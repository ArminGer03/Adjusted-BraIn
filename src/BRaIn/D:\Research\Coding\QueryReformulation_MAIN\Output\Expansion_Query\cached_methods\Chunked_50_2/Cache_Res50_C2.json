[{"bug_id": 2352, "bug_title": "Assertion errors in StaxEventItemReader", "bug_description": "In the afterPropertiesSet method, there are two notNull assertions on the field fragmentRootElementNames. The latter assertion should be changed to notEmpty instead.\n\n\n\n\n\n\nAssert.notNull(fragmentRootElementNames, \"The FragmentRootElementNames must not be null\");\n\n\n\n\nAssert.notNull(fragmentRootElementNames, \"The FragmentRootElementNames must not be empty\");\n\n\n\n\n\n\nAlso, the following error message is incorrect. It should be corrected to \"must not contain\"\n\n\n\n\n\n\nAssert.hasText(fragmentRootElementName.getLocalPart(), \"The FragmentRootElementNames must contain empty elements\");\n\n\n\n\n\n", "project": "Spring", "sub_project": "BATCH", "version": "3.0.3.RELEASE", "fixed_version": "3.0.4.RELEASE", "fixed_files": ["org.springframework.batch.item.xml.StaxEventItemReader.java"], "label": 1, "es_results": []}, {"bug_id": 2359, "bug_title": "CommandLineJobRunner - Content defined after an empty line is ignored when pipe mechanism is used", "bug_description": "The job arguments are stored in a file that looks like the following code snippet.\n\n\n\n\n\n\nsample job parameter file\n\n\n\n\n\n\n#\n\n\n\n\nfoo=bar\n\n\n\n\n\n\n\n\n\nfoo2=bar2\n\n\n\n\n\n\nWhen I call CommandLineJobRunner after a pipe, it ignores the second job argument (foo2=bar2).\n\n\n\n\n\n\ncat jobParameterFile | java -classpath foo.jar org.springframework.batch.core.launch.support.CommandLineJobRunner jobs/jobName.xml jobName\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "BATCH", "version": "3.0.3.RELEASE", "fixed_version": "3.0.4.RELEASE", "fixed_files": ["org.springframework.batch.core.launch.support.CommandLineJobRunnerTests.java", "org.springframework.batch.core.launch.support.CommandLineJobRunner.java"], "label": 1, "es_results": []}, {"bug_id": 29, "bug_title": "Dates are displayed in GMT instead of using the locale of the jvm", "bug_description": "Version 1.0.0.CI-SNAPSHOT\nThe timezone is hardcoded in the org.springframework.batch.admin.web.JobExecutionController class. \nIn this class you see the following hardcoding of timezone to GMT all over the place...\nmodel.addAttribute(new JobExecutionInfo(jobExecution, TimeZone.getTimeZone(\"GMT\"))); \nI think it would be better to default the timezone to the users locale and make it possible to override it using a configuration setting.  I&apos;m in a GMT+10 timezone so displaying GMT times makes times appear way off and there is no indication on the web page that the time is displayed in GMT.  ", "project": "Spring", "sub_project": "BATCHADM", "version": "1.0.0.RELEASE", "fixed_version": "1.0.0.M3", "fixed_files": ["org.springframework.batch.admin.sample.RestartJobIntegrationTests.java", "org.springframework.batch.admin.web.JobController.java", "org.springframework.batch.admin.web.StepExecutionController.java", "org.springframework.batch.admin.web.JobExecutionController.java", "org.springframework.batch.admin.web.JobExecutionInfo.java"], "label": 1, "es_results": []}, {"bug_id": 44, "bug_title": "Restart button on Job execution screen generates incorrect url", "bug_description": "I currently have over a thousand executions and when I press the Restart button on the Job execution screen it seems to generate a url with a thousand separator comma in it: /admin/batch/jobs/myJob/1,459/executions", "project": "Spring", "sub_project": "BATCHADM", "version": "1.0.0.M1", "fixed_version": "1.0.0.M3", "fixed_files": ["org.springframework.batch.admin.web.views.JobExecutionViewTests.java"], "label": 1, "es_results": []}, {"bug_id": 52, "bug_title": "Colons are escaped in job parameters in Jobs page", "bug_description": "Colons are escaped in job parameters in Jobs page (e.g. input.file=files\\://foo/bar.txt).  This is not fatal, it just means that you have to backspace over them before you submit the job.", "project": "Spring", "sub_project": "BATCHADM", "version": "1.0.0.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.batch.admin.web.JobController.java", "org.springframework.batch.admin.web.JobControllerTests.java"], "label": 1, "es_results": []}, {"bug_id": 71, "bug_title": "Protect admin console from CannotResolveClassException when deserializing from meta data tables", "bug_description": "When using Spring Batch Admin Console to view job executions from different JVMs causes a CannotResolveClassException from XStream. \nSpecifically, jobs saving custom classes to the job execution will have serialized objects stored in the meta data tables. When viewing the job execution in Spring Batch Admin Console, the console will attempt to deserialize these objects, and if the class is not available at runtime, the above exception will be thrown, causing an error to appear instead of the job execution.\nAs the deserialized objects are not used by the admin console, there is no reason to report this error and the exception can be caught and ignored or logged.\nSee the forum link for further details.", "project": "Spring", "sub_project": "BATCHADM", "version": "1.0.0.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.batch.admin.service.SimpleJobService.java", "org.springframework.batch.admin.service.SimpleJobServiceTests.java"], "label": 1, "es_results": []}, {"bug_id": 73, "bug_title": "XSS vulnerability in file download", "bug_description": "If there is an error the filename is by default not escaped in the html output.  A workaround for existing users is to provide a MessageSource with the relevant error codes from the FileController (file.download.missing and file.download.failed) so that the default text is not used. The fix is easy, and it only applies to the @RequestMapping with the wildcard \"**\" url pattern (others are rejected by the dispatcher).", "project": "Spring", "sub_project": "BATCHADM", "version": "1.0.0.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.batch.admin.web.FileControllerTests.java", "org.springframework.batch.admin.web.FileController.java"], "label": 1, "es_results": []}, {"bug_id": 78, "bug_title": "period ('.'), in jobName seems to confuse SBA UI when displaying Job Instances.", "bug_description": "After an execution of mycom.myJob  I can see the job in the Jobs Tab. If I click on that job I get &apos;There are no job instances for this job.&apos;  on the Job Instances Page\nIf I run the  same job  but using &apos;-&apos;  instead of &apos;.&apos; in the jobName ie mycom-myJob  then I can see the job Instances as expected.  ", "project": "Spring", "sub_project": "BATCHADM", "version": "1.0.0.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.batch.admin.web.JobController.java", "org.springframework.batch.admin.web.JobControllerTests.java"], "label": 1, "es_results": []}, {"bug_id": 99, "bug_title": "Ensure that all partitions in a step are represented in the job execution view", "bug_description": "Partition step executions are missing because of the way that the JobExecutionController tries to account for steps that have not yet started.", "project": "Spring", "sub_project": "BATCHADM", "version": "1.2.0.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.batch.admin.web.JobExecutionController.java"], "label": 1, "es_results": []}, {"bug_id": 115, "bug_title": "SimpleJobMetrics.getLatestStepExitDescription() does not work if the last step is very quick.", "bug_description": "I&apos;ve found (running against MySQL  and derby) that the timestamp comparison of steps isn&apos;t granular enough when the step executions are close together (within same second I think).  Adding another test comparing id&apos;s did the trick for me:\neg:\nif (stepDate.after(latest)) {\n    latest = stepDate;\n    stepExecution = candidate;\n    // hack when stepExecution endTimes are not granular enough.\n} else if (stepDate.equals(latest) && candidate.getId() > stepExecution.getId()) {\n    latest = stepDate;\n    stepExecution = candidate;\n}\n", "project": "Spring", "sub_project": "BATCHADM", "version": "1.2.0.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.batch.admin.jmx.SimpleJobExecutionMetrics.java", "org.springframework.batch.admin.jmx.SimpleJobExecutionMetricsTests.java"], "label": 1, "es_results": []}, {"bug_id": 137, "bug_title": "MessageChannelPartitionHandler in version 1.2.1 is not listening on replyChannel", "bug_description": "MessageChannelPartitionHandler in version 1.2.1 is creating new QueueChannel instead of getting it from the instance variable. In version 1.2.0, it is working fine. There is a property tag we can set in version 1.2.0 but not in version 1.2.1.\n\t<bean id=\"partitionHandler\"\n\t\tclass=\"org.springframework.batch.integration.partition.MessageChannelPartitionHandler\">\n\t\t<property name=\"messagingOperations\">\n\t\t\t<bean class=\"org.springframework.integration.core.MessagingTemplate\">\n\t\t\t\t<property name=\"defaultChannel\" ref=\"request\" />\n\t\t\t\t<property name=\"receiveTimeout\" value=\"10000\" />\n\t\t\t</bean>\n\t\t</property>\n\t\t<property name=\"replyChannel\" ref=\"reply\" />\n\t\t<property name=\"stepName\" value=\"step1\" />\n\t\t<property name=\"gridSize\" value=\"2\" />\n\t</bean>", "project": "Spring", "sub_project": "BATCHADM", "version": "1.2.1.RELEASE", "fixed_version": "1.3.0.RELEASE", "fixed_files": ["org.springframework.batch.integration.partition.MessageChannelPartitionHandler.java"], "label": 1, "es_results": []}, {"bug_id": 23, "bug_title": "PageImpl can not be constructed with empty content", "bug_description": "When passing empty list to PageImpl constructor (e.g. in a test, when mocking repository method which returns Page), PageRequest is instantiated with \"content.size()\" as page size, but 0 size is not allowed argument value in PageRequest.\nBY THE WAY, 1.0 M5 DATACMNS is not marked as released in JIRA, but it is, as part of or together with DATAJPA 1.0 M2 release.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.0.0.M5", "fixed_version": "1.0.0.M6", "fixed_files": ["org.springframework.data.domain.PageImpl.java", "org.springframework.data.domain.PageImplUnitTests.java", "org.springframework.data.domain.Page.java"], "label": 1, "es_results": []}, {"bug_id": 44, "bug_title": "ParametersParameterAccessor iterator will never iterate...", "bug_description": "In the ParametersParameterAccessor class, the BindableParameterIterator is invalid : \nThe hasNext() method test \"values.length <= currentIndex;\" instead of \"values.length >= currentIndex;\" ...", "project": "Spring", "sub_project": "DATACMNS", "version": "1.1.0.M1", "fixed_version": "1.1.0.M2", "fixed_files": ["org.springframework.data.repository.query.ParametersParameterAccessor.java"], "label": 1, "es_results": []}, {"bug_id": 45, "bug_title": "Property check for repository methods fails for properties starting with _", "bug_description": "If you have a class\n\n\n\n\n\n\nclass Person {\n\n\n\n\n  private int _age;\n\n\n\n\n  \n\n\n\n\n  public int getAge() {\n\n\n\n\n    return _age;\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n\nand a repository interface\n\n\n\n\n\n\ninterface PersonRepository extends Repository<Person, Long> {\n\n\n\n\n  Person findByAge(int age);\n\n\n\n\n}\n\n\n\n\n\n\ncreating a proxy instance for the interface will fail with an exception claiming that no property age is found. This is due to the fact that TypeDiscoverer is currently only considering fields right now and we should think about if it makes sense to make it really property aware.\nA workaround to simply use findBy_Age fails as well as {} is used as custom delimiter to manually define property paths. So we should at least guard the code to correctly resolve _age in case there&apos;s no content in front of the {}.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.1.0.M1", "fixed_version": "1.1.0.M2", "fixed_files": ["org.springframework.data.repository.query.parser.Property.java", "org.springframework.data.repository.query.parser.PropertyUnitTests.java", "org.springframework.data.util.TypeDiscoverer.java", "org.springframework.data.util.ClassTypeInformationUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 52, "bug_title": "Declaring an intermediate base repository does not work correctly", "bug_description": "I have cases where I want to group together several query methods, but they don&apos;t seem to fit on any entity-typed repository. I realize I could just use an arbitrary entity for the repository type, but it seems architecturally wrong, and I don&apos;t want to leave an option for client code to call methods inherited from GenericDao.\nTherefore I suggest adding an option to create a repository that has no type and does not inherit any methods. I think the best way to configure such a repository interface is with annotations/XML, and not require inheriting from a marker interface. Such repository mechanism would not require the ability to add custom implementation, since it just groups together JPQL queries instead of placing them at the entity sources, and any \"custom implementation\" should be placed in other beans.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.1.0.M2", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.data.repository.core.support.DefaultRepositoryInformationUnitTests.java", "org.springframework.data.querydsl.SimpleEntityPathResolverUnitTests.java", "org.springframework.data.repository.core.support.RepositoryFactorySupportUnitTests.java", "org.springframework.data.repository.core.support.DefaultRepositoryInformation.java"], "label": 1, "es_results": []}, {"bug_id": 57, "bug_title": "Use of parameterized type in constructor arguments is not supported", "bug_description": "When an object contains a List of another object (no simple types), the MongoMappingConverter finds correct generic type for the field, but when this field is used in the PersistenceConstructor, the type is considered to be the raw type and then no information is available to convert batck the DBObject instances for this list.\nIn the TypeDiscover class, the method getParameterTypes(Constructor<?>) use the reflection method Class<?>[] Constructor.getParameterTypes() that give no hint on the generic parameter types. I replaced this call with Type[] Constructor::getGenericParameterTypes(), that has solved my problem.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.1.0.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.data.util.TypeDiscoverer.java", "org.springframework.data.util.TypeDiscovererUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 65, "bug_title": "BasicPersistentEntity potentially suffers from ConcurrentModificationException", "bug_description": "BasicPersistentEntity exposes an addPersistentEntity(...) method to allow adding properties and essentially makes it mutable. This potentially opens it up to a concurrency problem given the following scenario:\n1. We concurrently use MongoTemplate for inserting objects of a type not already known to the MappingContext.\n2. Thread A enters getPersistentEntity(...) which discovers the entity not mapped already and thus calls addPersistentEntity(...). The algorithm in there eagerly adds the PersistentEntity object to the map of PersistentEntities to allow type self-references be detected. No or some properties might have been discovered already.\n3. Thread B enters getPersistentEntity(...) which now discovers the semi-parsed PersistentEntity and thus returns it. This thread continues and at some point doWithProperties(...) gets invoked, iterating over the PersistentProperties already registered.\n4. Meanwhile Thread A wants to add additional PersistentProperties and thus causes a ConcurrentModificationException in thread B.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.1.0.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.data.mapping.context.AbstractMappingContext.java"], "label": 1, "es_results": []}, {"bug_id": 69, "bug_title": "Performance issues with RepositoryInterfaceAwareBeanPostProcessor when using @Transactional", "bug_description": "There is a major performance issue with RepositoryInterfaceAwareBeanPostProcessor when using @Transactional support in application&apos;s service classes. The problem is that the method RepositoryInterfaceAwareBeanPostProcessor.predictBeanType(Class<?> beanClass, String beanName) is relatively slow due to a usage of ClassUtils.resolveClassName(...). The actual problem is that the method in question is called whenever someone calls BeanFactoryUtils.beansOfTypeIncludingAncestors(...) and that someone happens to be TransactionAspectUtils.getTransactionManager(...) method, which is called before a call of any method annotated with @Transactional annotation. These calls happens because RepositoryInterfaceAwareBeanPostProcessor implements SmartInstantiationAwareBeanPostProcessor.\nCan RepositoryInterfaceAwareBeanPostProcessor.predictBeanType(Class<?> beanClass, String beanName) method be optimized?", "project": "Spring", "sub_project": "DATACMNS", "version": "1.1.0.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.data.repository.core.support.RepositoryInterfaceAwareBeanPostProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 736, "bug_title": "Invalid error message in PointFormatter", "bug_description": "It reports it&apos;s expecting a semicolon but actually expects a comma.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.10.1.RELEASE", "fixed_version": "1.10.2.RELEASE", "fixed_files": ["org.springframework.data.geo.format.DistanceFormatterUnitTests.java", "org.springframework.data.geo.format.PointFormatterUnitTests.java", "org.springframework.data.geo.format.PointFormatter.java"], "label": 1, "es_results": []}, {"bug_id": 750, "bug_title": "Part.extractProperty(String part) invalidly extracts property paths containing keywords", "bug_description": "I declare a method named findByLeakInfoAuditStateIn(Collection states). When I start up my application, Spring Data throws an exception: \n\n\n\n\n\n\nPropertyReferenceException: No property leak found for type Leak!\n\n\n\n\n\n\nLeakInfo is a bean, Leak is not. Then i debug into source, i found source that:\n\n\n\n\n\n\npublic String extractProperty(String part) {\n\n\n\n\n\n\n\n\n\n  String candidate = StringUtils.uncapitalize(part);\n\n\n\n\n  for (String keyword : keywords) {\n\n\n\n\n    if (candidate.endsWith(keyword)) {\n\n\n\n\n      return candidate.substring(0, candidate.indexOf(keyword));\n\n\n\n\n    }\n\n\n\n\n  }\n\n\n\n\n  return candidate;\n\n\n\n\n}\n\n\n\n\n\n\nThe String.indexOf() method find the first In within LeakInfo. That&apos;s not excepted. May be use String.lastIndexOf() instead?", "project": "Spring", "sub_project": "DATACMNS", "version": "1.10.2.RELEASE", "fixed_version": "1.11.0.RELEASE", "fixed_files": ["org.springframework.data.repository.query.parser.PartTreeUnitTests.java", "org.springframework.data.repository.query.parser.Part.java"], "label": 1, "es_results": []}, {"bug_id": 761, "bug_title": "PageableHandlerMethodArgumentResolver reduces page size by one if on-indexed parameters are used", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.10.2.RELEASE", "fixed_version": "1.11.1.RELEASE", "fixed_files": ["org.springframework.data.web.PageableHandlerMethodArgumentResolverUnitTests.java", "org.springframework.data.web.PageableHandlerMethodArgumentResolver.java"], "label": 1, "es_results": []}, {"bug_id": 772, "bug_title": "Add converter for ZoneId to String and vice versa", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.0.RELEASE", "fixed_version": "1.12.0.M1", "fixed_files": ["org.springframework.data.convert.ThreeTenBackPortConvertersUnitTests.java", "org.springframework.data.convert.Jsr310Converters.java", "org.springframework.data.convert.ThreeTenBackPortConverters.java", "org.springframework.data.convert.Jsr310ConvertersUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 769, "bug_title": "Cannot create auto-generated @Async method with pagination", "bug_description": "When I create a repository with asynchronous paging query, I get a BeanCreationException about incompatible return type, which must be Slice, Page or List (see stacktrace.txt).\n\n\n\n\n\n\npublic interface TRepository extends MongoRepository<T, String> {\n\n\n\n\n\n\n\n\n\n    @Async\n\n\n\n\n    CompletableFuture<List<T>> findByUrl(String url, Pageable p); // works neither with Future nor with ListenableFuture\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.0.RELEASE", "fixed_version": "1.11.1.RELEASE", "fixed_files": ["org.springframework.data.repository.util.ClassUtilsUnitTests.java", "org.springframework.data.repository.util.ClassUtils.java"], "label": 1, "es_results": []}, {"bug_id": 773, "bug_title": "Add support for persisting ZoneId instances out of the box", "bug_description": "The JSR-310 mapping support can read a simple string (e.g., \"US/Central\") into a ZoneId field, but when it&apos;s saved, it&apos;s saved as a complex serialized object, with _class: \"java.time.ZoneRegion\" and all the internal state.\nHowever, the mapper can&apos;t read this saved object, presumably because of the lack of a cooperative constructor; the exception message is\n\n\n\n\n\n\norg.springframework.data.mapping.model.MappingException: No property null found on entity class java.time.ZoneRegion to bind constructor parameter to!\n\n\n\n\n\n\nI suggest that the ZoneId should be saved as the simple string identifier.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.0.RELEASE", "fixed_version": "1.12.0.M1", "fixed_files": ["org.springframework.data.convert.ThreeTenBackPortConvertersUnitTests.java", "org.springframework.data.convert.Jsr310Converters.java", "org.springframework.data.convert.ThreeTenBackPortConverters.java", "org.springframework.data.convert.Jsr310ConvertersUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 779, "bug_title": "Fix JavaDoc of constructor of QuerydslPredicateBuilder", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.0.RELEASE", "fixed_version": "1.11.1.RELEASE", "fixed_files": ["org.springframework.data.querydsl.binding.QuerydslPredicateBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 789, "bug_title": "Fix typo in JavaDoc of Page", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.10.2.RELEASE", "fixed_version": "1.11.2.RELEASE", "fixed_files": ["org.springframework.data.domain.Page.java"], "label": 1, "es_results": []}, {"bug_id": 843, "bug_title": "Raise log level of repositories that get dropped in strict configuration mode to INFO", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.10.2.RELEASE", "fixed_version": "1.11.5.RELEASE", "fixed_files": ["org.springframework.data.repository.config.RepositoryConfigurationDelegate.java", "org.springframework.data.repository.config.RepositoryConfigurationExtensionSupport.java"], "label": 1, "es_results": []}, {"bug_id": 804, "bug_title": "IndexOutOfBoundException in ParametersParameterAccessor iterator when non-bindable parameter(s) used", "bug_description": "When using a ParametersParameterAccessor on a method with, say, a Pageable (which is non-bindable), attempting to iterate over the accessor throws an IndexOutOfBoundException.\nThis is because BindableParameterIterator.hasNext() checks values.length, which includes non-bindable parameters, whereas next() calls getBindableValue.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.2.RELEASE", "fixed_version": "1.12.0.M1", "fixed_files": ["org.springframework.data.repository.query.ParametersParameterAccessorUnitTests.java", "org.springframework.data.repository.query.ParametersParameterAccessor.java"], "label": 1, "es_results": []}, {"bug_id": 812, "bug_title": "Confusing message generated by  PageImpl.toString()", "bug_description": "The PageImpl.toString() uses getNumber() and getTotalPages(). The problem is:\n\ngetNumber() uses 0-based index\ngetTotalPages() is the total number of pages\n\nSo you end up with:\n\n\n\n\n\n\nPage 0 of 2 containing com.foo.Bar instances\n\n\n\n\nPage 1 of 2 containing com.foo.Bar instances\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.4.RELEASE", "fixed_version": "1.12.0.RC1", "fixed_files": ["org.springframework.data.domain.PageImpl.java"], "label": 1, "es_results": []}, {"bug_id": 829, "bug_title": "Projecting a Map with a null value causes an exception", "bug_description": "ProjectingMethodInterceptor.getProjection(Object, Class<?>) assumes the first param to be non-null, but it may be null if there is a Map with a null value, e.g. a Collections.createSingletonMap(\"key\", null).\nThat means that returning such map from a @Projection, e.g.:\n\n\n\n\n\n\npublic interface MyProjection {\n\n\n\n\n    Map<String, Object> getData();\n\n\n\n\n}\n\n\n\n\n\n\nresults in an exception.\nA kind of a workaround is to remove nulls from a projected map, e.g.:\n\n\n\n\n\n\npublic interface MyProjection {\n\n\n\n\n    @Value(\"#{T(...).mapWithoutNulls(target.getData())}\")\n\n\n\n\n    Map<String, Object> getData();\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n...\n\n\n\n\n\n\n\n\n\npublic static <K, V> Map<K, V> mapWithoutNulls(Map<K, V> map) {\n\n\n\n\n    return map.entrySet().stream()\n\n\n\n\n            .filter(entry -> entry.getValue() != null)\n\n\n\n\n            .collect(Collectors.toMap(\n\n\n\n\n                    Map.Entry::getKey,\n\n\n\n\n                    Map.Entry::getValue));\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.4.RELEASE", "fixed_version": "1.12.0.RC1", "fixed_files": ["org.springframework.data.projection.ProxyProjectionFactoryUnitTests.java", "org.springframework.data.projection.ProjectingMethodInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 854, "bug_title": "Custom implementation of repository fails when overriding methods containing generics", "bug_description": "I am using the method for creating custom implementation of repositories, as described (among other places) here. This works great for just about all methods, including methods from the standard CrudRepository and PagingAndSortingRepository like Page<T> findAll(Pageable pageable). However, this does not work if the method defined in CrudRepository or PagingAndSortingRepository contains parameters with generics, like T findOne(ID id).\nWhy am I doing this you ask? Well, I am trying to find a work around while waiting for DATACMNS-293. This allows me to implement the methods manually, while keeping all the goodness of the restful exposure code as-is, which given QueryDSL is suprisingly simple and I am nearly questioning the need for the solution in DATACMNS-293...\nThe following patch fixes the issue for me, but I am not able to see if this has further unwanted ramifications:\n\n\n\n\n\n\niff --git a/src/main/java/org/springframework/data/repository/core/support/DefaultRepositoryInformation.java b/src/main/java/org/springframework/data/repository/core/support/DefaultRepositoryInformation.java\n\n\n\n\nindex 48bcdac..785c575 100644\n\n\n\n\n--- a/src/main/java/org/springframework/data/repository/core/support/DefaultRepositoryInformation.java\n\n\n\n\n+++ b/src/main/java/org/springframework/data/repository/core/support/DefaultRepositoryInformation.java\n\n\n\n\n@@ -356,7 +356,7 @@ class DefaultRepositoryInformation implements RepositoryInformation {\n\n\n\n\n                                        return false;\n\n\n\n\n                                }\n\n\n\n\n                        } else {\n\n\n\n\n-                               if (!types[i].equals(parameterType)) {\n\n\n\n\n+                               if (!types[i].isAssignableFrom(parameterType)) {\n\n\n\n\n                                        return false;\n\n\n\n\n                                }\n\n\n\n\n                        }\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.4.RELEASE", "fixed_version": "1.11.5.RELEASE", "fixed_files": ["org.springframework.data.repository.core.support.DefaultRepositoryInformation.java", "org.springframework.data.repository.core.support.DefaultRepositoryInformationUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 831, "bug_title": "AbstractMappingContext.getPersistentEntity sometimes returns an empty entity when called by multiple threads", "bug_description": "If you call the getPersistentEntity() method in the AbstractMappingContext class with the same type from multiple threads concurrently, you will sometimes get an empty entity back, i.e. an entity without any properties. This is caused by a race condition at the beginning of the addPersistentEntity() method. If one thread calls the method while another one is already executing inside the write lock in the method, the first thread will return an empty entity from the persistentEntities map even though the second thread is still populating it with properties. To fix this, the addPersistentEntity() method should acquire the read lock before accessing the persistentEntities map.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.4.RELEASE", "fixed_version": "1.11.5.RELEASE", "fixed_files": ["org.springframework.data.mapping.context.AbstractMappingContext.java"], "label": 1, "es_results": []}, {"bug_id": 863, "bug_title": "Query method Parameter should return element type for wrapper ones (e.g. Optional)", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.4.RELEASE", "fixed_version": "1.11.5.RELEASE", "fixed_files": ["org.springframework.data.repository.query.ParametersUnitTests.java", "org.springframework.data.repository.query.Parameter.java"], "label": 1, "es_results": []}, {"bug_id": 883, "bug_title": "NullPointerException for Querydsl bindings referring to collection element attributes", "bug_description": "Assume you have a domain model like this:\n\n\n\n\n\n\nclass User {\n\n\n\n\n  List<Address> addresses;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nclass Address {\n\n\n\n\n  String street;\n\n\n\n\n}\n\n\n\n\n\n\nReferring to the property addresses.street via Querydsl-backed web requests doesn&apos;t work as we&apos;re inspecting the properties in the Querydsl generated classes, and the ListPath generated for addresses needs a dedicated any() lookup to get back to the EntityPath for the element predicates.\nManually specifying a binding, doesn&apos;t help either as the translation into a PropertyPath fails, as we currently rely on the toString() representation of the PathMetadata, which in case of the usage of any() returns any(user.addresses).street.\nWe need to fix the to-dot-path translation in that step and should add the implicit call to any() for derived path expressions in case we encounter a Path that points to a collection.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.4.RELEASE", "fixed_version": "1.13.0.M1", "fixed_files": ["org.springframework.data.querydsl.binding.QuerydslBindings.java", "org.springframework.data.querydsl.binding.QuerydslPredicateBuilderUnitTests.java", "org.springframework.data.querydsl.QueryDslUtils.java", "org.springframework.data.querydsl.User.java", "org.springframework.data.querydsl.binding.QuerydslPredicateBuilder.java", "org.springframework.data.querydsl.binding.QuerydslBindingsUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 896, "bug_title": "ClassTypeInformation computes incorrect TypeVariable mappings for recursive generics", "bug_description": "When using a class with type variables in the class hierarchy, which contains variables referencing other classes also using common parts of the same class hierarchy, the type variables type mappings for the referenced classes are incorrectly mixed into the original classes type variables.\nSee the attached JUnit test which can demonstrate the problem.  It may require several runs for it appear, but it is consistently failing for us.\nI believe this is due the essentially random ordering of the HashSet.entrySet().iterator() on line 130 and the putAll() on line 136:\nhttps://github.com/spring-projects/spring-data-commons/blob/master/src/main/java/org/springframework/data/util/ClassTypeInformation.java#L130\nhttps://github.com/spring-projects/spring-data-commons/blob/master/src/main/java/org/springframework/data/util/ClassTypeInformation.java#L136\nDepending on the sequencing, you either get your own type variable value, or some other related classes.  Last one wins.\nWe&apos;ve tried modifying this class to removed the putAll (line 136), and it fixes this test, and does not appear to cause problems for 100s of other Spring Data Repository based tests we have.  It&apos;s not clear why the type variable mappings from other classes that are not direct superclasses or interfaces are included at all, it seems very wrong.\n\nIt took us 4 days to track down this as the ultimate source of a random startup failures of a Spring Data JPA Repository while parsing of dynamic query methods on a particular part of our domain model.  It was very hard to reproduce, but one developers box seemed to want to fail rather consistently, which gave the opportunity to narrow it down.  My hope, for now, is to work around it by mapping the query method to a custom implementation.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.4.RELEASE", "fixed_version": "1.11.5.RELEASE", "fixed_files": ["org.springframework.data.util.ClassTypeInformation.java", "org.springframework.data.util.ClassTypeInformationUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 909, "bug_title": "Exclude decoratedClass from JSON links, created from Projection and received with Spring @RestController", "bug_description": "Experiment with spring-boot version: in 1.3.7.RELEASE (spring data 2.4.4) decoratedClass is absent, but in 1.4.0.RELEASE (spring data 2.5.2) it is present\nI&apos;d like get clean JSON, when using Projection as DTO with RestController. However, in the best case we get JSON, most of which contain links to dekoratedClass.\n{\"name\":\"Dmitry\",\"id\":1,\"decoratedClass\":\"ru.inkontext.domain.Person\", \"adress\":{\"id\":1,\"decoratedClass\":\"ru.inkontext.domain.Adress\",\"city\":\"Surgut\"}}\nDecide by Oliver Gierke\nLooks like this is caused by proxies created through Spring&apos;s ProxyFactory now also implementing a new DecoratingProxy, which exposes getDecoratedClass() and our TargetAware interface that&apos;s in place to mask the artificial proxy properties doesn&apos;t mask that newly introduced attribute. I can adapt our TargetAware accordingly.\nA temporary workaround would be to redeclare the getDecoratedClass() method on your projection interface and annotate it with @JsonIgnore.\nTests below imaging matter of question.\nRestController\nWithout Projection\nmockMvc.perform(get(\"/rest/persons/1\"))\n.andExpect(jsonPath(\"id\").value(1)\n.andExpect(jsonPath(\"decoratedClass\").doesNotExist());\nProjection created by Repository\nmockMvc.perform(get(\"/rest/persons/1/projected\"))\n.andExpect(jsonPath(\"id\").value(1))\n.andExpect(jsonPath(\"decoratedClass\").value(\"java.util.HashMap\"));\nProjection created by Repository with Generic\nmockMvc.perform(get(\"/rest/persons/1/projectedClass\"))\n.andExpect(jsonPath(\"id\").value(1))\n.andExpect(jsonPath(\"decoratedClass\").value(\"java.util.HashMap\"));\nProjection created by Projection Factory\nmockMvc.perform(get(\"/rest/persons/1/adressCity\"))\n.andExpect(jsonPath(\"id\").value(1))\n.andExpect(jsonPath(\"decoratedClass\").value(\"ru.inkontext.domain.Person\"));\nStandard Sring Data REST API\nwithout Projection\nmockMvc.perform(get(\"/rest/api/persons/1\"))\n.andExpect(jsonPath(\"id\").doesNotExist())\n.andExpect(jsonPath(\"_links\").exists());\nwith Projection\nmockMvc.perform(get(\"/rest/api/persons/1?projection=adressCity\"))\n.andExpect(status().isOk())\n.andExpect(jsonPath(\"id\").value(1))\n.andExpect(jsonPath(\"_links\").exists());", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.4.RELEASE", "fixed_version": "1.11.5.RELEASE", "fixed_files": ["org.springframework.data.projection.TargetAware.java"], "label": 1, "es_results": []}, {"bug_id": 828, "bug_title": "Potential NullPointerException in ResultProcessor", "bug_description": "According to the JavaDoc ResultProcessor.processResult() allows null to be handed as result, which makes sense as a query result to be processed can be null. However, null is not handled implicitly or explicitly and will yield an exception being thrown from ProjectionFactory as a projection is attempted downstream.\nWe should handle null explicitly and eagerly return the value as is.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.12.0.M1", "fixed_version": "1.12.0.RC1", "fixed_files": ["org.springframework.data.repository.query.ResultProcessorUnitTests.java", "org.springframework.data.repository.query.ResultProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 859, "bug_title": "ResultProcessor does not handle Stream instances correctly", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.12.1.RELEASE", "fixed_version": "1.12.2.RELEASE", "fixed_files": ["org.springframework.data.repository.query.ResultProcessorUnitTests.java", "org.springframework.data.repository.query.ResultProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 860, "bug_title": "ResultProcessor should use ConversionService as fallback if target is a class", "bug_description": "If the actual conversion target in repository projections is not an interface, ResultProcessor currently fails with the ProjectionFactory rejecting the type. We could rather use a standard ConversionService implementation so that normal object conversion mechanisms can kick in (i.e. the ObjectToObjectConverter supporting converting factory methods, and constructors).", "project": "Spring", "sub_project": "DATACMNS", "version": "1.12.1.RELEASE", "fixed_version": "1.12.2.RELEASE", "fixed_files": ["org.springframework.data.repository.query.ResultProcessorUnitTests.java", "org.springframework.data.repository.query.ResultProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 856, "bug_title": "DomainClassConverter throws erroneous exception in matches", "bug_description": "DomainClassConverter#matches throws a ConversionMatchAbbreviationException instead of correctly returning false in at least the following scenario:\n\nsourceType is not related to targetType\ntargetType has a Spring Data repository with a String ID\n\nThe matches method performs the following logic:\n\nsourceType is not assignable to targetType\ntargetType has a repository\nthe ID type is String\nsourceType is not a String, and I can&apos;t convert sourceType to a String\n\nThe correct response is therefore simply not to match (and in my case, to let SpEL attempt to bind to a different method overload). The converter instead throws an exception.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.12.1.RELEASE", "fixed_version": "1.11.5.RELEASE", "fixed_files": ["org.springframework.data.repository.support.DomainClassConverter.java"], "label": 1, "es_results": []}, {"bug_id": 862, "bug_title": "ReturnedInterface should not consider super interfaces of domain type projecting", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.12.1.RELEASE", "fixed_version": "1.12.2.RELEASE", "fixed_files": ["org.springframework.data.repository.query.ReturnedTypeUnitTests.java", "org.springframework.data.repository.query.ReturnedType.java"], "label": 1, "es_results": []}, {"bug_id": 951, "bug_title": "Add Converters for JSR-310 Duration and Period", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.12.1.RELEASE", "fixed_version": "1.13.0.RC1", "fixed_files": ["org.springframework.data.convert.Jsr310Converters.java", "org.springframework.data.convert.Jsr310ConvertersUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 880, "bug_title": "TransactionalRepositoryFactoryBeanSupport.setBeanFactory does not delegate to super-implementation", "bug_description": "From TransactionalRepositoryFactoryBeanSupport:\n\n\n\n\n\n\npublic void setBeanFactory(BeanFactory beanFactory) {\n\n\n\n\n\n\n\n\n\n\tAssert.isInstanceOf(ListableBeanFactory.class, beanFactory);\n\n\n\n\n\n\n\n\n\n\tListableBeanFactory listableBeanFactory = (ListableBeanFactory) beanFactory;\n\n\n\n\n\tthis.txPostProcessor = new TransactionalRepositoryProxyPostProcessor(listableBeanFactory, transactionManagerName,\n\n\n\n\n\t\t\tenableDefaultTransactions);\n\n\n\n\n\tthis.exceptionPostProcessor = new PersistenceExceptionTranslationRepositoryProxyPostProcessor(listableBeanFactory);\n\n\n\n\n\t    \n\n\n\n\n}\n\n\n\n\n\n\nwhich doesn&apos;t delegate to the super-implementation of RepositoryFactoryBeanSupport, and consequently, afterPropertiesSet() passes null down to a custom factory implementation, which is IMHO wrong. Maven project attached to demonstrate the issue, but I think the fix is simply to add a line with the call to the super implementation in TransactionalRepositoryFactoryBeanSupport.setBeanFactory.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.12.2.RELEASE", "fixed_version": "1.13.0.M1", "fixed_files": ["org.springframework.data.repository.core.support.TransactionalRepositoryFactoryBeanSupport.java", "org.springframework.data.repository.core.support.TransactionRepositoryFactoryBeanSupportUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 900, "bug_title": "ExampleMatcher.PropertySpecifiers does not implement equals/hashCode", "bug_description": "The class ExampleMatcher.PropertySpecifiers does not implement equals/hashCode. Since an ExampleMatcher and its PropertySpecifiers are referenced by an Example instance, this means that it is not possible to mock the implementation of repository methods taking an Example as argument, e.g. JpaRepository.findAll(Example).", "project": "Spring", "sub_project": "DATACMNS", "version": "1.12.2.RELEASE", "fixed_version": "1.12.3.RELEASE", "fixed_files": ["org.springframework.data.domain.ExampleMatcher.java", "org.springframework.data.domain.ExampleMatcherUnitTests.java", "org.springframework.data.domain.ExampleUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 912, "bug_title": "Unable to write custom implementation of CRUD method with generic parameters", "bug_description": "As discussed in https://jira.spring.io/browse/DATACMNS-854, I am opening a new issue as I am unable to create a custom implementation of a CRUD method that takes generic parameters.\nI modified my example that reproduces the problem and removed Mockito from the picture.  I also tested the flow in our code base at runtime (not in unit tests), and am also able to reproduce.\nHere is the potential DefaultRepositoryInformationUnitTests test that reproduces:\n\n\n\n\n\n\n    class BossRepositoryCustom {\n\n\n\n\n        Boss save(Boss boss) {\n\n\n\n\n            return boss;\n\n\n\n\n        }\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    @Test\n\n\n\n\n    public void discoversCustomlyImplementedCrudMethodWithGenericParameters() throws SecurityException, NoSuchMethodException {\n\n\n\n\n        BossRepositoryCustom customImplementation = new BossRepositoryCustom();\n\n\n\n\n        RepositoryMetadata metadata = new DefaultRepositoryMetadata(BossRepository.class);\n\n\n\n\n        RepositoryInformation information = new DefaultRepositoryInformation(metadata, CrudRepository.class,\n\n\n\n\n                                                                             customImplementation.getClass());\n\n\n\n\n\n\n\n\n\n        Method customBaseRepositoryMethod = BossRepository.class.getMethod(\"save\", Object.class);\n\n\n\n\n        assertThat(information.isCustomMethod(customBaseRepositoryMethod), is(true));\n\n\n\n\n    }\n\n\n\n\n\n\nI&apos;ve also attached a self-contained small test that also reproduces the issue.\nLet me know if you need more information.  Hopefully I am not missing something obvious here.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.12.2.RELEASE", "fixed_version": "1.11.5.RELEASE", "fixed_files": ["org.springframework.data.repository.core.support.DefaultRepositoryInformation.java", "org.springframework.data.repository.core.support.DefaultRepositoryInformationUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 921, "bug_title": "ResultProcessor should create approximate collection instead of exact one", "bug_description": "ResultProcessor currently tries to create an instance of the exact collection type encountered when processing collections. This will fail for special collection implementation types that don&apos;t have a default constructor or fail to instantiate for other reasons.\nWe should fall back to an approximate collection in that case.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.12.3.RELEASE", "fixed_version": "1.12.4.RELEASE", "fixed_files": ["org.springframework.data.repository.query.ResultProcessorUnitTests.java", "org.springframework.data.repository.query.ResultProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 963, "bug_title": "ReturnedType.getInputProperties() does not guarantee distinct properties", "bug_description": "In case inheritance is used in projection interfaces and an accessor method is redeclared, the property is returned twice in ReturnedType.getInputProperties(). The reason for that is that the accessor methods are backed by different PropertyDescriptor instances as they&apos;re unique per declared type.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.12.5.RELEASE", "fixed_version": "1.13.0.RC1", "fixed_files": ["org.springframework.data.repository.query.ReturnedTypeUnitTests.java", "org.springframework.data.repository.query.ReturnedType.java"], "label": 1, "es_results": []}, {"bug_id": 81, "bug_title": "RepositoryInterfaceAwareBeanPostProcessor potentially suffers from NullPointerException", "bug_description": "RepositoryInterfaceAwareBeanPostProcessor.getClassForPropertyValue(...) returns null if a repository interface can not be loaded. The caching ConcurrentHashMap does not allow null as values.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.2.0.M1", "fixed_version": "1.2.0.M2", "fixed_files": ["org.springframework.data.repository.core.support.RepositoryInterfaceAwareBeanPostProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 108, "bug_title": "RepositoryFactorySupport throws ClassCastException for annotation based repositories", "bug_description": "Repository interfaces using the annotation based declaration model cannot be created through RepositoryFactorySupport as it&apos;s generics are typed to T extends Repository. As the proxy generated might not implement this interface itself we should add it to the interfaces the proxy exposes.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.2.0.M2", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.data.repository.core.support.RepositoryFactorySupportUnitTests.java", "org.springframework.data.repository.core.support.RepositoryFactorySupport.java", "org.springframework.data.mapping.model.BeanWrapper.java"], "label": 1, "es_results": []}, {"bug_id": 109, "bug_title": "Upgrade to latest Querydsl", "bug_description": "Hello,\nUnit tests against spring-data-commons-core don&apos;t run on JDK 1.7. \nIt happens because spring-data-commons-core depends on querydsl 2.2.0 version which has a known bug. Please see https://bugs.launchpad.net/querydsl/+bug/819861\nThis issue was fixed in 2.2.1, so after I updated dependency everything works fine.\nRegards,\nAlexey.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.2.0.M2", "fixed_version": "1.11.2.RELEASE", "fixed_files": ["org.springframework.data.util.TypeVariableTypeInformation.java"], "label": 1, "es_results": []}, {"bug_id": 125, "bug_title": "QueryExecutorMethodInterceptor does not reject interfaces with query methods if no QueryLookupStrategy defined", "bug_description": "The constructor of QueryExecutorMethodInterceptor tries to reject interfaces containing query methods if no QueryLookupStrategy is defined. Unfortunately it doesn&apos;t as it checks for custom methods instead of query methods.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.2.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.repository.core.support.QueryExecutorMethodInterceptorUnitTests.java", "org.springframework.data.repository.core.support.RepositoryFactorySupport.java"], "label": 1, "es_results": []}, {"bug_id": 120, "bug_title": "PreferredConstructor.Parameter does not have equals(...) and hashCode() methods", "bug_description": "If this is fixed MappedConstructor.getFor(...) in Spring Data Mongo could rather hold a Map of Parameter to MappedParameter to avoid iterating over all MappedParameter instances on each call.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.2.RELEASE", "fixed_version": "1.3.0.RC1", "fixed_files": ["org.springframework.data.mapping.PreferredConstructor.java"], "label": 1, "es_results": []}, {"bug_id": 132, "bug_title": "NullPointerException AbstractPersistentProperty inside isEntity", "bug_description": "isEntity() throws a NPE when evaluating a HashMap. See the forum reference (from entry #4 and forth) for more details.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.3.0.M1", "fixed_version": "1.3.0.RC1", "fixed_files": ["org.springframework.data.mapping.model.AbstractPersistentPropertyUnitTests.java", "org.springframework.data.mapping.model.AbstractPersistentProperty.java"], "label": 1, "es_results": []}, {"bug_id": 139, "bug_title": "StackOverflowError from infinite recursion in PropertyPath.create:326", "bug_description": "Using the mapper from Spring Data MongoDB, I get a stack overflow exception when I make a call to findOne using a simple .is() criteria. I tested with spring-data-commons-core 1.2.1.RELEASE and 1.2.2.BUILD-SNAPSHOT.\nI was able to reproduce the error using data common&apos;s PropertyPath stand-alone; putting following line in a test causes the same exception:\n\n\n\n\n\n\nPropertyPath pp = PropertyPath.from(\"_id\", CardInteraction.class);\n\n\n\n\n\n\nwhere CardInteraction is defined with the @Id annotation:\n\n\n\n\n\n\n@Document\n\n\n\n\npublic class CardInteraction {\n\n\n\n\n@Id private String interactionId;\n\n\n\n\n...\n\n\n\n\n}\n\n\n\n\n\n\nThe infinite recursion converges with the arguments PropertyPath.create:326(source=\"_\", type=..., addTail=\"id\")", "project": "Spring", "sub_project": "DATACMNS", "version": "1.2.1.RELEASE", "fixed_version": "1.3.0.RC1", "fixed_files": ["org.springframework.data.mapping.PropertyPath.java", "org.springframework.data.mapping.PropertyUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 170, "bug_title": "Potential NullPointerException in ReflectionEntityInformation", "bug_description": "After scanning for the annotation handed to the constructor, ReflectionEntityInformation tries to make it accessible before checking the field for null. This will cause a NullPointerException being thrown. Thus, thhe null-check following afterwards should be moved before that statement.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.3.0.RC2", "fixed_version": "1.3.0.RELEASE", "fixed_files": ["org.springframework.data.repository.core.support.ReflectionEntityInformation.java"], "label": 1, "es_results": []}, {"bug_id": 133, "bug_title": "Documented Configuration of Conversion Service with DomainClassConverter Does Not Work", "bug_description": "The Spring Data JPA documentation describes configuring a DomainClassConverter like so:\n\n\n\n\n\n\n<mvc:annotation-driven conversion-service=\"conversionService\" />\n\n\n\n\n\n\n\n\n\n<bean id=\"conversionService\" class=\"....context.support.ConversionServiceFactoryBean\">\n\n\n\n\n  <property name=\"converters\">\n\n\n\n\n    <list>\n\n\n\n\n      <bean class=\"org.springframework.data.repository.support.DomainClassConverter\">\n\n\n\n\n        <constructor-arg ref=\"conversionService\" />\n\n\n\n\n      </bean>\n\n\n\n\n    </list>\n\n\n\n\n  </property>\n\n\n\n\n</bean>\n\n\n\n\n\n\nHowever, this fails to work from an apparent cyclic instantiation error (\"Error creating bean with name &apos;conversionService&apos;: FactoryBean which is currently in creation returned null from getObject\").\nThis is one workaround for the problem:\n\n\n\n\n\n\n<bean id=\"conversionService\" class=\"org.springframework.core.convert.support.DefaultConversionService\"/>\n\n\n\n\n\n\n\n\n\n<bean class=\"org.springframework.beans.factory.config.MethodInvokingFactoryBean\">\n\n\n\n\n  <property name=\"targetClass\" value=\"org.springframework.core.convert.support.ConversionServiceFactory\"/>\n\n\n\n\n  <property name=\"targetMethod\" value=\"registerConverters\"/>\n\n\n\n\n  <property name=\"arguments\">\n\n\n\n\n    <util:list>\n\n\n\n\n      <set>\n\n\n\n\n        <bean class=\"org.springframework.data.repository.support.DomainClassConverter\">\n\n\n\n\n          <constructor-arg ref=\"conversionService\"/>\n\n\n\n\n        </bean>\n\n\n\n\n      </set>\n\n\n\n\n      <ref bean=\"conversionService\"/>\n\n\n\n\n    </util:list>\n\n\n\n\n  </property>\n\n\n\n\n</bean>\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.2.1.RELEASE", "fixed_version": "1.3.0.RC1", "fixed_files": ["org.springframework.data.repository.support.DomainClassConverter.java", "org.springframework.data.repository.support.DomainClassConverterUnitTests.java", "org.springframework.data.repository.core.support.AbstractEntityInformationUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 226, "bug_title": "ConfigurableTypeInformationMapper caches too aggressively", "bug_description": "If ConfigurableTypeInformationMapper is used with a MappingContext the TypeInformation and aliases managed are looked up eagerly. As types can be added later on we need to fall back to another PersistentEntity lookup in case we don&apos;t find a cached value. ", "project": "Spring", "sub_project": "DATACMNS", "version": "1.3.2.RELEASE", "fixed_version": "1.11.4.RELEASE", "fixed_files": ["org.springframework.data.convert.TypeInformationMapper.java", "org.springframework.data.convert.DefaultTypeMapper.java", "org.springframework.data.mapping.MappingMetadataTests.java", "org.springframework.data.convert.TypeAliasAccessor.java", "org.springframework.data.convert.ConfigurableTypeInformationMapperUnitTests.java", "org.springframework.data.convert.ConfigurableTypeInformationMapper.java", "org.springframework.data.convert.SimpleTypeInformationMapper.java", "org.springframework.data.mapping.context.AbstractMappingContext.java"], "label": 1, "es_results": []}, {"bug_id": 228, "bug_title": "Mapping sub-system should exclude Groovy introduced properties from persistent properties", "bug_description": "When using Groovy classes with the mapping metadata sub-system, the Groovy compiler introduced fields like metaClass should not be considered a persistent property.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.4.0.RC1", "fixed_version": "1.11.4.RELEASE", "fixed_files": ["org.springframework.data.mapping.context.AbstractMappingContextUnitTests.java", "org.springframework.data.mapping.context.AbstractMappingContext.java"], "label": 1, "es_results": []}, {"bug_id": 233, "bug_title": "DomainClassConverter should gracefully return null for null sources or empty strings", "bug_description": "I&apos;ve noticed an important issue related to automatic web binding of String id to Domain class.\nImagine the use case where you have an Order domain class which has a ManyToOne reference to Customer.\nWhen posting a new Order where Order.customer == \"\" then a converter exception is thrown:\n\n\n\n\n\n\nFailed to convert property value of type java.lang.String to required type org.mycomp.domain.Customer for property customer; nested exception is org.springframework.core.convert.ConversionFailedException: Failed to convert from type java.lang.String to type @javax.validation.constraints.NotNull @javax.persistence.ManyToOne org.mycomp.domain.Customer for value &apos;; nested exception is org.springframework.dao.InvalidDataAccessApiUsageException: The given id must not be null!; nested exception is java.lang.IllegalArgumentException: The given id must not be null!\n\n\n\n\n\n\nI think it should not try to convert to Domain class if id is null or empty.\nAnd note that for optional references this even might even because a complete blocker?\nThis is the code I used:\n\n\n\n\n\n\n<form:select path=\"customer\">\n\n\n\n\n\t<form:option value=\"\" label=\"Select\" />\n\n\n\n\n\t<form:options items=\"${customers}\" itemValue=\"id\"></form:options>\n\n\n\n\n</form:select>\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.3.2.RELEASE", "fixed_version": "1.11.4.RELEASE", "fixed_files": ["org.springframework.data.repository.support.DomainClassConverter.java", "org.springframework.data.repository.support.DomainClassConverterUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 239, "bug_title": "AbstractRepositoryPopulatorFactoryBean handling of ContextRefreshedEvent does not work", "bug_description": "The code in https://github.com/SpringSource/spring-data-commons/blob/master/spring-data-commons-core/src/main/java/org/springframework/data/repository/init/AbstractRepositoryPopulatorFactoryBean.java assumes that the ApplicationContext is the BeanFactory.\nSomething like to following seems to be required for a ConfigurableApplicationContext.\n\n\n\n\n\n\nApplicationContext source = event.getApplicationContext();\n\n\n\n\nif (source instanceof ConfigurableApplicationContext &&\n\n\n\n\n\t((ConfigurableApplicationContext)source).getBeanFactory().equals(beanFactory)) {\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.4.0.RC1", "fixed_version": "1.11.4.RELEASE", "fixed_files": ["org.springframework.data.repository.init.AbstractRepositoryPopulatorFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 263, "bug_title": "CDI integration with openEJB fails", "bug_description": "\nprovided an EntityManager Producer\ncreate context: context = EJBContainer.createEJBContainer(p).getContext();\nlog says:\n\nOpenEJB.cdi - OpenWebBeans Container is starting...\norg.springframework.data.jpa.repository.cdi.JpaRepositoryExtension - Activating CDI extension for Spring Data JPA repositories.\norg.springframework.data.jpa.repository.cdi.JpaRepositoryExtension - Discovered &apos;javax.persistence.EntityManager&apos; with qualifiers [@javax.enterprise.inject.Any(), @javax.enterprise.inject.Default()].\nand then:\nUnable to resolve a bean for &apos;javax.persistence.EntityManager&apos; with qualifiers [@javax.enterprise.inject.Any(), @javax.enterprise.inject.Default()].\nsee also attached log", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.4.RELEASE", "fixed_version": "1.11.5.RELEASE", "fixed_files": ["org.springframework.data.repository.cdi.CdiRepositoryExtensionSupport.java"], "label": 1, "es_results": []}, {"bug_id": 271, "bug_title": "AnnotationBasedPersistentProperty should cache annotation lookups", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.4.RELEASE", "fixed_version": "1.11.5.RELEASE", "fixed_files": ["org.springframework.data.mapping.model.AnnotationBasedPersistentProperty.java"], "label": 1, "es_results": []}, {"bug_id": 276, "bug_title": "ParameterizedTypeInformation is missing hashCode() method", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.4.RELEASE", "fixed_version": "1.4.1.RELEASE", "fixed_files": ["org.springframework.data.util.ParameterizedTypeInformation.java"], "label": 1, "es_results": []}, {"bug_id": 283, "bug_title": "Improve exception message for failed instantiations in ReflectionEntityInstatiator", "bug_description": "In case we see an exception invoking the constructor of an entity class in ReflectionEntityInstantiator there&apos;s no information about why this has actually failed. We should capture more context such as the type to be instantiated, the constructor being used and the resolved parameters.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.5.RELEASE", "fixed_version": "1.5.1.RELEASE", "fixed_files": ["org.springframework.data.convert.ReflectionEntityInstantiator.java", "org.springframework.data.mapping.model.MappingInstantiationException.java", "org.springframework.data.convert.ReflectionEntityInstantiatorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 281, "bug_title": "Change Order class so that case insensitive sorts can be performed by setting an ignore case flag", "bug_description": "I would like to allow the setting of an ignore case flag to be set on the Order class so that case insensitive sorts can be supported.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.5.RELEASE", "fixed_version": "1.6.0.M1", "fixed_files": ["org.springframework.data.domain.Sort.java", "org.springframework.data.domain.SortUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 300, "bug_title": "ReflectionEntityInstantiator should actually throw created exception", "bug_description": "In the catch block a new exception is instanciated, which I assume should be thrown, but misses the throw keyword and therefore currently does nothing.\nhttps://github.com/SpringSource/spring-data-commons/blob/master/src/main/java/org/springframework/data/convert/ReflectionEntityInstantiator.java#L64\nSimplistic test that demonstrates this: https://github.com/SpringSource/spring-data-commons/pull/25/files", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.5.RELEASE", "fixed_version": "1.5.1.RELEASE", "fixed_files": ["org.springframework.data.convert.ReflectionEntityInstantiator.java", "org.springframework.data.convert.ReflectionEntityInstantiatorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 309, "bug_title": "TypeDiscoverer does not correctly resolve nested property path expressions", "bug_description": "\n\n\n\n\n\nclass Foo {\n\n\n\n\n  Bar bar;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nclass Bar {\n\n\n\n\n  Long id;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nTypeInformation<?> type = ClassTypeInformation.from(Foo.class);\n\n\n\n\nassertThat(type.getProperty(\"bar.id\"), is(notNullValue()));\n\n\n\n\n\n\nThe assertion fails as TypeDiscoverer.getProperty() does not recursively resolve the properties but looks up the head in the cache only (line 180).", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.5.RELEASE", "fixed_version": "1.5.1.RELEASE", "fixed_files": ["org.springframework.data.util.TypeDiscoverer.java", "org.springframework.data.util.ClassTypeInformationUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 323, "bug_title": "PageImpl.getTotalPages() possibly returns incorrect result when PageImpl is instantiated with simple constructor", "bug_description": "I wonder, why PageImpl.getTotalPages() returns 0, when instantiated with simple constructor, with non zero element collection as argument.\n\n\n\n\n\n\nPageImplTest.java\n\n\n\n\n\n\nimport org.junit.*;\n\n\n\n\nimport org.springframework.data.domain.*;\n\n\n\n\n\n\n\n\n\nimport java.util.*;\n\n\n\n\n\n\n\n\n\nimport static org.hamcrest.CoreMatchers.*;\n\n\n\n\nimport static org.junit.Assert.*;\n\n\n\n\n\n\n\n\n\npublic class PageImplTest {\n\n\n\n\n\n\n\n\n\n    @Test\n\n\n\n\n    public void getTotalPagesReturnSameResultForAllConstructors() {\n\n\n\n\n        List<String> content = Arrays.asList(\"a\", \"b\");\n\n\n\n\n\n\n\n\n\n        Page<String> pageWithSimpleConstructor = new PageImpl<>(content);\n\n\n\n\n\n\n\n\n\n        Pageable pageable = new PageRequest(0, content.size());\n\n\n\n\n\n\n\n\n\n        Page<String> pageWithComplexConstructor = new PageImpl<>(content, pageable, content.size());\n\n\n\n\n\n\n\n\n\n        assertThat(pageWithComplexConstructor.getTotalPages(), is(1));\n\n\n\n\n        assertThat(pageWithSimpleConstructor.getTotalPages(), is(1));\n\n\n\n\n\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.11.5.RELEASE", "fixed_version": "1.6.0.M1", "fixed_files": ["org.springframework.data.domain.PageImpl.java", "org.springframework.data.domain.PageImplUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 333, "bug_title": "Support for Jackson 2.x for JSON repository populators", "bug_description": "Trying to getting started with:\nhttp://static.springsource.org/spring-data/commons/docs/current/reference/html/repositories.html#d0e893\nHowever I get a ClassNotFoundException: org.codehaus.jackson.map.ObjectMapper when using Jackson 2.x", "project": "Spring", "sub_project": "DATACMNS", "version": "1.5.1.RELEASE", "fixed_version": "1.6.0.M1", "fixed_files": ["org.springframework.data.repository.config.RepositoryNameSpaceHandler.java", "org.springframework.data.repository.config.ResourceReaderRepositoryPopulatorBeanDefinitionParserIntegrationTests.java", "org.springframework.data.repository.config.ResourceReaderRepositoryPopulatorBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 327, "bug_title": "AbstractMappingContext has to init domain classes in afterPropertiesSet()", "bug_description": "We have to revert the fix introduced for DATACMNS-179 as this leaves MappingContext implementations in uninitialized state at container init stages when other application components might already rely on the context being fully initialized.\nE.g. this could be a MongoDB query execution in an init method of a component that relies on all persistent entities being known in advance. ", "project": "Spring", "sub_project": "DATACMNS", "version": "1.5.1.RELEASE", "fixed_version": "1.6.0.M1", "fixed_files": ["org.springframework.data.mapping.context.AbstractMappingContextUnitTests.java", "org.springframework.data.mapping.context.AbstractMappingContext.java"], "label": 1, "es_results": []}, {"bug_id": 345, "bug_title": " AbstractMappingContext does not consider the actual type of property of a generic collection type. ", "bug_description": "AbstractMappingContext.getPersistentEntity() should use actual type information to deal with generic collection types. The current implementation of AbstractMappingContext.getPersistentEntity() returns null for the list property of the class listed below. \n\n\n\n\n\n\nstatic class ParentClass {\n\n\n\n\n  \n\n\n\n\n  String id;\n\n\n\n\n  List<? extends AbstractChildClass> list;\n\n\n\n\n\n\n\n\n\n  public ParentClass(String id, List<? extends AbstractChildClass> list) {\n\n\n\n\n    this.id = id;\n\n\n\n\n    this.list = list;\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nstatic abstract class AbstractChildClass {\n\n\n\n\n\n\n\n\n\n  String id;\n\n\n\n\n  String value;\n\n\n\n\n\n\n\n\n\n  public AbstractChildClass(String id, String value) {\n\n\n\n\n    this.id = id;\n\n\n\n\n    this.value = value;\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nstatic class ConcreteChildClass extends AbstractChildClass {\n\n\n\n\n\n\n\n\n\n  public ConcreteChildClass(String id, String value) {\n\n\n\n\n    super(id, value);\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.5.1.RELEASE", "fixed_version": "1.5.2.RELEASE", "fixed_files": ["org.springframework.data.mapping.context.AbstractMappingContextUnitTests.java", "org.springframework.data.mapping.context.AbstractMappingContext.java"], "label": 1, "es_results": []}, {"bug_id": 341, "bug_title": "RepositoryFactorySupport proxy classloader", "bug_description": "The RepositoryFactorySupport.getRepository uses result.getProxy() to create a new proxy. Since the method is called to create a new bean it should probably use the variant that accepts a classloader (obtained via ClassLoaderAware).", "project": "Spring", "sub_project": "DATACMNS", "version": "1.5.1.RELEASE", "fixed_version": "1.11.6.RELEASE", "fixed_files": ["org.springframework.data.repository.core.support.RepositoryFactorySupportUnitTests.java", "org.springframework.data.repository.core.support.RepositoryFactorySupport.java", "org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.java"], "label": 1, "es_results": []}, {"bug_id": 360, "bug_title": "Unable to use @Profile annotation on scanned repository interfaces", "bug_description": "The scanner created by RepositoryConfigurationSourceSupport [1] does not set an Environment. This means that @Profile annotations on the scanned repository will be resolved against a new StandardEnvironement which will not have any active profiles.\n[1] https://github.com/SpringSource/spring-data-commons/blob/ac256f9921807977fc8baa70054aa52cbcfebe6b/src/main/java/org/springframework/data/repository/config/RepositoryConfigurationSourceSupport.java#L43", "project": "Spring", "sub_project": "DATACMNS", "version": "1.5.2.RELEASE", "fixed_version": "1.11.6.RELEASE", "fixed_files": ["org.springframework.data.repository.config.XmlRepositoryConfigurationSource.java", "org.springframework.data.repository.config.RepositoryBeanDefinitionRegistrarSupportUnitTests.java", "org.springframework.data.repository.config.RepositoryConfigurationSourceSupport.java", "org.springframework.data.repository.config.AnnotationRepositoryConfigurationSource.java", "org.springframework.data.repository.config.AnnotationRepositoryConfigurationSourceUnitTests.java", "org.springframework.data.repository.config.RepositoryBeanDefinitionParser.java", "org.springframework.data.repository.config.RepositoryBeanDefinitionRegistrarSupport.java"], "label": 1, "es_results": []}, {"bug_id": 362, "bug_title": "Potential concurrency issues in Repositories", "bug_description": "getRepoInfoFor() is iterating over the key set of the repositories already cached to eagerly return RepositoryInformation instances found upfront. A second thread might have already passed that block of the code and triggered lookupRepositoryFactoryInformationFor() which writes into the repositories instance variable. This will cause a ConcurrentModificationException as reported in this issue.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.5.2.RELEASE", "fixed_version": "1.11.6.RELEASE", "fixed_files": ["org.springframework.data.repository.support.Repositories.java"], "label": 1, "es_results": []}, {"bug_id": 352, "bug_title": "SortHandlerMethodArgumentResolver and PageableHandlerMethodArgumentResolver have inconsistent property names", "bug_description": "In SortHandlerMethodArgumentResolver (added in 1.6), you can customize the request parameter name with method setSortParameter. However, PageableHandlerMethodArgumentResolver uses the word \"property\" instead of \"paramater\" for its request parameter properties: setPageProperty and setSizeProperty. These should be consistent. I prefer \"parameter\" because that reflects the fact that it&apos;s a request parameter, but however they&apos;re named it should be consistent.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.0.RC1", "fixed_version": "1.11.6.RELEASE", "fixed_files": ["org.springframework.data.web.PageableHandlerMethodArgumentResolverUnitTests.java", "org.springframework.data.web.PageableDefaultUnitTests.java", "org.springframework.data.web.PageableHandlerMethodArgumentResolver.java"], "label": 1, "es_results": []}, {"bug_id": 358, "bug_title": "The current page number cannot be greater or equal to the total number of pages", "bug_description": "I see \"The current page number cannot be greater or equal to the total number \nof pages\" exception when datastore has no data.\nTruncated Trace:\n-------------------------------------------\njava.lang.IllegalArgumentException: The current page number cannot be greater or equal to the total number of pages!\n\torg.springframework.util.Assert.isTrue(Assert.java:65)\n\torg.springframework.hateoas.PagedResources$PageMetadata.<init>(PagedResources.java:207)\n\torg.springframework.data.web.PagedResourcesAssembler.asPageMetadata(PagedResourcesAssembler.java:162)\n\torg.springframework.data.web.PagedResourcesAssembler.createResource(PagedResourcesAssembler.java:124)\n\torg.springframework.data.web.PagedResourcesAssembler.toResource(PagedResourcesAssembler.java:109)", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.0.RC1", "fixed_version": "1.11.6.RELEASE", "fixed_files": ["org.springframework.data.web.PagedResourcesAssemblerUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 376, "bug_title": "Repositories cannot deal with CGLib proxied classes", "bug_description": "If you ask Repositories for a RepositoryInformation or PersistentEntity and pass a proxy class of a type type that is actually managed by the Repositories instance it currently returns null as the RepositoryFactoryInformation lookup fails. This is due to the lookup not actually looking up the information for the user class but the proxied one.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.5.3.RELEASE", "fixed_version": "1.6.2.RELEASE", "fixed_files": ["org.springframework.data.repository.support.RepositoriesIntegrationTests.java", "org.springframework.data.repository.support.Repositories.java"], "label": 1, "es_results": []}, {"bug_id": 385, "bug_title": "DefaultRepositoryInformation#getTargetClassMethod matches wrong save-Method if Entity implements Iterable", "bug_description": "If an entity implements Iterable and I try to use SimpleJpaRepository#save(Iterable) to save a list of these entities, the code sometimes fails because DefaultRepositoryInformation#getTargetClassMethod(Method, Class) matches the save(Object)-method, depending which of the two save-methods is checked first in the loop.\nTo reproduce this behaviour reliably, I had to set a breakpoint in the for-Loop of getTargetClassMethod() and make sure, that the method save(Object) is called before the save(Iterable) for a list of iterable entities.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.1.RELEASE", "fixed_version": "1.6.2.RELEASE", "fixed_files": ["org.springframework.data.repository.core.support.DefaultRepositoryInformation.java", "org.springframework.data.repository.core.support.DefaultRepositoryInformationUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 408, "bug_title": "Guard against invalid values when resolving pagination and sorting parameters from web requests", "bug_description": "[example of invalid value]\n\npage=-1 (negative numeric)\nsize=a (not numeric)\nsort= (not specified)\nsort=,DESC (not specified property of sort target)\netc ...\n\nCurrent implementation of the PageableHandlerMethodArgumentResolver is occurred IllegalArgumentException, and http response status is returned 500(Internal Server Error) on the default settings of SpringMVC.\nI think a best that http response status is returned 400(Bad Request).", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.1.RELEASE", "fixed_version": "1.6.3.RELEASE", "fixed_files": ["org.springframework.data.web.PageableHandlerMethodArgumentResolverUnitTests.java", "org.springframework.data.web.SortHandlerMethodArgumentResolver.java", "org.springframework.data.web.PageableHandlerMethodArgumentResolver.java", "org.springframework.data.web.SortHandlerMethodArgumentResolverUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 377, "bug_title": "All elements are returned if pageSize = 0", "bug_description": "All elements are returned if pageSize = 0 in splite of new option maxPageSize in PageableHandlerMethodArgumentResolver introduced from v1.6.\nConsider the example below\n\n\n\n\n\n\n@ContextConfiguration\n\n\n\n\n@RunWith(SpringJUnit4ClassRunner.class)\n\n\n\n\n@Transactional\n\n\n\n\n@TransactionConfiguration(defaultRollback = true)\n\n\n\n\npublic class CustomerRepositoryTest {\n\n\n\n\n    @Inject\n\n\n\n\n    protected CustomerRepository customerRepository;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    @Test\n\n\n\n\n    public void testFindAllPageable() {\n\n\n\n\n        System.out.println(customerRepository.findAll(new PageRequest(0, 3)));\n\n\n\n\n        System.out.println(customerRepository.findAll(new PageRequest(0, 0)));\n\n\n\n\n        System.out.println(customerRepository.findAll(new PageRequest(0, -1)));\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n}\n\n\n\n\n\n\nFist case, only 3 elements are returned with the following SQL\n\n\n\n\n\n\n5. /* select count(*) from Customer as generatedAlias0 */ select count(*) as col_0_0_ from customer customer0_ {executed in 5 msec}\n\n\n\n\n5. /* select generatedAlias0 from Customer as generatedAlias0 */ select customer0_.customer_code as customer1_3_, customer0_.customer_add as customer2_3_, customer0_.customer_birth as customer3_3_, customer0_.customer_job as customer4_3_, customer0_.customer_kana as customer5_3_, customer0_.customer_mail as customer6_3_, customer0_.customer_name as customer7_3_, customer0_.customer_pass as customer8_3_, customer0_.customer_post as customer9_3_, customer0_.customer_tel as custome10_3_ from customer customer0_ limit 3 {executed in 8 msec}\n\n\n\n\n\n\nThird case, IllegalArgumentException is thrown with a message, \"Page size must not be less than zero!\".\nI think these are correct result.\nHowever, in second case, all elements are returned with the following SQL\n\n\n\n\n\n\n5. /* select count(*) from Customer as generatedAlias0 */ select count(*) as col_0_0_ from customer customer0_ {executed in 2 msec}\n\n\n\n\n5. /* select generatedAlias0 from Customer as generatedAlias0 */ select customer0_.customer_code as customer1_3_, customer0_.customer_add as customer2_3_, customer0_.customer_birth as customer3_3_, customer0_.customer_job as customer4_3_, customer0_.customer_kana as customer5_3_, customer0_.customer_mail as customer6_3_, customer0_.customer_name as customer7_3_, customer0_.customer_pass as customer8_3_, customer0_.customer_post as customer9_3_, customer0_.customer_tel as custome10_3_ from customer customer0_ {executed in 7 msec}\n\n\n\n\n\n\nNote that there is no &apos;limit&apos; statement.\nI&apos;m afraid tha it will cause OutOfMemoryError easily and weak for DDoS atack.\nI think it&apos;s better to throw IllegalArgumentException if pageSize=0 or replace pageSize by maxPageSize.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.1.RELEASE", "fixed_version": "1.7.0.M1", "fixed_files": ["org.springframework.data.web.PageableHandlerMethodArgumentResolverUnitTests.java", "org.springframework.data.web.PageableHandlerMethodArgumentResolver.java", "org.springframework.data.domain.PageRequest.java", "org.springframework.data.domain.PageRequestUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 379, "bug_title": "SortHanderMethodArgumentResolver fails to resolve comma-only sort parameter", "bug_description": "If specified \",\"(comma only) in parameter value of sort, occurred the ArrayIndexOutOfBoundsException.\nI expected that IllegalArgumentException occurs.\nOther patterns is occurred IllegalArgumentException.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.1.RELEASE", "fixed_version": "1.6.3.RELEASE", "fixed_files": ["org.springframework.data.web.SortHandlerMethodArgumentResolver.java", "org.springframework.data.web.SortHandlerMethodArgumentResolverUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 429, "bug_title": "PageRequest constructor documentation parameter order incorrect.", "bug_description": "The documentation for the constructor PageRequest(int page, int size) is incorrect as it has the parameters listed in the wrong order.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.1.RELEASE", "fixed_version": "1.7.0.RC1", "fixed_files": ["org.springframework.data.domain.Sort.java", "org.springframework.data.domain.PageRequest.java"], "label": 1, "es_results": []}, {"bug_id": 387, "bug_title": "Potential NullPointerExceptions in PartTree area", "bug_description": "When creating a PartTree for an empty predicate (e.g. findAllByOrderByFooAsc) we create a Part with a null PropertyPath. This causes issues later on when this path is consumed excepting it not to be null at any time.\nWe should reject the invalid parameters handed around in the value objects more aggressively and even prevent the creation of a Part in the PartTree if the string is empty at this point.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.2.RELEASE", "fixed_version": "1.7.0.M1", "fixed_files": ["org.springframework.data.domain.PageImpl.java", "org.springframework.data.repository.query.QueryMethodUnitTests.java", "org.springframework.data.repository.query.QueryMethod.java", "org.springframework.data.domain.Page.java", "org.springframework.data.web.PagedResourcesAssembler.java", "org.springframework.data.domain.PageImplUnitTests.java", "org.springframework.data.util.ClassTypeInformation.java", "org.springframework.data.mapping.PropertyPathUnitTests.java", "org.springframework.data.repository.query.parser.PartTree.java", "org.springframework.data.repository.query.parser.Part.java", "org.springframework.data.util.ClassTypeInformationUnitTests.java", "org.springframework.data.mapping.PropertyPath.java", "org.springframework.data.repository.query.parser.PartTreeUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 410, "bug_title": "ReflectionRepositoryInvoker not working properly", "bug_description": "The ReflectionRepositoryInvoker is not invoking the findOne method correctly on a non-CrudRepository implementation. Specifically, the:\n\n\n\n\n\n\n \n\n\n\n\npublic T invokeFindOne(Serializable id) {\n\n\n\n\n  return (T) ReflectionUtils.invokeMethod(methods.getFindOneMethod(), id);\n\n\n\n\n}\n\n\n\n\n\n\nshould be fixed to: \n\n\n\n\n\n\n \n\n\n\n\npublic T invokeFindOne (Serializable id) {\n\n\n\n\n  return (T) ReflectionUtils.invokeMethod (methods.getFindOneMethod (), repository, id);\n\n\n\n\n}\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.2.RELEASE", "fixed_version": "1.7.0.RC1", "fixed_files": ["org.springframework.data.repository.support.ReflectionRepositoryInvokerUnitTests.java", "org.springframework.data.repository.support.ReflectionRepositoryInvoker.java", "org.springframework.data.repository.support.RepositoriesIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 415, "bug_title": "Performance improvements in configuration subsystem", "bug_description": "Original email by Martin Lippert:\n\nThe implementation creates a new ClassPathScanningCandidateComponentProvider without setting a MetadataReaderFactory. This causes a new caching metadata reading factory being created every time this method is called, resulting in more or less no caching for the metadata. I am not sure from where to get the appropriate MetadataReaderFactory, but the ConfigurationClassPostProcessor has the right one. I hope there is a way to reuse that, it would reduce the loading and parsing of byte code a lot.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.3.RELEASE", "fixed_version": "1.7.0.RC1", "fixed_files": ["org.springframework.data.repository.config.RepositoryBeanDefinitionBuilder.java", "org.springframework.data.repository.config.RepositoryBeanDefinitionParser.java", "org.springframework.data.repository.config.RepositoryBeanDefinitionRegistrarSupport.java"], "label": 1, "es_results": []}, {"bug_id": 412, "bug_title": "Exception ' java.lang.IllegalArgumentException: Not an managed type' upon a tomcat context reload", "bug_description": "Exception &apos; java.lang.IllegalArgumentException: Not an managed type&apos; upon a tomcat context reload when cached &apos;RepositoryInformation&apos; (change added in  DATACMNS-395) is returned by the &apos;RepositoryFactorySupport&apos; class.\nThe &apos;Environment&apos; field of this Jira issue contains details on my setup (emdedded tomcat 7).\nThe attached file &apos;tomcat-log.txt&apos; contains the full trace of the exception and context reload.\nIf I modify RepositoryFactorySupport#getRepositoryInformation and have it always return new RepositoryInformation (i.e. effectively the old behaviour prior to the DATACMNS-395 change) then this exception does not occur.\nAttached (\"RepositoryInformationCmp.txt\") is a dump of the cached version of RepositoryInformation vs a newly created instance (I used ReflectionToStringBuilder with a recursive &apos;ToStringStyle&apos; strategey to produce the dump). The &apos;different&apos; utility reveals that the content of both instances is identical.\nNote however that the recursion stops at java.lang classes and so does not include the contents of the &apos;Class&apos; classes which is where I believe the difference lies.\nMy theory on the because of this problem is that a new class loader is instantiated when the Tomcat context is reloaded, thereby somehow invalidating existing &apos;Class&apos; meta-information.\nInterestingly, the first comment I saw upon navigating to the Spring Data Commons Jira site, by Seppel Hardt read with words to the effect that he encountered a similar problem and had reached a similar conclusion.\nBy anecdotal observation of stack overflow posts, I see there appears to numerous other users facing this issue also.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.3.RELEASE", "fixed_version": "1.7.0.RC1", "fixed_files": ["org.springframework.data.repository.core.support.RepositoryFactorySupport.java"], "label": 1, "es_results": []}, {"bug_id": 436, "bug_title": "Order.ignoreCase not taken into account in equals(), hashCode() and toString()", "bug_description": "The org.springframework.data.domain.Sort.Order#ignoreCase field is not taken into account in Order#equals(), Order#hashCode() and Order#toString(), although setting this field to different values impacts the semantics of Order.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.6.3.RELEASE", "fixed_version": "1.6.4.RELEASE", "fixed_files": ["org.springframework.data.domain.Sort.java", "org.springframework.data.domain.SortUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 441, "bug_title": "Analyzing @Query annotated bridge methods lead to NPEs during QueryMethod processing in Java 8", "bug_description": "We should skip bridge methods instead considering them for @Query annotation inspection, since we cannot extract the generic type parameter from bridge  methods.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.7.0.RC1", "fixed_version": "1.7.0.RELEASE", "fixed_files": ["org.springframework.data.repository.core.support.DefaultRepositoryInformation.java", "org.springframework.data.repository.core.support.DefaultRepositoryInformationUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 453, "bug_title": "NullPointerException at listing non-CRUD repositories in RepositoryMetadata.isPageableRepository()", "bug_description": "Listing repositories if one repository has no pageable finders leads to a NullPointerException.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.7.0.RELEASE", "fixed_version": "1.7.1.RELEASE", "fixed_files": ["org.springframework.data.repository.core.support.AbstractRepositoryMetadataUnitTests.java", "org.springframework.data.repository.core.support.AbstractRepositoryMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 477, "bug_title": "PageableHandlerMethodArgumentResolver.setFallbackPageable(null) does not work as specified", "bug_description": "The javadoc indicates that passing null to this method is valid and should result in a null value handed into the controller method.  However if a null value is passed the result is a NullPointerException thrown from the resolveArgument() method.  It is clear from the implementation code in resolveArgument() that a null default is not anticipated.  The fix is relatively trivial: the resolveArgument() method simply needs to return null if the defaultOrFallback value is null.\nThe ability to provide null as a default value allows an application to support both paged and non paged results from a single controller method, depending on whether the page parameters are passed in.  The workaround is to declare separate methods and use request mappings to differentiate them based on presence of the page parameters in the request, but this seems awkward compared to being able to simply test for a null pageable.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.7.1.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.web.PageableHandlerMethodArgumentResolverUnitTests.java", "org.springframework.data.web.PageableDefaultUnitTests.java", "org.springframework.data.web.PageableHandlerMethodArgumentResolver.java"], "label": 1, "es_results": []}, {"bug_id": 479, "bug_title": "Regression in PersistentEntity detection for concrete Map types", "bug_description": "A change introduced in Spring Data Commons 1.7.x to improve the detection of nested PersistentEntities causes concrete Map types being added to the MappingContext in case they are used as property type.\nThis is caused by PersistentProperty.isEntity() not excluding Map and Collection types anymore and PersistentProperty.getPersistentEntityTypes() adding the sole type to the list of returned types in a subsequent detection step.\nWe should ditch the check on isEntity() altogether and solely rely on the list of nested types being returned from getPersistentEntityTypes(). Ironically, master already has this implemented correctly due to the changes made for DATACMNS-243. Still we should forward port the slight change in the detection algorithm to keep them as consistent as possible.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.7.1.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.mapping.context.AbstractMappingContextUnitTests.java", "org.springframework.data.mapping.context.AbstractMappingContext.java", "org.springframework.data.mapping.model.AbstractPersistentProperty.java"], "label": 1, "es_results": []}, {"bug_id": 519, "bug_title": "PagedResourcesAssembler should keep tempalte variables provided in base link", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.7.2.RELEASE", "fixed_version": "1.9.0.M1", "fixed_files": ["org.springframework.data.web.PagedResourcesAssembler.java", "org.springframework.data.web.PageableHandlerMethodArgumentResolver.java", "org.springframework.data.web.PagedResourcesAssemblerUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 509, "bug_title": "NullableWrapper Breaks JSON Conversion", "bug_description": "Since an upgrade to JPA 1.6 RC1, Spring MVC fails to properly address a NullableWrapper and this is returned, with the contents contained with the NullableWrapper.\nI have a MVC method that is returning:\n\n\n\n\n\n\npublic Callable<Set<Pos>> get(.....) {\n\n\n\n\n    final Set<Pos> allPos = posService.findAll();\n\n\n\n\n    return ImmutableSortedSet.copyOf(allPos);\n\n\n\n\n}\n\n\n\n\n\n\nWith Spring Data JPA 1.5., I get on the wire a set of Pos&apos;s in JSON format, i.e.,\n\n\n\n\n\n\n[{\"name: \"pos1\"}, {\"name: \"pos2\"}]\n\n\n\n\n\n\nWith Spring Data JPA 1.6 RC1, I now get the NullableWrapper with Contents:\n\n\n\n\n\n\n[valueType: \"java.util.ArrayList\", value: [{\"name: \"pos1\"}, {\"name: \"pos2\"}]]\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.8.0.RC1", "fixed_version": "1.8.0.RELEASE", "fixed_files": ["org.springframework.data.repository.util.QueryExecutionConverters.java", "org.springframework.data.repository.core.support.RepositoryFactorySupport.java", "org.springframework.data.repository.core.support.DummyRepositoryFactory.java", "org.springframework.data.repository.core.support.RepositoryFactorySupportUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 511, "bug_title": "AbstractMappingContext.addPersistentEntity causes infinite loop", "bug_description": "After updating from Codd SR2 to Dijkstra I could not run my tests. After debugging the issue I found that the problem lies in AbstractMappingContext.addPersistentEntity. This method is never called in Codd SR2 due to initialize not being triggered.\nWe use quite a few abstract MappedSuperclasses that have circular references and apparently this does not work. An example:\n\n\n\n\n\n\npublic class User extends AbstractTenantUser<User, Role, Permission, Tenant> {\n\n\n\n\n    ...\n\n\n\n\n}\n\n\n\n\npublic abstract class AbstractTenantUser<USER extends AbstractTenantUser<USER, ROLE, PERMISSION, TENANT>, ROLE extends AbstractRole<USER, PERMISSION>, PERMISSION extends AbstractPermission<USER>, TENANT extends AbstractTenant<USER>> extends AbstractUser<USER, ROLE, PERMISSION> implements TenantEntity<TENANT> {\n\n\n\n\n    ...\n\n\n\n\n}\n\n\n\n\npublic abstract class AbstractUser<USER extends AbstractUser<USER, ROLE, PERMISSION>, ROLE extends AbstractRole<USER, PERMISSION>, PERMISSION extends AbstractPermission<USER>> extends AuditingDateBaseEntity<USER> {\n\n\n\n\n    ...\n\n\n\n\n}\n\n\n\n\npublic abstract class AbstractPermission<USER extends AbstractUser<USER, ?, ?>> extends AuditingDateBaseEntity<USER> {\n\n\n\n\n    ...\n\n\n\n\n}\n\n\n\n\npublic abstract class AuditingDateBaseEntity<USER extends AbstractUser<USER, ?, ?>> extends AbstractDateBaseEntity implements AuditingEntity<USER> {\n\n\n\n\n    ...\n\n\n\n\n}\n\n\n\n\npublic abstract class AbstractDateBaseEntity extends AbstractBaseEntity implements DateEntity {\n\n\n\n\n    ...\n\n\n\n\n}\n\n\n\n\npublic abstract class AbstractBaseEntity implements BaseEntity {\n\n\n\n\n    ...\n\n\n\n\n}\n\n\n\n\n\n\nI hope this gives enough insight into the problem and hopefully you can fix this soon.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.8.0.RELEASE", "fixed_version": "1.7.3.RELEASE", "fixed_files": ["org.springframework.data.util.TypeVariableTypeInformation.java"], "label": 1, "es_results": []}, {"bug_id": 583, "bug_title": "DomainClassConverter#matches should return false when source- and targetType are equal", "bug_description": "I ran into a very peculiar issue today, that was hard to reproduce. In a Spring-MVC app that uses Spring Data JPA and has a DomainClassConverter registered I have a controller method that takes some entity as a model attribute parameter. The entity has a String ID field.\nWhat happens now in some cases (haven&apos;t identified the exact circumstances) is that the entity instance, which is initially created and bound correctly, is ran through the conversion service, which finds the DomainClassConverter which will happily map the entity instance onto another instance of the same type by mapping the instance to a String using the standard ObjectToStringConverter and treating the result as the primary key of the entity type... This results in always getting null passed in as the parameter for the controller method.\nObviously the DomainClassConverter should not be used at all in this scenario.\nFortunately I was able to reproduce the scenario in a simple app (see attachment). It&apos;s really weird: if you remove the extra non-default constructor of the Entity class, for example, you can no longer reproduce the error. Also, if you comment out the spring.version property in the pom, thereby using 4.0.7.RELEASE instead of 4.1.1.RELEASE, you can also not reproduce the error. This might therefore be related to a recent change in Spring Core as well.\nAnyways, there is an easy fix for this issue: the DomainClassConvert#matches method should first check if the source- and targetType are equal and if so, return false: I&apos;d say that no domain class can have itself as its key type and thus it should never attempt to convert these types. \nIf you manage to pinpoint the exact because you might find that there&apos;s a better solution, but this is how I worked around this issue for now.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.8.4.RELEASE", "fixed_version": "1.9.1.RELEASE", "fixed_files": ["org.springframework.data.repository.support.DomainClassConverterUnitTests.java", "org.springframework.data.repository.support.DomainClassConverter.java"], "label": 1, "es_results": []}, {"bug_id": 695, "bug_title": "Potential NullPointerException in AbstractMappingContext", "bug_description": "We found the reported issue upgrading Spring Data MongoDB library from 1.3.5.RELEASE to 1.5.5.RELEASE. The issue is triggered querying a nested generic field qualified with a custom class (not primitive). Following snippet shows the nested field we are trying to query:\n\n\n\n\n\n\npublic class External{\n\n\n\n\n ..\n\n\n\n\n private Optional<Internal> field = new Optional<Internal>();\n\n\n\n\n ..\n\n\n\n\n}\n\n\n\n\n\n\nThe call to mongoOperations throws a NullPointerException originating from AbstractMappingContext. It is a Spring Data Commons class and we noticed that the issue starts from version 1.7.2.RELEASE of this library, just after commit 02046da.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.8.5.RELEASE", "fixed_version": "1.11.0.M1", "fixed_files": ["org.springframework.data.mapping.context.AbstractMappingContextUnitTests.java", "org.springframework.data.mapping.context.AbstractMappingContext.java"], "label": 1, "es_results": []}, {"bug_id": 715, "bug_title": "@Transactional customizations not applied correctly on redeclared methods", "bug_description": "\n\n\n\n\n\npublic interface RepositoryExample extends JpaRepository<User, String>{\n\n\n\n\n\t\n\n\n\n\n        // This Query&apos;s timeout just works \n\n\n\n\n\t@Query(\"FROM User\")\n\n\n\n\n\t@Transactional(timeout = 10,propagation = Propagation.REQUIRED)\n\n\n\n\n\tpublic List<User> findAll2();\n\n\n\n\n\t\n\n\n\n\n        //The query below - timeout doesn&apos;t work , the @Transactional timeout is not being applied\n\n\n\n\n        // Although in the documentation it shows it suppose to work exactly as below \n\n\n\n\n        @Override\t\n\n\n\n\n\t@Transactional(timeout = 10,propagation = Propagation.REQUIRED)\n\n\n\n\n\tpublic List<User> findAll();\n\n\n\n\n}\n\n\n\n\n\n\nRecommendation: In order to debug it put breakpoint in  EntityManagerFactoryUtils.applyTransactionTimeout", "project": "Spring", "sub_project": "DATACMNS", "version": "1.8.5.RELEASE", "fixed_version": "1.9.3.RELEASE", "fixed_files": ["org.springframework.data.repository.core.support.TransactionalRepositoryProxyPostProcessor.java", "org.springframework.data.repository.core.support.TransactionRepositoryProxyPostProcessorUnitTests.java", "org.springframework.data.repository.core.support.RepositoryFactorySupportUnitTests.java", "org.springframework.data.repository.core.support.RepositoryFactorySupport.java"], "label": 1, "es_results": []}, {"bug_id": 717, "bug_title": "AnnotatedTypeScanner does not use context classloader for loading found types", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.8.5.RELEASE", "fixed_version": "1.9.3.RELEASE", "fixed_files": ["org.springframework.data.util.AnnotatedTypeScanner.java"], "label": 1, "es_results": []}, {"bug_id": 719, "bug_title": "Version fails to parse input string with non-numerical suffix", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.8.5.RELEASE", "fixed_version": "1.9.3.RELEASE", "fixed_files": ["org.springframework.data.util.VersionUnitTests.java", "org.springframework.data.util.Version.java"], "label": 1, "es_results": []}, {"bug_id": 565, "bug_title": "Custom repository implementations are not picked up when using CDI", "bug_description": "Custom repository implementations cannot be resolved when using CDI 1.0 because BeanManager.getBeans(... does not provide any beans during AfterBeanDiscovery event.\nSolution: Shift the lookup from AfterBeanDiscovery to the the actual bean creation", "project": "Spring", "sub_project": "DATACMNS", "version": "1.9.0.RC1", "fixed_version": "1.9.0.RELEASE", "fixed_files": ["org.springframework.data.repository.cdi.CdiRepositoryBean.java", "org.springframework.data.repository.cdi.DummyCdiExtension.java", "org.springframework.data.repository.cdi.CdiRepositoryExtensionSupport.java"], "label": 1, "es_results": []}, {"bug_id": 590, "bug_title": "Bug in generics detection for multiply nested generic types", "bug_description": "It fails guess the concrete class of a two level embedded document in a concrete scenario using abstract class with generics.\nThe reference git repository, reproduces this error running unit tests. It also downloads and runs a local MongoDB server using https://github.com/jirutka/embedmongo-Spring plugin.\n", "project": "Spring", "sub_project": "DATACMNS", "version": "1.9.1.RELEASE", "fixed_version": "1.10.0.M1", "fixed_files": ["org.springframework.data.util.ClassTypeInformation.java", "org.springframework.data.util.ParentTypeAwareTypeInformation.java", "org.springframework.data.util.TypeDiscoverer.java", "org.springframework.data.util.TypeDiscovererUnitTests.java", "org.springframework.data.util.ParameterizedTypeUnitTests.java", "org.springframework.data.util.TypeVariableTypeInformation.java", "org.springframework.data.util.ClassTypeInformationUnitTests.java", "org.springframework.data.util.ParameterizedTypeInformation.java", "org.springframework.data.util.GenericArrayTypeInformation.java"], "label": 1, "es_results": []}, {"bug_id": 594, "bug_title": "Strange generics behaviour for multiply nested generic types", "bug_description": "This behaviour was incorrectly reported reopening DATACMNS-590 by me, sorry about that \nAfter the resolution of DATACMNS-590, we found another strange behaviour using Spring Data MongoDB, but only disabling the default type mapper resolution, which resolves the class type to map using an attribute. See github repo and run unit tests.\nI simplify a lot the domain model and use the generics in the minimal expression as possible to reproduce this, and I think now is much easier to understand.\nTake a close look at:\n\nCustomerNonTypedRepositoryTest.testFindOne\nCustomerNonTypedRepositoryTest.testFindOneItem\n\nRetrieving a Customer and navigate to ItemType will lead to a ClassCastException due the lost of generic type. But if we retrieve an Item and navigate to ItemType is ok.\nI know this is a corner case, and as said in DATACMNS-590 this will probably lead into a &apos;work-as-designed&apos; resolution.\nWe can&apos;t use the default type, because we are not using Spring to populate the database, but we think we can workaround this providing a custom type mapper.\nThank you ", "project": "Spring", "sub_project": "DATACMNS", "version": "1.9.1.RELEASE", "fixed_version": "1.10.0.M1", "fixed_files": ["org.springframework.data.util.ClassTypeInformation.java", "org.springframework.data.util.TypeDiscoverer.java", "org.springframework.data.util.ClassTypeInformationUnitTests.java", "org.springframework.data.util.GenericArrayTypeInformation.java", "org.springframework.data.util.ParameterizedTypeInformation.java"], "label": 1, "es_results": []}, {"bug_id": 609, "bug_title": "Multiple usage of repository setup means (XML or annotation) creates multiple bean definitions for RepositoryInterfaceAwareBeanPostProcessor", "bug_description": "Apparently every time the tag jpa:repositories is used in XML files, a new instance of RepositoryInterfaceAwareBeanPostProcessor is created and registered with the bean factory. This is mainly a performance problem because predictBeanType()-method is then called N times for every relevant bean. This can easily be reproduced with the version 51d1c5d of git@github.com:spring-projects/spring-data-jpa-examples.git by adding an extra stanza like <jpa:repositories base-package=\"org.springframework.dummy\" /> to simple-repository-context.xml and running XmlConfigCachingRepositoryTests.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.9.1.RELEASE", "fixed_version": "1.10.0.M1", "fixed_files": ["org.springframework.data.repository.config.RepositoryConfigurationExtensionSupport.java", "org.springframework.data.repository.config.RepositoryConfigurationExtensionSupportUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 640, "bug_title": "Possible NullPointerException on PageableHandlerMethodArgumentResolver when fallbackPageable is null", "bug_description": "If {fallbackPageable}} is set to null, but a specific page is requested without a valid sort parameter, a NullPointerException is thrown as the resolver tries to fetch the default sort from the fallbackPageable in the end (if no sort is determined yet). Case recap: page and size are given, sort is not.\nProblem situated on line 249 in 1.9.1 source of PageableHandlerMethodArgumentResolver. As far as I can tell possible issue is still there in recent code base.\nThis is in fact blocking in situations where no valid sort properties are available. There is also no valid workaround to have the SortHandlerMethodArgumentResolver return an \"empty\" (but not null) sort instance.\nApart from the bug, possible improvement:\nMy case is as follows: for some controllers the paging settings are stored on the user profile.  If no actual pageable is defined, use the default from the user profile.  \nWith the current code base there appears to be no way to determine if the pageable you receive is the actual fallback pageable. Since new pageable instances get created, you cannot distinguish between the fallback and a manually selected version with the same parameters. Null would be the only - and acceptable - solution for this, but then you are forced to configure this globally on the resolver level.  An improvement could also be to have a null default pageable configurable on controller parameter.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.9.2.RELEASE", "fixed_version": "1.10.0.RC1", "fixed_files": ["org.springframework.data.web.PageableHandlerMethodArgumentResolverUnitTests.java", "org.springframework.data.web.PageableHandlerMethodArgumentResolver.java"], "label": 1, "es_results": []}, {"bug_id": 648, "bug_title": "o.s.d.r.q.Parameters prevents custom classloader from being garbage collected", "bug_description": "Parameters creates a static DefaultParameterNameDiscoverer, wich adds a LocalVariableTableParameterNameDiscoverer to its list of ParameterNameDiscoverers.\nThis LVTPND holds a Map with a class as a key.\nAs I said, I&apos;m using a custom classloaders for a kind of plugin-based application.\nThe problem is, since Repository-subclasses stay in the LVTPND&apos;s parameterNamesCache, the custom classloader who loaded the Repository can never be GC&apos;ed.\nI Am not sure about if this issue should be fixed in Spring Data Commons or in LocalVariableTableParameterNameDiscoverer by using a WeakHashMap for parameterNamesCache.\nRegards\nMatthias", "project": "Spring", "sub_project": "DATACMNS", "version": "1.9.2.RELEASE", "fixed_version": "1.9.3.RELEASE", "fixed_files": ["org.springframework.data.repository.query.Parameters.java"], "label": 1, "es_results": []}, {"bug_id": 663, "bug_title": "Typo in method in BytecodeGeneratingEntityInstantiator", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.10.0.RELEASE", "fixed_version": "1.11.0.M1", "fixed_files": ["org.springframework.data.convert.BytecodeGeneratingEntityInstantiator.java"], "label": 1, "es_results": []}, {"bug_id": 683, "bug_title": "Enabling Spring Data web support breaks @ModelAttribute binding in Spring MVC", "bug_description": "Given following Java config class\n\n\n\n\n\n\npackage be.vdab.web;\n\n\n\n\n\n\n\n\n\nimport org.springframework.context.annotation.ComponentScan;\n\n\n\n\nimport org.springframework.context.annotation.Configuration;\n\n\n\n\nimport org.springframework.data.web.config.EnableSpringDataWebSupport;\n\n\n\n\nimport org.springframework.web.servlet.config.annotation.EnableWebMvc;\n\n\n\n\nimport org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;\n\n\n\n\n\n\n\n\n\n// enkele imports\n\n\n\n\n@Configuration\n\n\n\n\n@EnableWebMvc\n\n\n\n\n@EnableSpringDataWebSupport\n\n\n\n\n@ComponentScan\n\n\n\n\npublic class CreateControllerBeans extends WebMvcConfigurerAdapter {\n\n\n\n\n}\n\n\n\n\n\n\n, following Controller class\n\n\n\n\n\n\npackage be.vdab.web;\n\n\n\n\n\n\n\n\n\nimport org.springframework.stereotype.Controller;\n\n\n\n\nimport org.springframework.web.bind.annotation.ModelAttribute;\n\n\n\n\nimport org.springframework.web.bind.annotation.RequestMapping;\n\n\n\n\nimport org.springframework.web.bind.annotation.RequestMethod;\n\n\n\n\nimport org.springframework.web.servlet.ModelAndView;\n\n\n\n\n\n\n\n\n\nimport be.vdab.entities.Person;\n\n\n\n\n\n\n\n\n\n@Controller\n\n\n\n\n@RequestMapping(value = \"/\")\n\n\n\n\npublic class PersonController {\n\n\n\n\n\tprivate static final String TOEVOEGEN_VIEW = \"/WEB-INF/JSP/index.jsp\";\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t@RequestMapping(method=RequestMethod.GET)\n\n\n\n\n\tModelAndView get() {\n\n\n\n\n\t\treturn new ModelAndView(TOEVOEGEN_VIEW).addObject(new Person());\n\n\n\n\n\t}\n\n\n\n\n\t\n\n\n\n\n\t@RequestMapping(method = RequestMethod.POST)\n\n\n\n\n\tString post(@ModelAttribute Person person) {\n\n\n\n\n\t  if (person == null) {\n\n\n\n\n\t\t  throw new IllegalArgumentException(\"person IS NULL\");\n\n\n\n\n\t  }\n\n\n\n\n\t  return \"redirect:/\";\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n}\n\n\n\n\n\n\nand following JSP\n\n\n\n\n\n\n<%@page contentType=\"text/html\" pageEncoding=\"UTF-8\" session=\"false\"%>\n\n\n\n\n<%@taglib prefix=\"form\" uri=\"http://www.springframework.org/tags/form\" %>\n\n\n\n\n<!doctype html>\n\n\n\n\n<html lang=\"nl\">\n\n\n\n\n<head>\n\n\n\n\n<title>Add person</title>\n\n\n\n\n</head>\n\n\n\n\n<body>\n\n\n\n\n<form:form action=\"\" method=\"post\" commandName=\"person\">\n\n\n\n\n<form:label path=\"name\">Name:</form:label>\n\n\n\n\n<form:input path=\"name\" autofocus=\"true\"/>\n\n\n\n\n<input type=\"submit\">\n\n\n\n\n</form:form>\n\n\n\n\n</body>\n\n\n\n\n</html>\n\n\n\n\n\n\nthe method post in PersonController throws the InvalidArgumentException because the person parameter is null.\nObservation 1:\nThis worked up to and including spring-data-jpa 1.7.2.RELEASE\nObservation 2:\nThe bug disappears when @EnableSpringDataWebSupport is put in comment in CreateControllerBeans.java\nObservation 3:\nThe bug disappears when @ModelAttribute is put in comment in PersonController.java\nYou can clone a project that shows the bug from\nhttps://github.com/desmethans/springDataJpaError.git", "project": "Spring", "sub_project": "DATACMNS", "version": "1.10.0.RELEASE", "fixed_version": "1.11.0.M1", "fixed_files": ["org.springframework.data.repository.support.DomainClassConverterUnitTests.java", "org.springframework.data.repository.support.DomainClassConverter.java"], "label": 1, "es_results": []}, {"bug_id": 697, "bug_title": "Field-local generics information not honored", "bug_description": "In my project, we have an entity called NormalizedProfile, which is a huge collection of generic ListField s. Each listField is a list of Value s plus some metadata. And Value is a (well) single \"value\" plus some metadata. In our case, atomic \"value\" is either primitive wrapper, Object or Enum, never a collection (in case it is relevant).\nValue<T> gets its generic type from ListField<T> it is enclosed in. Nothing fancy.\nIn addition to standard java SpringDataMongo config, we customise MappingMongoConverter to stop save and use \"_class\" field. No polymorphic behaviour is needed in our case, so why not.\nProblem is with Object- and Enum- generalized ListField s. After they are saved, they never read as a real object and returned as LHM instead. When I use java.util.List instead of our custom structure, everything works fine.\nPlease see attached minimal test - j.you.List<Education> testcase succeeds and ListField<Education> fails.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.10.0.RELEASE", "fixed_version": "1.11.0.M1", "fixed_files": ["org.springframework.data.util.TypeDiscoverer.java", "org.springframework.data.util.ParameterizedTypeUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 711, "bug_title": "DomainClassConverter triggered unnecessarily", "bug_description": "DomainClassConverter wrongfully triggers on form submits. I have a controller, which accepts a filled out Entity as a form \n@RequestMapping(value=\"entity/edit\", method=RequestMethod.POST)\npublic String modifyEntity(@Validated(Edit.class) Entity entity){\nMVC builds a Detached Entity, and does a check if a conversion via the ConversionService must take place. The conversion goes from com.mycompany.myproject.domain.Entity to @Validated com.mycompany.myproject.domain.Entity. It goes through every registered converter to see if someone wishes to perform this conversion. So far so good.\nNow DomainClassConverter.ToIdConverter checks if it can convert Entity to @Validated Entity. It agrees that it can not, however it then reduces the source entity to its ID, and begins a brand new search by the converters to see if Entity&apos;s String id can be converted to Entity. Of course it finds  the DomainClassConverter.ToEntityConverter. \nThus the DomainClassConvert.ToIdConverter is found as a legitimate converter for Entity->@Validated Entity. When it is asked to do this convertion, it doesn&apos;t match them as equals, being as they have different annotations, and actually invokes DomainClassConvert.ToEntityConverter which does a callback to the database etc. etc. etc.\nThere are of course two problems with this. Most importantly, it discards any of the changes. Secondly, since my Entity has a collection, and the DomainClassConverter loads the Entity in its own transaction, which is commited and closed by the time the Controller is called, any work on the collection results in a org.hibernate.LazyInitializationException. \nBasically, I am now disabling DomainClassConverter, until this is fixed. I think the way to fix it, is to do more intelligent TypeDescriptor comparisons in the convert method. Alternatively, some way to disable DomainClassConverter from activating on a specific controller, or just only focusing on IdToEntity, and never EntityToId", "project": "Spring", "sub_project": "DATACMNS", "version": "1.10.0.RELEASE", "fixed_version": "1.10.1.RELEASE", "fixed_files": ["org.springframework.data.repository.support.DomainClassConverterUnitTests.java", "org.springframework.data.repository.support.DomainClassConverter.java"], "label": 1, "es_results": []}, {"bug_id": 720, "bug_title": "Explicit transaction configuration is not considered if default transactions are disabled", "bug_description": "", "project": "Spring", "sub_project": "DATACMNS", "version": "1.10.0.RELEASE", "fixed_version": "1.10.1.RELEASE", "fixed_files": ["org.springframework.data.repository.core.support.TransactionalRepositoryFactoryBeanSupport.java", "org.springframework.data.repository.core.support.TransactionalRepositoryProxyPostProcessor.java", "org.springframework.data.repository.core.support.TransactionRepositoryFactoryBeanSupportUnitTests.java", "org.springframework.data.repository.core.support.TransactionRepositoryProxyPostProcessorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 722, "bug_title": "ProxyProjectionFactory does not handle arrays correctly", "bug_description": "The ProxyProjectionFactory currently does not handle primitive and non-primitive arrays correctly.", "project": "Spring", "sub_project": "DATACMNS", "version": "1.10.0.RELEASE", "fixed_version": "1.10.1.RELEASE", "fixed_files": ["org.springframework.data.projection.ProxyProjectionFactoryUnitTests.java", "org.springframework.data.projection.ProjectingMethodInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 860, "bug_title": "EntityAccess::boxPrimitiveArray throws NPE", "bug_description": "When a custom query returns null for a field which is a collection type in the corresponding @QueryResult object, org.neo4j.ogm.annotations.EntityAccess::boxPrimitiveArray throws an NPE (as it tries to box a null).\n", "project": "Spring", "sub_project": "DATAGRAPH", "version": "4.1.1.RELEASE", "fixed_version": "4.1.2.RELEASE", "fixed_files": ["org.springframework.data.neo4j.queries.QueryIntegrationTest.java", "org.springframework.data.neo4j.examples.movies.domain.queryresult.EntityWrappingQueryResult.java", "org.springframework.data.neo4j.examples.movies.repo.UserRepository.java"], "label": 1, "es_results": []}, {"bug_id": 861, "bug_title": "@QueryResult is not working for field \"id\"", "bug_description": "I have a class annotated with @QueryResult and a field id of type Long:\n\n\n\n\n\n\n@QueryResult\n\n\n\n\npublic class MappingTest {\n\n\n\n\n\n\n\n\n\n    private Long id;\n\n\n\n\n\n\n\n\n\n    public Long getId() {\n\n\n\n\n        return this.id;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    public void setId( final Long id ) {\n\n\n\n\n        this.id = id;\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nIn my domain objects the id-property is annotated with @GraphId\nIn a GraphRepository i have a annotated query method:\n\n\n\n\n\n\n    @Query(\"MATCH (a:Attribute) RETURN id(a) as id\")\n\n\n\n\n    Iterable<MappingTest> testMe();\n\n\n\n\n\n\nWhen this method is executed i get an list with objects and the id property of each object is null. When i rename the property everything is ok.\nIn the code i found that in org.neo4j.ogm.metadata.ClassInfo.propertySetters() there is the following check\n\n\n\n\n\n\n!methodInfo.getName().equals(identitySetter.getName())\n\n\n\n\n\n\nDue to this check the propertySetters() method returns an empty Collection and later on no property-writer is created and the property is not set.", "project": "Spring", "sub_project": "DATAGRAPH", "version": "4.1.1.RELEASE", "fixed_version": "4.1.2.RELEASE", "fixed_files": ["org.springframework.data.neo4j.queries.QueryIntegrationTest.java", "org.springframework.data.neo4j.examples.movies.repo.UserRepository.java", "org.springframework.data.neo4j.examples.movies.domain.queryresult.UserQueryResult.java"], "label": 1, "es_results": []}, {"bug_id": 865, "bug_title": "Spurious warnings related to enum classes", "bug_description": "Neo4jPersistentProperty logs spurious WARN messages when parsing properties that are enums, for example:\n\n\n\n\n\n\n2016-05-06 15:25:32,532  WARN ta.neo4j.mapping.Neo4jPersistentProperty:  88 - No identity field found for class of type: java.lang.Enum when creating persistent property for field: private final java.lang.String java.lang.Enum.name\n\n\n\n\n2016-05-06 15:25:32,535  WARN ta.neo4j.mapping.Neo4jPersistentProperty:  88 - No identity field found for class of type: java.lang.Enum when creating persistent property for field: private final int java.lang.Enum.ordinal\n\n\n\n\n2016-05-06 15:25:32,536  WARN ta.neo4j.mapping.Neo4jPersistentProperty:  88 - No identity field found for class of type: java.lang.Enum when creating persistent property for field: null\n\n\n\n\n2016-05-06 15:25:32,539  WARN ta.neo4j.mapping.Neo4jPersistentProperty:  88 - No identity field found for class of type: org.springframework.data.neo4j.examples.movies.domain.queryresult.Gender when creating persistent property for field: private final java.lang.String java.lang.Enum.name\n\n\n\n\n2016-05-06 15:25:32,540  WARN ta.neo4j.mapping.Neo4jPersistentProperty:  88 - No identity field found for class of type: org.springframework.data.neo4j.examples.movies.domain.queryresult.Gender when creating persistent property for field: private final int java.lang.Enum.ordinal\n\n\n\n\n2016-05-06 15:25:32,540  WARN ta.neo4j.mapping.Neo4jPersistentProperty:  88 - No identity field found for class of type: org.springframework.data.neo4j.examples.movies.domain.queryresult.Gender when creating persistent property for field: null\n\n\n\n\n\n\nEnums are not persistable as nodes or edges, only as properties. They don&apos;t require an id.", "project": "Spring", "sub_project": "DATAGRAPH", "version": "4.1.1.RELEASE", "fixed_version": "4.1.3.RELEASE", "fixed_files": ["org.springframework.data.neo4j.mapping.Neo4jPersistentProperty.java"], "label": 1, "es_results": []}, {"bug_id": 893, "bug_title": "Repository methods that return an @QueryResult do not support paging", "bug_description": "Repository methods that return an @QueryResult don&apos;t support paging. ", "project": "Spring", "sub_project": "DATAGRAPH", "version": "4.2.0.M1", "fixed_version": "4.2.0.RC1", "fixed_files": ["org.springframework.data.neo4j.queries.PagedQueryIT.java", "org.springframework.data.neo4j.repository.query.GraphRepositoryQuery.java", "org.springframework.data.neo4j.examples.movies.domain.Cinema.java", "org.springframework.data.neo4j.examples.movies.repo.CinemaRepository.java", "org.springframework.data.neo4j.web.domain.Cinema.java", "org.springframework.data.neo4j.repository.query.QueryResultGraphRepositoryQuery.java"], "label": 1, "es_results": []}, {"bug_id": 895, "bug_title": "Auto-paging does not work when @Query ends with ';' ", "bug_description": "Auto-paging was added in 4.1.2, however an error occurs when the specified @Query ends with &apos;;&apos; \nArguably this should not be the case. ", "project": "Spring", "sub_project": "DATAGRAPH", "version": "4.2.0.M1", "fixed_version": "4.2.0.RC1", "fixed_files": ["org.springframework.data.neo4j.repository.query.QueryResultGraphRepositoryQuery.java", "org.springframework.data.neo4j.repository.query.GraphRepositoryQuery.java", "org.springframework.data.neo4j.examples.movies.repo.CinemaRepository.java"], "label": 1, "es_results": []}, {"bug_id": 896, "bug_title": "Neo4jRepositoryFactoryBean should declare mappingContext as auto-wired", "bug_description": "Neo4jRepositoryFactoryBean should declare mappingContext as auto-wired. Without doing this tests in spring-data-rest will fail. \nIt is not possible to explicitly wire this component in the down-stream project unless the package level access restriction is removed (an alternative. ", "project": "Spring", "sub_project": "DATAGRAPH", "version": "4.2.0.M1", "fixed_version": "4.2.0.RC1", "fixed_files": ["org.springframework.data.neo4j.repository.support.Neo4jRepositoryFactoryBean.java", "org.springframework.data.neo4j.repository.query.QueryResultGraphRepositoryQuery.java", "org.springframework.data.neo4j.queries.PagedQueryIT.java", "org.springframework.data.neo4j.repository.query.GraphRepositoryQuery.java"], "label": 1, "es_results": []}, {"bug_id": 920, "bug_title": "Allow SDN to work at the same time with other Spring Data projects.", "bug_description": "SDN does not work with other Spring Data projects due to issues with MappingContext.\nThis is a regression done from another piece of work.", "project": "Spring", "sub_project": "DATAGRAPH", "version": "4.2.0.M1", "fixed_version": "4.2.0.RC1", "fixed_files": ["org.springframework.data.neo4j.repository.support.Neo4jRepositoryFactoryBean.java", "org.springframework.data.neo4j.repository.config.Neo4jRepositoryConfigurationExtension.java"], "label": 1, "es_results": []}, {"bug_id": 23, "bug_title": "Creating queries from method names with IsNull and IsNotNull is broken", "bug_description": "In JpaQueryCreator&apos;s toPredicate() method instead of following lines\n\n\n\n\n\n\n        case IS_NULL:\n\n\n\n\n            return root.isNull();\n\n\n\n\n        case IS_NOT_NULL:\n\n\n\n\n            return root.isNotNull();\n\n\n\n\n\n\nshould be\n\n\n\n\n\n\n        case IS_NULL:\n\n\n\n\n            return path.isNull();\n\n\n\n\n        case IS_NOT_NULL:\n\n\n\n\n            return path.isNotNull();\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.query.JpaQueryCreator.java"], "label": 1, "es_results": []}, {"bug_id": 58, "bug_title": "Persistable.isNew is not used by JpaPersistableEntityInformation", "bug_description": "The isNew()  method is not used by JpaPersistableEntityInformation , which causes unwanted behavior in Repository.save() \nJpaPersistableEntityInformation  should extend PersistableEntityInformation instead of AbstractEntityInformation", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.support.JpaPersistableEntityInformation.java"], "label": 1, "es_results": []}, {"bug_id": 68, "bug_title": "AuditingEntityListener problem with determining if entity is new", "bug_description": "Actually ran into this problem in the Hades library but I see the code is still the same.  Using EclipseLink (2.1.3), the id is already set on the entity when it is passed to the method annotated with @PrePersist and @PreUpdate so calling isNew() on the entity to determine if the creation audits should be applied doesn&apos;t work (always returns false).  I suggest splitting the @PrePersist and @PreUpdate to separate methods and not using isNew().", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.data.jpa.domain.support.AuditingEntityListener.java", "org.springframework.data.jpa.domain.support.AuditingEntityListenerUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 77, "bug_title": "Count query for manually declared queries (either @Query or NamedQuery) get pagination applied", "bug_description": "When executing a paging query the executing infrastructure triggers a count query to compute the number of overall results. If you define the query manually by using @Query or via a JPA NamedQuery the count query generation seems to also get the pagination information applied (see forum post for example).\nThis seems to boil down to SimpleJpaQuery.createCountQuery(...) calling ParameterBinder.bindAndPrepare(...) instead of prepare(...) as the former call applies pagination information to the query.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.SimpleJpaQuery.java", "org.springframework.data.jpa.repository.query.SimpleJpaQueryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 94, "bug_title": "Sort order inside Pageable is not respected on PartTree generated queries", "bug_description": "Here is a test method for UserRepositoryFinderTests \n\n\n\n\n\n\n\n\n\n\n\n@Test\n\n\n\n\npublic void respectsPageableOrder() throws Exception {\n\n\n\n\n\tPage<User> ascending = userRepository.findByLastname(new PageRequest(0, 10, new Sort(Direction.ASC, \"lastname\")),\"Matthews\");\n\n\n\n\n\tPage<User> descending = userRepository.findByLastname(new PageRequest(0, 10, new Sort(Direction.DESC, \"lastname\")),\"Matthews\");\n\n\n\n\n\tassertThat(ascending.getTotalElements(), is(2L));\n\n\n\n\n\tassertThat(descending.getTotalElements(), is(2L));\n\n\n\n\n\tassertThat(ascending.getContent().get(0).getFirstname(), is(not(equalTo(descending.getContent().get(0).getFirstname()))));\n\n\n\n\n\tassertThat(ascending.getContent().get(0).getFirstname(), is(equalTo(descending.getContent().get(1).getFirstname())));\n\n\n\n\n\tassertThat(ascending.getContent().get(1).getFirstname(), is(equalTo(descending.getContent().get(0).getFirstname())));\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryFinderTests.java", "org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.query.PartTreeJpaQuery.java"], "label": 1, "es_results": []}, {"bug_id": 96, "bug_title": "Invalid use of part.getProperty().toDotPath() in JpaQueryCreator", "bug_description": "As explained in great details in the forum (see reference). Short Summary: \nAll usages of part.getProperty().toDotPath() in JpaQueryCreator are invalid because the persistence provider expects single attributes and not object graphs as input of get() method.\nHappens with LIKE, NOT_LIKE, BETWEEN and perhaps in other places too.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.JpaQueryCreator.java"], "label": 1, "es_results": []}, {"bug_id": 86, "bug_title": "find-Method throws exception when a group-by-clause is used", "bug_description": "When using a repository to get a Page object with this method Page<T> findAll(Specification<T> specification, Pageable pageable) two queries are generated. A count-Query to get the total number of results and the actual query to get the results for the page. When the specification-parameter contains a group by-clause the count-query throws an exception org.springframework.dao.IncorrectResultSizeDataAccessException result returns more than one elements). The problem is that the group by-clause returns more than one result row for the count query and only a single result with one number is expected.\nExample:\n\n\n\n\n\n\nSELECT DISTINCT COUNT(id) FROM Table WHERE value > 70 GROUP BY name;\n\n\n\n\n\n\nResult:\n4 (for name1)\n7 (for name2)\n2 (for name3)\nSo if there&apos;s more than one result being returned from the count query we actually have to consider the size of the list instead of the value returned.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.0.RC1", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.NamedQuery.java", "org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.query.SimpleJpaQueryUnitTests.java", "org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.query.JpaQueryExecution.java", "org.springframework.data.jpa.repository.query.SimpleJpaQuery.java", "org.springframework.data.jpa.repository.query.ParameterBinder.java", "org.springframework.data.jpa.repository.query.AbstractJpaQuery.java", "org.springframework.data.jpa.repository.query.JpaQueryExecutionUnitTests.java", "org.springframework.data.jpa.repository.query.PartTreeJpaQuery.java"], "label": 1, "es_results": []}, {"bug_id": 110, "bug_title": "Error identifying 'alias' when the entity's name has numbers", "bug_description": "When a query is generated by spring-data, an error is provocated by org.springframework.data.jpa.repository.query.QueryUtils because does not recognize names of entities containing numbers. Example of entity name: T05User.\nThe error is on line 57 of class QueryUtils, the pattern does not match with words that contains numbers.\n\n\n\n\n\n\nprivate static final String IDENTIFIER = \"[\\\\p{L}._$]+\";\n\n\n\n\n\n\nA proposed solution is\n\n\n\n\n\n\nprivate static final String IDENTIFIER = \"[\\\\p{L}(\\\\d*)._$]+\";\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 111, "bug_title": "The SimpleJpaRepository's deleteAll() should not call them.clear().", "bug_description": "Now, the SimpleJpaRepository&apos;s deleteAll() calls them.clear(). So, If I use B.deleteAll() after A.insert(), the insertion of A is ignored.\n\n\n\n\n\n\n@Transactional\n\n\n\n\npublic void doSomething() {\n\n\n\n\n  Book springBook = new Book(\"spring\");\n\n\n\n\n  bookRepository.save(springBook);\n\n\n\n\n  \n\n\n\n\n  CardRepository.deleteAll();\n\n\n\n\n  \n\n\n\n\n  //then, the springBook will not be inserted to the DB, because in the deleteAll(), them.clear() is called.\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.support.SimpleJpaRepository.java"], "label": 1, "es_results": []}, {"bug_id": 120, "bug_title": "@OneToOne mappings in AbstractAuditable should rather be @ManyToOne ones", "bug_description": "", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.domain.AbstractAuditable.java"], "label": 1, "es_results": []}, {"bug_id": 138, "bug_title": "MergingPersistenceUnitManager does not work with Spring 3.1.0 DefaultPersistenceUnitManager", "bug_description": "The following check in DefaultPersistenceUnitManager of Spring ORM 3.1.0.RELEASE defeats the purpose of the merge using the same persistence unit name:\n\n\n\n\n\n\nString name = pui.getPersistenceUnitName();\n\n\n\n\nif (!this.persistenceUnitInfoNames.add(name)) {\n\n\n\n\n\tStringBuilder message = new StringBuilder();\n\n\n\n\n\tmessage.append(\"Conflicting persistence unit definitions for name &apos;\").append(name).append(\"&apos;: \");\n\n\n\n\n\tmessage.append(pui.getPersistenceUnitRootUrl()).append(\", \");\n\n\n\n\n\tmessage.append(this.persistenceUnitInfos.get(name).getPersistenceUnitRootUrl());\n\n\n\n\n\tthrow new IllegalStateException(message.toString());\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.1.RELEASE", "fixed_version": "1.0.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.support.MergingPersistenceUnitManager.java", "org.springframework.data.jpa.support.MergingPersistenceUnitManagerUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 141, "bug_title": "JpaMetamodelEntityInformation cannot deal with mapped superclasses", "bug_description": "Currently repository interfaces cannot be used with a @MappedSuperclass annotated JPA entity class as we try to lookup an EntityType from the EntityManager&apos;s Metamodel which MappedSuperclass aren&apos;t. We should rather use .managedType() and see if it implements IdentitifiedType to look for id information.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.2.RELEASE", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.support.JpaPersistableEntityInformationUnitTests.java", "org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation.java"], "label": 1, "es_results": []}, {"bug_id": 142, "bug_title": "Invalid count query generated when using Pageable and NamedQuery with existing order by", "bug_description": "Taking:\n\n\n\n\n\n\n@NamedQuery(name = \"Test.findQuery\", query = \"from Test te where te.name like ?1 order by te.name desc\")\n\n\n\n\n\n\nAnd executing using:\n\n\n\n\n\n\nrepository.findQuery(name, new PageRequest(0, 5));\n\n\n\n\n\n\nResults in:\n\n\n\n\n\n\norg.springframework.orm.hibernate3.HibernateJdbcException: \n\n\n\n\nJDBC exception on Hibernate data access: \n\n\n\n\nSQLException for SQL [select count(test0_.id) as col_0_0_ from test test0_ where test0_.name=? order by test0_.name desc]; \n\n\n\n\nSQL state [null]; \n\n\n\n\nerror code [0]; could not execute query; \n\n\n\n\nnested exception is org.hibernate.exception.GenericJDBCException: could not execute query...\n\n\n\n\n\n\nI&apos;m in 2 minds whether this is actually \"correct\" behaviour and whether there can be a more friendly/elegant way of warning or erroring out upfront if pageable requests are made on a named query with ordering etc. or whether the count query should be amended to exclude the order by (though there are probably a myriad of edge case scenarios that would then need to be catered for.)\nOr is it just a case of &apos;caveat emptor&apos; when mapping to a named query and using pageable finders? I&apos;d hope there was some middle ground!", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.2.RELEASE", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.query.NamedQuery.java", "org.springframework.data.jpa.repository.query.NamedQueryUnitTests.java", "org.springframework.data.jpa.repository.query.JpaQueryMethod.java", "org.springframework.data.jpa.repository.query.JpaQueryMethodUnitTests.java", "org.springframework.data.jpa.repository.Query.java"], "label": 1, "es_results": []}, {"bug_id": 137, "bug_title": "deleteAll() - generated bulk delete queries do not respect cascade delete", "bug_description": "delete from %s x does not respect cascade delete operations (with hibernate at least).\nPerforming:\n\n\n\n\n\n\nfor(T entity : this.findAll()) {\n\n\n\n\n    delete(entity);\n\n\n\n\n}\n\n\n\n\n\n\nOperates as expected - though obviously looses the efficiency of the bulk query.\nAdditionally, attempting to do:\n\n\n\n\n\n\ndelete(findAll())\n\n\n\n\n\n\nWill fail if there is a cascade delete dependency between objects of the same type:\n\"deleted instance passed to merge\"\nAs the check:\n\n\n\n\n\n\nthem.remove(them.contains(entity) ? entity : them.merge(entity));\n\n\n\n\n\n\nCorrectly establishes the entity no longer exists and attempts to do a merge instead (not entirely sure why as if it doesn&apos;t exist in the persistence context and we&apos;re attempting to delete it a merge has no purpose?). Surely:\n\n\n\n\n\n\nif(them.contains(entity)) {\n\n\n\n\n    them.remove(entity);\n\n\n\n\n}\n\n\n\n\n\n\nIs the correct functionality here?", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.2.RELEASE", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.JpaRepository.java", "org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.support.SimpleJpaRepository.java"], "label": 1, "es_results": []}, {"bug_id": 148, "bug_title": "Sort with aggregate properties results in an invalid alias being generated and added to the query", "bug_description": "I have defined an @Query annotation on a repository query which is aggregating data, but would like to offer the ability to sort on different aggregates in the data. When adding an aggregate statement as a Sort property, Spring Data JPA is automatically adding on an object alias which will cause a completely incorrect query to generate.\nExample to replicate:\n\nUse the following @Query: select sum(sessionTime),sum(inputSize),sum(outputSize) from RawData where beginDate between ? and ? group by username\nCall: myRepository.customQuery(beginDate,endDate,new Sort(\"sum(sessionTime\"));\n\nResults in following query being generated: select sum(sessionTime),sum(inputSize),sum(outputSize) from RawData where eventDate between ? and ? group by username order by where.sum(sessionTime) asc\n\n\n\nNote that the order by clause generates as: where .sum(sessionTime) asc\nResolving this may be possible through a simple check to see if the property contains a parenthesis that would seem to indicate it is an aggregate.  If it is detected as an aggregate, the alias addition would be skipped during the order by statement generation.\nExample patch:\n\n\n\n\n\n\n*** QueryUtils.java     2012-01-04 16:10:59.000000000 -0600\n\n\n\n\n--- QueryUtils.java     2012-01-04 16:11:15.000000000 -0600\n\n\n\n\n***************\n\n\n\n\n*** 136,142 ****\n\n\n\n\n                builder.append(\" order by\");\n\n\n\n\n\n\n\n\n\n                for (Order order : sort) {\n\n\n\n\n!                       builder.append(String.format(\" %s.%s %s,\", alias, order.getProperty(), toJpaDirection(order)));\n\n\n\n\n                }\n\n\n\n\n\n\n\n\n\n                builder.deleteCharAt(builder.length() - 1);\n\n\n\n\n--- 136,145 ----\n\n\n\n\n                builder.append(\" order by\");\n\n\n\n\n\n\n\n\n\n                for (Order order : sort) {\n\n\n\n\n!                       if (order.getProperty().contains(\"(\"))\n\n\n\n\n!                               builder.append(String.format(\" %s %s,\", order.getProperty(), toJpaDirection(order)));\n\n\n\n\n!                       else\n\n\n\n\n!                               builder.append(String.format(\" %s.%s %s,\", alias, order.getProperty(), toJpaDirection(order)));\n\n\n\n\n                }\n\n\n\n\n\n\n\n\n\n                builder.deleteCharAt(builder.length() - 1);\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.2.RELEASE", "fixed_version": "1.3.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 169, "bug_title": "JPA Repository can get typing of @Query annotated findXXX methods wrong", "bug_description": "If I have an entity with a getter containing a set (of itself in this case - it&apos;s a tree structure):\n\n\n\n\n\n\n    @ManyToMany(fetch=FetchType.EAGER)\n\n\n\n\n    @JoinTable(\n\n\n\n\n        name=\"ancestors\",\n\n\n\n\n        joinColumns=@JoinColumn(name=\"entity_id\"),\n\n\n\n\n        inverseJoinColumns=@JoinColumn(name=\"entity_ancestor_id\")\n\n\n\n\n    )\n\n\n\n\n    public Set<TreeEntity> getAncestors() {\n\n\n\n\n        return ancestors;\n\n\n\n\n    }\n\n\n\n\n\n\nand I have a method on my repository:\n\n\n\n\n\n\n    @Query(\"select \" +\n\n\n\n\n            \"    distinct entity.ancestors \" +\n\n\n\n\n            \"from \" +\n\n\n\n\n            \"    example.data.TreeEntity entity \" +\n\n\n\n\n            \"where \" +\n\n\n\n\n            \"    entity.id = :entityId\")\n\n\n\n\n    public List<TreeEntity> findAncestors(@Param(\"entityId\") Long groupId);\n\n\n\n\n\n\nthen in 1.1.0 RC1, when the query is parsed, it believes that the signature of the method should return List<Set<TreeEntity>>, when in fact the query will really return a List<Group>. 1.0.3 got this correct, and so it&apos;s a regression.\nI attach a very basic Maven project which shows the problem. Changing the version back to 1.0.3 gets the query typing correct.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.1.0.RC1", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.query.SimpleJpaQuery.java"], "label": 1, "es_results": []}, {"bug_id": 189, "bug_title": "MergingPersistenceUnitManager potentially adds classes multiple times", "bug_description": "MergingPersistenceUnitManager does not guard against the the new PUI&apos;s root URL bing equivalent to the old ones. In this case the old PUIs root URL gets added to the list of JAR file URLs but does not get removed as root URL which might cause persistence providers (e.g. Hibernate) because complaining about duplicate entries. ", "project": "Spring", "sub_project": "DATAJPA", "version": "1.0.3.RELEASE", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.data.jpa.support.MergingPersistenceUnitManager.java", "org.springframework.data.jpa.support.MergingPersistenceUnitManagerUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 186, "bug_title": "Typos in log message when named query is used with a Pageable", "bug_description": "Create a repository method as follows:\n\npublic interface UserRepository extends JpaRepository<User, Long>\n{\n    Page<User> findAllByNameLike(String name, Pageable page);\n}\nWhen the application context is initialized, the following message appears in the logs:\n\nINFO Finder method org.example.data.UserRepository.findAllByNameLike is backed by a NamedQuery but contains a Pageble parameter! Sorting deliviered via this Pageable will not be applied!\nThis message has two typos Pageble and deliviered.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.1.0.RC1", "fixed_version": "1.0.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.NamedQuery.java"], "label": 1, "es_results": []}, {"bug_id": 268, "bug_title": "LockModePopulatingMethodInterceptor leak causes OutOfMemoryError: PermGen space", "bug_description": "In cases where locking is not externally set (like when invoking it form a non @Transactional call stack) org.springframework.data.jpa.repository.support.LockModeRepositoryPostProcessor.LockModePopulatingMethodIntercceptor.invoke(MethodInvocation) is registering the locking mode itself (with the target method as key) using org.springframework.transaction.support.TransactionSynchronizationManager.bindResource(Object, Object), but is not calling org.springframework.transaction.support.TransactionSynchronizationManager#unbindResource(Object) afterwards.\nIn environments where the classloaders are discarded but the threads are reused, like in any application or web server with a service thread pool and hot redeployments, the VM ends up running out of PermGen space since \n{@link java.lang.Thread#threadLocals}\n will keep a strong reference to the bound method keeping alive the otherwise unused class loader and all its, classes and objects graph.\nSorry about the test case, it was written in a rush.\nHeap dump can be found here (18Mb): https://dl.dropbox.com/you/1249691/LockModeRepositoryPostProcessor_LockModePopulatingMethodIntercceptorMemoryLeakTest.zip", "project": "Spring", "sub_project": "DATAJPA", "version": "1.1.0.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.support.LockModeRepositoryPostProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 909, "bug_title": "Count query breaks if pagination is used with projections", "bug_description": "The functionality described in the stack overflow below (requiring the use of the AS keyword for projection support) doesn&apos;t seem to be documented. I think it would be very helpful to have at least a mention of this included in the main documentation\nhttp://stackoverflow.com/questions/36701358/using-projections-with-pageable-in-spring-data/37317529#37317529", "project": "Spring", "sub_project": "DATAJPA", "version": "1.10.1.RELEASE", "fixed_version": "1.10.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.JpaCountQueryCreator.java", "org.springframework.data.jpa.repository.query.JpaQueryCreator.java"], "label": 1, "es_results": []}, {"bug_id": 913, "bug_title": "Inconsistent behavior with projections when using @NamedQuery vs @Query", "bug_description": "Queries are interpreted differently when using @NamedQuery and @Query in regard of projections. Having the following as a named query:\n\n\n\n\n\n\n@NamedQueries({    \n\n\n\n\n    @NamedQuery(\n\n\n\n\n\t    name = \"FoobarEntity.getDateOfFirstRecord1\",\n\n\n\n\n\t    query\n\n\n\n\n\t    = \"Select coalesce(min(m.recordedOn), current_date()) as dateOfFirstRecord1 from FoobarEntity m\"\n\n\n\n\n    )\n\n\n\n\n})\n\n\n\n\n\n\nand a repository method\n\n\n\n\n\n\npublic interface FoobarRepository extends JpaRepository<FoobarEntity, Integer> {\n\n\n\n\n    Calendar getDateOfFirstRecord1();\n\n\n\n\n}\n\n\n\n\n\n\nI get the expected date. If I however put the same query directly on the method like:\n\n\n\n\n\n\n    @Query(\"Select coalesce(min(m.recordedOn), current_date()) as dateOfFirstRecord2 from FoobarEntity m\")\n\n\n\n\n    Calendar getDateOfFirstRecord2();\n\n\n\n\n\n\nI end up with\n\n\n\n\n\n\norg.springframework.dao.InvalidDataAccessApiUsageException: Projection type must be an interface!; nested exception is java.lang.IllegalArgumentException: Projection type must be an interface!\n\n\n\n\n\n\nThat used to work in 1.9.5. Attached is a small demo.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.10.1.RELEASE", "fixed_version": "1.10.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.StringQuery.java", "org.springframework.data.jpa.repository.query.AbstractStringBasedJpaQuery.java", "org.springframework.data.jpa.repository.query.QueryUtils.java", "org.springframework.data.jpa.repository.query.SimpleJpaQueryUnitTests.java", "org.springframework.data.jpa.repository.query.PartTreeJpaQueryIntegrationTests.java", "org.springframework.data.jpa.repository.query.StringQueryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 937, "bug_title": "Broken placeholder in exception message to be created in QueryByExamplePredicateBuilder.getPredicate()", "bug_description": "Hi,\nthe class QueryByExamplePredicateBuilder has a bug in the getPredicates-Method. If it tries to throw a JpaSystemException the string formattier throws an UnknownFormatConversionException because of the missing \"s\" after the second \"%\" in the formatting template.\n\n\n\n\n\n\nString.format(\"Unexpected path type for %s. Found % where From.class was expected.\", currentPath, from)));\n\n\n\n\n\n\nbest regards,\nRaphael", "project": "Spring", "sub_project": "DATAJPA", "version": "1.10.2.RELEASE", "fixed_version": "1.11.0.M1", "fixed_files": ["org.springframework.data.jpa.convert.QueryByExamplePredicateBuilderUnitTests.java", "org.springframework.data.jpa.convert.QueryByExamplePredicateBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 951, "bug_title": "Projections not handled correctly when Optional is used as wrapping return type", "bug_description": "When using Optional return type and JPQL projection to create an object (not an Entity type)\nThe following exception is thrown:\n\n\n\n\n\n\norg.springframework.core.convert.ConverterNotFoundException: No converter found capable of converting from type [java.util.Optional<?>] to type [com.cookies.domain.dto.AuthenticationPrincipal]\n\n\n\n\n\n\nAn exaple repository is:\n\n\n\n\n\n\n@Repository\n\n\n\n\npublic interface UserPrincipalRepository extends CrudRepository<UserAccountPair, String> {\n\n\n\n\n \n\n\n\n\n    @Query(value = \"SELECT \" +\n\n\n\n\n            \"new xxx.AuthenticationPrincipal(you.id, you.email, you.password, you.enabled) \" +\n\n\n\n\n            \"FROM ApiUser you \"\n\n\n\n\n            + \"WHERE LOWER(you.email) = LOWER(?1)\")\n\n\n\n\n    Optional<AuthenticationPrincipal> findUserForAuthentication(String string);\n\n\n\n\n}\n\n\n\n\n\n\nIn previous versions this was working as expected.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.10.2.RELEASE", "fixed_version": "1.10.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.JpaQueryExecutionUnitTests.java", "org.springframework.data.jpa.repository.query.JpaQueryExecution.java"], "label": 1, "es_results": []}, {"bug_id": 974, "bug_title": "Projections referring to collection attributes do not create a proper selection (missing joins)", "bug_description": "I have model entity as below\nDocument <-1-----M--> Document\nand repository method is \"public List<DocumentWithoutParent> findByParentIsNull()\"\nwhere &apos;DocumentWithoutParent&apos; is projection\nsql that hibernate generate is incorrect. but when I change List<DocumentWithoutParent> to List<Document> it is OK.\nSo I think problem come from spring data jpa.\nBelow is  a test project on this problem.\nhttps://github.com/pramoth/hibernate-generate-wrong-sql-with-projection", "project": "Spring", "sub_project": "DATAJPA", "version": "1.10.3.RELEASE", "fixed_version": "1.11.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryFinderTests.java", "org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.query.JpaQueryCreator.java"], "label": 1, "es_results": []}, {"bug_id": 984, "bug_title": "JPA projection query returning single non-standard JPA type results in \"No aliases found in result tuple\" error", "bug_description": "This relates directly to DATAJPA-885. The issue described there still occurs when a query returns a standard JPA projection consisting of a single type, where Spring Data JPA doesn&apos;t recognize that the type can be mapped by the JPA provider itself. In my case this happens when returning a collection of Joda LocalDate instances. \nI&apos;ve attached a small sample app with a unit test that shows the problem. The same test also shows that a direct JPA query does work.\nIt would be nice if Spring Data JPA could somehow detect that I&apos;m not trying to use its projection feature in this case, to prevent the \"No aliases found in result tuple\" error from happening. ", "project": "Spring", "sub_project": "DATAJPA", "version": "1.10.4.RELEASE", "fixed_version": "1.10.5.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.AbstractJpaQuery.java"], "label": 1, "es_results": []}, {"bug_id": 1000, "bug_title": "Pageable With Fetch not returning the right alias Name", "bug_description": "When using @Query in a JPA repository along with Pageable and attempting to sort on a field in a joined fetch entity, the from entity gets prepended to the sort field. Because the alias got a bad result. For example, if I do the following query:\n\n\n\n\n\n\n@Query(value = \"SELECT DISTINCT user FROM User user LEFT JOIN FETCH user.authorities authority\")\n\n\n\n\n\n\n if I simply decide to sort by a field in the Authority entity with this PageRequest:\n\n\n\n\n\n\nnew PageRequest(0, 10, Direction.DESC, \"authority.name\");\n\n\n\n\n\n\nThe query run is:\n\n\n\n\n\n\nSELECT DISTINCT user FROM com.admtl.model.user.User user LEFT JOIN FETCH user.authorities authority  order by user.authority.name asc\n\n\n\n\n\n\nAnd I got :\n\n\n\n\n\n\nSEVERE: Servlet.service() for servlet [SpringWeb] in context with path [/path] threw exception [Request processing failed; nested exception is org.springframework.dao.InvalidDataAccessApiUsageException: org.hibernate.QueryException: could not resolve property: authority of: com.admtl.model.user.User [SELECT DISTINCT user FROM com.admtl.model.user.User user LEFT JOIN FETCH user.authorities authority  order by user.authority.name asc]; nested exception is java.lang.IllegalArgumentException: org.hibernate.QueryException: could not resolve property: authority of: com.admtl.model.user.User [SELECT DISTINCT user FROM com.admtl.model.user.User user LEFT JOIN FETCH user.authorities authority  order by user.authority.name asc]] with root because\n\n\n\n\n\n\nNormal because authorities is property of User not authority\nBut If I remove the FETCH\n\n\n\n\n\n\n@Query(value = \"SELECT DISTINCT user FROM User user LEFT JOIN user.authorities authority\")\n\n\n\n\n\n\nWith the same PageRequest, my query run is:\n\n\n\n\n\n\nSELECT DISTINCT user FROM com.admtl.model.user.User user LEFT JOIN FETCH user.authorities authority  order by authority.name asc\n\n\n\n\n\n\nPerfect!\nI look a bit on the code of org.springframework.data.jpa.repository.query.QueryUtils\nfor method getOuterJoinAliases\n\n\n\n\n\n\n    static Set<String> getOuterJoinAliases(String query) {\n\n\n\n\n\n\n\n\n\n\t\tSet<String> result = new HashSet<String>();\n\n\n\n\n\t\tMatcher matcher = JOIN_PATTERN.matcher(query);\n\n\n\n\n\n\n\n\n\n\t\twhile (matcher.find()) {\n\n\n\n\n\n\n\n\n\n\t\t\tString alias = matcher.group(QUERY_JOIN_ALIAS_GROUP_INDEX);\n\n\n\n\n\t\t\tif (StringUtils.hasText(alias)) {\n\n\n\n\n\t\t\t\tresult.add(alias);\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t}\n\n\n\n\n\n\n\n\n\n\t\treturn result;\n\n\n\n\n\t}\n\n\n\n\n\n\nThe FETCH put the mess with the QUERY_JOIN_ALIAS_GROUP_INDEX", "project": "Spring", "sub_project": "DATAJPA", "version": "1.10.4.RELEASE", "fixed_version": "1.11.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 1024, "bug_title": "Querrying empty table for non-standard JPA type results in IllegalStateExcepion with the message \"No aliases found in result tuple\"", "bug_description": "Related to DATAJPA-984. Querrying empty table for non-standard JPA type results in IllegalStateExcepion with the message \"No aliases found in result tuple\", instead of returning null.\nIn the linked git repository this is showcased with org.joda.time.LocalDate instances. Querries for standard types, e.g. java.time.LocalDate return null as expected. It would be nice if the behaviour was unified.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.10.5.RELEASE", "fixed_version": "1.10.6.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.AbstractJpaQuery.java", "org.springframework.data.jpa.repository.query.TupleConverterUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1023, "bug_title": "Reject stream executions if not executed within transaction ", "bug_description": "I&apos;m using Stream&apos;s to loop through each element in a Repository in an @Scheduled method. After running 200 times I get the following error:\n\n\n\n\n\n\n2016-12-13 09:40:39.159  WARN 51004 --- [pool-2-thread-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: null\n\n\n\n\n2016-12-13 09:40:39.159 ERROR 51004 --- [pool-2-thread-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : [pool-2-thread-1] Timeout: Pool empty. Unable to fetch a connection in 2 seconds, none available[size:200; busy:200; idle:0; lastwait:2000].\n\n\n\n\n\n\nThe Repository is defined as such:\n\n\n\n\n\n\npublic interface PushNotificationRepository extends JpaRepository<PushNotification, Long> {\n\n\n\n\n    @Query(value = \"select p from PushNotification p\")\n\n\n\n\n    Stream<PushNotification> findAllAndStream();\n\n\n\n\n}\n\n\n\n\n\n\nThe Service is defined like this:\n\n\n\n\n\n\n@Service\n\n\n\n\n@Transactional()\n\n\n\n\npublic class PushNotificationFlusherService {\n\n\n\n\n    private static final Logger LOGGER = LoggerFactory.getLogger(PushNotificationFlusherService.class);\n\n\n\n\n\n\n\n\n\n    private final PushNotificationRepository pushNotificationRepository;\n\n\n\n\n\n\n\n\n\n    @Autowired\n\n\n\n\n    public PushNotificationFlusherService(PushNotificationRepository pushNotificationRepository) {\n\n\n\n\n        this.pushNotificationRepository = pushNotificationRepository;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    @Scheduled(fixedDelay = 5000)\n\n\n\n\n    protected void flushPushNotificationQueue() {\n\n\n\n\n        LOGGER.info(\"Flushing push notifications\");\n\n\n\n\n\n\n\n\n\n        try (Stream<PushNotification> pushNotifications = pushNotificationRepository.findAllAndStream()) {\n\n\n\n\n            pushNotifications.forEach((PushNotification pushNotification) -> {\n\n\n\n\n               // Send notification \n\n\n\n\n            });\n\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n        LOGGER.info(\"Flushed push notifications\");\n\n\n\n\n    }\n\n\n\n\n\n\nI&apos;ve tried using @Transactional( readOnly=true) but it does not make a difference.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.10.5.RELEASE", "fixed_version": "1.11.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryFinderTests.java", "org.springframework.data.jpa.repository.query.JpaQueryExecution.java"], "label": 1, "es_results": []}, {"bug_id": 243, "bug_title": "Sorting of paginated results is not working when Querydsl is used ", "bug_description": "I have following code that was working perfectly with 1.1.0.RELEASE (I am using Querydsl 2.7.0):\n\n\n\n\n\n\n@Transactional(readOnly = true)\n\n\n\n\n@Override\n\n\n\n\npublic List<Person> search(SearchDTO dto) {\n\n\n\n\n\t//Gets predicate by using static method of the query builder class\n\n\n\n\n\tPredicate predicate = firstOrLastNameStartsWith(dto.getSearchTerm());\t\n\n\n\n\n\tPageable pageSpecification = buildPageSpecification(dto.getPageIndex(), dto.getPageSize());\n\n\n\n\n\n\n\n\n\n\tPage<Person> page = repository.findAll(predicate, pageSpecification);\n\n\n\n\n\n\n\n\n\n\treturn page.getContent();\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nprivate Pageable buildPageSpecification(int pageIndex, int pageSize) {\n\n\n\n\n\treturn new PageRequest(pageIndex, pageSize, sortByLastNameAndFirstNameAsc());\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nprivate Sort sortByLastNameAndFirstNameAsc() {\n\n\n\n\n\treturn new Sort(new Sort.Order(Sort.Direction.ASC, \"lastName\"),\n\n\n\n\n\t            new Sort.Order(Sort.Direction.ASC, \"firstName\")\n\n\n\n\n    );\n\n\n\n\n}\n\n\n\n\n\n\nAfter I updated to 1.2.0.M1, query results were no longer sorted. The problem is that the applySorting() method method of Querydsl class is never called when paginated queries are build by Spring Data JPA. The relevant methods of the Querydsl class are given in following (my comment in CAPS):\n\n\n\n\n\n\npublic JPQLQuery applyPagination(Pageable pageable, JPQLQuery query) {\n\n\n\n\n\n\n\n\n\n\tif (pageable == null) {\n\n\n\n\n\t\treturn query;\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n\tquery.offset(pageable.getOffset());\n\n\n\n\n\tquery.limit(pageable.getPageSize());\n\n\n\n\n\n\n\n\n\n        //CALL TO applySorting(pageable.getSort(), query) IS MISSING?\n\n\n\n\n\n\n\n\n\n\treturn query;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\npublic JPQLQuery applySorting(Sort sort, JPQLQuery query) {\n\n\n\n\n\n\n\n\n\n\tif (sort == null) {\n\n\n\n\n\t\treturn query;\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n\tfor (Order order : sort) {\n\n\n\n\n\t\tquery.orderBy(toOrder(order));\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n\treturn query;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n@SuppressWarnings({ \"rawtypes\", \"unchecked\" })\n\n\n\n\nprivate OrderSpecifier<?> toOrder(Order order) {\n\n\n\n\n\n\n\n\n\n\tExpression<Object> property = builder.get(order.getProperty());\n\n\n\n\n\n\n\n\n\n\treturn new OrderSpecifier(order.isAscending() ? com.mysema.query.types.Order.ASC\n\n\n\n\n\t\t\t: com.mysema.query.types.Order.DESC, property);\n\n\n\n\n}\n\n\n\n\n\n\nThe original discussion about this problem is found at:\nhttp://forum.springsource.org/showthread.php?129211-Sorting-problem-with-paginated-query-results-%28Spring-Data-JPA-1-2-0-M1-and-Querydsl%29", "project": "Spring", "sub_project": "DATAJPA", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.support.QueryDslJpaRepositoryTests.java", "org.springframework.data.jpa.repository.support.Querydsl.java"], "label": 1, "es_results": []}, {"bug_id": 277, "bug_title": "Pageable sorting by join property excludes null matches with Specifications", "bug_description": "If you have a repository that extends JpaSpecficationExecutor and use the findAll method with a Specification, the resulting query excludes null matches from the result.  This may be related to issue DATAJPA-252.\nI&apos;ve attached a test case that demonstrates how DATAJPA-252 is fixed but this is still an issue.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.1.2.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.EclipseLinkNamespaceUserRepositoryTests.java", "org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 287, "bug_title": "Count query does not take into account the distinct property of target query", "bug_description": "I found the issue using the Specification and PageRequest when i have joins and distinct at the same time in my query. When i call Page.getTotalElements() i get wrong number, bigger than it should be. Seems that duplicate items introduced by join get counted for total elements.\nSo the problem is that i use joins while building a Predicate, so to eliminate duplicates i set distinct property of query object to true:\n\n\n\n\n\n\npublic Predicate toPredicate(Root<Parent> root, CriteriaQuery<?> query, CriteriaBuilder cb) {\n\n\n\n\n                Path<Set<Child>> childrenPath = root.get(\"children\");\n\n\n\n\n                root.join(\"children\");\n\n\n\n\n                query.distinct(true);\n\n\n\n\n                return cb.isNotEmpty(childrenPath);\n\n\n\n\n            }\n\n\n\n\n\n\nAs i see from DATA JPA code before doing the actual select query it performs count query, from my log it&apos;s the following:\n\n\n\n\n\n\nselect\n\n\n\n\n        distinct count(*) as col_0_0_ \n\n\n\n\n    from\n\n\n\n\n        parent parent0_ \n\n\n\n\n    inner join\n\n\n\n\n        parent_children children1_ \n\n\n\n\n            on parent0_.id=children1_.parent_id \n\n\n\n\n    inner join\n\n\n\n\n        child child2_ \n\n\n\n\n            on children1_.child_id=child2_.id \n\n\n\n\n    where\n\n\n\n\n        exists (\n\n\n\n\n            select\n\n\n\n\n                child4_.id \n\n\n\n\n            from\n\n\n\n\n                parent_children children3_,\n\n\n\n\n                child child4_ \n\n\n\n\n            where\n\n\n\n\n                parent0_.id=children3_.parent_id \n\n\n\n\n                and children3_.child_id=child4_.id\n\n\n\n\n        )\n\n\n\n\n\n\nAs i understand distinct clause should be inside count() function:\n\n\n\n\n\n\nselect count(distinct *) ...\n\n\n\n\n\n\nIf i run such query directly in DB i&apos;ll get the right number of items.\nI believe this issue can be fixed by using countDistinct instead of count() here https://github.com/SpringSource/spring-data-jpa/blob/master/src/main/java/org/springframework/data/jpa/repository/support/SimpleJpaRepository.java#L459\nOr it can be conditionally ran \n\n\n\n\n\n\nif (query.isDistinct()) {\n\n\n\n\n    query.select(builder.countDistinct(root));\n\n\n\n\n} else {\n\n\n\n\n    query.select(builder.count(root));\n\n\n\n\n}\n\n\n\n\n\n\nPlease see the attached zip file of the test project.\nPlease let me know if there is any workaround.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.1.2.RELEASE", "fixed_version": "1.11.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.support.SimpleJpaRepository.java"], "label": 1, "es_results": []}, {"bug_id": 266, "bug_title": " SimpleJpaRepository.exists(ID) fails, if ID is an composite key", "bug_description": "I tried to deleted an entity via repo.delete(ID). \nThe entity uses an composite key. \nFollowing exception was thrown:\norg.springframework.dao.InvalidDataAccessApiUsageException: Parameter value [MyId@92121c] did not match expected type [java.lang.String];\nI saw delete(ID) uses exisits(ID). Exists grabs idAttributeName via \nString idAttributeName = entityInformation.getIdAttribute().getName();\nBut getName() returns the first value of my composite key only.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.1.2.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.support.JpaEntityInformation.java", "org.springframework.data.jpa.repository.support.SimpleJpaRepository.java", "org.springframework.data.jpa.repository.support.JpaRepositoryTests.java", "org.springframework.data.jpa.repository.support.JpaEntityInformationSupportUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java", "org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation.java"], "label": 1, "es_results": []}, {"bug_id": 296, "bug_title": "Sort does not support case insensitive sorting ", "bug_description": "Currently when using the Sort class in the findAll method, the results returned are always case sensitive.  For example, if the following names were sorted they would be returned in this order:\nDave\nOliver\nkevin\nI&apos;m proposing that when sorting on properties that are Strings that it is possible to have the sort be case insensitive so that the results above would be returned as:\nDave\nkevin\nOliver", "project": "Spring", "sub_project": "DATAJPA", "version": "1.11.3.RELEASE", "fixed_version": "1.4.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.support.QueryDslJpaRepositoryTests.java", "org.springframework.data.jpa.repository.support.Querydsl.java", "org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java", "org.springframework.data.jpa.repository.UserRepositoryTests.java"], "label": 1, "es_results": []}, {"bug_id": 327, "bug_title": "Case insensitive sorting using Pageable", "bug_description": "Currently, there is no way to specify in Spring-Data if the sorting is case insensitive or not. It is possible in Hibernate, but since Spring-Data is using springframework classes, clients can&apos;t specify if sorting is case sensitive or not.\nTake this example:\nI have this method in my Repository \n\n\n\n\n\n\npublic interface ItemRepository extends QueryDslPredicateExecutor<Item>{\n\n\n\n\n    @Query(\"SELECT o FROM Item o WHERE o.status = ?1\")\n\n\n\n\n    Page<Item> findByStatus(Item.Status status, Pageable pageable);\n\n\n\n\n}\n\n\n\n\n\n\nI want to be able to call that with:\n\n\n\n\n\n\nitemRepository.findByStatus(Status.completed, new PageRequest(0, 10, Direction.ASC, \"lower(name)\")\n\n\n\n\n\n\nNote the lower function in the property string. That doesn&apos;t work as Spring-data expects a property there. That will get translated to something like:\n\n\n\n\n\n\nSELECT o FROM Item o WHERE o.status = ?1 ORDER BY o.lower(name)\n\n\n\n\n\n\nwhich of course won&apos;t work as there is no &apos;lower&apos; property on the object.\nIn order to make this work, the Sort interface should have a case sensitive trigger.\nOr to make it even more flexible, Sort could accept expressions as &apos;columns&apos;. E.g. accept expressions like:\n\n\n\n\n\n\nlower(name)\n\n\n\n\nlower(concat(firstName, \", \", lastName))\n\n\n\n\netc.\n\n\n\n\n\n\nOne easy way to do it would be to create a custom implementation of Sort, let&apos;s say ColumnExpressionSort which clients can use to define complex custom columns for sorting. In that case the client is responsible of specifying the full expression.\nE.g. in the above case, the user would do:\n\n\n\n\n\n\nColumnExpressionSort sort = new ColumnExpressionSort(\"lower(o.name)\", ASC);\n\n\n\n\nitemRepository.findByStatus(Status.completed, new PageRequest(0, 10, sort);\n\n\n\n\n\n\nGiven that user does know how the query looks like, they&apos;d know that the returned object is using the o alias. Same for generated queries, they could use the default alias.\nI&apos;m happy to work on the changes if the solution makes sense.\nCheers,\nIulian.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.11.3.RELEASE", "fixed_version": "1.4.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.support.QueryDslJpaRepositoryTests.java", "org.springframework.data.jpa.repository.support.Querydsl.java", "org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java", "org.springframework.data.jpa.repository.UserRepositoryTests.java"], "label": 1, "es_results": []}, {"bug_id": 342, "bug_title": "Wrong calculation of total number of elements when using DISTINCT clause", "bug_description": "If I define a custom query of this type:\n\n\n\n\n\n\n@Query(\"SELECT DISTINCT m.genre FROM Media m WHERE m.user = ?1 ORDER BY m.genre ASC\")\n\n\n\n\nPage<String> getJukeGenres(User user, Pageable pageable);\n\n\n\n\n\n\nThe resulting Page element has wrong Total Elements.\nIt seems like it gives the number of total records instead of the distinct ones.\nI had to create another adhoc query just to have the correct count:\n\n\n\n\n\n\n@Query(\"SELECT count(*) as num FROM Media m WHERE m.user = ?1 AND m.genre IS NOT NULL\")\n\n\n\n\nlong countGenres(User user);\n\n\n\n\n\n\nBut this is tedious workaround that I would like to avoid", "project": "Spring", "sub_project": "DATAJPA", "version": "1.11.3.RELEASE", "fixed_version": "1.4.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.SimpleJpaQuery.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 403, "bug_title": "Unnecessary OUTER JOIN are generated when sorting on ElementCollection", "bug_description": "Extending JpaSpecificationExecutor and calling findAll with a Specification and a Sort because unnecessary outer join to be add to the query generating wrong results with duplicate data.\nThis happens if the Specification queries on a field of an object mapped by and @ElementCollection and sort by another field of the same object.\nNot sure if the problem in SimpleJpaRepository or in QueryUtils, but somewhere new outer join is created while an existing one could be reuse.\nThe following query is generated\n\n\n\n\n\n\nSELECT\n\n\n\n\n    entitya0_.id AS id1_0_\n\n\n\n\nFROM\n\n\n\n\n    entity_a entitya0_\n\n\n\n\nLEFT OUTER JOIN\n\n\n\n\n    entity_b entitiesb1_\n\n\n\n\nON\n\n\n\n\n    entitya0_.id=entitiesb1_.entity_a_id\n\n\n\n\nLEFT OUTER JOIN\n\n\n\n\n    entity_b entitiesb2_\n\n\n\n\nON\n\n\n\n\n    entitya0_.id=entitiesb2_.entity_a_id\n\n\n\n\nWHERE\n\n\n\n\n    entitiesb1_.field=?\n\n\n\n\nORDER BY\n\n\n\n\n    entitiesb2_.rank DESC\n\n\n\n\n\n\nThe expected query looks like\n\n\n\n\n\n\nSELECT\n\n\n\n\n    entitya0_.id AS id1_0_\n\n\n\n\nFROM\n\n\n\n\n    entity_a entitya0_\n\n\n\n\nLEFT OUTER JOIN\n\n\n\n\n    entity_b entitiesb1_\n\n\n\n\nON\n\n\n\n\n    entitya0_.id=entitiesb1_.entity_a_id\n\n\n\n\nWHERE\n\n\n\n\n    entitiesb1_.field=?\n\n\n\n\nORDER BY\n\n\n\n\n    entitiesb1_.rank DESC\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.2.1.RELEASE", "fixed_version": "1.3.5.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 353, "bug_title": "ClasspathScanningPersistenceUnitPostProcessor does not resolve mapping files properly", "bug_description": "Using the postprocessor to scan the classpath for mapping orm.xml files using a wildcard pattern. Although the mapping files are discovered, they are added to the PersistenceUnitInfo as URLs. As a result they cannot be resolved by hibernate because it expects them in qualified package resource form:\n\n\n\n\n\n\nINFO  org.hibernate.ejb.Ejb3Configuration - HHH000360: Unable to resolve mapping file [file:/Users/dev/Documents/eclipse-workspaces/workspace/project1/target/classes/com/example/model/Mapping.orm.xml]\n\n\n\n\n\n\nThe property on LocalContainerEntityManagerFactoryBean:\n\n\n\n\n\n\n<property name=\"persistenceUnitPostProcessors\">\n\n\n\n\n\t<list>\n\n\n\n\n\t\t<bean class=\"org.springframework.data.jpa.support.ClasspathScanningPersistenceUnitPostProcessor\">\n\n\n\n\n\t\t\t<constructor-arg value=\"com.example.model\" />\n\n\n\n\n\t\t\t<property name=\"mappingFileNamePattern\" value=\"**/*orm.xml\" />\n\n\n\n\n\t\t</bean>\n\n\n\n\n\t</list>\n\n\n\n\n</property>\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.3.1.RELEASE", "fixed_version": "1.4.0.RC1", "fixed_files": ["org.springframework.data.jpa.support.ClasspathScanningPersistenceUnitPostProcessor.java", "org.springframework.data.jpa.support.ClasspathScanningPersistenceUnitPostProcessorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 350, "bug_title": "Improve query validation by creating explicit EntityManager instance", "bug_description": "org.springframework.data.jpa.repository.query.SimpleJpaQuery\n\n\n\n\n\n\nSimpleJpaQuery(JpaQueryMethod method, EntityManager them, String queryString) {  \n\n\n\n\n\n\n\n\n\n    \n\n\n\n\n  // Try to create a Query object already to fail fast  \n\n\n\n\n  if (!method.isNativeQuery()) {  \n\n\n\n\n    try {  \n\n\n\n\n      them.createQuery(query.getQuery());  \n\n\n\n\n    } catch (RuntimeException e) {  \n\n\n\n\n      // Needed as there&apos;s ambiguities in how an invalid query string shall be expressed by the persistence provider  \n\n\n\n\n      // http://java.net/projects/jpa-spec/lists/jsr338-experts/archive/2012-07/message/17  \n\n\n\n\n      throw e instanceof IllegalArgumentException ? e : new IllegalArgumentException(e);  \n\n\n\n\n    }  \n\n\n\n\n  }  \n\n\n\n\n    \n\n\n\n\n}  \n\n\n\n\n\n\ncreate Query but not close because org.springframework.orm.jpa.SharedEntityManagerCreator\nwhen execute Query:\n\n\n\n\n\n\nif (method.getName().equals(\"getResultList\") || method.getName().equals(\"getSingleResult\") ||  \n\n\n\n\n  method.getName().equals(\"executeUpdate\")) {  \n\n\n\n\n  EntityManagerFactoryUtils.closeEntityManager(this.them);  \n\n\n\n\n}\n\n\n\n\n\n\nto close the EntityManager. Simple solution:\n\n\n\n\n\n\nEntityManager target = null;\n\n\n\n\n// Try to create a Query object already to fail fast\n\n\n\n\nif (!method.isNativeQuery()) {\n\n\n\n\n try {\n\n\n\n\n  target = them.getEntityManagerFactory().createEntityManager();\n\n\n\n\n  target.createQuery(query.getQuery());\n\n\n\n\n } catch (RuntimeException e) {\n\n\n\n\n  // Needed as there&apos;s ambiguities in how an invalid query string shall be expressed by the persistence provider\n\n\n\n\n  // http://java.net/projects/jpa-spec/lists/jsr338-experts/archive/2012-07/message/17\n\n\n\n\n  throw e instanceof IllegalArgumentException ? e : new IllegalArgumentException(e);\n\n\n\n\n } finally {\n\n\n\n\n  EntityManagerFactoryUtils.closeEntityManager(target);\n\n\n\n\n }\n\n\n\n\n}\n\n\n\n\n\n ", "project": "Spring", "sub_project": "DATAJPA", "version": "1.3.2.RELEASE", "fixed_version": "1.4.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.query.JpaQueryLookupStrategyUnitTests.java", "org.springframework.data.jpa.repository.query.SimpleJpaQuery.java", "org.springframework.data.jpa.repository.query.SimpleJpaQueryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 359, "bug_title": "@Lock annotation does not work on (at least) findOne method", "bug_description": "If I have a repository defined thus:\n\n\n\n\n\n\npublic interface DataObjectRepository extends PagingAndSortingRepository<DataObject, Integer> {\n\n\n\n\n\n\n\n\n\n\t@Override\n\n\n\n\n\t@Lock(LockModeType.PESSIMISTIC_WRITE)\n\n\n\n\n\tDataObject findOne(Integer id);\n\n\n\n\n\t\n\n\n\n\n\t@Query(\"from DataObject o where o.id = ?1\")\n\n\n\n\n\t@Lock(LockModeType.PESSIMISTIC_WRITE)\n\n\n\n\n\tDataObject findOneAndLock(Integer id);\n\n\n\n\n}\n\n\n\n\n\n\nand I run both findOne() and findOneAndLock() then only my more specific method acquires a lock - the @Lock annotation applied to the CRUD method has no effect on its operation. Interestingly, applying the annotation to the findAll method (as noted in the docs) does work !? The documentation suggests that the @Lock annotation should also apply to the other CRUD methods.\nI&apos;ve created a sample Maven / Eclipse project to demonstrate the issue (this example uses Derby as its DB, but the issue is also present on at least MySQL where I discovered it first)\nThe output of running the test.Application class ends with some Hibernate logging of the Derby:\n\n\n\n\n\n\nHibernate: \n\n\n\n\n    select\n\n\n\n\n        dataobject0_.id as id1_0_0_,\n\n\n\n\n        dataobject0_.name as name2_0_0_ \n\n\n\n\n    from\n\n\n\n\n        data dataobject0_ \n\n\n\n\n    where\n\n\n\n\n        dataobject0_.id=?\n\n\n\n\nHibernate: \n\n\n\n\n    select\n\n\n\n\n        dataobject0_.id as id1_0_,\n\n\n\n\n        dataobject0_.name as name2_0_ \n\n\n\n\n    from\n\n\n\n\n        data dataobject0_ for update\n\n\n\n\n            with rs\n\n\n\n\nHibernate: \n\n\n\n\n    select\n\n\n\n\n        dataobject0_.id as id1_0_,\n\n\n\n\n        dataobject0_.name as name2_0_ \n\n\n\n\n    from\n\n\n\n\n        data dataobject0_ \n\n\n\n\n    where\n\n\n\n\n        dataobject0_.id=? for update\n\n\n\n\n            with rs\n\n\n\n\n\n\nand I had expected that the first query (using the @Lock&apos;ed findOne) should also have acquired the lock with the \"for update\" suffix.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.3.2.RELEASE", "fixed_version": "1.3.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.LockIntegrationTests.java", "org.springframework.data.jpa.repository.support.SimpleJpaRepository.java", "org.springframework.data.jpa.repository.sample.RoleRepository.java"], "label": 1, "es_results": []}, {"bug_id": 348, "bug_title": "@IdClass of @MappedSuperclass is not supported", "bug_description": "org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation.IdMetadata#getType does not support MappedSuperclass annotation, i.e. if I have @IdClass at superclass with MappedSuperclass this code does not resolve it and returns null. ", "project": "Spring", "sub_project": "DATAJPA", "version": "1.3.2.RELEASE", "fixed_version": "1.3.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformationIntegrationTests.java", "org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation.java"], "label": 1, "es_results": []}, {"bug_id": 363, "bug_title": "Improve SimpleJpaRepository.delete(ID id) by removing superfluous call to exists().", "bug_description": "SimpleJpaRepository.delete(ID id) calls exists() to detect whether an entity with the given identifier exists. If that&apos;s the case it loads the entity and passes it on.\nThe exists call is superfluous as we can simply check the result of findOne() for null and thus avoid the additional SQL statement to be executed.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.3.2.RELEASE", "fixed_version": "1.3.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.support.SimpleJpaRepository.java"], "label": 1, "es_results": []}, {"bug_id": 362, "bug_title": "Parameter used in % LIKE expression is changed for whole query", "bug_description": "\n\n\n\n\n\n@Query(\"SELECT e FROM Example e WHERE e.one = ?1 OR e.two LIKE %?1\")\n\n\n\n\nList<Example> findByOneOrTwo(String query);\n\n\n\n\n\n\nwill result in the following SQL query being executed (parameter &apos;QUERY&apos;):\n\n\n\n\n\n\nSELECT e.one, e.two FROM examples e WHERE e.one = &apos;%QUERY&apos; OR e.two LIKE &apos;%QUERY&apos;\n\n\n\n\n\n\nbut it should look like this:\n\n\n\n\n\n\nSELECT e.one, e.two FROM examples e WHERE e.one = &apos;QUERY&apos; OR e.two LIKE &apos;%QUERY&apos;\n\n\n\n\n\n\nA workaround is to use a separate parameter for the LIKE expression:\n\n\n\n\n\n\n@Query(\"SELECT e FROM Example e WHERE e.one = ?1 OR e.two LIKE %?2\")\n\n\n\n\nList<Example> findByOneOrTwo(String query, String queryTwo);\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.3.2.RELEASE", "fixed_version": "1.6.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.StringQueryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 373, "bug_title": "NullPointerException for manually defined queries with multiple named like expressions", "bug_description": "", "project": "Spring", "sub_project": "DATAJPA", "version": "1.3.3.RELEASE", "fixed_version": "1.3.4.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.StringQueryUnitTests.java", "org.springframework.data.jpa.repository.query.StringQuery.java"], "label": 1, "es_results": []}, {"bug_id": 377, "bug_title": "Count queries should be issued without ORDER BY clause", "bug_description": "I have the following query method:\n\n\n\n\n\n\n@Query(\"SELECT a FROM AdminModule a WHERE a.admin = :admin ORDER BY a.module\")\n\n\n\n\npublic Page<AdminModule> findByAdmin(@Param(\"admin\") Admin admin, Pageable page);\n\n\n\n\n\n\nThe test is:\n\n\n\n\n\n\n@Test\n\n\n\n\npublic void testFindByAdmin() {\n\n\n\n\n  Page<AdminModule> adminModules = adminModuleRepository.findByAdmin(admin0, new PageRequest(0, 10));\n\n\n\n\n  assertEquals(1, adminModules.getContent().size());\n\n\n\n\n  assertEquals(adminModule0.getModule(), adminModules.getContent().get(0).getModule());\n\n\n\n\n  adminModules = adminModuleRepository.findByAdmin(admin1, new PageRequest(0, 10));\n\n\n\n\n  assertEquals(10, adminModules.getContent().size());\n\n\n\n\n  assertEquals(adminModule1.getModule(), adminModules.getContent().get(0).getModule());\n\n\n\n\n  assertEquals(adminModule2.getModule(), adminModules.getContent().get(1).getModule());\n\n\n\n\n  adminModules = adminModuleRepository.findByAdmin(admin1, new PageRequest(1, 10));\n\n\n\n\n  assertEquals(manyAdminModules.get(8).getModule(), adminModules.getContent().get(0).getModule());\n\n\n\n\n  assertEquals(manyAdminModules.get(9).getModule(), adminModules.getContent().get(1).getModule());\n\n\n\n\n}\n\n\n\n\n\n\nIt is successful when run against the MySQL database. But when run against the H2 database, it gives the following error:\n\n\n\n\n\n\n2013-07-25 12:10:40,560 DEBUG  [sqlonly]  org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:208)\n\n\n\n\n6. select count(adminmodul0_.id) as col_0_0_ from admin_module adminmodul0_ where adminmodul0_.admin_id=4362\n\n\n\n\norder by adminmodul0_.module\n\n\n\n\n2013-07-25 12:10:40,588 ERROR  [sqlonly]  org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:208)\n\n\n\n\n6. select count(adminmodul0_.id) as col_0_0_ from admin_module adminmodul0_ where adminmodul0_.admin_id=4362 order by adminmodul0_.module\n\n\n\n\norg.h2.jdbc.JdbcSQLException: Column \"ADMINMODUL0_.MODULE\" must be in the GROUP BY list; SQL statement:\n\n\n\n\nselect count(adminmodul0_.id) as col_0_0_ from admin_module adminmodul0_ where adminmodul0_.admin_id=? order by adminmodul0_.module [90016-172]\n\n\n\n\n\n\nI&apos;m using the following:\n\n\n\n\n\n\n  <properties>\n\n\n\n\n    <hibernate.version>3.6.10.Final</hibernate.version>\n\n\n\n\n  </properties>\n\n\n\n\n\n\n\n\n\n    <dependency>\n\n\n\n\n      <groupId>org.hibernate</groupId>\n\n\n\n\n      <artifactId>hibernate-core</artifactId>\n\n\n\n\n      <version>${hibernate.version}</version>\n\n\n\n\n    </dependency>\n\n\n\n\n    <dependency>\n\n\n\n\n      <groupId>org.hibernate</groupId>\n\n\n\n\n      <artifactId>hibernate-entitymanager</artifactId>\n\n\n\n\n      <version>${hibernate.version}</version>\n\n\n\n\n    </dependency>\n\n\n\n\n    <dependency>\n\n\n\n\n      <groupId>org.springframework.data</groupId>\n\n\n\n\n      <artifactId>spring-data-jpa</artifactId>\n\n\n\n\n      <version>1.3.4.RELEASE</version>\n\n\n\n\n    </dependency>\n\n\n\n\n    <dependency>\n\n\n\n\n      <groupId>org.hibernate</groupId>\n\n\n\n\n      <artifactId>hibernate-annotations</artifactId>\n\n\n\n\n      <version>3.5.6-Final</version>\n\n\n\n\n    </dependency>\n\n\n\n\n    <dependency>\n\n\n\n\n      <groupId>org.hibernate.javax.persistence</groupId>\n\n\n\n\n      <artifactId>hibernate-jpa-2.0-api</artifactId>\n\n\n\n\n      <version>1.0.1.Final</version>\n\n\n\n\n    </dependency>\n\n\n\n\n    <dependency>\n\n\n\n\n      <groupId>com.h2database</groupId>\n\n\n\n\n      <artifactId>h2</artifactId>\n\n\n\n\n      <version>1.3.172</version>\n\n\n\n\n    </dependency>\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.3.4.RELEASE", "fixed_version": "1.4.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 375, "bug_title": "Not specifying the ASC clause results in a double ORDER BY clause", "bug_description": "I have a query with an ORDER BY clause.\n\n\n\n\n\n\n@Query(\"SELECT a FROM Admin a \" + \n\n\n\n\n       \"WHERE LOWER(a.firstname) LIKE LOWER(CONCAT(&apos;%&apos;, :searchTerm, &apos;%&apos;))\" + \n\n\n\n\n       \"   OR LOWER(a.lastname) LIKE LOWER(CONCAT(&apos;%&apos;, :searchTerm, &apos;%&apos;))\" +\n\n\n\n\n       \"   OR LOWER(a.email) LIKE LOWER(CONCAT(&apos;%&apos;, :searchTerm, &apos;%&apos;))\" +\n\n\n\n\n       \"   OR LOWER(a.login) LIKE LOWER(CONCAT(&apos;%&apos;, :searchTerm, &apos;%&apos;))\" +\n\n\n\n\n       \"ORDER BY a.lastname, a.firstname\")\")\n\n\n\n\npublic Page<Admin> search(@Param(\"searchTerm\") String searchTerm, Pageable page);\n\n\n\n\n\n\nThe ORDER BY clause does not specify any ASC nor DESC clause assuming the default ASC clause would be used.\nBut instead, the generated query looks like:\n\n\n\n\n\n\nSELECT a FROM com.thalasoft.learnintouch.core.jpa.domain.Admin a \n\n\n\n\nWHERE LOWER(a.firstname) LIKE LOWER(CONCAT(&apos;%&apos;, :searchTerm, &apos;%&apos;)) \n\n\n\n\n   OR LOWER(a.lastname) LIKE LOWER(CONCAT(&apos;%&apos;, :searchTerm, &apos;%&apos;)) \n\n\n\n\n   OR LOWER(a.email) LIKE LOWER(CONCAT(&apos;%&apos;, :searchTerm, &apos;%&apos;))\n\n\n\n\n   OR LOWER(a.login) LIKE LOWER(CONCAT(&apos;%&apos;, :searchTerm, &apos;%&apos;))\n\n\n\n\nORDER BY a.lastname, a.firstname order by a.lastname asc, a.firstname asc\n\n\n\n\n\n\nIt shows two ORDER BY clauses. If I explicitly add the ASC clause then the query is fine.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.3.4.RELEASE", "fixed_version": "1.4.0.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 396, "bug_title": "CriteriaQuery caching causes problems with Hibernate's alias name generation in multithreaded environments", "bug_description": "In my project, every now and again some Spring Data Repository methods raise a ClassCastException when called. If this happens once, every subsequent call on the same method results in the same exception. The method is then broken until the JVM or the Spring context is restarted.\nAfter investigating further I found out that this is caused by an incorrectly generated query string. In my case this JPA query string is something like \nselect generatedAlias0 from Order as generatedAlias0 left join generatedAlias0.product as generatedAlias0 where generatedAlias0=:param0\nThe generated alias is the same for the root object as well as the join! After taking a closer look at Hibernate&apos;s sources, I found out that Hibernate&apos;s javax.persistence.criteria.CriteriaQuery implementation (CriteriaQueryImpl) is not thread safe. If there are no aliases set on the CriteriaQuery object (=default), alias names are generated on the first call that uses the object. Now, if multiple threads use the CriteriaQuery object at the same time, this can cause incorrectly generated alias names. Since Spring Data JPA repositories use a shared CriteriaQuery object for each query method, this causes problems in multithreaded environments.\nJPA does not explicitly require implementations to provide thread safe CriteriaQuery objects. I reproduced this with Hibernate 4.2.5 and 4.1.9. Maybe with other JPA implementations alias generation is implemented differently and thread safe. Either way, unfortunately, Spring Data can not rely on thread safety in this regard. This problem might have been introduced in DATAJPA-71\nInvestigation notes:\nQuery generation in Hibernate can found in org.hibernate.ejb.criteria.CriteriaQueryCompiler (line 223). The renderingContext passed is unique for the thread/call (not unique for the CriteriqQuery object)", "project": "Spring", "sub_project": "DATAJPA", "version": "1.3.4.RELEASE", "fixed_version": "1.4.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.PartTreeJpaQuery.java"], "label": 1, "es_results": []}, {"bug_id": 352, "bug_title": "SimpleJpaQuery validates count queries to aggressively", "bug_description": "The fix for DATAJPA-350 introduced query validation for count queries as well which causes issues if the original query is not defined to be projected into a count query (e.g. including joins that will break the count() clause).", "project": "Spring", "sub_project": "DATAJPA", "version": "1.4.0.M1", "fixed_version": "1.4.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.query.SimpleJpaQuery.java", "org.springframework.data.jpa.repository.query.SimpleJpaQueryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 346, "bug_title": "Sort by property of an associated object does not work. Join type should be LEFT OUTER JOIN for sorting on associated objects.", "bug_description": "The issue I have is that I try to order by a property in an associated object (composite pattern). Thus I have a class PreApprovalRequest and a property in that class assignedTo of type PaceUser. I am trying to order requests by the name of the assignedTo user.\nConcrete code below. I have a call that loads all PreApprovalRequest objects (for simplicity I&apos;ll leave out pagination). E.g.\n\n\n\n\n\n\n select * from PreApprovalRequest\n\n\n\n\n\n\nThat translates to:\n\n\n\n\n\n\nselect * from ( select preapprova0_.ID as ID0_, preapprova0_.CREATED as CREATED0_ from PRE_APPROVAL_REQUEST preapprova0_ order by preapprova0_.CREATED desc ) where rownum <= ?\n\n\n\n\n\n\nNow, when I apply the ordering by first name and then last name of the assignedTo user, the query translates into:\n\n\n\n\n\n\nselect * from ( select preapprova0_.ID as ID0_, preapprova0_.CREATED as CREATED0_ from PRE_APPROVAL_REQUEST preapprova0_, PACE_USER paceuser1_ where preapprova0_.ASSIGNED_TO=paceuser1_.ID order by lower(paceuser1_.FIRST_NAME) asc, lower(paceuser1_.LAST_NAME) asc ) where rownum <= ?\n\n\n\n\n\n\nNote that because the join used when applying sorting is the default one (not using the JOIN keyword) - which is basically INNER JOIN - the items where there is no user assigned to the request will be filtered out, which is not desired of course.\nThus, I think the solution is to join using LEFT OUTER JOIN instead of default join and that should fix it.\nI&apos;m happy to clone the repository and add the fix if needed.\nThanks,\nIulian.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.4.0.M1", "fixed_version": "1.4.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.EclipseLinkNamespaceUserRepositoryTests.java", "org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 407, "bug_title": "ClasspathScanningPersistenceUnitPostProcessor throws IndexOutOfBoundsException on Windows", "bug_description": "ClasspathScanningPersistenceUnitPostProcessor throws IndexOutOfBoundsException on windows, in scanForMappingFileLocations at line 140:\nresourcePath.substring(resourcePath.indexOf(basePackagePathComponent))\nThat&apos;s because resourcePath always has forward slash path (&apos;/&apos;) separator beeing an URI, while basePackagePathComponent has system dependent separator (on windows it&apos;s the backslash separator). So on windows the indexOf above will return -1 and hence the IndexOutOfBoundsException in substring.\nThe fix which worked for me:\nOn line 124 and 125 replace the existing code with the following:\n        String basePackagePathComponent = basePackage.replace(&apos;.&apos;, &apos;/&apos;);\n        String path = ResourcePatternResolver.CLASSPATH_ALL_URL_PREFIX + basePackagePathComponent + \"/\" + mappingFileNamePattern;", "project": "Spring", "sub_project": "DATAJPA", "version": "1.4.0.RC1", "fixed_version": "1.4.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.support.ClasspathScanningPersistenceUnitPostProcessor.java", "org.springframework.data.jpa.support.ClasspathScanningPersistenceUnitPostProcessorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 415, "bug_title": "org.springframework.data.jpa.repository.Query is not supported varargs", "bug_description": "@org.springframework.data.jpa.repository.Modifying\n\t@org.springframework.data.jpa.repository.Query(\"UPDATE #\n{#entityName}\n user SET user.status = :userStatus WHERE user.id IN (:ids)\")\n\tvoid updateUserStatus(@org.springframework.data.repository.query.Param(\"userStatus\") UserStatus userStatus,@org.springframework.data.repository.query.Param(\"ids\") Integer...ids);", "project": "Spring", "sub_project": "DATAJPA", "version": "1.4.1.RELEASE", "fixed_version": "1.5.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.EclipseLinkNamespaceUserRepositoryTests.java", "org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.OpenJpaNamespaceUserRepositoryTests.java", "org.springframework.data.jpa.repository.query.ParameterBinder.java", "org.springframework.data.jpa.domain.sample.User.java", "org.springframework.data.jpa.repository.query.ParameterBinderUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 424, "bug_title": "#entityName SpEL does not match alias regex when detecting alias", "bug_description": "Using of the #entityName SpEL within the @Query annotation causes StringQuery.alias to become null because the query string cannot be matched against ALIAS_MATCH in QueryUtils.detectAlias().\nThis means that using Pageable parameters with repository methods do not evaluate the alias correctly when constructing the sorted query string, i.e. given the @Query on the repository method\n\n\n\n\n\n\n@Query(\"SELECT o FROM #{#entityName} o WHERE o.orderState = :orderState\")\n\n\n\n\npublic Page<Order> findOrders(@Param(\"orderState\") OrderState orderState, Pageable pageable);\n\n\n\n\n\n\ncalled from \n\n\n\n\n\n\norderRepository.findOrders(state, new PageRequest(0, 10, Direction.DESC, \"orderDate\"))\n\n\n\n\n\n\nthen end query is parsed/resolved to\n\n\n\n\n\n\nSELECT o FROM Order o WHERE o.orderState = :orderState  order by null.orderDate desc\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.4.2.RELEASE", "fixed_version": "1.5.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.sample.MappedTypeRepository.java", "org.springframework.data.jpa.repository.MappedTypeRepositoryIntegrationTests.java", "org.springframework.data.jpa.repository.query.ExpressionBasedStringQueryUnitTests.java", "org.springframework.data.jpa.repository.query.ExpressionBasedStringQuery.java"], "label": 1, "es_results": []}, {"bug_id": 427, "bug_title": "Sort by property of an associated object generates inner join instead of left join with QueryDsl and Hibernate", "bug_description": "I have a custom repository implementation with QueryDsl predicate. When I sort by property of an associated object query that gets generated uses inner join instead left join statement.\nI also have a custom repository implementation with JpaSpecification executor. There everything works well.\nI have attached a test case.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.4.2.RELEASE", "fixed_version": "1.4.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.domain.sample.User.java", "org.springframework.data.jpa.repository.EclipseLinkNamespaceUserRepositoryTests.java", "org.springframework.data.jpa.repository.support.Querydsl.java", "org.springframework.data.jpa.repository.support.QueryDslJpaRepositoryTests.java"], "label": 1, "es_results": []}, {"bug_id": 430, "bug_title": "Fix incompatibilities with latest Hibernate 4.3 (CR2 currently)", "bug_description": "Hibernate&apos;s behaviour changed with version 4.3.0.Beta5, I think.\nInstead of throwing an IllegalStateException, null is returned.\nSomething like the following might fix it.\nIn org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation.IdMetadata\n\n\n\n\n\n\n\t\tpublic Class<?> getType() {\n\n\n\n\n\n\n\n\n\n\t\t\tif (idType != null) {\n\n\n\n\n\t\t\t\treturn idType;\n\n\n\n\n\t\t\t}\n\n\n\n\n\n\n\n\n\n\t\t\tClass<?> idType;\n\n\n\n\n\n\n\n\n\n\t\t\ttry {\n\n\n\n\n                final Type<?> idType1 = type.getIdType();\n\n\n\n\n                if (idType1 != null) {\n\n\n\n\n                    idType = idType1.getJavaType();\n\n\n\n\n                } else {\n\n\n\n\n                    IdClass annotation = AnnotationUtils.findAnnotation(type.getJavaType(), IdClass.class);\n\n\n\n\n                    idType = annotation == null ? null : annotation.value();\n\n\n\n\n                }\n\n\n\n\n\t\t\t} catch (IllegalStateException e) {\n\n\n\n\n\t\t\t\t// see https://hibernate.onjira.com/browse/HHH-6951\n\n\n\n\n\t\t\t\tIdClass annotation = AnnotationUtils.findAnnotation(type.getJavaType(), IdClass.class);\n\n\n\n\n\t\t\t\tidType = annotation == null ? null : annotation.value();\n\n\n\n\n\t\t\t}\n\n\n\n\n\n\n\n\n\n\t\t\tthis.idType = idType;\n\n\n\n\n\t\t\treturn idType;\n\n\n\n\n\t\t}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.4.2.RELEASE", "fixed_version": "1.4.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.PartTreeJpaQueryIntegrationTests.java", "org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation.java"], "label": 1, "es_results": []}, {"bug_id": 420, "bug_title": "COUNT syntax error when use scalar select (select a.b ,a.c from ...) with paging", "bug_description": "When use select with scalar & paging in Spring data JPA as below\n@Query(\"select s.fname,s.lname from Student s\") \nPage<Object> findWithScalarSelect(Pageable pageable);\nEclipselink generate malform jpql as below\nselect count(s.fname,s.lname) from Student s\nI made test on github => https://github.com/pramoth/springdata-pagingbug", "project": "Spring", "sub_project": "DATAJPA", "version": "1.4.2.RELEASE", "fixed_version": "1.4.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 444, "bug_title": "PersistenceProvider enum should also match org.hibernate.jpa.HibernateEntityManager", "bug_description": "With Hibernate 4.3 the package for HibernateEntityManager changed to org.hibernate.jpa.HibernateEntityManager.\nThe lack of support for the new location leads to a QueryCreationException because of an erroneous fallback to GENERIC_JPA which sets canExtractQuery() to false.\nPersistenceProvider should also match the new location to HIBERNATE or a new enum value which returns true for canExtractQuery().", "project": "Spring", "sub_project": "DATAJPA", "version": "1.4.3.RELEASE", "fixed_version": "1.5.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.support.PersistenceProvider.java"], "label": 1, "es_results": []}, {"bug_id": 442, "bug_title": "Repository initialization causes transaction rollback in CDI environments", "bug_description": "The CreateIfNotFoundQueryLookupStrategy cannot be used with Hibernate 4.3 in a JTA environment. Spring Data JPA calls them.createNamedQuery(queryName) in the NamedQuery constructor to check if the named query exists. In previous Hibernate versions this caused an IllegalArgumentException to be thrown by the entity manager. But now Hibernate roles back the transaction and a NullPointerException is thrown that is never caught by Spring Data JPA.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.4.3.RELEASE", "fixed_version": "1.5.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.cdi.PersonRepository.java", "org.springframework.data.jpa.repository.cdi.CdiExtensionIntegrationTests.java", "org.springframework.data.jpa.repository.cdi.JpaRepositoryExtension.java"], "label": 1, "es_results": []}, {"bug_id": 454, "bug_title": "Query on byte array fails", "bug_description": "I have a blob which is mapped as a byte array in my entity. When creating a method to search on it in Spring JPA, I got an exception at server launch.\nEntity:\n\n\n\n\n\n\n@Entity\n\n\n\n\n@Table(name = \"CERTIFICATE\")\n\n\n\n\npublic class Certificate {\n\n\n\n\n\n\n\n\n\n\t@Id\n\n\n\n\n\t@Column(name = \"ID\")\n\n\n\n\n\t@GeneratedValue(strategy = GenerationType.AUTO)\n\n\n\n\n\tprivate Integer id;\n\n\n\n\n\n\n\n\n\n\t@Column(name = \"CERTIFICATE\")\n\n\n\n\n\t@Lob\n\n\n\n\n\tprivate byte[] binary;\n\n\n\n\n\t// Getters and setters present but not shown\n\n\n\n\n}\n\n\n\n\n\n\nDAO:\n\n\n\n\n\n\npublic interface CertificateDAO extends JpaRepository<Certificate, Integer> {\n\n\n\n\n\n\n\n\n\n\tpublic Certificate findByBinary(byte[] binary);\n\n\n\n\n}\n\n\n\n\n\n\nException in attached file. It seems that the array is always handled as a relation and thus try to generate a join. At line 453 of QueryUtils property.isCollection() is true.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.4.3.RELEASE", "fixed_version": "1.4.4.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.domain.sample.User.java", "org.springframework.data.jpa.repository.query.QueryUtilsIntegrationTests.java", "org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 492, "bug_title": "findAll(Iterable<ID>)  : Invalid comparation Exception  thrown", "bug_description": "I am developping a web application which uses Spring and JPA. My aim is to get the content of a table called Product with a filter on the table identifier (use of the SQL syntax &apos;IN&apos;). For that, I use the method findAll(Iterable<ID>) of an interface which extends of CrudRepository.\nOn the call of the method findAll, I catch an exception which tell me that Spring can&apos;t compare an Integer object to an Iterable object. But, I don&apos;t understand why Spring try to compare an Integer object to an Iterable object.\nPlease find in attachment a simple project which reproduces the exception\nThe URL of the exception: http://localhost:8080/myshop/product/list", "project": "Spring", "sub_project": "DATAJPA", "version": "1.5.0.RELEASE", "fixed_version": "1.4.5.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.support.SimpleJpaRepository.java"], "label": 1, "es_results": []}, {"bug_id": 496, "bug_title": "Query derivation does not create joins for in-clauses on element collections", "bug_description": "We currently don&apos;t support finderQueries for ElementCollection since we don&apos;t generate the necessary joins.\nE.g.: The following use case dosen&apos;t work at the moment:\n\n\n\n\n\n\n...\n\n\n\n\n@ElementCollection private Set<String> attributes;\n\n\n\n\n...\n\n\n\n\n\n\n\n\n\n\n\n\n...\n\n\n\n\nList<User> findByAttributesIn(Set<String> attributes);\n\n\n\n\n...\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.5.0.RELEASE", "fixed_version": "1.5.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.domain.sample.User.java", "org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.EclipseLinkNamespaceUserRepositoryTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 500, "bug_title": "Sorting of Embeddables raises ClassCastException ", "bug_description": "Sorting via an Embeddable creates a ClassCastException\nQEntity cannot be cast to com.mysema.query.types.EntityPath\nSee referenced Gist.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.5.1.RELEASE", "fixed_version": "1.6.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.support.QueryDslJpaRepositoryTests.java"], "label": 1, "es_results": []}, {"bug_id": 505, "bug_title": "Blob query result only returns first byte", "bug_description": "After upgrading Spring Data from 1.5.0 to 1.5.1, the following query always returns a byte array containing only the first byte of the expected blob, instead of the entire blob:\n\n\n\n\n\n\n    @Query(\"select w.bytes from EntityWithBlobField w where w.id = :id\")\n\n\n\n\n    public byte[] getBytes(@Param(value = \"id\") long id);\n\n\n\n\n\n\n Reverting to Spring Data 1.5.0 fixed this issue for me.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.5.1.RELEASE", "fixed_version": "1.6.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.query.JpaQueryMethod.java"], "label": 1, "es_results": []}, {"bug_id": 513, "bug_title": "Improve error message for missing @Param annotations for query methods with named parameters", "bug_description": "Assume you have a repository declaration like this:\n\n\n\n\n\n\npublic PeopleRepository extends Repository<Person, Long> {\n\n\n\n\n\n\n\n\n\n  @Query(\"select p from Person p where p.lastname = :lastname\")\n\n\n\n\n  List<Person> findByLastname(String lastname);\n\n\n\n\n}\n\n\n\n\n\n\nOn method invocation you get a \"Name must not be null or empty!\" from StringQuery which doesn&apos;t make too obvious that you&apos;re missing @Param annotations on the lastname parameter. We should improve the exception message to guide users a bit more.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.5.1.RELEASE", "fixed_version": "1.5.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.StringQueryUnitTests.java", "org.springframework.data.jpa.repository.query.StringQuery.java"], "label": 1, "es_results": []}, {"bug_id": 499, "bug_title": "Paginate with QueryDSL generate \"nulls last\" illegal syntax when using MSSQL.", "bug_description": "Microsoft SQL Server does not support NULLS FIRST|LAST (of SQL:2003) for ORDER BY syntax, but QueryDSL add it on paginated list.\nI found NullHandling.NullsLast just used in Querydsl.toOrderSpecifier on 1.5.1.RELEASE. when I passed custom Pageable without NullHandling (according to 1.5.0.RELEASE), It just run well.\n(Then may I mess with Microsoft? )", "project": "Spring", "sub_project": "DATAJPA", "version": "1.5.1.RELEASE", "fixed_version": "1.6.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.support.Querydsl.java"], "label": 1, "es_results": []}, {"bug_id": 510, "bug_title": "Regression in 1.5.1 - Sort by property of an associated object does not work. Join property and INNER vs OUTER join when sorting", "bug_description": "Order by a column on a join table seems to be filtering out null values again (INNER JOIN vs OUTER JOIN?). This is with an Oracle-backed db.\nDATAJPA-346 fixed this issue, however after upgrading to 1.5.1 it has come back.\nLibrary versions are:\nspring-data-jpa 1.5.1.RELEASE\nquerydsl 3.3.2\nhibernate 4.3.4.Final\nWhen I try to sort on a joined column, the null joins are filtered out. When I change spring-dta-jpa to 1.5.0.RELEASE it works again without filtering with all other dependencies the same version.\nSeems like a regression in 1.5.1.\nThe offending generated query is shown in both versions below\n\n\n\n\n\n\n1.5.0 (working)\n\n\n\n\n\n\n    select\n\n\n\n\n        * \n\n\n\n\n    from\n\n\n\n\n        (\n\n\n\n\n        select\n\n\n\n\n            <<all-my-select-cols>>\n\n\n\n\n        from\n\n\n\n\n            REQUEST request0_ \n\n\n\n\n        left outer join\n\n\n\n\n            SITE_USER siteuser1_ \n\n\n\n\n                on request0_.ASSIGNED_TO=siteuser1_.ID \n\n\n\n\n        where\n\n\n\n\n            request0_.ROW_END_DATE is null \n\n\n\n\n        order by\n\n\n\n\n            lower(siteuser1_.FIRST_NAME) asc,\n\n\n\n\n            lower(siteuser1_.LAST_NAME) asc) \n\n\n\n\n    where\n\n\n\n\n        rownum <= ?\n\n\n\n\n\n\n\n\n\n\n\n\n1.5.1 (broke)\n\n\n\n\n\n\n    select\n\n\n\n\n        * \n\n\n\n\n    from\n\n\n\n\n        (\n\n\n\n\n        select\n\n\n\n\n            <<all-my-select-cols>>\n\n\n\n\n        from\n\n\n\n\n            REQUEST request0_,\n\n\n\n\n            SITE_USER siteuser1_ \n\n\n\n\n        where\n\n\n\n\n            request0_.ASSIGNED_TO=siteuser1_.ID \n\n\n\n\n            and (\n\n\n\n\n                request0_.ROW_END_DATE is null\n\n\n\n\n            ) \n\n\n\n\n        order by\n\n\n\n\n            lower(siteuser1_.FIRST_NAME) asc) \n\n\n\n\n    where\n\n\n\n\n        rownum <= ?\n\n\n\n\n\n\nIt also looks like my secondary order by column is missing (LAST_NAME), as the only thing I changed between runs was the spring-data-jpa version.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.5.1.RELEASE", "fixed_version": "1.5.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.support.Querydsl.java"], "label": 1, "es_results": []}, {"bug_id": 545, "bug_title": "Special characters not allowed anymore in named binding parameter", "bug_description": "Migration from 1.2.0 to 1.5.2 leads to regression in terms of support of accentuated characters in named binding parameters. The problem comes form the use of \\w+ in regular expression to match named parameter.  One solution would be to use \"\\p\n{L}\n+\" instead (see the JavaDoc of Pattern).\nThe code that might be improved is in the static field PARAMETER_BINDING_PATTERN in the enum ParameterBindingParser of org.springframework.data.jpa.repository.query.StringQuery class.\n\n\n\n\n\n\npublic static void main(String[] args) {\n\n\n\n\n  \n\n\n\n\n  String frenchWord = \"abonns\";\n\n\n\n\n\n\n\n\n\n  Pattern pOK = Pattern.compile(\"\\\\p\\{L\\}+\", Pattern.CASE_INSENSITIVE);\n\n\n\n\n  Matcher matcherOK = pOK.matcher(frenchWord);\n\n\n\n\n  System.out.println(frenchWord + \" matches \" +  pOK.pattern() + \" : \" + matcherOK.matches());\n\n\n\n\n\t\t\n\n\n\n\n  Pattern pKO = Pattern.compile(\"\\\\w+\", Pattern.CASE_INSENSITIVE);\n\n\n\n\n  Matcher matcherKO = pKO.matcher(frenchWord);\n\n\n\n\n  System.out.println(frenchWord + \" matches \" +  pKO.pattern() + \" : \" + matcherKO.matches());\n\n\n\n\n}\n\n\n\n\n\n\nI modified several of my source files because I needed the update, but I am a bit frustrated. It would be nice to check elsewhere the use of \\w+ in Spring data regular expression. Thank you very much in advance to bring back the support of native languages everywhere, just like Java does.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.5.2.RELEASE", "fixed_version": "1.5.3.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.StringQueryUnitTests.java", "org.springframework.data.jpa.repository.query.StringQuery.java"], "label": 1, "es_results": []}, {"bug_id": 523, "bug_title": "Specifications should implement Serializable", "bug_description": "org.springframework.data.jpa.domain.Specifications does not implement Serializable therefore it cannot be used to create a Specification for remote (e.g. via Spring Remoting) call of  JpaSpecificationExecutor repositories.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.5.2.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.jpa.domain.Specification.java", "org.springframework.data.jpa.domain.SpecificationsUnitTests.java", "org.springframework.data.jpa.domain.Specifications.java"], "label": 1, "es_results": []}, {"bug_id": 517, "bug_title": "Defensively check for null for optional dependency to CrudMethodMetadata in SimpleJpaRepository", "bug_description": "DATAJPA-173 introduced a CrudMethodMetadata abstraction used in SimpleJpaRepository. As it&apos;s an optional dependency (configured through a setter) we do guard access to it with null checks.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.0.M1", "fixed_version": "1.6.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.support.SimpleJpaRepository.java"], "label": 1, "es_results": []}, {"bug_id": 561, "bug_title": "Entity with primitive version property invalidly considered not new", "bug_description": "Hello,\nwe have some problems while saving entities with cascading after updating from 1.3.4.RELEASE to 1.6.0.RELEASE.\nCalling save with a list of entities will return a list of entities where only one has an ID.\nThis results in a constraint violation if the corresponding data should be inserted into the database.\nDependencies:\nBefore (Working):\n\nspring-data-jpa 1.3.4.RELEASE\nspring-data-commons 1.7.1.RELEASE\nspring 4.0.5.RELEASE\neclipselink 2.5.1\n\nAfter (Not working):\n\nspring-data-jpa 1.6.0.RELEASE\nspring-data-commons 1.8.0.RELEASE\nspring 4.0.5.RELEASE\neclipselink 2.5.1\n\nSee attachement for JUnit test case.\nI hope the single files are ok for you. If not I can upload a complete test project somewhere.\nI figured out that the problematic line of code seems to be ChildEntity:52.\nHere the child will be added to the list of children in the parent.\nI do not know if this is good style but it worked fine with previous version of spring-data.\nIs this really a bug or is the style of adding children to parents not more supported?\nThanks and best regards\nDennis", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.0.RELEASE", "fixed_version": "1.6.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformationIntegrationTests.java", "org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation.java"], "label": 1, "es_results": []}, {"bug_id": 611, "bug_title": "SimpleJpaRepository.findAll(Iterable<ID ids) not working when for composite primary keys", "bug_description": "I have a composite primary key and this is how i have incorporated it:\n@IdClass(PrimaryKey.class)\nclass Table {\n@Id\nprivate String id1;\n@Id\nprivate String id2;\n@Id\nprivate Integer id3;\n}\nclass PrimaryKey {\nprivate String id1;\nprivate String id2;\nprivate Integer id3;\n}\npublic interface TableRepository extends JpaRepository<Table, PrimaryKey>\nFindOne works fine with this PrimaryKey, however, it is unable to recognize the fields correctly when i use FindAll with a List of PrimaryKeys.\nAttached is a log.\nI use Hibernate with Spring Data JPA.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.0.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.RepositoryWithCompositeKeyTests.java", "org.springframework.data.jpa.repository.support.SimpleJpaRepository.java"], "label": 1, "es_results": []}, {"bug_id": 568, "bug_title": "Cannot update the new inserted entity which has @Version", "bug_description": "I have a record in database with ID=1 and version is 0(which is the initial value). When I save an entity from DTO W/ ID=1 and version is 0. I got the typical detached entity related exception.\nBecause in the class org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation,  the line 206 is return versionAttribute.getJavaType().isPrimitive() && ((Number) versionValue).longValue() == 0 \nwhich regards the version value = 0 as a NEW entity. Then the persist method will be mis-invoked.\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.1.RELEASE", "fixed_version": "1.7.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformationIntegrationTests.java", "org.springframework.data.jpa.domain.sample.PrimitiveVersionProperty.java", "org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation.java"], "label": 1, "es_results": []}, {"bug_id": 567, "bug_title": "OptimisticLock does not work anymore", "bug_description": "When migrating from spring-data-jpa 1.6.0 to 1.6.1.RELEASE, Optimistic Locking does not work anymore. Here is my entity:\n\n\n\n\n\n\n@Entity\n\n\n\n\n@Table\n\n\n\n\npublic class MyEntity implements Serializable {\n\n\n\n\n\n\n\n\n\n\t@Id\n\n\n\n\n\t@Column(unique = true, nullable = false)\n\n\n\n\n\tprivate String id;\n\n\n\n\n\n\n\n\n\n\t@Version\n\n\n\n\n\t@Column(name = \"version\")\n\n\n\n\n\tprivate long version;\n\n\n\n\n\t\n\n\n\n\n}\n\n\n\n\n\n\nThe following JUnit test works fine before 1.6.1:\n\n\n\n\n\n\n@Test(expected = OptimisticLockException.class)\n\n\n\n\npublic void testWithOptimisticLock() {\n\n\n\n\n\tMyEntity myEntity = new Entity();\n\n\n\n\n        myEntity.setId(\"myId\");\n\n\n\n\n\tmyEntityDao.save(myEntity);\n\n\n\n\n\tmyEntityDao.save(myEntity);\n\n\n\n\n}\n\n\n\n\n\n\nmyEntityDao is an interface which extends JpaRepository.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.1.RELEASE", "fixed_version": "1.7.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformationIntegrationTests.java", "org.springframework.data.jpa.domain.sample.PrimitiveVersionProperty.java", "org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation.java"], "label": 1, "es_results": []}, {"bug_id": 585, "bug_title": "Incomplete null handling in QueryDslJpaRepository ", "bug_description": "In QueryDslJpaRepository, when findAll(Predicate, Pageable) is called with a null Pageable, a NPE is thrown after the code tries to access the offset. However, delegation to the Querydsl helper class has dealt with the null value properly two lines above. ", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.1.RELEASE", "fixed_version": "1.9.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.support.QueryDslJpaRepositoryTests.java", "org.springframework.data.jpa.repository.support.QueryDslJpaRepository.java"], "label": 1, "es_results": []}, {"bug_id": 608, "bug_title": "JpaPersistentEntityImpl.isEntity() should consider actual type", "bug_description": "JpaPersistentProperty.isEntity() is defined to return true if the actual property type is an entity. So Collection and Map types need to inspect the component and value types. It&apos;s probably safe to simply rely on getActualType() here.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.4.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.jpa.mapping.JpaMetamodelMappingContextIntegrationTests.java", "org.springframework.data.jpa.mapping.JpaPersistentPropertyImpl.java"], "label": 1, "es_results": []}, {"bug_id": 617, "bug_title": "Named query lookups might cause transaction to be rolled back", "bug_description": "The execution of a paged repository method backed by a JPA named query might break the currently running transaction as it tries to look up a named count query but can mitigate a lookup failure. However, the failing lookup causes the transaction to be marked as rollback (as required by the JPA specification).\nWe should revisit named query validation and execution like we did for manually defined queries using @Query in DATAJPA-350.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.4.RELEASE", "fixed_version": "1.7.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.NamedQuery.java", "org.springframework.data.jpa.repository.support.JpaRepositoryFactoryUnitTests.java", "org.springframework.data.jpa.repository.CrudMethodMetadataIntegrationTests.java", "org.springframework.data.jpa.repository.query.NamedQueryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 605, "bug_title": "JpaPersistentPropertyImpl does not override method isVersionProperty", "bug_description": "JpaPersistentPropertyImpl is not overriding the isVersionProperty so if you call PersistentEntity.hasVersionProperty it could return incorrectly false.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.4.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.jpa.mapping.JpaPersistentPropertyImpl.java", "org.springframework.data.jpa.mapping.JpaPersistentPropertyImplUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 627, "bug_title": "Typo in BeanDefinitionNames.", "bug_description": "\n\n\n\n\n\n\tpublic static final String JPA_MAPPING_CONTEXT_BEAN_NAME = \"jpaMapppingContext\";\n\n\n\n\n\n\nshould be:\n\n\n\n\n\n\n\tpublic static final String JPA_MAPPING_CONTEXT_BEAN_NAME = \"jpaMappingContext\";\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.4.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.config.BeanDefinitionNames.java"], "label": 1, "es_results": []}, {"bug_id": 652, "bug_title": "Provide support for ParameterMode.REF_CURSOR", "bug_description": "As described here https://github.com/spring-projects/spring-data-examples/issues/44\nI was trying to execute a procedure on spring-data-jpa with hibernate on oracle 11g database.\n\n\n\n\n\n\nProcedure\n\n\n\n\n\n\nPROCEDURE MY_PROC (\n\n\n\n\n    P_ID IN NUMBER,\n\n\n\n\n    P_PERIOD IN VARCHAR2,\n\n\n\n\n    P_LIMIT IN NUMBER,\n\n\n\n\n    P_CURSOR OUT T_CURSOR);\n\n\n\n\n\n\n\n\n\n\n\n\nMyEntity.java\n\n\n\n\n\n\n@NamedStoredProcedureQuery(\n\n\n\n\n        name = \"myProc\",\n\n\n\n\n        procedureName = \"MY_PROC\",\n\n\n\n\n        resultClasses = ResultEntity.class,\n\n\n\n\n        parameters = {\n\n\n\n\n            @StoredProcedureParameter(mode = ParameterMode.IN, type = Long.class),\n\n\n\n\n            @StoredProcedureParameter(mode = ParameterMode.IN, type = String.class),\n\n\n\n\n            @StoredProcedureParameter(mode = ParameterMode.IN, type = Long.class),\n\n\n\n\n            @StoredProcedureParameter(mode = ParameterMode.REF_CURSOR, type = void.class)\n\n\n\n\n\n\n\n\n\n\n\n\nMyRepository.java\n\n\n\n\n\n\n@Procedure(name = \"myProc\", procedureName = \"MY_PROC\")\n\n\n\n\n    List<ResultEntity> execMyProc(Long userId,String period,Long idClientLimit);\n\n\n\n\n\n\n\n\n\n\n\n\nI was able run the procedure programmatically\n\n\n\n\nStoredProcedureQuery query = entityManager.createNamedStoredProcedureQuery(\"extractWebUser\");\n\n\n\n\nquery.setParameter(1, userId);\n\n\n\n\nquery.setParameter(2, period);\n\n\n\n\nquery.setParameter(3, idClientLimit);\n\n\n\n\nquery.execute();\n\n\n\n\nList resultList = query.getResultList();\n\n\n\n\n\n\nBut spring-data uses getOutputParameterValue Method instead of getResultList\n\n\n\n\n\n\nObject outputParameterValue = query.getOutputParameterValue(4);\n\n\n\n\n\n\nAnd it makes a lot of problems with hibernate\nHibernate does not support REF_CURSOR: https://github.com/hibernate/hibernate-orm/blob/4.3.7.Final/hibernate-core/src/main/java/org/hibernate/procedure/internal/AbstractParameterRegistrationImpl.java\nFinally, I moved to the EclipseLink and it worked perfectly.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.4.RELEASE", "fixed_version": "1.8.0.RC1", "fixed_files": ["org.springframework.data.jpa.domain.sample.User.java", "org.springframework.data.jpa.support.EntityManagerTestUtils.java", "org.springframework.data.jpa.repository.query.StoredProcedureAttributeSource.java"], "label": 1, "es_results": []}, {"bug_id": 681, "bug_title": "Execution of derived stored procedures fails if named parameters are used", "bug_description": "If a derived stored procedure is used (like here in the Spring Data examples) and named parameters are enabled (e.g., through compiling with -parameters on JDK 8) the execution fails as the output parameter will always be bound by position. This effectively means mixing named and positional parameters which is forbidden by the JPA spec.\nWe should alter newAdhocStoredProcedureQuery() by using a synthetic output parameter name if named parameters are used.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.6.5.RELEASE", "fixed_version": "1.8.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.query.StoredProcedureJpaQuery.java", "org.springframework.data.jpa.repository.query.StoredProcedureAttributeSourceUnitTests.java", "org.springframework.data.jpa.repository.query.StoredProcedureAttributes.java"], "label": 1, "es_results": []}, {"bug_id": 593, "bug_title": "Custom repository implementations are not picked up when using CDI", "bug_description": "", "project": "Spring", "sub_project": "DATAJPA", "version": "1.7.0.RC1", "fixed_version": "1.7.0.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.cdi.JpaRepositoryBean.java", "org.springframework.data.jpa.repository.cdi.JpaRepositoryExtension.java"], "label": 1, "es_results": []}, {"bug_id": 620, "bug_title": "Infinite loop in unsynchronized HashMap in CrudMethodMetadataPostProcessor", "bug_description": "The method org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor.CrudMethodMetadataPopulatingMethodIntercceptor#invoke is not thread-safe, although it is called concurrently when Spring-Data-JPA-Queries are executed concurrently.\nMore concretely, since the method uses the non-thread-safe java.util.HashMap, concurrent calls to this method may result in an infinite loop when executing the Hashmap-Lookup &apos;metadataCache.get(method)&apos; (line 101 in version 1.7.0.RELEASE), and I have actually encountered this behavior in an application. (Infinite loops in concurrently used hashmaps appear to be a known problem, see, e.g., https://jira.spring.io/browse/DATACMNS-518 or http://mailinator.blogspot.dk/2009/06/beautiful-race-condition.html.)\nI therefore believe that this method should be made thread-safe, e.g., by using a java.util.concurrent.ConcurrentHashMap.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.7.0.RELEASE", "fixed_version": "1.7.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 656, "bug_title": "Count query with group by returns wrong result", "bug_description": "The count method of SimpleJpaRepository. \n\n\n\n\n\n\npublic long count(Specification<T> spec) {\n\n\n\n\n\treturn getCountQuery(spec).getSingleResult();\n\n\n\n\n}\n\n\n\n\n\n\nGives a wrong result when using a specification having a group by.\nWhile the method below does this correctly for grouped queries.\n\n\n\n\n\n\nprotected Page<T> readPage(TypedQuery<T> query, Pageable pageable, Specification<T> spec) {\n\n\n\n\n\n\n\n\n\n\tquery.setFirstResult(pageable.getOffset());\n\n\n\n\n\tquery.setMaxResults(pageable.getPageSize());\n\n\n\n\n\n\n\n\n\n\tLong total = QueryUtils.executeCountQuery(getCountQuery(spec));\n\n\n\n\n\tList<T> content = total > pageable.getOffset() ? query.getResultList() : Collections.<T> emptyList();\n\n\n\n\n\n\n\n\n\n\treturn new PageImpl<T>(content, pageable, total);\n\n\n\n\n}\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.7.0.RELEASE", "fixed_version": "1.8.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.support.SimpleJpaRepository.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 629, "bug_title": "SPEL expression does not work with #{#entityName} in @Query", "bug_description": "", "project": "Spring", "sub_project": "DATAJPA", "version": "1.7.1.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.query.ExpressionBasedStringQuery.java"], "label": 1, "es_results": []}, {"bug_id": 798, "bug_title": "Repository query method fails when sorting with Pageable and query with line breaks.", "bug_description": "I have a repository with a custom query (using @Query) that has line breaks in the String specifying the query, for readability in the repository interface and in the log output. Specifically, the problem is that the original query in the @Query annotation is not correctly parsed when there are line breaks between the FROM and the main ENTITY.\n\n\n\n\n\n\n@Query(\n\n\n\n\n\t\"\tselect m \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\\n\"+\n\n\n\n\n\t\"\tfrom \\n Movement as m \t\t\t\t\t\t\t\t\t\t\t\t\t\t\\n\"+\t// WTF?? If there&apos;s a new line between the FROM and the main entity class alias (\"m\") SpringData fails to parse the query correctly!!\n\n\n\n\n\t\"\t\tleft join m.toAccount as toAcc\t\t\t\t\t\t\t\t\t\t\t\t\\n\"+\n\n\n\n\n\t\"\t\tleft join m.toAccount.owner as toOwn\t\t\t\t\t\t\t\t\t\t\\n\"+\n\n\n\n\n\t\"\twhere                                                                           \t\t\t\t\t\t\t\t\\n\"+\n\n\n\n\n\t\"\t\t(:login is null or (m.account.owner.login = :login) or (toOwn.login = :login))\t\t\t\\n\"+\t// The owner of the account transferred from/to\n\n\n\n\n\t\"\t\tand (:accountId is null or (m.account.id = :accountId) or (toAcc.id = :accountId))\t\t\\n\"+\t// Transfers from/to this account\n\n\n\n\n\t\"\t\tand (:movTypeKey is null or m.type.key = :movTypeKey)                         \t\t\t\\n\"+\n\n\n\n\n\t\"\t\tand (:movStatusKey is null or m.status.key = :movStatusKey)                   \t\t\t\\n\")\n\n\n\n\n\n\nI have included an attached .txt file with the details.\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.7.3.RELEASE", "fixed_version": "1.9.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 736, "bug_title": "Count query creation fails when entity names contain non-ASCII characters", "bug_description": "org.springframework.data.jpa.repository.query.QueryUtils.createCountQueryFor(String, String) uses pattern matching to derive the count query. However, this pattern matching does not support the presence of accented letters in entity names.\nAn example of a query for which the count query computation fails:\nselect you from Usr you where you.firstname like ?1%\nOf course the example is dumb, but in non-English languages entity names might have accents (JPA allows it).", "project": "Spring", "sub_project": "DATAJPA", "version": "1.8.0.RELEASE", "fixed_version": "1.8.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 759, "bug_title": "Log names of Class and Mapping Files found during scan to DEBUG level in ClasspathScanningPersistenceUnitPostProcessor", "bug_description": "This is very minor low-hanging fruit. \nWhen users troubleshoot Entity Manager classpath scanning, it is helpful to enable DEBUG logging to see what Entity/MappedSuperclass and Mapping Files are found by spring. In fact, this logging was the intention of the current code, however it fails to output the actual resource name that was found, as below:\n\n\n\n\n\n\n07/10/2015 11:17:43 DEBUG org.springframework.data.jpa.support.ClasspathScanningPersistenceUnitPostProcessor (ClasspathScanningPersistenceUnitPostProcessor.java:101) - Registering classpath-scanned entity %s in persistence unit info!\n\n\n\n\n07/10/2015 11:17:43 DEBUG org.springframework.data.jpa.support.ClasspathScanningPersistenceUnitPostProcessor (ClasspathScanningPersistenceUnitPostProcessor.java:106) - Registering classpath-scanned entity mapping file in persistence unit info!\n\n\n\n\n\n\nSince slf4j is being used, the fix is likely just adding the \"{}\" token instead of \"%s\".\n\n\n\n\n\n\nin: org.springframework.data.jpa.support.ClasspathScanningPersistenceUnitPostProcessor.postProcessPersistenceUnitInfo(MutablePersistenceUnitInfo)\n\n\n\n\n. . .\n\n\n\n\nLOG.debug(\"Registering classpath-scanned entity %s in persistence unit info!\", definition.getBeanClassName());\n\n\n\n\n. . .\n\n\n\n\nLOG.debug(\"Registering classpath-scanned entity mapping file in persistence unit info!\", location);\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.8.1.RELEASE", "fixed_version": "1.8.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.support.ClasspathScanningPersistenceUnitPostProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 758, "bug_title": "Using Java 8 named parameter prevents positional query parameter binding", "bug_description": "When I turned on parameter naming in the java 8 compiler all the non named parameters I have no longer work.\nIn other words, Spring Data JPA insists on using the parameter name...\nSimple Example:\n\n\n\n\n\n\n    @Query(\"select r from Role r where ?1 member of r.permissions\")\n\n\n\n\n    public List<Role> findByPermission(Permission permission);\n\n\n\n\n\n\nWorks fine without parameter names added to compiler.\nWhen I turn on the inclusion of parameter names I get this error:\nUsing named parameters for method public abstract java.util.List com.xxx.RoleRepository.findByPermission(com.xxx.Permission) but parameter &apos;permission&apos; not found in annotated query &apos;select r from AshesRole r where ?1 member of r.permissions&apos;!\nAnd if I now change it to:\n\n\n\n\n\n\n    @Query(\"select r from AshesRole r where :permission member of r.permissions\")\n\n\n\n\n    public List<Role> findByPermission(Permission permission);\n\n\n\n\n\n\nIt works again...\nThis could be by design - I understand that if it is the case. i.e. when you turn on parameter name inclusion then you must name all your parameters.\nA fall back to \"non named\" would be ideal if scanning with parameter names is not successful but that might be too much overhead.\nThough another option would be to allow the user to turn off using named parameters even when available. Developers might require parameter names in classes for some unrelated purpose and turning it on would break all their JPA queries (as they have not used it up to now).\nMaybe making it configurable per repository is an alternative...", "project": "Spring", "sub_project": "DATAJPA", "version": "1.8.1.RELEASE", "fixed_version": "1.8.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.ParameterMetadataProvider.java", "org.springframework.data.jpa.repository.query.JpaQueryMethodUnitTests.java", "org.springframework.data.jpa.repository.query.JpaQueryMethod.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 763, "bug_title": "Executing a Specification with fetch-joins leads to wrong HQL query", "bug_description": "IS\nCalling the mentioned method with a Specification which contains fetches only will lead to an added join clause for the entity used within the sort declaration. This leads to the following exception: \n\n\n\n\n\n\norg.springframework.dao.InvalidDataAccessApiUsageException: org.hibernate.QueryException: query specified join fetching, but the owner of the fetched association was not present in the select list\n\n\n\n\n\n\nSHOULD\nThe mentioned method should not add a join clause to the Root as there is already a suitable fetch join.\nHINTS\nThis behaviour cannot be reproduced in spring-data-jpa Version 1.2.0", "project": "Spring", "sub_project": "DATAJPA", "version": "1.8.1.RELEASE", "fixed_version": "1.8.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsIntegrationTests.java", "org.springframework.data.jpa.repository.query.EclipseLinkQueryUtilsIntegrationTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 805, "bug_title": "Typo in @Modifying documentation", "bug_description": "In @Modifying javadoc there&apos;s a typo in the description of the clearAutomatically attribute.\n    clearAutomatically\n public abstract boolean clearAutomatically\n    Defines whether we should clear the underlying persistence context after excuting the modifying query.\n Returns:\n Default:\nfalse\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.8.2.RELEASE", "fixed_version": "1.9.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.Modifying.java"], "label": 1, "es_results": []}, {"bug_id": 815, "bug_title": "order by qualifyReference when property begins with joinAlias", "bug_description": "When a property begins with a joinAlias, the order by clause incorrectly assigns the qualifyReference boolean.\nThe following query shows the problem.  It assumes Cat.created and Dog.created exist, and a Sort column of \"created\".\nfrom Cat c join Dog d\nBecause both tables have \"created\" as a column name and the property \"created\" begins with a joinAlias \"c\", the qualifyReference is set to false, resulting in \"order by created\" instead of \"order by c.created\".  This results in \"column reference created is ambiguous\".\nI have attached a patch that resolves the issue.\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.8.2.RELEASE", "fixed_version": "1.9.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 820, "bug_title": "New entity merged rather than persisted when ID is not generated and version is in a MappedSuperClass ", "bug_description": "Effect of bug is that SimpleJpaRepository::save(...) uses them.merge on a brand new entity, causing both  @PostPersist and @PostUpdate callbacks to be invoked.\nRequirements to hit the bug:\n\nAn Entity class that has a provided identity (i.e. no id generation), so the ID field is non-null at the very start.\n\n\n\n\n\n\n\npublic class User extends AbstractEntity {\n\n\n\n\n  @Id()\n\n\n\n\n  @Column(nullable = false, length = 64, unique = true)\n\n\n\n\n  private String phone;\n\n\n\n\n  ...\n\n\n\n\n}\n\n\n\n\n\n\n\nA MappedSuperclass that contains the version field:\n\n\n\n\n\n\n@MappedSuperclass\n\n\n\n\npublic abstract class AbstractEntity implements Serializable {\n\n\n\n\n\n\n\n\n\n  @Version\n\n\n\n\n  private Long version;\n\n\n\n\n  ...\n\n\n\n\n}\n\n\n\n\n\n\n\n=> With this, we will get two callbacks.\n=> Moving the version field from the abstract class to every concrete class causes the expected behaviour to occur.\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.9.0.RELEASE", "fixed_version": "1.9.1.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.support.JpaPersistableEntityInformationUnitTests.java", "org.springframework.data.jpa.repository.support.OpenJpaMetamodelEntityInformationIntegrationTests.java", "org.springframework.data.jpa.repository.support.EclipseLinkJpaMetamodelEntityInformationIntegrationTests.java", "org.springframework.data.jpa.domain.sample.AbstractMappedType.java", "org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformationIntegrationTests.java", "org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformationUnitTests.java", "org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation.java"], "label": 1, "es_results": []}, {"bug_id": 830, "bug_title": "NotContaining does not work for String properties on query methods", "bug_description": "", "project": "Spring", "sub_project": "DATAJPA", "version": "1.8.2.RELEASE", "fixed_version": "1.9.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.UserRepositoryFinderTests.java", "org.springframework.data.jpa.repository.query.ParameterMetadataProvider.java", "org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.query.JpaQueryCreator.java"], "label": 1, "es_results": []}, {"bug_id": 790, "bug_title": "org.hibernate.QueryException when applying @EntityGraph on (Querydsl) findAll(Predicate, Pageable) method", "bug_description": "The exception is thrown when applying @EntityGraph annotation on the Page<T> findAll(Predicate, Pageable) method in a repository interface.\nExample Stacktrace (source: stackoverflow):\n\n\n\n\n\n\norg.springframework.dao.InvalidDataAccessApiUsageException: org.hibernate.QueryException: query specified join fetching, but the owner of the fetched association was not present in the select list [FromElement{explicit,not a collection join,fetch join,fetch non-lazy properties,classAlias=appointment,role=com.physioclinic.entity.Appointment.createdBy,tableName=user,tableAlias=user5_,origin=appointment appointmen0_,columns={appointmen0_.createdBy_id ,className=com.physioclinic.entity.User}}] [select count(appointment)\n\n\n\n\nfrom com.physioclinic.entity.Appointment appointment where lower(concat(concat(appointment.patient.person.name,?1),appointment.patient.person.surname)) like ?2 escape &apos;!&apos;]; nested exception is java.lang.IllegalArgumentException: org.hibernate.QueryException: query specified join fetching, but the owner of the fetched association was not present in the select list [FromElement{explicit,not a collection join,fetch join,fetch non-lazy properties,classAlias=appointment,role=com.physioclinic.entity.Appointment.createdBy,tableName=user,tableAlias=user5_,origin=appointment appointmen0_,columns={appointmen0_.createdBy_id ,className=com.physioclinic.entity.User}}]\n\n\n\n\n\n\nApplying the annotation on the Iterable<T> findAll(Predicate) is not resulting with the exception (works just fine).", "project": "Spring", "sub_project": "DATAJPA", "version": "1.9.0.RELEASE", "fixed_version": "1.10.5.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.EntityGraphRepositoryMethodsIntegrationTests.java", "org.springframework.data.jpa.repository.sample.RepositoryMethodsWithEntityGraphConfigRepository.java", "org.springframework.data.jpa.repository.support.QueryDslJpaRepository.java"], "label": 1, "es_results": []}, {"bug_id": 848, "bug_title": "AbstractPersistable.equals() always returns false if target entity is a proxy", "bug_description": "I found a problem with org.springframework.data.jpa.domain.AbstractPersistable class equals method implementation.\nIt always return false if target entity for comparison is javassist proxy which hibernate returns for example if you do entityRepository.getOne(123) instead of findOne.\nThe problem is with line\n\n\n\n\n\n\nif (!getClass().equals(obj.getClass())) {\n\n\n\n\n\n\nThe obj.getClass returns something like Employee_$$_jvst860_de while this already deproxyfied and has class Employee. So this two classes of course not equal.\nI think we can do instead this:\n\n\n\n\n\n\nif (!getClass().isInstance(obj)) {\n\n\n\n\n\n\nOr this:\n\n\n\n\n\n\nClass<?> otherClass = HibernateProxyHelper.getClassWithoutInitializingProxy(obj);\n\n\n\n\nif (!getClass().equals(otherClass)) {\n\n\n\n\n\n\nThe second variant is more \"right\" because it excludes subclasses but using HibernateProxyHelper in AbstractPersistable is bad idea I think.\nThe first variant works but can&apos;t guarantee that obj is same class as this and not subclass (other than proxy). But I think even this is better then just return false for the same entity.\nSimple code to reproduce this bug:\n\n\n\n\n\n\nEmployee e1 = employeeRepository.getOne(15);\n\n\n\n\nEmployee e2 = employeeRepository.getOne(15);\n\n\n\n\nSystem.out.println(e1.getClass()); // Employee_$$_jvst860_de\n\n\n\n\nSystem.out.println(e2.getClass()); // Employee_$$_jvst860_de\n\n\n\n\n// The classes equal here but inside e1.equals method e1&apos;s &apos;this&apos; has class Employee (not proxy)\n\n\n\n\nSystem.out.println(e1.equals(e2)); // false\n\n\n\n\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAJPA", "version": "1.9.2.RELEASE", "fixed_version": "1.10.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.sample.CustomAbstractPersistableRepository.java", "org.springframework.data.jpa.domain.AbstractPersistable.java", "org.springframework.data.jpa.repository.AbstractPersistableIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 858, "bug_title": "Contains binding inspects first property for collections, not the leaf property", "bug_description": "\n\n\n\n\n\nclass User {\n\n\n\n\n  Set<Role> roles;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nclass Role {\n\n\n\n\n  String name;\n\n\n\n\n}\n\n\n\n\n\n\nA query findByRolesNameContaining() will fail as it tries to trigger collection contains binding as it&apos;s inspecting the first traversal (the one to roles). It has to inspect the leaf property instead and only trigger that special binding if the leaf property is a collection.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.9.2.RELEASE", "fixed_version": "1.10.0.M1", "fixed_files": ["org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.query.JpaQueryCreator.java"], "label": 1, "es_results": []}, {"bug_id": 920, "bug_title": "Add support for exists projection in repository query derivation", "bug_description": "Add support for exists projection in repository query derivation.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.9.2.RELEASE", "fixed_version": "1.11.0.RC1", "fixed_files": ["org.springframework.data.jpa.repository.query.JpaQueryCreator.java", "org.springframework.data.jpa.domain.sample.EmbeddedIdExampleEmployee.java", "org.springframework.data.jpa.repository.sample.UserRepository.java", "org.springframework.data.jpa.repository.RepositoryWithCompositeKeyTests.java", "org.springframework.data.jpa.repository.query.PartTreeJpaQueryIntegrationTests.java", "org.springframework.data.jpa.domain.sample.IdClassExampleDepartment.java", "org.springframework.data.jpa.repository.UserRepositoryTests.java", "org.springframework.data.jpa.repository.query.JpaQueryExecution.java", "org.springframework.data.jpa.repository.sample.EmployeeRepositoryWithEmbeddedId.java", "org.springframework.data.jpa.repository.sample.EmployeeRepositoryWithIdClass.java", "org.springframework.data.jpa.domain.sample.IdClassExampleEmployee.java", "org.springframework.data.jpa.repository.query.PartTreeJpaQuery.java"], "label": 1, "es_results": []}, {"bug_id": 903, "bug_title": "Stream<Object[]> missing result attributes on Hibernate", "bug_description": "Having \n\n\n\n\n\n\n \n\n\n\n\n    @Query(\"select 1,2,3,4 from Offer\")\n\n\n\n\n    Stream<Object[]> streamQuery();\n\n\n\n\n\n\n\n\n\n    @Query(\"select 1,2,3,4 from Offer\")\n\n\n\n\n    List<Object[]> listQuery();\n\n\n\n\n\n\n\n\n\n\n\n\n    @Test\n\n\n\n\n    public void listVsStreamQuery() throws Exception {\n\n\n\n\n        List<Object[]> res1 = testRepo.listQuery();\n\n\n\n\n        List<Object[]> res2 = testRepo.streamQuery().collect(Collectors.toList());\n\n\n\n\n\n\n\n\n\n        assertEquals(res1, res2);\n\n\n\n\n    }\n\n\n\n\n\n\nER. The above test passes. \nAR. The above test fails. res1 contains [[1,2,3,4]], res2 contains [1] (only first argument). \nIs this a known limitation of streaming approach?\nHibernate is the ORM provider. Using springBoot 1.3.3.RELEASE.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.9.4.RELEASE", "fixed_version": "1.10.2.RELEASE", "fixed_files": ["org.springframework.data.jpa.provider.PersistenceProvider.java"], "label": 1, "es_results": []}, {"bug_id": 960, "bug_title": "Order by clause not created correctly if a manually defined query is not using an alias", "bug_description": "In my repository I have:\n\n\n\n\n\n\n@Query(value = \"from mytable where\" \n\n\n\n\n\t\t+ \" name  LIKE CONCAT(&apos;%&apos;, :name, &apos;%&apos;) \"\n\n\n\n\n\t\t+ \"and  ((trunc ( to_date(date, &apos;DD/MM/YYYY&apos; )) = trunc (to_date(:date,&apos;DD/MM/YYYY&apos;))) or :date is null) \")\n\n\n\n\nList<Prodotto> cercaProdotto(@Param(\"name\") String name, @Param(\"date\") Date date, Pageable p);\n\n\n\n\n\n\n\n\n\nPageable and Sort (in service class):\n\n\n\n\nPageable p = new PageRequest(1, 10, mySort);\n\n\n\n\nSort mySort = new Sort(Sort.Direction.ASC, \"name\");\n\n\n\n\n\n\nI am getting an error finishing with:  order by where.name asc.", "project": "Spring", "sub_project": "DATAJPA", "version": "1.9.4.RELEASE", "fixed_version": "1.9.5.RELEASE", "fixed_files": ["org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 965, "bug_title": "Mapping Sort instances to ORDER BY expressions should be restricted to fields for manually defined queries", "bug_description": "", "project": "Spring", "sub_project": "DATAJPA", "version": "1.9.4.RELEASE", "fixed_version": "1.9.5.RELEASE", "fixed_files": ["org.springframework.data.jpa.domain.JpaSort.java", "org.springframework.data.jpa.repository.query.QueryUtilsUnitTests.java", "org.springframework.data.jpa.domain.JpaSortTests.java", "org.springframework.data.jpa.repository.query.QueryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 369, "bug_title": "Wrong query created when one value is a DBObject", "bug_description": "Regression in 1.0.0-RELEASE. Works as expected in 1.0.0-RC1\nQuery: { \"type\" : \n{ \"$in\" : [ \"folder\"]}\n , \"deleted\" : false }\nWhen a query contains a DBObject as a value like \"type\" in the example QueryMapper.getMappedObject will return in line 103 ignoring all further keys of the query.\nThis results in the query { \"type\" : \n{ \"$in\" : [ \"folder\"]}\n } sent to MongoDB.\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.QueryMapper.java", "org.springframework.data.mongodb.core.query.QueryMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 376, "bug_title": "Fix potential NPE in SpringDataMongodbSerializer", "bug_description": "We currently run into a NPE in case no property with the to-string expression is found. This is inevitably the case if an any() expression is used in the predicate because of the way visit() is implemented in the superclass. I&apos;ve opened a ticket against Querydsl to prevent the invocation (as it doesn&apos;t seem necessary) but we should guard against the issue nevertheless.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.support.SpringDataMongodbSerializerUnitTests.java", "org.springframework.data.mongodb.repository.support.QueryDslMongoRepository.java"], "label": 1, "es_results": []}, {"bug_id": 368, "bug_title": "Empty values in collections are not supported", "bug_description": "Using the MongoDB command line it is possible to insert null values as part of a collection:\n\n\n\n\n\n\n> db.test.insert({x: [1,2,3,null,3,2,3,4]})\n\n\n\n\n\n\nIn the result it will still be visible:\n\n\n\n\n\n\n> db.test.find()\n\n\n\n\n{ \"_id\" : ObjectId(\"4f01a3cb41e58d141d6c06ab\"), \"x\" : [ 1, 2, 3, null, 3, 2, 3, 4 ] }\n\n\n\n\n\n\nUsing Spring Data (RC1) the null values are removed by the MappingMongoConverter.writeCollectionInternal(Collection<?> source, TypeInformation<?> type, BasicDBList sink) method.\nFor sample code:\n\n\n\n\n\n\nList<Number> al = new ArrayList<Number>();\n\n\n\n\nal.add(1);\n\n\n\n\nal.add(null);\n\n\n\n\nal.add(2);\n\n\n\n\nTest test = new Test();\n\n\n\n\ntest.setX(al);\n\n\n\n\noperations.insert(test, \"test2\");\n\n\n\n\n\n\nThe result is:\n\n\n\n\n\n\n> db.test2.find()\n\n\n\n\n{ \"_id\" : ObjectId(\"4f01a50d3372f368908a571a\"), \"_class\" : \"nl.eid.dashboard.mvc.ajax.dashboard.Test\", \"x\" : [ 1, 2 ] }\n\n\n\n\n\n\nI would expect the null value in the result. The writeCollectionInternal() method should not remove the null values.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 387, "bug_title": "Executing query methods with GeoPage results does not work", "bug_description": "When using GeoPage as return value for repository query methods we run into a ClassCastException.\n\n\n\n\n\n\norg.springframework.data.mongodb.core.geo.GeoResults cannot be cast to org.springframework.data.mongodb.core.geo.GeoPage\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.AbstractMongoQuery.java", "org.springframework.data.mongodb.repository.query.MongoQueryCreator.java", "org.springframework.data.mongodb.repository.AbstractPersonRepositoryIntegrationTests.java", "org.springframework.data.mongodb.repository.query.PartTreeMongoQuery.java", "org.springframework.data.mongodb.repository.PersonRepository.java"], "label": 1, "es_results": []}, {"bug_id": 358, "bug_title": "Nested List does not work anymore for a @Document", "bug_description": "An object that looks like this:\n@Document\nItem {\n  List<Attribute> attributes;\n}\nAttribute {\n  String key;\n  Object value;\n}\nE.g.\nItem item = new Item();\nList<Attribute> list = new ArrayList<Attribute>();\nAttribute attribute = new Attribute();\nattribute.setKey(\"key\");\nList<String> valueList = new ArrayList();\nvalueList.add(\"1\");\nvalueList.add(\"2\");\nattribute.setValue(valueList);\nIf you persist that Document and retrieve it again, the valueList List is now just an Object reference with no data.\nIf you create an Attribute where the value is a List it now fails to convert that property back to a list. \nThis used to work up until M5.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 385, "bug_title": "MongoRepositoryFactory does not support id classes of type java.lang.Long", "bug_description": "It is not possible to use a MongoRepository with Long id class:\n\n\n\n\n\n\npublic interface TestRepository extends MongoRepository<TestEntity, Long> {  }\n\n\n\n\n\n\n\n\n\n\n\n\n@Document\n\n\n\n\npublic class TestEntity\n\n\n\n\n{\n\n\n\n\n  @Id\n\n\n\n\n  private Long id;\n\n\n\n\n  \n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.RC1", "fixed_version": "1.0.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.support.MongoRepositoryFactoryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 401, "bug_title": "StringBasedMongoQuery suffers from NullPointerException in case a null parameter gets bound to a parameter placeholder", "bug_description": "Given a repository:\n\n\n\n\n\n\nprivate interface SampleRepository extends Repository<Person, Long> {\n\n\n\n\n\n\n\n\n\n  @Query(\"{ &apos;lastname&apos; : ?0 }\")\n\n\n\n\n  Person findByLastname(String lastname);\n\n\n\n\n}\n\n\n\n\n\n\nwhen you call the repository method as follows:\n\n\n\n\n\n\nrepo.findByLastname(null);\n\n\n\n\n\n\none is currently getting:\n\n\n\n\n\n\njava.lang.NullPointerException\n\n\n\n\n  at org.springframework.data.mongodb.repository.query. StringBasedMongoQuery.getParameterWithIndex(StringBasedMongoQuery.java:103)\n\n\n\n\n  at org.springframework.data.mongodb.repository.query. StringBasedMongoQuery.replacePlaceholders(StringBasedMongoQuery.java:95)\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.StringBasedMongoQueryUnitTests.java", "org.springframework.data.mongodb.repository.query.StringBasedMongoQuery.java"], "label": 1, "es_results": []}, {"bug_id": 354, "bug_title": "MongoTemplate does not support multiple $pushAll in one update", "bug_description": "Update.push uses \"addMultiFieldOperation\". For some reason Update.pushAll does not. Second pushAll over-writes the first one.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.RC1", "fixed_version": "1.4.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.query.UpdateTests.java", "org.springframework.data.mongodb.core.query.Update.java"], "label": 1, "es_results": []}, {"bug_id": 411, "bug_title": "Potential ClassCastExceptions in MongoPersistentEntityIndexCreator", "bug_description": "The Spring ApplicationEvent mechanism uses some mechanism to select event listeners based on generic types. Unfortunately it does not consider nested generic types which we use to distinguish a mapping event for MongoDB from one for Neo4j e.g. Thus the MongoPersistentEntityIndexCreator will get invoked for mapping events for other stores as well. Thus we have to double check the event types before invoking further code.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexCreator.java"], "label": 1, "es_results": []}, {"bug_id": 412, "bug_title": "getUserCredentials() is called twice in AbstractMongoConfiguration::mongoDbFactory()", "bug_description": "During MongoDbFactory creation in mongoDbFactory(), getUserCredentials() is called twice:\n\n\n\n\n\n\nif (getUserCredentials() == null) {\n\n\n\n\n return new SimpleMongoDbFactory(mongo(), getDatabaseName());\n\n\n\n\n} else {\n\n\n\n\n return new SimpleMongoDbFactory(mongo(), getDatabaseName(), getUserCredentials());\n\n\n\n\n}\n\n\n\n\n\n\nIt is almost not worth mentioning, but for pedantic reasons it would be better to do:\n\n\n\n\n\n\nUserCredentials userCredentials = getUserCredentials();\n\n\n\n\nif (userCredentials == null) {\n\n\n\n\n return new SimpleMongoDbFactory(mongo(), getDatabaseName());\n\n\n\n\n} else {\n\n\n\n\n return new SimpleMongoDbFactory(mongo(), getDatabaseName(), userCredentials);\n\n\n\n\n}\n\n\n\n\n\n\nAlmost always override of getUserCredentials() would look like:\n\n\n\n\n\n\n@Override\n\n\n\n\npublic UserCredentials getUserCredentials() {\n\n\n\n\n  return new UserCredentials(..., ...);\n\n\n\n\n}\n\n\n\n\n\n\nand there is no need to create UserCredentials twice, even if it only happens during startup.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.config.AbstractMongoConfiguration.java", "org.springframework.data.mongodb.core.TestMongoConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 422, "bug_title": "UUIDToBinaryConverter not compatible with mongo java driver", "bug_description": "UUID to Binary conversion as implemented in spring-data-mongodb converts the UUID to a string and saves it as a mongo Binary with subtype BSON.B_UUID:\n\n\n\n\n\n\nreturn source == null ? null : new Binary(BSON.B_UUID, source.toString().getBytes(\"UTF-8\"));\n\n\n\n\n\n\nThe java driver reads this value back in with\n\n\n\n\n\n\norg.bson.BasicBSONDecoder\n\n\n\n\n\n\ncase B_UUID:\n\n\n\n\n    if ( totalLen != 16 )\n\n\n\n\n        throw new IllegalArgumentException( \"bad data size subtype 3 len: \" + totalLen + \" != 16\");\n\n\n\n\n\n\n\n\n\n    long part1 = _in.readLong();\n\n\n\n\n    long part2 = _in.readLong();\n\n\n\n\n    _callback.gotUUID(name, part1, part2);\n\n\n\n\n    return;\n\n\n\n\n}\n\n\n\n\n\n\nThat obviously does not work because the java driver expects to read in 2 x 8 bytes containing the most and least significant bytes when it encounters the binary subtype BSON.B_UUID. The converter has to save UUIDs as in BasicBSONEncoder (method putUUID, arround line 266 in 2.7.1) in order for this to work.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MongoConvertersUnitTests.java", "org.springframework.data.mongodb.core.convert.CustomConversions.java", "org.springframework.data.mongodb.core.convert.MongoConverters.java", "org.springframework.data.mongodb.core.convert.CustomConversionsUnitTests.java", "org.springframework.data.mongodb.core.mapping.MongoSimpleTypes.java"], "label": 1, "es_results": []}, {"bug_id": 425, "bug_title": "Binding a Date to a manually defined repository query fails", "bug_description": "See this StackOverflow question for details.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.config.MongoNamespaceIntegrationTests.java", "org.springframework.data.mongodb.repository.Person.java", "org.springframework.data.mongodb.repository.AbstractPersonRepositoryIntegrationTests.java", "org.springframework.data.mongodb.repository.PersonRepository.java", "org.springframework.data.mongodb.repository.query.StringBasedMongoQuery.java"], "label": 1, "es_results": []}, {"bug_id": 424, "bug_title": "Declaring a list of DBRef in a domian class results in Null for each DBRef when reading from mongo database", "bug_description": "We have a requirement that we have to be able to define the following field in our domain class. The reason that we need to have such restriction is that this domain is used for integration with another system.\n\n\n\n\n\n\n@Field(\"deletions\")\n\n\n\n\nprivate List<com.mongodb.DBRef> deletions;\n\n\n\n\n\n\nSaving of deletions collections works fine and I can verify deletions list stored properly. However, when the list is read from Mongo DB, all instance of com.mongodb.DBRef are null. I had the same issue with having define one com.mongodb.DBRef in a domain class, but I could get around with that by creating a reading converter that converts from com.mongodb.DBRef to com.mongodb.DBRef ", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.1.RELEASE", "fixed_version": "1.1.0.M2", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 420, "bug_title": "Extra quotes being added to @Query values and fields", "bug_description": "Quotes are being added to values passed into @Query annotations.\n@Query( value = \"\n{ ?0 }\n\", fields = \"\n{ ?1 }\n\" )\nsomeMethod( String values, String fields );\nWhatever I pass into \"values\" or \"fields\" gets wrapped in quotes when inserted into the query sent to MongoDB.\nString values = \"value : &apos;things&apos;\";\n  -> rendered as - \n{ \"value : &apos;things&apos;\" }\n  -> This is not a valid query - the double quotes around it break it.\nString values = \"field : 0\";\n  -> rendered as - \n{ \"field : 0\" }\n  -> This is not a valid projection - the double quotes around it break it.\nString values = \"field\\\" : \\\"0\";\n  -> rendered as - \n{ \"field\" : \"0\" }\n  -> This is not a valid projection - the double quotes around zero turn it into a string so it renders as \"true\" instead of 0/undefined.\nThanks.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.1.RELEASE", "fixed_version": "1.5.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.StringBasedMongoQueryUnitTests.java", "org.springframework.data.mongodb.repository.query.StringBasedMongoQuery.java"], "label": 1, "es_results": []}, {"bug_id": 483, "bug_title": "@Indexed(unique=true, name=\"foo\") puts name's value to the 'key' in the MongoDB ", "bug_description": "Here is the example:\n\n\n\n\n\n\n@Document\n\n\n\n\nclass User {\n\n\n\n\n   @Id\n\n\n\n\n   private String id;\n\n\n\n\n   \n\n\n\n\n   @Indexed(unique=true, name=\"username_unique_1\")\n\n\n\n\n   @Field(\"username\")\n\n\n\n\n   private String user_name;\n\n\n\n\n} \n\n\n\n\n\n\nSpring Data will generate the follwoing index document: \n\n\n\n\n\n\n{ \"v\" : 1, \"key\" : { \"username_unique_1\" : 1 }, \"unique\" : true, \"ns\" : \"test_db.user\", \"name\" : \"username_unique_1\", \"dropDups\" : false, \"sparse\" : false }\n\n\n\n\n\n\nHowever the expected document is:\n\n\n\n\n\n\n{ \"v\" : 1, \"key\" : { \"username\" : 1 }, \"unique\" : true, \"ns\" : \"test_db.user\", \"name\" : \"username_unique_1\", \"dropDups\" : false, \"sparse\" : false }\n\n\n\n\n\n\nI think the expected behavior is: @Indexed.name should correpond to name in the index document, while @Field.value should correpsond to the key in the index document. If @Field is absent, than field name should be used as a key in the index document.\nThe current implementation confusing: if you put something different from a field name into @Indexed.name, your index will be created on nonexistent field. However this is why we need @Indexed.name - to add a descriptive name to the index.\nIf someone wants to use @Indexed.name for creating an index on non-existen field (to be honest can&apos;t imagine the case) then low-level API like execute on DBCollection should be used.\nThe issue is related to the line 165 of MongoPersistentEntityIndexCreator.java where @Inbdexed.name is implicitly used as a name of the field on which index should be created.\nP.S. Before submitting this issue I&apos;ve seatched this JIRA for similar defact and found couple of them:\n\nDATAMONGO-70\nDATAMONGO-79\nDATAMONGO-237\n\nThe mentioned issues doesn&apos;t describe the problem in full.\nGuys, would you like me to sumbit a patch for that?", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.2.RELEASE", "fixed_version": "1.0.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexCreator.java", "org.springframework.data.mongodb.core.index.CompoundIndex.java"], "label": 1, "es_results": []}, {"bug_id": 480, "bug_title": "The WriteResultChecking is not used in case of insert or save of documents.", "bug_description": "The insertDBObject(), insertDBObjectList() and saveDBObject() do not use the WriteResultChecking similar to what is done in doInsert() and doUpdate() methods.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.2.RELEASE", "fixed_version": "1.0.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 489, "bug_title": "ClassCastException when loading Map<String, String[]>", "bug_description": "When saving a regular Java Map with array inside (as in SolrQuery), it seems that Spring Sata saves the object fine, but when you trying to read it, it is a Map with List as the value type. When you&apos;re trying to work with the object you&apos;re getting a ClassCastException: java.util.ArrayList cannot be cast to [Ljava.lang.String. We find that the problem is in MappingMongoConverter#readCollectionOrArray(), at this line:\n\n\n\n\n\n\ncollectionType = Collection.class.isAssignableFrom(collectionType) ? collectionType : List.class;\n\n\n\n\n\n\nWhen the type is array (String[]) it obviously cannot be assigned to Collection so it returns it as a List. Possible solution is to return an object from this method and handle arrays too. There is a main that reproduce that issue as an attachment.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.2.RELEASE", "fixed_version": "1.0.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 481, "bug_title": "After upgrading to 1.0.2 IsTrue does not work properly in query method", "bug_description": "For such created query:\nAccount findByUsernameAndConfirmedIsTrue(String username);\nI see following in logs:\nCreated query Query: { \"confirmed\" : true , \"$and\" : [ \n{ \"confirmed\" : true}\n]}, Fields: null, Sort: null\nAnd the query does not return proper value.\nIn previous release (1.0.1.RELEASE) the same code produces valid query:\nCreated query \n{ \"username\" : \"me\" , \"confirmed\" : true}", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.2.RELEASE", "fixed_version": "1.0.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.MongoQueryCreator.java", "org.springframework.data.mongodb.repository.query.MongoQueryCreatorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 469, "bug_title": "Query creation from method names using AND criteria does not work anymore", "bug_description": "When migrating from 1.0.1 to 1.0.2, one of my test failed.\n\n\n\n\n\n\n@Test\n\n\n\n\npublic void testFindByPseudoAndPassword_wrongPseudo() {\n\n\n\n\n    Member member = new Member(\"pseudo\");\n\n\n\n\n    member.setPassword(\"password\");\n\n\n\n\n\n\n\n\n\n    memberRepository.save(member);\n\n\n\n\n\n\n\n\n\n    Member findMember = memberRepository.findByPseudoAndPassword(\"wrong-pseudo\", \"password\");\n\n\n\n\n    assertThat(findMember).isNull(); // FAILS HERE because the query retrieve the member with password equals \"password\" and miss the pseudo value\n\n\n\n\n}\n\n\n\n\n\n\nand the log is : \n\n\n\n\n\n DEBUG [MongoTemplate] findOne using query: { \"password\" : \"password\" , \"$and\" : [ { \"password\" : \"password\"}]} \n\n\n\n\n\n\nI saw that in https://github.com/SpringSource/spring-data-mongodb/blob/1.0.x/spring-data-mongodb/src/test/java/org/springframework/data/mongodb/repository/query/MongoQueryCreatorUnitTests.java there is no assertion for the test #createsQueryCorrectly which test the Criteria AND case.\nMay be it is due to https://github.com/SpringSource/spring-data-mongodb/commit/c8bb46ffb3b2ffa5456417a199ffa0d3b977bf0b", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.2.RELEASE", "fixed_version": "1.0.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.MongoQueryCreator.java", "org.springframework.data.mongodb.repository.query.MongoQueryCreatorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 521, "bug_title": "Query creation from method names using AND criteria does not work anymore", "bug_description": "I created a simple repository like below\n\n\n\n\n\n\npublic interface PersonRepository extends PagingAndSortingRepository<Person, String> {\n\n\n\n\n\t\n\n\n\n\n\tPerson findOneByFirstname(String name);\n\n\n\n\n\tPerson findOneByFirstnameAndLastname(String firstname, String lastname);\n\n\n\n\n}\n\n\n\n\n\n\nand when queried using this repository\n\n\n\n\n\n\nPerson p = repository.findOneByFirstnameAndLastname(\"Shirish\",\"Reddy\");\n\n\n\n\n\n\nThe command that goes in to mongodb is\nrunQuery called db.persons \n{ lastname: \"Reddy\" }\n where as it should be having ", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.3.RELEASE", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.AbstractPersonRepositoryIntegrationTests.java", "org.springframework.data.mongodb.repository.PersonRepository.java", "org.springframework.data.mongodb.repository.PersonRepositoryIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 539, "bug_title": "Document remove does not work when giving collection name as a parameter", "bug_description": "I have a document that is put to different kinds of collections, depending on the need. Therefore, I need to use mongoOperations.save(item, \"collection\") method to save the document. Saving works fine, but removing the item with a call like this: mongoOperations.remove(item, \"collection\") doesn&apos;t actually remove the document. The remove operation doesn&apos;t fail, but the document still exists in the collection.\nRemove works when using spring-data-mongo version 1.0.1 and 1.0.2.\nHere&apos;s some test code to show a failing test:\n\n\n\n\n\n\nItem item = new Item(\"kukkuu\");\n\n\n\n\nmongoOperations.save(item, \"test\");\n\n\n\n\nmongoOperations.remove(item, \"test\");\n\n\n\n\nassertThat(mongoOperations.findAll(Item.class, \"test\").isEmpty(), is(Boolean.TRUE));\n\n\n\n\n\n\nThe Item is defined as:\n\n\n\n\n\n\n@Document\n\n\n\n\npublic class Item {\n\n\n\n\n\n\n\n\n\n    @Id\n\n\n\n\n    private String id;\n\n\n\n\n    private String name;\n\n\n\n\n\n\n\n\n\n    public Item(String name) {\n\n\n\n\n        this.name = name;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    public String getName() {\n\n\n\n\n        return name;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    public String getId() {\n\n\n\n\n        return id;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    public void setId(String id) {\n\n\n\n\n        this.id = id;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    public void setName(String name) {\n\n\n\n\n        this.name = name;\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.3.RELEASE", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 540, "bug_title": "MongoTemplate upsert and findOne handle id queries differently", "bug_description": "With a domain object class that has @Id annotated property:\n\n\n\n\n\n\npublic class Item {\n\n\n\n\n  @Id\n\n\n\n\n  private String id;\n\n\n\n\n  \n\n\n\n\n\n\nIf these objects are upserted using MongoTemplate and the resulting object is then fetched with exactly the same query using findOne() method, the upsert fails silently (ie. no exception or error messages in debug logs) but findOne() returns the correct object (in applications point of view).\n\n\n\n\n\n\nQuery query = new Query(Criteria.where(\"id\").is(identifier));\n\n\n\n\nmongoTemplate.upsert(query, update, collectionName);\n\n\n\n\nItem item = mongoTemplate.findOne(query, Item.class, collectionName);\n\n\n\n\n\n\nIn mongod logs:\n\n\n\n\n\n\nThu Sep 13 14:25:51 [conn91] update db.collection query: { id: \"foo\" } update: { $inc: { totalClickCount: 1 } } 0ms\n\n\n\n\nThu Sep 13 14:25:51 [conn91] query db.collection query: { _id: \"foo\" } ntoreturn:1 idhack:1 reslen:61 0ms\n\n\n\n\n\n\nThis shows that in upsert method, id in the query is resolved to id, whereas in findOne() method it is resolved to _id. \nBecause of this, the upsert creates or updates a document {id : \"foo\", _id : \n{\"$oid\" : <something>}\n ...} but findOne returns the document {_id : \"foo\" ...}\nIf I change the property in query to _id like this: \n\n\n\n\n\n\nQuery query = new Query(Criteria.where(\"_id\").is(identifier));\n\n\n\n\n\n\neverything works as expected.\nNow I know, having browsed through this project&apos;s JIRA, that it is confusing to use id-property and @Id at the same time and should be avoided. The problem here is, I AM GOING TO, that MongoTemplate methods resolve these queries differently leading to confusing results.\nThe example works as expected (upsert() succeeds and findOne() returns the created object) up until 1.0.2.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.3.RELEASE", "fixed_version": "1.2.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java"], "label": 1, "es_results": []}, {"bug_id": 458, "bug_title": "When reading back empty collections unmodifiable instances of Collections.emptyList/Set is returned.", "bug_description": "When reading back a document stored with an empty collection, e.g:\n  private Set<ClusterId> clusters = new HashSet<ClusterId>();\nThe driver deserializes this into a instance of Collections.emptySet, thus causing UnsupportedOperation exception when modifying.\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.M1", "fixed_version": "1.1.0.M2", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 508, "bug_title": "DBRef can accidentally get added as PersistentProperty", "bug_description": "MappingMongoConverter.createDBRef() inspects the given object&apos;s metadata to extract id value and collection information of it. In case the given object is a DBRef already this is not necessary. Actually it will cause DBRef being added as PersistentEntity which should be avoided.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.M2", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 505, "bug_title": "Conversion of associations does not work for collection values", "bug_description": "Assume you have the following scenario:\n\n\n\n\n\n\nclass Entity {\n\n\n\n\n\n\n\n\n\n  Long id;\n\n\n\n\n  @DBRef\n\n\n\n\n  Property property;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nclass Property {\n\n\n\n\n  Long id;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\ninterface EntityRepository extends Repository<Entity, Long> {\n\n\n\n\n\n\n\n\n\n  Entity findByPropertyIn(Property... property);\n\n\n\n\n}\n\n\n\n\n\n\nThe execution of findByProperty() will fail as the given array (or collection) is not correctly translated into a collection of DBRefs. The reason is that ConvertingIterator treats the value as is and wants to create a DBRef from it. We need to unwrap the elements and convert them into DBRef instances one by one.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.M2", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.data.mongodb.repository.query.ConvertingParameterAccessorUnitTests.java", "org.springframework.data.mongodb.repository.query.ConvertingParameterAccessor.java"], "label": 1, "es_results": []}, {"bug_id": 517, "bug_title": "QueryMapping incorrectly translates complex keywords", "bug_description": "For queries with keywords having complex values (e.g. \n{ \"$in\" : [  ] }\n) QueryMapper drops the keyword and makes the converted complex value the value of the actual property reference.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.M2", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapper.java", "org.springframework.data.mongodb.core.convert.QueryMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 523, "bug_title": "@TypeAlias annotation not used with AbstractMongoConfiguration ", "bug_description": "When using the AbstractMongoConfiguration without any further modifications regarding the converter (afterMappingMongoConverterCreation) the @TypeAlias annotation is not used when writing the _class property. Seems like it always uses the SimpleTypeInformationMapper. The documentation suggests that you just annotate your @Document classes with the @TypeAlias annotations and everything should be fine. ", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.4.RELEASE", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 527, "bug_title": "Criteria.equals() broken for complex criterias", "bug_description": "", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.4.RELEASE", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.query.Criteria.java", "org.springframework.data.mongodb.core.query.CriteriaTests.java"], "label": 1, "es_results": []}, {"bug_id": 532, "bug_title": "Multithreading authentication issue", "bug_description": "I have come across an issue which results in the following exception to be thrown.\n\n\n\n\n\n\njava.lang.RuntimeException: org.springframework.data.mongodb.CannotGetMongoDbConnectionException: Failed to authenticate to database\n\n\n\n\n\n\nThis appears to be caused by multiple threads trying to authenticate a single DB instance. The bug appears to be in MongoDbUtils in the doGetDB() method. The method retrieves the DB object for a given name and checks if it is authenticated, if it is not authenticated then it will authenticate it with the given username and password. However, if two threads check the same DB object they will both attempt to authenticate which leads to the exception being thrown. I have checked the latest source code in the git repository and the bug still appears to be present. To solve this issue I have replaced lines 109 - 118 with:\n\n\n\n\n\n\nif (credentialsGiven && !db.isAuthenticated()) {\n\n\n\n\n\tString username = credentials.getUsername();\n\n\n\n\n\tString password = credentials.hasPassword() ? credentials.getPassword() : null;\n\n\n\n\n\tsynchronized (db) {\n\n\n\n\n\t\tif (!db.isAuthenticated() && !db.authenticate(username, password == null ? null : password.toCharArray())) {\n\n\n\n\n\t\t\tthrow new CannotGetMongoDbConnectionException(\"Failed to authenticate to database [\" + databaseName\n\n\n\n\n\t\t\t\t\t+ \"], username = [\" + username + \"], password = [\" + password + \"]\", databaseName, credentials);\n\n\n\n\n\t\t}\t\n\n\n\n\n\t}\n\n\n\n\n}\n\n\n\n\n\n\nThe synchronized block could be moved to include both if statements which would remove the need for the second call to isAuthenticated() but it would mean that each time the doGetDb() method is called the synchronized block will be entered. Whereas the above will only be synchronized on calls to doGetDb() when the db has not been authenticated, with the compromise that the isAuthenticated() method has to be called twice.\nI have run the above fix (well the same fix based on the 1.0.4.RELEASE code) and it appears to solve the issue.\nA second issue to be aware of is the pre version 2.9.0 of the java mongo driver has a multithreading bug described in the link below. I have had a look a the latest dev version of spring-mongo and it is still using 2.7.1 so it would be worth considering the upgrade.\nhttps://jira.mongodb.org/browse/JAVA-582", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.4.RELEASE", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoDbUtils.java"], "label": 1, "es_results": []}, {"bug_id": 530, "bug_title": "MongoMappingContext.setApplicationContext() does not invoke superclass method", "bug_description": "AbstractMappingContext.setApplicationContext() does not get invoked on invocations of MongoMappingContext.setApplicationContext(). This causes the entity initialization not being triggered correctly.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.RC1", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.mapping.MongoMappingContextUnitTests.java", "org.springframework.data.mongodb.core.mapping.MongoMappingContext.java"], "label": 1, "es_results": []}, {"bug_id": 535, "bug_title": "Retrieve of existing Mongo DB from Transaction is not working", "bug_description": "dbHolder.doesNotHoldNonDefaultDB() in MongoDbUtils.doGetDB() is always false, so the DbHolder is never used. \nMongoDbUtils.doGetDB() is also always registering synchronization for the same Mongo instance on every call. For two or more calls it fails to unbindResource() because resource is already unbounded.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.0.4.RELEASE", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoDbUtils.java", "org.springframework.data.mongodb.core.MongoDbUtilsUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 549, "bug_title": "MongoTemplate.save() suffers from potential NullPointException", "bug_description": "MongoTemplate.save() runs into a NullPointerException in case the object handed in is a Mongo-primitive one (Map, Collection, Java-primitive). Also if the object handed into the method is null already we run into an NPE as well.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 550, "bug_title": "MongoTemplate.save(BasicDBObject, String) results in NPE (after upgrading to 1.1.0.RELEASE", "bug_description": "", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 551, "bug_title": "MongoTemplate.save(String, String) results in NPE (after upgrading to 1.1.0.RELEASE", "bug_description": "In this case the String we are talking about is a JSON String. ", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 553, "bug_title": "StackOverflowError when objects have cycles", "bug_description": "The issue was first reported to Spring Integration project: https://jira.springsource.org/browse/INT-2778 and we narrowed down the problem to the fact that the persisted object had a cycle. In the reported case persisted object is Exception who&apos;s default &apos;because&apos; is &apos;this&apos; thus creating a cycle.\nI think classes of type Throwable needs to be treated in a special way where instead of using Reflection getCause() should be called.\nHowever it would also help to have some cycle detection mechanism even for the purpose of throwing a more meaningful exception (e.g., Cycle detected)", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.mapping.SimpleMongoMappingContext.java", "org.springframework.data.mongodb.core.mapping.BasicMongoPersistentPropertyUnitTests.java", "org.springframework.data.mongodb.core.mapping.BasicMongoPersistentProperty.java", "org.springframework.data.mongodb.core.mapping.MongoPersistentProperty.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 585, "bug_title": "Exception during authentication in multithreaded access", "bug_description": "Bug & further details are here:\nhttp://forum.springsource.org/showthread.php?132878-can-t-authenticate-twice-on-same-database\nSpecifically what can be used for a test case is use a ThreadPoolExecutor, set a minpool and maxpool value of 5, add 25 objects to be executed.  Those objects are a class which implements Runnable.  \nThose objects each then perform a bunch of inserts into mongoDB using a DocumentDao which calls mongoOperations.insert.\nthanks", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoDbUtils.java"], "label": 1, "es_results": []}, {"bug_id": 534, "bug_title": "The GridFs query execution does not return sorted resources, when the sorting fields are defined in the query definition", "bug_description": "The sorting fields of a Query instance are disregarded during the query execution using an instance of GridFsOperations. The result sets of the found GridFS files are not sorted no matter of the existence of the sorting fields in the preceding query. I expected the resources to be sorted according to the instructions of the corresponding sorting fields.\nExample (a dummy one):\nPrerequisites:\n1. At least 2 files have been stored using GridFs\n2. We have certain meta-data fields, which are used as part of the criteria, but we will miss, since they are irrelevant to the example.\n\n\n\n\n\n\n@Autowired\n\n\n\n\nprivate GridFsOperations ops;\n\n\n\n\n\n\n\n\n\nQuery query = Query.query(Criteria.where(...));\n\n\n\n\nquery = query.sort().on(\"uploadDate\", Order.DESCENDING);\n\n\n\n\n\n\n\n\n\nfinal List<GridFSDBFile> files = ops.find(query);\n\n\n\n\n\n\nThe results in the list, named files, will not be sorted according to the standard GridFsDbFile attribute uploadDate. I believe that the reason lies into the default implementation of the GridFsOperations, more precisely in the class GridFsTemplate. There the method getMappedQuery(Query), which is used for a basic mapping facility from Query to DBObject is implemented like this:\n\n\n\n\n\n\nprivate DBObject getMappedQuery(Query query) {\n\n\n\n\n\treturn query == null ? null : queryMapper.getMappedObject(query.getQueryObject(), null);\n\n\n\n\n}\n\n\n\n\n\n\nI believe that this is the problematic call, since I debugged the DBObject returned from the invocation of the queryMapper.getMappedObject() and it never contained any sorting fields no matter that they were part of if the transformed Query instance. I think that if one goes through the MongoTemplate find-ers implementations, she / he may find the mapping implementation there way better than what is currently available with the GridFs implementation.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.0.RC1", "fixed_version": "1.4.0.M1", "fixed_files": ["org.springframework.data.mongodb.gridfs.GridFsTemplate.java", "org.springframework.data.mongodb.gridfs.GridFsTemplateIIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 562, "bug_title": "Cannot create entity with OptimisticLocking (@Version) and initial id", "bug_description": "Cannot store entities with @Version and id already set. Either a NullPointerException or OptimisticLockingFailureException\nThe following test case provokes a NullPointerException since person.version is null. However, if I change version to 0 I will get an OptimisticLockingFailureException.\n\t@Test\n\tpublic void optimisticLockingHandlingWithExistingId() \n{\n\t\tPersonWithVersionPropertyOfTypeInteger person = new PersonWithVersionPropertyOfTypeInteger();\n\t\tperson.id = new ObjectId().toString();\n\t\tperson.age = 29;\n\t\tperson.firstName = \"Patryk\";\n\t\ttemplate.save(person);\n\t}", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 588, "bug_title": "MongoTemplate.insert does not initialize null versions to zero", "bug_description": "When persisting an object with a null @version field, you get different results when calling MongoTemplate.insert(Object) versus MongoTemplate.save(Object):\n\nMongoTemplate.insert ==> @version = null\nMongoTemplate.save ==> @version = 0\n\nI think the insert method should set @version to zero when it is null, like is done for the save method.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 583, "bug_title": "Check if you are using for loop with a DBCursor", "bug_description": "The mongodb driver has a possible memory leak, when using a DBCursor with a for loop:\n\n\n\n\n\n\nDBCursor cursor = c.find();\n\n\n\n\ntry {\n\n\n\n\n    for (DBObject obj: cursor) {\n\n\n\n\n        if (someCondition(obj)) {\n\n\n\n\n            return obj;\n\n\n\n\n        }\n\n\n\n\n    }\n\n\n\n\n} finally {\n\n\n\n\n    cursor.close();\n\n\n\n\n}\n\n\n\n\n\n\nPlease see here:\nhttps://jira.mongodb.org/browse/JAVA-664\nPlease check this case is used and maybe switch to a while(cursor.hasNext())", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 592, "bug_title": "Persisting Objects containing Objects with PersistenceConstructor causes MappingInstantiationException", "bug_description": "I am able to persist an object and have SringSource re-create the object from the database if all the member variables are primitive types.  This holds true if the names of the @PersistenceConstructor arguments don&apos;t match exactly the names of the member variables - in this case they an be matched up by using the @Field(\"foo\") and @Value(\"#root.foo\") annotations.  However, I get a MappingInstantiationException when I try to persist objects that contain other objects using the @PersistenceConstructor.\nSee StackOverflow 13854753 and StackOverflow 13832188 for details.\nAccording to Oliver Gierke:\n\nYou seem to have found a bug. The value resulting from the first Spel expression evaluation is a DBObject and not actually translated into the parameter type. I&apos;ve already have some code here locally that fixes that. Would you mind creating a ticket against Spring Data MongoDB to file this as a bug?", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 601, "bug_title": "CannotGetMongoDbConnectionException should not print password in logfile", "bug_description": "When the provided password and / or user is wrong we receive the following exception:\n\n\n\n\n\n\nError creating bean with name &apos;sameCoolClassRepository&apos;: FactoryBean threw exception on object creation; nested exception is org.springframework.data.mongodb.CannotGetMongoDbConnectionException:\n\n\n\n\nFailed to authenticate to database [mydbname], username = [myusername], password = [thecleartextpassword]\n\n\n\n\n\n\nSpring Data should never print the password in the logiles.\nSuggested solution: print first and last letter: &apos;mysecret&apos; gets &apos;m**************t&apos;", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoDbUtils.java"], "label": 1, "es_results": []}, {"bug_id": 603, "bug_title": "Results of geo queries in repository do not't get metrics of supplied distance applied", "bug_description": "Assume you have a geo query in a repository:\n\n\n\n\n\n\ninterface PersonRepository implements Repository<Person, Long> {\n\n\n\n\n\n\n\n\n\n  GeoResults<Person> findByLocationNear(Point point, Distance distance);\n\n\n\n\n}\n\n\n\n\n\n\nHanding in a Distance in a particular metric is not regarded in the Distance instance the GeoResults instance carries in .getAverageDistance().\n\n\n\n\n\n\nDistance distance = new Distance(150, Metrics.KILOMETERS);\n\n\n\n\nPoint point = new Point(10.0, 20.0);\n\n\n\n\n\n\n\n\n\nGeoResults<Person> result = repository.findByLocationNear(point, distance);\n\n\n\n\n\n\n\n\n\n// fails\n\n\n\n\nassertThat(result.getAverageDistance().getMetric(), is(Metrics.KILOMETERS));\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.config.AbstractMongoConfiguration.java", "org.springframework.data.mongodb.core.query.NearQueryUnitTests.java", "org.springframework.data.mongodb.core.geo.GeoSpatialTests.java", "org.springframework.data.mongodb.repository.query.AbstractMongoQuery.java", "org.springframework.data.mongodb.repository.AbstractPersonRepositoryIntegrationTests.java", "org.springframework.data.mongodb.core.query.NearQuery.java"], "label": 1, "es_results": []}, {"bug_id": 568, "bug_title": "MongoTemplate.find(...)  method causes Nullpointer if query parameter is null", "bug_description": "If the Query query parameter is null both find methods because a NullPointer Exception.\nIf query is null an IllegalArgument should be thrown.\nThe Assert.notnull(query) is missing", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 629, "bug_title": "Different results when using count and find with the same criteria with 'id' field", "bug_description": "Assume we have following query:\n\n\n\n\n\n\nQuery q = query(where(&apos;id&apos;).regex(&apos;zzz&apos;))\n\n\n\n\n\n\nmongoTemplate.find(q,java.util.HashMap.class,&apos;test&apos;) gives following query (peeked in mongo console):\n\n\n\n\n\n\n{ \"ts\" : ISODate(\"2013-03-22T10:00:51.685Z\"),\n\n\n\n\n  \"op\" : \"query\",\n\n\n\n\n  \"ns\" : \"test.test\",\n\n\n\n\n  \"query\" : {\n\n\n\n\n\t\t\"id\" : /zzz/\n\n\n\n\n\t},\n\n\n\n\n\t\"nscanned\" : 1,\n\n\n\n\n\t\"responseLength\" : 20,\n\n\n\n\n\t\"millis\" : 0,\n\n\n\n\n\t\"client\" : \"127.0.0.1\",\n\n\n\n\n\t\"user\" : \"\"\n\n\n\n\n}\n\n\n\n\n\n\nThe same query, when used in count (mongoTemplate.count(q,&apos;test&apos;)) gives:\n\n\n\n\n\n\n{\n\n\n\n\n\t\"ts\" : ISODate(\"2013-03-22T10:00:36.299Z\"),\n\n\n\n\n\t\"op\" : \"command\",\n\n\n\n\n\t\"ns\" : \"test.$cmd\",\n\n\n\n\n\t\"command\" : {\n\n\n\n\n\t\t\"count\" : \"test\",\n\n\n\n\n\t\t\"query\" : {\n\n\n\n\n\t\t\t\"_id\" : /zzz/\n\n\n\n\n\t\t}\n\n\n\n\n\t},\n\n\n\n\n\t\"ntoreturn\" : 1,\n\n\n\n\n\t\"responseLength\" : 48,\n\n\n\n\n\t\"millis\" : 0,\n\n\n\n\n\t\"client\" : \"127.0.0.1\",\n\n\n\n\n\t\"user\" : \"\"\n\n\n\n\n}\n\n\n\n\n\n\nThis is inconsistent since we could have records with field id and they will be retrieved properly from the db. Count on the other hand will give bad results since it uses _id field.\nIn org.springframework.data.mongodb.core.convert.QueryMapper the method determineKey, for some reason treats id and _id as the same field. This is probably the because of the strange behaviour because find() method does not use QueryMapper and count() does.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapper.java", "org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.convert.QueryMapperUnitTests.java", "org.springframework.data.mongodb.core.mapping.MongoMappingContext.java"], "label": 1, "es_results": []}, {"bug_id": 642, "bug_title": "MongoChangeSetPersister does not use mapped collection name", "bug_description": "", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.crossstore.CrossStoreMongoTests.java", "org.springframework.data.mongodb.crossstore.MongoChangeSetPersister.java"], "label": 1, "es_results": []}, {"bug_id": 594, "bug_title": "cross-store=> Define document name using annotation", "bug_description": "In a cross-store configuration, the RelatedDocument is stored in a MongoDB collection using the container&apos;s Entity&apos;s package name.\nIt would be nice if the collection name would be either the name of the class (document, not entity) or as specified using annotations(@Document(collection=\"\")).\nThis \"issue\" is caused by the class\norg.springframework.data.mongodb.crossstore.MongoChangeSetPersister\nwhich gets the name of the collection from the method getCollectionNameForEntity which does:\nreturn ClassUtils.getQualifiedName(entityClass);", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.crossstore.CrossStoreMongoTests.java", "org.springframework.data.mongodb.crossstore.MongoChangeSetPersister.java"], "label": 1, "es_results": []}, {"bug_id": 571, "bug_title": "Spring Data for MongoDb does not save null values when @Version is added to domain class ", "bug_description": "Scenario:\n1. Domain class is loaded from mongodb using CrudRepository.findOne() method.\n2. The loaded instances any non id nor @Version annotated field is set to null. \n3. The loaded instance is saved to same mongodb using CrudRepository.save() method.\n4. The field that has been set to null does not write to database, its unchanged.\nImportant: The problem does not occur when @Version annotation is not used in the domain class definition.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.query.Update.java"], "label": 1, "es_results": []}, {"bug_id": 602, "bug_title": "Querying with $in operator on the id field of type BigInteger returns zero results", "bug_description": "There is a problem when trying to query for documents with id field is in a given list of BigInteger values. Id field is mapped as a BigInteger.\nFor example, these lines will work only if given id list contains only one item.\n\n\n\n\n\n\nList<BigInteger> profileIds = findProfileIds();\n\n\n\n\nPredicate predicate = QProfileDocument.profileDocument.id.in(profileIds);\n\n\n\n\nIterable<ProfileDocument> profiles = profileRepository.findAll(predicate);\n\n\n\n\n\n\nThe underlying MongodbQuery is different if there is only one item in profileIds. The query looks like this for a profileIds with multiple elements\n\n\n\n\n\n\n{ \"_id\" : { \"$in\" : [ \"25069473312490162649510603609\" , \"25045916045544535958655878835\"]}}\n\n\n\n\n\n\nand it looks like this when there is only one item in the list.\n\n\n\n\n\n\n{ \"_id\" : { \"$oid\" : \"5100fb776c67e7e092be6b59\"}}\n\n\n\n\n\n\nIn the first case, query will return no results and in the second it will work and return an Iterable with one item.\nAs you can see, the problem is with the representation of the BigInteger. using decimal format will not work with MongoDB.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.3.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java"], "label": 1, "es_results": []}, {"bug_id": 746, "bug_title": "IndexInfo cannot be read for indices created via mongo she will", "bug_description": "As described in the stackoverflow post, spring mongo data cannot retrieve the index information for an index that has been created via the mongo she will.\nTrisha from 10gen traced the root because down to this:\n\"I would recommend reporting this to the guys at Spring, you will not be the only one who experiences this. I found the problem in DefaultIndexOperations lines 138 - 141 in version 1.1.1 of spring-data-mongodb.\"\nI figure this issue also exists in later versions though I did not get around to test it myself.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.3.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.DefaultIndexOperations.java"], "label": 1, "es_results": []}, {"bug_id": 647, "bug_title": "Using \"OrderBy\" in \"query by method name\" ignores the @Field annotation for field alias.", "bug_description": "I created a method using the \"query by method name\" approach:\nInside my Answer object, I have a field called \"Score\" that is annotated with\n@Field(\"sr\")\nint Score\nList<Answer> findByQuestionIdOrderByScoreDesc(String questionId)\nWhen the query is run, the database attempts to sort the results by \"score\" rather than my \"sr\" field name.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.1.RELEASE", "fixed_version": "1.4.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 622, "bug_title": "An unversioned object should be created using insert() instead of save.", "bug_description": "MongoTemplate.doSaveVersioned() uses doSave() to store an unversioned object. It should rather use doInsert() to avoid race conditions on concurrent inserts.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.2.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 621, "bug_title": "MongoTemplate.initializeVersionProperty() does not use ConversionService", "bug_description": "The BeanWrapper used in MongoTemplate.initializeVersionProperty() is not using the ConversionService held in the MongoConverter. This can cause type assignment conflicts in case the version property is not an integer.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.2.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 620, "bug_title": "MongoTemplate.doSaveVersioned() does not consider collection handed into the method", "bug_description": "doSaveVersioned() calls updateFirst(query, update, objectToSave.getClass()) in an update case which essentially neglects the collectionName originally handed into the method.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.2.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java", "org.springframework.data.mongodb.core.PersonWithVersionPropertyOfTypeInteger.java"], "label": 1, "es_results": []}, {"bug_id": 617, "bug_title": "NullPointerException in MongoTemplate.initializeVersionProperty()", "bug_description": "If mongoPersistentEntity is null, NullPointerException is thrown (line 671).\nWrite this (ligne 669) : \n\n\n\n\n\n\nif (mongoPersistentEntity != null && mongoPersistentEntity.hasVersionProperty()) \n\n\n\n\n\n\nInstead of : \n\n\n\n\n\n\nif (mongoPersistentEntity == null || mongoPersistentEntity.hasVersionProperty())\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.1.2.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 633, "bug_title": "Upgrade to Querydsl 3.0.0", "bug_description": "", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.1.RELEASE", "fixed_version": "1.3.0.M1", "fixed_files": ["org.springframework.data.mongodb.repository.support.SpringDataMongodbSerializer.java"], "label": 1, "es_results": []}, {"bug_id": 663, "bug_title": "org.springframework.data.mongodb.core.query.Field needs an equals method", "bug_description": "The above class Field does not has an equals() method.\nBut org.springframework.data.mongodb.core.query.Query has an equals method which is using the equals method of the Field class.\n\n\n\n\n\n\nboolean fieldsEqual = this.fieldSpec == null ? that.fieldSpec == null : this.fieldSpec.equals(that.fieldSpec);\n\n\n\n\n\n\nPlease implement an equals on the Field method.\nPurpose: For unit testing the equals method is needed.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.1.RELEASE", "fixed_version": "1.3.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.query.Field.java"], "label": 1, "es_results": []}, {"bug_id": 679, "bug_title": "MongoTemplate.doSave() passed a JSON String does not save it.", "bug_description": "I have Spring 3.1.2 setup to TEXT messages off a queue(that contain JSON), then insert them into a mongo database.\nThe MongoTemplate.doSave(..) method is passed in \ncollectionName = \"audit_log\"\nobjectToSave = \"{\"nanosecond\":528023582734299,\"clientID\":\"300\",\"action\":\"ENTRY\"\";\nwriter = MappingMongoConvertor()\nThese are all correct.\nThe code though has this...\nif (!(objectToSave instanceof String)) {\n\twriter.write(objectToSave, dbDoc);\n} else {\n\ttry \n{\n\t\tobjectToSave = (T) JSON.parse((String) objectToSave);\n\t}\n catch (JSONParseException e) \n{\n\t\tthrow new MappingException(\"Could not parse given String to save into a JSON document!\", e);\n\t}\n}\nmaybeEmitEvent(new BeforeSaveEvent<T>(objectToSave, dbDoc));\nObject id = saveDBObject(collectionName, dbDoc, objectToSave.getClass());\nSo the objectToSave is a String, so the first IF statement fails, and it goes into the ELSE section.\nThe &apos;objectToSave&apos; is then correctly pasrsed into a BasicDBObject with the correct values.\nThe saveDBObject() method though is not passed in the objectToSave.\nIts passed in the collectionName (which is correct). \nThe dbDoc which is empty since we&apos;ve put nothing into it.\nand the objectToSave.getClass()\nSo how will it ever save the objectToSave if its not passed into the save method ??\nI suspect it should have something like...\nobjectToSave = (T) JSON.parse((String) objectToSave);\nfollowed by\ndbDoc = (com.mongodb.BasicDBObject)objectToSave\nNote my spring config is using a int-jms:channel to wire in the queue to Mongo.\n<int-jms:channel id=\"saveToDBChannel\"  \n    \tqueue-name=\"ESI_AUDIT\" \n    \tauto-startup=\"true\" concurrency=\"50\">\n    </int-jms:channel>\n    <int-mongodb:outbound-channel-adapter id=\"outBoundMongoAdapter\"\n        collection-name=\"audit_log\"  \n        mongodb-factory=\"mongoDbFactory\" channel=\"saveToDBChannel\" />\nIf you require a WAR that is a test of this, please let me know.\nThanks\nJeff\nNote: this affect version 1.1.2(at least) to 1.2.1\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.1.RELEASE", "fixed_version": "1.3.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 683, "bug_title": "QueryMapper does not handle default _id when no MappingMetadata is present", "bug_description": "", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.1.RELEASE", "fixed_version": "1.3.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapper.java", "org.springframework.data.mongodb.core.convert.QueryMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 676, "bug_title": "SimpleMongoRepository fails if used with customized collection name", "bug_description": "SimpleMongoRepository fails if MongoEntityInformation is passed to initialize the repository which customized collection name for entity.\nIt fails with \nSimpleMongoRepository#findOne(id)\nSimpleMongoRepository#delete(id)\nSimpleMongoRepository#delete(entity)\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.1.RELEASE", "fixed_version": "1.3.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.MongoOperations.java", "org.springframework.data.mongodb.repository.support.SimpleMongoRepository.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 706, "bug_title": "QueryMapper does not transform DBRefs in nested keywords correctly", "bug_description": "", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.1.RELEASE", "fixed_version": "1.2.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapper.java", "org.springframework.data.mongodb.core.convert.QueryMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 688, "bug_title": "There is no precedence between @Id annotation and field named \"id\" - both are attempted to be used", "bug_description": "If you have a domain class with an attribute named \"id\", even if you annotate a DIFFERENT field with \"@Id\", spring-data-mongo errors trying to map 2 things to the id.  While the error is correct in that you can&apos;t have 2, it surprises me that one doesn&apos;t take precedence over the other.\nI tried (in vain) to find this issue listed in jira, having read about it from a post in the forums after hitting the same issue myself, so apologies if this is a duplicate.\nOriginal forum post here: http://forum.springsource.org/showthread.php?120188-_id-mapping", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.1.RELEASE", "fixed_version": "1.3.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.mapping.MongoPersistentProperty.java", "org.springframework.data.mongodb.core.mapping.MongoMappingContextUnitTests.java", "org.springframework.data.mongodb.core.mapping.BasicMongoPersistentEntity.java", "org.springframework.data.mongodb.core.mapping.BasicMongoPersistentProperty.java"], "label": 1, "es_results": []}, {"bug_id": 702, "bug_title": "Spring Data MongoDB projection search, is not properly configured with respective Java Pojo", "bug_description": "If Model Java POJO, is annotated with @Field, then during search with\nquery.fields().include(field)\nuning mongoTemplate\nit does not java property field as field parameter, rather it needs the name declared with name defined with @Field annotation.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.1.RELEASE", "fixed_version": "1.3.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 717, "bug_title": "Application context is not properly distributed to persistent entities", "bug_description": "The MongoMappingContext does not properly distribute the application context when set to persistent entities that have already been added.\nCurrent code:\n\n\n\n\n\n\nMongoMappingContext.java\n\n\n\n\n\n\n\t@Override\n\n\n\n\n\tprotected <T> BasicMongoPersistentEntity<T> createPersistentEntity(TypeInformation<T> typeInformation) {\n\n\n\n\n\n\n\n\n\n\t\tBasicMongoPersistentEntity<T> entity = new BasicMongoPersistentEntity<T>(typeInformation);\n\n\n\n\n\n\n\n\n\n\t\tif (context != null) {\n\n\n\n\n\t\t\tentity.setApplicationContext(context);\n\n\n\n\n\t\t}\n\n\n\n\n\n\n\n\n\n\t\treturn entity;\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n\t\n\n\n\n\n\t@Override\n\n\n\n\n\tpublic void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n\n\n\n\n\n\n\n\n\n\t\tthis.context = applicationContext;\n\n\n\n\n\t\tsuper.setApplicationContext(applicationContext);\n\n\n\n\n\t}\n\n\n\n\n\n\nPossible fix:\n\n\n\n\n\n\nMongoMappingContext.java\n\n\n\n\n\n\n@Override\n\n\n\n\n\tpublic void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n\n\n\n\n\n\n\n\n\n\t\tthis.context = applicationContext;\n\n\n\n\n\t\tsuper.setApplicationContext(applicationContext);\n\n\n\n\n                // Send the application context to ALL the PersistentEntities, not just ones created after this point\n\n\n\n\n               for (BasicMongoPersistentEntity entity : getPersistentEntities()) {\n\n\n\n\n                   entity.setApplicationContext(applicationContext);\n\n\n\n\n               }\n\n\n\n\n\t}\n\n\n\n\n\n\nSee referenced URL PoC, no_indexes branch, test: MultiTenantTest::testMultiTenantSave() for example.\nUPDATE:\nAbstractMongoConfiguration is calling initialize() on MongoMappingContext before it returns the object.\n\n\n\n\n\n\nAbstractMongoConfiguration\n\n\n\n\n\n\n        @Bean\n\n\n\n\n\tpublic MongoMappingContext mongoMappingContext() throws ClassNotFoundException {\n\n\n\n\n\n\n\n\n\n\t\tMongoMappingContext mappingContext = new MongoMappingContext();\n\n\n\n\n\t\tmappingContext.setInitialEntitySet(getInitialEntitySet());\n\n\n\n\n\t\tmappingContext.setSimpleTypeHolder(customConversions().getSimpleTypeHolder());\n\n\n\n\n\t\tmappingContext.initialize(); // <----\n\n\n\n\n\n\n\n\n\n\t\treturn mappingContext;\n\n\n\n\n\t}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.1.RELEASE", "fixed_version": "1.2.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.config.AbstractMongoConfigurationUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 721, "bug_title": "Polymorphic attribute type not persisted on update operations", "bug_description": "We found a problem with Spring Data for Mongo DB.\nHere is our situation: we have an entity which have an attribute which is a list of another kind of entity, like the code below.\n@Document\npublic class ParentClass {\n   private List<ChildClass> list;\n}\nthe ChildClass is annotated with @Document too, but we want to store it&apos;s content as an embed document of ParentClass.\nWhen using MongoTemplate class with code such as below, the _class attribute is not inserted on the embedded document, so, if one of the items of the list attribute is a subclass of ChildClass, and ChildClass is an abstract class, we begin to face instantiation problems.\nHere is one example of usage of MongoTemplate in which we found a problem.\nmongoTemplate.updateFirst(Query.query(criteria), \n  new Update().push(\"list\", child));\nIf child is a subclass of ChildClass, the _class attribute is not added to the embedded document.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.1.RELEASE", "fixed_version": "1.3.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapper.java"], "label": 1, "es_results": []}, {"bug_id": 675, "bug_title": "findAndModify does not use field value annotation for update object", "bug_description": "I am using the @Field annotation on some of my fields to keep the full variable name in java but shorten the mongodb key associated to it. Example: \n\n\n\n\n\n\n@Field(value = \"desc\")\n\n\n\n\nprotected String description;\n\n\n\n\n\n\nEverywhere I can still use the java name (e.g. description) to query with criteria except in findAndModify() from the MongoTemplate class.\nI dug into your code to try to understand why and noticed in doFindAndModify() you are not calling the mapper.getMappedObject() on the update object passed in parameters. Is there any reason for that? Because it is called in the doUpdate() (line 927).\nIt is not a big issue but just wanted to know why it was not consistent with the rest.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.1.RELEASE", "fixed_version": "1.2.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java", "org.springframework.data.mongodb.core.query.Update.java"], "label": 1, "es_results": []}, {"bug_id": 752, "bug_title": "QueryMapper prevents searching for values that start with a $ [dollarsign]", "bug_description": "When querying for values that start with a dollar sign the QueryMapper.Keyword#isKeyword recognizes this as a keyword, resulting in a ClassCastException (QueryMapper.java:311)\nThe following snippet demonstrates this behaviour:\n\n\n\n\n\n\nmongoTemplate.find(query(where(\"myvalue\").is(\"$334\")), My.class);\n\n\n\n\n\n\nThe mongo keywords (&apos;$gt&apos; etc.) would usually be provided with the associated methods (.gt() etc.). A is() query should either not try to recognize keywords or at least be more specific (not only check for a leading &apos;$&apos;).\nHow could a query for a value that starts with a dollar sign be written otherwise, using the Spring MongoTemplate?", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.3.RELEASE", "fixed_version": "1.3.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapper.java", "org.springframework.data.mongodb.core.convert.QueryMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 745, "bug_title": "@Query($in) and Pageable in result Page total = 0", "bug_description": "Hi If I used MongoRepository and anotation Quary and Pageable in response I get true result but getTotalElements == 0\n@Query(\"{&apos;snapshotId&apos; : ?0 ,&apos;defects.id&apos;:{ $in:?1}}\")\nPage<Test> findBySnapshotIdAndDefects(ObjectId snapshotId, List<Integer> defectIds, Pageable pageable);\nBase Struct\n{5225a5ece4b0a01629fce9c6={ \"_id\" : \n{ \"$oid\" : \"5225a5ece4b0a01629fce9c6\"}\n , \"snapshotId\" : \n{ \"$oid\" : \"5225a5ece4b0a01629fce9c5\"}\n , \"defects\" : [ \n{ \"_id\" : 1 }\n]}", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.3.RELEASE", "fixed_version": "1.4.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.Person.java", "org.springframework.data.mongodb.repository.AbstractPersonRepositoryIntegrationTests.java", "org.springframework.data.mongodb.repository.PersonRepository.java"], "label": 1, "es_results": []}, {"bug_id": 741, "bug_title": "Trying to 'group' on a field of a sub-object causes an error in Spring Data MongoDB 1.3.0.RC1", "bug_description": "Using the new Aggregation support fails when I try to &apos;group&apos; on a property of a sub-object.  The referenced Gist should give enough context.  Following things in the debugger lead me to believe that the code is trying to resolve the &apos;code&apos; property on the parent object instead of the contained sub-object.  Using a top-level property works great.  I&apos;ve run the equivalent aggregation in the MongoDB she will and it allows me to &apos;group&apos; on the sub-object&apos;s property so it doesn&apos;t appear to be illegal in MongoDB.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.3.0.RC1", "fixed_version": "1.3.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.aggregation.ExposedFieldsAggregationOperationContext.java", "org.springframework.data.mongodb.core.aggregation.GroupOperationUnitTests.java", "org.springframework.data.mongodb.core.aggregation.ExposedFields.java", "org.springframework.data.mongodb.core.aggregation.Fields.java", "org.springframework.data.mongodb.core.aggregation.AggregationUnitTests.java", "org.springframework.data.mongodb.core.aggregation.TypeBasedAggregationOperationContext.java"], "label": 1, "es_results": []}, {"bug_id": 829, "bug_title": "NearQuery, when used in conjunction with a Query, it sets num=0, unless Query specifies otherwise", "bug_description": "Hello,\ni have built the following query:\n\n\n\n\n\n\npublic GeoResults<MyObject> findByTypeAndLocationNear(MyObjectType type, Point p, Distance distance) {\n\n\n\n\n   final Query query = Query.query(Criteria.where(\"type\").is(type.name()));\n\n\n\n\n   final NearQuery nearQuery = NearQuery.near(p).maxDistance(distance).query(query);\n\n\n\n\n   log.info(\"{}\",nearQuery.toDBObject());\n\n\n\n\n   return mongoTemplate.geoNear(nearQuery, MyObject.class);\n\n\n\n\n}\n\n\n\n\n\n\nAnd it logs to this:\n\n\n\n\n\n\n{ \"query\" : { \"type\" : \"small\"} , \"maxDistance\" : 1.567855942887398E-4 , \"distanceMultiplier\" : 6378.137 , \"num\" : 0 , \"near\" : [ x , y] , \"spherical\" : true}\n\n\n\n\n\n\nWhere is this \"num=0\" coming from? I did not set any limits.\nIn the 1.2.1 release, \"num\" is an Integer and is only used in the DBObject, when it is != null. When i set a Query, \"num\" is left untouched and therefore it does not appear in the DBObject. See [1]\nStarting from 1.2.4 release, \"num\" is still an Integer, but when i set a Query, this time \"num\" gets the \"limit\" value of the Query, which by default is always 0. See [2]\nI do not see this subtle change mentioned in the latest change file.\nMy opinion is, to use the limit value from Query is very convenient and makes sense, but it should only be used, if someone has explicitly set a limit for the Query object (probably its enough to check, if the limit is > 0)\nThe same applies on \"skip\", but it is not used in NearQuery anyways.\nWhat do you guys think?\n[1] http://grepcode.com/file/repo1.maven.org/maven2/org.springframework.data/spring-data-mongodb/1.2.1.RELEASE/org/springframework/data/mongodb/core/query/NearQuery.java#NearQuery.query%28org.springframework.data.mongodb.core.query.Query%29\n[2] http://grepcode.com/file/repo1.maven.org/maven2/org.springframework.data/spring-data-mongodb/1.2.4.RELEASE/org/springframework/data/mongodb/core/query/NearQuery.java#NearQuery.query%28org.springframework.data.mongodb.core.query.Query%29\n[3] http://docs.mongodb.org/manual/reference/command/geoNear/\n[4] http://docs.spring.io/spring-data/mongodb/docs/1.3.3.RELEASE/changelog.txt", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.2.4.RELEASE", "fixed_version": "1.3.5.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.query.NearQuery.java", "org.springframework.data.mongodb.core.query.NearQueryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 789, "bug_title": "Support login via different (e.g. admin) authentication database", "bug_description": "MongoDB allows to have users to be defined in the &apos;admin&apos; database that have permissions in other databases. See last example in http://docs.mongodb.org/manual/tutorial/add-user-to-database/. Before MongoDB 2.4, a login was automatically checked both in the database you connected to and in the &apos;admin&apos; database. Since MongoDB 2.4, you need to explicitly mention the authentication database when logging in via the tools.\nIf you connect via the Driver, you need to first connect to the &apos;admin&apos; database to authenticate, and then switch to the database of your choice.\nThis option is missing from the Spring-Data-MongoDB integration module.\n\n\n\n\n\n\n    <mongo:mongo id=\"mongo\" write-concern=\"#{T(com.mongodb.WriteConcern).ACKNOWLEDGED}\"\n\n\n\n\n                 replica-set=\"${mongo.mongoReplicaSet}\"/>\n\n\n\n\n    <mongo:db-factory id=\"mongoDbFactory\"\n\n\n\n\n                      dbname=\"${mongo.mongoDatabaseName}\"\n\n\n\n\n                      username=\"${mongo.mongoUser}\"\n\n\n\n\n                      password=\"${mongo.mongoPass}\"\n\n\n\n\n                      mongo-ref=\"mongo\"\n\n\n\n\n\n\n\n\n\nauthenticationDatabase=\"${mongo.authenticationDatabase}\"\n\n\n\n\n/> <!-- authenticationDatabase missing -->\n\n\n\n\n    <mongo:auditing/>\n\n\n\n\n\n\nThe use of users in the admin database was enforced by our MongoDB consultants.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.3.1.RELEASE", "fixed_version": "1.4.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.SimpleMongoDbFactoryUnitTests.java", "org.springframework.data.mongodb.monitor.ServerInfo.java", "org.springframework.data.mongodb.config.MongoNamespaceTests.java", "org.springframework.data.mongodb.config.AbstractMongoConfiguration.java", "org.springframework.data.mongodb.config.AbstractMongoConfigurationUnitTests.java", "org.springframework.data.mongodb.core.MongoAdmin.java", "org.springframework.data.mongodb.core.SimpleMongoDbFactory.java", "org.springframework.data.mongodb.core.MongoDbUtils.java", "org.springframework.data.mongodb.config.MongoDbFactoryParser.java", "org.springframework.data.mongodb.core.MongoDbUtilsIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 788, "bug_title": "Projection operations do not render synthetic fields properly.", "bug_description": "If a part \"a\" of a group id _id.a is referenced in a projection operation it should be rendered as \n\n\n\n\n\n\"a\":\"$_id.a\"\n\n\n\n\n\n while it is currently rendered as \n\n\n\n\n\n\"a\":1\n\n\n\n\n\n.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.3.2.RELEASE", "fixed_version": "1.4.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.aggregation.ProjectionOperation.java", "org.springframework.data.mongodb.core.aggregation.ProjectionOperationUnitTests.java", "org.springframework.data.mongodb.core.aggregation.Field.java", "org.springframework.data.mongodb.core.aggregation.ExposedFields.java", "org.springframework.data.mongodb.core.aggregation.AggregationUnitTests.java", "org.springframework.data.mongodb.core.aggregation.Fields.java", "org.springframework.data.mongodb.core.aggregation.AggregationTests.java"], "label": 1, "es_results": []}, {"bug_id": 807, "bug_title": "using findAndModify removes the _class field of encapsulated classes, causing MappingInstantiationException", "bug_description": "given the two classes:\npublic interface IUser{\n}\npublic class User implements IUser{\n    public int i;\n}\npublic class UserWrapper{\n    private IUser user;\n}\nwhen using findAndModify on a UserWrapper collection, \nthe \"_class\" field from the User class is removed.\nwhen trying to restore the UserWrapper class, \na MappingInstantiationException is being thrown with \"Failed to instantiate IUser using constructor NO_CONSTRUCTOR with arguments.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.3.2.RELEASE", "fixed_version": "1.4.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java", "org.springframework.data.mongodb.core.convert.UpdateMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 862, "bug_title": "Update Array Field Using Positional Operator ($) Does Not Work", "bug_description": "After updating to a newer version of Spring Data MongoDB, I found that I can no longer update array fields. The most recent version I observed this to work correctly is 1.2.x.\nIn 1.3.x and above, it seems that the positional operator ($) is removed from the key.\nFor example:\nmongoOps.findAndModify(new Query(), new Update().set(\"options.$.name\", \"color\"), MongoProduct.class);\nIn the actual command, \"options.$.name\" turns into \"options.name\".\nThis results in the mongodb error: \"exception: can&apos;t append to array using string field name: name\"", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.3.4.RELEASE", "fixed_version": "1.4.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.UpdateMapper.java", "org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.convert.UpdateMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 868, "bug_title": "findAndModify method does not increment @Version field.", "bug_description": "DATAMONGO-811 addresses this issue for update methods. But findAndModify method still lacks the version increment.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.3.4.RELEASE", "fixed_version": "1.4.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateUnitTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 877, "bug_title": "AbstractMongoConfiguration.getMappingBasePackage() throws NullPointerException if config class resides in default package", "bug_description": "", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.3.4.RELEASE", "fixed_version": "1.3.5.RELEASE", "fixed_files": ["org.springframework.data.mongodb.config.AbstractMongoConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 804, "bug_title": "EnableMongoRepositories repositoryImplementationPostfix() default is empty String instead of \"Impl\"", "bug_description": "In contrast to the doc, which states that the default repositoryImplementationPostfix is \"Impl\", the default is actually set to empty string:\nString repositoryImplementationPostfix() default \"\";\nTook me a while to figure out why my RepositoryImpl was not recognised...", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.0.M1", "fixed_version": "1.3.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.config.EnableMongoRepositories.java"], "label": 1, "es_results": []}, {"bug_id": 828, "bug_title": "UpdateFirst throws OptimisticLockingFailureException when updating document that does not exist", "bug_description": "when updating a document that does not exists using MongoTemplage.updateFirst an OptimisticLockingFailureException is thrown in case of a non multi update.\n\n\n\n\n\n\n@Test\n\n\n\n\npublic void updateFirstShouldDoNothingWhenCalledForEntitiesThatDoNotExist() {\n\n\n\n\n\t\t\n\n\n\n\n\tQuery q = query(where(\"id\").is(Long.MIN_VALUE));\n\n\n\n\n\tAssume.assumeThat(template.findOne(q, VersionedPerson.class), IsNull.nullValue());\n\n\n\n\n\t\t\n\n\n\n\n\ttemplate.updateFirst(q, Update.update(\"lastname\", \"supercalifragilisticexpialidocious\"), VersionedPerson.class);\n\n\n\n\n\tAssert.assertThat(template.findOne(q, VersionedPerson.class), IsNull.nullValue());\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.0.M1", "fixed_version": "1.3.4.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 852, "bug_title": "Increase version for update does not traverse DBObject correctly in order to find version property.", "bug_description": "Version property is nested and therefore not resolved correctly.\n\n\n\n\n\n\n{\n\n\n\n\n  $inc : {version : 1}\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.0.RC1", "fixed_version": "1.4.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java", "org.springframework.data.mongodb.core.query.Update.java", "org.springframework.data.mongodb.core.query.UpdateTests.java"], "label": 1, "es_results": []}, {"bug_id": 863, "bug_title": "QueryMapper.getMappedValue Fails To Handle Arrays Mapped To $in", "bug_description": "I have a scenario where I run the following update to pull array elements with the given ids:\nList<BigInteger> idsToRemove = Arrays.asList(\n    BigInteger.valueOf(123), BigInteger.valueOf(234));\nUpdate update = new Update()\n        .pull(\"options\",\n            new BasicDBObject(\"_id\",\n            new BasicDBObject(\"$in\", mongoOps\n                .getConverter().convertToMongoType(idsToRemove))));\nmongoOps.findAndModify(new Query(), update, MongoProduct.class);\nThis used to work before version 1.4.\nUsing version 1.4, I get a java.lang.ClassCastException (see attachment).\nThis seems to be due to a double call to QueryMapper.getMappedValue(Field, Object) from UpdateMapper.getMappedObjectForField(Field, Object) at line 80 of UpdateMapper, the first of which converts idsToRemove (which is already a BasicDBList) to an array of strings. The second call to getMappedValue from within super.getMappedObjectForField then tries to cast that array to Iterable<?>, which fails.\nFinally, this might be a little out of scope, but I feel that if a BasicDBObject is passed to the Spring Data API, it should be taken as is. It should not be re-converted/re-mapped!", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.0.RELEASE", "fixed_version": "1.4.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapper.java", "org.springframework.data.mongodb.core.convert.UpdateMapper.java", "org.springframework.data.mongodb.core.convert.UpdateMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 843, "bug_title": "Unable to use @EnableMongoAuditing annotation in Java config", "bug_description": "When declaring an @EnableMongoAuditing annotation on a configuration, application startup fails due to an exception: NoSuchBeanDefinitionException: No bean named &apos;mappingContext&apos; is defined.   This error only occurs if auditing is enabled.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.0.RC1", "fixed_version": "1.4.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.config.MongoAuditingRegistrar.java", "org.springframework.data.mongodb.config.AuditingViaJavaConfigRepositoriesTests.java", "org.springframework.data.mongodb.config.GridFsTemplateParser.java", "org.springframework.data.mongodb.config.BeanNames.java", "org.springframework.data.mongodb.config.MongoParser.java", "org.springframework.data.mongodb.core.mapping.event.AuditingEventListener.java", "org.springframework.data.mongodb.core.mapping.event.AuditingEventListenerUnitTests.java", "org.springframework.data.mongodb.config.MappingMongoConverterParserIntegrationTests.java", "org.springframework.data.mongodb.config.MappingMongoConverterParserValidationIntegrationTests.java", "org.springframework.data.mongodb.config.MappingMongoConverterParser.java", "org.springframework.data.mongodb.repository.support.MongoRepositoryFactoryBean.java", "org.springframework.data.mongodb.config.MongoTemplateParser.java", "org.springframework.data.mongodb.config.MongoAuditingBeanDefinitionParser.java", "org.springframework.data.mongodb.repository.config.MongoRepositoryConfigurationExtension.java", "org.springframework.data.mongodb.config.MongoDbFactoryParser.java"], "label": 1, "es_results": []}, {"bug_id": 970, "bug_title": "Id query cannot be created if object to remove is DBObject", "bug_description": "If we in insert DBObject in database used method:\n\n\n\n\n\n\nprotected void populateIdIfNecessary(Object savedObject, Object id) {\n\n\n\n\n  if (id == null) {\n\n\n\n\n    return;\n\n\n\n\n  }\n\n\n\n\n  if (savedObject instanceof BasicDBObject) {\n\n\n\n\n    DBObject dbObject = (DBObject) savedObject;\n\n\n\n\n    dbObject.put(ID_FIELD, id);\n\n\n\n\n    return;\n\n\n\n\n  }\n\n\n\n\n  MongoPersistentProperty idProp = getIdPropertyFor(savedObject.getClass());\n\n\n\n\n  if (idProp == null) {\n\n\n\n\n    return;\n\n\n\n\n  }\n\n\n\n\n  ConversionService conversionService = mongoConverter.getConversionService();\n\n\n\n\n  BeanWrapper<PersistentEntity<Object, ?>, Object> wrapper = BeanWrapper.create(savedObject, conversionService);\n\n\n\n\n  Object idValue = wrapper.getProperty(idProp, idProp.getType(), true);\n\n\n\n\n  if (idValue != null) {\n\n\n\n\n    return;\n\n\n\n\n  }\n\n\n\n\n  wrapper.setProperty(idProp, id);\n\n\n\n\n}\n\n\n\n\n\n\nwhere checked: &apos;savedObject instanceof BasicDBObject&apos; and not store property with &apos;_id&apos;. Then if we remove DBObject from database for create query used:\n\n\n\n\n\n\nprivate Query getIdQueryFor(Object object) {\n\n\n\n\n  Assert.notNull(object);\n\n\n\n\n  Class<?> objectType = object.getClass();\n\n\n\n\n  MongoPersistentEntity<?> entity = mappingContext.getPersistentEntity(objectType);\n\n\n\n\n  MongoPersistentProperty idProp = entity == null ? null : entity.getIdProperty();\n\n\n\n\n  if (idProp == null) {\n\n\n\n\n    throw new MappingException(\"No id property found for object of type \" + objectType);\n\n\n\n\n  }\n\n\n\n\n  ConversionService service = mongoConverter.getConversionService();\n\n\n\n\n  Object idProperty = null;\n\n\n\n\n  idProperty = BeanWrapper.create(object, service).getProperty(idProp, Object.class, true);\n\n\n\n\n  return new Query(where(idProp.getFieldName()).is(idProperty));\n\n\n\n\n}\n\n\n\n\n\n\nWhere not checked:  &apos;savedObject instanceof BasicDBObject&apos; and throw exception. Why not checked removing object on &apos;savedObject instanceof BasicDBObject&apos; if we insert BAsicDBObject and after remove then.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.0.RC1", "fixed_version": "1.5.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 880, "bug_title": "Error when trying to persist an object containing a DBRef which was lazy loaded.", "bug_description": "When fetching a property which is annotated as DBRef(lazy = true) the object returned is a CGLIB proxy. If we use this proxy as a value for the property of a new object and try to persist it, the object is not found.\n\n\n\n\n\n\nTemplate.java\n\n\n\n\n\n\n// New object we are trying to persist\n\n\n\n\npublic class Template {\n\n\n\n\n\n\n\n\n\n    private String id;\n\n\n\n\n    @DBRef(lazy = true)\n\n\n\n\n    private Content content;\n\n\n\n\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\nIf the template object above is loaded from the database and the content property is used for the message below, then the id of the DbRef is not resolved when saved since the target is a proxy.\n\n\n\n\n\n\nMessage.java\n\n\n\n\n\n\n// New object we are trying to persist\n\n\n\n\npublic class Message {\n\n\n\n\n\n\n\n\n\n    private String id;\n\n\n\n\n    @DBRef\n\n\n\n\n    private Content content;\n\n\n\n\n\n\n\n\n\n}\n\n\n\n\n\n\nA workaround would be to switch this object back to eager loading.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.1.RELEASE", "fixed_version": "1.5.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.convert.DbRefMappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.DefaultDbRefResolver.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java", "org.springframework.data.mongodb.core.convert.DbRefResolver.java", "org.springframework.data.mongodb.core.convert.LazyLoadingTestUtils.java", "org.springframework.data.mongodb.core.MongoTemplateTests.java"], "label": 1, "es_results": []}, {"bug_id": 887, "bug_title": "Repository not instantiated when entity contains field of type TreeMap", "bug_description": "Repository fails to instantiate when the entity contains a TreeMap with value class that does not have a convertor. I&apos;ve tested with HashMap, HashSet, TreeSet but this only seems to affect TreeMap.\n\n\n\n\n\n\n// Repository\n\n\n\n\npublic interface SourceRepository extends PagingAndSortingRepository<MyEntity, ObjectId> {\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n// Entity\n\n\n\n\n@Document(\"test_collection\")\n\n\n\n\npublic class MyEntity {\n\n\n\n\nprivate TreeMap<String,MyClass> treeMap;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n// TreeMap value class\n\n\n\n\npublic class MyClass {\n\n\n\n\nprivate String foo = \"bar\";\n\n\n\n\n}\n\n\n\n\n\n\nThis succeeds if i build a convertor for MyClass but it really shouldn&apos;t need one. This is working in 1.4.0.RELEASE but fails in version 1.4.1.RELEASE and beyond.\n\n\n\n\n\n\nThrows: java.lang.ArrayIndexOutOfBoundsException: 0\n\n\n\n\nIn: org.springframework.data.util.ParameterizedTypeInformation.getComponentType(ParameterizedTypeInformation.java:148)\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.1.RELEASE", "fixed_version": "1.5.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 888, "bug_title": "Mapping is not applied to SortObject during queries.", "bug_description": "during find() method with query that has Sort clause. The mapping hasn&apos;t been applied to Sort Object.\nFor e.g., I defined a filed as Id as followed.\n@Id\nprivate String orderId.  \nThen I have query condition like this. query.with(new Sort(\"orderId\"));\nThen the actual query should be sorted on \"_id\" (after mapping). But the sort is sent as is with \"orderId\".\nI have found this for find() method. May be the case in all places where the Sort Object is used.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.1.RELEASE", "fixed_version": "1.4.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java", "org.springframework.data.mongodb.core.QueryCursorPreparerUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 897, "bug_title": "FindAndUpdate broken when using @DbRef and interface as target", "bug_description": "NullPointerException is thrown when using MongoTemplate.findAndModify(...) with @DbRef and interface as @DbRef target. See attached project for more details. Probably regression issue since same test is passing with Spring Data Commons 1.6.3.RELEASE and Spring Data MongoDB 1.3.3.RELEASE.\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.1.RELEASE", "fixed_version": "1.4.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapper.java", "org.springframework.data.mongodb.core.convert.UpdateMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 892, "bug_title": "<mongo:mapping-converter> cannot be configured as nested bean definition", "bug_description": "The sample config which worked in the 1.1.1 version, but doesn&apos;t work now:\n\n\n\n\n\n\n<beans:bean id=\"messageStore\" class=\"org.springframework.integration.mongodb.store.ConfigurableMongoDbMessageStore\">\n\n\n\n\n\t\t<beans:constructor-arg ref=\"mongoDbFactory\"/>\n\n\n\n\n\t\t<beans:constructor-arg>\n\n\n\n\n\t\t\t<mongo:mapping-converter>\n\n\n\n\n\t\t\t\t<mongo:custom-converters>\n\n\n\n\n\t\t\t\t\t<mongo:converter>\n\n\n\n\n\t\t\t\t\t\t<beans:bean class=\"org.springframework.integration.mongodb.store.ConfigurableMongoDbMessageGroupStoreTests$MessageReadConverter\"/>\n\n\n\n\n\t\t\t\t\t</mongo:converter>\n\n\n\n\n\t\t\t\t</mongo:custom-converters>\n\n\n\n\n\t\t\t</mongo:mapping-converter>\n\n\n\n\n\t\t</beans:constructor-arg>\n\n\n\n\n\t\t<beans:constructor-arg value=\"testConfigurableMongoDbMessageStore\"/>\n\n\n\n\n\t</beans:bean>\n\n\n\n\n\n\nThat&apos;s because MappingMongoConverterParser doesn&apos;t check if the parserContext.isNested(), registers BeanDefinition and returns null", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.1.RELEASE", "fixed_version": "1.4.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.config.MappingMongoConverterParserIntegrationTests.java", "org.springframework.data.mongodb.config.MappingMongoConverterParser.java"], "label": 1, "es_results": []}, {"bug_id": 893, "bug_title": "Mapping Convertor does not remove \"_class\" property on collection of embedded objects", "bug_description": "Let&apos;s have this example:\n\none document has embedded field\nrepository with method which has collection of embedded fields as argument\n\n\n\n\n\n\n\nFoo.java\n\n\n\n\n\n\n@Document\n\n\n\n\npublic class Foo {\n\n\n\n\n   @Id\n\n\n\n\n   private ObjectId id;\n\n\n\n\n   private EmbeddedClass embedded;\n\n\n\n\n   //getters and setters\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\nEmbeddedClass.java\n\n\n\n\n\n\npublic class EmbeddedClass {\n\n\n\n\n   public String id;\n\n\n\n\n   //getters and setters\n\n\n\n\n   //hashcode and equals\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\nIFooRepository.java\n\n\n\n\n\n\n@Repository\n\n\n\n\npublic interface IFooRepository extends MongoRepository<Foo, ObjectId> {\n\n\n\n\n   public List<Foo> findByEmbeddedIn(List<EmbeddedClass> list);\n\n\n\n\n}\n\n\n\n\n\n\nAnd this repository method is not working (worked in 1.2.1)\nin spring-data-mongodb 1.2.1 it generates underlying query:\nfind: db.foo { \"embedded\" : { \"$in\" : [ { \"_id\" : \"0\"} , { \"_id\" : \"2\"}]} , \"_class : \"Foo\" }\nand in affected version 1.4.1 it generates:\nfind: db.foo { \"embedded\" : { \"$in\" : [ { \"_class\" : \"Foo\" , \"_id\" : \"0\"} , { \"_class\" : \"Foo\" , \"_id\" : \"2\"}]}}\nIn my opinion in MappingMongoConverter.convertToMongoType() it should call removeTypeInfoRecursively but it do not.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.1.RELEASE", "fixed_version": "1.4.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.QueryMapper.java", "org.springframework.data.mongodb.core.convert.QueryMapperUnitTests.java", "org.springframework.data.mongodb.repository.PersonRepository.java", "org.springframework.data.mongodb.repository.AbstractPersonRepositoryIntegrationTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 914, "bug_title": "Improve resolving of LazyLoading proxies for classes that override equals/hashcode", "bug_description": "", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.2.RELEASE", "fixed_version": "1.5.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.convert.DefaultDbRefResolver.java"], "label": 1, "es_results": []}, {"bug_id": 917, "bug_title": "DefaultDbRefResolver throws NPE when bundled into an uberjar", "bug_description": "\n\n\n\n\n\npublic class DefaultDbRefResolver implements DbRefResolver {\n\n\n\n\n\n\n\n\n\n\tprivate static final boolean IS_SPRING_4_OR_BETTER = SpringVersion.getVersion().startsWith(\"4\");\n\n\n\n\n\n\nAccording to the Spring API documentation, it&apos;s perfectly valid for getVersion to return null, but this code doesn&apos;t check for that scenario.\nThe SpringVersion.getVersion() will return null when the dependency is packaged using e.g. maven-shade-plugin.\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.2.RELEASE", "fixed_version": "1.5.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.convert.DefaultDbRefResolver.java"], "label": 1, "es_results": []}, {"bug_id": 948, "bug_title": "Assertion error in MongoTemplate.getMappedSortObject ", "bug_description": "MongoTemplate.executeQuery(Query query, String collectionName, DocumentCallbackHandler dch) creates a QueryCursorPreparer with type=null. \nSpecifying a sort condition for a query in that case will cause an error in MongoTemplate.getMappedSortObject which REQUIRES QueryCursorPreparer.type != null\nThe problem appeared around 1.4.2 I believe and it is still present in 1.5.0", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.2.RELEASE", "fixed_version": "1.4.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateUnitTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 952, "bug_title": "@Query annotation does not work with only field restrictions", "bug_description": "If you are using repository based queries and try to use @Query annotation to limit the fetched fields, it has zero effect.\nFor example repository query:\n\n\n\n\n\n\n@Query(fields = \"{ &apos;email&apos; : 1 }\")\n\n\n\n\nUser findByEmail(String email)\n\n\n\n\n\n\nThe query above returns all fields of the User and the fields definition has no effect at all. If you are using @Query with value attribute to define the query, then the fields limitation is applied though.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.4.2.RELEASE", "fixed_version": "1.4.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.PartTreeMongoQuery.java"], "label": 1, "es_results": []}, {"bug_id": 901, "bug_title": "MongoRepositoryConfigurationExtension fails to invoke super method", "bug_description": "The change for DATAMONGO-843 has wiped away the invocation of the registerBeansForRoot() method of the parent class which causes the repository type predicting BeanPostProcessor not being registered.\nThis might cause repository beans not be available for injection depending on the initialization order.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.0.M1", "fixed_version": "1.5.0.RC1", "fixed_files": ["org.springframework.data.mongodb.repository.config.MongoRepositoriesRegistrarIntegrationTests.java", "org.springframework.data.mongodb.repository.config.MongoRepositoryConfigurationExtension.java"], "label": 1, "es_results": []}, {"bug_id": 928, "bug_title": "Error when using field-naming-strategy-ref", "bug_description": " org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Only one of the attributes abbreviate-field-names and field-naming-strategy-ref can be configured!\nOccurs whenever field-naming-strategy-ref is used, possibly caused by abbreviate-field-names defaulting to false in the XSD:\n<xsd:attribute name=\"abbreviate-field-names\" use=\"optional\" default=\"false\">", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.0.RC1", "fixed_version": "1.5.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.config.MappingMongoConverterParserIntegrationTests.java", "org.springframework.data.mongodb.config.MappingMongoConverterParser.java"], "label": 1, "es_results": []}, {"bug_id": 938, "bug_title": "Exception when creating geo within Criteria using MapReduce", "bug_description": "I am getting an IllegalArgumentException when I try to query a MongoDB collection using a Criteria.within and a Box.\n\n\n\n\n\n\nCriteria.where(\"location\").within(new Box(lowerLeft, upperRight));\n\n\n\n\n\n\nThe exception reads:\njava.lang.IllegalArgumentException: can&apos;t serialize class org.springframework.data.mongodb.core.query.GeoCommand", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.0.RELEASE", "fixed_version": "1.4.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.mapreduce.MapReduceTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 963, "bug_title": "Compound index with expireAfterSeconds causes repeating error on mongodb server.", "bug_description": "Using @CompoundIndex(expireAfterSeconds=10) causes constantly repeating error on mongo server.\n\n\n\n\n\n\nERROR: key for ttl index can only have 1 field\n\n\n\n\n\n\n\nTTL indexes have the following limitations:\n\nCompound indexes are not supported.\n...\n\n_http://docs.mongodb.org/manual/core/index-ttl/_\nwe should either check for the number of keys used for the compound index (1 key is just fine) and raise an error if more than 1 key involved or remove the expireAfterSeconds attribute. \nMaybe we could deprecate the attribute for the 1.5 train.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.0.RELEASE", "fixed_version": "1.5.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexResolverUnitTests.java", "org.springframework.data.mongodb.core.index.CompoundIndex.java", "org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexResolver.java"], "label": 1, "es_results": []}, {"bug_id": 969, "bug_title": "String @id field is not mapped to ObjectId when using QueryDSL .id.in(Collection<String>)", "bug_description": "This is similar to DATAMONGO-467 which was resolved a while back.\nBut in this case instead of .eq() I am using .in().\n\n\n\n\n\n\n@Document\n\n\n\n\npublic class User {\n\n\n\n\n    @Id String id;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nCollection<String> collection = new ArrayList<>();\n\n\n\n\ncollection.add(\"abcdef.....\");\n\n\n\n\nIterable<User> user = userRepository.findAll(QUser.user.id.in(collection));\n\n\n\n\n\n\nThis is translating to $in clause with empty collection", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.0.RELEASE", "fixed_version": "1.6.0.M1", "fixed_files": ["org.springframework.data.mongodb.repository.support.SpringDataMongodbSerializerUnitTests.java", "org.springframework.data.mongodb.repository.support.SpringDataMongodbSerializer.java", "org.springframework.data.mongodb.repository.AbstractPersonRepositoryIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 987, "bug_title": "Problem with lazy loading in @DBRef when getting data using MongoTemplate", "bug_description": "The situation is simple: if we reference on an entity class another entity (both annotated with @Document) called Parent and Child. Here is the code:\n\n\n\n\n\n\n@Document\n\n\n\n\nclass Parent {\n\n\n\n\n     @Id\n\n\n\n\n     private String id;\n\n\n\n\n     private String name;\n\n\n\n\n     @DBref(lazy=true)\n\n\n\n\n     private Child child;\n\n\n\n\n\n\n\n\n\n    // getters and setters ommited\n\n\n\n\n}\n\n\n\n\n\n\nand the Child class\n\n\n\n\n\n\n@Document\n\n\n\n\nclass Child {\n\n\n\n\n      @Id\n\n\n\n\n       private String id;\n\n\n\n\n       private String name;\n\n\n\n\n      //getters and setters ommited\n\n\n\n\n}\n\n\n\n\n\n\nThe following situation should never happen:\n\n\n\n\n\n\nParent parent = new Parent();\n\n\n\n\nparent.setName(\"Daddy\");\n\n\n\n\nmongoTemplate.save(parent); //ok, it is persisted like we expected.\n\n\n\n\n// Than we try to load this same entity from the database\n\n\n\n\nCriteria criteria = Criteria.where(\"_id\").is(parent.getId());\n\n\n\n\nParent persisted = mongoTemplate.findOne(new Query(criteria), Parent.class);\n\n\n\n\n// The child attribute should be null, right?\n\n\n\n\nassertNull(persisted.getChild()); // it fails\n\n\n\n\n\n\nThe null attribute is actually an enhanced class generated by CGLib. It should not be. This brings a lot of problems when you, by accident, persist the same entity. I attached a project with the JUnit test which reproduces the problem for you.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.0.RELEASE", "fixed_version": "1.5.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverter.java", "org.springframework.data.mongodb.core.convert.DbRefMappingMongoConverterUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1001, "bug_title": "Cannot save/update lazy load object", "bug_description": "Test case:\n\n\n\n\n\n\n@Document\n\n\n\n\npublic class Child {\n\n\n\n\n    @Id\n\n\n\n\n    private String id;\n\n\n\n\n    private String name;\n\n\n\n\n   //gets/sets\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n@Document\n\n\n\n\npublic class Parent {\n\n\n\n\n    @Id\n\n\n\n\n    private String id;\n\n\n\n\n    @DBRef(lazy = true)\n\n\n\n\n    Child child;\n\n\n\n\n   //gets/sets\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n@Test\n\n\n\n\n    public void test01() {\n\n\n\n\n\n\n\n\n\n        final Child b = new Child();\n\n\n\n\n        b.setName(\"name\");\n\n\n\n\n        this.mongoTemplate.save(b);\n\n\n\n\n\n\n\n\n\n        final Parent tmpl = new Parent();\n\n\n\n\n        tmpl.setChild(b);\n\n\n\n\n        this.mongoTemplate.save(tmpl);\n\n\n\n\n\n\n\n\n\n        final Criteria criteria = Criteria.where(\"child\").is(tmpl.getChild());\n\n\n\n\n        final Parent parent = this.mongoTemplate.findOne(Query.query(criteria), Parent.class);\n\n\n\n\n        assertNotNull(parent.getChild().getName());\n\n\n\n\n\n\n\n\n\n        final Child relatedChild = parent.getChild();\n\n\n\n\n        final String contentId = relatedChild.getId();\n\n\n\n\n        relatedChild.setName(\"changing name\");\n\n\n\n\n\n\n\n\n\n        this.mongoTemplate.save(relatedChild);\n\n\n\n\n\n\n\n\n\n        final Child child = this.mongoTemplate.findById(contentId, Child.class);\n\n\n\n\n        System.out.println(child.getName());\n\n\n\n\n        assertEquals(relatedChild.getName(), child.getName());\n\n\n\n\n    }\n\n\n\n\n\n\nLazy loaded references are not being updated.\nShould parent.getChild() return the real entity instance and not the proxy instance?\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.0.RELEASE", "fixed_version": "1.5.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.LazyLoadingProxy.java", "org.springframework.data.mongodb.core.convert.DefaultDbRefResolver.java", "org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java", "org.springframework.data.mongodb.core.convert.CustomConversionsUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1050, "bug_title": "SimpleMongoRepository.findById(id, class)  do not return ids for nested documents.", "bug_description": "SimpleMongoRepository.findById(id, class)  don&apos;t return ids for nested documents.\nE.g. \n\n\n\n\n\n\nclass A {\n\n\n\n\n private String id; //stored in mongo as \"id\"\n\n\n\n\n private String name;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nclass B {\n\n\n\n\n  private String id; // stored in mongo as \"_id\"\n\n\n\n\n  private List<A> innerDocs;\n\n\n\n\n}\n\n\n\n\n\n\nWhen it return B documents, innerDocs A objects have id == null. If i refactor A.id to A.myId, then it start working correctly.\nSaving data (save, updateFirst, etc) always save fields correctly.\nA and B objects are pojos (only lombok @Data and @NoArgsConstructor is used to provide getters and setters). Ids are created by mongo.\nCould it related somehow  to ids that have 24 characters, but stored not as \"_id\"?\nEasy workaround is to have different field name (not \"id\").", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.1.RELEASE", "fixed_version": "1.7.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.mapping.BasicMongoPersistentPropertyUnitTests.java", "org.springframework.data.mongodb.core.convert.QueryMapperUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.mapping.BasicMongoPersistentProperty.java"], "label": 1, "es_results": []}, {"bug_id": 1025, "bug_title": "Duplicate index creation on embedded documents ", "bug_description": "Having the documents:\n\n\n\n\n\n\n@CompoundIndexes({ @CompoundIndex(collection=\"timeRead\", name = \"eventIdAndChip\", def = \"{eventId : 1, chip : 1}\"),\n\n\n\n\n        @CompoundIndex(collection=\"timeRead\", name = \"eventIdAndPublish\", def = \"{ eventId : 1, publish : 1}\"),\n\n\n\n\n        @CompoundIndex(collection=\"timeRead\", name = \"chipAndTimeReadTickIndex\", def = \"{&apos;chip&apos; : -1, &apos;timeReadTick&apos; : 1}\") })\n\n\n\n\n@Document\n\n\n\n\npublic class TimeRead { }\n\n\n\n\n\n\nand \n\n\n\n\n\n\n@Document\n\n\n\n\npublic class TimeReadChip {\n\n\n\n\n\n\n\n\n\n    private Map<String, TimeRead> timeReads;\n\n\n\n\n    private Map<String, TimeRead> pointNameToTimeRead;\n\n\n\n\n}\n\n\n\n\n\n\nThe Mongo driver tries to create the same indexes twice: once because they are defined as compound on TimeRead (which is correct), and a second time when parsing the TimeReadChip document (incorrect). I&apos;m assuming it sees the Map<String, TimeRead> and tries to create indexes on timeRead collection (again). This bug was introduced after 1.3.5.RELEASE.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.2.RELEASE", "fixed_version": "1.5.4.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexResolverUnitTests.java", "org.springframework.data.mongodb.core.index.Indexed.java", "org.springframework.data.mongodb.core.index.GeoSpatialIndexed.java", "org.springframework.data.mongodb.core.index.CompoundIndex.java", "org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexResolver.java", "org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexCreatorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1027, "bug_title": "Collection inherits complex index from embedded class/object", "bug_description": "Say I have two collections:\nBooks and Author\nAuthor has a unique compound index and Book has a list of authors as property.\nNow if I add different book with the same author to books, the insert is ignored because books inherits the index from authors.\nOn a subsequent context restart I&apos;m also getting a duplicate key exception:\n\n\n\n\n\n\ncom.mongodb.MongoException$DuplicateKey: { \"serverUsed\" : \"\" , \"err\" : \"E11000 duplicate key error index: db.books.$name_appId_idx  dup key\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.2.RELEASE", "fixed_version": "1.5.4.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexResolverUnitTests.java", "org.springframework.data.mongodb.core.index.Indexed.java", "org.springframework.data.mongodb.core.index.GeoSpatialIndexed.java", "org.springframework.data.mongodb.core.index.CompoundIndex.java", "org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexResolver.java", "org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexCreatorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1030, "bug_title": "Query methods retuning a single entity does not work with projecting types", "bug_description": "Assume the following repository:\n\n\n\n\n\n\ninterface UserRepository extends CrudRepository<User, BigInteger> {\n\n\n\n\n\n\n\n\n\n  UserSummary findSummaryByLastnameLike(String lastname);\n\n\n\n\n}\n\n\n\n\n\n\nAssuming that UserSummary does not extend User executing the query method will always return null as the collection the query is run against will be derived from UserSummary which it shouldn&apos;t in this case.\nThe issue is that SingleEntityExecution does not hand the collection name of the MongoEntityMetadata to the template so that the collection is derived from the return type only.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.2.RELEASE", "fixed_version": "1.5.4.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.AbstractMongoQuery.java", "org.springframework.data.mongodb.repository.AbstractPersonRepositoryIntegrationTests.java", "org.springframework.data.mongodb.repository.PersonRepository.java"], "label": 1, "es_results": []}, {"bug_id": 1072, "bug_title": "Query placeholders in keys no longer correctly substituted", "bug_description": "Between 1.5.1.RELEASE and 1.5.2.RELEASE, processing of query parameters for keys was broken.  Example, this query:\n\n\n\n\n\n\n  @Query(\"{?0 : ?1}\")\n\n\n\n\n  List<T> findAllByKeyValue(String key, String value);\n\n\n\n\n\n\nWhen called with these parameters:\n\n\n\n\n\n\n  findAllByKeyValue(\"name\", \"Joe\");\n\n\n\n\n\n\nbecomes this with 1.5.1: {\"name\" : \"Joe\"}\nBut with 1.5.2, the ?0 is not correctly substituted so this is the broken query that is created: {\"?0\" : \"Joe\"}", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.2.RELEASE", "fixed_version": "1.6.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.StringBasedMongoQueryUnitTests.java", "org.springframework.data.mongodb.repository.AbstractPersonRepositoryIntegrationTests.java", "org.springframework.data.mongodb.repository.PersonRepository.java", "org.springframework.data.mongodb.repository.query.StringBasedMongoQuery.java"], "label": 1, "es_results": []}, {"bug_id": 1043, "bug_title": "SpEL Expressions in @Document annotations are not re-evaluated for query executions", "bug_description": "Based on the idea of Oliver Gierke in https://jira.spring.io/browse/DATAMONGO-525 I followed some post like the ones below\nhttp://stackoverflow.com/questions/18129291/mongodb-and-spel-expressions-in-document-annotations\nand\nhttp://stackoverflow.com/questions/19807733/mongodb-multi-tenacy-spel-with-document?rq=1\nbut in the end I realized that the problem is that AbstractMongoQuery is cached between requests(maybe a problem in my config?), and its query-method object of type MongoQueryMethod, which holds the metadata, MongoEntityMetadata. And thus make this approach (use SpEL in @Document annotation) not fully working.\nAbstractMongoQuery deals with different kind of executions. All of them but SingleEntityExecution suffers from this problem, and it&apos;s because in SingleEntityExecution mongoOperations is called without passing collectionName and thus letting, in the end, BasicMongoPersistentEntity.getCollection apply SpEL over entity class to obtain the runtime collection name.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.2.RELEASE", "fixed_version": "1.7.0.M1", "fixed_files": ["org.springframework.data.mongodb.repository.query.SimpleMongoEntityMetadata.java", "org.springframework.data.mongodb.repository.query.MongoQueryMethod.java"], "label": 1, "es_results": []}, {"bug_id": 1040, "bug_title": "deleteAll repository query do not use EntityMetadata collection name", "bug_description": "Unlike other methods, deleteAll repository queries don&apos;t use the collection name provided by MongoEntityMetadata. This prevents me to use multiple collection names for a same Entity.\nIn AbstractMongoQuery$AbstractMongoQuery :\n\n\n\n\n\n\n\t\tprivate Object deleteAndConvertResult(Query query, MongoEntityMetadata<?> metadata) {\n\n\n\n\n\n\n\n\n\n\t\t\tif (method.isCollectionQuery()) {\n\n\n\n\n\t\t\t\treturn operations.findAllAndRemove(query, metadata.getJavaType());\n\n\n\n\n\t\t\t}\n\n\n\n\n\n\n\n\n\n\t\t\tWriteResult writeResult = operations.remove(query, metadata.getJavaType(), metadata.getCollectionName());\n\n\n\n\n\t\t\treturn writeResult != null ? writeResult.getN() : 0L;\n\n\n\n\n\t\t}\n\n\n\n\n\n\nA simple change will fix that :\n\n\n\n\n\n\n\t\t\tif (method.isCollectionQuery()) {\n\n\n\n\n\t\t\t\treturn operations.findAllAndRemove(query, metadata.getJavaType(), metadata.getCollectionName());\n\n\n\n\n\t\t\t}\n\n\n\n\n\n\nThanks", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.4.RELEASE", "fixed_version": "1.6.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.AbstractMongoQuery.java", "org.springframework.data.mongodb.repository.query.AbstractMongoQueryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1068, "bug_title": "elemMatch of Class Criteria fails to build special cirteria", "bug_description": "There is an entity like this:  \n\n\n\n\n\n\n\t\n\n\n\n\n\tpublic class Room {\n\n\n\n\n\t\tprivate String name;\n\n\n\n\n\t\tprivate List<Date> occupied;\n\n\n\n\n\t}\n\n\n\n\n\n\nI need to issue a criteria to fetch all documents in which none of elements of occupied falls into a specified date range. The query JSON is:  \n\n\n\n\n\n\n\t{\n\n\n\n\n\t\toccupied : {\n\n\n\n\n\t\t\t$not : {\n\n\n\n\n\t\t\t\t$elemMatch : {\n\n\n\n\n\t\t\t\t\t$gte : start,\n\n\n\n\n\t\t\t\t\t$lte : end\n\n\n\n\n\t\t\t\t}\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t}\n\n\n\n\n\t}\n\n\n\n\n\n\nThen, I tried on  \n\n\n\n\n\n\n\tCriteria c1 = new Criteria().gte(start).lte(end);\n\n\n\n\n\tCriteria c = Criteria.where(\"occupied\").not().elemMatch(c1);\n\n\n\n\n\n\nBut the serialization to JSON for c is:\n\n\n\n\n\n\n\t\n\n\n\n\n{\n\n\n\n\n\toccupied : {\n\n\n\n\n\t\t$not : {\n\n\n\n\n\t\t\t$elemMatch : {\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t}\n\n\n\n\n\t}\n\n\n\n\n}\n\n\n\n\n\n\nIt seems that c1 will be explained to empty Map by invoking elemMatch(Criteria) because I haven&apos;t assign a key to it. But really no key I can assign to it.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.4.RELEASE", "fixed_version": "1.6.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.query.Criteria.java", "org.springframework.data.mongodb.core.query.CriteriaTests.java"], "label": 1, "es_results": []}, {"bug_id": 1077, "bug_title": "Update removes positional operator $ in key when used on DBRef property", "bug_description": "Ensure the following works in UpdateMapperUnitTests.\n\n\n\n\n\n\n/**\n\n\n\n\n * @see SO-26556527\n\n\n\n\n */\n\n\n\n\n@Test\n\n\n\n\npublic void shouldNotRemovePositionalParameter() {\n\n\n\n\n\n\n\n\n\n\tUpdate update = new Update();\n\n\n\n\n\tupdate.unset(\"dbRefAnnotatedList.$\");\n\n\n\n\n\n\n\n\n\n\tDBObject mappedUpdate = mapper.getMappedObject(update.getUpdateObject(),\n\n\n\n\n\t\t\tcontext.getPersistentEntity(DocumentWithDBRefCollection.class));\n\n\n\n\n\n\n\n\n\n\tDBObject $unset = DBObjectTestUtils.getAsDBObject(mappedUpdate, \"$unset\");\n\n\n\n\n\n\n\n\n\n\tassertThat($unset, equalTo(new BasicDBObjectBuilder().add(\"dbRefAnnotatedList.$\", 1).get()));\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.4.RELEASE", "fixed_version": "1.6.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapper.java", "org.springframework.data.mongodb.core.convert.UpdateMapper.java", "org.springframework.data.mongodb.core.convert.UpdateMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1080, "bug_title": "AbstractMongoQuery must not eagerly post-process results", "bug_description": "Currently using Optional with repository query methods doesn&apos;t work correctly as the ConversionService used in AbstractMongoQuery tries to eagerly convert the result returned by the query execution into the methods return type.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.4.RELEASE", "fixed_version": "1.6.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.AbstractMongoQuery.java", "org.springframework.data.mongodb.repository.query.AbstractMongoQueryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1139, "bug_title": "MongoQueryCreator must not create $nearSphere query for neutral Distance", "bug_description": "MongoQueryCreator.from() compares the Distance&apos;s metric against null which will never result in true as {8Distance}} returns Metric.NEUTRAl by default.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.4.RELEASE", "fixed_version": "1.5.5.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.StubParameterAccessor.java", "org.springframework.data.mongodb.repository.query.MongoQueryCreator.java", "org.springframework.data.mongodb.repository.query.MongoQueryCreatorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1216, "bug_title": "Authentication mechanism PLAIN  changes to SCRAM-SHA-1 ", "bug_description": "We have a mongodb properly configured with plain authentication mechanism, and we can successfully log in using mongodb client. However, if we try to connect using mongo driver + spring data, login is incorrect due to authentication mechanism sent is SCRAM-SHA-1 and not PLAIN.\nWe have made a code review and a full debug and the problem seems to be in MongoDbUtils.doGetDB(Mongo, String, UserCredentials, boolean, String) method, in the synchronized block, since the authentication mechanism seems to get lost there.\nOur spring data configuration is:\n\n\n\n\n\n\n<mongo:db-factory uri=\"mongodb://user:pass@ip1:port1,ip2:port2,/logCenter?authSource=$external&amp;authMechanism=PLAIN\" />\n\n\n\n\n\n\n\n\n\n<bean id=\"mongoTemplate\" class=\"org.springframework.data.mongodb.core.MongoTemplate\">\n\n\n\n\n\t<constructor-arg name=\"mongoDbFactory\" ref=\"mongoDbFactory\"></constructor-arg>\n\n\n\n\n</bean>\n\n\n\n\n\t\n\n\n\n\n<mongo:repositories base-package=\"com.xxx.repositories\" />\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.5.5.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.MongoDbUtils.java", "org.springframework.data.mongodb.core.MongoDbUtilsUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 995, "bug_title": "Parameter binding in String-based query does not bind all parameters", "bug_description": "In version 1.5.1, the parameter&apos;s pattern is defined (in org.springframework.data.mongodb.repository.query.StringBasedMongoQuery.java) as:\n\n\n\n\n\n\n  Pattern PLACEHOLDER = Pattern.compile(\"\\\\?(\\\\d+)\")\n\n\n\n\n\n\nand in 1.6, it has changed to\n\n\n\n\n\n\n  StringBuilder builder = new StringBuilder();\n\n\n\n\n  builder.append(\"\\\\?(\\\\d+)\"); // position parameter and parameter index\n\n\n\n\n  builder.append(\"[^,&apos;\\\"]*\"); // followed by non quotes, non field separators\n\n\n\n\n  builder.append(\"[,\\\"&apos;}]?\");\n\n\n\n\n  PARAMETER_BINDING_PATTERN = Pattern.compile(builder.toString(), CASE_INSENSITIVE);\n\n\n\n\n\n\nWith an annotation query like this:\n@Query(value = \"{$where: &apos;return this.date.getUTCMonth() == ?3 && this.date.getUTCDay() == ?4;&apos;...}\")\nIn version 1.6, the parameter ?4 gets ignored and it causes a query syntax error (while in 1.5.x, it works as expected).\nThe is the error I got in the console:\norg.springframework.data.mongodb.UncategorizedMongoDbException: \n{ \"serverUsed\" : \"localhost:27017\" , \"errmsg\" : \"exception: SyntaxError: Unexpected token ?\" , \"code\" : 16722 , \"ok\" : 0.0}\n; nested exception is com.mongodb.CommandFailureException: \n{ \"serverUsed\" : \"localhost:27017\" , \"errmsg\" : \"exception: SyntaxError: Unexpected token ?\" , \"code\" : 16722 , \"ok\" : 0.0}", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.0.M1", "fixed_version": "1.5.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.StringBasedMongoQueryUnitTests.java", "org.springframework.data.mongodb.repository.query.StringBasedMongoQuery.java"], "label": 1, "es_results": []}, {"bug_id": 1062, "bug_title": "Fix failing test in ServerAddressPropertyEditorUnitTests.", "bug_description": "The test rejectsAddressConfigWithoutASingleParsableServerAddress fails because the supposedly non-existing hostname \"bar\" \"now\" resolves to a real host-address: \n```\ntom@gauss ~/Documents/dev/repos/spring/spring-data-mongodb (master)$ ping bar\nPING bar (127.0.53.53): 56 data bytes\nRequest timeout for icmp_seq 0\n```", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.0.RELEASE", "fixed_version": "1.6.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.config.ServerAddressPropertyEditorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1058, "bug_title": "Using @Field(\"foo\") with @Dbref breaking behavior.", "bug_description": "When transitioning from 1.4.3.RELEASE to 1.6.0.RELEASE, the model below no longer returns with map\nModel\n\n\n\n\n\n\n@Document(collection=\"model\")\n\n\n\n\nclass Model {\n\n\n\n\n\t@Id\n\n\n\n\n\tObjectId id;\n\n\n\n\n        \n\n\n\n\n/**\n\n\n\n\n* Currently only works without @Field annotation\n\n\n\n\n*/\n\n\n\n\n    @Field(\"foo\")\n\n\n\n\n\t@DBRef\n\n\n\n\n\tMap<String, Foo> mapOfFoos ; //assume Foo is a class\n\n\n\n\n}\n\n\n\n\n\n\nRepo\n\n\n\n\n\n\npublic interface ModelDao extends MongoRepository<Model, ObjectId> {\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\npublic interface FooDao extends MongoRepository<Foo, ObjectId> {\n\n\n\n\n}\n\n\n\n\n\n\nSnippet of a unit test\n\n\n\n\n\n\n...\n\n\n\n\nModel model = new Model();\n\n\n\n\nMap<String, Foo> mapOfFoos = new HashMap<String, Foo>();\n\n\n\n\nFoo foo = new Foo()\n\n\n\n\nfooDao.save(foo)\n\n\n\n\nmapOfFoo(\"somestring\", foo)\n\n\n\n\nmodel.setMapOfFoos(mapOfFoo)\n\n\n\n\nmodelDao.save(model);\n\n\n\n\nModel  retreivedModel = modelDao.findOne(model.getId());\n\n\n\n\n//retreivedModel.getMapOfFoos() returns null\n\n\n\n\n//EXPECTED (and previous behavior) retreivedModel.getMapOfFoos() not null\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.0.RELEASE", "fixed_version": "1.6.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 1057, "bug_title": "AbstractMongoQuery.SlicedExecution#execute() skips every nth element", "bug_description": "AbstractMongoQuery.SlicedExecution#execute() skips every nth element. Say the page size is 20, every 21st element is skipped. This is because of the pageSize increment", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.0.RELEASE", "fixed_version": "1.6.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.AbstractMongoQuery.java", "org.springframework.data.mongodb.repository.AbstractPersonRepositoryIntegrationTests.java", "org.springframework.data.mongodb.repository.query.AbstractMongoQueryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1053, "bug_title": "In 1.6, any field in a mapped object named \"language\" will fail to map if it is a type other than String", "bug_description": "In 1.6, there is now a restriction that a field named \"language\" must be a String.  So, in 1.5, the following will map but will not map in 1.6:\n\n\n\n\n\n\npackage com.instantly.pipeline.engine.model;\n\n\n\n\n\n\n\n\n\nimport javax.persistence.Id;\n\n\n\n\n\n\n\n\n\npublic class Foobar {\n\n\n\n\n\n\n\n\n\n    @Id\n\n\n\n\n    String id;\n\n\n\n\n    \n\n\n\n\n    private Number language;\n\n\n\n\n\n\n\n\n\n    public String getId() {\n\n\n\n\n        return id;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    public void setId(String id) {\n\n\n\n\n        this.id = id;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    public Number getLanguage() {\n\n\n\n\n        return language;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    public void setLanguage(Number language) {\n\n\n\n\n        this.language = language;\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.0.M1", "fixed_version": "1.6.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.mapping.BasicMongoPersistentEntity.java", "org.springframework.data.mongodb.core.mapping.BasicMongoPersistentEntityUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1096, "bug_title": "RuntimeExceptions during debug query printing in MongoTemplate", "bug_description": "When printing DEBUG logs for remove and update queries in org.springframework.data.mongodb.core.MongoTemplate, string value of queries should be obtained with org.springframework.data.mongodb.core.query.SerializationUtils#serializeToJsonSafely method.  This protects us from RuntimeException&apos;s as mentioned in DATAMONGO-495", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.1.RELEASE", "fixed_version": "1.7.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 1094, "bug_title": "Wrong reference to @DocumentField in error message", "bug_description": "Looking through the code, it looks like this message is outdated:\nhttps://github.com/spring-projects/spring-data-mongodb/blob/master/spring-data-mongodb/src/main/java/org/springframework/data/mongodb/core/mapping/BasicMongoPersistentEntity.java#L56\nI guess it should just refer to the @Field annotation to disambiguate? According to git blame this has been there for quite a while", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.1.RELEASE", "fixed_version": "1.7.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.mapping.MongoMappingContextUnitTests.java", "org.springframework.data.mongodb.core.mapping.BasicMongoPersistentEntity.java"], "label": 1, "es_results": []}, {"bug_id": 1120, "bug_title": "Pageable queries timeout or return incorrect counts", "bug_description": "Counts for total elements and pages on some repositories return 0 and some throw a 500 when the socket times out.  This is ONLY occurring on calls that return a Page object and accept a Pageable input.  After debugging a bit, the inputs all seem to be populated from the controller fine.  The query definitions are\nfindByActiveIsTrue = wrong counts for totalElements and totalPages. both are 0\nfindByUserId = this collection is large at around 3 million records, but is indexed.\nThis is only happening in 1.6.1 and works correctly in 1.6.0", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.1.RELEASE", "fixed_version": "1.6.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.AbstractMongoQueryUnitTests.java", "org.springframework.data.mongodb.repository.query.AbstractMongoQuery.java", "org.springframework.data.mongodb.core.MongoOperations.java", "org.springframework.data.mongodb.core.MongoTemplate.java", "org.springframework.data.mongodb.repository.Person.java"], "label": 1, "es_results": []}, {"bug_id": 1118, "bug_title": "Custom converters not used for map keys", "bug_description": "I have an enum with rather long names and shorter per-value \"tags\" that I want to use for serialization. I&apos;ve implemented a Converter pair that maps the values back and forth. They work properly when saving a Set of the enum.\nHowever, when saving a Map<MyEnum,?>, the converter method is skipped; the enum&apos;s name is still used as the map key saved to Mongo. This would be frustrating but work-aroundable, but the proper converter is applied on reads. This means that when I save an object with a non-empty map and immediately attempt to read it, I get an exception when calling the read converter (since it&apos;s being supplied an invalid argument).\nThe problem appears to be at MappingMongoConverter:644, where the conversion service is explicitly skipped. This means that converters are applied to all types on read, and to all instances except map keys on write.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.1.RELEASE", "fixed_version": "1.5.5.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java", "org.springframework.data.mongodb.core.convert.CustomConversions.java"], "label": 1, "es_results": []}, {"bug_id": 1123, "bug_title": "geoNear, does not return all matching elements, it returns only a max of 100 documents", "bug_description": "Aloha,\nI have the following query:\n\n\n\n\n\n\npublic GeoResults<MyObject> findByTypeAndLocationNear(MyObjectType type, Point p, Distance distance) {\n\n\n\n\n   final NearQuery nearQuery = NearQuery.near(p).maxDistance(distance);\n\n\n\n\n   log.info(\"{}\",nearQuery.toDBObject());\n\n\n\n\n   return mongoTemplate.geoNear(nearQuery, MyObject.class);\n\n\n\n\n}\n\n\n\n\n\n\nThe geoNear method is documented like this:\n\n\n\n\n\n\nReturns {@link GeoResults} for all entities matching the given {@link NearQuery}.\n\n\n\n\n\n\nI expect 1000 \"matching\" documents But i only get 100. There is some default being set, that restricts the result to 100. That should be stated in the method. And another method having a pageable should be added.\nWhat do you think?", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.1.RELEASE", "fixed_version": "1.5.5.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoOperations.java"], "label": 1, "es_results": []}, {"bug_id": 1126, "bug_title": "Repository keyword query findByInId with pageable not returning correctly", "bug_description": "I&apos;ve been trying to use the In-keyword with identifiers and making the query pageable. The query returns results but getTotalElements() and getTotalPages() always returns 0. Also when you try to get any other page than 0, no results return. I&apos;ve tried using In with another member other than id and it works as expected. Below is a strip down example I used for testing;\nI&apos;ve created 3 types and 10 items per those types, results in a total of 30 items.\n\n\n\n\n\n\n@Document\n\n\n\n\npublic class Item {\n\n\n\n\n\n\n\n\n\n    @Id\n\n\n\n\n    private String id;\n\n\n\n\n    private String type;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\npublic interface ItemRepository extends MongoRepository<Item, String> {\n\n\n\n\n\n\n\n\n\n    Page<Item> findByIdIn(Collection ids, Pageable pageable);\n\n\n\n\n    Page<Item> findByTypeIn(Collection types, Pageable pageable);\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n@RunWith(SpringJUnit4ClassRunner.class)\n\n\n\n\n@ContextConfiguration(classes = {MongoDbConfig.class})\n\n\n\n\n@TransactionConfiguration(defaultRollback = false)\n\n\n\n\npublic class TestPageableIdIn {\n\n\n\n\n\n\n\n\n\n    @Autowired\n\n\n\n\n    private ItemRepository itemRepository;\n\n\n\n\n    \n\n\n\n\n    private List<String> allIds = new LinkedList<>();\n\n\n\n\n\n\n\n\n\n    @Before\n\n\n\n\n    public void setUp() {\n\n\n\n\n        itemRepository.deleteAll();\n\n\n\n\n        String[] types = {\"SWORD\", \"SHIELD\", \"ARMOUR\"};\n\n\n\n\n\n\n\n\n\n        // 10 items per type\n\n\n\n\n        for (String type : types) {\n\n\n\n\n            for (int i = 0; i < 10; i++) {\n\n\n\n\n                String id = UUID.randomUUID().toString();\n\n\n\n\n                allIds.add(id);\n\n\n\n\n                itemRepository.save(new Item(id, type));\n\n\n\n\n            }\n\n\n\n\n        }\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    @Test\n\n\n\n\n    public void testPageableIdIn() {\n\n\n\n\n        \n\n\n\n\n        Pageable pageable = new PageRequest(0, 5);\n\n\n\n\n        \n\n\n\n\n        // expect 5 Items returned, total of 10 Items(SWORDS) in 2 Pages\n\n\n\n\n        Page<Item> results = itemRepository.findByTypeIn(Arrays.asList(\"SWORD\"), pageable);\n\n\n\n\n        Assert.assertEquals(5, results.getContent().size());\n\n\n\n\n        Assert.assertEquals(10, results.getTotalElements());\n\n\n\n\n        Assert.assertEquals(2, results.getTotalPages());\n\n\n\n\n        \n\n\n\n\n        // expect 5 Items returned, total of 30 Items in 6 Pages\n\n\n\n\n        results = itemRepository.findByIdIn(allIds, pageable);\n\n\n\n\n        Assert.assertEquals(5, results.getContent().size());\n\n\n\n\n        Assert.assertEquals(30, results.getTotalElements()); // this is returning 0\n\n\n\n\n        Assert.assertEquals(6, results.getTotalPages());     // this is returning 0\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.1.RELEASE", "fixed_version": "1.6.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.AbstractMongoQueryUnitTests.java", "org.springframework.data.mongodb.repository.query.AbstractMongoQuery.java", "org.springframework.data.mongodb.core.MongoOperations.java", "org.springframework.data.mongodb.core.MongoTemplate.java", "org.springframework.data.mongodb.repository.Person.java"], "label": 1, "es_results": []}, {"bug_id": 1180, "bug_title": "Incorrect exception message creation in PartTreeMongoQuery.", "bug_description": "In PartTreeMongoQuery#createQuery the JSONParseException is passed to the String.format() instead of IllegalStateException.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.2.RELEASE", "fixed_version": "1.7.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.PartTreeMongoQueryUnitTests.java", "org.springframework.data.mongodb.repository.query.PartTreeMongoQuery.java"], "label": 1, "es_results": []}, {"bug_id": 1166, "bug_title": "ReadPreference not used for Aggregations.", "bug_description": "From the referenced issue on SO:\n\nIt turned out that spring-data-mongodb does not pass the read preference specified on mongoTemplate to the underlying com.mongodb.Mongo connection pool - for aggregations. It would pass the read preference for simple find operations.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.2.RELEASE", "fixed_version": "1.6.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateUnitTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 1232, "bug_title": "IgnoreCase should escape queries", "bug_description": "The IgnoreCase query generator is subject to a sort of \"regex injection\" attack, because the query generator simply slaps ^..$ around the string and passes it directly to MongoDB. This fails when the string contains any sort of special characters. In my case, I&apos;m trying to perform a case-insensitive find on an e-mail address with the + sign, a legal character, but the regex interprets this as 1..*.\nThe query generator needs to properly escape regex-special characters.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.2.RELEASE", "fixed_version": "1.6.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.MongoQueryCreator.java", "org.springframework.data.mongodb.repository.query.MongoQueryCreatorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1236, "bug_title": "MongoOperations findAndModify and updateFirst do not include the _class in Map values", "bug_description": "When a map of type LinkedHashMap<String, Object>  is updated via MongoOperations findAndModify or updateFirst, the _class field is not saved for the map values.  Therefore, later reads of the data do not convert the value to the correct type, instead leaving it as LinkedHashMap. \nPlease see attached maven project for test illustrating the problem. ", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.2.RELEASE", "fixed_version": "1.6.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.UpdateMapper.java", "org.springframework.data.mongodb.core.convert.UpdateMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1254, "bug_title": "Group after Project in aggregation uses incorrect field name", "bug_description": "When creating an aggregation, if a new field is named in the project, the new field name is converted to something else in a group by following the projection; the name passed in the group by is ignored.  This causes the results to be incorrect. See test case for an example. ", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.3.RELEASE", "fixed_version": "1.7.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.aggregation.AggregationUnitTests.java", "org.springframework.data.mongodb.core.aggregation.ProjectionOperation.java"], "label": 1, "es_results": []}, {"bug_id": 1263, "bug_title": "Missing indexes in associations involving generic types", "bug_description": "When an association between documents involves generic types, the type information is not correctly inferred at startup time resulting in missing indexes.\nPlease, see https://github.com/agustisanchez/SpringDataMongoDBBug, for code samples.\nGiven:\n\nclass Book with index on \"ISBN\" attribute\nsuper class AbstractProduct with index on \"name\" attribute\nclass ProductWrapper holding attribute \"content\" of generic type \"T extends AbstractProduct\"\n\nWhen defining a class Catalog with a list of \"wrapped\" books:\n\nList<ProductWrapper<Book>> books2 = new ArrayList<>\n\nThe index \"name\" inherited from AbstractProduct is created (book2.content.name) inside \"catalog\" , but the index defined on the Book class itself (isbn) is not created as Spring Data Mongo is only inferring type infromation from the ProductWrapper class definition (ProductWrapper <T extends AbstractProduct>).\nSpring Data MongoDB should be able to infer type information from the list declaration ( List<ProductWrapper<Book>> ), becoming aware that Catalog contains a list of Books, hence indexes defined on Book should be created.\nIf the wrapper class is defined as ProductWrapper<T>, then no indexes are created at all on Catalog.books2.content.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.3.RELEASE", "fixed_version": "1.8.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexResolverUnitTests.java", "org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexResolver.java"], "label": 1, "es_results": []}, {"bug_id": 1297, "bug_title": "Unique Index on DBRef", "bug_description": "I&apos;m not able to uniquely index a property if it&apos;s a reference.\nFor example: \n\n\n\n\n\n\n\n\n\n\n\n@DBRef\n\n\n\n\n@Indexed(unique = true) // This does not work because of @DBRef\n\n\n\n\nprivate User user1;\n\n\n\n\n\n\n\n\n\n@Indexed(unique = true) // This works fine\n\n\n\n\nprivate User user1;\n\n\n\n\n\n\n\n\n\n\n\nI know that it&apos;s possible to unique index a DBRef, so I&apos;m not sure why this doesn&apos;t work. It seems like a pretty important piece of functionality. ", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.3.RELEASE", "fixed_version": "1.8.1.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexResolverUnitTests.java", "org.springframework.data.mongodb.core.index.MongoPersistentEntityIndexResolver.java"], "label": 1, "es_results": []}, {"bug_id": 1208, "bug_title": "MongoTemplate.stream() does not consider limit, order, sort etc.", "bug_description": "I am trying to introduce the operation mongoTemplate.stream in my project.\nThis is the code I use to create the query-object\n\n\n\n\n\n\n    private Query createQuery(Criteria criteria, int pageSize, boolean disableTimeout, boolean limitFrom) {\n\n\n\n\n        Query query = query(criteria)\n\n\n\n\n                .with(\n\n\n\n\n                        new PageRequest(\n\n\n\n\n                                0, pageSize,\n\n\n\n\n                                new Sort(limitFrom ? Sort.Direction.ASC : Sort.Direction.DESC, \"timestamp\")));\n\n\n\n\n\n\n\n\n\n        if (disableTimeout) {\n\n\n\n\n            query = query.maxTime(4, TimeUnit.HOURS);\n\n\n\n\n        }\n\n\n\n\n        return query;\n\n\n\n\n    }\n\n\n\n\n\n\nThe resulting query contains a value for the limit-field. However, when executing the stream-operation, the limit-value is not taken into account and I retrieve all matching documents.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.7.0.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 1193, "bug_title": "Prevent unnecessary database lookups when resolving DBRefs on 2.x driver", "bug_description": "DefaultDbRefResolver looks up a DB instance via the MongoDbFactory whose output will not actually be used in the case of using the MongoDB 2.x Java driver.\nThis causes a performance degradation especially in collections of DBRef instances.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.7.0.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.convert.ReflectiveDBRefResolver.java", "org.springframework.data.mongodb.core.convert.DefaultDbRefResolver.java"], "label": 1, "es_results": []}, {"bug_id": 1229, "bug_title": "MongoQueryCreator incorrectly rejects ignoreCase on nested String path", "bug_description": "I have an embedded field foo.bar in my document class. I can use a repository to define findByFooBar(String bar), but findByFooBarIgnoreCase(String bar) throws an exception at query time:\n\n\n\n\n\n\njava.lang.IllegalArgumentException: part Doc.foo.bar must be of type String but was SIMPLE_PROPERTY (1): [Is, Equals]\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.7.0.RELEASE", "fixed_version": "1.6.3.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.MongoQueryCreator.java", "org.springframework.data.mongodb.repository.query.MongoQueryCreatorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1204, "bug_title": "ObjectPath equality check breaks due to changes MongoDB V3.", "bug_description": "The equality check for ObjectPathItem item id&apos;s in ObjectPath seems to break when used with MongoDB V3 due to contract changes of MongoDB&apos;s ObjectID. \nFrom the referenced commit in the mongo-java-driver:\nhttps://github.com/mongodb/mongo-java-driver/commit/aa4b4355c808e045ce00cc1dfbdd0bf78fb6901a\n(ObjectId.)equals method will no longer compare equal to anything but an ObjectId", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.7.0.RELEASE", "fixed_version": "1.8.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 1425, "bug_title": "NOT_CONTAINS keyword issues CONTAINS query.", "bug_description": "", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.6.4.RELEASE", "fixed_version": "1.9.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.AbstractPersonRepositoryIntegrationTests.java", "org.springframework.data.mongodb.repository.PersonRepository.java", "org.springframework.data.mongodb.repository.query.MongoQueryCreator.java", "org.springframework.data.mongodb.repository.query.MongoQueryCreatorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1257, "bug_title": "mongo:mongo-client namespace does not support usernames with a comma", "bug_description": "When using a mongo database with X-509 authentication, the username of the user is the subject DN from the X-509 certificate (see http://docs.mongodb.org/manual/tutorial/configure-x509-client-authentication/). The subject DN usually contains commas in it. This causes problems with trying to setup the mongo client using the mongo:mongo-client namespace with xml configuration since it expects credentials to be a comma separated list of usernames and splits on comma (,)\nAnother problem is that the credential is expected to be in username:password@database format, but when using X-509 authentication there is no password.\nA third issue that I noticed was that there seems to be a bug in \norg.springframework.data.mongodb.config.MongoCredentialPropertyEditor since when it checks for the presence of : and @ in the property, it does so on the original property, not the split string, which can cause NPEs if the colon or @ exists in the property but not on each split.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.7.1.RELEASE", "fixed_version": "1.7.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.config.MongoCredentialPropertyEditor.java", "org.springframework.data.mongodb.config.MongoCredentialPropertyEditorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1269, "bug_title": "QueryMapper drops numeric keys in Maps.", "bug_description": "As of 1.7.1 numeric keys get dropped in query mapping.\n\n\n\n\n\n\n@Test\n\n\n\n\npublic void SO_31799474() {\n\n\n\n\n\n\n\n\n\n\tSomeContent content = new SomeContent();\n\n\n\n\n\tcontent.text = \"foo\";\n\n\n\n\n\n\n\n\n\n\tSO31799474 entity = new SO31799474();\n\n\n\n\n\tentity.id = \"id-1\";\n\n\n\n\n\n\n\n\n\n\tentity.map = Collections.singletonMap(Integer.valueOf(1), content);\n\n\n\n\n\n\n\n\n\n\ttemplate.save(entity);\n\n\n\n\n\n\n\n\n\n\tassertThat(template.findOne(query(where(\"map.1.text\").is(\"foo\")), SO31799474.class), notNullValue());\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nstatic class SO31799474 {\n\n\n\n\n\tString id;\n\n\n\n\n\tMap<Integer, SomeContent> map;\n\n\n\n\n\n\n\n\n\n\t@Override\n\n\n\n\n\tpublic String toString() {\n\n\n\n\n\t\treturn \"SO31799474 [id=\" + id + \", map=\" + map + \"]\";\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.7.1.RELEASE", "fixed_version": "1.8.0.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapper.java", "org.springframework.data.mongodb.core.convert.UpdateMapper.java", "org.springframework.data.mongodb.core.convert.QueryMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1244, "bug_title": "StringBasedMongoQuery handles complex expression parameters incorrectly.", "bug_description": "Currently the regex based expression parameter scanning is too weak to handle nested object expressions like:\n\n\n\n\n\n\n{&apos;id&apos;:?#{ [0] ? { $exists :true} : [1] }}\n\n\n\n\n\n\nwhich currently yields the invalid mongo query:\n\n\n\n\n\n\n{&apos;id&apos;:?expr0 : [1] }}\n\n\n\n\n\n\ninstead of:\n\n\n\n\n\n\n{&apos;id&apos;:&apos;?expr0&apos;}\n\n\n\n\n\n\nFurther more, if complex parameter objects are passed as expressions \nthey get unnecessarily quoted which could yield wrong results.\nE.g:\n\n\n\n\n\n\n@{&apos;id&apos;:?#{ [0] ? { $exists :true} : [1] }, &apos;foo&apos;:42, &apos;bar&apos;: ?#{ [0] ? { $exists :false} : [1] }}\n\n\n\n\n\n\nCurrently results in:\n\n\n\n\n\n\n@{&apos;id&apos;:\"{ \\\"$exists\\\" :true}\", &apos;foo&apos;:42, &apos;bar&apos;: &apos;foo&apos; }}\n\n\n\n\n\n\nwhen finally rendered.\nThis prevents the effective use of SpEL based parameter expressions\nto be used for dynamic filtering with Spring Security as it is currently possible\nwith Spring Data JPA.\nWith this fixed one could easily perform filtering based on Spring Security context information in Spring Data MongoDB Repositories:\n\n\n\n\n\n\npublic interface PersonRepository extends CrudRepository<Person, String> {\n\n\n\n\n\n\n\n\n\n\t@Query(\"{id: ?#{ hasRole(&apos;ROLE_ADMIN&apos;) ? {$exists:true} : principal.id}}\")\n\n\n\n\n\tList<Person> findAllForCurrentUserById();\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.8.0.M1", "fixed_version": "1.8.0.RC1", "fixed_files": ["org.springframework.data.mongodb.repository.query.StringBasedMongoQueryUnitTests.java", "org.springframework.data.mongodb.repository.query.StringBasedMongoQuery.java"], "label": 1, "es_results": []}, {"bug_id": 1335, "bug_title": "DBObjectAccessor does not write properties correctly if multiple ones are nested", "bug_description": "When DBObjectAccessor is building the BasicDBObject it could check if the current dbObject already holds a BasicDBObject for the given key\nAnd thus documents like the one below will be inserted correctly (now only \"id\" and \"desc\"  are inserted)\n\n\n\n\n\n\n    public class One {\n\n\n\n\n      @Id String id;\n\n\n\n\n      @Field(\"DATA.TITLE\") String title;\n\n\n\n\n      @Field(\"DATA.DESC\") String desc;\n\n\n\n\n     ....\n\n\n\n\n    }\n\n\n\n\n\n\nI have provided a sample projecte with a few tests in order to verify the behaviour before and after the proposed change.\nI am aware that field names cannot contain the dot (.) character (https://docs.mongodb.org/manual/core/document/#field-names), and that data structures like the one before should be mapped with a Map BUT now the read process can cope with this kind of data structures so I am wondering if we can improve the write process to cover this case.  JUST AN IDEA", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.7.2.RELEASE", "fixed_version": "1.8.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.DBObjectAccessor.java", "org.springframework.data.mongodb.core.convert.DBObjectAccessorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1342, "bug_title": "Potential NullPointerException in MongoQueryCreator.nextAsArray()", "bug_description": "A null value is handed to a contains-clause of a repository query method will cause a NullPointerException rather than being treated like a single element object array.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.7.2.RELEASE", "fixed_version": "1.8.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.query.MongoQueryCreator.java", "org.springframework.data.mongodb.repository.query.MongoQueryCreatorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1406, "bug_title": "Query mapper does not use @Field field name when querying nested fields in combination with nested keywords", "bug_description": "we have a document class;\n\n\n\n\n\n\n@Document(collection = \"Computer\")\n\n\n\n\npublic class Computer\n\n\n\n\n{\n\n\n\n\n   @Id\n\n\n\n\n   private String _id;\n\n\n\n\n\n\n\n\n\n   private String batchId;\n\n\n\n\n\n\n\n\n\n  @Field(\"stat\")\n\n\n\n\n   private String status;\n\n\n\n\n\n\n\n\n\n   @Field(\"disp\")\n\n\n\n\n   private List<Monitor> displays;\n\n\n\n\n\n\n\n\n\n   //setters and getters\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\npublic class Monitor {\n\n\n\n\n   @Field(\"res\")\n\n\n\n\n   private String resolution;\n\n\n\n\n\n\n\n\n\n  // setters/getters\n\n\n\n\n}\n\n\n\n\n\n\nIn MongoTemplate.java, the call to :\n\n\n\n\n\n\nprotected <S, T> List<T> doFind(String collectionName, DBObject query, DBObject fields, Class<S> entityClass,\n\n\n\n\n\t\t\tCursorPreparer preparer, DbObjectCallback<T> objectCallback)\n\n\n\n\n\n\n\n\n\nDBObject mappedQuery = queryMapper.getMappedObject(query, entity);\n\n\n\n\n\n\nresolves the fields to the input query to the ones in the @Field annotations, except for these in embedded arrays. So, in the example above, resolution fields in DBObject remains resolution. While, the status field resolves to stat. \nNote the queries in the inner list, are setup as elemMatch.\nThe query submitted to mongo after getMappedObject is called:\n\n\n\n\n\n\n{ \"$and\" : [ { \"stat\" : \"A\"} , { \"disp\" : { \"$elemMatch\" : { \"$and\" : [ { \"resolution\" : { \"$ne\" :  null }} , { \"resolution\" : { \"$ne\" : \"\"}}]}}}] , \"batchId\" : \"5d0f1c53-92a2-48cb-8c84-1061769962c1\"}\n\n\n\n\n\n\nWhich doesn&apos;t get any data, because there is no field called resolution (the field in mongo is res). \nNote: The query input to getMappedObject is:\n\n\n\n\n\n\n{ \"$and\" : [ { \"status\" : \"A\"} , { \"displays\" : { \"$elemMatch\" : { \"$and\" : [ { \"resolution\" : { \"$ne\" :  null }} , { \"resolution\" : { \"$ne\" : \"\"}}]}}}] , \"batchId\" : \"5d0f1c53-92a2-48cb-8c84-1061769962c1\"}\n\n\n\n\n\n\nNotice the status and displays fields correctly get converted to the value in the @Field annotation. \nThe correct query from getMappedObject should be:\n\n\n\n\n\n\n{ \"$and\" : [ { \"stat\" : \"A\"} , { \"disp\" : { \"$elemMatch\" : { \"$and\" : [ { \"res\" : { \"$ne\" :  null }} , { \"res\" : { \"$ne\" : \"\"}}]}}}] , \"batchId\" : \"5d0f1c53-92a2-48cb-8c84-1061769962c1\"}\n\n\n\n\n\n\nThis basically means that any queries that operate on fields (with a name different from the peristed name) in the inner list will fail. \n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.7.2.RELEASE", "fixed_version": "1.8.5.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.QueryMapper.java", "org.springframework.data.mongodb.core.convert.QueryMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1334, "bug_title": "MapResultOptions limit not implemented", "bug_description": "As I can see in the code and with the behavior I&apos;m currently experiencing, it seems that limit on MapReduceOptions is not working.\nIn the source code, there&apos;s no attribute set with the provided param, the limit(int limit) method only return the current instance.\n\n\n\n\n\n\npublic MapReduceOptions limit(int limit) {\n\n\n\n\n    return this;\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.8.1.RELEASE", "fixed_version": "1.8.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.mapreduce.MapReduceOptions.java", "org.springframework.data.mongodb.core.MongoTemplateUnitTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java", "org.springframework.data.mongodb.core.mapreduce.MapReduceOptionsTests.java"], "label": 1, "es_results": []}, {"bug_id": 1394, "bug_title": "References not handled correctly when using QueryDSL", "bug_description": "Trying to use eq on reference&apos;s $id, with no luck. \nThis is an example code:\n\n\n\n\n\n\nBook.java\n\n\n\n\n\n\npublic class Book {\n\n\n\n\n     @DBRef\n\n\n\n\n     private Library library;\n\n\n\n\n} \n\n\n\n\n\n\n\n\n\n\n\n\nLibrary.java\n\n\n\n\n\n\npublic class Library {\n\n\n\n\n     @Id\n\n\n\n\n     private String id;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\nBookService.java\n\n\n\n\n\n\nString library_id = [SOME_ID];\n\n\n\n\nQBook book = QBook.book;\n\n\n\n\nBooleanExpression exp = book.library.id.eq(library_id);\n\n\n\n\n    \n\n\n\n\nList<Book> list = bookRepository.findAll(exp);  // EMPTY\n\n\n\n\n\n\nDoing:\n\n\n\n\n\n\nBookService.java\n\n\n\n\n\n\nLibrary library = libraryRepository.findById(library_id);\n\n\n\n\nQBook book = QBook.book;\n\n\n\n\nBooleanExpression exp = book.library.eq(library);\n\n\n\n\n\n\n\n\n\nList<Book> list = bookRepository.findAll(exp);  // EXPECTED ITEMS\n\n\n\n\n\n\nor:\n\n\n\n\n\n\nBookService.java\n\n\n\n\n\n\nList<Book> list = bookRepository.findByLibraryId(library_id) // EXPECTED ITEMS\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.8.1.RELEASE", "fixed_version": "1.10.0.M1", "fixed_files": ["org.springframework.data.mongodb.repository.support.SpringDataMongodbSerializer.java", "org.springframework.data.mongodb.repository.support.QuerydslRepositorySupportTests.java"], "label": 1, "es_results": []}, {"bug_id": 1387, "bug_title": "BasicQuery.fields().include() does not stick, even though Query.fields().include() does", "bug_description": "I am attempting to use BasicQuery with a defined list of fields. It appears that the fields list is being ignored. \n\n\n\n\n\n\nString queryString = ... // json-formatted string\n\n\n\n\nQuery query = new BasicQuery(queryString);\n\n\n\n\nquery.fields().include(\"myField\");\n\n\n\n\nfinal List<MyObject> results = mongoOps.find(query, MyObject.class);\n\n\n\n\n// MyObject includes all fields, not just myField\n\n\n\n\n\n\nI was digging through the source and it looks like org.springframework.data.mongodb.core.query.Query and org.springframework.data.mongodb.core.query.BasicQuery do things a little differently. Query defines fields() and BasicQuery does not, but getFieldsObject is different in the two implementations. \n\n\n\n\n\n\nQuery.getFieldsObject\n\n\n\n\n\n\n\tpublic DBObject getFieldsObject() {\n\n\n\n\n\t\treturn this.fieldSpec == null ? null : fieldSpec.getFieldsObject();\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\nBasicQuery.getFieldsObject\n\n\n\n\n\n\n\tpublic DBObject getFieldsObject() {\n\n\n\n\n\t\treturn fieldsObject;\n\n\n\n\n\t}\n\n\n\n\n\n\nIt looks like when I use BasicQuery.fields() it does successfully create a fieldspec in the object. But later, when I pass that BasicQuery object into MongoOps, it calls query.getFieldsObject() and it&apos;s null, because I never set an explicit fieldsObject. \nAm I using BasicQuery incorrectly? I am not clear why BasicQuery needs to override getFieldsObject as the behavior in the parent class seems to be the one that you&apos;d want.\nThanks!", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.8.2.RELEASE", "fixed_version": "1.9.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.query.BasicQuery.java", "org.springframework.data.mongodb.core.query.BasicQueryUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1397, "bug_title": "MongoTemplate.geoNear() do not log the Query", "bug_description": "MongoTemplate.geoNear() do not log the queries using class LOGGER instance...", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.8.4.RELEASE", "fixed_version": "1.9.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 1423, "bug_title": "Nested document update does not apply converters on embedded maps", "bug_description": "When trying to perform a direct update a nested document which is a map by\n\n\n\n\n\n\n $set : {&apos;metadata.thumbnails&apos; : Map<Enum, String>}\n\n\n\n\n\n\nthe the map keys are not converted\nMeanwhile, updating the core level object works properly \n\n\n\n\n\n\n$set : {a: metadata}\n\n\n\n\n\n\nFor example: \nEntity class\n\n\n\n\n\n\npublic class Video {\n\n\n\n\n    ....\n\n\n\n\n    private VideoMetadata metadata;\n\n\n\n\n    ....\n\n\n\n\n}\n\n\n\n\n\n\nNested object\n\n\n\n\n\n\npublic class VideoMetadata {\n\n\n\n\n    ....\n\n\n\n\n \tprivate Map<ThumbnailType, String> thumbnails;\n\n\n\n\n    ....\n\n\n\n\n}\n\n\n\n\n\n\nEnum\n\n\n\n\n\n\npublic enum ThumbnailType {\n\n\n\n\n\tDEFAULT,  MEDIUM, HIGH, STANDARD, MAXRES\n\n\n\n\n}\n\n\n\n\n\n\nInvoked Dao method to update thumbnails\n\n\n\n\n\n\nQuery query = Query.query(Criteria.where(\"_id\").is(id);\n\n\n\n\nUpdate update = new Update()\n\n\n\n\n\t.set(\"metadata.thumbnails\", metadata.getThumbnails());\n\n\n\n\n\t.set(\"metadata2\", metadata);\n\n\n\n\n}\n\n\n\n\nmongoOps.updateFirst(query, update, Video.class);\n\n\n\n\n\n\nJust after performing the update my objects looks like \n\n\n\n\n\n\n{ \n\n\n\n\n    \"_id\" : ... ,\n\n\n\n\n    \"_class\" :  ... ,\n\n\n\n\n    ......\n\n\n\n\n    \"metadata\" : {\n\n\n\n\n        \"thumbnails\" : {\n\n\n\n\n            \"MEDIUM\" : \"a\", \n\n\n\n\n            \"DEFAULT\" : \"b\", \n\n\n\n\n            \"STANDARD\" : \"c\"\n\n\n\n\n        }, \n\n\n\n\n    \"metadata2\" : {\n\n\n\n\n        \"thumbnails\" : {\n\n\n\n\n            \"medium\" : \"a\", \n\n\n\n\n            \"default\" : \"b\", \n\n\n\n\n            \"standard\" : \"c\"\n\n\n\n\n        }\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nThe only workaround I can find is to call converter manually : \n\n\n\n\n\n\n\tDBObject dbObject = new BasicDBObject();\n\n\n\n\n\tmongoOps.getConverter().write(metadata.getThumbnails(), dbObject);\n\n\n\n\n\tdbObject.removeField(\"_class\");\n\n\n\n\n\tupdate.set(\"metadata.thumbnails\", dbObject);\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.8.4.RELEASE", "fixed_version": "1.9.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverter.java", "org.springframework.data.mongodb.core.convert.UpdateMapperUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1453, "bug_title": "Parse error into GeoJsonPoint if coordinates are \"integers\"", "bug_description": "When mapping a document containing a GeoJSON location into a GeoJsonPoint object, if the location coordinates are \"round\" numbers (e.g. [0,0]) I get a ClassCastException: \n\n\n\n\n\n\nFailed to convert from type \\[com.mongodb.BasicDBObject\\] to type \\[org.springframework.data.mongodb.core.geo.GeoJsonPoint\\] for value &apos;\\{ \"type\" : \"Point\" , \"coordinates\" : [ 0 , 0]\\}&apos;; nested exception is java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.Double\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.8.4.RELEASE", "fixed_version": "1.10.0.M1", "fixed_files": ["org.springframework.data.mongodb.core.geo.GeoJsonTests.java", "org.springframework.data.mongodb.core.convert.GeoConverters.java"], "label": 1, "es_results": []}, {"bug_id": 1485, "bug_title": "Querydsl MongodbSerializer does not take registered converters for Enums into account", "bug_description": "MongodbSerializer#visit(Constant<?> expr, Void context)\nshould check for custom conversions availability to enable typesafe querydsl expressions containing enums. Currently it performs the following:\n\n\n\n\n\n\nif (Enum.class.isAssignableFrom(expr.getType())) {\n\n\n\n\n            @SuppressWarnings(\"unchecked\") //Guarded by previous check\n\n\n\n\n            Constant<? extends Enum<?>> expectedExpr = (Constant<? extends Enum<?>>) expr;\n\n\n\n\n            return expectedExpr.getConstant().name();\n\n\n\n\n        } else {\n\n\n\n\n            return expr.getConstant();\n\n\n\n\n        }\n\n\n\n\n\n\nAssuming the following model:\n\n\n\n\n\n\nclass Connection {\n\n\n\n\n  private String id;\n\n\n\n\n  private ConnectionType type;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nenum ConnectionType {\n\n\n\n\n        A(0),\n\n\n\n\n\tB(1),\n\n\n\n\n\tC(2);\n\n\n\n\n\n\n\n\n\n\tprivate final int value;\n\n\n\n\n\n\n\n\n\n        ConnectionType(int value){\n\n\n\n\n\t\tthis.value = value;\n\n\n\n\n\t}\n\n\n\n\n}\n\n\n\n\n\n\nand registered conversions: \n\n\n\n\n\n\n@ReadingConverter\n\n\n\n\n@Component\n\n\n\n\npublic class ConnectionTypeReadConverter implements Converter<Integer, ConnectionType> {\n\n\n\n\n    @Override\n\n\n\n\n    public ConnectionType convert(Integer source) {\n\n\n\n\n        return source == null ? null : ConnectionType.getConnectionType((Integer)source);\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n@WritingConverter\n\n\n\n\n@Component\n\n\n\n\npublic class ConnectionTypeWriteConverter implements Converter<ConnectionType, Integer> {\n\n\n\n\n    @Override\n\n\n\n\n    public Integer convert(ConnectionType source) {\n\n\n\n\n        return source == null ? null : source.getValue();\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nthen the following query generates the enum name (A) instead of value(0) as condition:\n\n\n\n\n\n\nConnectionType type = ConnectionType.A;\n\n\n\n\nQConnection qConnection = QConnection.connection;\n\n\n\n\nPredicate predicate = qConnection.type.eq(type);\n\n\n\n\n\n\n\n\n\nconnectionRepository.findOne(predicate);}}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.8.4.RELEASE", "fixed_version": "1.8.5.RELEASE", "fixed_files": ["org.springframework.data.mongodb.repository.support.SpringDataMongodbSerializer.java", "org.springframework.data.mongodb.repository.support.SpringDataMongodbSerializerUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 1497, "bug_title": "MappingMongoConverter's check for whether a value is available for a property should use DbObjectAccessor", "bug_description": "MappingMongoConverter&apos;s read method when dealing with remaining properties and associations not already set in the constructor should use a DBObjectAccessor instead of accessing the DBObject directly.\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.8.5.RELEASE", "fixed_version": "1.9.4.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MappingMongoConverterUnitTests.java", "org.springframework.data.mongodb.core.convert.MappingMongoConverter.java"], "label": 1, "es_results": []}, {"bug_id": 1513, "bug_title": "Non-ObjectId identifiers generated by event listeners are not populated if documents are inserted as batch", "bug_description": "We have observed issues when persisting multiple entities at a time. The id does not get populated. It&apos;s caused by insertDBObjectList() handling ids different compared to insertDBObject(). In our use case we define our own ids when persisting to Mongo. They are Strings. We use a MongoEventListener to set the id like this:\n\n\n\n\n\n\npublic void onBeforeSave(BaseEntity p, DBObject dbo) {\n\n\n\n\n        if (p.isNew()) {\n\n\n\n\n            String id = ....;\n\n\n\n\n            dbo.put(\"_id\", id);\n\n\n\n\n        }\n\n\n\n\n    }\n\n\n\n\n\n\nThis works fine when we persist only one instance at a time because the insertDBObject() does not care about the type of the id, but insertDBObjectList() does. It goes like this:\n\n\n\n\n\n\nif (id instanceof ObjectId) {\n\n\n\n\n    ids.add((ObjectId) id);\n\n\n\n\n} else {\n\n\n\n\n    // no id was generated\n\n\n\n\n    ids.add(null);\n\n\n\n\n}\n\n\n\n\n\n\nResult is that we do no get the id populated in the entities we persist.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.8.6.RELEASE", "fixed_version": "1.10.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplateTests.java", "org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 1416, "bug_title": "Standard bootstrap issues warning in converter registration", "bug_description": "I just upgraded to 1.9.1 from 1.8.4 and keep getting these warnings. \n\n\n\n\n\n\norg.springframework.data.mongodb.core.convert.CustomConversions:229 - Registering converter from class java.lang.Number to class java.lang.Number as writing converter although it doesn&apos;t convert to a Mongo supported type! You might want to check you annotation setup at the converter implementation\n\n\n\n\n\n\n I have NO custom converters configured.  Not sure where this is coming from or how to fix.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.9.1.RELEASE", "fixed_version": "1.9.2.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.convert.MongoConvertersUnitTests.java", "org.springframework.data.mongodb.core.convert.MongoConverters.java"], "label": 1, "es_results": []}, {"bug_id": 1465, "bug_title": "String arguments passed to DefaultScriptOperations.execute() appear quoted in script", "bug_description": "DefaultScriptOperations.execute() calls convertScriptArgs() to convert the script&apos;s arguments. For Strings it performs a local single-quoting.\nThis is necessary for DefaultScriptOperations.call() arguments (as the function call is constructed as a string) but not for execute() (as the arguments will be transfered in a DBObject.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.9.2.RELEASE", "fixed_version": "1.8.5.RELEASE", "fixed_files": ["org.springframework.data.mongodb.core.DefaultScriptOperations.java", "org.springframework.data.mongodb.core.DefaultScriptOperationsTests.java"], "label": 1, "es_results": []}, {"bug_id": 1498, "bug_title": "MongoMappingContext does not know about types usually auto-detected (JodaTime, JDK 8 date time types)", "bug_description": "(not sure if this issue should be opened for Spring Data REST or Spring Data Mongo, since the problem manifests itself in the contents rendered by SDR but the fix might probably go to the SD MongoDB)\nAs described in this SO thread, in Spring Boot 1.3.6, Spring Data 1.8.4, Spring Data REST 2.4.4 the Spring Data MongoDB entities that have a property of Joda DateTime type:\n\n\n\n\n\n\n    @JsonProperty(\"myDate\")\n\n\n\n\n    private DateTime myDate;\n\n\n\n\n\n\ngets rendered into in the REST representation of my Spring Data entity as \n\n\n\n\n\n\n    \"myDate\": \"2016-09-25T15:58:37.486Z\"\n\n\n\n\n\n\nWith Spring Boot 1.4.1, Spring Data MongoDB 1.9.3, Spring Data REST 2.5.3 same properties suddenly get represented as  \n\n\n\n\n\n\n    \"myDate\": {\n\n\n\n\n        \"content\": \"2016-09-25T15:58:37.486Z\"\n\n\n\n\n    },\n\n\n\n\n\n\nIt looks like Joda&apos;s DateTime started to get treated as data entity again:\nhttps://jira.spring.io/browse/DATAMONGO-624\nAdding Jackson2 @JsonUnwrapped annotation to the property helps to get representation back:\n\n\n\n\n\n\n    @JsonProperty(\"myDate\")\n\n\n\n\n    @JsonUnwrapped\n\n\n\n\n    private DateTime myDate;\n\n\n\n\n\n\nBut this cannot be a solution since in case of auto-generated properties, e.g. from JSON schema. there is only limited options to control generated annotations, especially since the @JsonUnwrapped must be set on all child/empbedded objects.\nThe Javadoc for the CustomConversions class states that \n\nThese types will be considered simple ones (which means they neither\nneed deeper inspection nor nested conversion. Thus the\nCustomConversions also act as factory for SimpleTypeHolder\nWhich is in fact not true for Spring Data REST [any more], from what I can tell debugging my code.\nThe types that are added via default CustomConversions are not treated as simple ones when rendering JSON and properties of those types get serialised as embedded entity objects.\nHere is the place in the Spring Data REST PersistentEntityJackson2Module that calls to Spring Data MongoDB PersistentEntity implementation to check whether the property type is simple or not. And since the simpleTypeHolder in the Spring Data Commons AbstractMappingContext does not contain the types for which Spring Boot auto-configuration adds Joda DateTime converters, the DateTime field is treated as complex object.\nThis one presents a major problem upgrading from Spring Boot 1.3 to 1.4, since it breaks REST APIs by default with no generic solution known so far for all Joda DateTime properties in the project.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.9.3.RELEASE", "fixed_version": "1.10.0.RC1", "fixed_files": ["org.springframework.data.mongodb.config.MongoAuditingRegistrar.java", "org.springframework.data.mongodb.config.AuditingViaJavaConfigRepositoriesTests.java", "org.springframework.data.mongodb.repository.config.MongoRepositoryConfigurationExtension.java"], "label": 1, "es_results": []}, {"bug_id": 1521, "bug_title": "Aggregation.skip(...) expects int but new SkipOperation(...) supports long", "bug_description": "Currently the class SkipOperation takes an long as only parameter, the static factory method Aggregation.skip() takes an int. As the skip-operation seems to support long, should the static factory-method also use long?\n\n\n\n\n\n\npublic static SkipOperation skip(int elementsToSkip) {\n\n\n\n\n\t\treturn new SkipOperation(elementsToSkip);\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\npublic SkipOperation(long skipCount) {\n\n\n\n\n\t\tAssert.isTrue(skipCount >= 0, \"Skip count must not be negative!\");\n\n\n\n\n\t\tthis.skipCount = skipCount;\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.9.4.RELEASE", "fixed_version": "1.10.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.aggregation.Aggregation.java", "org.springframework.data.mongodb.core.aggregation.AggregationTests.java", "org.springframework.data.mongodb.core.aggregation.SkipOperation.java"], "label": 1, "es_results": []}, {"bug_id": 1534, "bug_title": "Type hint is missing when using BulkOperations.insert", "bug_description": "when inserting a list of documents\n\n\n\n\n\n\nmongoTemplate.bulkOps(BulkOperations.BulkMode.UNORDERED, FOO.class, collectionName)\n\n\n\n\n  .insert(foos);\n\n\n\n\n\n\nthe type info written in _class element is missing.\nas a result, the class cannot be read back.\nThis make bulkOps insert method unusable.", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.9.4.RELEASE", "fixed_version": "1.10.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.DefaultBulkOperationsIntegrationTests.java", "org.springframework.data.mongodb.core.DefaultBulkOperations.java"], "label": 1, "es_results": []}, {"bug_id": 1565, "bug_title": "Placeholders in manually defined queries not escaped properly", "bug_description": "\n\n\n\n\n\ncollection.findByApplicationIdAndName(\"fff?1fff\", \"This is outside of quotations\");\n\n\n\n\n\n\n\n\n\ninterface MyCollection  extends MongoRepository<MyObject, String> {\n\n\n\n\n     @Query(value=\"{ &apos;applicationId&apos; : ?0, &apos;name&apos; :?1}\");\n\n\n\n\n     List<MyObject> findByApplicationIdAndName(String id, String name);\n\n\n\n\n}\n\n\n\n\n\n\nResulting query:\n\n\n\n\n\n\n{&apos;applicationId&apos;: \"fff\"This is outside of quotations\"fff\", &apos;name&apos;:?1}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.9.5.RELEASE", "fixed_version": "1.10.0.RC1", "fixed_files": ["org.springframework.data.mongodb.repository.query.StringBasedMongoQueryUnitTests.java", "org.springframework.data.mongodb.repository.query.ExpressionEvaluatingParameterBinder.java"], "label": 1, "es_results": []}, {"bug_id": 1476, "bug_title": "New stream method only partially makes use of collection name", "bug_description": "The new stream Method allowing to specify the collection name, should also make use of the collection name on read callback time. ", "project": "Spring", "sub_project": "DATAMONGO", "version": "1.10.0.M1", "fixed_version": "1.10.0.RC1", "fixed_files": ["org.springframework.data.mongodb.core.MongoTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 75, "bug_title": "<redis:collection/> breaks for type=\"PROPERTIES\" because defaults are not initialized", "bug_description": "<redis:collection/> breaks for type=\"PROPERTIES\" because defaults are not initialized.  The \"defaults\" field is protected i nthe super class (java.util.Properties) but not initialized by default, and it is referenced in the propertyNames() method (line 111) -> NullPointerException on startup.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.0.0.M4", "fixed_version": "v1.0.0.RC1", "fixed_files": ["org.springframework.data.redis.support.collections.RedisPropertiesTests.java", "org.springframework.data.redis.support.collections.RedisProperties.java"], "label": 1, "es_results": []}, {"bug_id": 78, "bug_title": "RedisCacheManager throw UnsupportedOperationException", "bug_description": "I am try to config a cache layer use the spring 3.1 cache abstraction and redis. when i config @Cacheable(\"relation\") in my code and run the unit test , it throw UnsupportedOperationException. i tracking the source code ,and found that there is something wrong in the RedisCacheManager.java file.\n\tprivate final Collection<String> names = Collections.unmodifiableSet(caches.keySet()); //this collection announce to be unmodifiable.\n\tprivate final RedisTemplate template;\n\tprivate boolean usePrefix;\n\tprivate RedisCachePrefix cachePrefix = new DefaultRedisCachePrefix();\n\tpublic RedisCacheManager(RedisTemplate template) \n{\n\t\tthis.template = template;\n\t}\n\n\tpublic Cache getCache(String name) {\n\t\tCache c = caches.get(name);\n\t\tif (c == null) \n{\n\t\t\tc = new RedisCache(name, (usePrefix ? cachePrefix.prefix(name) : null), template);\n\t\t\tcaches.put(name, c);\n\t\t\tnames.add(name);     // this collection is modified .\n\t\t}\n\n\t\treturn c;\n\t}", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.0.0.RC1", "fixed_version": "v1.0.0.RELEASE", "fixed_files": ["org.springframework.data.redis.cache.RedisCacheManager.java", "org.springframework.data.redis.cache.RedisCacheTest.java"], "label": 1, "es_results": []}, {"bug_id": 79, "bug_title": "In RedisTemplate class,expireAt has a bug", "bug_description": "In redis,ExpireAt takes an absolute UNIX timestamp as parameter. But in RedisTemplate source code,it uses date.getTime() function to get timestamp, getTime() returns the number of milliseconds since January 1, 1970.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.0.0.M4", "fixed_version": "v1.0.0.RELEASE", "fixed_files": ["org.springframework.data.redis.core.RedisTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 81, "bug_title": "Mixed lifecycle in RedisMessageListenerContainer", "bug_description": "RedisMessageListenerContainer should not be invoking its start() method from afterPropertiesSet(). I believe it should follow the lifecycle of the enclosing class. In other words if one should be able to delegate to RedisMessageListenerContainer.start() method when its own start method is invoked.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.0.0.RELEASE", "fixed_version": "v1.0.1.RELEASE", "fixed_files": ["org.springframework.data.redis.listener.RedisMessageListenerContainer.java", "org.springframework.data.redis.listener.PubSubTests.java"], "label": 1, "es_results": []}, {"bug_id": 82, "bug_title": "JedisUtils should not wrap unknow Exception", "bug_description": "The project I&apos;m working on has 2 data access configuration, one with Spring-data-jpa, and an other with Spring-data-redis. \nSince I added the JedisConnectionFactory as a Spring bean, one of my JPA-based junit failed because it attempts to catch a DataIntegrityViolationException. But instead this exception is wrapped into a JedisSystemException (see JedisUtils.convertJedisAccessException()).\nWhen I read the code in ChainedPersistenceExceptionTranslator, I understand that a PersistenceExceptionTranslator that doesn&apos;t handle an exception should return null. So I think JedisUtils.convertJedisAccessException() should return null also in case of unhandled exception.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.0.0.RELEASE", "fixed_version": "v1.0.1.RELEASE", "fixed_files": ["org.springframework.data.redis.connection.jedis.JedisUtils.java"], "label": 1, "es_results": []}, {"bug_id": 246, "bug_title": "RedisCacheManagers getCache method does not match the logical of CompositeCacheManager", "bug_description": "RedisCacheManager&apos;s getCache(name) always return RedisCache, that doesn&apos;t match the CompositeCacheManager&apos;s getCache(name) logic, so hardly combined with each other.\nMaybe RedisCacheManager should provide allowed cache names, and getCache(name) should return null if absent.\nThanks.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.1.0.RELEASE", "fixed_version": "v1.2.0.RC1", "fixed_files": ["org.springframework.data.redis.cache.RedisCacheManager.java"], "label": 1, "es_results": []}, {"bug_id": 283, "bug_title": "RedisCacheManager.loadCaches overrides already defined cache names in afterPropertiesSet().", "bug_description": "Already defined cache names should not be cleared when loading remote caches.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.2.0.RELEASE", "fixed_version": "v1.2.1.RELEASE", "fixed_files": ["org.springframework.data.redis.cache.RedisCacheManager.java", "org.springframework.data.redis.cache.RedisCacheManagerUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 285, "bug_title": "LettuceTemplate.execute should read and convert entire response.", "bug_description": "LettuceConnection uses ByteArrayOutput as result definition which does not apply for multi bulk reply. For those cases ValueListOutput has to be used.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.2.0.RELEASE", "fixed_version": "v1.2.1.RELEASE", "fixed_files": ["org.springframework.data.redis.connection.lettuce.LettuceConnection.java", "org.springframework.data.redis.connection.lettuce.LettuceConnectionIntegrationTests.java", "org.springframework.data.redis.connection.jredis.JRedisConnectionIntegrationTests.java", "org.springframework.data.redis.connection.jedis.JedisConnectionIntegrationTests.java", "org.springframework.data.redis.connection.srp.SrpConnectionIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 300, "bug_title": "RedisConnectionUtils: inconsistency with connection open() and close()", "bug_description": "All Redis operations are handled within RedisTemplate#execute\nIt does\n\n\n\n\n\n\nconn = RedisConnectionUtils.bindConnection(factory, enableTransactionSupport);\n\n\n\n\n\n\nbefore operation and\n\n\n\n\n\n\n} finally {\n\n\n\n\n            RedisConnectionUtils.releaseConnection(conn, factory);\n\n\n\n\n}\n\n\n\n\n\n\nafter.\nIn our case it is JedisConnectionFactory with default settings. The most interesting thing is usePool = true\nSuppose that means we can&apos;t use more connections, than Pool allows.\nWell.\nRedisConnectionUtils#doGetConnection populates  RedisConnectionHolder with RedisConnection from pool to the TransactionSynchronizationManager.bindResource\nbecause:\n\n\n\n\n\n\npublic static RedisConnection bindConnection(RedisConnectionFactory factory, boolean enableTranactionSupport) {\n\n\n\n\n        return doGetConnection(factory, true, true, enableTranactionSupport);\n\n\n\n\n}\n\n\n\n\n\n\nand bind = true.\nBut RedisConnectionUtils#releaseConnection does a check\n\n\n\n\n\n\n// Only release non-transactional/non-bound connections.\n\n\n\n\n        if (!isConnectionTransactional(conn, factory)) {\n\n\n\n\n\n\nwhich returns true and I never see\n\n\n\n\n\n\nlog.debug(\"Closing Redis Connection\");\n\n\n\n\n\n\nAnd it causes ConnectionPool leak.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.3.0.RC1", "fixed_version": "v1.3.0.RELEASE", "fixed_files": ["org.springframework.data.redis.core.RedisConnectionUtils.java", "org.springframework.data.redis.core.RedisTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 317, "bug_title": "Cannot increment RedisAtomicInteger", "bug_description": "I am trying to increment a RedisAtomicInteger object by a given delta:\n\n\n\n\n\n\n    private void updateBandwidthUsage(String remoteAddr, int length) {\n\n\n\n\n        RedisAtomicInteger counter = new RedisAtomicLong(\"someKey\", redisTemplate)\n\n\n\n\n        counter.getAndAdd(length);\n\n\n\n\n        counter.expire(1, TimeUnit.DAYS);\n\n\n\n\n    }\n\n\n\n\n\n\nThis fails with\n\n\n\n\n\n\n    redis.clients.jedis.exceptions.JedisDataException: ERR value is not an integer or out of range\n\n\n\n\n\n\nWhen I use the MONITOR command on the server, this is what I can see:\n\n\n\n\n\n\n    1403019417.097887 [0 10.0.2.2:46694] \"INCRBY\" \"\\xac\\xed\\x00\\x05t\\x00\\x150:0:0:0:0:0:0:1:16238\" \"7625\"\n\n\n\n\n\n\nI am using Spring Data Redis (1.3.0) with the Jedis (2.5.1) connector, the server is running Redis 2.8.6.\nIt seems that the underlying reason is that Spring Data Redis is not storing the value as an integer, but as a byte-dump of a Java Integer object, as can be observed on this log entry from a counter.set(1) call:\n\n\n\n\n\n\n    1403020463.368050 [0 10.0.2.2:47127] \"SET\" \"\\xac\\xed\\x00\\x05t\\x00\\x150:0:0:0:0:0:0:1:16238\" \"\\xac\\xed\\x00\\x05sr\\x00\\x11java.lang.Integer\\x12\\xe2\\xa0\\xa4\\xf7\\x81\\x878\\x02\\x00\\x01I\\x00\\x05valuexr\\x00\\x10java.lang.Number\\x86\\xac\\x95\\x1d\\x0b\\x94\\xe0\\x8b\\x02\\x00\\x00xp\\x00\\x00\\x00\\x00\"\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.3.0.RELEASE", "fixed_version": "v1.3.1.RELEASE", "fixed_files": ["org.springframework.data.redis.support.atomic.RedisAtomicIntegerTests.java", "org.springframework.data.redis.support.atomic.RedisAtomicInteger.java", "org.springframework.data.redis.support.atomic.RedisAtomicLongTests.java", "org.springframework.data.redis.support.atomic.RedisAtomicDoubleTests.java", "org.springframework.data.redis.support.atomic.RedisAtomicLong.java", "org.springframework.data.redis.support.atomic.RedisAtomicDouble.java"], "label": 1, "es_results": []}, {"bug_id": 310, "bug_title": "Lock of RedisCache is not safe", "bug_description": "RedisCache get lock only in clear() method.\nRedisCache checks clear()&apos;s lock in the other methods, but inconsistencies may occur due to race conditions.\nput() method is serious because there is a serialize process.\nFor example...\n1. Thread-A(put method) check lock.\n2. Thread-A start serialize value.\n3. Thread-B(clear method) check lock.\n4. Thread-B get lock.\n5. Thread-A put key and value.\n6. Thread-B start del keys.\n7. Thread-B del key from Thread-A\nI think it is better to get lock in all methods(get/put/evict).\nOr serialize value before call connection.multi(), and deserialize value after call connection.exec().", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.3.0.RELEASE", "fixed_version": "v1.3.1.RELEASE", "fixed_files": ["org.springframework.data.redis.cache.RedisCache.java"], "label": 1, "es_results": []}, {"bug_id": 333, "bug_title": "EvalSha returns incorrect result", "bug_description": "I use version 1.3.0 (not sure what is 1.3 GA (Dijkstra)).\nRedis (in case of evalsha) returns bytes as String.\nSpring Data Redis encodes them to bytes again (convert back for consistency) in JedisScriptReturnConverter.convert() method.\nSafeEncoder.encode() uses UTF-8 charset for encoding but this encoding is incorrect. Probably Redis use other charset. Please check.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.3.0.RELEASE", "fixed_version": "v1.4.0.RC1", "fixed_files": ["org.springframework.data.redis.connection.jedis.JedisConverters.java", "org.springframework.data.redis.connection.jedis.JedisConnection.java"], "label": 1, "es_results": []}, {"bug_id": 332, "bug_title": "@Transactional Using multiple connections", "bug_description": "When using a RedisTemplate with enableTransactionSupport set to true, it will open new connections for each redis operation.\nGiven this example:\n@Transactional\npublic void test() {\n\tlistOperations.rightPush(\"test\", \"a\");\n\tlistOperations.rightPush(\"test\", \"a\");\n}\nWhen monitoring everything that the server handles, you will see this output:\n1406625662.861592 [0 127.0.0.1:54842] \"MULTI\"\n1406625662.861592 [0 127.0.0.1:54842] \"RPUSH\" \"test\" \"\\\"a\\\"\"\n1406625662.861592 [0 127.0.0.1:54842] \"EXEC\"\n1406625663.220937 [0 127.0.0.1:54843] \"MULTI\"\n1406625663.220937 [0 127.0.0.1:54843] \"RPUSH\" \"test\" \"\\\"a\\\"\"\n1406625663.220937 [0 127.0.0.1:54843] \"EXEC\"\nWith debugging the spring-data-redis source code we found that in RedisTemplate.java line 201 (version 1.3.1-RELEASE) the if condition checks for \"enableTransactionSupport\". If that is true, the connection is unbound. This leads to the next redis operation not working on the same connection anymore. If the condition would be \"if (!enableTransactionSupport)\" then the output is as we expect it to be:\n1406626330.259418 [0 127.0.0.1:54894] \"MULTI\"\n1406626330.259418 [0 127.0.0.1:54894] \"RPUSH\" \"test\" \"\\\"a\\\"\"\n1406626330.259418 [0 127.0.0.1:54894] \"RPUSH\" \"test\" \"\\\"a\\\"\"\n1406626330.259418 [0 127.0.0.1:54894] \"EXEC\"\n", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.3.1.RELEASE", "fixed_version": "v1.6.0.M1", "fixed_files": ["org.springframework.data.redis.core.RedisConnectionUtils.java", "org.springframework.data.redis.core.RedisTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 337, "bug_title": "MessageListener method should only be invoked once per message", "bug_description": "The problem is in MessageListenerAdapter in approximately 113 line (version 1.3.2.RELEASE), where using reflection you are extracting methods to be invoked by listener.\nProblem appears, when Listener is subclass of another class with the same method definition (i.e class A has abstract method doSmth and class B extends A and implements doSmth method). \nThen, methods array is populated with wrong number of method which then are invoked on listener (one for each parent classes that have same method definition), which can lead to invoking same method on listener several times.\nYou can reproduce this bug with those steps:\n1. Create abstract class\n\n\n\n\n\n\nAbstractTest.java\n\n\n\n\n\n\npublic abstract class AbstractTest {\n\n\n\n\n   public abstract void foo(); \n\n\n\n\n} \n\n\n\n\n\n\n2. Create implementation to this class\n\n\n\n\n\n\nTest.java\n\n\n\n\n\n\npublic class Test extends AbstractTest {\n\n\n\n\n   @Override\n\n\n\n\n   public void foo() {\n\n\n\n\n      System.out.println(\"in foo\");\n\n\n\n\n   } \n\n\n\n\n} \n\n\n\n\n\n\n3. Define Test as spring bean and as message listener\n\n\n\n\n\n\n<bean id=\"test\" class=\"Test\"/>\n\n\n\n\n <redis:listener-container connection-factory=\"jedisConnectionFactory\">\n\n\n\n\n        <redis:listener ref=\"test\" method=\"foo\" topic=\"testTopic\"/>\n\n\n\n\n    </redis:listener-container>\n\n\n\n\n\n\nWhen message will come to topic &apos;testTopic&apos;, method foo will be invoked twice. ", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.3.2.RELEASE", "fixed_version": "v1.4.0.RC1", "fixed_files": ["org.springframework.data.redis.listener.adapter.MessageListenerAdapter.java", "org.springframework.data.redis.listener.adapter.MessageListenerTest.java"], "label": 1, "es_results": []}, {"bug_id": 347, "bug_title": "DefaultScriptExecutor always runs script twice if Exception is thrown", "bug_description": "The DefaultScriptExecutor seems to optimistically attempt to run the server-cached version of a script by passing the SHA1.  If any exception is thrown, it assumes that this is because the script does not exist on the server and attempts to send the script and run it.\nHere is the code in question:\n\n\n\n\n\n\nDefaultScriptExecutor.java\n\n\n\n\n\n\nprotected <T> T eval(RedisConnection connection, RedisScript<T> script, ReturnType returnType, int numKeys,\n\n\n\n\n\t\t\tbyte[][] keysAndArgs, RedisSerializer<T> resultSerializer) {\n\n\n\n\n\t\tObject result;\n\n\n\n\n\t\ttry {\n\n\n\n\n\t\t\tresult = connection.evalSha(script.getSha1(), returnType, numKeys, keysAndArgs);\n\n\n\n\n\t\t} catch (Exception e) {\n\n\n\n\n\t\t\tresult = connection.eval(scriptBytes(script), returnType, numKeys, keysAndArgs);\n\n\n\n\n\t\t}\n\n\n\n\n\t\tif (script.getResultType() == null) {\n\n\n\n\n\t\t\treturn null;\n\n\n\n\n\t\t}\n\n\n\n\n\t\treturn deserializeResult(resultSerializer, result);\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n\n\nThis means that ANY exception thrown by a script causes it to be run twice, and obviously any side affects of running the script (i.e. data insertions) which occur before the error are duplicated.\nI believe this is likely not the intended behaviour.  The DefaultScriptExecutor should verify the reason for the exception prior to re-attempting to run the script in every case.\nI have seen this behaviour in 1.3.4, 1.4.0 and as of writing, the source seems to be the same.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.3.4.RELEASE", "fixed_version": "v1.4.1.RELEASE", "fixed_files": ["org.springframework.data.redis.core.script.DefaultScriptExecutor.java", "org.springframework.data.redis.core.script.DefaultRedisScript.java"], "label": 1, "es_results": []}, {"bug_id": 375, "bug_title": "A transactional RedisCacheManager decorates the cache with the TransactionAwareCacheDecorator twice", "bug_description": "When the RedisCacheManager is configured the following way:\n\n\n\n\n\n\nRedisCacheManager cacheManager = new RedisCacheManager(redisTemplate());\n\n\n\n\ncacheManager.setTransactionAware(true);\n\n\n\n\ncacheManager.setCacheNames(Arrays.asList(cacheName));\n\n\n\n\n\n\nthen the created Cache instances are decorated twice with the TransactionAwareCacheDecorator.\nThe problem is that in the addConfiguredCachesIfNecessary method the not configured caches are retrieved with the getCache(cacheName) method which already returns a decorated cache. This cache is then used in the loadCaches() method of the AbstractCacheManager and there it will be decorated again with the TransactionAwareCacheDecorator.\nThe attached patch was created on the master branch and contains tests which show the issue and a quick fix is also implemented.\nShall I create a pull request for this?", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.3.5.RELEASE", "fixed_version": "v1.5.0.RC1", "fixed_files": ["org.springframework.data.redis.cache.RedisCacheManager.java"], "label": 1, "es_results": []}, {"bug_id": 354, "bug_title": "Jackson2JsonRedisSerializer should allow to customise the JavaType for deserialization via getJavaType()", "bug_description": "The Jackson2JsonRedisSerializer has an overridable `getJavaType(Class<?> class)` method, but it does not delegate to this method to determine the `javaType` used by the object mapper when deserializing.\nThe fix is simple. Instead of setting the private field `JavaType javaType` to the `Class<T> type` passed in from the constructor, it should be set to the type returned by `getJavaType(Class<?> class)`.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.4.1.RELEASE", "fixed_version": "v1.5.0.M1", "fixed_files": ["org.springframework.data.redis.serializer.JacksonJsonRedisSerializer.java", "org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer.java"], "label": 1, "es_results": []}, {"bug_id": 369, "bug_title": "RedisCache zset leak", "bug_description": "I&apos;m using the spring-data-redis caching abstraction support feature, and I&apos;ve run into a serious redis leak. \nRedisCache maintains a \"~keys\" ZSET in redis that collects the keys for a logical cache (i.e. person~keys for a cache named person). When using expirations, the actual key expires fine, and I see code setting a TTL on the ZSET at the same time as the TTL for the real key, but that TTL applies to the entire set. If you have constant cache puts for new items into the same cache, the ZSET never expires and just grows unbounded. In a production scenario with a cache that has a TTL of 5 minutes, I&apos;ve seen 2.9 million keys in the ZSET for the cache with hardly any of those keys actually still valid.", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.4.1.RELEASE", "fixed_version": "v1.5.0.RC1", "fixed_files": ["org.springframework.data.redis.cache.RedisCache.java"], "label": 1, "es_results": []}, {"bug_id": 417, "bug_title": "ScanCursor throw \" java.util.NoSuchElementException\"", "bug_description": "when scan big key with \"match\" options, redis server continuous return empty resultScanCursor throw \" java.util.NoSuchElementException\"", "project": "Spring", "sub_project": "DATAREDIS", "version": "v1.5.0.RELEASE", "fixed_version": "1.6.1.RELEASE", "fixed_files": ["org.springframework.data.redis.core.ScanCursor.java", "org.springframework.data.redis.connection.AbstractConnectionIntegrationTests.java", "org.springframework.data.redis.connection.AbstractConnectionTransactionIntegrationTests.java", "org.springframework.data.redis.connection.AbstractConnectionPipelineIntegrationTests.java", "org.springframework.data.redis.core.ScanCursorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 448, "bug_title": "DefaultSetOperations.intersectAndStore do not return operation result", "bug_description": "Method intersectAndStore in DefaultSetOperations don&apos;t return count the number of elements in the resulting set.\nhttp://redis.io/commands/sinterstore\n\n\n\n\n\n\npublic Long intersectAndStore(K key, Collection<K> otherKeys, K destKey) {\n\n\n\n\n  final byte[][] rawKeys = rawKeys(key, otherKeys);\n\n\n\n\n  final byte[] rawDestKey = rawKey(destKey);\n\n\n\n\n  return execute(new RedisCallback<Long>() {\n\n\n\n\n\n\n\n\n\n    public Long doInRedis(RedisConnection connection) {\n\n\n\n\n      connection.sInterStore(rawDestKey, rawKeys);\n\n\n\n\n      return null; // <<<<\n\n\n\n\n    }\n\n\n\n\n  }, true);\n\n\n\n\n}\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.4.4.RELEASE", "fixed_version": "1.6.2.RELEASE", "fixed_files": ["org.springframework.data.redis.core.DefaultSetOperations.java", "org.springframework.data.redis.core.DefaultSetOperationsTests.java"], "label": 1, "es_results": []}, {"bug_id": 431, "bug_title": "SELECT not called with @Caching annotations and Lettuce library", "bug_description": "It seems like when items are put in the cache / retrieved from the cache using spring caching and when using the lettuce library (which i have recently switched to from jedis), that when a RedisConnection is retrieved from the pool and used by the RedisCache class, SELECT is not called and all the cache operations are happening in dbIndex 0, instead of the appropriate database index configured on the RedisTemplate.   I have confirmed that operations done using the redistemplate directly select the correct dbIndex before operations, but when simply using @Cacheable, @CachePut, and @CacheEvict attributes on a method the operations happen in dbIndex 0.", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.6.0.RELEASE", "fixed_version": "1.6.1.RELEASE", "fixed_files": ["org.springframework.data.redis.connection.srp.SrpConnectionIntegrationTests.java", "org.springframework.data.redis.connection.jedis.JedisConnectionPipelineIntegrationTests.java", "org.springframework.data.redis.connection.lettuce.LettuceConnectionFactoryTests.java", "org.springframework.data.redis.connection.jredis.JRedisConnectionIntegrationTests.java", "org.springframework.data.redis.connection.jedis.JedisConnectionIntegrationTests.java", "org.springframework.data.redis.connection.jedis.JedisConnectionTransactionIntegrationTests.java", "org.springframework.data.redis.connection.lettuce.LettuceConnection.java", "org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.java", "org.springframework.data.redis.connection.AbstractConnectionIntegrationTests.java", "org.springframework.data.redis.connection.lettuce.LettuceConnectionUnitTestSuite.java"], "label": 1, "es_results": []}, {"bug_id": 548, "bug_title": "Connection should be released when used with read-only transactions", "bug_description": "A RedisTemplate with enabled transaction support does not close the connection when used in read-only transactions.\n\n\n\n\n\n\n\t@Transactional(readOnly = true)\n\n\n\n\n\tpublic void readonly() {\n\n\n\n\n\t\t\ttemplate.opsForValue().set(\"key\", \"value\");\n\n\n\n\n\t}\n\n\n\n\n\n\nRedisTemplate.execute performs a check after the callback whether transaction support is enabled and if so, it skips connection releasing.", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.6.4.RELEASE", "fixed_version": "1.6.5.RELEASE", "fixed_files": ["org.springframework.data.redis.connection.jedis.JedisTransactionalConnectionStarvationTest.java", "org.springframework.data.redis.core.RedisConnectionUtils.java", "org.springframework.data.redis.connection.AbstractTransactionalTestBase.java", "org.springframework.data.redis.core.RedisTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 467, "bug_title": "Cluster mget not working", "bug_description": "With a 3-node redis cluster, all masters, I&apos;ve set 100 keys via mset, which seems to have worked correctly. Note: all keys do not slot to the same cluster member. Calling JedisClusterConnection.mGet with all 100 keys returns 3 results. It&apos;s hard to tell from debugging but I think the problem is in ClusterCommandExecutor.executeMuliKeyCommand, where a Map of RedisClusterNode to Future<T> is collected and processed. I believe it&apos;s discarding the multiple futures per host here by putting them in a Map with the same key, so that the only result we end up with is the last for each cluster member.", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.7.0.M1", "fixed_version": "1.7.0.RC1", "fixed_files": ["org.springframework.data.redis.connection.jedis.JedisClusterConnectionTests.java", "org.springframework.data.redis.connection.jedis.JedisClusterConnection.java", "org.springframework.data.redis.connection.lettuce.LettuceClusterConnection.java", "org.springframework.data.redis.connection.ClusterCommandExecutorUnitTests.java", "org.springframework.data.redis.core.RedisTemplate.java", "org.springframework.data.redis.connection.lettuce.LettuceClusterConnectionTests.java", "org.springframework.data.redis.connection.ClusterCommandExecutor.java"], "label": 1, "es_results": []}, {"bug_id": 472, "bug_title": "Update/Add guards in JedisConnetion that (no longer) require casts from long to int when exceeding Integer.MAX_VALUE", "bug_description": "The Jedis API in JedisConnection has not been updated for a while. It was using the old Jedis API for expiries where time is passed as integer. As a workaround the expiration time was checked if it is > Integer.MAX_VALUE which then caused the exception when calling pExpire(key, time) on JedisConnection in the pipeline with time in ms > Integer.MAX_VALUE , which is 24 days.\nThis pull request removes this guard and uses new Jedis API that accepts long time instead of int. All tests pass.", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.7.0.M1", "fixed_version": "1.7.0.RC1", "fixed_files": ["org.springframework.data.redis.connection.jedis.JedisConnection.java", "org.springframework.data.redis.connection.jedis.JedisConnectionUnitTestSuite.java"], "label": 1, "es_results": []}, {"bug_id": 542, "bug_title": "RedisCache.putIfAbsent does not set the TTL on the element", "bug_description": "RedisCache.putIfAbsent does not set the TTL on the element in redis. This appears to be because the RedisCachePutIfAbsentCallback performs the wrong check to decide whether it should set the TTL.\nThe check at\nhttps://github.com/spring-projects/spring-data-redis/blob/master/src/main/java/org/springframework/data/redis/cache/RedisCache.java#L725\nLooks like it should check for null being returned from the set rather than checking equality with the supplied value.", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.6.6.RELEASE", "fixed_version": "1.8.0.RC1", "fixed_files": ["org.springframework.data.redis.cache.RedisCacheUnitTests.java", "org.springframework.data.redis.cache.RedisCache.java"], "label": 1, "es_results": []}, {"bug_id": 498, "bug_title": "MappingRedisConverter uses List.sort which requires Java 8.", "bug_description": "", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.7.1.RELEASE", "fixed_version": "1.7.2.RELEASE", "fixed_files": ["org.springframework.data.redis.core.convert.MappingRedisConverter.java"], "label": 1, "es_results": []}, {"bug_id": 489, "bug_title": "Store and retrieve type hints for Object type property values even when those are considered as simple types.", "bug_description": "\n\n\n\n\n\nstatic class Foo {\n\n\n\n\n\tMap<String, Object> map = new HashMap<String, Object>();\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\nFoo foo = new Foo();\n\n\n\n\nfoo.map.put(\"foo\", \"bar\");\n\n\n\n\n\n\n\n\n\nRedisData rd = write(foo);\n\n\n\n\n\n\n\n\n\nFoo result = converter.read(Foo.class, rd);\n\n\n\n\nassertThat(result.map.get(\"foo\"), instanceof(String.class));\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.7.1.RELEASE", "fixed_version": "1.7.2.RELEASE", "fixed_files": ["org.springframework.data.redis.core.convert.MappingRedisConverterUnitTests.java", "org.springframework.data.redis.core.convert.MappingRedisConverter.java", "org.springframework.data.redis.core.convert.ConversionTestEntities.java"], "label": 1, "es_results": []}, {"bug_id": 492, "bug_title": "\"CollectionLike\" properties are force cast into Collection<?> even though they could be arrays", "bug_description": "MappingRedisConverter.writeInternal() does a check against properties. If they are \"collection like\" then they get cast as Collection<?>. However, isCollectionLike() detects iterables, arrays, and collections, hence this is a faulty assumption for casting.\n\n\n\n\n\n\n...\n\n\n\n\nif (persistentProperty.isMap()) {\n\n\n\n\n\twriteMap(keyspace, propertyStringPath, persistentProperty.getMapValueType(),\n\n\n\n\n\t\t(Map<?, ?>) accessor.getProperty(persistentProperty), sink);\n\n\n\n\n} else if (persistentProperty.isCollectionLike()) {\n\n\n\n\n\twriteCollection(keyspace, propertyStringPath, (Collection<?>) accessor.getProperty(persistentProperty),\n\n\n\n\n\t\t\tpersistentProperty.getTypeInformation().getComponentType(), sink);\n\n\n\n\n} else if (persistentProperty.isEntity()) {\n\n\n\n\n\twriteInternal(keyspace, propertyStringPath, accessor.getProperty(persistentProperty),\n\n\n\n\n\t\t\tpersistentProperty.getTypeInformation().getActualType(), sink);\n\n\n\n\n} else {\n\n\n\n\n\tObject propertyValue = accessor.getProperty(persistentProperty);\n\n\n\n\n\twriteToBucket(propertyStringPath, propertyValue, sink, persistentProperty.getType());\n\n\n\n\n}\n\n\n\n\n...\n\n\n\n\n\n\nTypeDiscoverer.isCollectionLike...\n\n\n\n\n\n\n\tpublic boolean isCollectionLike() {\n\n\n\n\n\n\n\n\n\n\t\tClass<?> rawType = getType();\n\n\n\n\n\n\n\n\n\n\t\tif (rawType.isArray() || Iterable.class.equals(rawType)) {\n\n\n\n\n\t\t\treturn true;\n\n\n\n\n\t\t}\n\n\n\n\n\n\n\n\n\n\t\treturn Collection.class.isAssignableFrom(rawType);\n\n\n\n\n\t}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.7.1.RELEASE", "fixed_version": "1.7.2.RELEASE", "fixed_files": ["org.springframework.data.redis.core.convert.MappingRedisConverterUnitTests.java", "org.springframework.data.redis.core.convert.MappingRedisConverter.java", "org.springframework.data.redis.core.convert.ConversionTestEntities.java", "org.springframework.data.redis.core.convert.PathIndexResolver.java"], "label": 1, "es_results": []}, {"bug_id": 501, "bug_title": "RedisTemplate's default serializer assumes that its ClassLoader can load application types", "bug_description": "By default, RedisTemplate uses a JdkSerializationRedisSerializer that will use the default class loader (typically the app class loader) for deserialization. This assumes that the class loader that loaded RedisTemplate will also be able to load an application&apos;s own classes. This doesn&apos;t hold true when using Spring Boot&apos;s DevTools or in a container where Spring Data Redis is installed as a shared library.\nDATAREDIS-427 made it easier to configure the class loader used by JdkSerializationRedisSerializer. Could RedisTemplate be updated to take advantage of this and configure its default JdkSerializationRedisSerializer to use the application context&apos;s ClassLoader?", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.7.1.RELEASE", "fixed_version": "1.7.2.RELEASE", "fixed_files": ["org.springframework.data.redis.core.RedisTemplateUnitTests.java", "org.springframework.data.redis.core.RedisTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 509, "bug_title": "Handle serializing arrays of primitives", "bug_description": "MappingRedisConverter.writeInternal() does a check against properties. If they are \"collection like\" then there is an additional check for array. However, array is assumed to be an array of objects and is cast to Object[]. That does not work for array of primitives.\n\n\n\n\n\n\nif (persistentProperty.isMap()) {\n\n\n\n\n\t\t\t\t\twriteMap(keyspace, propertyStringPath, persistentProperty.getMapValueType(),\n\n\n\n\n\t\t\t\t\t\t\t(Map<?, ?>) accessor.getProperty(persistentProperty), sink);\n\n\n\n\n\t\t\t\t} else if (persistentProperty.isCollectionLike()) {\n\n\n\n\n\n\n\n\n\n\t\t\t\t\tfinal Object property = accessor.getProperty(persistentProperty);\n\n\n\n\n\n\n\n\n\n\t\t\t\t\tif (property == null || Iterable.class.isAssignableFrom(property.getClass())) {\n\n\n\n\n\n\n\n\n\n\t\t\t\t\t\twriteCollection(keyspace, propertyStringPath, (Iterable<?>) property,\n\n\n\n\n\t\t\t\t\t\t\t\tpersistentProperty.getTypeInformation().getComponentType(), sink);\n\n\n\n\n\t\t\t\t\t} else if (property.getClass().isArray()) {\n\n\n\n\n\n\n\n\n\n\t\t\t\t\t\twriteCollection(keyspace, propertyStringPath, Arrays.asList((Object[]) property),\n\n\n\n\n\t\t\t\t\t\t\t\tpersistentProperty.getTypeInformation().getComponentType(), sink);\n\n\n\n\n\t\t\t\t\t} else {\n\n\n\n\n\n\n\n\n\n\t\t\t\t\t\tthrow new RuntimeException(\"Don&apos;t know how to handle \" + property.getClass() + \" type collection\");\n\n\n\n\n\t\t\t\t\t}\n\n\n\n\n\n\nIf we add the following test to org/springframework/data/redis/core/convert/MappingRedisConverterUnitTests.java:\n\n\n\n\n\n\n@Test\n\n\n\n\n    public void writeHandlesArraysOfPrimitivesProperly() {\n\n\n\n\n        WithArrays source = new WithArrays();\n\n\n\n\n        source.arrayOfPrimitives = new int[] { 1, 2, 3 };\n\n\n\n\n        assertThat(write(source).getBucket(), isBucket().containingUtf8String(\"arrayOfPrimitives.[0]\", \"1\")\n\n\n\n\n                .containingUtf8String(\"arrayOfPrimitives.[1]\", \"2\")\n\n\n\n\n                .containingUtf8String(\"arrayOfPrimitives.[2]\", \"3\"));\n\n\n\n\n\n\n\n\n\n    }\n\n\n\n\n\n, it fails with: \n\n\n\n\n\n\njava.lang.ClassCastException: [I cannot be cast to [Ljava.lang.Object;\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.7.1.RELEASE", "fixed_version": "1.7.2.RELEASE", "fixed_files": ["org.springframework.data.redis.core.convert.PathIndexResolverUnitTests.java", "org.springframework.data.redis.core.convert.ConversionTestEntities.java", "org.springframework.data.redis.core.convert.MappingRedisConverterUnitTests.java", "org.springframework.data.redis.core.convert.MappingRedisConverter.java", "org.springframework.data.redis.core.convert.PathIndexResolver.java"], "label": 1, "es_results": []}, {"bug_id": 510, "bug_title": "Current CacheValueAccessor implementation Make null value to empty string", "bug_description": "\n\n\n\n\n\n\t\tbyte[] convertToBytesIfNecessary(Object value) {\n\n\n\n\n\n\n\n\n\n\t\t\tif (value == null) {\n\n\n\n\n\t\t\t\treturn new byte[0];\n\n\n\n\n\t\t\t}\n\n\n\n\n\n\n\n\n\n\t\t\tif (valueSerializer == null && value instanceof byte[]) {\n\n\n\n\n\t\t\t\treturn (byte[]) value;\n\n\n\n\n\t\t\t}\n\n\n\n\n\n\n\n\n\n\t\t\treturn valueSerializer.serialize(value);\n\n\n\n\n\t\t}\n\n\n\n\n\n\n\n\n\n\t\tObject deserializeIfNecessary(byte[] value) {\n\n\n\n\n\n\n\n\n\n\t\t\tif (valueSerializer != null) {\n\n\n\n\n\t\t\t\treturn valueSerializer.deserialize(value);\n\n\n\n\n\t\t\t}\n\n\n\n\n\n\n\n\n\n\t\t\treturn value;\n\n\n\n\n\t\t}\n\n\n\n\n\n\nThe code above convert null to empty byte array when save to redis, but did not do the reverse when read from redis.\n", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.7.1.RELEASE", "fixed_version": "1.7.2.RELEASE", "fixed_files": ["org.springframework.data.redis.cache.RedisCache.java", "org.springframework.data.redis.cache.RedisCacheTest.java"], "label": 1, "es_results": []}, {"bug_id": 500, "bug_title": "executePipelined with RedisCallback uses wrong serializer (RedisTemplate.java)", "bug_description": "RedisTemplate.executePipelined with RedisCallback uses wrong serializer when hashKeySerializer is different from  hashValueSerializer. \n\n\n\n\n\n\n    @Test\n\n\n\n\n    public void testExecutePipelinedWidthDifferentHashKeySerializerAndHashValueSerializer() {\n\n\n\n\n        assumeTrue(redisTemplate instanceof RedisTemplate);\n\n\n\n\n        redisTemplate.setKeySerializer(new StringRedisSerializer());\n\n\n\n\n        redisTemplate.setHashKeySerializer(new StringRedisSerializer());\n\n\n\n\n        redisTemplate.setHashValueSerializer(new GenericToStringSerializer<Long>(Long.class));\n\n\n\n\n        redisTemplate.opsForHash().put((K) \"foo\", \"key\", 1L);\n\n\n\n\n        List<Object> results = redisTemplate.executePipelined(new RedisCallback() {\n\n\n\n\n            public Object doInRedis(RedisConnection connection) throws DataAccessException {\n\n\n\n\n                connection.hGetAll(((StringRedisSerializer) redisTemplate.getKeySerializer()).serialize(\"foo\"));\n\n\n\n\n                return null;\n\n\n\n\n            }\n\n\n\n\n        });\n\n\n\n\n        assertEquals(((Map) results.get(0)).get(\"key\"), 1L);\n\n\n\n\n    }\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.7.1.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.redis.core.RedisTemplate.java", "org.springframework.data.redis.core.RedisTemplateTests.java"], "label": 1, "es_results": []}, {"bug_id": 524, "bug_title": "NOAUTH Authentication required when connecting to Redis Sentinel with LettuceConnectionFactory", "bug_description": "Using LettuceConnectionFactory with Redis Sentinel and password-protected Redis nodes causes NOAUTH errors because the configured password is not set in RedisURI.", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.7.2.RELEASE", "fixed_version": "1.8.0.M1", "fixed_files": ["org.springframework.data.redis.connection.lettuce.DefaultLettucePool.java", "org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.java", "org.springframework.data.redis.connection.lettuce.LettuceConnectionFactoryUnitTests.java", "org.springframework.data.redis.connection.lettuce.DefaultLettucePoolTests.java"], "label": 1, "es_results": []}, {"bug_id": 547, "bug_title": "Getting NPE when writing valid Query Method without any criteria", "bug_description": "When creating a valid query method in Spring Data Redis without any criteria, for example:\n\n\n\n\n\n\nGame findFirstByOrderByStartDesc();\n\n\n\n\n\n\nWe don&apos;t get an error stating that Ordering/Sorting is not supported for Redis, but instead we receive a NPE in the following class:\n\n\n\n\n\n\norg.springframework.data.redis.repository.query.RedisQueryCreator#complete\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREDIS", "version": "1.7.2.RELEASE", "fixed_version": "1.7.3.RELEASE", "fixed_files": ["org.springframework.data.redis.repository.RedisRepositoryIntegrationTestBase.java", "org.springframework.data.redis.core.RedisQueryEngine.java", "org.springframework.data.redis.core.RedisKeyValueAdapter.java", "org.springframework.data.redis.repository.query.RedisQueryCreator.java"], "label": 1, "es_results": []}, {"bug_id": 38, "bug_title": "Listing relations with Accept:application/x-spring-data-compact-json does not contain self link.", "bug_description": "When loading a relation like this: \nhttp://localhost:8080/rest/entity/6bf64863-2c1f-4661-b54b-7611971b36aa/relation/a6ae6a94-31f9-47a5-9904-329477ab54d0\nwith: \n\"application/x-spring-data-compact+json\" as Accept-Type, the result does not contain a self link. The same for \"application/json\" as Accept-Type.\nThis worked before and also works for:\nhttp://localhost:8080/rest/entity/ etc.", "project": "Spring", "sub_project": "DATAREST", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryRestController.java"], "label": 1, "es_results": []}, {"bug_id": 48, "bug_title": "Executing /search/findEntityById?id=823892389 with x-spring-data-compact+json does not return any value.", "bug_description": "When I try to execute a search with the following URL: \nhttp://localhorst:8080/rest/entity/search/findEntityById?id=823892389 setting Accept : application/x-spring-data-compact+json the result is:\n{\n  \"links\" : [ ],\n  \"content\" : [ ]\n}\nDoing the exactly same request with \nAccept : application/json returns\n{\n  \"links\" : [ ],\n  \"content\" : [ {\n    \"links\" : [  \n{\n      \"rel\" : \"self\",\n      \"href\" : \"http://localhost:8080/rest/entity/453234243\"\n    }\n,  ],\n    \"enabled\" : false,\n    ....\n  } ]\n}\nIn the previous build it worked. ", "project": "Spring", "sub_project": "DATAREST", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryRestController.java"], "label": 1, "es_results": []}, {"bug_id": 44, "bug_title": "Issue on Entity without @Version attribute when using Eclipselink as provider", "bug_description": "If using EclipseLink as persistence provider, the exporter fails with this error:\n\"java.lang.IllegalArgumentException: No @Version attribute exists on the identifiable type\"\nI have isolated the error at line 35 of JpaEntityMetadata class, seems that the metod entityType.getVersion(Long.class) fails in eclipselink if no @Version is defined.\nIn attachment the log file", "project": "Spring", "sub_project": "DATAREST", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.data.rest.repository.jpa.JpaEntityMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 83, "bug_title": "Controller implementations should not be annotated with @Controller", "bug_description": "The controller implementations are currently annotated with @Controller which causes issues when you use Spring Data REST in the same application context in which you have Spring MVC activated through @EnableWebMvc. The latter registers a RequestHandlerMapping that scans the ApplicationContext for all beans annotated with @Controller and will find the SD REST controllers. As the RequestHandlerMapping has higher precedence than the RepositoryRestHandlerMapping it will take over the execution of the controllers which causes trouble in case the additional functionality applied in RRHM is (e.g. baseUri configuration etc.) needed.\nActually the classes don&apos;t need to be annotated with @Controller as they are registered explicitly and the RRHM explicitly considers these classes anyway.", "project": "Spring", "sub_project": "DATAREST", "version": "1.1.0.M1", "fixed_version": "2.0.0.M1", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryController.java", "org.springframework.data.rest.webmvc.RepositoryEntityController.java", "org.springframework.data.rest.webmvc.RepositoryPropertyReferenceController.java", "org.springframework.data.rest.webmvc.RepositorySearchController.java", "org.springframework.data.rest.webmvc.AbstractRepositoryRestController.java"], "label": 1, "es_results": []}, {"bug_id": 200, "bug_title": "Embedded associations do not get rendered", "bug_description": "\n\n\n\n\n\nclass Order {\n\n\n\n\n\n\n\n\n\n  Set<LineItems> lineItems;\n\n\n\n\n}\n\n\n\n\n\n\nIf Order is repository managed but LineItems is not, the line items do not get rendered at all.", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.0.M1", "fixed_version": "2.0.0.RC1", "fixed_files": ["org.springframework.data.rest.webmvc.jpa.TestDataPopulator.java", "org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java", "org.springframework.data.rest.webmvc.jpa.JpaWebTests.java", "org.springframework.data.rest.webmvc.jpa.Order.java"], "label": 1, "es_results": []}, {"bug_id": 213, "bug_title": "Make old presentation available for smooth migration to HAL", "bug_description": "For people using SD Rest a bit longer, the migration towards HAL could take some time. So I think there a many people, which would really appreciate the opportunity of a smooth migration by default enabling both, the old and the new representation.\nThat would help, to be able to get the bugfixes regarding SDF 4.0 and for example the previously filed sorting bug.", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.0.M1", "fixed_version": "2.0.0.RC1", "fixed_files": ["org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 222, "bug_title": "Path.matches() should escape reference before trying to match it", "bug_description": "", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.0.M1", "fixed_version": "2.0.0.RC1", "fixed_files": ["org.springframework.data.rest.core.Path.java", "org.springframework.data.rest.core.PathUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 246, "bug_title": "ValidatingRepositoryEventListener should use Repositories more lenient", "bug_description": "ValidatingRepositoryEventListener uses field injection to access a Repositories instance and does a by-type lookup of components in afterPropertiesSet() which can cause a circular reference on initialization.\nWe should rather use an ObjectFactory<Repositories> from within the listener so that the container can give us a proxy that will eventually return the Repositories instance but doesn&apos;t have to instantiate Repositories eagerly.", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.0.RC1", "fixed_version": "2.0.0.RELEASE", "fixed_files": ["org.springframework.data.rest.core.event.AbstractRepositoryEventListener.java", "org.springframework.data.rest.core.context.ValidatorIntegrationTests.java", "org.springframework.data.rest.core.event.ValidatingRepositoryEventListener.java", "org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 216, "bug_title": "AOP proxying does not work for findOne(ID) method", "bug_description": "When attempting to apply AOP proxying to an overriden findOne(ID) method, the proxied method is not called.\nExample:\n\n\n\n\n\n\n@Override\n\n\n\n\n@PreAuthorize(\"hasAuthority(&apos;ROLE_ADMIN&apos;)\")\n\n\n\n\nPurchaseOrder findOne(PurchaseOrderPK pk);\n\n\n\n\n\n\nThe problem is due to the base class &apos;findOne(Serializable id)&apos; method being called instead of the more specific, covariant version.\nAlthough the obvious solution is to simply override the &apos;findOne(Serializable id)&apos; method and place an annotation on in it instead, this does not completely solve the issue. There are cases where it is desirable to overload the more specific version such as when one is using a spEL expression in an annotation and referring to a composite key, for example:\n\n\n\n\n\n\n@Override\n\n\n\n\n@PreAuthorize(\"#pk.getUserId() == authentication.id\")\n\n\n\n\nPurchaseOrder findOne(@Param(\"pk\") PurchaseOrderPK pk);\n\n\n\n\n\n\nThe issue is specific to CrudRepository and PagingAndSortingRepository derived repositories.", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.0.M1", "fixed_version": "2.0.0.RELEASE", "fixed_files": ["org.springframework.data.rest.core.invoke.CrudRepositoryInvoker.java", "org.springframework.data.rest.core.invoke.ReflectionRepositoryInvoker.java", "org.springframework.data.rest.core.domain.jpa.OrderRepository.java", "org.springframework.data.rest.core.domain.jpa.Order.java", "org.springframework.data.rest.core.invoke.RepositoryInvoker.java"], "label": 1, "es_results": []}, {"bug_id": 238, "bug_title": "PUT on entity with self links causes changes to be overwritten with old values", "bug_description": "When PUTting the following JSON (a \"Workload\" entity):\n\n\n\n\n\n\n{\n\n\n\n\n  \"version\" : 1,\n\n\n\n\n  \"weight\" : 123,\n\n\n\n\n  \"handlingMinutes\" : 2,\n\n\n\n\n  \"articleCount\" : 3,\n\n\n\n\n  \"address\" : {\n\n\n\n\n    \"line1\" : null,\n\n\n\n\n    \"line2\" : null,\n\n\n\n\n    \"line3\" : null,\n\n\n\n\n    \"postCode\" : \"53123\",\n\n\n\n\n    \"city\" : \"Bonn          \",\n\n\n\n\n    \"countryCode\" : null,\n\n\n\n\n    \"street\" : \"Bonner Bonnweg\",\n\n\n\n\n    \"houseNumber\" : \"125\"\n\n\n\n\n  },\n\n\n\n\n  \"links\" : [ {\n\n\n\n\n    \"rel\" : \"self\",\n\n\n\n\n    \"href\" : \"http://127.0.0.1:8000/api/workloadDao/1060\"\n\n\n\n\n  }, {\n\n\n\n\n    \"rel\" : \"area\",\n\n\n\n\n    \"href\" : \"http://127.0.0.1:8000/api/workloadDao/1060/area\"\n\n\n\n\n  }, {\n\n\n\n\n    \"rel\" : \"product\",\n\n\n\n\n    \"href\" : \"http://127.0.0.1:8000/api/workloadDao/1060/product\"\n\n\n\n\n  } ]\n\n\n\n\n}\n\n\n\n\n\n\n.. the incoming JSON is converted all fine and well, until it runs into the links/rel/self/href thing, and hits this line: [1]\nThis causes the converted Workload entity from the PUT call to be overwritten with the old values. End-effect: A PUT looks like it is successful, but no changes are stored.\n[1] https://github.com/spring-projects/spring-data-rest/blob/2.0.0.M1/spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/PersistentEntityJackson2Module.java#L135", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.0.M1", "fixed_version": "2.0.0.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryEntityController.java", "org.springframework.data.rest.webmvc.jpa.JpaWebTests.java", "org.springframework.data.rest.webmvc.AbstractWebIntegrationTests.java", "org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java", "org.springframework.data.rest.webmvc.json.RepositoryTestsConfig.java", "org.springframework.data.rest.webmvc.json.PersistentEntitySerializationTests.java"], "label": 1, "es_results": []}, {"bug_id": 143, "bug_title": "PUT of entity with links fails..", "bug_description": "Github Author: jhiemer\nGithub Last-Updated: 2013-03-22T20:05:51Z\nThis issue was automatically imported from github\nHi Jon,\nwhen I am doing a put to the self link with embedded links I get an error. This means I need to remove all links before putting an element. I think this should not be the desired behaviour. Or?\nSample:\n\n\n\n\n\n\n{\n\n\n\n\n   \"description\":\"adasdadsasdads\",\n\n\n\n\n   \"name\":\"Customer Corp\",\n\n\n\n\n   \"links\":[\n\n\n\n\n      {\n\n\n\n\n         \"rel\":\"self\",\n\n\n\n\n         \"href\":\"http://localhost:8080/web/api/customer/1\"\n\n\n\n\n      },\n\n\n\n\n      {\n\n\n\n\n         \"rel\":\"customer.customer.users\",\n\n\n\n\n         \"href\":\"http://localhost:8080/web/api/customer/1/users\"\n\n\n\n\n      },\n\n\n\n\n      {\n\n\n\n\n         \"rel\":\"customer.customer.credentials\",\n\n\n\n\n         \"href\":\"http://localhost:8080/web/api/customer/1/credentials\"\n\n\n\n\n      },\n\n\n\n\n      {\n\n\n\n\n         \"rel\":\"customer.customer.addresses\",\n\n\n\n\n         \"href\":\"http://localhost:8080/web/api/customer/1/addresses\"\n\n\n\n\n      },\n\n\n\n\n      {\n\n\n\n\n         \"rel\":\"customer.customer.sector\",\n\n\n\n\n         \"href\":\"http://localhost:8080/web/api/customer/1/sector\"\n\n\n\n\n      }\n\n\n\n\n   ]\n\n\n\n\n}\n\n\n\n\n\n\nThe response is:\n\n\n\n\n\n\njavascript\n\n\n\n\n{\n\n\n\n\n  \"because\" : null,\n\n\n\n\n  \"message\" : \"Property &apos;links&apos; not found for entity de.model.customer.Customer\"\n\n\n\n\n}\n\n\n\n\n\n\nPerhaps one additional note: the same happens, when using embedded entities like you described here: http://stackoverflow.com/questions/12879975/spring-data-rest-uri-vs-entity-id. Of course the POST fails, if I remove the links as the exporter is not able to find the customer in the database.", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.0.M1", "fixed_version": "2.0.0.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryEntityController.java", "org.springframework.data.rest.webmvc.jpa.JpaWebTests.java", "org.springframework.data.rest.webmvc.AbstractWebIntegrationTests.java", "org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java", "org.springframework.data.rest.webmvc.json.RepositoryTestsConfig.java", "org.springframework.data.rest.webmvc.json.PersistentEntitySerializationTests.java"], "label": 1, "es_results": []}, {"bug_id": 254, "bug_title": "org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module does not properly handle JPA @Transient annotation during serialization yeilding a NPE", "bug_description": "Create and Entity as per below:\n@Entity\n@Table(name = \"category\")\npublic class Category implements Serializable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    protected Long id;\n    @Column(name = \"description\")\n    protected String description;\n    @Column(name=\"last_change_dtm\")\n    private Date lastChangeDate;\n    @Transient\n    private Long key;\n    ...\n}\nMethod org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.updateBuilder(SerializationConfig config, BeanDescription beanDesc, BeanSerializerBuilder builder) with throw a NullPointerException when trying to serialize the key property of Category bean.  Within the for loop, @Transient properties will result in a null persistentProperty and the subsequent if() statement will throw a NPE.  This did not occur in Spring Data Rest 2.0.0.RC1.\n", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.0.RELEASE", "fixed_version": "2.0.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.AbstractRepositoryRestController.java", "org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java", "org.springframework.data.rest.webmvc.jpa.Order.java", "org.springframework.data.rest.webmvc.json.PersistentEntitySerializationTests.java"], "label": 1, "es_results": []}, {"bug_id": 253, "bug_title": "AssociationOmittingSerializerModifier suffers from potential NullPointerException", "bug_description": "AssociationOmittingSerializerModifier traverses the properties Jackson detected and checks whether they&apos;re associations. For properties not backed by a field at all (i.e. getters that represent a calculated business value) the PersistentProperty will be null and the subsequent if-clauses will cause a NullPointerException.", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.0.RELEASE", "fixed_version": "2.0.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.AbstractRepositoryRestController.java", "org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java", "org.springframework.data.rest.webmvc.jpa.Order.java", "org.springframework.data.rest.webmvc.json.PersistentEntitySerializationTests.java"], "label": 1, "es_results": []}, {"bug_id": 261, "bug_title": "RepositoryRelProvider is not registered", "bug_description": "Currently there&apos;s bean registered for the RepositoryRelProvider implementation that returns rels based on the mapping information.\nThis causes components using a RelProvider to calculate rels (in contrast to ones that directly use the ResourceMapping (such as the root controller). This causes different rels being rendered depending on which API a component uses.", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.0.RELEASE", "fixed_version": "2.0.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.webmvc.AbstractWebIntegrationTests.java", "org.springframework.data.rest.core.support.RepositoryRelProvider.java", "org.springframework.data.rest.webmvc.jpa.JpaWebTests.java"], "label": 1, "es_results": []}, {"bug_id": 247, "bug_title": "NPE when calling count Queries in SD MongoDB Repositories", "bug_description": "I created the following query:\n\n\n\n\n\n\n@Query(value = \"{&apos;requestId&apos;: ?0}\", count = true)\n\n\n\n\npublic Long countByRequestId(@Param(\"id\") String id);\n\n\n\n\n\n\nTrying to access this query via SD REST, results in a NPE. This NPE is thrown in the AbstractRepositoryRestController. The throwing method is:\n\n\n\n\n\n\n@SuppressWarnings({ \"unchecked\" })\n\n\n\n\n\tprotected Resources resultToResources(Object result) {\n\n\n\n\n\n\n\n\n\n\t\tif (result instanceof Page) {\n\n\n\n\n\t\t\tPage<Object> page = (Page<Object>) result;\n\n\n\n\n\t\t\treturn entitiesToResources(page, assembler);\n\n\n\n\n\t\t} else if (result instanceof Iterable) {\n\n\n\n\n\t\t\treturn entitiesToResources((Iterable<Object>) result);\n\n\n\n\n\t\t} else if (null == result) {\n\n\n\n\n\t\t\treturn new Resources(EMPTY_RESOURCE_LIST);\n\n\n\n\n\t\t} else {\n\n\n\n\n\t\t\tResource<Object> resource = perAssembler.toResource(result);\n\n\n\n\n\t\t\treturn new Resources(Collections.singletonList(resource));\n\n\n\n\n\t\t}\n\n\n\n\n\t}\n\n\n\n\n\n\nAs the query returns Long the method steps into:\n\n\n\n\n\n\nResource<Object> resource = perAssembler.toResource(result);\n\n\n\n\n\n\nwhich results in a Null instance for entity in:\n\n\n\n\n\n\nPersistentEntity<?, ?> entity = repositories.getPersistentEntity(instance.getClass());\n\n\n\n\n\n\nand then leads to the NPE.", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.0.M1", "fixed_version": "2.0.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.mongodb.ProfileRepository.java", "org.springframework.data.rest.webmvc.RepositorySearchControllerIntegrationTests.java", "org.springframework.data.rest.webmvc.mongodb.MongoWebTests.java", "org.springframework.data.rest.webmvc.AbstractWebIntegrationTests.java", "org.springframework.data.rest.webmvc.RepositorySearchController.java"], "label": 1, "es_results": []}, {"bug_id": 288, "bug_title": "RepositorySchemaController must not depend on javax.validation", "bug_description": "", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.1.RELEASE", "fixed_version": "2.0.2.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.json.PersistentEntityToJsonSchemaConverter.java", "org.springframework.data.rest.webmvc.RepositorySchemaController.java"], "label": 1, "es_results": []}, {"bug_id": 311, "bug_title": "executeSearchCompact - Mismatch argument name and path variable name", "bug_description": "In the RepositorySearchController class, the method executeSearchCompact does not take the right argument.\nThis case happens when the Accept values in the Request Header contains application/*+json\nIf you use the browser, no issue can be detected.", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.2.RELEASE", "fixed_version": "2.0.3.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.jpa.JpaWebTests.java", "org.springframework.data.rest.webmvc.AbstractWebIntegrationTests.java", "org.springframework.data.rest.webmvc.RepositorySearchController.java"], "label": 1, "es_results": []}, {"bug_id": 316, "bug_title": "UriStringDeserializer should guard against URI templates submitted", "bug_description": "Currently UriStringDeserializer uses the raw String provided for the value and tries to create a URI instance from it. In case the client accidentally submits a URI tempalte, this will fail.\nThe UriStringDeserializer should defensively expand the given value to make sure optional template variables are stripped.", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.2.RELEASE", "fixed_version": "2.0.3.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java", "org.springframework.data.rest.webmvc.RepositoryPropertyReferenceController.java"], "label": 1, "es_results": []}, {"bug_id": 301, "bug_title": "Illegal character '{' in URL when using projection and PUT request", "bug_description": "We are calling URL http://localhost:8080/rapnot/companies/4 with PUT method in order to update data.\nIn the logs, we see this error: \n\n\n\n\n\n\n2014-05-06 10:54:45,688 ERROR [org.springframework.data.rest.webmvc.AbstractRepositoryRestController] Illegal character in path at index 40: http://localhost:8080/rapnot/companies/4{?projection}\n\n\n\n\n\n\nThe {?projection} has been added to the URL and we get an invalid URL.\nThe issue seems to be located in this part of the code in org.springframework.data.rest.webmvc.RepositoryEntityController:\n\n\n\n\n\n\nprivate ResponseEntity<ResourceSupport> mergeAndReturn(Object incoming, Object domainObject,\n\n\n\n\n\tRepositoryInvoker invoker, HttpMethod httpMethod, PersistentEntityResourceAssembler assembler) {\n\n\n\n\n\n\n\n\n\n\t\n\n\n\n\n\n\n\n\n\n\tif (PUT.equals(httpMethod)) {\n\n\n\n\n\t\theaders.setLocation(URI.create(assembler.getSelfLinkFor(obj).getHref()));\n\n\n\n\n\t}\n\n\n\n\n\t\n\n\n\n\n}\n\n\n\n\n\n\nAt least, this is where the {?projection} is added to the URL.", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.0.RC1", "fixed_version": "2.0.3.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryEntityControllerIntegrationTests.java", "org.springframework.data.rest.webmvc.RepositoryEntityController.java"], "label": 1, "es_results": []}, {"bug_id": 307, "bug_title": "Root mapping not discovered on Tomcat", "bug_description": "In case the URI handling returns an empty String (e.g. on requests to the root mapping) the subsequent lookup of the handler method fails to discover the RepositoryController on Tomcat.", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.0.RC1", "fixed_version": "2.1.0.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryRestHandlerMapping.java"], "label": 1, "es_results": []}, {"bug_id": 325, "bug_title": "ReflectionRepositoryInvoker fails to invoke non-public methods", "bug_description": "Assume the following repository:\n\n\n\n\n\n\n@RepositoryRestResource\n\n\n\n\ninterface AuthorRepository extends Repository<Author, Long> {\n\n\n\n\n\n\n\n\n\n\tList<Author> findByFirstnameContaining(String name);\n\n\n\n\n}\n\n\n\n\n\n\nThis repo is package scope but still exported, due to its  @RepositoryRestResource annotation. Trying to invoke the finder will cause an exception in ReflectionRepositoryInvoker.invoke() as the method is not accessible.", "project": "Spring", "sub_project": "DATAREST", "version": "2.0.3.RELEASE", "fixed_version": "2.1.1.RELEASE", "fixed_files": ["org.springframework.data.rest.core.invoke.ReflectionRepositoryInvokerIntegrationTests.java", "org.springframework.data.rest.core.invoke.ReflectionRepositoryInvoker.java", "org.springframework.data.rest.core.mapping.ResourceMappingsIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 329, "bug_title": "RepositoryRestMvcConfiguration causes eager initialization of beans", "bug_description": "RepositoryRestMvcConfiguration declares a bean of type AnnotatedHandlerBeanPostProcessor which is a BeanPostProcessor and thus will get initialized very early in the container lifecycle. This however means that the configuration class will be populated and thus trigger the creation of all beans that need to be autowired into the container.\nWe should make the bean definition method static as it doesn&apos;t actually require any dependencies be present in the first place.", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.0.RELEASE", "fixed_version": "2.1.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.webmvc.neo4j.Neo4jWebTests.java"], "label": 1, "es_results": []}, {"bug_id": 331, "bug_title": "Improvements in ResourceProcessorHandlerMethodReturnValueHandler", "bug_description": "ResourceProcessorHandlerMethodReturnValueHandler currently doesn&apos;t invoke ResourceProcessor instances that are typed to Resources if the value returned from the controller is a subtype of Resources (e.g. PagedResources).", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.0.RELEASE", "fixed_version": "2.1.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.ResourceProcessorHandlerMethodReturnValueHandlerUnitTests.java", "org.springframework.data.rest.webmvc.ResourceProcessorHandlerMethodReturnValueHandler.java"], "label": 1, "es_results": []}, {"bug_id": 328, "bug_title": "Serialization errors if type contains only renamed properties", "bug_description": "Adding @EnableMongoAuditing to an application configuration causes a few different problems related to (but probably not caused by) Jackson serialization.  These issues can be reproduced by (1) starting an application with @EnableMongoAuditing, (2) POSTing certain types of entities to a RepositoryRestResource, and (3) attempting to GET from the same repository.  \nPlease refer to the referenced URL for a working example based on the mongodb-data-rest getting-started sample.  Also note the comment with sample command-line input at: https://github.com/ncantelmo/gs-accessing-mongodb-data-rest/commit/988626629a1ef708b5a3d44c4bd8b2874662747f#commitcomment-6740135\nAdditional notes:\n\nThis issue was initially identified in an application that implemented AuditorAware.  The inclusion of an AuditorAware bean appears to make no difference on the described behavior.\nThe following sequence of events will NOT reveal the issue: (1) POST a new document to some repository X, (2) Restart the application, (3), GET from repository X, (4) POST another document with the same fields to repository X, (5) GET from repository X.\nIn other words, if you GET from a populated repository before you POST, the serialization routines will work properly.\nIn the referenced example, removing the @JsonProperty(\"brand_name\") annotation in PetFood.java will prevent serialization from causing a crash.\nIn root-level entities or immediate nested children, custom @JsonProperty annotations will cause the annotated properties to not be fetched during a GET after an initial POST, but won&apos;t because a crash.\n\n", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.0.RELEASE", "fixed_version": "2.1.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java"], "label": 1, "es_results": []}, {"bug_id": 320, "bug_title": "Fields with @JsonProperty are ignored on serialization", "bug_description": "Field annotated with @JsonProperty are left out from the serialization. This also means that it is not possible to alter the json property name. \nThe problem seems to be caused by \n\n\n\n\n\nPersistentEntityJackson2Module.updateBuilder(..)\n\n\n\n\n\n on line #219, where the property is attempted looked up by the name from the @JsonProperty, instead of the \"real\" property name. One way I think this can be solved is to add an inner loop to find the internal name from beanDesc.findProperties().\nExample:\n\n\n\n\n\n\n@Entity\n\n\n\n\npublic class Description {    \n\n\n\n\n    private String heading;\n\n\n\n\n    @JsonProperty(\"body\")\n\n\n\n\n    private String content;\n\n\n\n\n    ...\n\n\n\n\n}\n\n\n\n\n\n\nOn serialization, everything looks fine from Jackson&apos;s perspective, but when the updateBuilder() hook on PersistentEntityJackson2Module is called the content property is omitted because the name of the field is different from the @JsonProperty.\nI haven&apos;t sent a pull request, since I haven&apos;t enlisted in the contributor program, but hopefully you can cherry pick or look at the commit on my fork.\nThis problem was also described in DATAREST-117 and the corresponding pull request that was never merged: https://github.com/spring-projects/spring-data-rest/pull/136.", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.0.RELEASE", "fixed_version": "2.1.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java"], "label": 1, "es_results": []}, {"bug_id": 319, "bug_title": "Add means to prefer deleting by object instead of deleting by id", "bug_description": "From the REST interface to the Repository you cannot force preference for using the void delete(T t) method over void delete(ID id) method. As a result we cannot do @PreAuthorize filters on delete based of object values. A use case for this would be to set security constraints.", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.0.RELEASE", "fixed_version": "2.2.0.RC1", "fixed_files": ["org.springframework.data.rest.core.invoke.ReflectionRepositoryInvokerIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 346, "bug_title": "ReflectionRepositoryInvoker does not apply conversion on invocation of an overridden delete() method", "bug_description": "If a repository redeclares a delete() method using the concrete identifier type the ReflectionRepositoryInvoker fails to invoke this method as it will get the raw id value handed into the invokeDelete() method.\nThis is a side effect of the fix for DATAREST-335 which added explicit handling for the overridden method with the concrete identifier type but assumed the parameter would be handed in the correct type already.", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.1.RELEASE", "fixed_version": "2.2.0.M1", "fixed_files": ["org.springframework.data.rest.core.invoke.ReflectionRepositoryInvokerIntegrationTests.java", "org.springframework.data.rest.core.invoke.ReflectionRepositoryInvoker.java"], "label": 1, "es_results": []}, {"bug_id": 394, "bug_title": "Projections are not applied to collection attributes", "bug_description": "When a projection has an attribute which is a collection of another projection, Spring Data REST is not populating the collection with projections but with entities. This patch allows Spring Data REST to apply projections to collection attributes as well.", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.4.RELEASE", "fixed_version": "2.3.0.M1", "fixed_files": ["org.springframework.data.rest.core.projection.ProjectingMethodInterceptor.java", "org.springframework.data.rest.core.projection.ProjectingMethodInterceptorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 408, "bug_title": "Nested projections not loading nested lists", "bug_description": "When nesting projections, Lists/Maps are not included in the processing. Sample:\nThe following snippet represents the nested projection, which contains a list of limitations.\n\n\n\n\n\n\n\"name\" : \"Light\",\n\n\n\n\n    \"description\" : \"Light\",\n\n\n\n\n    \"enabled\" : true,\n\n\n\n\n    \"limitations\" : [ {\n\n\n\n\n      \"name\" : \"Request\",\n\n\n\n\n      \"description\" : \"Number of requests per billing period\",\n\n\n\n\n      \"type\" : null,\n\n\n\n\n      \"value\" : 20.0\n\n\n\n\n    } ],\n\n\n\n\n    \"links\" : [ ],\n\n\n\n\n    \"content\" : [ ],\n\n\n\n\n    \"links\" : [ {\n\n\n\n\n      \"rel\" : \"self\",\n\n\n\n\n      \"href\" : \"http://localhost:8080/web/specifications/1310{?projection}\"\n\n\n\n\n    }, {\n\n\n\n\n      \"rel\" : \"limitations\",\n\n\n\n\n      \"href\" : \"http://localhost:8080/web/specifications/1310/limitations\"\n\n\n\n\n    }, {\n\n\n\n\n      \"rel\" : \"product\",\n\n\n\n\n      \"href\" : \"http://localhost:8080/web/specifications/1310/product\"\n\n\n\n\n    }\n\n\n\n\n\n\nUsing the parent projection, which contains the nested projection\n\n\n\n\n\n\n\"name\" : \"Light\",\n\n\n\n\n    \"description\" : \"Light\",\n\n\n\n\n    \"prices\" : [ {\n\n\n\n\n      \"value\" : -1.0,\n\n\n\n\n      \"currency\" : \"USD\",\n\n\n\n\n      \"unit\" : \"Request\",\n\n\n\n\n      \"period\" : \"Month\",\n\n\n\n\n      \"interval\" : 1,\n\n\n\n\n      \"approximation\" : false,\n\n\n\n\n      \"component\" : null\n\n\n\n\n    } ],\n\n\n\n\n    \"productCategory\" : {\n\n\n\n\n      \"name\" : \"Price comparison\",\n\n\n\n\n      \"description\" : \"Blablablaba\"\n\n\n\n\n    },\n\n\n\n\n    \"specifications\" : [ {\n\n\n\n\n      \"name\" : \"Light\",\n\n\n\n\n      \"description\" : \"Light\",\n\n\n\n\n      \"enabled\" : true\n\n\n\n\n    } ],\n\n\n\n\n    \"trialPeriod\" : null,\n\n\n\n\n    \"trialInterval\" : 0,\n\n\n\n\n    \"links\" : [ ],\n\n\n\n\n    \"content\" : [ ],\n\n\n\n\n    \"links\" : [ {\n\n\n\n\n      \"rel\" : \"self\",\n\n\n\n\n      \"href\" : \"http://localhost:8080/web/products/1300{?projection}\"\n\n\n\n\n    }, {\n\n\n\n\n      \"rel\" : \"specifications\",\n\n\n\n\n      \"href\" : \"http://localhost:8080/web/products/1300/specifications\"\n\n\n\n\n    }, {\n\n\n\n\n      \"rel\" : \"product\",\n\n\n\n\n      \"href\" : \"http://localhost:8080/web/products/1300/product\"\n\n\n\n\n    }, {\n\n\n\n\n      \"rel\" : \"productCategory\",\n\n\n\n\n      \"href\" : \"http://localhost:8080/web/products/1300/productCategory\"\n\n\n\n\n    }, {\n\n\n\n\n      \"rel\" : \"accounts\",\n\n\n\n\n      \"href\" : \"http://localhost:8080/web/products/1300/accounts\"\n\n\n\n\n    } ]\n\n\n\n\n\n\none can see, that all types (int, string) etc. are rendered, but the list not. ", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.4.RELEASE", "fixed_version": "2.3.0.M1", "fixed_files": ["org.springframework.data.rest.core.projection.ProjectingMethodInterceptor.java", "org.springframework.data.rest.core.projection.ProjectingMethodInterceptorUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 445, "bug_title": "RepositoryCollectionResourceMapping does not obtain domain type from RepositoryMetadata", "bug_description": "RepositoryCollectionResourceMapping is manually looking up generic types to determine the domain type handled but actually it can just use the RepositoryMetadata handed into the constructor.", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.4.RELEASE", "fixed_version": "2.1.5.RELEASE", "fixed_files": ["org.springframework.data.rest.core.mapping.RepositoryCollectionResourceMapping.java", "org.springframework.data.rest.core.mapping.RepositoryCollectionResourceMappingUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 460, "bug_title": "Make sure @Bean methods of RepositoryRestMvcConfiguration are called from proxied methods", "bug_description": "Some methods in RepositoryRestMvcConfiguration are private but call @Bean annotated methods in turn. These method calls will not get intercepted correctly as private methods are not intercepted by the CGLib generated subtype of the configuration class. That means that @Bean methods called from the private methods will not be routed through the interceptor and thus Spring&apos;s bean management (scopes, invocation of callbacks) will not be applied.", "project": "Spring", "sub_project": "DATAREST", "version": "2.1.4.RELEASE", "fixed_version": "2.1.5.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 381, "bug_title": "Controllers for Alps and repository listing get listed under the root even if a base URI is configured", "bug_description": "", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.0.RC1", "fixed_version": "2.2.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryEntityController.java", "org.springframework.data.rest.webmvc.RepositoryRestHandlerAdapter.java", "org.springframework.data.rest.webmvc.alps.AlpsController.java", "org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.webmvc.RepositoryRestHandlerMapping.java", "org.springframework.data.rest.webmvc.RepositoryController.java", "org.springframework.data.rest.webmvc.RepositoryRestController.java"], "label": 1, "es_results": []}, {"bug_id": 388, "bug_title": "Cannot use controller advices if annotation based event handling is used", "bug_description": "Spring Data REST is capturing any exceptions thrown by event handler methods and re-throwing them as IllegalStateException. By doing this, Spring Data REST makes it very hard to adopt any exception handling mechanism offered by Spring MVC (controller advices, for example) because we cannot pinpoint which exception we would like to handle in each exception handler of the controller advice (the only exception that we can handle is IllegalStateException).\nThe patch in the pull request corrects this behavior. If a event handler throws a unchecked exception, than it makes sure that this very exception is thrown. Otherwise (if it is a checked exception), it resorts to the old behavior, encapsulating the checked exception in a IllegalStateException. Without this patch, the controller advice shown below does not work.\n\n\n\n\n\n\n@ControllerAdvice\n\n\n\n\npublic class ExceptionHandlingControllerAdvice {\n\n\n\n\n  @ExceptionHandler(UnauthorizedException.class)\n\n\n\n\n  public ResponseEntity handleUnauthorizedException(UnauthorizedException exception) {\n\n\n\n\n    String stackTrace = ExceptionUtils.getStackTrace(exception);\n\n\n\n\n    return new ResponseEntity(stackTrace, HttpStatus.FORBIDDEN); \n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n\nBy applying this patch, I believe Spring Data REST better fits the Spring MVC world.", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.0.RELEASE", "fixed_version": "2.1.5.RELEASE", "fixed_files": ["org.springframework.data.rest.core.event.AfterLinkDeleteEvent.java", "org.springframework.data.rest.core.event.AfterLinkSaveEvent.java", "org.springframework.data.rest.core.support.Methods.java", "org.springframework.data.rest.core.event.LinkSaveEvent.java", "org.springframework.data.rest.core.domain.jpa.PersonBeforeSaveHandler.java", "org.springframework.data.rest.core.annotation.RepositoryEventHandler.java", "org.springframework.data.rest.core.annotation.HandleBeforeLinkDelete.java", "org.springframework.data.rest.core.context.RepositoryEventIntegrationTests.java", "org.springframework.data.rest.core.annotation.HandleAfterLinkDelete.java", "org.springframework.data.rest.core.annotation.HandleBeforeDelete.java", "org.springframework.data.rest.core.annotation.HandleBeforeLinkSave.java", "org.springframework.data.rest.core.event.BeforeLinkSaveEvent.java", "org.springframework.data.rest.core.annotation.HandleBeforeCreate.java", "org.springframework.data.rest.core.event.AnnotatedHandlerBeanPostProcessor.java", "org.springframework.data.rest.core.annotation.HandleAfterCreate.java", "org.springframework.data.rest.core.util.UUIDConverter.java", "org.springframework.data.rest.core.annotation.HandleBeforeSave.java", "org.springframework.data.rest.core.event.BeforeLinkDeleteEvent.java", "org.springframework.data.rest.core.annotation.HandleAfterDelete.java", "org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.core.annotation.HandleAfterLinkSave.java", "org.springframework.data.rest.core.domain.jpa.AnnotatedPersonEventHandler.java", "org.springframework.data.rest.core.annotation.HandleAfterSave.java"], "label": 1, "es_results": []}, {"bug_id": 424, "bug_title": "Make sure HAL HttpMessageConverter is ordered before the standard one", "bug_description": "RepositoryRestMvcConfiguration registers two HttpMessageConverter beans handling ResourceSupport types. One is handling the HAL media type, the other all Spring Data REST specific media types. We have to make sure that depending on the settings of config().useHalAsDefaultJsonMediaType() one is registered before the other.", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.1.RELEASE", "fixed_version": "2.2.2.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.webmvc.config.RepositoryRestMvConfigurationIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 434, "bug_title": "PersistentEntityResourceHandlerMethodArgumentResolver's read() methods swallow exceptions", "bug_description": "", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.1.RELEASE", "fixed_version": "2.2.2.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.config.PersistentEntityResourceHandlerMethodArgumentResolver.java"], "label": 1, "es_results": []}, {"bug_id": 461, "bug_title": "@JsonIgnored properties must not be updated in PUT requests", "bug_description": "When issuing PUT requests for existing entities properties that are not mapped (e.g. using @JsonIgnore) must not be nulled out.", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.1.RELEASE", "fixed_version": "2.2.2.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.config.PersistentEntityResourceHandlerMethodArgumentResolver.java", "org.springframework.data.rest.webmvc.config.JsonPatchHandler.java", "org.springframework.data.rest.webmvc.json.DomainObjectReader.java"], "label": 1, "es_results": []}, {"bug_id": 485, "bug_title": "RepositoryPropertyReferenceController.createPropertyReference() does not work for empty content supplied on Spring 4.1", "bug_description": "Spring 4.1&apos;s RequestResponseBodyMethodProcessor rejects a request with an empty payload if a parameter annotated with @RequestBody is not configured to required = true. Even in this case it forcibly returns null so that a HandlerMethodArgumentResolver that could even deal with an empty payload is not even invoked.\nWe need to switch to required = false to not run into the rejection and manually default the Resources<Object> in case it&apos;s null", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.2.RELEASE", "fixed_version": "2.3.0.RC1", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryPropertyReferenceController.java"], "label": 1, "es_results": []}, {"bug_id": 502, "bug_title": "Not convenient to search a repository by a related entity using links", "bug_description": "It doesn&apos;t seem to be very convenient to search a repository using an related entity as a query parameter. Consider the following repository:\n\n\n\n\n\n\n@RepositoryRestResource\n\n\n\n\npublic interface TagRepository extends PagingAndSortingRepository<Tag, Long> {\n\n\n\n\n\n\n\n\n\n    Page<Tag> findAllByNameContainingIgnoreCaseAndOrganisationOrderByNameAsc(@Param(\"name\") String name,\n\n\n\n\n                                                                             @Param(\"organisation\") Organisation organisation,\n\n\n\n\n                                                                             Pageable pageable);\n\n\n\n\n}\n\n\n\n\n\n\nOrganisations have many tags, a tag has one organisation. The HATEOAS semantics return entity relationships as links, however we cannot pass one of these links as the \"organisation\" query parameter above.\nAs far as I can tell, the only way to pass an organisation parameter is by using the ID (primary key) of the entity directly. This is quite inconvenient as it means we need to resolve links on the client first in order to determine the ID we need and also means that we need to expose the IDs in our DTOs (which is not default and seems like a bad idea), or attempt to parse it from the URI link.\nThis is how I would expect it to be able to work:\nhttp://localhost:8080/api/tags/search/findAllByNameContainingIgnoreCaseAndOrganisationOrderByNameAsc?name=tagName&organisation=http://localhost:8080/api/organisations/1\nHowever we are currently required to use it like this:\nhttp://localhost:8080/api/tags/search/findAllByNameContainingIgnoreCaseAndOrganisationOrderByNameAsc?name=tagName&organisation=1\nIs this the only way to query using a related entity?", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.2.RELEASE", "fixed_version": "2.4.0.M1", "fixed_files": ["org.springframework.data.rest.webmvc.alps.AlpsControllerIntegrationTests.java", "org.springframework.data.rest.webmvc.RepositorySearchController.java", "org.springframework.data.rest.webmvc.json.PersistentEntityToJsonSchemaConverterUnitTests.java", "org.springframework.data.rest.webmvc.RepositorySearchControllerIntegrationTests.java", "org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.core.UriToEntityConverter.java", "org.springframework.data.rest.webmvc.jpa.BookRepository.java"], "label": 1, "es_results": []}, {"bug_id": 537, "bug_title": "Cannot remove an element of an array using JSON Patch request", "bug_description": "The ||JsonPatchHandler}} applies a customization to remove operations. Instead of removing the node, it replace it with a null object. It works well for objects, but it doesn&apos;t for elements of an array. The element won&apos;t be removed from the array, instead it will be replaced with a null object.\nI think if the path of the remove operation defines an element of an array, the original remove operation should be used instead of the customized ReplaceOperation.", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.2.RELEASE", "fixed_version": "2.4.0.M1", "fixed_files": ["org.springframework.data.rest.webmvc.config.JsonPatchHandlerUnitTests.java", "org.springframework.data.rest.webmvc.config.JsonPatchHandler.java"], "label": 1, "es_results": []}, {"bug_id": 556, "bug_title": "PUT/PATCH does not consider custom Jackson field naming strategy", "bug_description": "1. git clone https://github.com/spring-guides/gs-accessing-data-rest.git\n2. use spring.jackson.property-naming-strategy=PASCAL_CASE_TO_CAMEL_CASE\n3. PUT/PATCH fails.\norg.springframework.data.rest.webmvc.json.DomainObjectReader:170 will remove valid property names required by the objectMapper later on. \nIf one posts camelCase properties instead, the objectMapper will ignore them.\nPossible fix is to simply not remove properties so eagerly (Line 170) and let the objectMapper decide.\n", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.2.RELEASE", "fixed_version": "2.4.0.M1", "fixed_files": ["org.springframework.data.rest.webmvc.json.DomainObjectReaderUnitTests.java", "org.springframework.data.rest.webmvc.json.DomainObjectReader.java"], "label": 1, "es_results": []}, {"bug_id": 597, "bug_title": "AlpsController not working on Spring 4.2", "bug_description": "", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.2.RELEASE", "fixed_version": "2.4.0.RC1", "fixed_files": ["org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.webmvc.alps.AlpsJsonHttpMessageConverter.java", "org.springframework.data.rest.webmvc.config.RepositoryRestMvConfigurationIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 599, "bug_title": "findBy + @Param expects an Id, which is not visible via REST", "bug_description": "Hi,\nhere is another issue I came across while trying out Spring Data REST: \nIDs are, if I&apos;m correct, intentionally not exposed in the resource body, as you&apos;re supposed to use the URL as primary identifier. \nThis is a problem, because by exposing a repository finder Spring Data REST expects me to put the primary key as query param.\nI put up a small example on github:\nhttps://github.com/otrosien/spring-data-examples/tree/findQueryParamMismatch\nThis is the interesting part: How am I, as REST client, suppose to fill the query param for customer1?\n\n\n\n\n\n\npublic interface RelationshipRepository extends PagingAndSortingRepository<Relationship, Long> {\n\n\n\n\n Page<Relationship> findByCustomer1(@Param(\"customer1\") Customer customer1, Pageable pageable);\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.2.RELEASE", "fixed_version": "2.4.0.M1", "fixed_files": ["org.springframework.data.rest.webmvc.alps.AlpsControllerIntegrationTests.java", "org.springframework.data.rest.webmvc.RepositorySearchController.java", "org.springframework.data.rest.webmvc.json.PersistentEntityToJsonSchemaConverterUnitTests.java", "org.springframework.data.rest.webmvc.RepositorySearchControllerIntegrationTests.java", "org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.core.UriToEntityConverter.java", "org.springframework.data.rest.webmvc.jpa.BookRepository.java"], "label": 1, "es_results": []}, {"bug_id": 423, "bug_title": "Spring Data REST registered ConversionService not used when overriding individual resources", "bug_description": "I have a business object User and in my application I have to set property active to false when deleting User.\nI don&apos;t want to expose my business logic on REST model so I wanted to override DELETE /user/{id} behavior to patch user to set active to false.\nIn order to achieve that I write my own controller with following piece of code:\n\n\n\n\n\n\n@RepositoryRestController\n\n\n\n\n@ResponseBody\n\n\n\n\n@RequestMapping(\"/users\")\n\n\n\n\npublic class UserController {\n\n\n\n\n\n\n\n\n\n    @Inject\n\n\n\n\n    private UserService userService;\n\n\n\n\n\n\n\n\n\n    @ResponseStatus(value = HttpStatus.NO_CONTENT)\n\n\n\n\n    @RequestMapping(method = RequestMethod.DELETE, value = \"/{user}\")\n\n\n\n\n    public void delete(@PathVariable(\"user\") User user) {\n\n\n\n\n        user.setActive(false);\n\n\n\n\n        userService.save(user);\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nMethod is correctly called but I get an org.springframework.beans.ConversionNotSupportedException...\nSo I tried to add a custom converter (String -> User) like describe here: http://docs.spring.io/spring-data/rest/docs/1.1.0.M1/reference/htmlsingle/#d4e110\nBut the converter is never called.\nWhen debugging I saw that https://github.com/spring-projects/spring-framework/blob/master/spring-beans/src/main/java/org/springframework/beans/TypeConverterDelegate.java#L169 is NULL that why my converter is not called.\nI will try to find more and create PR if possible but atm I don&apos;t have more information.", "project": "Spring", "sub_project": "DATAREST", "version": "2.3.0.M1", "fixed_version": "2.2.2.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.webmvc.jpa.JpaWebTests.java"], "label": 1, "es_results": []}, {"bug_id": 448, "bug_title": "RepositoryRestHandlerMapping is handling non-repository requests", "bug_description": "The fix for DATAREST-429 has introduced a regression of RepositoryRestHandlerMapping not verifying the repositoryLookupPath actually pointing to a repository in the first place.", "project": "Spring", "sub_project": "DATAREST", "version": "2.3.0.M1", "fixed_version": "2.3.0.RC1", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryRestHandlerMappingUnitTests.java", "org.springframework.data.rest.webmvc.RepositoryRestHandlerMapping.java", "org.springframework.data.rest.webmvc.CommonWebTests.java"], "label": 1, "es_results": []}, {"bug_id": 492, "bug_title": "JSON Schema reports primitive numbers as object", "bug_description": "A type like this:\n\n{class:java}\nclass Sample {\n\n  double foo;\n}{class}\n\nyields a JSON Schema document of:\n\n\n\n\n\n\n{\n\n\n\n\n  \"foo\" : {\n\n\n\n\n    \"type\" : \"object\"\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREST", "version": "2.3.0.RC1", "fixed_version": "2.2.3.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.json.JsonSchema.java"], "label": 1, "es_results": []}, {"bug_id": 500, "bug_title": "Rendering of lazy-loading proxies fails", "bug_description": "Problem is that the nested lazy loading proxy is not unpacked correctly, see the linked example project for further details.\nThe code in \n\n\n\n\n\norg.springframework.data.rest.webmvc.RepositoryPropertyReferenceController.doWithReferencedProperty(RootResourceInformation, Serializable, String, Function<ReferencedProperty, ResourceSupport>, HttpMethod)\n\n\n\n\nPersistentEntity<?, ?> persistentEntity = repoRequest.getPersistentEntity();\n\n\n\n\nPersistentProperty<?> prop = persistentEntity.getPersistentProperty(propertyPath);\n\n\n\n\n...\n\n\n\n\nPersistentPropertyAccessor accessor = persistentEntity.getPropertyAccessor(domainObj);\n\n\n\n\nObject propVal = accessor.getProperty(prop);\n\n\n\n\n\n\ntraverses the product property of the Category which returns the proxied version of the product instance. This instance cannot be serialized. We have to find a way to unwrap that proxy (probably still in JPA) or make it somehow serializable (in a way that works for other proxy mechanisms too...)\nThe test case: shouldBeAbleToResolveLazyLoadingProxyForProductInCategory demonstrates the problem.", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.3.RELEASE", "fixed_version": "2.4.0.M1", "fixed_files": ["org.springframework.data.rest.webmvc.json.Jackson2DatatypeHelper.java"], "label": 1, "es_results": []}, {"bug_id": 519, "bug_title": "RepositoryEntityLinks does not populate search resource URIs with Pageable and Sorts", "bug_description": "", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.3.RELEASE", "fixed_version": "2.4.0.M1", "fixed_files": ["org.springframework.data.rest.webmvc.support.RepositoryEntityLinksIntegrationTests.java", "org.springframework.data.rest.webmvc.support.RepositoryEntityLinks.java"], "label": 1, "es_results": []}, {"bug_id": 581, "bug_title": "ETag getVersionInformation fails with proxied Entities for projections", "bug_description": "See the reference GitHub project.\nI&apos;ve got an @Entity with a @Version&apos;ed field, a @Projection, and a Repository. When I try to GET the projection of a single entry, I get a 500 Internal server error, because of a failed assertion in BasicPersistentEntity line 394, as called from Etag line 191:\n> Assert.isTrue(getType().isInstance(bean), \"Target bean is not of type of the persistent entity!\");\nThe argument bean here is of type $Proxy90 / JdkDynamicAopProxy, not Book.\nThe projection only works again when the @Version annotation is removed. This is since Fowler, as I had no such issues with Evans.", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.3.RELEASE", "fixed_version": "2.3.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryEntityControllerIntegrationTests.java", "org.springframework.data.rest.webmvc.RepositoryEntityController.java", "org.springframework.data.rest.webmvc.jpa.Address.java"], "label": 1, "es_results": []}, {"bug_id": 617, "bug_title": "Requests with Accept header of application/*+json return the compact representation", "bug_description": "As the controller methods handling the compact representation use an explicit produces clause in the request mapping, they get favored when the client sends Accept: application/*+json.\nWe should tweak the default mappings to implicitly match this situation.", "project": "Spring", "sub_project": "DATAREST", "version": "2.3.1.RELEASE", "fixed_version": "2.3.2.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryRestHandlerMapping.java", "org.springframework.data.rest.webmvc.config.LegacyRepresentationConfigIntegrationTests.java", "org.springframework.data.rest.webmvc.BasePathAwareHandlerMapping.java"], "label": 1, "es_results": []}, {"bug_id": 655, "bug_title": "Typo in exception message in parameter checks for ParameterMetadata", "bug_description": "", "project": "Spring", "sub_project": "DATAREST", "version": "2.3.2.RELEASE", "fixed_version": "2.2.4.RELEASE", "fixed_files": ["org.springframework.data.rest.core.mapping.ParameterMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 662, "bug_title": "Unable to post entity with subclassed property (JPA)", "bug_description": "Given these entities:\n\n\n\n\n\n\nstatic class PetOwner {\n\n\n\n\n    private Pet pet;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n@JsonTypeInfo(include = JsonTypeInfo.As.PROPERTY, use = JsonTypeInfo.Id.MINIMAL_CLASS)\n\n\n\n\nstatic class Pet {}\n\n\n\n\nstatic class Cat extends Pet {}\n\n\n\n\n\n\nSubmitting a post like\n\n\n\n\n\n\ncurl -d &apos;{\"pet\" : \"http://localhost:8080/pets/1\"}&apos; -H &apos;Content-Type: application/json&apos; &apos;http://localhost:8080/petOwners/&apos;\n\n\n\n\n\n\nfails, because Jackson will try and deserialize \"with type\".", "project": "Spring", "sub_project": "DATAREST", "version": "2.3.2.RELEASE", "fixed_version": "2.2.4.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java", "org.springframework.data.rest.webmvc.json.PersistentEntityJackson2ModuleUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 665, "bug_title": "Use consistent scheme for property titles in JSON Schema", "bug_description": "", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.4.RELEASE", "fixed_version": "2.4.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.json.PersistentEntityToJsonSchemaConverter.java", "org.springframework.data.rest.webmvc.json.JsonSchema.java", "org.springframework.data.rest.webmvc.json.PersistentEntityToJsonSchemaConverterUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 699, "bug_title": "On Java 8, link templates to search resources using pagination contain pageable variable", "bug_description": "When using Java 8 with parameter name discovery added, the links pointing to search methods using a Pageable contain a pageable URI template variable. This is caused by the RepositoryMethodResourceMapping only dropping parameters without names (assuming Pageable and Sort were never annotated with @Param).\nWe should explicitly exclude parameters of these types from being exposed as explicit search method parameters.", "project": "Spring", "sub_project": "DATAREST", "version": "2.3.2.RELEASE", "fixed_version": "2.4.1.RELEASE", "fixed_files": ["org.springframework.data.rest.core.mapping.RepositoryMethodResourceMapping.java", "org.springframework.data.rest.core.mapping.RepositoryMethodResourceMappingUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 683, "bug_title": "ALPS profile does not reflect jackson customization (e.g. enableEnumTranslation=true)", "bug_description": "Found while trying to document the enums of my REST API with ALPS.\nSee example including failing test here: https://github.com/otrosien/spring-alps-bug\nThe alps profile starts like below, but seems like it uses a differently configured jackson mapper, as the main one is configured to \"enableEnumTranslation\" (\"Payment expected\" instead of \"PAYMENT_EXPECTED\").\n\n\n\n\n\n\n{\n\n\n\n\n  \"version\" : \"1.0\",\n\n\n\n\n  \"descriptors\" : [ {\n\n\n\n\n    \"id\" : \"order-representation\",\n\n\n\n\n    \"href\" : \"http://localhost/profile/orders\",\n\n\n\n\n    \"descriptors\" : [ {\n\n\n\n\n      \"name\" : \"status\",\n\n\n\n\n      \"doc\" : {\n\n\n\n\n        \"value\" : \"PAYMENT_EXPECTED, PAID\",\n\n\n\n\n        \"format\" : \"TEXT\"\n\n\n\n\n      },\n\n\n\n\n      \"type\" : \"SEMANTIC\"\n\n\n\n\n    } ]\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.4.RELEASE", "fixed_version": "2.4.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.alps.RootResourceInformationToAlpsDescriptorConverter.java", "org.springframework.data.rest.webmvc.alps.AlpsControllerIntegrationTests.java", "org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java", "org.springframework.data.rest.webmvc.alps.AlpsJsonHttpMessageConverter.java", "org.springframework.data.rest.webmvc.jpa.Person.java"], "label": 1, "es_results": []}, {"bug_id": 690, "bug_title": "Invalid JSON Schema for properties pointing to association resources", "bug_description": "I am using a Spring Data REST version of Spring Boot&apos;s PetClinic application for playing around with the JSON Schema support. I noticed the following:\nA property which represents a one-to-many association is of type string and format uri. However, it also contains the properties uniqueItems and items, which, according to the JSON Schema validation docs, only exist for array types. Below is an excerpt of the JSON Schema for the Owner class:\n\n\n\n\n\n\n{\n\n\n\n\n  \"title\": \"Owner\",\n\n\n\n\n  \"properties\": {\n\n\n\n\n    \"pets\": {\n\n\n\n\n      \"title\": \"Pets\",\n\n\n\n\n      \"readOnly\": false,\n\n\n\n\n      \"type\": \"string\",\n\n\n\n\n      \"format\": \"uri\",\n\n\n\n\n      \"uniqueItems\": true,\n\n\n\n\n      \"items\": {\n\n\n\n\n        \"type\": \"object\"\n\n\n\n\n      }\n\n\n\n\n    },\n\n\n\n\n    ...\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n\nI think the correct representation would be the following, do you agree?\n\n\n\n\n\n\n{\n\n\n\n\n  \"title\": \"Owner\",\n\n\n\n\n  \"properties\": {\n\n\n\n\n    \"pets\": {\n\n\n\n\n      \"title\": \"Pets\",\n\n\n\n\n      \"readOnly\": false,\n\n\n\n\n      \"type\": \"array\",\n\n\n\n\n      \"uniqueItems\": true,\n\n\n\n\n      \"items\": {\n\n\n\n\n        \"type\": \"string\",\n\n\n\n\n        \"format\": \"uri\"\n\n\n\n\n      }\n\n\n\n\n    },\n\n\n\n\n    ...\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.4.RELEASE", "fixed_version": "2.4.1.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.json.PersistentEntityToJsonSchemaConverter.java", "org.springframework.data.rest.webmvc.json.JsonSchema.java", "org.springframework.data.rest.webmvc.json.PersistentEntityToJsonSchemaConverterUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 705, "bug_title": "Cannot PUT versioned entity returned by spring-data-rest", "bug_description": "I would expect it to be possible to execute PUT by simply supplying all fields returned by GET. However, this is currently broken as a consequence of DATAREST-160. \nNow when an entity is exposed via REST API (either as part of a list, or directly), it&apos;s returned without version property. However, when PUT operation is performed, version property can be required, since the whole entity is persisted (as opposed to PATCH logic where only changed fields need to be supplied). This is true, for example, for JPA, which will check version and refuse updating if version is missing.\nThis means that REST API client is expected to send a property that it never received. In fact, the client might not even be aware that such property exists, how it&apos;s called, and what value it should contain.", "project": "Spring", "sub_project": "DATAREST", "version": "2.2.4.RELEASE", "fixed_version": "2.4.2.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.json.DomainObjectReaderUnitTests.java", "org.springframework.data.rest.webmvc.json.DomainObjectReader.java"], "label": 1, "es_results": []}, {"bug_id": 565, "bug_title": "Hal Browser does not seem to work with spring boot with a non-default context-path", "bug_description": "if i have server.contextpath=foo in my application.properties \nand i go to localhost:8080/foo/ i am redirected to localhost:8080/browser/index.html which is 404. It if i navigate to: localhost:8080/foo/browser/index.html it also redirects me to that same place. \nHal Browser needs to take context path into account.", "project": "Spring", "sub_project": "DATAREST", "version": "2.4.0.M1", "fixed_version": "2.4.0.RC1", "fixed_files": ["org.springframework.data.rest.webmvc.halbrowser.HalBrowser.java"], "label": 1, "es_results": []}, {"bug_id": 847, "bug_title": "RepositoryEntityController.saveAndReturn calls AfterSaveEvent with wrong domain object", "bug_description": "The saveAndReturn method has the following code to handle the Repository Event logic.\n\n\n\n\n\n\npublisher.publishEvent(new BeforeSaveEvent(domainObject));\n\n\n\n\nObject obj = invoker.invokeSave(domainObject);\n\n\n\n\npublisher.publishEvent(new AfterSaveEvent(domainObject));\n\n\n\n\n\n\nbut I think this is wrong. It is using the provided domainObject for the AfterSaveEvent, instead of the obj returned by the invoker. From what I can tell, the expectation is that the After events should be supplied the object with its current state (i.e. after the change has been applied). This is further born out by the behavior of the createAndReturn method, which uses:\n\n\n\n\n\n\npublisher.publishEvent(new BeforeCreateEvent(domainObject));\n\n\n\n\nObject savedObject = invoker.invokeSave(domainObject);\n\n\n\n\npublisher.publishEvent(new AfterCreateEvent(savedObject));\n\n\n\n\n\n\nHere it is using the returned object (savedObject in this case). This gets even more confusing in the case of a REST PUT call, since that method first determines if the request should create a new item or update an existing item. Granted, since the contract of PUT is to always supply a complete object, the impact is less then a PATCH case, if one is using Generated fields or has EntityListeners that affect the object, those changes would be hidden to the AfterSaveEvent.", "project": "Spring", "sub_project": "DATAREST", "version": "2.3.2.RELEASE", "fixed_version": "2.6.0.M1", "fixed_files": ["org.springframework.data.rest.webmvc.RepositoryEntityController.java"], "label": 1, "es_results": []}, {"bug_id": 716, "bug_title": "Rest Endpoints produce HttpMessageNotWritableException sometimes after restarts", "bug_description": "In some cases after application start some rest repositories fail to handle the http request and throw a HttpMessageNotWritableException (see StackOverflow reference)\n\n\n\n\n\n\n2015-11-27 09:56:19.015  WARN 1207 --- [nio-9000-exec-9] .w.s.m.s.DefaultHandlerExceptionResolver : Failed to write HTTP message: org.springframework.http.converter.HttpMessageNotWritableException: Could not write content: org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module$ProjectionResourceContentSerializer cannot be cast to com.fasterxml.jackson.databind.ser.impl.UnwrappingBeanSerializer (through reference chain: org.springframework.hateoas.PagedResources[\"_embedded\"]->java.util.UnmodifiableMap[\"permissions\"]->java.util.ArrayList[0]->org.springframework.data.rest.webmvc.json.ProjectionResource[\"content\"]); nested exception is com.fasterxml.jackson.databind.JsonMappingException: org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module$ProjectionResourceContentSerializer cannot be cast to com.fasterxml.jackson.databind.ser.impl.UnwrappingBeanSerializer (through reference chain: org.springframework.hateoas.PagedResources[\"_embedded\"]->java.util.UnmodifiableMap[\"permissions\"]->java.util.ArrayList[0]->org.springframework.data.rest.webmvc.json.ProjectionResource[\"content\"])\n\n\n\n\n2015-11-27 09:56:19.024  WARN 1207 --- [nio-9000-exec-2] .w.s.m.s.DefaultHandlerExceptionResolver : Failed to write HTTP message: org.springframework.http.converter.HttpMessageNotWritableException: Could not write content: org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module$ProjectionResourceContentSerializer cannot be cast to com.fasterxml.jackson.databind.ser.impl.UnwrappingBeanSerializer (through reference chain: org.springframework.hateoas.PagedResources[\"_embedded\"]->java.util.UnmodifiableMap[\"userroles\"]->java.util.ArrayList[0]->org.springframework.data.rest.webmvc.json.ProjectionResource[\"content\"]); nested exception is com.fasterxml.jackson.databind.JsonMappingException: org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module$ProjectionResourceContentSerializer cannot be cast to com.fasterxml.jackson.databind.ser.impl.UnwrappingBeanSerializer (through reference chain: org.springframework.hateoas.PagedResources[\"_embedded\"]->java.util.UnmodifiableMap[\"userroles\"]->java.util.ArrayList[0]->org.springframework.data.rest.webmvc.json.ProjectionResource[\"content\"])\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREST", "version": "2.4.1.RELEASE", "fixed_version": "2.4.2.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java", "org.springframework.data.rest.webmvc.json.PersistentEntitySerializationTests.java"], "label": 1, "es_results": []}, {"bug_id": 743, "bug_title": "Rest Endpoints produce HttpMessageNotWritableException sometimes after restarts", "bug_description": "Occasionally, the application throws a HttpMessageNotWritableException on start up.  See #DATAREST-716.  It appears this is still happening in Gosling SR2 (Spring Boot 1.3.1).\n\n\n\n\n\n\n2016-01-06 19:27:54.639  INFO 1783 --- [ost-startStop-1] o.a.catalina.util.SessionIdGenerator     : Creation of SecureRandom instance for session ID generation using [SHA1PRNG] took [9,898] milliseconds.\n\n\n\n\nJan 06, 2016 7:27:54 PM org.apache.coyote.AbstractProtocol start\n\n\n\n\nINFO: Starting ProtocolHandler [\"http-bio-8080\"]\n\n\n\n\nJan 06, 2016 7:27:54 PM org.apache.coyote.AbstractProtocol start\n\n\n\n\nINFO: Starting ProtocolHandler [\"ajp-bio-8009\"]\n\n\n\n\nJan 06, 2016 7:27:54 PM org.apache.catalina.startup.Catalina start\n\n\n\n\nINFO: Server startup in 59514 ms\n\n\n\n\nJan 06, 2016 7:27:54 PM org.apache.catalina.core.ApplicationContext log\n\n\n\n\nINFO: Initializing Spring FrameworkServlet &apos;dispatcherServlet&apos;\n\n\n\n\n2016-01-06 19:27:54.817  INFO 1783 --- [bio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : FrameworkServlet &apos;dispatcherServlet&apos;: initialization started\n\n\n\n\n2016-01-06 19:27:54.854  INFO 1783 --- [bio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : FrameworkServlet &apos;dispatcherServlet&apos;: initialization completed in 28 ms\n\n\n\n\n2016-01-06 19:27:58.029  WARN 1783 --- [io-8080-exec-11] .w.s.m.s.DefaultHandlerExceptionResolver : Failed to write HTTP message: org.springframework.http.converter.HttpMessageNotWritableException: Could not write content: org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module$ProjectionResourceContentSerializer cannot be cast to com.fasterxml.jackson.databind.ser.impl.UnwrappingBeanSerializer (through reference chain: org.springframework.hateoas.PagedResources[\"_embedded\"]->java.util.UnmodifiableMap[\"activities\"]->java.util.ArrayList[0]->org.springframework.data.rest.webmvc.json.ProjectionResource[\"content\"]); nested exception is com.fasterxml.jackson.databind.JsonMappingException: org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module$ProjectionResourceContentSerializer cannot be cast to com.fasterxml.jackson.databind.ser.impl.UnwrappingBeanSerializer (through reference chain: org.springframework.hateoas.PagedResources[\"_embedded\"]->java.util.UnmodifiableMap[\"activities\"]->java.util.ArrayList[0]->org.springframework.data.rest.webmvc.json.ProjectionResource[\"content\"])\n\n\n\n\n\n", "project": "Spring", "sub_project": "DATAREST", "version": "2.4.2.RELEASE", "fixed_version": "2.5.0.M1", "fixed_files": ["org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java"], "label": 1, "es_results": []}, {"bug_id": 747, "bug_title": "ProjectionDefinitionConfiguration does not select projection for most concrete type", "bug_description": "If two projections of the same name are registered for an inheritance hierarchy, the current projection selection algorithm doesn&apos;t necessarily prefer the projection defined for the most concrete type.", "project": "Spring", "sub_project": "DATAREST", "version": "2.4.2.RELEASE", "fixed_version": "2.5.0.M1", "fixed_files": ["org.springframework.data.rest.core.config.ProjectionDefinitionConfiguration.java", "org.springframework.data.rest.core.config.ProjectionDefinitionConfigurationUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 798, "bug_title": "Nested validation errors reported as top level ones ", "bug_description": "ValidationErrors doesn&apos;t consider the nested path of fields correctly.", "project": "Spring", "sub_project": "DATAREST", "version": "2.4.4.RELEASE", "fixed_version": "2.5.0.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.support.RepositoryConstraintViolationExceptionMessage.java", "org.springframework.data.rest.core.context.ValidatorIntegrationTests.java", "org.springframework.data.rest.core.event.ValidatingRepositoryEventListener.java", "org.springframework.data.rest.core.ValidationErrors.java"], "label": 1, "es_results": []}, {"bug_id": 805, "bug_title": "RepositoryConstraintViolationExceptionMessage produces inaccurate output", "bug_description": "The invalidValue field of RepositoryConstraintViolationExceptionMessage.ValidationError is a string even if the failed member is of another type because it is being string formatted. By maintaining the original type we allow better debugging by expressing more closely the true type input and not just its toString()  and also allow the original marshaller/unmarshaller to express the object as is more appropriate. \nExample input:\n\n\n\n\n\n\n{\n\n\n\n\n    \"givenName\" : \"null\",\n\n\n\n\n    \"familyName\" : \"Bongiorno\",\n\n\n\n\n    \"dob\" : \"2007-12-03\",\n\n\n\n\n    \"nationalId\" : \"12345687\",\n\n\n\n\n    \"photo\" : null\n\n\n\n\n    \n\n\n\n\n}\n\n\n\n\n\n\nor\n\n\n\n\n\n\n{\n\n\n\n\n    \"givenName\" : null,\n\n\n\n\n    \"familyName\" : \"Bongiorno\",\n\n\n\n\n    \"dob\" : \"2007-12-03\",\n\n\n\n\n    \"nationalId\" : \"12345687\",\n\n\n\n\n    \"photo\" : null\n\n\n\n\n    \n\n\n\n\n}\n\n\n\n\n\n\nexample output\n\n\n\n\n\n\n{\n\n\n\n\n    \"errors\": [\n\n\n\n\n        {\n\n\n\n\n            \"entity\": \"Worker\",\n\n\n\n\n            \"message\": \"may not be null\",\n\n\n\n\n            \"invalidValue\": \"null\",\n\n\n\n\n            \"property\": \"givenName\"\n\n\n\n\n        }\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n\nEntity:\n\n\n\n\n\n\n@Entity\n\n\n\n\npublic class Worker {\n\n\n\n\n\n\n\n\n\n    @Id\n\n\n\n\n    private Long id;\n\n\n\n\n\n\n\n\n\n    @NotNull\n\n\n\n\n    @Pattern(regexp = \"[^null]\", message = \"may not be null\")\n\n\n\n\n    private String givenName;\n\n\n\n\n\n\n\n\n\n    @NotNull\n\n\n\n\n    private String familyName;\n\n\n\n\n\n\n\n\n\n    private LocalDate dob;\n\n\n\n\n\n\n\n\n\n    private String nationalId;\n\n\n\n\n\n\n\n\n\n    private byte[] photo;\n\n\n\n\n}\n\n\n\n\n\n\nI intentionally added a silly validation constraint to demonstrate", "project": "Spring", "sub_project": "DATAREST", "version": "2.4.4.RELEASE", "fixed_version": "2.5.2.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.support.RepositoryConstraintViolationExceptionMessage.java"], "label": 1, "es_results": []}, {"bug_id": 863, "bug_title": "REST calls to /api always redirect to HAL Browser if no accept header is specified", "bug_description": "After updating 2 projects to Spring Boot 1.4 (and Spring Data Rest 2.5.2) all REST calls to /api  that don&apos;t specify a header like \"accept: application/json\" redirect to /api/browser/index.html#/api/. In previous versions this was only the case when the accept header was text/html, but now the redirect happens with empty accept header.\nThis may have nothing to do with Spring Data Rest directly, I just put it here because HAL Browser is involved.\nBut as a result, the default HAL browser itself cannot get the /api and shows its own index.html.", "project": "Spring", "sub_project": "DATAREST", "version": "2.4.4.RELEASE", "fixed_version": "2.4.5.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.BasePathAwareHandlerMapping.java", "org.springframework.data.rest.webmvc.halbrowser.HalBrowserIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 791, "bug_title": "Repository with EntityLookup not resolving for POST on an Association-Ressource", "bug_description": "POST /user/olivergierke/friends\ncontent-type: text/uri-list\ncontent: /person/\n{username}\n(username=asterix, user_Id=12345)\nGenerate SQL with \"user_ID\" in where-Clause, but the \"username\" as param.\nselect person.user_id as user_id,  ... , person.username as username\nfrom persontable person\nwhere person.user_id=&apos;asterix&apos;\nURI for User-Resource \"asterix\" is /person/asterix\nUsing the person/12345 instead of person/asterix as paylod works fine, but  that is not as intended.\n(see config.withEntityLookup().forRepository(PersonRepository.class, Person::getUsername, PersonRepository::findByUsername)\nOtherwise, following example works fine:\nPATCH /user/olivergierke/\n{\"friends\": [ \"/person/asterix\" ]}\n\n\n(see https://jira.spring.io/browse/DATAREST-724)", "project": "Spring", "sub_project": "DATAREST", "version": "2.5.0.RC1", "fixed_version": "2.5.0.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.AbstractRepositoryRestController.java", "org.springframework.data.rest.webmvc.RepositorySearchController.java", "org.springframework.data.rest.webmvc.RepositoryEntityController.java", "org.springframework.data.rest.webmvc.RepositoryPropertyReferenceController.java", "org.springframework.data.rest.webmvc.RepositoryController.java"], "label": 1, "es_results": []}, {"bug_id": 937, "bug_title": "Transient properties in JSON should be included in merge", "bug_description": "When using the repository domain object update end point (via the PATCH method with JSON data), fields that are not persisted (marked as @Transient or simply not marked for persistence) are not updated.\nFor example, given this class:\n\n\n\n\n\n\n@JsonAutoDetect(fieldVisibility = Visibility.ANY)\n\n\n\n\nstatic class SampleWithTransient {\n\n\n\n\n\n\n\n\n\n\tString name;\n\n\n\n\n\t@org.springframework.data.annotation.Transient String temporary;\n\n\n\n\n}\n\n\n\n\n\n\nif an HTTP PATCH is done to update that object with this request body:\n\n\n\n\n\n\n{\n\n\n\n\n  \"temporary\": \"new temp\"\n\n\n\n\n}\n\n\n\n\n\n\nthe result will be that the value of temporary was not changed to \"new temp\" as expected.", "project": "Spring", "sub_project": "DATAREST", "version": "2.4.6.RELEASE", "fixed_version": "2.6.0.RC1", "fixed_files": ["org.springframework.data.rest.webmvc.json.DomainObjectReaderUnitTests.java", "org.springframework.data.rest.webmvc.json.DomainObjectReader.java"], "label": 1, "es_results": []}, {"bug_id": 815, "bug_title": "HAL browser redirect fails when proxied through Zuul", "bug_description": "I have an app called viewer with little more than @SpringBootApplication & @EnableEurekaClient that has spring-data-rest-hal-browser:2.5.1.RELEASE on it&apos;s classpath, along with spring cloud Brixton.RC2 dependencies. application.yml only holds the spring.application.name, no context-path. This app connects to a eureka instance and is routed through a Zuul proxy, both also running Brixton.RC2. The Zuul proxy automatically routes /viewer to the backend service.\nWhen I open the root URL from whatever port the viewer app is running on, I&apos;m correctly redirected to /browser/index.html#.\nWhen I open the root URL through my separate Zuul proxy, I&apos;m again redirected to /browser/index.html#, but that fails because the /viewer x-forwarded-prefix header is ignored. Here&apos;s a sample response from the actuator /trace page:\n\n\n\n\n\n\n{\n\n\n\n\n  \"timestamp\": 1461596698378,\n\n\n\n\n  \"info\": {\n\n\n\n\n    \"method\": \"GET\",\n\n\n\n\n    \"path\": \"/\",\n\n\n\n\n    \"headers\": {\n\n\n\n\n      \"request\": {\n\n\n\n\n        \"accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\",\n\n\n\n\n        \"upgrade-insecure-requests\": \"1\",\n\n\n\n\n        \"user-agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36\",\n\n\n\n\n        \"dnt\": \"1\",\n\n\n\n\n        \"accept-language\": \"en-US,en;q=0.8,nl;q=0.6\",\n\n\n\n\n        \"cookie\": \"JSESSIONID=\",\n\n\n\n\n        \"x-forwarded-host\": \"canary.company.nl\",\n\n\n\n\n        \"x-forwarded-proto\": \"https\",\n\n\n\n\n        \"x-forwarded-prefix\": \"/viewer\",\n\n\n\n\n        \"x-forwarded-port\": \"443\",\n\n\n\n\n        \"connection\": \"Keep-Alive\",\n\n\n\n\n        \"accept-encoding\": \"gzip\",\n\n\n\n\n        \"transfer-encoding\": \"chunked\",\n\n\n\n\n        \"host\": \"canary.company.nl:56260\"\n\n\n\n\n      },\n\n\n\n\n      \"response\": {\n\n\n\n\n        \"X-Application-Context\": \"viewer:0\",\n\n\n\n\n        \"Location\": \"https://canary.company.nl/browser/index.html#\",\n\n\n\n\n        \"status\": \"302\"\n\n\n\n\n      }\n\n\n\n\n    }\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n\nAs you can see the Location header does not include the /viewer prefix. Opening /viewer/browser/index.html#/ directly works as expected.", "project": "Spring", "sub_project": "DATAREST", "version": "2.5.1.RELEASE", "fixed_version": "2.5.2.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.halbrowser.HalBrowser.java", "org.springframework.data.rest.webmvc.halbrowser.HalBrowserUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 880, "bug_title": "@JsonUnwrapped annotation ignored", "bug_description": "Using Spring Boot 1.4.0, Spring Data REST no longer seems to take the @JsonUnwrapped annotation into account to unwrap entities in the JSON responses. The previous Spring Boot versions (i.c. 1.3.7) does not have this problem.\nIt can be easily reproduced on the master branch of the RestBucks project. When you PUT a payment for an order, the credit card number should be unwrapped, since it is annotated with @JsonUnwrapped, but it is not:\n\n\n\n\n\n\n{\n\n\n\n\n  \"amount\": \"EUR4.20\",\n\n\n\n\n  \"creditCard\": {\n\n\n\n\n    \"number\": {\n\n\n\n\n      \"number\": \"1234123412341234\"\n\n\n\n\n    },\n\n\n\n\n    \"cardHolderName\": \"Oliver Gierke\",\n\n\n\n\n    \"expirationDate\": \"2099-12-01\"\n\n\n\n\n  },\n\n\n\n\n  \"_links\": {\n\n\n\n\n    \"restbucks:order\": {\n\n\n\n\n      \"href\": \"http://localhost:8080/orders/1{?projection}\",\n\n\n\n\n      \"templated\": true,\n\n\n\n\n      \"title\": \"An order\"\n\n\n\n\n    },\n\n\n\n\n    \"curies\": [\n\n\n\n\n      {\n\n\n\n\n        \"href\": \"http://localhost:8080/docs/{rel}.html\",\n\n\n\n\n        \"name\": \"restbucks\",\n\n\n\n\n        \"templated\": true\n\n\n\n\n      }\n\n\n\n\n    ]\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n\nThe expected output would be (if the @JsonUnwrapped annotation was parsed correctly):\n\n\n\n\n\n\n{\n\n\n\n\n  \"amount\": \"EUR4.20\",\n\n\n\n\n  \"creditCard\": {\n\n\n\n\n    \"number\": \"1234123412341234\",\n\n\n\n\n    \"cardHolderName\": \"Oliver Gierke\",\n\n\n\n\n    \"expirationDate\": \"2099-12-01\"\n\n\n\n\n  },\n\n\n\n\n  \"_links\": {\n\n\n\n\n    \"restbucks:order\": {\n\n\n\n\n      \"href\": \"http://localhost:8080/orders/1{?projection}\",\n\n\n\n\n      \"templated\": true,\n\n\n\n\n      \"title\": \"An order\"\n\n\n\n\n    },\n\n\n\n\n    \"curies\": [\n\n\n\n\n      {\n\n\n\n\n        \"href\": \"http://localhost:8080/docs/{rel}.html\",\n\n\n\n\n        \"name\": \"restbucks\",\n\n\n\n\n        \"templated\": true\n\n\n\n\n      }\n\n\n\n\n    ]\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n\nThis looks like a Spring Data REST bug. Spring Boot 1.3.x uses Spring Data Gosling and @JsonUnwrapped works as expected. However if spring-data-releasetrain.version is overriden to use Spring Data Hopper @JsonUnwrapped no longer works. You can see this behaviour if you check out and run this commit in RestBucks.", "project": "Spring", "sub_project": "DATAREST", "version": "2.5.2.RELEASE", "fixed_version": "2.5.3.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.jpa.CreditCard.java", "org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java", "org.springframework.data.rest.webmvc.json.PersistentEntitySerializationTests.java"], "label": 1, "es_results": []}, {"bug_id": 866, "bug_title": "NullPointerException from RepositoryRestConfiguration if you inject mvcValidator into RepositoryRestConfigurer", "bug_description": "Hopper release throws a null-pointer exception when you inject \"mvcValidator\" in your RepositoryRestConfigurer.", "project": "Spring", "sub_project": "DATAREST", "version": "2.5.2.RELEASE", "fixed_version": "2.5.3.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 864, "bug_title": "NestedEntitySerializer does not support Maps", "bug_description": "With the latest Hopper-SR2 I get the following error:\n\n\n\n\n\n\n2016-07-30 15:50:16,189 [main] WARN : Failed to write HTTP message: org.springframework.http.converter.HttpMessageNotWritableException: Could not write content: PersistentEntity must not be null! (through reference chain: org.springframework.data.rest.webmvc.json.[\"content\"]->com.nemesis.platform.module.cms.core.entity.ListerPageEntity[\"title\"]); nested exception is com.fasterxml.jackson.databind.JsonMappingException: PersistentEntity must not be null! (through reference chain: org.springframework.data.rest.webmvc.json.[\"content\"]->com.nemesis.platform.module.cms.core.entity.ListerPageEntity[\"title\"])\n\n\n\n\n\n\nMy entity has a Map<Locale, LocalizedValue> where LocalizedValue is @Embedable and in my case entity is null because in PersistentEntityJackson2Module you look it up like this \n\n\n\n\n\n\nPersistentEntity<?, ?> entity = entities.getPersistentEntity(value.getClass());\n\n\n\n\n\n\nbut value is a Map so value.getClass() returns PersistentMap.\nSounds like you need a dedicated clause for Maps in NestedEntitySerializer.serialize().\n", "project": "Spring", "sub_project": "DATAREST", "version": "2.5.2.RELEASE", "fixed_version": "2.5.3.RELEASE", "fixed_files": ["org.springframework.data.rest.webmvc.json.PersistentEntitySerializationTests.java", "org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module.java", "org.springframework.data.rest.tests.mongodb.User.java"], "label": 1, "es_results": []}, {"bug_id": 898, "bug_title": "Typo in EntityLookupConfiguration assertion message", "bug_description": "", "project": "Spring", "sub_project": "DATAREST", "version": "2.5.2.RELEASE", "fixed_version": "2.5.3.RELEASE", "fixed_files": ["org.springframework.data.rest.core.config.EntityLookupConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 931, "bug_title": "PATCH for non-resource associations does not work as expected", "bug_description": "User has a repository and Phone has not. [id and some other fields are pruned in below examples for brevity, see full entities in example code]\n\n\n\n\n\n\n@Entity\n\n\n\n\npublic class User {\n\n\n\n\n\n\n\n\n\n        private String name;\n\n\n\n\n\n\n\n\n\n\t@Column(nullable = false)\n\n\n\n\n\t@Temporal(value = TemporalType.TIMESTAMP)\n\n\n\n\n\tprivate Calendar creationDate;\n\n\n\n\n\n\n\n\n\n\t@OneToMany(mappedBy = \"user\", cascade = CascadeType.ALL)\n\n\n\n\n\tprivate List<Phone> phones;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n@Entity\n\n\n\n\npublic class Phone extends BaseEntity {\n\n\n\n\n\n\n\n\n\n\t@Column(nullable = false)\n\n\n\n\n\t@Temporal(value = TemporalType.TIMESTAMP)\n\n\n\n\n\tprivate Calendar creationDate;\n\n\n\n\n\n\n\n\n\n\t@ManyToOne(fetch = FetchType.EAGER)\n\n\n\n\n\tprivate User user;\n\n\n\n\n}\n\n\n\n\n\n\nIn this case patch for /users/1 with following data works:\n\n\n\n\n\n\n{\n\n\n\n\n   \"name\":\"John Doe X\",\n\n\n\n\n   \"phones\":[\n\n\n\n\n      {\n\n\n\n\n         \"id\":1,\n\n\n\n\n         \"creationDate\":\"2016-11-02T07:34:02.806+0000\",\n\n\n\n\n         \"label\":\"work\",\n\n\n\n\n         \"number\":\"00000000\"\n\n\n\n\n      }\n\n\n\n\n   ]\n\n\n\n\n}\n\n\n\n\n\n\nbut following data fails with not-null-constraint error for creationDate:\n\n\n\n\n\n\n{\n\n\n\n\n   \"name\":\"John Doe X\",\n\n\n\n\n   \"phones\":[\n\n\n\n\n      {\n\n\n\n\n         \"id\":1,\n\n\n\n\n         \"label\":\"work\",\n\n\n\n\n         \"number\":\"00000000\"\n\n\n\n\n      }\n\n\n\n\n   ]\n\n\n\n\n}\n\n\n\n\n\n\nPATCH works selectively on resources however doesn&apos;t work as expected for inline data which is not a resource (in this case \"phone\")", "project": "Spring", "sub_project": "DATAREST", "version": "2.5.4.RELEASE", "fixed_version": "2.6.0.M1", "fixed_files": ["org.springframework.data.rest.webmvc.json.DomainObjectReaderUnitTests.java", "org.springframework.data.rest.webmvc.config.JsonPatchHandler.java", "org.springframework.data.rest.webmvc.json.DomainObjectReader.java"], "label": 1, "es_results": []}, {"bug_id": 919, "bug_title": "PUT/PATCH of Entity object that is a Map silently dropping elements of Map", "bug_description": "When one has an Entity that has an attribute that is a Map, performing a PUT/PATCH to apply an update the Map will silently throw away any first-level sub-elements of the Map that are themselves a JSON object. \nFor example, if I have an entity like:\n\n\n\n\n\n\n@Entity\n\n\n\n\npublic class Person\n\n\n\n\n{\n\n\n\n\n    @Id\n\n\n\n\n    private Long id;\n\n\n\n\n\n\n\n\n\n     private String name;\n\n\n\n\n\n\n\n\n\n     private HashMap<String, Object> attributes;\n\n\n\n\n}\n\n\n\n\n\n\nAnd I create the initial record with the following JSON using POST /api/persons:\n\n\n\n\n\n\n{\n\n\n\n\n    \"name\" : \"person1\",\n\n\n\n\n    \"attributes\" : {\n\n\n\n\n          \"sub1\" : \"ok\",\n\n\n\n\n          \"sub2\" : [ \"ok1\", \"ok2\" ],\n\n\n\n\n          \"sub3\" : [ { \"childOk1\" : \"ok\" }],\n\n\n\n\n          \"sub4\" : {\n\n\n\n\n               \"c1\" : \"v1\"\n\n\n\n\n          }\n\n\n\n\n     }\n\n\n\n\n}\n\n\n\n\n\n\nEverything works fine. If I then try to update using PATCH or PUT /api/persons/1:\n\n\n\n\n\n\n{\n\n\n\n\n    \"attributes\" : {\n\n\n\n\n          \"sub1\" : \"ok\",\n\n\n\n\n          \"sub2\" : [ \"ok1\", \"ok2\" ],\n\n\n\n\n          \"sub3\" : [ { \"childOk1\" : \"ok\" }],\n\n\n\n\n          \"sub4\" : {\n\n\n\n\n               \"c1\" : \"v1\",\n\n\n\n\n               \"c2\" : \"new\"\n\n\n\n\n          }\n\n\n\n\n     }\n\n\n\n\n}\n\n\n\n\n\n\nNot only will the attributes.sub4.c2 value not be saved, the entire attributes.sub4 element will disappear. The rest of the items, including attributes.sub3 will remain, since its value is an array of objects instead of just an object. \nIf I then submit the exact same REST call, everything will return. In fact, if you just keep doing PUT or PATCH over and over, it will keep flipping back and forth from the two states.\nIt appears the issue is somewhere in DomainObjectReader.java, but I haven&apos;t been able to fully track it down as of yet. I wanted to get this logged since I suspect this could be a major bug for people, and given that it only appears during the PATCH/PUT phase, its possible this could be missed for awhile.", "project": "Spring", "sub_project": "DATAREST", "version": "2.5.4.RELEASE", "fixed_version": "2.6.0.RC1", "fixed_files": ["org.springframework.data.rest.webmvc.json.DomainObjectReaderUnitTests.java", "org.springframework.data.rest.webmvc.json.DomainObjectReader.java"], "label": 1, "es_results": []}, {"bug_id": 938, "bug_title": "Nested entities are replaced with new instances instead of being updated when merging", "bug_description": "When using the repository domain object update end point (via the PATCH method with JSON data), nested objects are replaced with new instances instead of updates being applied to the existing instance.\nFor example, given these classes:\n\n\n\n\n\n\n\n\n\n\n\n@JsonAutoDetect(fieldVisibility = Visibility.ANY)\n\n\n\n\nstatic class Outer {\n\n\n\n\n\n\n\n\n\n\tString name;\n\n\n\n\n\tString prop;\n\n\n\n\n\tInner inner;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n@JsonAutoDetect(fieldVisibility = Visibility.ANY)\n\n\n\n\nstatic class Inner {\n\n\n\n\n\n\n\n\n\n\tString name;\n\n\n\n\n\tString prop;\n\n\n\n\n}\n\n\n\n\n\n\nLet there be an instance of Outer like this:\n\n\n\n\n\n\nInner inner = new Inner();\n\n\n\n\ninner.name = \"inner name\";\n\n\n\n\ninner.prop = \"something\";\n\n\n\n\nOuter outer = new Outer();\n\n\n\n\nouter.prop = \"else\";\n\n\n\n\nouter.name = \"outer name\";\n\n\n\n\nouter.inner = inner;\n\n\n\n\n\n\nThen make an HTTP PATCH request to update that object with this request body:\n\n\n\n\n\n\n{ \"inner\" : { \"name\" : \"new inner name\" } }\n\n\n\n\n\n\nthe resulting Outer object should have inner.prop=\"something\" but inner.prop is actually null.", "project": "Spring", "sub_project": "DATAREST", "version": "2.5.4.RELEASE", "fixed_version": "2.6.0.RC1", "fixed_files": ["org.springframework.data.rest.webmvc.json.DomainObjectReaderUnitTests.java", "org.springframework.data.rest.webmvc.json.DomainObjectReader.java"], "label": 1, "es_results": []}, {"bug_id": 953, "bug_title": "PUT empties nested collection", "bug_description": "In the following scenario Parent and Child are entities and Item is either a Embeddable or an Entity. Only Parent has a repository that is also exported.\n\nPosting such a structure works fine but the PUT empties the Item collection in Child. \nPlease see this project to reproduce the issue - https://github.com/mduesterhoeft/sdr-put-nested-list.\nSuch a scenario has been working in Hopper-SR4 and started to be broken since Hopper-SR5.\n\nHere are the requests I am issuing:\n\nCreate parent\n\n\n\n\n\n\nPOST /parents -> 201\n\n\n\n\n{\n\n\n\n\n    \"child\": {\n\n\n\n\n        \"items\": [\n\n\n\n\n          {\"some\": \"test\"}]\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nupdate parent\n\n\n\n\n\n\nPUT /parents/id -> 204\n\n\n\n\n{\n\n\n\n\n    \"child\": {\n\n\n\n\n        \"items\": [\n\n\n\n\n          {\"some\": \"test123\"} ]\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\n\nAfter the PUT the items collection is empty.", "project": "Spring", "sub_project": "DATAREST", "version": "2.5.5.RELEASE", "fixed_version": "2.6.0.RC1", "fixed_files": ["org.springframework.data.rest.webmvc.json.DomainObjectReaderUnitTests.java"], "label": 1, "es_results": []}, {"bug_id": 956, "bug_title": "PUT does not apply new items in nested collection", "bug_description": "In the following scenario Parent and Child are entities and Item is either a Embeddable or an Entity. Only Parent has a repository that is also exported.\n\nPUT updates existing items but does not add new items.\nPlease see this project to reproduce the issue - https://github.com/mduesterhoeft/sdr-put-nested-list. See test ParentRestIntegrationTest#should_add_new_item\n\nHere are the requests I am issuing:\n\nCreate parent\n\n\n\n\n\n\nPOST /parents -> 201\n\n\n\n\n{\n\n\n\n\n    \"child\": {\n\n\n\n\n        \"items\": [\n\n\n\n\n          {\"some\": \"test\"}]\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nupdate parent\n\n\n\n\n\n\nPUT /parents/id -> 204\n\n\n\n\n{\n\n\n\n\n    \"child\": {\n\n\n\n\n        \"items\": [\n\n\n\n\n          {\"some\": \"test123\"},\n\n\n\n\n          {\"some\": \"test1235\"}]\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\n\nAfter the PUT the items collection still has size 1.", "project": "Spring", "sub_project": "DATAREST", "version": "2.5.5.RELEASE", "fixed_version": "2.6.0.RC1", "fixed_files": ["org.springframework.data.rest.webmvc.json.DomainObjectReaderUnitTests.java", "org.springframework.data.rest.webmvc.json.DomainObjectReader.java"], "label": 1, "es_results": []}, {"bug_id": 290, "bug_title": "LdapTemplate logs message at INFO level instead of DEBUG when authentication exception is captured", "bug_description": "When there is an authentication exception in the method below, a full stack trace is logged at info level; this is polluting the logs whenever a user cannot authenticate. Since the exception is added to the callback object it seems logical that the caller should decide what to do with this exception. Even a DEBUG message seems useless here. \npublic boolean authenticate(Name base, String filter, String password,\n\t\t\tfinal AuthenticatedLdapEntryContextCallback callback, final AuthenticationErrorCallback errorCallback)", "project": "Spring", "sub_project": "LDAP", "version": "1.3.2.RELEASE", "fixed_version": "2.0.1.RELEASE", "fixed_files": ["org.springframework.ldap.core.LdapTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 277, "bug_title": "ODM needs to use DN Attribute index when populating DnAttribute values", "bug_description": "If the same attribute is part of the DN twice (e.g. ou=department,ou=company) the automatic DN calculation in ODM doesn&apos;t seem to work.", "project": "Spring", "sub_project": "LDAP", "version": "2.0.0.M1", "fixed_version": "2.0.0.RELEASE", "fixed_files": ["org.springframework.ldap.odm.core.impl.DefaultObjectDirectoryMapper.java"], "label": 1, "es_results": []}, {"bug_id": 278, "bug_title": "Static fields should be disregarded by ODM", "bug_description": "", "project": "Spring", "sub_project": "LDAP", "version": "2.0.0.M1", "fixed_version": "2.0.0.RELEASE", "fixed_files": ["org.springframework.ldap.odm.core.impl.DefaultObjectDirectoryMapper.java", "org.springframework.ldap.odm.core.impl.ObjectMetaData.java", "org.springframework.ldap.odm.core.impl.AttributeMetaData.java"], "label": 1, "es_results": []}, {"bug_id": 291, "bug_title": "ldapTemplate#authenticate does not throw EmptyResultDataAccessException", "bug_description": "ldapTemplate#authenticate does not throw EmptyResultDataAccessException when zero entry was found.  In that case, it returns authentication exception which is unable to distinguish with password mismatch error.", "project": "Spring", "sub_project": "LDAP", "version": "2.0.0.RELEASE", "fixed_version": "2.0.1.RELEASE", "fixed_files": ["org.springframework.ldap.core.LdapTemplate.java", "org.springframework.ldap.core.LdapTemplateTest.java"], "label": 1, "es_results": []}, {"bug_id": 317, "bug_title": "ldap:context-source/url not parsing properties #{}", "bug_description": "I have tried to create ldap-context in xml, and set attributes from a properties file.\n\n\n\n\n\n\n<util:properties id=\"ldapProperties\" location=\"ldap.properties\"/>\n\n\n\n\n\n\n\n\n\n<ldap:context-source\n\n\n\n\n        url=\"#{ldapProperties.url}\"\n\n\n\n\n        base=\"#{ldapProperties.base}\"\n\n\n\n\n        username=\"#{ldapProperties.username}\"\n\n\n\n\n        password=\"#{ldapProperties.password}\" />\n\n\n\n\n<ldap:ldap-template id=\"ldapTemplate\"/>\n\n\n\n\n\n\n\n\n\n\n\n\nldap.properties\n\n\n\n\n\n\nurl=ldap://localhost:10389\n\n\n\n\nbase=ou=system\n\n\n\n\nusername=uid=admin,ou=system\n\n\n\n\npassword=secret\n\n\n\n\n\n\nWhen I try to use ldapTemplate instance, exception is thrown:\n\njava.net.MalformedURLException: Invalid URI: #ldapProperties.url}/ou=system\ncurly bracket removed after # jira had a problem with that.\nI am attaching maven project with a test case.\nThere is a few ways to workaround this issue I went with java bean configuration,  @Configuration, @Bean.\nIt might be related to a fact that we can set many urls for failover - coma separated.", "project": "Spring", "sub_project": "LDAP", "version": "2.0.2.RELEASE", "fixed_version": "2.0.3.RELEASE", "fixed_files": ["org.springframework.ldap.config.ContextSourceParser.java", "org.springframework.ldap.config.LdapTemplateNamespaceHandlerTest.java"], "label": 1, "es_results": []}, {"bug_id": 314, "bug_title": "repository methods ignoring @Entity(base=)", "bug_description": "LdapRepository query methods ignore @Entry(base = \n\n\n\n\n\n\ninterface LdapAccountRepository extends LdapRepository<Account>\n\n\n\n\nAccount findByAccount(String account);\n\n\n\n\n\n\n\n\n\n@Entry(base = \"DC=wims,DC=tijd,DC=intra\", objectClasses=\"user\")\n\n\n\n\npublic final class Account {\n\n\n\n\n\n\nfix in org.springframework.ldap.repository.query.LdapQueryCreator : \n\n\n\n\n\n\nprotected ContainerCriteria create(Part part, Iterator<Object> iterator) {\n\n\n\n\n        ConditionCriteria criteria = query().base(clazz.getAnnotation(Entry.class).base()).where(getAttribute(part));\n\n\n\n\n\n\n\n\n\n        return appendCondition(part, iterator, criteria);\n\n\n\n\n    }\n\n\n\n\n\n", "project": "Spring", "sub_project": "LDAP", "version": "2.0.2.RELEASE", "fixed_version": "2.0.3.RELEASE", "fixed_files": ["org.springframework.ldap.repository.query.PartTreeLdapRepositoryQueryTest.java", "org.springframework.ldap.repository.query.LdapQueryCreator.java"], "label": 1, "es_results": []}, {"bug_id": 335, "bug_title": "NoClassDefFoundError: RepositoryConfigurationExtension", "bug_description": "This seems to have been caused by changes for issue LDAP-311.\nWhen starting up an application that uses Spring LDAP with XML config, the exception is thrown on init:\norg.springframework.beans.FatalBeanException: Invalid NamespaceHandler class [org.springframework.ldap.config.LdapNamespaceHandler] for namespace http://www.springframework.org/schema/ldap: problem with handler class file or dependent class; nested exception is java.lang.NoClassDefFoundError: org/springframework/data/repository/config/RepositoryConfigurationExtension\nAdding spring-data-commons dependency resolves this issue.", "project": "Spring", "sub_project": "LDAP", "version": "2.0.3.RELEASE", "fixed_version": "2.0.4.RELEASE", "fixed_files": ["org.springframework.ldap.config.LdapNamespaceHandler.java"], "label": 1, "es_results": []}, {"bug_id": 25, "bug_title": "LiteDeviceResolver does not see IPAD user-agent as mobile.", "bug_description": "I have been testing using Firefox user-agent switcher to simulate the IPAD.\nMozilla/5.0 (iPad; YOU; CPU OS 3_2 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Version/4.0.4 Mobile/7B334b Safari/531.21.10\nThis is seen by the LiteDeviceResolver as &apos;not mobile&apos;.\nIn the forum discussion referenced it is believed this is not correct.", "project": "Spring", "sub_project": "MOBILE", "version": "v1.0.0.M3", "fixed_version": "v1.0.0.RC1", "fixed_files": ["org.springframework.mobile.device.LiteDeviceResolverTest.java", "org.springframework.mobile.device.LiteDeviceResolver.java"], "label": 1, "es_results": []}, {"bug_id": 21, "bug_title": "False positives in LiteDeviceResolver", "bug_description": "I&apos;m getting a false positive from a request via the Layar app (www.layar.com). The app sends a request from an android device with the following user-agent: \"Layar/4.0 Android/2.2.1\".\nWould it be somehow possible to create a list of prefixes which must not be in the user-agent?\n", "project": "Spring", "sub_project": "MOBILE", "version": "v1.0.0.M3", "fixed_version": "v1.0.0.RC2", "fixed_files": ["org.springframework.mobile.device.LiteDevice.java", "org.springframework.mobile.device.LiteDeviceResolverTest.java", "org.springframework.mobile.device.LiteDeviceResolver.java"], "label": 1, "es_results": []}, {"bug_id": 51, "bug_title": "Blackberry 10 user agent missing", "bug_description": "Hi,\nI&apos;m working with a blackberry 10 simulator and it never detect this device as mobile. I reviewed the KNOWN_MOBILE_USER_AGENT_KEYWORDS variable and I think it&apos;s only add the \"touch\" as new keyworkd, I&apos;m not sure \nThere is the user agent example:\nMozilla/5.0 (BB10; Touch) AppleWebKit/537.3+ (KHTML, like Gecko) Version/10.0.9.386 Mobile Safari/537.3+\nAnd here the description of user agent for this device:\nhttp://crackberry.com/developers-here-blackberry-10-user-agent\nMore Info:\nhttp://us.blackberry.com/sites/developers/resources/simulators.html", "project": "Spring", "sub_project": "MOBILE", "version": "v1.0.0.RELEASE", "fixed_version": "v1.0.1.RELEASE", "fixed_files": ["org.springframework.mobile.device.UserAgent.java", "org.springframework.mobile.device.LiteDeviceResolverTest.java", "org.springframework.mobile.device.LiteDeviceResolver.java"], "label": 1, "es_results": []}, {"bug_id": 79, "bug_title": "Firefox OS user agent missing", "bug_description": "Hi,\nI usually use Spring Framework on my project with Spring Mobile on them to be able to know if users are on mobile or not to put correct view...\nSome users are now on mobile with Firefox OS and not have mobile but desktop view.\nFor information, user agent of Firefox OS is : \n\n\n\n\n\n\nMozilla/5.0 (Mobile; rv:15.0) Gecko/15.0 Firefox/15.0\n\n\n\n\n\n\nSo when i try to use user agent switcher on firefox to try that user agent, i don&apos;t have mobile view but normal view. So it means that the Device recovered by the DeviceResolver answer \"false\" on device.isMobile()\nI actually work with 1.0.1.RELEASE version of spring mobile\nThanks for your help", "project": "Spring", "sub_project": "MOBILE", "version": "v1.0.1.RELEASE", "fixed_version": "v1.1.0.RC1", "fixed_files": ["org.springframework.mobile.device.UserAgent.java", "org.springframework.mobile.device.LiteDeviceResolverTest.java", "org.springframework.mobile.device.LiteDeviceResolver.java"], "label": 1, "es_results": []}, {"bug_id": 61, "bug_title": "SiteSwitcherRequestFilter - initFilterBean() overwrites values from constructor", "bug_description": "The SiteSwitcherRequestFilter provides two constructors: the default constructor and one where all the SiteUrlFactories etc. can be specified.\nWe need to use the last-mentioned (with a DelegatingFilterProxy) since we want to configure our own implementation of the SiteUrlFactory (which always redirects to the same url - we named it StaticSiteUrlFactory).\nUnfortunately our configuration gets overwritten in the initFilterBean-method.", "project": "Spring", "sub_project": "MOBILE", "version": "v1.1.0.M2", "fixed_version": "v1.1.0.M3", "fixed_files": ["org.springframework.mobile.device.switcher.SiteSwitcherRequestFilterTest.java", "org.springframework.mobile.device.switcher.SiteSwitcherRequestFilter.java"], "label": 1, "es_results": []}, {"bug_id": 62, "bug_title": "SiteSwitcherRequestFilter - filterChain.doFilter should only be called if the response is not already committed", "bug_description": "In doFilterInternal(...) the call to the filterChain should only be executed, if the response is not already committed - i.e. the SiteSwitcherHandler did not handle the response.\nPossible fix:\n\n\n\n\n\n\n@Override\n\n\n\n\nprotected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)\n\n\n\n\n\t\t\tthrows ServletException, IOException {\n\n\n\n\n\tif(siteSwitcherHandler.handleSiteSwitch(request, response)) {\n\n\n\n\n\t\t\tfilterChain.doFilter(request, response);\n\n\n\n\n\t}\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "MOBILE", "version": "v1.1.0.M2", "fixed_version": "v1.1.0.M3", "fixed_files": ["org.springframework.mobile.device.switcher.SiteSwitcherRequestFilterTest.java", "org.springframework.mobile.device.switcher.SiteSwitcherRequestFilter.java"], "label": 1, "es_results": []}, {"bug_id": 63, "bug_title": "DeviceDelegatingViewResolver redirects to \"mobile//\"", "bug_description": "When configuring a prefix of \"mobile/\" with the DeviceDelegatingViewResolver, mobile requests for \"redirect:/\" are redirected to \"website.com/mobile//\". Note the extra forward slash.", "project": "Spring", "sub_project": "MOBILE", "version": "v1.1.0.M2", "fixed_version": "v1.1.0.M3", "fixed_files": ["org.springframework.mobile.device.view.LiteDeviceDelegatingViewResolver.java", "org.springframework.mobile.device.view.LiteDeviceDelegatingViewResolverTest.java"], "label": 1, "es_results": []}, {"bug_id": 68, "bug_title": "Site path formatting is overwritten if it contains no slashes or only trailing slashes", "bug_description": "In AbstractSitePathUrlFactory, if a site path is configured with no slashes or only a trailing slash, formatPath incorrectly formats the path.", "project": "Spring", "sub_project": "MOBILE", "version": "v1.1.0.M2", "fixed_version": "v1.1.0.M3", "fixed_files": ["org.springframework.mobile.device.switcher.AbstractSitePathUrlFactoryTest.java", "org.springframework.mobile.device.switcher.AbstractSitePathUrlFactory.java"], "label": 1, "es_results": []}, {"bug_id": 69, "bug_title": "QueryString parameters not honored when redirecting", "bug_description": "See forum reference for details.", "project": "Spring", "sub_project": "MOBILE", "version": "v1.1.0.M2", "fixed_version": "v1.1.0.M3", "fixed_files": ["org.springframework.mobile.device.switcher.AbstractSiteUrlFactory.java", "org.springframework.mobile.device.switcher.SiteSwitcherHandlerInterceptorTest.java", "org.springframework.mobile.device.switcher.MobileSitePathUrlFactoryTest.java", "org.springframework.mobile.device.switcher.SiteSwitcherRequestFilterTest.java"], "label": 1, "es_results": []}, {"bug_id": 70, "bug_title": "Absolute URLs are not handled correctly when redirecting", "bug_description": "The LiteDeviceDelegatingViewResolver does not correctly handle absolute URLs when redirecting.\nFor example, the following URL, \n\n\n\n\n\n\nredirect:http://www.google.com/\n\n\n\n\n\n\nredirects to  \n\n\n\n\n\n\nwww.website.com/context/mobile/http://www.google.com/\n\n\n\n\n\n", "project": "Spring", "sub_project": "MOBILE", "version": "v1.1.0.M2", "fixed_version": "v1.1.0.RC1", "fixed_files": ["org.springframework.mobile.device.view.LiteDeviceDelegatingViewResolverTest.java", "org.springframework.mobile.device.view.AbstractDeviceDelegatingViewResolver.java"], "label": 1, "es_results": []}, {"bug_id": 95, "bug_title": "Device resolver possibly returning MOBILE_INSTANCE when the device is a tablet", "bug_description": "LiteDeviceResolver will return that a tablet is a phone if it has UAProf headers (e.g. Galaxy Tab 8.9)", "project": "Spring", "sub_project": "MOBILE", "version": "v1.1.0.RELEASE", "fixed_version": "v1.1.1.RELEASE", "fixed_files": ["org.springframework.mobile.device.UserAgent.java", "org.springframework.mobile.device.LiteDeviceResolverTest.java", "org.springframework.mobile.device.LiteDeviceResolver.java"], "label": 1, "es_results": []}, {"bug_id": 57, "bug_title": "mvn test failure following tutorial on blog", "bug_description": "Following the steps in the \"roo 2\" blog post tutorial. Everything working great until the step where I run \"mvn test\". At this point I get 9 test failures, due to missing classes on the classpath (javax/annotation types). \nSee attached file for full error log.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.addon.maven.MavenOperations.java"], "label": 1, "es_results": []}, {"bug_id": 61, "bug_title": "Failure to detect existing fields with clashing name when introducing identifier field", "bug_description": "EntityMetadata fails to detect naming classes if there is an existing field with the same name as the proposed identifier field.\nThe new version field name is correctly resolved (though also see ROO-60). We need similar logic for the identifier field.\nSteps to reproduce:\ncreate project com.foo\ninstall jpa -provider HIBERNATE -database HYPERSONIC_IN_MEMORY \nnew persistent class jpa -name SomeClass -testAutomatically   \nadd field string someField\nRunning \"mvn test\" at this point will pass. If you then \"add field string id -class com.foo.SomeClass\", it will give an IT WOULD error when the tests are compiled:\ncompiler errors : \nerror at public java.lang.String SomeClass.getId() {    \n                                  ^^\n/home/balex/t/src/main/java/com/foo/SomeClass_Roo_JavaBean.aj:13:0::0 intertype declaration from com.foo.SomeClass_Roo_Entity conflicts with intertype declaration: java.lang.String com.foo.SomeClass.getId() from com.foo.SomeClass_Roo_JavaBean\nerror at public java.lang.Long SomeClass.getId() {    \n                                ^^", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.addon.entity.RooEntity.java", "org.springframework.roo.addon.entity.EntityMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 64, "bug_title": "Annotations containing class attributes erroneously remain unqualified", "bug_description": "As detailed in ROO-50, creating an integration test for an entity named com.foo.Test will erroneously result in the following type declaration:\npackage com.foo;\nimport org.springframework.roo.addon.test.RooIntegrationTest;\nimport org.junit.Test;\n@RooIntegrationTest(entity = Test.class)\npublic class TestIntegrationTest \n{ ... }\n\nThe annotation should be @RooIntegrationTest(entity = com.foo.Test.class), not @RooIntegrationTest(entity = Test.class). It is unclear at this moment whether this is due to a bug in the Java Parser metadata component or specific to the integration test add-on.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserUtils.java"], "label": 1, "es_results": []}, {"bug_id": 73, "bug_title": "Package declaration using package-info.java causes error message", "bug_description": "If a package contains the package definition file package-info.java, the Roo she will produces the following error message:\n> The first letter of the type name portion must be uppercase (attempted &apos;<packagename>.package-info&apos;)\nThis seems to be a cosmetic issue only because Roo parses and generates code for all other files in the package as expected.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 63, "bug_title": "script clinic.roo stops with \"Script execution aborted\"", "bug_description": "If I follow these steps:\ncd \\java\nmkdir clinic\ncd clinic\nroo\nscript clinic.roo\nI get many lines from previous steps executed right and:\nnew controller automatic -name ~.web.OwnerController -formBackingObject ~.domain.Owner\nCreated SRC_MAIN_JAVA\\com\\springsource\\petclinic\\web\\OwnerController.java\nCreated SRC_MAIN_JAVA\\com\\springsource\\petclinic\\domain\\PetEditor.java\nCreated SRC_MAIN_JAVA\\com\\springsource\\petclinic\\web\\OwnerController_Roo_Controller.aj\nCreated SRC_MAIN_WEBAPP\\WEB-INF\\jsp\\owner\nCreated SRC_MAIN_WEBAPP\\WEB-INF\\jsp\\owner\\list.jsp\nCreated SRC_MAIN_WEBAPP\\WEB-INF\\jsp\\owner\\show.jsp\nUndo create SRC_MAIN_WEBAPP\\WEB-INF\\jsp\\owner\\show.jsp\nUndo create SRC_MAIN_WEBAPP\\WEB-INF\\jsp\\owner\\list.jsp\nUndo create SRC_MAIN_WEBAPP\\WEB-INF\\jsp\\owner\nUndo create SRC_MAIN_JAVA\\com\\springsource\\petclinic\\web\\OwnerController_Roo_Controller.aj\nUndo create SRC_MAIN_JAVA\\com\\springsource\\petclinic\\domain\\PetEditor.java\nUndo create SRC_MAIN_JAVA\\com\\springsource\\petclinic\\web\\OwnerController.java\nScript execution aborted\nroo>\nif I try to execute by hand the rest of the \"new controller automatic (Pet,Vet).\", all undo the creation of files.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 82, "bug_title": "Problem with the many to many relationship, script line is not closed correct", "bug_description": "When creating a many to many relationship, the following line contains an error\n<script type=\"text/javascript\">Spring.addDecoration(new Spring.ElementDecoration(\n{elementId : \"_tasks\", widgetType: \"dijit.form.MultiSelect\")); </script>\n\nRight after MultiSelect\" a }\n is missing", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 78, "bug_title": "Support for array types in parser", "bug_description": "Roo&apos;s parser apparently has problems when dealing with array types:\n@RooJavaBean\npublic class Foo \n{\n\n  private String bar[];\n\n}\n\nwill produce the following aspect, not recognizing that bar is an array:\nprivileged aspect Foo_Roo_JavaBean {\n    public java.lang.String at.telekomaustria.zusdie.xml.Foo.getBar() \n{    \n        return this.bar;        \n    }\n \n    public void at.telekomaustria.zusdie.xml.Foo.setBar(java.lang.String bar) \n{    \n        this.bar = bar;        \n    }\n \n}\nThe alternative array syntax \"String[] bar;\" causes the whole aspect to be deleted, apparently because of a parsing failure.\nParser and code generation should support all legal Java array type declarations, as defined in the JLS 10.2, also nasties such as \"byte[] rowvector, colvector, matrix[];\"", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.classpath.javaparser.details.JavaParserFieldMetadata.java", "org.springframework.roo.addon.entity.EntityMetadata.java", "org.springframework.roo.classpath.javaparser.JavaParserUtils.java", "org.springframework.roo.model.JavaType.java", "org.springframework.roo.addon.dod.DataOnDemandMetadata.java", "org.springframework.roo.classpath.operations.jsr303.SetField.java", "org.springframework.roo.classpath.operations.FieldCommands.java"], "label": 1, "es_results": []}, {"bug_id": 83, "bug_title": "Integration test does not support entities which have timestamps as version", "bug_description": "If an entity has a timestamp field specified as the versioning field (the field is annotated with @Version) then the generated integration test has a compile error as it compares obj.getVersionTimestamp() > currentVersion (assuming the annotated timestamp field is called versionTimestamp). Instead if the version field is a timestamp the comparison should presumably be made using obj.getVersionTimestamp().after(currentVersion).", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.addon.test.IntegrationTestMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 86, "bug_title": "Annotation attributes initialized with arrays are not parsed correctly.", "bug_description": "Parsed annotation metadata (via JavaParserAnnotationMetadata) does not contain annotation initializers for attributes that have arrays as parameters (e.g. Hibernate&apos;s @Type(parameters = \n{...}\n): The annotation attribute name is stored correctly inside the JavaParserAnnotationMetadata, whereas the AnnotationValue contains null for that attribute.\nSteps to reproduce:\npublic @interface ArrayAnnot {\n  public String[] value() default {};\n}\npublic class Foo {\n  @ArrayAnnot ( \n{ \"1\" }\n)\n  private String type;\n}\nResult: the FieldMetadata for Foo.type does have an annotation \"@ArrayAnnot\", but the value is null.\nThis bug is possibly related to http://jira.springsource.org/browse/ROO-78", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.classpath.details.AnnotationMetadataUtils.java"], "label": 1, "es_results": []}, {"bug_id": 95, "bug_title": "Invalid package declaration for generated resources of classes in default package", "bug_description": "For classes that reside in the default package, Roo generates source files that have a package declaration, but no package identifier.\nSteps to reproduce:\ncreate a class in the default package:\nimport org.springframework.roo.addon.tostring.RooToString;\n@RooToString\npublic class Foo {\n}\nThe generated file Bar_Roo_ToString.aj will contain a package declaration as such:\n\"package ;\"\nwhich is invalid. The package declaration should not be emitted if a class resides in the default package.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.classpath.itd.ItdSourceFileComposer.java"], "label": 1, "es_results": []}, {"bug_id": 85, "bug_title": "Hitting return/enter on a textarea field triggers form submit", "bug_description": "Using the auto scaffolded UI, any field with a @Size() > 30 characters generates a textarea.  However, the Dojo form widget adds form submit to pressing return in the field, so multi-line text entries cannot be created.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 100, "bug_title": "Carriage return \r inserted into XML", "bug_description": "The XML that was inserted when creating the DriverManagerDataSource XML has several \n characters in it.  Other cases of XML that is managed by ROO do not have this issue.\n \n<bean class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\" id=\"dataSource\">\n        <property name=\"driverClassName\" value=\"$\n{database.driverClassName}\n\"/>\n        <property name=\"url\" value=\"$\n{database.url}\n\"/>\n        <property name=\"username\" value=\"$\n{database.username}\n\"/>\n        <property name=\"password\" value=\"$\n{database.password}\n\"/>\n    </bean>\n\n\t<bean class=\"org.springframework.orm.jpa.JpaTransactionManager\" id=\"transactionManager\">\n        <property name=\"entityManagerFactory\" ref=\"entityManagerFactory\"/>\n    </bean>\n\n\t<tx:annotation-driven mode=\"aspectj\" transaction-manager=\"transactionManager\"/>\n\n\t<bean class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\" id=\"entityManagerFactory\">\n        <property name=\"dataSource\" ref=\"dataSource\"/>\n    </bean>", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M1", "fixed_version": "1.0.0.M2", "fixed_files": ["org.springframework.roo.addon.jpa.JpaOperations.java"], "label": 1, "es_results": []}, {"bug_id": 116, "bug_title": "Cannot install finder for entity with similarly named fields", "bug_description": "When installing finder for an entity which has two fields that has similar names eg.:\nname of field1: code, field2: codeGroup, finderName: findCodesByCodeAndCodeGroup\nerror:\nUnable to match all fields of Code for CodeAndCodeGroup (remaining &apos;Group&apos;)\nattached a .roo script which reproduces the bug.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.roo.addon.finder.ReservedToken.java", "org.springframework.roo.addon.finder.FinderTokenizer.java", "org.springframework.roo.addon.finder.FieldToken.java", "org.springframework.roo.addon.finder.Token.java", "org.springframework.roo.addon.finder.DynamicFinderServicesImpl.java"], "label": 1, "es_results": []}, {"bug_id": 134, "bug_title": "MS SQL driver class definition incorrect", "bug_description": "install jpa -database MSSQL currently yields: database.driverClassName=com.microsoft.jdbc.sqlserver.SQLServerDriver when it should be database.driverClassName=com.microsoft.sqlserver.jdbc.SQLServerDriver", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.roo.addon.jpa.JdbcDatabase.java"], "label": 1, "es_results": []}, {"bug_id": 124, "bug_title": "Roo does not clean up finder methods from UI navigation menu when removed from @RooEntity", "bug_description": "Add a finder method to a roo entity.  Update and run, and see the finder method appear in navigation.\nRemove the finder method from the @RooEntity annotation in the domain object.  Re-run Roo.  It cleans up the .aj files but does not rework the menu on the UI.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspMetadataListener.java", "org.springframework.roo.addon.web.menu.MenuOperations.java"], "label": 1, "es_results": []}, {"bug_id": 136, "bug_title": "WebFlow defined with -flowName when installing webflow - camel-cased name gets lowercased in navigation UI", "bug_description": "When building a web flow with a given name, such as registerAttendees:\ninstall web flow -flowName registerAttendees\nWhen the UI generates the \"Enter the registerAttendeesFlow\" link on the navigation bar, it lowercases the URL.  The URL becomes:\n/registerattendees\n  This creates a flow not found situation; the flow is properly configured with the camel case name.  The correct flow URi is:\n/registerAttendees\n", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.roo.addon.web.flow.WebFlowOperations.java"], "label": 1, "es_results": []}, {"bug_id": 96, "bug_title": "Two textareas which are decorated with dijit.form.SimpleTextarea in the same page will sumit as a single parameter for POST submits", "bug_description": "Currently, you cannot have two dijit.form.SimpleTextarea fields in the same page. Both fields (field &apos;a&apos; and field &apos;b&apos;) will end up being submitted as a single param (&apos;a&apos;) and the text entered in both will be merged under parameter &apos;a&apos;\nfield definitions to reproduce:\nadd field string -class ~.domain.Test -fieldName a -sizeMax 70\nadd field string -class ~.domain.Test -fieldName b -sizeMax 70\nFirebug shows that a is submitted twice with different values (once the value from textarea &apos;a&apos; and once from &apos;b&apos;):\na TestA\na TestB\nThis results in field &apos;b&apos; not being populated in AbstractPerson and field &apos;a&apos; containing: &apos;TestA TestB&apos;", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.DojoUtils.java"], "label": 1, "es_results": []}, {"bug_id": 141, "bug_title": "create project foo, followed by \"mvn package\" causes a build failure because there is no web.xml file", "bug_description": "This problem was reported by Adrian Colyer in ROO-138.\nEssentially we have changed the initial project generation to start without any Web artifacts (see ROO-26). This allows users to create a simple Spring project without any persistence or Web artefacts.\nHowever, the project maven pom file still refers to packaging type &apos;war&apos; which causes &apos;mvn package&apos; to fail due to a missing web.xml which is expected in Web projects. ", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.roo.project.ProjectOperations.java", "org.springframework.roo.addon.maven.MavenProjectMetadataProvider.java", "org.springframework.roo.project.ProjectMetadataProvider.java", "org.springframework.roo.addon.web.flow.WebFlowOperations.java", "org.springframework.roo.addon.web.mvc.controller.WebMvcOperations.java"], "label": 1, "es_results": []}, {"bug_id": 106, "bug_title": "Unable to create project from petclinic sample script due to XPath exception", "bug_description": "Running the clinic.roo script fails with: \"org.apache.xpath.domapi.XPathStylesheetDOM3Exception: Prefix must resolve to a namespace: tx\"\nAttached log from the run.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.roo.addon.jms.JmsOperations.java", "org.springframework.roo.addon.web.mvc.controller.WebMvcOperations.java", "org.springframework.roo.addon.email.MailOperations.java", "org.springframework.roo.addon.maven.MavenOperations.java", "org.springframework.roo.support.util.XmlUtils.java", "org.springframework.roo.addon.security.SecurityOperations.java", "org.springframework.roo.addon.jpa.JpaOperations.java"], "label": 1, "es_results": []}, {"bug_id": 143, "bug_title": "Two MultiSelect boxes which are decorated with dijit.form.MultiSelect in the same page will sumit as a single parameter for POST submits", "bug_description": "This issue has the same symptoms as described in ROO-96", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.DojoUtils.java"], "label": 1, "es_results": []}, {"bug_id": 142, "bug_title": "Problem with new controller automatic when you use the same Class Name", "bug_description": "This has happened to me a couple of times during testing when I accidentally give the controller the same name as the domain class (or I forgot i wasn&apos;t using grails).\nroo>new persistent class jpa -name ~.domain.SomeClass\nCreated SRC_MAIN_JAVA\\org\\stjude\\ri\\bwfp\\domain\\SomeClass.java\nCreated SRC_MAIN_JAVA\\org\\stjude\\ri\\bwfp\\domain\\SomeClass_Roo_Entity.aj\nCreated SRC_MAIN_JAVA\\org\\stjude\\ri\\bwfp\\domain\\SomeClass_Roo_ToString.aj\nCreated SRC_MAIN_JAVA\\org\\stjude\\ri\\bwfp\\domain\\SomeClass_Roo_Configurable.aj\nroo> add field string -fieldName SomeField\nManaged SRC_MAIN_JAVA\\org\\stjude\\ri\\bwfp\\domain\\SomeClass.java\nCreated SRC_MAIN_JAVA\\org\\stjude\\ri\\bwfp\\domain\\SomeClass_Roo_JavaBean.aj\nManaged SRC_MAIN_JAVA\\org\\stjude\\ri\\bwfp\\domain\\SomeClass_Roo_ToString.aj\nroo> new controller automatic -formBackingObject ~.domain.SomeClass -name ~.web.SomeClass\nCreated SRC_MAIN_JAVA\\org\\stjude\\ri\\bwfp\\web\\SomeClass.java\nManaged SRC_MAIN_WEBAPP\\WEB-INF\\web.xml\nWhat happens is the generated controller looks like this\npackage org.stjude.ri.bwfp.web;\nimport org.springframework.roo.addon.web.mvc.controller.RooWebScaffold;\nimport org.stjude.ri.bwfp.domain.SomeClass;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.stereotype.Controller;\n@RooWebScaffold(automaticallyMaintainView = true, formBackingObject = SomeClass.class)\n@RequestMapping(\"/someclass/**\")\n@Controller\npublic class SomeClass {\n}\nThe class will not compile because the import conflicts with the class name but from the roo command line there is no indication of an error.\n It&apos;s an annoyance level issue and is easily fixed but could be common for users with previous grails experience.\nThe new controller automatic command line needs to be able to detect if the provided classname in -name is the same as the provided classname in -formbackingobject and give an error, or be grails-like and append Controller to the generated class name.\n", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.roo.classpath.operations.ClasspathOperations.java", "org.springframework.roo.addon.web.mvc.controller.ControllerCommands.java"], "label": 1, "es_results": []}, {"bug_id": 145, "bug_title": "Not all current types in java.lang correctly recognized by JavaParserUtils", "bug_description": "The @RooJavaBean creates invalid fully qualified package names for Iterable:\npackage foo.bar.baz;\nimport org.springframework.roo.addon.javabean.RooJavaBean;\n@RooJavaBean\npublic class X {\n  Iterable<Object> it;\n}\nproduces a IT WOULD with a method with the following declaration:\n public foo.bar.baz.Iterable<java.lang.Object> X.getIt()\nFor a other types sitting in java.lang, e.g., String the declaration is correct and refers to java.lang.String. As JavaBeanMetadata#getDeclaredGetter currently simply copies the type of the getter&apos;s field as its return type, I assumed that JavaParser&apos;s knowledge of java.lang is incomplete.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserUtils.java"], "label": 1, "es_results": []}, {"bug_id": 122, "bug_title": "@RooConfigurable produces errornous IT WOULD for parameterized types", "bug_description": "The IT WOULD created by @RooConfigurable uses the parameterized type name for accessing the annotated class:\n@RooConfigurable\npublic class Foo<T> {\n}\nprivileged aspect Foo_Roo_Configurable {\n    declare @type: Foo<T>: @org.springframework.beans.factory.annotation.Configurable;    \n}\nThis is an error in AspectJ: \"T cannot be resolved to a type\". The error can be resolved by removing the type parameter:\ndeclare @type: Foo: @org.springframework.beans.factory.annotation.Configurable;    ", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.roo.classpath.itd.ItdSourceFileComposer.java"], "label": 1, "es_results": []}, {"bug_id": 162, "bug_title": "Parsing fails for types that are sub-subclasses of a type unknown to Roo", "bug_description": "If Roo encounters a class hierarchy nested for at least 2 levels where the super class is unknown to Roo, then its parser barfs:\nroo> create project -topLevelPackage test.sub.types\n\njava.lang.Exception is unknown to Roo, this line is just to show Roo&apos;s error message\nroo> new java file -name test.sub.types.Foo -extends java.lang.Exception\nUnable to locate requested type&apos;java.lang.Exception&apos;\n\nroo> new java file -name test.sub.types.Foo\n\nManually modify test.sub.types.Foo and let it extend Exception, save it\n\n\nAfter saving Foo; inheritence from Foo works without problems\nroo> new java file -name test.sub.types.Bar -extends ~.Foo\nCreated SRC_MAIN_JAVA\\test\\sub\\types\\Bar.java\n\n\nInheritence from a class that indirectly has Foo as a supertype does not work\nroo> new java file -name foo.bar.baz.Baz -extends ~.Bar\nType &apos;foo.bar.baz.Bar&apos; exists on disk but cannot be parsed\n\nIf metadata trace is at level 1 or 2, its output suggests that Roo enters some recursion that finally aborts once a StackOverflowError is thrown.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.M2", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 171, "bug_title": "Incorrect help text for \"new integration test\" she will command", "bug_description": "If you type \"help\" at the roo prompt, the displayed help text includes these two lines:\n...\n\nnew dod - Creates a new data on demand for the specified entity\nnew integration test - Creates a new data on demand for the specified entity\n...\n\nThe second message of the two shown above seems to be an unintended duplicate.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.classpath.operations.ClasspathCommands.java"], "label": 1, "es_results": []}, {"bug_id": 172, "bug_title": "Misplaced tr and thead in List all... generated tables", "bug_description": "Hi,\nCurrently the JsPDocumentHelper class of the mvc-jsp addon generates a table to list all entities of a kind. This tables have a misplaced tr and thead like this\n<table>\n   <tr>\n       <thead>\n             <th>...</th>\n             <th>...</th>\n               ..............\n      </thead>\n  </tr>\nThe tr tag should be a child of the thead tag instead\n<table>\n   <thead>\n       <tr>\n             <th>...</th>\n             <th>....</th>\n      </tr>\n  </thead>\nThe change is pretty trivial, patch attached\nRegards", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 190, "bug_title": "Date fields does not allow null values", "bug_description": "1. Create new pojo with jdk or jpa date field - no validations at all\n2. mvn tomcat:run\n3. try to save empty form\n\n\n\n\n\n\nFailed to convert property value of type [java.lang.String] to required type [java.util.Date] for property someDate; nested exception is java.lang.IllegalArgumentException: Could not parse date: Unparseable date: \"\"\n\n\n\n\n\n\nHmm... ", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 186, "bug_title": "'list finders for' command not working (ambigious command)", "bug_description": "    ____  ____  ____\n   / __ \\/ __ \\/ __ \\\n  / /_/ / / / / / / /\n / , _/ // / /_/ /\n// ||___/___/    1.0.0.RC1 [rev 198]\nWelcome to Spring Roo. For assistance press TAB or type \"hint\" then hit ENTER.\nroo> list finders for -class ~.Foo\nAmbigious command &apos;list finders for -class ~.Foo&apos; (for assistance press TAB or type \"hint\" then hit ENTER)\nhelp command gives a hint:\nroo> help list finders for\n\nlist finders for - List all finders for a given target (must be an entity\nnew java jms listener - Create a new type which is a asynchronous JMS consumer\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.shell.SimpleParser.java"], "label": 1, "es_results": []}, {"bug_id": 205, "bug_title": "JavaType.equals(Object) fails to take into account data type", "bug_description": "The second assertion check incorrectly fails:\n\n\n\n\n\n\n\t@Test\n\n\n\n\n\tpublic void test() {\n\n\n\n\n\t\tJavaType t1 = JavaType.BOOLEAN_PRIMITIVE;\n\n\n\n\n\t\tJavaType t2 = JavaType.BOOLEAN_PRIMITIVE;\n\n\n\n\n\t\tJavaType t3 = JavaType.BOOLEAN_OBJECT;\n\n\n\n\n\t\tAssert.assertTrue(t1.equals(t2));\n\n\n\n\n\t\tAssert.assertFalse(t1.equals(t3));\n\n\n\n\n\t}\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.model.JavaType.java"], "label": 1, "es_results": []}, {"bug_id": 206, "bug_title": "DataOnDemand fails to properly support common primitive data types", "bug_description": "DataOnDemand attempts to present null to mutators for primitive fields.\nReproduce by script clinic.roo, modifying Pet&apos;s \"sendReminders\" from Boolean to boolean, and then executing the test. The error will be:\nPetDataOnDemand_Roo_DataOnDemand.aj:19:0::0 The method setSendReminders(boolean) in the type Pet is not applicable for the arguments (null)", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 194, "bug_title": "Maps fields not supported by mvc plugin", "bug_description": "Either it needs to be marked as caveat in release doc that map fields are unsupported or it is a bug.\nIn 1.0.0.RC1 , roo cannot decide on plural name for Map<String,Entity> - it tries to find a plural for first param instead of second , specifying @RooPlural on String is out of question  . Not sure how the gui should look like for a map - probably list of entries....", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 184, "bug_title": "Dropdown disappears after validation error", "bug_description": "Dropdown controls disappear from forms upon validation errors. This appears to be a problem with the AspectJ controller files generated by Spring Roo generally. The petclinic sample application provides one example. Specifically, the \"createForm\" method in the auto-generated file OwnerController_Roo_Controller.aj maps \"pets\" to the result set from a call to ~.domain.Pet.findAllPets(); but this mapping does not occur in the \"create\" method prior to returning with the String \"owner/create.\" Consequently, the pets model object is lost in the process of returning from validation.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 203, "bug_title": "upper case member names are ignored in generated jsp files", "bug_description": "If I generate a persistent class wherein the member names are all upper case, the generated jsp files, for the generated controller, ignore these names:\ne.g.:\nnew persistent class jpa -name ~.domain.document -testAutomatically\nadd field string -fieldName TLE1 -notNull\nadd field string -fieldName TLE2 -notNull\nadd field string -fieldName TLE3 -notNull\nnew controller automatic -name ~.web.DocumentController -formBackingObject ~.domain.Document\nThe fields TLE1, TLE2 and TLE3 do not appear in the maintenance jsp files (e.g. update.jsp)", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.addon.beaninfo.BeanInfoMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 217, "bug_title": "JavaParserUtils incorrectly identifies methods returning \"void\" as being JavaType Void objects instead of JavaType void primitives", "bug_description": "Declaring a method in a .java file with a \"void\" return type will be incorrectly represented by JavaParserUtils. The method should be reported as a JavaType.VOID_PRIMITIVE.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserUtils.java"], "label": 1, "es_results": []}, {"bug_id": 229, "bug_title": "Filters inserted into web.xml do not adhere to ordering requirements", "bug_description": "Currently, the OpenEntityManagerInViewFilter required for JPA and also the SpringSecurityFilterChain required by Spring Security are inserted into the web.xml when required. However, their location in the web.xml is not correct. ", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.addon.security.SecurityOperations.java", "org.springframework.roo.addon.web.mvc.controller.WebMvcOperations.java"], "label": 1, "es_results": []}, {"bug_id": 238, "bug_title": "JavaParserUtils.importTypeIfRequired(...) fails to handle primitive JavaType conversion", "bug_description": "JavaParserUtils.importTypeIfRequired(...) fails to handle primitive JavaType conversion", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserUtils.java"], "label": 1, "es_results": []}, {"bug_id": 242, "bug_title": "Integration tests fail when executed against OpenJPA due to flush timing and result list mutability", "bug_description": "script clinic.roo when persistence is OPENJPA will fail due to two errors:\n1. Flushing is required so that the identifier is assigned to newly-persisted entities (integration test add-on).\n2. The List<EntityClass> returned from the finder is immutable, so subsequent attempts to add newly-created transient entities to that list will fail (data on demand add-on).", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java", "org.springframework.roo.addon.test.IntegrationTestMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 204, "bug_title": "datepicker semi-language dependent", "bug_description": "Just ran clinic.roo script and try to add an owner.\nThe datepicker widget doesn&apos;t if I set my windows locale to dutch (netherlands). It will pick a date as 14-9-2009 instead of 14-sep-2009. It will say:\nFailed to convert property value of type [java.lang.String] to required type [java.util.Date] for property birthDay; nested exception is java.lang.IllegalArgumentException: Could not parse date: Unparseable date: \"14-9-2009\"\nmay not be null\nWhen changing my locale to english, it works (on IE8, but not in FF3.5).\nAlso, non-required fields are rejected when not filled in.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.RooWebScaffold.java", "org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java", "org.springframework.roo.addon.web.mvc.controller.WebScaffoldAnnotationValues.java"], "label": 1, "es_results": []}, {"bug_id": 262, "bug_title": "\"process\" commands in MavenCommands should set current working directory for spawned Maven process", "bug_description": "The MavenCommands.mvn method does not set the working directory of  the maven process. This causes the command to fail if running embedded  \ninside STS (the current directory is not the Roo project directory).  You can fix that by passing the working directory to the  \"Runtime.exec\" call: Runtime.getRuntime().exec(\"mvn clean eclipse:clean\", new String[0], new File(\"/file/system/path/ roo-1.0.0.RC2/clinic\"));", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.maven.MavenOperations.java", "org.springframework.roo.addon.maven.MavenCommands.java"], "label": 1, "es_results": []}, {"bug_id": 263, "bug_title": "\"process clean\" command removes Eclipse metadata, causing poor user experience within Eclipse and STS", "bug_description": "When running \"process clean\" the Eclipse project meta data will get  deleted. This is not very nice if running inside STS or Eclipse. It should really only do a \"clean\".", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.maven.MavenCommands.java"], "label": 1, "es_results": []}, {"bug_id": 261, "bug_title": "JspDocumentHelper NullPointerException (NPE) when using a Roo 1.0.0.RC1-created project with new 1.0.0.RC2 release", "bug_description": "If you create a project with RC1 and then open a RC2 she will for that  project you get:\nNullPointerException at  \norg.springframework.roo.addon.mvc.jsp.JspDocumentHelper.<init> \n(JspDocumentHelper.java:74)\nThis is easy to reproduce:\n\nOpen RC1 she will\nroo> script clinic.roo\nroo> exit\nOpen RC2 she will\nsee above error\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 276, "bug_title": "The \"field other\" comment is inconsistent with other \"field\" commands", "bug_description": "When using field other the field name is specified via a --name option.  For all other field types it is --fieldName.\nThe --path option is required, even though the command will default to the last used class in the usual way if --class is not specified.  The path must specify the correct maven location or that class won&apos;t be found.\nAuto-complete seems to behave differently.\n  field string --<tab>  generates a list of the available options\n  field other --<tab>  auto-completes --class\nRunning \"help field other\" to list the possible options --notNull is not listed.  However --notNull can be specified (but it won&apos;t be auto-completed) and the field will be created with no warning.  However the @NotNull annotation will be missing.  Either notNull is supported and should be available in help and auto-complete, or it should generate a warning that it is being ignore, or an error that it is not supported should be generated.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.classpath.operations.FieldCommands.java", "org.springframework.roo.classpath.operations.jsr303.FieldDetails.java"], "label": 1, "es_results": []}, {"bug_id": 288, "bug_title": "Backup does not include empty directories (like src/main/resources)", "bug_description": "The \"backup\" command does not include empty directories.\nThis causes problems if people use the backup command to make a ZIP file that other person attempt to then use with Eclipse (via mvn eclipse:eclipse). Eclipse reports a missing src/main/resources directory.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.backup.BackupOperations.java"], "label": 1, "es_results": []}, {"bug_id": 291, "bug_title": "the \"Show Object\" icon in the generated list view does not use the custom controller path", "bug_description": "As mikej stated in the above forum post, he noticed that the \"Show Object\" icon in the generated list view does not use the custom controller path. \nE.g., he creates a controller with:\n\n\n\n\n\n\ncontroller scaffold --name ~.web.home.TaskController --entity ~.domain.Task --path appuser/task\n\n\n\n\n\n\nAnd then he navigates to /myapp/appuser/task. In the list of tasks the \"show task\" icon for each task row is mapped to the wrong url, e.g.:\n\n\n\n\n\n\n<form id=\"command\" action=\"/myapp/task/23\" method=\"GET\">\n\n\n\n\n\n\nNote that the \"action\" in this case should be \"/myapp/appuser/task/23\".", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java", "org.springframework.roo.addon.web.menu.MenuOperations.java", "org.springframework.roo.addon.web.mvc.controller.ControllerCommands.java"], "label": 1, "es_results": []}, {"bug_id": 290, "bug_title": "user-configured controller paths with more than one path element produce invalid expressions in jsp files", "bug_description": "I have tried the new RC2 feature \"user-configured controller paths\".\nBut it does not seem to work for paths with more than one element.\nMy commands are:\n\n\n\n\n\n\ncontroller scaffold --name ~.web.MyEntityController --entity ~.model.MyEntity --path admin/myentity\n\n\n\n\ncontroller scaffold --name ~.web.MyOtherEntityController --entity ~.model.MyOtherEntity --path /admin/myotherentity/\n\n\n\n\n\n\nThis is the generated view code:\n\n\n\n\n\n\n<li id=\"web_mvc_jsp_create_admin/myentity_menu_item\">\n\n\n\n\n    <c:url value=\"/admin/myentity/form\" var=\"web_mvc_jsp_create_admin/myentity_menu_item_url\"/>\n\n\n\n\n    <a href=\"${web_mvc_jsp_create_admin/myentity_menu_item_url}\">\n\n\n\n\n        <spring:message arguments=\"MyEntity\" code=\"global.menu.new\"/>\n\n\n\n\n    </a>\n\n\n\n\n</li>\n\n\n\n\n...\n\n\n\n\n<li id=\"web_mvc_jsp_create_admin/myotherentity/_menu_item\">\n\n\n\n\n    <c:url value=\"/admin/myotherentity//form\" var=\"web_mvc_jsp_create_admin/myotherentity/_menu_item_url\"/>\n\n\n\n\n    <a href=\"${web_mvc_jsp_create_admin/myotherentity/_menu_item_url}\">\n\n\n\n\n        <spring:message arguments=\"MyOtherEntity\" code=\"global.menu.new\"/>\n\n\n\n\n    </a>\n\n\n\n\n</li>\n\n\n\n\n\n\nAnd this is the result:\n\n\n\n\n\n\n<a href=\"0\">Create new MyEntity</a>\n\n\n\n\n...\n\n\n\n\n<a href=\"NaN\">Create new MyOtherEntity</a>\n\n\n\n\n\n\nIt seems that the variable generation strategy produces invalid expressions.\nCheers\n      Tim", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java", "org.springframework.roo.addon.web.menu.MenuOperations.java", "org.springframework.roo.addon.web.mvc.controller.ControllerCommands.java"], "label": 1, "es_results": []}, {"bug_id": 286, "bug_title": "Title pane widget creates conflict with \"title\" object property", "bug_description": "For example, if I have an object with a \"title\" property (say, employee.title or book.title), roo generates pages with conflicting id attributes on html elements. In my own case, I had a create.jspx page that created the following jsp code:\nLine 3:    <div id=\"_title\" style=\"width: 100%\">\nLine 34:                 <form:textarea cssStyle=\"width:250px\" id=\"_title\" path=\"title\"/>\nLine 37:                 <form:errors cssClass=\"errors\" id=\"_title\" path=\"title\"/>\nI&apos;m not sure about the last one, which may not create an html element in the generated html, but the first two create html elements both with id=\"_title\". (As a result, due to js errors, that page doesn&apos;t even display.) \nPerhaps Roo ought to use more complex naming on its non-user-specified elements such as the title pane widget&apos;s div.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.DojoUtils.java", "org.springframework.roo.addon.mvc.jsp.JspUtils.java", "org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 308, "bug_title": "Controllers created outside toplevel package break the application", "bug_description": "I did a &apos;controller all&apos; on a small sample app, but made a typo in the package. The result is that the @Controller classes are generated in the specified package, but since webmvc-config only contains a component-scan directive for @Controller classes under the toplevel package they&apos;re never picked up. Hence all URLs that should be handled by these controllers will go to the default UrlFilenameViewController instead.\nRoo should either give an error-message (seems like the best choice) or add an extra component-scan directive when the user creates controllers outside the toplevel package.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.ControllerCommands.java"], "label": 1, "es_results": []}, {"bug_id": 303, "bug_title": "Uppercase field names not working with scaffold", "bug_description": "Execute the following script (note the uppercase letter in the field name):\nproject --topLevelPackage org.test.rootask\npersistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY \nentity --name ~.domain.Task\nfield string Name\ncontroller all --package ~.web \nRun it and browse to: http://localhost:8080/rootask/task/form\nIt throws an error:\norg.springframework.beans.NotReadablePropertyException: Invalid property &apos;Name&apos; of bean class [org.test.rootask.domain.Task]: Bean property &apos;Name&apos; is not readable or has an invalid getter method: Does the return type of the getter match the parameter type of the setter?\nThis code works:\nproject --topLevelPackage org.test.rootask\npersistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY \nentity --name ~.domain.Task\nfield string name\ncontroller all --package ~.web \n", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.DojoUtils.java", "org.springframework.roo.addon.mvc.jsp.JspUtils.java", "org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 298, "bug_title": " Error rendering datepicker in finder view", "bug_description": "If you run petclinic sample and uses any date involved finder like \"Find by Visit Date Between\", the date inputs does not renders the calendar picker for Date fields. I think it may be a bug because the picker rendering seems ok while creating new entities.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.DojoUtils.java", "org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 307, "bug_title": "JavaParser fails for annotation values that contain the string concatenation operator", "bug_description": "Replacing this:\n\n\n\n\n\n\n@NamedQueries({\n\n\n\n\n        @NamedQuery(name = \"photo.findByEventIdAndScanNumFetchRoll\",\n\n\n\n\n                   query = \"SELECT p FROM Photo p INNER JOIN FETCH p.roll WHERE p.eventId = :eventId AND p.scanNum = :scanNum AND p.access <> &apos;D&apos; \")\n\n\n\n\n})\n\n\n\n\n\n\nwith this:\n\n\n\n\n\n\n@NamedQueries({\n\n\n\n\n        @NamedQuery(name = \"photo.findByEventIdAndScanNumFetchRoll\",\n\n\n\n\n                   query = \"SELECT p FROM Photo p INNER JOIN FETCH p.roll WHERE\" +\n\n\n\n\n \" p.eventId = :eventId AND p.scanNum = :scanNum AND p.access <> &apos;D&apos; \")\n\n\n\n\n})\n\n\n\n\n\n\ncauses this:\n[timerFactory] Deleted SRC_MAIN_JAVA/test/MyEntity_Roo_Configurable.aj\n[timerFactory] Deleted SRC_MAIN_JAVA/test/MyEntity_Roo_Entity.aj\n[timerFactory] Deleted SRC_MAIN_JAVA/test/MyEntity_Roo_ToString.aj\n[timerFactory] Deleted SRC_MAIN_JAVA/test/MyEntity_Roo_JavaBean.aj", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.classpath.javaparser.details.JavaParserAnnotationMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 327, "bug_title": "Eclipse Tooling: Maven \"perform\" commands do not work from Eclipse Console", "bug_description": "From within the STS/Eclipse Roo she will:\nroo> perform clean\n[INFO] Scanning for projects...\n[INFO] Searching repository for plugin with prefix: &apos;eclipse&apos;.\n[INFO] ------------------------------------------------------------------------\n[INFO] Building Maven Default Project\n[INFO]    task-segment: [clean, eclipse:clean]\n[INFO] ------------------------------------------------------------------------\n[INFO] ------------------------------------------------------------------------\n[ERROR] BUILD ERROR\n[INFO] ------------------------------------------------------------------------\n[INFO] Cannot execute mojo: clean. It requires a project with an existing pom.xml, but the build is not using one.\n[INFO] ------------------------------------------------------------------------\n[INFO] For more information, run Maven with the -e switch\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time: < 1 second\n[INFO] Finished at: Thu Oct 29 19:26:26 MDT 2009\n[INFO] Final Memory: 6M/104M\n[INFO] ------------------------------------------------------------------------", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.maven.MavenOperations.java", "org.springframework.roo.addon.maven.MavenCommands.java"], "label": 1, "es_results": []}, {"bug_id": 329, "bug_title": "EditorMetadata erroneously attempts to introduce various members when they are already defined in the target type", "bug_description": "Similar to ROO-328, the EditorMetadata erroneously attempts to introduce various members when they are already defined in the target type. This is exhibited when undertaking a push-in refactor. The Roo ITDs should never contain members separately provided in the standard .java file. The Roo system correctly reports the error on the console, but the property editor add-on next to be fixed to not attempt this in the first place.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.property.editor.EditorMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 321, "bug_title": "Creation of integration test for abstract classes is possible by running the command explicitly", "bug_description": "The command\n\n\n\n\n\n\nentity --abstract --name ~.model.AbstractEntity --testAutomatically \n\n\n\n\n\n\nproduces this message\n\n\n\n\n\n\nAutomatic tests cannot be created for an abstract entity; remove the --testAutomatically or --abstract option\n\n\n\n\n\n\nHowever the explicit creation of the integration test is possible:\n\n\n\n\n\n\nentity --abstract --name ~.model.AbstractEntity\n\n\n\n\ntest integration --entity tld.domain.project.model.AbstractEntity\n\n\n\n\n\n\nThis surely does not compile because AbstractEntity cannot be instantiated:\n\n\n\n\n\n\nAbstractEntityDataOnDemand_Roo_DataOnDemand.aj\n\n\n\n\n\n\ntld.domain.project.model.AbstractEntity obj = new tld.domain.project.model.AbstractEntity();\n\n\n\n\n\n\nMaybe \"test integration\" on an abstract class should fail like \"entity --abstract --testAutomatically\".", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.classpath.operations.ClasspathOperations.java"], "label": 1, "es_results": []}, {"bug_id": 316, "bug_title": "DataOnDemand IT WOULD references non-existing abstract class if the corresponding member is @NotNull", "bug_description": "the following roo script\n\n\n\n\n\n\n \n\n\n\n\nproject --topLevelPackage tld.domain.project --java 6 --projectName icc_roo2\n\n\n\n\n\n\n\n\n\npersistence setup --database HYPERSONIC_IN_MEMORY --provider HIBERNATE\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nentity --abstract --name ~.model.AbstractEntity\n\n\n\n\n\n\n\n\n\nentity --name ~.model.ConcreteEntity --testAutomatically\n\n\n\n\nfield reference --fieldName reference --type ~.model.AbstractEntity --notNull yes\n\n\n\n\n\n\nproduces the entity\n\n\n\n\n\n\n@Entity\n\n\n\n\n@RooJavaBean\n\n\n\n\n@RooToString\n\n\n\n\n@RooEntity\n\n\n\n\npublic class ConcreteEntity {\n\n\n\n\n\n\n\n\n\n    @NotNull\n\n\n\n\n    @ManyToOne(targetEntity = AbstractEntity.class)\n\n\n\n\n    @JoinColumn\n\n\n\n\n    private AbstractEntity reference;\n\n\n\n\n}\n\n\n\n\n\n\nand the following DataOnDemand IT WOULD\n\n\n\n\n\n\nprivileged aspect ConcreteEntityDataOnDemand_Roo_DataOnDemand {\n\n\n\n\n[...]\n\n\n\n\n    @Autowired    \n\n\n\n\n    private AbstractEntityDataOnDemand ConcreteEntityDataOnDemand.abstractEntityDataOnDemand;    \n\n\n\n\n[...]\n\n\n\n\n\n\nUnfortunately AbstractEntityDataOnDemand does not exist. \nAnd it can not be created because --testAutomatically is not allowed for abstract classes.\nThe reference to abstractEntityDataOnDemand is only included if the corresponding class member is marked as @NotNull.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.classpath.operations.ClasspathOperations.java", "org.springframework.roo.addon.dod.DataOnDemandMetadata.java", "org.springframework.roo.addon.dod.DataOnDemandMetadataProvider.java", "org.springframework.roo.classpath.operations.ClasspathCommands.java"], "label": 1, "es_results": []}, {"bug_id": 331, "bug_title": "Finder add-on creates incorrect JQL queries when joining conditions", "bug_description": "Finder add-on creates incorrect JQL queries when joining conditions", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.finder.FinderMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 333, "bug_title": "Introduction of new annotation to a JavaType is not flushed to disk", "bug_description": "Invoking MutableClassOrInterfaceTypeDetails.addTypeAnnotation(AnnotationMetadata) does not add the annotation to the physical source code.\n", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.classpath.javaparser.details.JavaParserAnnotationMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 334, "bug_title": "IT WOULD source file imported types are not aware of generics", "bug_description": "When calling DefaultItdTypeDetailsBuilder.addImplementsType(JavaType) generics applied to the JavaType are ignored.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.classpath.itd.ItdSourceFileComposer.java"], "label": 1, "es_results": []}, {"bug_id": 343, "bug_title": "ClassCastException in file monitoring", "bug_description": "I tried to use file monitoring service from another Spring project. If I add monitoring request for a file followed by a directory, I get ClassCastException in PollingFileMonitorService.add(MonitoringRequest). The fix is simple (patch attached)", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.file.monitor.polling.PollingFileMonitorService.java"], "label": 1, "es_results": []}, {"bug_id": 254, "bug_title": "enums cannot be entered in web interface", "bug_description": "The new enum facility does not work with the web-interface.  The enumerator field appears as two empty drop-downs.  See attached screenshot.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspUtils.java", "org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java", "org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 354, "bug_title": "Dependencies incorrectly parsed when unexpected <type> element appearing in pom.xml", "bug_description": "I&apos;ve changed some part of my pom.xml with Eclipse editor, something like add new Plugin and properties or Tabbed some dependencies for putting them in right format.\nNow after create a new Controller then pom.xml will include 10 repeated dependencies.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC3", "fixed_files": ["org.springframework.roo.project.Dependency.java"], "label": 1, "es_results": []}, {"bug_id": 364, "bug_title": "Problem with custom controller path", "bug_description": "Using revision 401 (which is RC3)\n\n\n\n\n\n\n \n\n\n\n\nroo> controller scaffold --name ~.web.MyEntityController --entity ~.domain.Ent1 --path admin/ent1\n\n\n\n\nCreated SRC_MAIN_JAVA/com/test/web/MyEntityController.java\n\n\n\n\nManaged SRC_MAIN_WEBAPP/WEB-INF/web.xml\n\n\n\n\nManaged ROOT/pom.xml\n\n\n\n\nCreated SRC_MAIN_JAVA/com/test/web/MyEntityController_Roo_Controller.aj\n\n\n\n\nCreated SRC_MAIN_WEBAPP/WEB-INF/views/admin/ent1\n\n\n\n\nCreated SRC_MAIN_WEBAPP/WEB-INF/views/admin/ent1/list.jspx\n\n\n\n\nCreated SRC_MAIN_WEBAPP/WEB-INF/views/admin/ent1/show.jspx\n\n\n\n\nCreated SRC_MAIN_WEBAPP/WEB-INF/views/admin/ent1/create.jspx\n\n\n\n\nUndo create SRC_MAIN_WEBAPP/WEB-INF/views/admin/ent1/create.jspx\n\n\n\n\nUndo create SRC_MAIN_WEBAPP/WEB-INF/views/admin/ent1/show.jspx\n\n\n\n\nUndo create SRC_MAIN_WEBAPP/WEB-INF/views/admin/ent1/list.jspx\n\n\n\n\nUndo create SRC_MAIN_WEBAPP/WEB-INF/views/admin/ent1\n\n\n\n\nUndo create SRC_MAIN_JAVA/com/test/web/MyEntityController_Roo_Controller.aj\n\n\n\n\nUndo manage ROOT/pom.xml\n\n\n\n\nUndo manage SRC_MAIN_WEBAPP/WEB-INF/web.xml\n\n\n\n\nUndo create SRC_MAIN_JAVA/com/test/web/MyEntityController.java\n\n\n\n\nIllegal name &apos;admin/ent1&apos; (illegal character)\n\n\n\n\n\n\nThis used to work before, I am currently using revision 362 and have controllers with admin/... path.  Upgrading to RC3 breaks my project with the same error (I am also using automaticallyMaintainView=true)", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.web.flow.WebFlowOperations.java", "org.springframework.roo.addon.mvc.jsp.JspMetadataListener.java", "org.springframework.roo.addon.web.menu.MenuOperations.java"], "label": 1, "es_results": []}, {"bug_id": 367, "bug_title": "@NotNull enum field causes drop down boxes to be rendered twice.", "bug_description": "Will attach sample project and screenshot.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.DojoUtils.java", "org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 374, "bug_title": "Typo in doc section A.4.2", "bug_description": "--entity The entity which /will/ this data on demand class will create and modify as required", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.classpath.operations.ClasspathCommands.java"], "label": 1, "es_results": []}, {"bug_id": 377, "bug_title": "Roo generated finder has a sql syntax error in it", "bug_description": "Copying over from STS-626:\nI am using PSQL and hibernate for persistence.\nI generated a finder to find Researchers by Interests. The Roo generated finder has a SQL error in it (look for WHERE AND). Here is the generated method:\n\n\n\n\n\n\npublic static Query Researcher.findResearchersByInterests(Set<Interest> interests) {\n\n\n\n\n   if (interests == null) throw new IllegalArgumentException(\"The interests argument is required\");\n\n\n\n\n   EntityManager them = Researcher.entityManager();\n\n\n\n\n   StringBuilder queryBuilder = new StringBuilder(\"SELECT Researcher FROM Researcher AS researcher WHERE AND\");\n\n\n\n\n   for (int i = 0; i < interests.size(); i++) { \n\n\n\n\n      if (i > 0) queryBuilder.append(\" AND\"); \n\n\n\n\n      queryBuilder.append(\" :interests_item\").append(i).append(\" MEMBER OF researcher.interests\"); \n\n\n\n\n   }\n\n\n\n\n   Query q = them.createQuery(queryBuilder.toString());\n\n\n\n\n   int i = 0;\n\n\n\n\n   for (Interest interest: interests) { \n\n\n\n\n      q.setParameter(\"interests_item\" + i++, interest); \n\n\n\n\n   }\n\n\n\n\n   return q;\n\n\n\n\n}\n\n\n\n\n\n\nWhen I try to use this finder in my app i get a org.hibernate.hql.ast.QuerySyntaxException: unexpected token: AND near line 1, column 81 [SELECT Researcher FROM edu.drexel.goodwin.domain.Researcher AS researcher WHERE AND :interests_item0 MEMBER OF researcher.interests]\nThat word AND shouldn&apos;t be right after the WHERE.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.finder.FinderMetadata.java", "org.springframework.roo.addon.finder.DynamicFinderServicesImpl.java"], "label": 1, "es_results": []}, {"bug_id": 379, "bug_title": "She Will tab completion irregularity when default options are used", "bug_description": "(Logged by Ben on behalf of Paul)\nIf I run Roo RC3:\nroo> project --[TAB]\nproject --java           project --projectName    project --template\nroo> project --t[TAB]\nproject --template           project --topLevelPackage\nWhy don&apos;t I get ----topLevelPackage appear in the first list, only in the second?  Is this a bug or expected behaviour?", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.shell.ParserUtils.java"], "label": 1, "es_results": []}, {"bug_id": 378, "bug_title": "Tests are failing when @OneToOne relationship is present", "bug_description": "Here are the steps to reproduce:\n\n\n\n\n\n\n \n\n\n\n\nroo> project --topLevelPackage com.test --projectName Test --template STANDARD_PROJECT\n\n\n\n\nroo> persistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY\n\n\n\n\nroo> entity --name Region --testAutomatically\n\n\n\n\nroo> field string --fieldName name\n\n\n\n\nroo> entity --name Survey --testAutomatically\n\n\n\n\nroo> field string --fieldName name\n\n\n\n\nroo> perform tests\n\n\n\n\n\n\nEverything works as expected.\nIn my case you can only have one survey per region.  And you can create a region without creating a survey.\nSo I manually (because I don&apos;t see a Roo command to add one-to-one relationship) add the following:\nin Survey.java\n\n\n\n\n\n\n \n\n\n\n\n    @NotNull\n\n\n\n\n    @OneToOne(cascade = CascadeType.ALL, optional=false)\n\n\n\n\n    @JoinColumn(name = \"region_id\")\n\n\n\n\n    private Region region;\n\n\n\n\n\n\nin Region.java\n\n\n\n\n\n\n \n\n\n\n\n    @OneToOne(mappedBy=\"region\", optional=true)\n\n\n\n\n    private Survey survey;\n\n\n\n\n\n\nI now run the tests again:  \n\n\n\n\n\n\n \n\n\n\n\nroo> perform tests\n\n\n\n\n-------------------------------------------------------\n\n\n\n\n T E S T S\n\n\n\n\n-------------------------------------------------------\n\n\n\n\nRunning com.test.RegionIntegrationTest\n\n\n\n\nTests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.755 sec\n\n\n\n\nRunning com.test.SurveyIntegrationTest\n\n\n\n\nTests run: 9, Failures: 0, Errors: 8, Skipped: 0, Time elapsed: 0.094 sec <<< FAILURE!\n\n\n\n\n\n\n\n\n\nResults :\n\n\n\n\n\n\n\n\n\nTests in error: \n\n\n\n\n  testFlush(com.test.SurveyIntegrationTest)\n\n\n\n\n  testMerge(com.test.SurveyIntegrationTest)\n\n\n\n\n  testPersist(com.test.SurveyIntegrationTest)\n\n\n\n\n  testRemove(com.test.SurveyIntegrationTest)\n\n\n\n\n  testCountSurveys(com.test.SurveyIntegrationTest)\n\n\n\n\n  testFindSurvey(com.test.SurveyIntegrationTest)\n\n\n\n\n  testFindAllSurveys(com.test.SurveyIntegrationTest)\n\n\n\n\n  testFindSurveyEntries(com.test.SurveyIntegrationTest)\n\n\n\n\n\n\n\n\n\nTests run: 18, Failures: 0, Errors: 8, Skipped: 0\n\n\n\n\n\n\nLooking at the Survey&apos;s integration test report:\njavax.persistence.PersistenceException: org.hibernate.PropertyValueException: not-null property references a null or transient value: com.test.Survey.region\nI believe the problem is in the Survey&apos;s data on demand (region is being set to null):\n\n\n\n\n\n\n     \n\n\n\n\npublic Survey SurveyDataOnDemand.getNewTransientSurvey(int index) {    \n\n\n\n\n    com.test.Survey obj = new com.test.Survey();        \n\n\n\n\n    obj.setName(\"name_\" + index);        \n\n\n\n\n    obj.setRegion(null);        \n\n\n\n\n    return obj;        \n\n\n\n\n}    \n\n\n\n\n\n ", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java", "org.springframework.roo.addon.dod.DataOnDemandMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 363, "bug_title": "Perform commands do not work in RC3", "bug_description": "Just dowloaded RC3. \nPerform commands seem not to work at all. Same behavior in sts and in standalone roo she will.\nJust looks like this:\nroo> perform package\nroo>\nI have Maven 2.10 in my path. \nIn previous version (RC2) it did work  (besides the known issue in STS ...)", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.maven.MavenCommands.java"], "label": 1, "es_results": []}, {"bug_id": 387, "bug_title": "The database settings (url / username / password) do not get saved if you specify them when installing JPA", "bug_description": "You need to edit the props file or change the properties from the command line because it ignores them if you pass them as parameters when installing JPA", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.jpa.JpaCommands.java"], "label": 1, "es_results": []}, {"bug_id": 390, "bug_title": "RooIntegrationTest.findAllMaximum attribute is ignored", "bug_description": "I have some 500 - 1000 rows in a few tables, findAll test fails as the default for findAllMaximum is 250 but setting it to 1000 with @RooIntegrationTest(entity = Lab.class, findAllMaximum=1000) has no effect, the test still fails", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.test.IntegrationTestMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 376, "bug_title": "Not able to create field on an existing entity", "bug_description": "Created an entity named Employee added some fields\nCreated another entity named EmpDetails and added some fields\nTried adding one more field to Employee but failed\nTried adding field to EmpDetails and succeeded\nNot sure if I am using the rite versions (Java 1.6?)\nAlso not sure how to use backup\nroo> backup\nThe filename, directory name, or volume label syntax is incorrect\nroo> hint backup\nCannot find topic &apos;backup&apos;", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.backup.BackupOperations.java"], "label": 1, "es_results": []}, {"bug_id": 404, "bug_title": "'addon install' should clean up after itself", "bug_description": "Roo RC3 leaves addon zips in the temp dir after installing them: they should be removed if possible.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.bootstrap.AddOnOperations.java"], "label": 1, "es_results": []}, {"bug_id": 392, "bug_title": "perform command not working on Win 7", "bug_description": "I was following the Roo documentation, specifically section 1.4, and when running the 3 perform commands I get no output.  I was assuming the \"perform tests\" command would generate something similiar to the output I get when running tests from Maven.\nHere is the output:\nroo> version\n    ____  ____  ____\n   / __ \\/ __ \\/ __ \\\n  / /_/ / / / / / / /\n / , _/ // / /_/ /\n// ||___/___/    1.0.0.RC3 [rev 401]\nroo> per\nperform assembly    perform clean       perform command     perform eclipse\nperform package     perform tests       persistence setup\nroo> perform tests\nroo> perform package\nroo> perform eclipse\nroo>", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.maven.MavenCommands.java"], "label": 1, "es_results": []}, {"bug_id": 419, "bug_title": "Controller ITDs do not adjust when a referenced type changes plural", "bug_description": "Currently when an entity&apos;s plural name is changed the relevant controller IT WOULD is updated correctly, however, the controller IT WOULD also needs to be updated when a type referenced by that entity changes.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadataProvider.java", "org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 375, "bug_title": "Custom path controller on the existing project (Reference bug ROO-364)", "bug_description": "Bug ROO-364 has been fixed per my request as of build 415.  However the fix only worked for a brand new project.  I have an existing project with custom path controllers(data/...), and when I ran the latest roo build (419) on it, I get the error message:\n[timerFactory] Illegal name &apos;data/site&apos; (illegal character)", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.web.flow.WebFlowOperations.java", "org.springframework.roo.addon.mvc.jsp.JspMetadataListener.java"], "label": 1, "es_results": []}, {"bug_id": 396, "bug_title": "Controller path does not work", "bug_description": "I&apos;m trying to create a controller scalfold into path: \"admin/client\" but I&apos;m receiving a error:\ncontroller scaffold --name ~.model.ClientController --entity ~.model.Client --path  admin/client\nerror: Illegal name &apos;admin/client&apos; (illegal character)", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.web.flow.WebFlowOperations.java", "org.springframework.roo.addon.mvc.jsp.JspMetadataListener.java"], "label": 1, "es_results": []}, {"bug_id": 357, "bug_title": "workdir jars not removed on addon uninstall on Windows", "bug_description": "Addon jars remain in the work dir after an addon uninstall on Windows. AddOnOperations.cleanUp() uses File.deleteOnExit() for the deletion: my guess is that these files are still locked when the JVM tries to remove them because these jars are listed in java.ext.dirs, and Windows supports locking files that are in use. \nThe only solution I can come up with is that Roo should create a simple text file containing the files to delete and would leave it up to the roo.bat script to delete these files before starting the JVM (could even be done by another Java program started by the script instead of a &apos;del&apos; command, as long as that JVM command doesn&apos;t list the work dir in the java.ext.dirs). \nEvery Java-based solution running just in the Roo JVM will suffer from the fact that the jars are locked already by the same JVM that tries to remove them, so this takes more than a simple code patch; a 2-step process in the .bat file seems like the best bet to me.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.bootstrap.AddOnCommands.java", "org.springframework.roo.shell.ExitShellRequest.java"], "label": 1, "es_results": []}, {"bug_id": 422, "bug_title": "scaffold does not allow \"/\" in \"path\" option", "bug_description": "For a project contains hundreds of pages, it&apos;ll be better if ROO allow more than one level for path of views.\ne.g. I want to put all reference data maintenance pages under /reference/[resource_name]/[pages]\nIt works in RC2, though I notice there&apos;s a minor bug in generated menu.jspx which uses \"/\" in element id.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.web.flow.WebFlowOperations.java", "org.springframework.roo.addon.mvc.jsp.JspMetadataListener.java"], "label": 1, "es_results": []}, {"bug_id": 406, "bug_title": "Little bug with message.properties with scaffold", "bug_description": "If a have a entity B that has a @manyToOne to entity A and generate a scaffold to B and A and after that I change the plural of A, roo doens&apos;t update all jsp references. So, to resolve this bug I need to have 2 entries in my message.properties:\n\n\"label.old_name_of_A= ...\" and \"label.new_name_of_A=...\"\n\nI know, it is a very small bug.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.web.menu.MenuOperations.java"], "label": 1, "es_results": []}, {"bug_id": 447, "bug_title": "Form for finders with enum type are not generated correctly", "bug_description": "Form for finders with enum types are not generated correctly", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java", "org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 451, "bug_title": "Roo auto-generated finder has sql error when fiinding based on two fields", "bug_description": "The Roo-generated finder for my researcher findResearchersBySkillsAndInterests is missing an AND between the interests and the skills\norg.hibernate.hql.ast.QuerySyntaxException: unexpected token: : near line 1, column 123 [SELECT Researcher FROM edu.drexel.goodwin.domain.Researcher AS researcher WHERE :skills_item0 MEMBER OF researcher.skills :interests_item0 MEMBER OF researcher.interests]", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.finder.FinderMetadata.java", "org.springframework.roo.addon.finder.DynamicFinderServicesImpl.java"], "label": 1, "es_results": []}, {"bug_id": 455, "bug_title": "JavaParserMutableClassOrInterfaceTypeDetails.createType(..) fails to create types with correct \"implements\" references", "bug_description": "The JavaParserMutableClassOrInterfaceTypeDetails.createType(..) can be used to create new types. The arguments passed to the method include the list of types the new type should extend, and the list of types the new type should implement. Line 406 of JavaParserMutableClassOrInterfaceTypeDetails appears to be incorrectly handling the types to be implemented.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserMutableClassOrInterfaceTypeDetails.java"], "label": 1, "es_results": []}, {"bug_id": 459, "bug_title": "Hibernate syntaxt exception on finder method for boolean field", "bug_description": "I get a hibernate exception when searching for a boolean value.\norg.hibernate.hql.ast.QuerySyntaxException: unexpected token: : near line 1, column 102 [SELECT Contact FROM ...domain.Contact AS contact WHERE contact.callback NOT :callback]\nthe field definition is:\n\n\n\n\n\n\n    @NotNull\n\n\n\n\n    private Boolean callback;\n\n\n\n\n\n\nthe generated finder is:\n\n\n\n\n\n\n    public static Query Contact.findContactsByCallbackNot(Boolean callback) {    \n\n\n\n\n        if (callback == null) throw new IllegalArgumentException(\"The callback argument is required\");        \n\n\n\n\n        EntityManager them = Contact.entityManager();        \n\n\n\n\n        Query q = them.createQuery(\"SELECT Contact FROM Contact AS contact WHERE contact.callback NOT :callback\");        \n\n\n\n\n        q.setParameter(\"callback\", callback);        \n\n\n\n\n        return q;        \n\n\n\n\n    }    \n\n\n\n\n\n\nAs there is nothing special in my class I think this affects every Boolean fields so I ommited the complete script as this should be reproducable.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.0.RC4", "fixed_files": ["org.springframework.roo.addon.finder.DynamicFinderServicesImpl.java"], "label": 1, "es_results": []}, {"bug_id": 467, "bug_title": "Problem with scaffolded JSP when using RooEntity + identifierField + ManyToOne", "bug_description": "I&apos;m getting a NotReadablePropertyException in the scaffolded &apos;create&apos; and &apos;update&apos; JSPs when using RooEntity + identifierField + ManyToOne.\nI&apos;ve created two entities: Director and Movie. 1 Director has N Movies, and 1 Movie has 1 Director.\nThe Movie has a non default identifierField, as shown below.\n\n\n\n\n\n\n@Entity\n\n\n\n\n@RooJavaBean\n\n\n\n\n@RooToString\n\n\n\n\n@RooEntity\n\n\n\n\npublic class Director {\n\n\n\n\n\n\n\n\n\n    private String name;\n\n\n\n\n\n\n\n\n\n    @OneToMany(cascade = CascadeType.ALL, mappedBy = \"director\")\n\n\n\n\n    private Set<Movie> movies = new HashSet<Movie>();\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n@Entity\n\n\n\n\n@RooJavaBean\n\n\n\n\n@RooToString\n\n\n\n\n@RooEntity(identifierField=\"codMovie\")\n\n\n\n\npublic class Movie {\n\n\n\n\n\n\n\n\n\n    private String title;\n\n\n\n\n\n\n\n\n\n    @Max(10L)\n\n\n\n\n    private Long rating;\n\n\n\n\n\n\n\n\n\n    @ManyToOne(targetEntity = Director.class)\n\n\n\n\n    @JoinColumn\n\n\n\n\n    private Director director;\n\n\n\n\n}\n\n\n\n\n\n\nIn the &apos;create&apos; and &apos;update&apos; JSPs for the Movie entity, the combo box for selecting the Director is using the id from Movie, as shown below:\n\n\n\n\n\n\n<form:select cssStyle=\"width:250px\" id=\"_director_id\" path=\"director\">\n\n\n\n\n  <form:options itemValue=\"codMovie\" items=\"${directors}\"/>\n\n\n\n\n</form:select>\n\n\n\n\n\n\nI had a quick look in the JspDocumentHelper source code, and I think that the problem is on the  following line of the createFieldsForCreateAndUpdate method.\n\n\n\n\n\n\nifElement.appendChild(JspUtils.getSelectBox(document, field.getFieldName(), plural, entityMetadata.getIdentifierField()));\n\n\n\n\n\n\nIt&apos;s using the strong entityMetadata strong variable to get the identifier field, but that is the Movie. It should use the strong typeEntityMetadata strong, that is actually the Director.\nIs my analysis correct?", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC4", "fixed_version": "1.0.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 475, "bug_title": "No postgres driver dependency when choosing postgres as database", "bug_description": "I tried following along with the wedding project using Roo RC4 and decided to switch the database to postgres (using 8.4 right now). When I get to the perform tests step things fail:\nRunning com.wedding.domain.RsvpIntegrationTest\nCannot load JDBC driver class &apos;org.postgresql.Driver&apos;\njava.lang.ClassNotFoundException: org.postgresql.Driver\nThis:\ndependency add --artifactId postgresql --groupId postgresql --version 8.4-701.jdbc4\nfixes the problem, I would have expected this to work ootb.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC4", "fixed_version": "1.0.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.jpa.JdbcDatabase.java"], "label": 1, "es_results": []}, {"bug_id": 483, "bug_title": "Comment handling in scripts", "bug_description": "When running scripts, Roo does not recognise a comment without a space after it, e.g.\n// Comment\nworks, but\n//Comment\ndoes not.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC4", "fixed_version": "1.0.0.RELEASE", "fixed_files": ["org.springframework.roo.shell.internal.AbstractShell.java"], "label": 1, "es_results": []}, {"bug_id": 501, "bug_title": "CLONE -Persistence setup options not taking effect", "bug_description": "seems these options do not have the correct effect.\nWhen I do:\npersistence setup --provider HIBERNATE --database MYSQL --databaseName roofeed --userName root\nManaged SRC_MAIN_RESOURCES/META-INF/persistence.xml\nManaged SRC_MAIN_RESOURCES/META-INF/spring/database.properties\nplease enter your database details in src/main/resources/database.properties\nManaged SRC_MAIN_RESOURCES/META-INF/spring/applicationContext.xml\nI end up with this database.properties:\n#Updated at Thu Dec 10 17:16:33 CET 2009\n#Thu Dec 10 17:16:33 CET 2009\ndatabase.password=\ndatabase.url=jdbc\\:mysql\\://localhost\\:3306\ndatabase.username=\ndatabase.driverClassName=com.mysql.jdbc.Driver", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC3", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.shell.internal.AbstractShell.java"], "label": 1, "es_results": []}, {"bug_id": 512, "bug_title": "ROO managed applications are susceptible to XSS attacks", "bug_description": "Generate an application using the following commands:\nproject --topLevelPackage com.bloudraak.sample.xss\npersistence setup --provider HIBERNATE --database MYSQL \nentity --class ~.models.Item --table items\nfield string --fieldName title \nfield string --fieldName body --sizeMax 4096\ncontroller all --package ~.controllers\nexit\nStart the application by executing \"mvn tomcat:run\".  Create a new \"Item\" and enter \"<script>alert(&apos;Hello Dude&apos;)</script>\" in the description field and save.  Notice a dialog appearing that says \"Hello Dude\".  Also note that when listing all items, the website is \"broken\". \nAlso note that I can \"break\" the application by entering an HTML comment, such as \"<!--\". \nYou can find a few things to check for using this cheat sheet   I would strongly suggest that ROO generates tests to cover these cases so that a developer knows when he breaks the security.  \n", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 534, "bug_title": "database URL being truncated", "bug_description": "When creating a project using the following:\npersistence setup --provider HIBERNATE --database MYSQL\ndatabase properties set --key database.url --value jdbc:mysql://localhost:3306/mydatabase\ndatabase properties set --key database.username --value myuser\ndatabase properties set --key database.password --value mypassword\nThe database.properties file shows:\n#Updated at Thu Jan 14 11:05:58 NZDT 2010\n#Thu Jan 14 11:05:58 NZDT 2010\ndatabase.password=mypassword\ndatabase.url=jdbc\\:mysql\\         << THIS IS GETTING TRUNCATED \ndatabase.username=myuser\ndatabase.driverClassName=com.mysql.jdbc.Driver\nIt is easily fixed my manually updating the database.url to &apos;database.url=jdbc\\:mysql\\://localhost\\:3306/mydatabase&apos;.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.shell.internal.AbstractShell.java"], "label": 1, "es_results": []}, {"bug_id": 526, "bug_title": "Pluralization seems to not work for Enum types", "bug_description": "I am getting a \"Could not determine the plural name\" error in the final line of the following script.\n// start of script\nproject --topLevelPackage com.myco.testapp --projectName testapp\npersistence setup --provider HIBERNATE --database HYPERSONIC_PERSISTENT\nenum type --class ~.reference.AuditEventType\nenum constant --name SomeEventType\nenum constant --name AnotherEventType\nentity --class ~.base.AuditEvent\nfield date --fieldName ts --notNull --class ~.base.AuditEvent --type java.util.Date\nfield ref --fieldName eventType --notNull --type ~.reference.AuditEventType\nfield string --fieldName description --notNull\ncontroller all --package ~.web\n// end of script\nThe exact error is\nCould not determine the plural name for the &apos;eventType&apos; field in AuditEvent\nSo, I added added a @RooPlural(\"eventTypes\") above the eventType field in the AuditEvent class, but continue to get the same message.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.classpath.operations.FieldCommands.java"], "label": 1, "es_results": []}, {"bug_id": 541, "bug_title": "Roo running jdk 1.6 update 18 cannot display messages of green color.", "bug_description": "Roo running jdk 1.6 update 18 can&apos;t display messages of green color.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.email.MailOperations.java", "org.springframework.roo.process.manager.internal.DefaultProcessManager.java", "org.springframework.roo.file.undo.internal.DeleteDirectory.java", "org.springframework.roo.addon.web.flow.WebFlowOperations.java", "org.springframework.roo.addon.jpa.JpaOperations.java", "org.springframework.roo.addon.finder.FinderOperations.java", "org.springframework.roo.addon.maven.MavenCommands.java", "org.springframework.roo.addon.jms.JmsOperations.java", "org.springframework.roo.addon.web.selenium.SeleniumOperations.java", "org.springframework.roo.addon.web.mvc.controller.ControllerOperations.java", "org.springframework.roo.addon.backup.BackupOperations.java", "org.springframework.roo.addon.maven.MavenOperations.java", "org.springframework.roo.classpath.javaparser.JavaParserClassMetadata.java", "org.springframework.roo.bootstrap.Bootstrap.java", "org.springframework.roo.addon.web.mvc.controller.ControllerCommands.java", "org.springframework.roo.shell.SimpleParser.java", "org.springframework.roo.file.monitor.event.LoggingFileEventListener.java", "org.springframework.roo.file.undo.internal.UpdateFile.java", "org.springframework.roo.bootstrap.AddOnOperations.java", "org.springframework.roo.support.logging.HandlerUtils.java", "org.springframework.roo.file.monitor.polling.PollingFileMonitorService.java", "org.springframework.roo.file.undo.internal.CreateFile.java", "org.springframework.roo.file.undo.internal.CreateDirectory.java", "org.springframework.roo.shell.internal.AbstractShell.java", "org.springframework.roo.addon.security.SecurityOperations.java", "org.springframework.roo.metadata.internal.DefaultMetadataDependencyRegistry.java", "org.springframework.roo.file.undo.internal.DeleteFile.java"], "label": 1, "es_results": []}, {"bug_id": 535, "bug_title": "Compiler error on _Roo_Entity.aj  when identifierType is a primitive", "bug_description": "I&apos;ve tried to use a primitive type like identifier. This is an example:\n\n\n\n\n\n\nE1.java\n\n\n\n\n\n\n@Entity\n\n\n\n\n@RooJavaBean\n\n\n\n\n@RooToString\n\n\n\n\n@RooEntity(identifierType=int.class)\n\n\n\n\npublic class E1{\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    @Size(max = 30)\n\n\n\n\n    private String nombre;\n\n\n\n\n\n\n\n\n\n}\n\n\n\n\n\n\nRoo generates the \".aj\" files with no problems. But when I&apos;ve tried to compile with a &apos;perform package&apos; command Maven says:\n\n\n\n\n\n\n\n\n\n\n\n[INFO] [aspectj:compile {execution: default}]\n\n\n\n\n[ERROR] The operator == is undefined for the argument type(s) int, null\n\n\n\n\n[WARNING] advice defined in org.springframework.orm.jpa.aspectj.JpaExceptionTranslatorAspect has not been applied [Xlint:adviceDidNotMatch]\n\n\n\n\n[WARNING] advice defined in org.springframework.mock.staticmock.AnnotationDrivenStaticEntityMockingControl has not been applied [Xlint:adviceDidNotMatch]\n\n\n\n\n[WARNING] advice defined in org.springframework.mock.staticmock.AbstractMethodMockingControl has not been applied [Xlint:adviceDidNotMatch]\n\n\n\n\n[INFO] ------------------------------------------------------------------------\n\n\n\n\n[ERROR] BUILD ERROR\n\n\n\n\n[INFO] ------------------------------------------------------------------------\n\n\n\n\n[INFO] Compiler errors : \n\n\n\n\nerror at if (id == null) throw new IllegalArgumentException(\"An identifier is required to retrieve an instance of E1\");        \n\n\n\n\n    ^\n\n\n\n\n/home/jmvivo/projects/test-roo/test_jpa3/src/main/java/es/gva/cit/testjpa3/domain/E1_Roo_Entity.aj:75:0::0 The operator == is undefined for the argument type(s) int, null\n\n\n\n\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.entity.EntityMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 548, "bug_title": "Plugins in pom.xml that are missing a groupId result in an error message", "bug_description": "I added this to my pom in order to encode my sources with UTF-8:\n<plugin>\n   <artifactId>maven-resources-plugin</artifactId>\n   <version>2.2</version>\n   <configuration>\n      <encoding>UTF-8</encoding>\n   </configuration>\n</plugin>\nWhen I start up Roo, it gives me this error:\nDepenency XML format not supported or is missing a mandatory node (&apos;[plugin: null]&apos;)", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.project.Dependency.java"], "label": 1, "es_results": []}, {"bug_id": 539, "bug_title": "Console does not produce output on jdk 1.6.0_18", "bug_description": "Console does not produce output when running on Sun JDK 1.6.0_18.\nI had to re-install Sun JDK 1.6.0_17 in order to get it working.\nNote that a similar problem was reported in http://forum.springsource.org/showthread.php?t=80983 , except I was using Sun JDK.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.email.MailOperations.java", "org.springframework.roo.process.manager.internal.DefaultProcessManager.java", "org.springframework.roo.file.undo.internal.DeleteDirectory.java", "org.springframework.roo.addon.web.flow.WebFlowOperations.java", "org.springframework.roo.addon.jpa.JpaOperations.java", "org.springframework.roo.addon.finder.FinderOperations.java", "org.springframework.roo.addon.maven.MavenCommands.java", "org.springframework.roo.addon.jms.JmsOperations.java", "org.springframework.roo.addon.web.selenium.SeleniumOperations.java", "org.springframework.roo.addon.web.mvc.controller.ControllerOperations.java", "org.springframework.roo.addon.backup.BackupOperations.java", "org.springframework.roo.addon.maven.MavenOperations.java", "org.springframework.roo.classpath.javaparser.JavaParserClassMetadata.java", "org.springframework.roo.bootstrap.Bootstrap.java", "org.springframework.roo.addon.web.mvc.controller.ControllerCommands.java", "org.springframework.roo.shell.SimpleParser.java", "org.springframework.roo.file.monitor.event.LoggingFileEventListener.java", "org.springframework.roo.file.undo.internal.UpdateFile.java", "org.springframework.roo.bootstrap.AddOnOperations.java", "org.springframework.roo.support.logging.HandlerUtils.java", "org.springframework.roo.file.monitor.polling.PollingFileMonitorService.java", "org.springframework.roo.file.undo.internal.CreateFile.java", "org.springframework.roo.file.undo.internal.CreateDirectory.java", "org.springframework.roo.shell.internal.AbstractShell.java", "org.springframework.roo.addon.security.SecurityOperations.java", "org.springframework.roo.metadata.internal.DefaultMetadataDependencyRegistry.java", "org.springframework.roo.file.undo.internal.DeleteFile.java"], "label": 1, "es_results": []}, {"bug_id": 536, "bug_title": "Generated entity unit tests do not work correctly with numerical data types smaller than int", "bug_description": "In generated unit test *DataOnDemand_Roo_DataOnDemand aspect and its method DataOnDemand.getNewTransientVideoPart(int index) the object&apos;s field is not set properly if it is of a numerical data type smaller than int. Than the project does not compile.\nExample:\nMy entity:\n\n@Entity\n@RooJavaBean\n@RooToString\n@RooEntity\npublic class VideoPart {\n    private short partId;\n}\nand generated test for it:\n\npublic VideoPart VideoPartDataOnDemand.getNewTransientVideoPart(int index) {    \n        com.moteve.domain.VideoPart obj = new com.moteve.domain.VideoPart();        \n        obj.setCaptureTime(new java.util.Date());        \n        obj.setPartId(1); \n. . .\nhere 1 (int) can&apos;t be converted to a short without casting it explicitly.\nFor B/byte it&apos;s also similar.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 508, "bug_title": "Creating an entity called 'Entity' results in compile error", "bug_description": "Creating an entity called Entity in some package results in a Java file that can&apos;t be compiled b/o the import of the javax.persistence.Entity annotation. Roo should either not allow this class name for entities, or it should fully qualify the @Entity annotation in this case instead of using an import.\nCompile error:\n\n\n\n\n\n\n[INFO] [aspectj:compile {execution: default}]\n\n\n\n\n[ERROR] The import javax.persistence.Entity conflicts with a type defined in the same file\n\n\n\n\n[ERROR] Type mismatch: cannot convert from Entity to Annotation\n\n\n\n\n[WARNING] advice defined in org.springframework.orm.jpa.aspectj.JpaExceptionTranslatorAspect has not been applied [Xlint:adviceDidNotMatch]\n\n\n\n\n[WARNING] advice defined in org.springframework.mock.staticmock.AnnotationDrivenStaticEntityMockingControl has not been applied [Xlint:adviceDidNotMatch]\n\n\n\n\n[WARNING] advice defined in org.springframework.mock.staticmock.AbstractMethodMockingControl has not been applied [Xlint:adviceDidNotMatch]\n\n\n\n\n[WARNING] advice defined in org.springframework.mock.staticmock.AbstractMethodMockingControl has not been applied [Xlint:adviceDidNotMatch]\n\n\n\n\n[INFO] ------------------------------------------------------------------------\n\n\n\n\n[ERROR] BUILD ERROR\n\n\n\n\n[INFO] ------------------------------------------------------------------------\n\n\n\n\n[INFO] Compiler errors :\n\n\n\n\nerror at import javax.persistence.Entity;\n\n\n\n\n       ^^^^^^^^^^^^^^^^^^^^^^^\n\n\n\n\nC:\\java\\roo-projects\\GA\\src\\main\\java\\com\\springsource\\rootest\\Entity.java:3:0::0 The import javax.persistence.Entity conflicts with a type defined in the same file\n\n\n\n\nerror at @Entity\n\n\n\n\n ^^^^^\n\n\n\n\nC:\\java\\roo-projects\\GA\\src\\main\\java\\com\\springsource\\rootest\\Entity.java:9:0::0 Type mismatch: cannot convert from Entity to Annotation\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.classpath.javaparser.details.JavaParserFieldMetadata.java", "org.springframework.roo.classpath.javaparser.JavaParserMutableClassOrInterfaceTypeDetails.java", "org.springframework.roo.classpath.javaparser.details.JavaParserMethodMetadata.java", "org.springframework.roo.classpath.javaparser.JavaParserUtils.java", "org.springframework.roo.classpath.javaparser.details.JavaParserAnnotationMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 559, "bug_title": "Doco error: incorrect explanation of sizeMax and sizeMin options for \"field set\" command", "bug_description": "The reference docs for the \"field set\" command (http://static.springsource.org/spring-roo/reference/html/command-index.html#command-index-field-set) contain these argument descriptions:\n--sizeMin The minimum string length; no default value\n--sizeMax The maximum string length; no default value \nAs agreed by Stefan in the forum and as documented here for the @Size annotation:\nhttp://java.sun.com/javaee/6/docs/api/index.html?javax/validation/constraints/Size.html\n... these arguments actually relate to the minimum and maximum size of the set (i.e. the number of elements it contains), not the length of any strings.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.classpath.operations.FieldCommands.java"], "label": 1, "es_results": []}, {"bug_id": 562, "bug_title": "DataOnDemand does not work with non-null self-references", "bug_description": "When I run this script:\n\n\n\n\n\n\nproject --topLevelPackage foo\n\n\n\n\npersistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY\n\n\n\n\nentity --class ~.Person --testAutomatically\n\n\n\n\nfield reference --fieldName lastChangedBy --type ~.Person --notNull\n\n\n\n\n\nI get this error:\n\n\n\n\n\n\nproject --topLevelPackage foo\n\n\n\n\nCreated G:\\workspace-sts\\asset-manager\\pom.xml\n\n\n\n\nCreated SRC_MAIN_JAVA\n\n\n\n\nCreated SRC_MAIN_RESOURCES\n\n\n\n\nCreated SRC_TEST_JAVA\n\n\n\n\nCreated SRC_TEST_RESOURCES\n\n\n\n\nCreated SRC_MAIN_WEBAPP\n\n\n\n\nCreated SRC_MAIN_RESOURCES\\META-INF\\spring\n\n\n\n\nCreated SRC_MAIN_RESOURCES\\META-INF\\spring\\applicationContext.xml\n\n\n\n\nCreated SRC_MAIN_RESOURCES\\META-INF\\spring\\log4j.properties\n\n\n\n\npersistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY\n\n\n\n\nCreated SRC_MAIN_RESOURCES\\META-INF\\persistence.xml\n\n\n\n\nCreated SRC_MAIN_RESOURCES\\META-INF\\spring\\database.properties\n\n\n\n\nManaged SRC_MAIN_RESOURCES\\META-INF\\spring\\applicationContext.xml\n\n\n\n\nManaged ROOT\\pom.xml\n\n\n\n\nentity --class ~.Person --testAutomatically\n\n\n\n\nCreated SRC_MAIN_JAVA\\foo\n\n\n\n\nCreated SRC_MAIN_JAVA\\foo\\Person.java\n\n\n\n\nCreated SRC_TEST_JAVA\\foo\n\n\n\n\nCreated SRC_TEST_JAVA\\foo\\PersonDataOnDemand.java\n\n\n\n\nCreated SRC_TEST_JAVA\\foo\\PersonIntegrationTest.java\n\n\n\n\nCreated SRC_MAIN_JAVA\\foo\\Person_Roo_Entity.aj\n\n\n\n\nCreated SRC_MAIN_JAVA\\foo\\Person_Roo_ToString.aj\n\n\n\n\nCreated SRC_MAIN_JAVA\\foo\\Person_Roo_Configurable.aj\n\n\n\n\nCreated SRC_TEST_JAVA\\foo\\PersonDataOnDemand_Roo_Configurable.aj\n\n\n\n\nCreated SRC_TEST_JAVA\\foo\\PersonDataOnDemand_Roo_DataOnDemand.aj\n\n\n\n\nCreated SRC_TEST_JAVA\\foo\\PersonIntegrationTest_Roo_Configurable.aj\n\n\n\n\nCreated SRC_TEST_JAVA\\foo\\PersonIntegrationTest_Roo_IntegrationTest.aj\n\n\n\n\nfield reference --fieldName lastChangedBy --type ~.Person --notNull\n\n\n\n\nManaged SRC_MAIN_JAVA\\foo\\Person.java\n\n\n\n\nCreated SRC_MAIN_JAVA\\foo\\Person_Roo_JavaBean.aj\n\n\n\n\nManaged SRC_MAIN_JAVA\\foo\\Person_Roo_ToString.aj\n\n\n\n\nUndo manage SRC_MAIN_JAVA\\foo\\Person_Roo_ToString.aj\n\n\n\n\nUndo create SRC_MAIN_JAVA\\foo\\Person_Roo_JavaBean.aj\n\n\n\n\nUndo manage SRC_MAIN_JAVA\\foo\\Person.java\n\n\n\n\nUpstream dependency cannot be the same as the downstream dependency (&apos;MID:org.springframework.roo.addon.dod.DataOnDemandMetadata#SRC_TEST_JAVA?foo.PersonDataOnDemand&apos;)\n\n\n\n\nScript execution aborted\n\n\n\n\n\n\nIf I remove either the --testAutomatically or the --notNull, the script works fine.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 540, "bug_title": "create.jspx and update.jspx missing fields from entity", "bug_description": "When creating an entity with a ManyToOne relationship, the create.jspx and update.jspx for the entity at the One end of the relationship does not include a UI component for the Many end. This is fine, but sometimes when an entity includes this type of relationship then other fields (for example, of type string) are not generated.\nThere appears to be a bug in:\nhttps://anonsvn.springframework.org/svn/spring-roo/release-1.0.0.RELEASE/addon-web-mvc-jsp/src/main/java/org/springframework/roo/addon/mvc/jsp/JspDocumentHelper.java\nIn the createFieldsForCreateAndUpdate() method. See line 674. There is a return statement which would stop the generation of any subsequent fields.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 543, "bug_title": "Multiselect not getting fully selected on update", "bug_description": "I have a Researcher object that has many Interests and Skills. When I edit a researcher the skills and interests multiselect boxes do not get correctly bound, so if I just submit they will be almost all erased (all but the first interest). \nThe weird thing is that if you view source the correct skills and interests option tags are marked as selected=\"selected\", although they are not highlighted for me as a user and they are not considered selected when I submit the form (because if I submit they are wiped out).\nIs there something wrong with dojo MultiSelect widgit? \nYou might be able to reproduce the problem with this partial script:\n..all of the project and persistence setup\nentity --class ~.domain.Interest \nfield string --fieldName name\nentity --class ~.domain.Skill \nfield string --fieldName name\nentity --class ~.domain.Researcher \nfield set --fieldName interests --element ~.domain.Interest \nfield set --fieldName skills --element ~.domain.Skill \ncontroller scaffold all\nIf you create a few skills and interests and then create a researcher you should see the problem.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java"], "label": 1, "es_results": []}, {"bug_id": 563, "bug_title": "\"finder list\" only listing \"NOT\" option for boolean field", "bug_description": "Exactly as I wrote in the forum.\nHi guys!\nI&apos;ve got an entity that has a boolean field.\nWhen I type the command \"finder list\" in Roo She Will, it only lists the corresponding finder with the NOT modifier. For example:\nLet&apos;s suppose an entity named \"Foo\" with a boolean field named \"enabled\", if I type the command \"finder list\", Roo will show:\n.....\nfindFoosByEnabledNot(Boolean enabled)\n...\nAnd not the option\n...\nfindFoosByEnabled(Boolean enabled)\n...\nNevertheless Roo only doesn&apos;t list it, because if I type:\n...\nfinder add --finderName findFoosByEnabled\nRoo effectively generates the corresponding code.\nWhat I&apos;m pointing in this post is that this situation is a bit confusing and sometimes funny, in my case i used the findFoosByEnabledNot option and of course it was listing the opposite option I was looking for!!!!\nI&apos;m submitting the corresponding JIRA later ", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.finder.DynamicFinderServicesImpl.java"], "label": 1, "es_results": []}, {"bug_id": 574, "bug_title": "Flawed persistence when using Hypersonic", "bug_description": "When using a persistent Hypersonic database (via persistence setup --provider HIBERNATE --database HYPERSONIC_PERSISTENT), two artifacts should be generated differently:\n(1) META-INF/spring/database.properties: the connection string should contain the parameter ;shutdown=true, so that HSQLDB correctly writes any changes to disk when you stop Tomcat\n(2) persistence.xml: the default setting for hibernate.hbm2ddl.auto should be update\nEverything else will lead to side-effects which a user will not expect from a persistent setup.\nApart from that ... keep up the great work! I&apos;m excited to see where Roo will go.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.jpa.JdbcDatabase.java"], "label": 1, "es_results": []}, {"bug_id": 568, "bug_title": "DataOnDemand for OneToOne relationships should be more robust", "bug_description": "This bug is closely related to the linked issues about @OneToOne (cyclic toString() bug and \"field reference\" imrpovement).\nGenerated tests for \"reference\" relationships pick random target entity when feeding the reference.\nThis is fine for @ManyToOne relationships, but wrong for @OneToOne : randomisation will return several time same target entity.\nSo DataOnDemand should pick random target entity out of remaining ones when relationship is @OneToOne.\nHere is a minimal script to reproduce, along with a little manual editing :\nproject --topLevelPackage fr.free.hd.ch4mp.onetoone\npersistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY\nentity --class ~.domain.Person --testAutomatically\nentity --class ~.domain.DrivingLicense --testAutomatically\nfield string firstName --notNull --class ~.domain.Person\nfield string lastName --notNull --class ~.domain.Person\nfield number --fieldName points --type java.lang.Integer --notNull --min 0 --max 12 --class ~.domain.DrivingLicense\ncontroller all --package ~.web\nDrivingLicense.java editing :\nimport javax.persistence.JoinColumn;\nimport javax.persistence.OneToOne;\n...\n    @NotNull\n    @OneToOne(targetEntity = Person.class)\n    @JoinColumn\n    private Person owner;\nPerson.java editing :\nimport javax.persistence.CascadeType;\nimport javax.persistence.OneToOne;\n...\n    @OneToOne(targetEntity = DrivingLicense.class, cascade = CascadeType.ALL, mappedBy = \"owner\")\n    private DrivingLicense drivingLicense;\nperform test should fail.\nEditing DrivingLicenseDataOnDemand_Roo_DataOnDemand.aj and changing personDataOnDemand.getRandomPerson() call to Person.findPerson(new Long(index)) would be sufficient for tests to pass.", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1167, "bug_title": "@Column unique and validator", "bug_description": "It would be nice to be able to put different columns as unique with JPA from ROO, and get validators placed which work along with @Valid.\nBut it is rather easy even without an addon, I gathered a solution from the forums and documented it for my self at http://hatimonline.com/2010/08/04/spring-roo-and-spring-security-tutorial-0/", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.1.0.M3", "fixed_files": ["org.springframework.roo.classpath.operations.FieldCommands.java", "org.springframework.roo.classpath.operations.jsr303.FieldDetails.java"], "label": 1, "es_results": []}, {"bug_id": 173, "bug_title": "Add ability to define field uniqueness constraints", "bug_description": "I think it would be a useful feature for Roo to provide a way to define a field, or set of fields, as unique. For example, when adding a new field to a class:\nadd field string -fieldName myField -unique ....\nThat would then create a database column with a uniqueness constraint? Otherwise I will have to go in and manually add this constraint to all the columns that need it in the db.\nAlso, it would be nice to be able to define multiple-column uniqueness constraints such as in MySql:\nUNIQUE KEY &apos;userId_2&apos; (&apos;userId&apos;,&apos;customerId&apos;)", "project": "Spring", "sub_project": "ROO", "version": "1.0.0.RC1", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.classpath.operations.FieldCommands.java", "org.springframework.roo.classpath.operations.jsr303.FieldDetails.java"], "label": 1, "es_results": []}, {"bug_id": 570, "bug_title": "Outdated DTD on Tiles configuration files", "bug_description": "The generated Tiles configuration files use the following DTD:\n<!DOCTYPE tiles-definitions PUBLIC \"-//Apache Software Foundation//DTD Tiles Configuration 2.0//EN\" \"http://tiles.apache.org/dtds/tiles-config_2_0.dtd\">\nwhich is for the 2.0 release and doesn&apos;t contain some features found in the 2.1 release\nshould be:\n<!DOCTYPE tiles-definitions PUBLIC \"-//Apache Software Foundation//DTD Tiles Configuration 2.1//EN\" \"http://tiles.apache.org/dtds/tiles-config_2_1.dtd\">", "project": "Spring", "sub_project": "ROO", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.TilesOperations.java"], "label": 1, "es_results": []}, {"bug_id": 578, "bug_title": "Incorrect help text for \"finder add\" command when invalid finder name entered", "bug_description": "For any entity, enter this command:\n\n\n\n\n\n\nfinder add --finderName f\n\n\n\n\n\n\nRoo will respond with:\n\n\n\n\n\n\nrequired --finderName: The finder string as generated with &apos;list finders for&apos;; no default value\n\n\n\n\n\n\nThe problem is that there is no \"list finders for\" command; it&apos;s actually the \"finder list\" command.", "project": "Spring", "sub_project": "ROO", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.finder.FinderCommands.java"], "label": 1, "es_results": []}, {"bug_id": 615, "bug_title": "Incorrect elementId in finder view for multi-word fields", "bug_description": "If you create a project using this script:\n\n\n\n\n\n\nproject --topLevelPackage casing\n\n\n\n\npersistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY \n\n\n\n\nentity --class Car\n\n\n\n\nentity --class Person\n\n\n\n\nfield reference --fieldName rentalCar --type ~.Car\n\n\n\n\nfinder list --class ~.Person\n\n\n\n\nfinder add --finderName findPeopleByRentalCar\n\n\n\n\ncontroller all --package ~.web\n\n\n\n\n\n\nThen the generated findPeopleByRentalCar.jspx view will contain this markup (tidied a bit here):\n\n\n\n\n\n\n<label for=\"_rentalcar_id\">Rental Car:</label>\n\n\n\n\n<select id=\"_rentalcar_id\" name=\"rentalcar\">\n\n\n\n\n    <c:forEach items=\"${cars}\" var=\"rentalcar_item\">\n\n\n\n\n        <option value=\"${rentalcar_item.id}\">${rentalcar_item}</option>\n\n\n\n\n    </c:forEach>\n\n\n\n\n</select>\n\n\n\n\n<script type=\"text/javascript\">\n\n\n\n\n    Spring.addDecoration(new Spring.ElementDecoration({\n\n\n\n\n        elementId: &apos;_rentalCar_id&apos;,\n\n\n\n\n        widgetType: &apos;dijit.form.FilteringSelect&apos;,\n\n\n\n\n        widgetAttrs: {hasDownArrow : true}\n\n\n\n\n    }));\n\n\n\n\n</script>\n\n\n\n\n\n\nThe bug is that the decoration&apos;s elementId \"_rentalCar_id\" is differently cased to the select tag&apos;s id of \"_rentalcar_id\". The impact is that the decoration is not applied, so the drop-down looks and behaves like a plain HTML dropdown.", "project": "Spring", "sub_project": "ROO", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.mvc.jsp.DojoUtils.java", "org.springframework.roo.addon.mvc.jsp.JspDocumentHelper.java", "org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 619, "bug_title": "@RooJavaBean does not allow for final fields when settersByDefault is set to false", "bug_description": "@RooJavaBean has a \"settersByDefault\" attribute that you can set to false to only generate getters for all your properties.  As a user, I was expecting to also be able to mark such properties final.  However, once I did that Roo no longer managed those fields.", "project": "Spring", "sub_project": "ROO", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.javabean.JavaBeanMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 618, "bug_title": "AutoPopulationUtils fails to set @AutoPopulate fields with array value unless input annotation in array form", "bug_description": "If I have a Roo-managed \"Pizza\" entity annotated thus:\n\n\n\n\n\n\n@RooEntity\n\n\n\n\n\n\nand I add this \"finders\" element to it:\n\n\n\n\n\n\n@RooEntity(finders = \"findPizzasByName\")\n\n\n\n\n\n\nthen nothing happens in the Roo she will. It&apos;s only when I add the curly braces like this:\n\n\n\n\n\n\n@RooEntity(finders = {\"findPizzasByName\"})\n\n\n\n\n\n\nthat Roo creates the Pizza_Roo_Finder.aj file. Yet the compiler is happy without the braces, and all other annotations I&apos;ve worked with are equally happy without the braces. Ben reckons this looks like a Roo bug.", "project": "Spring", "sub_project": "ROO", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.roo.classpath.details.annotations.populator.AutoPopulationUtils.java"], "label": 1, "es_results": []}, {"bug_id": 589, "bug_title": "Setting method names to blank on @RooEntity does not prevent those methods from being generated", "bug_description": "Setting methods names to blank on @RooEntity does not prevent those methods from being generated the same way versionField=\"\" does, the settings appear to be ignored.\nMy specific requirement is to make an Entity read only (persistMethod=\"\", removeMethod=\"\", mergeMethod=\"\") but all of the method name attributes should probably work the same way.", "project": "Spring", "sub_project": "ROO", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java", "org.springframework.roo.addon.entity.EntityMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 576, "bug_title": "Restore handling of imports in generated .java types", "bug_description": "Currently, Roo generated .java files contain only fully qualified types. The import resolution mechanism seems broken.\nThis looks like a regression between the 1.0.0 release and 1.0.1 release.", "project": "Spring", "sub_project": "ROO", "version": "1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserUtils.java"], "label": 1, "es_results": []}, {"bug_id": 946, "bug_title": "Unit tests fail when DoD-generated values for String fields annotated with @Size are outside the range of the specified min and/or max attribute values", "bug_description": "When generated data on demand values for fields are not within the length range specified in the @Size annotation, unit tests fail during a persist(). ", "project": "Spring", "sub_project": "ROO", "version": "1.0.2.RELEASE", "fixed_version": "1.1.0.M2", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 864, "bug_title": "Give more details with error message \"The entire package name must be lowercase\"", "bug_description": "When starting roo, I receive the message \"The entire package name must be lowercase\".\nRoo starts but I cannot execute any commands.\nI found where the message is thrown in an AssertTrue statement assumption. \nI found where in the ROO code that throws the assertion: https://src.springframework.org/svn/spring-roo/branches/branch-1.0.x/model/src/main/java/org/springframework/roo/model/JavaPackage.java\nThe problem is I am unsure where or how to find out what could be wrong with my code.  \nThis is a project that has been running just fine.  I deleted some classes and now I cannot get roo to run.\nBased upon the assertion, it is running as specified so it may not be a bug, but I cannot figure out where in the load process it is failing.", "project": "Spring", "sub_project": "ROO", "version": "1.0.2.RELEASE", "fixed_version": "1.1.0.M2", "fixed_files": ["org.springframework.roo.model.JavaPackage.java"], "label": 1, "es_results": []}, {"bug_id": 1119, "bug_title": "cannot create a string field with sizeMax=1 and sizeMin=1", "bug_description": "When trying to create a string field with sizeMax=1 and sizeMin=1, the field isn&apos;t created. If you use any other size, the field is created correctly (ie field string --fieldName geoHashPrecision2 --sizeMax 2 --sizeMin 2 creates a field with @Size(min = 2, max = 2)).\nHere is the console output:\n\n\n\n\n\n\nroo> field string --fieldName geoHashPrecision1 --sizeMax 1 --sizeMin 1\n\n\n\n\nManaged SRC_MAIN_JAVA/com/ff/model/GeographicPoint.java\n\n\n\n\nManaged SRC_MAIN_JAVA/com/ff/model/GeographicPoint_Roo_JavaBean.aj\n\n\n\n\nManaged SRC_MAIN_JAVA/com/ff/model/GeographicPoint_Roo_ToString.aj\n\n\n\n\nUndo manage SRC_MAIN_JAVA/com/ff/model/GeographicPoint_Roo_ToString.aj\n\n\n\n\nUndo manage SRC_MAIN_JAVA/com/ff/model/GeographicPoint_Roo_JavaBean.aj\n\n\n\n\nUndo manage SRC_MAIN_JAVA/com/ff/model/GeographicPoint.java\n\n\n\n\nString index out of range: -1\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M2", "fixed_version": "1.1.0.M3", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1112, "bug_title": "Web scaffold: bad handling of self-referencing parent-child entity relationships", "bug_description": "When I create an entity with a parent-child relationship that references back to the same entity type, the generated web scaffold will not allow me to edit the relationship.\nSteps to reproduce:\nExecute the following code in Roo:-\nproject --topLevelPackage com.example.test \npersistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY\nentity --class ~.entities.Node\nfield string name --sizeMax 30 --notNull\nfield reference --fieldName parent --type ~.entities.Node --cardinality ONE_TO_ONE\nfield set --fieldName children --element ~.entities.Node --cardinality ONE_TO_MANY --mappedBy parent\ncontroller all --package ~.web\n[end Roo code]\nNext start up Tomcat with: mvn tomcat:run\nPoint a browser at http://localhost:8080/test \nCreate a new &apos;Node&apos;. Now, go to create a second &apos;Node&apos; - in the form it shows:-\nParent: [create-new button] No Parent found.\nChildren:This relationship is managed from the Node side.\nWhich isn&apos;t correct.\nExpected behaviour:\nOn creating the second entity, there should either be (a) a drop-down list for choosing a &apos;Parent&apos;, where any pre-existing entities should appear / be selectable (as you get when you have a one-to-one relationship between differing entity types)  or (b) there should be a multi-select list for choosing &apos;Children&apos; (as you get when you have a one-to-many relationship between differing entity types).\nI think perhaps option (a) - allowing selection of a parent - is the correct/easiest thing to do in this situation.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M2", "fixed_version": "1.1.0.M3", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1172, "bug_title": "Invalid message codes generated in Web MVC scaffolding", "bug_description": "JspViewManager produces field.invalid.integer instead of field_invalid_integer", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M2", "fixed_version": "1.1.0.M3", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspViewManager.java"], "label": 1, "es_results": []}, {"bug_id": 1206, "bug_title": "Suppress generation of labels for entity identifier and version fields for Web MVC scaffolding", "bug_description": "Suppress generation of labels for entity identifier and version fields for Web MVC scaffolding", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M2", "fixed_version": "1.1.0.M3", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspMetadataListener.java"], "label": 1, "es_results": []}, {"bug_id": 1210, "bug_title": "Import statements missing package name.", "bug_description": "I have a class SignCommand annotated with @RooJavaBean and with this property:\nsomepackage.SomeClass.Enum sslRef;\nFor this roo generates this getter:\n    public Enum SignCommand.getSslRef() \n{\n        return this.sslRef;\n    }\n\nwhich is fine, but it imports SomeClass.Enum without package name, so the import can&apos;t be resolved.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M2", "fixed_version": "1.1.0.M3", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserUtils.java"], "label": 1, "es_results": []}, {"bug_id": 1258, "bug_title": "When adding dependency via 'dependency add' command ROO resets the topLevelPackage to the groupId of added dependency", "bug_description": "Here is the script:\n\n\n\n\n\n\nroo> project --topLevelPackage sample.travel.demo --projectName sample-travel-demo\n\n\n\n\n. . . .\n\n\n\n\nsample.travel.demo roo> dependency add --groupId legacy-travel --artifactId legacy-travel-transformer --version 1.1\n\n\n\n\nManaged ROOT/pom.xml [Added dependency legacy-travel:legacy-travel-transformer:1.1]\n\n\n\n\nlegacy-travel roo> interface --class HelloGateway\n\n\n\n\nCreated SRC_MAIN_JAVA/legacy-travel\n\n\n\n\nCreated SRC_MAIN_JAVA/legacy-travel/HelloGateway.java\n\n\n\n\nlegacy-travel.HelloGateway roo>\n\n\n\n\n\n\nThis is actually a major issue, since it requires someone to create classes/interfaces before they add a dependency", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M2", "fixed_version": "1.1.0.M3", "fixed_files": ["org.springframework.roo.addon.dbre.DbreCommands.java", "org.springframework.roo.classpath.converters.JavaPackageConverter.java", "org.springframework.roo.addon.maven.MavenCommands.java", "org.springframework.roo.addon.creator.CreatorCommands.java", "org.springframework.roo.addon.web.mvc.controller.ControllerCommands.java"], "label": 1, "es_results": []}, {"bug_id": 1260, "bug_title": "addon-gwt cannot handle enums or booleans", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.gwt.GwtMetadata.java", "org.springframework.roo.addon.gwt.GwtPath.java", "org.springframework.roo.addon.gwt.GwtMetadataProvider.java", "org.springframework.roo.addon.gwt.GwtOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1339, "bug_title": "IdentifierMetadata not correctly handling short and char primitives in generated equals and hashCode methods", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.entity.IdentifierMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1351, "bug_title": "Maven dependency not added to project's pom.xml when the jdbc driver is used for more than one database", "bug_description": "When executing the \"persistence setup\" command, the maven dependency for the selected --database is removed if the JDBC driver is the same for more than one database provider. For example, MS SQL and Sybase use the same driver, jTDS. ", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.project.Dependency.java", "org.springframework.roo.addon.jpa.JpaOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1307, "bug_title": "Generated code in gwt interface records does not compile", "bug_description": "Wrong imports and code using an entity with integers and double. \nSteps:\nproject --topLevelPackage com.test.roo --projectName TestRoo --java 6\npersistence setup --database GOOGLE_APP_ENGINE --provider DATANUCLEUS \nentity --class ~.datos.Pedido --testAutomatically --identifierColumn id\nfield string --fieldName descripcion --sizeMin 5\nfield date --fieldName fecha --type java.util.Date\ngwt setup\nentity --class ~.datos.LineaPedido --testAutomatically --identifierColumn id\nAdded manually 2 fields with type integer and double:\n@Entity\n@RooJavaBean\n@RooToString\n@RooEntity(identifierColumn = \"id\")\npublic class Pedido {\n    @Size(min = 5)\n    private String descripcion;\n    @Temporal(TemporalType.TIMESTAMP)\n    @DateTimeFormat(style = \"S-\")\n    private Date fecha;\n    private int numeroLineas; // added manually\n    private double precio;   // added manually\n}\nThe generated class PedidoRecord has compile errors:\nimport com.test.roo.gwt.request.IntegerRecord; // does not exist\nimport com.test.roo.gwt.request.DoubleRecord;   // does not exist\n@RooGwtMirroredFrom(Pedido.class)\n@DataTransferObject(Pedido.class)\npublic interface PedidoRecord extends Record {\n    public String TOKEN = \"PedidoRecord\";\n    Property<com.test.roo.gwt.request.IntegerRecord> numeroLineas = new com.google.gwt.valuestore.shared.Property<com.test.roo.gwt.request.IntegerRecord>(\"numeroLineas\", \"Numero Lineas\", com.test.roo.gwt.request.IntegerRecord.class);\n    Property<com.test.roo.gwt.request.DoubleRecord> precio = new com.google.gwt.valuestore.shared.Property<com.test.roo.gwt.request.DoubleRecord>(\"precio\", \"Precio\", com.test.roo.gwt.request.DoubleRecord.class);\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M2", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.gwt.GwtMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1385, "bug_title": "Exception while creating roo addon ", "bug_description": "I am trying to create a simple addon using the script provided with the roo 1.1.0M3 zip but I am getting this error \nCould not locate &apos;/org/springframework/roo/addon/creator/simple\\roo-addon-simple-template.xml&apos; in classloader\nScript execution aborted\nCan anybody please help me solve this problem?", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.creator.CreatorOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1404, "bug_title": "Roo source code does not compile with Java 5", "bug_description": "\nCompilation failure\nclasspath/src/main/java/org/springframework/roo/classpath/operations/HintOperationsImpl.java:[64,44]\ncannot find symbol\nsymbol  : method keySet()\nlocation: class java.util.ResourceBundle\nkeySet method is available since 1.6 version\n http://download.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.classpath.operations.HintOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1418, "bug_title": "Max size of a string field causing test integration to fail", "bug_description": "There seems to be an issue with the test data generated for the Integration Tests used with &apos;perform tests&apos;.\nSteps to reproduce:\n1. Modify clinic.roo, change AbstractPersion firstName maxSize to 19\n2. run the script\n3. run perform tests\nBuild Failure occurrs\n[Thread-8] Tests in error:\n[Thread-8]   testPersist(com.springsource.petclinic.domain.OwnerIntegrationTest)\n[Thread-8]   testPersist(com.springsource.petclinic.domain.VetIntegrationTest)\nFrom what I have been able to figure, it has something to do with how the test data is being created.  The data it&apos;s using to put in the firstName field is causing the error.\nIt also seems to be dependant on the size of the field name.  So 19 causes the issue, 20 doesn&apos;t, but if you remove a character from the fieldName you can get 19 to work.\ni.e. max=19, field name =firstNam (removed one character to make the field name shorter)\nNow it starts failing at max=18 and works at max=19.\nSame the other way, if you add a charater to the field name, it starts failing at 20 (i.e. max=19, field name = firstName1)\nSo I assume there is some test data function that is using the field name and is creating test data that is bigger than the max field size.\nSeems to be creating data field name size + 11 and the error occurs when field name is greater than max-11\nSo end result name of a string field can&apos;t be more than max size of field - 11, and\nsetting --sizeMax < 12 will never allow the integration tests to pass successfully.\nI included a couple modified clinic.roo scripts that show the error.\nclinic-test1-fail.roo - set the max size of the firstName field to 19\nclinic-test1-success.roo - reduce the size of the fieldName by one to firstNam\nclinic-test2-fail.roo - increase the size of the fieldName by one to firstName1\nclinic-test3-fail.roo - add new string field with long fieldName and short maxSize (personCode --sizeMax 3)\nclinic-test4-success.roo - add new string field with short fieldName &apos;a&apos; and maxSize 12\nclinic-test4-fail.roo - add new string field with short fieldName &apos;a&apos; and maxSize 11", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1415, "bug_title": "Addon create fails on Windows platform", "bug_description": "Command addon create advance --topLevelPackage test and addon create simple --topLevelPackage test fails on Windows with:\nCould not locate &apos;/org/springframework/roo/addon/creator/simple\\roo-addon-advanced-template.xml in classloader.\nOn Mac OS it works fine.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.creator.CreatorOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1357, "bug_title": "Java keywords are generated for entity type variable names.", "bug_description": "When an entity has the same name as a java keyword the variable names used/created by the controller script because the generated files to be invalid/erroneous.\nie.\n   entity --class ~.products.Package\nwill create method signatures on controller aspects which call something like:\n   doSomethingWith(Package package)\nthis will not compile correctly due to the package keyword being used as a variable.\nI assume that this problem will occur for most java keywords as well as those used by aspectj.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.solr.SolrMetadata.java", "org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1423, "bug_title": "DataOnDemand code invalid when @Min and @Max annotations are used on an entity field", "bug_description": "When specifying a @Min(?L) and @Max(?L) annotation on an entity field the DataOnDemand aspect that gets generated for that entity contains a compilation error. Code that gets generated for \n\n\n\n\n\n\nMyBean.java\n\n\n\n\n\n\n...\n\n\n\n\n@Min(0L)\n\n\n\n\n@Max(100L)\n\n\n\n\nprivate long total;\n\n\n\n\n...\n\n\n\n\n\n\nis \n\n\n\n\n\n\nMyBeanDataOnDemand_Roo_DataOnDemand.aj\n\n\n\n\n\n\n...\n\n\n\n\npublic MyBean MyBeanDataOnDemand.getNewTransientMyBean(int index) {\n\n\n\n\n   ...\n\n\n\n\n   java.lang.Long total = new Integer(index).longValue();\n\n\n\n\n   if (total < 0L || total > L100) { // Should be 100L instead of L100\n\n\n\n\n       total = 100L;\n\n\n\n\n   }\n\n\n\n\n...\n\n\n\n\n}\n\n\n\n\n\n\nNote the greater than condition is invalid.\nThis only seems to happen when both a @Min and @Max annotations are present together. Having either on it&apos;s own works fine.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1353, "bug_title": "Stale sha info in Roo she will in STS", "bug_description": "Set up STS 2.5.0.M3 Build Id: 201008251000 to use a roo built from source\nMake or import a roo project and note the sha it shows when the she will starts\nClose the she will\nCommit a change to git and rebuild roo\nrm -rf spring-roo/bootstrap/target/osgi\nrun roo-dev somewhere\nNow open a roo she will again. Note that that it&apos;s still reporting the old sha. But it&apos;s pretty clear that it&apos;s actually running the new bits that you built. Looks like the code that displays that sha is pulling it from some stale cached location. \nA minor bug, perhaps, but it just sent me on a bit of a wild goose chase.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.shell.AbstractShell.java"], "label": 1, "es_results": []}, {"bug_id": 1451, "bug_title": "roo generated controllers and scaffolding is unable to support non-numeric keys", "bug_description": "I created a few entities and I annotated one of my entity attributes with the @Id annotation and I took off the autogenerated annotation.  I let roo regen the jspx and controller scaffolding and everything seemed fine until I tried to enter a string into the key that contained a \"/\" in it.  The entity is called gl and the key is called glAccount.  When I attempt to enter the gl of \"A/R\", the post (create) controller fires as it should then it redirects to \"redirect:/gl/\"+entity.getGlAccount();  which ends up having a url of GET(\"/gl/A/R\")  which should be \"/gl/A%2fR\".  Please update the scaffolding to escape the id values when creating links in the tagx files and in the controllers.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1510, "bug_title": "Entity command does not honor --abstract modifier", "bug_description": "When creating an abstract entity via the Roo she will:\n\n\n\n\n\n\nentity --class ... --abstract\n\n\n\n\n\n\nthe modifier of the resulting type does not contain the abstract keyword.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.classpath.operations.ClasspathCommands.java", "org.springframework.roo.addon.web.mvc.controller.ControllerOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1512, "bug_title": "Remove web.xml welcome file handling from GWT addon", "bug_description": "Remove web.xml welcome file handling from GWT addon", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.gwt.GwtOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1479, "bug_title": "DBRE on a DB2400 datasource throwing IllegalArgumentException JDBC driver not available for 'com.ibm.as400.access.AS400JDBCDriver'", "bug_description": "Attempting to DBRE on a DB2400 datasource fails with java.lang.IllegalArgumentException: JDBC driver not available for &apos;com.ibm.as400.access.AS400JDBCDriver&apos;.\nHave attempted to build Roo M4 from Git and copy the org.springframework.roo.wrapping.jtopen-6.7.0.0001.jar dependency into the M3 bundle directory.  Have also tried DBRE right from M4, but both give the same result.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.jdbc.polling.internal.CommonJdbcDriverProvider.java"], "label": 1, "es_results": []}, {"bug_id": 1515, "bug_title": "Dependencies not added using ProjectOperations.dependencyUpdate when switching ORM provider or databases", "bug_description": "Change JpaOperationsImpl  to add dependencies instead of updating them. Problem is due to having a property place holder for a version number rather than a number itself. The equals() method in dependency sees the dependency as the same.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.jpa.JpaOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1525, "bug_title": "DBRE does not handle slash characters in table and column names", "bug_description": "Database reverse engineering fails to convert forward and backslash characters into valid java type and field names", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.dbre.model.SchemaIntrospector.java", "org.springframework.roo.addon.dbre.DbreMetadata.java", "org.springframework.roo.addon.dbre.model.Column.java", "org.springframework.roo.addon.dbre.DbreTypeResolutionServiceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1536, "bug_title": "Order of foreign keys in .roo-dbre xml file determines @ManyToOne and @OneToOne field generation", "bug_description": "The order of the foreign keys in the .roo-dbre xml file should not affect the generation of @ManyToOne and @OneToOne fields. This is due to finding foreign keys based on the table&apos;s column names and stopping on the first match of a column instead of simply iterating through the foreign keys themselves and obtaining the local column from the foreign key&apos;s reference elements.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.addon.dbre.DbreMetadata.java", "org.springframework.roo.addon.dbre.model.Database.java", "org.springframework.roo.addon.dbre.model.Table.java", "org.springframework.roo.addon.dbre.model.ColumnComparator.java"], "label": 1, "es_results": []}, {"bug_id": 1555, "bug_title": "Undo Functionality Should clean up its temp files?", "bug_description": "I believe Roo is generating a tremendous amount of temp files in order to Undo actions when an error occurs.  These temp files are never removed so the temp directory continues to grow bigger and bigger.\nSince Roo doesn&apos;t allow the user to \"Undo\" commands, this Undo functionality is used only internally.  I would assume that the temp files are created so if an error occurs processing a command any actions taken before the error occurred are able to be rolledback (or Undone).\nI would think it is reasonable to say if the command was performed without error then the undo files should be removed after the command completes.\nThis would stop the ever growing temp directory.\nAn example of the impact: I started a roo project on 9/13 and as of today there are 112544 File(s) 689,963,308 bytes in roo temp files dated from 9/13 to 10/13.\nSame project on the computer that I did the actual development on there were over 6gb of the temp files.\n10/13/2010  10:25 AM            16,801 UpdateFile8082522949573900540tmp\n10/13/2010  10:25 AM            16,801 UpdateFile8831047267320096084tmp\n10/13/2010  10:25 AM            16,801 UpdateFile820654767042231678tmp\n10/13/2010  10:25 AM            16,801 UpdateFile8459059130848309600tmp\nsuccessfully running the roo security setup on a project generated 2047 temp files.\nsuccessfully running roo perform tests on the same project generated 654 File(s) 10,987,854 bytes\nSo everytime perform tests is executed it generates another 654 File(s) 10,987,854 bytes\nNot exactly sure why perform tests would need Undo functionality since none of the roo managed files are being changed during this command.\nAnyway, just thought I would post it so someone with a lot more knowledge could at least take a look at it.\nhttp://forum.springsource.org/showthread.php?t=95488", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.M3", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.roo.file.undo.UpdateFile.java", "org.springframework.roo.file.undo.DeleteDirectory.java", "org.springframework.roo.file.undo.DeleteFile.java"], "label": 1, "es_results": []}, {"bug_id": 1559, "bug_title": "Version is reported as UNKOWN VERSION when installing into a path containing spaces", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RC1", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.roo.shell.AbstractShell.java"], "label": 1, "es_results": []}, {"bug_id": 1562, "bug_title": "Intermittent Roo she will startup issue with Op4JMetadataProvider", "bug_description": "Oct 15, 2010 3:04:57 PM org.springframework.roo.felix.JdkDelegatingLogListener logNow\nSEVERE: [org.springframework.roo.addon.op4j [30]] [org.springframework.roo.addon.op4j.Op4jMetadataProvider] Cannot create component instance due to failure to bind reference metadataService\nOct 15, 2010 3:04:57 PM org.springframework.roo.felix.JdkDelegatingLogListener logNow\nSEVERE: [org.springframework.roo.addon.op4j [30]] FrameworkEvent ERROR\norg.apache.felix.log.LogException: org.osgi.framework.ServiceException: Service factory returned null.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RC1", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.op4j.Op4jMetadataProvider.java", "org.springframework.roo.addon.json.JsonMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 1563, "bug_title": "DataOnDemand fails to set correct data for numeric primitive fields", "bug_description": "When primitive numeric fields are declared without @NotNull, DoD uses null in the initializer resulting in failing tests. ", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RC1", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1581, "bug_title": "Web MVC JSP views not updated on domain changes", "bug_description": "Web MVC JSP views not updated on domain changes. For example the removal of a field in a domain object does not because the views to be updated.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RC1", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspMetadataListener.java"], "label": 1, "es_results": []}, {"bug_id": 1572, "bug_title": "DataOnDemand.init() no longer checks if data already created", "bug_description": "I noticed that the init() method in the integration test generated DataOnDemand classes changed in RC1 from M3. It no longer checks to see if the test set has already been created. Becuase the getRandomXXX() method always calls init(), whenever getRandomXXX() is called, the test set is created again.\nFor example, with the clinic.roo example, the Visit entity has a relationship with Pet. In the VisitDataOnDemand.getNewTransientVisit() entity, it gets a Pet instance by calling PetDataOnDemand.getRandomPet(). Thus every time VisitDataOnDemand.getNewTransientVisit() is called, 10 Pet entities are created in PetDataOnDemand.init().\nIf Pet were to have a unique constraints (e.g. the description field), then the call to init() will fail with a constraint violation as the description will be repeated in the second set creation. This is what is happening with my application as I&apos;m using a unique constraint.\nRC1 code (no check):\n    public void PetDataOnDemand.init() {\n        data = new java.util.ArrayList<com.springsource.petclinic.domain.Pet>();\n        for (int i = 0; i < 10; i++) \n{\n            com.springsource.petclinic.domain.Pet obj = getNewTransientPet(i);\n            obj.persist();\n            data.add(obj);\n        }\n    }\n\nM3 code:\n    public void PetDataOnDemand.init() {\n        if (data != null && !data.isEmpty()) {\n            return;\n        }\n\n        data = com.springsource.petclinic.domain.Pet.findPetEntries(0, 10);\n        if (data == null) throw new IllegalStateException(\"Find entries implementation for &apos;Pet&apos; illegally returned null\");\n        if (!data.isEmpty()) {            return;        }\n\n        data = new java.util.ArrayList<com.springsource.petclinic.domain.Pet>();\n        for (int i = 0; i < 10; i++) {            com.springsource.petclinic.domain.Pet obj = getNewTransientPet(i);            obj.persist();            data.add(obj);        }\n    }", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RC1", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1585, "bug_title": "HttpMethodFilter should come before springSecurityFilterChain in web.xml", "bug_description": "When adding security to a Roo project with the \"security setup\" command, a filter is added to the web.xml for Spring Security. This filter is put before HttpMethodFilter, but it needs to be put after. HttpMethodFilter is responsible for converting the Spring MVC HTTP POST with parameter _method=DELETE into an actual HTTP DELETE method. If you want to define a Spring Security <intercept-url> with method=\"DELETE\", a delete request will only be intercepted if the request has been converted to the HTTP DELETE method previously. Thus the HttpMethodFilter needs to have been called first, and should be put before the springSecurityFilterChain filter in the web.xml.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RC1", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.security.SecurityCommands.java", "org.springframework.roo.addon.security.SecurityOperations.java", "org.springframework.roo.addon.web.mvc.controller.WebMvcOperationsImpl.java", "org.springframework.roo.addon.security.SecurityOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1565, "bug_title": "Data on demand initialization causes integraion tests failures", "bug_description": "The problem appears when one entity has non-optional reference to another entity which has field with unique constraint.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RC1", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1590, "bug_title": "Spring Roo cannot reverse engineer Oracle db", "bug_description": "I&apos;m trying to reverse engineer an Oracle database with Roo.\nI am able to instrospect the database without error, and the results look correct.\nWhen I reverse engineer the database, it creates the files then undoes the create. Below is what is sent to the screen (abbreviated to fit within a post), but I&apos;m not sure how to turn on any debugging to get more meaningful information.\nCode:\n\n\n\n\n\n\nroo> database reverse engineer --package ~.db --sCreated org.neoninc.db.TypeType\n\n\n\n\nManaged ROOT\\.roo-dbre                               Created org.neoninc.db.Unit\n\n\n\n\nCreated SRC_MAIN_JAVA\\org\\neoninc\\db             Created org.neoninc.db.UnitTrsl\n\n\n\n\nCreated SRC_MAIN_JAVA\\org\\neoninc\\db\\Attr.java   Created \n\n\n\n\n\n\n\n\n\n....\n\n\n\n\n\n\n\n\n\nCreated SRC_MAIN_JAVA\\org\\neoninc\\db\\Samp_Roo_Entity.aj\n\n\n\n\nUndo create SRC_MAIN_JAVA\\org\\neoninc\\db\\Samp_Roo_Entity.aj\n\n\n\n\n\n\n\n\n\n....\n\n\n\n\n\n\n\n\n\nUndo manage ROOT\\.roo-dbre\n\n\n\n\nField &apos;samps4&apos; already defined in IT WOULD (IT WOULD target &apos;org.neoninc.db.Samp_Roo_DbMan\n\n\n\n\naged)&apos;\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RC1", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.dbre.DbreMetadata.java", "org.springframework.roo.addon.dbre.model.Table.java", "org.springframework.roo.addon.dbre.model.JoinTable.java"], "label": 1, "es_results": []}, {"bug_id": 1617, "bug_title": "NPE in SolrMetadata", "bug_description": "NPE is raised in SolrMetadata because it assumes version fields always exist.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RC1", "fixed_version": "1.1.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.solr.SolrMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1643, "bug_title": "declaredByMetadataId is never assigned in JavaParserMethodMetadata", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.classpath.javaparser.details.JavaParserMethodMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1652, "bug_title": "Roo DBRE : Repeated column in mapping for entity", "bug_description": "In an effort to obtain access to key values of foreign keys,\nTtable.java defines @Column(name = \"first_bee\")\nRoo notices, and creates relevant _JavaBean.aj IT WOULD, \nbut fails to annotate for: (should be mapped with insert=\"false\" update=\"false\")\nAttached is the backup.zip with mysql dump, log.roo, tc.log (the stacktrace from tc-server)\nand the whole eclipse project.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.classpath.details.MemberFindingUtils.java", "org.springframework.roo.addon.dbre.DbreMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1662, "bug_title": "Documentation on web mvc install language is wrong", "bug_description": "The documentation on web mvc install language states:\nCreate a new manual Controller (ie where you write the methods)\nThis is wrong of course - it adds i18n for the specificied language.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspCommands.java"], "label": 1, "es_results": []}, {"bug_id": 1657, "bug_title": "'controller scaffold' command gives confusing error with missing entity", "bug_description": "Roo script:-\nproject --topLevelPackage pluralbug\npersistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY\nentity --class ~.domain.SomeEntity --testAutomatically\nfield string junkText --notNull --sizeMax 30\ncontroller scaffold --class ~.web.SomeEntityController --entity ~.domain.OtherEntity\nThe final line of this script should throw some error about not finding ~.domain.OtherEntity - but instead Roo is ignoring the elephant in the room (or lack thereof) and saying:-\n[...]\ncontroller scaffold --class ~.web.SomeEntityController --entity ~.domain.OtherEntity\nCould not determine plural for &apos;OtherEntity&apos;\nScript execution aborted\nRoo exited with code 1\n\nThanks.\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.ControllerCommands.java"], "label": 1, "es_results": []}, {"bug_id": 1667, "bug_title": "Quoted single arguments in Roo she will do not terminate the current argument buffer unless a space is added at the end of argument", "bug_description": "When surrounding an argument with double quotes, currently a space must be added to the end of the argument before the second double quote else the same option is displayed again when TAB is pressed.\nFor example:\nentity --class \"Foo\" then TAB causes --class to be displayed again. \nMultiple valued arguments are not affected. For example, the hypothetical command below works OK:\necho --message \"foo bar\" then TAB does not because --message to be displayed again.\nAlso, echo --message \"foo\" then ENTER prompts for the --message again", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.shell.Parser.java", "org.springframework.roo.shell.AbstractShell.java", "org.springframework.roo.shell.SimpleParser.java", "org.springframework.roo.shell.ParserUtils.java"], "label": 1, "es_results": []}, {"bug_id": 1677, "bug_title": "Date handling in MVC broken", "bug_description": "If I enter a date using the standard Roo view everything looks fine (see BeforeSubmit.png). Then I submit the value and get an error (see AfterSubmit.png). If I enter the same String without using the widget it works.\nThis is on Ubuntu with the browser integrated in Eclipse. Using Google Chrome  on Linux leads to different behavior (see BeforeSubmitChrome / AfterSubmitChrome). As you can see the format used there is 11.2.2010 which is a typical German layout for a Date. I am running on a German localization with the browser - maybe that is the reason for the issue.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1719, "bug_title": "DbreDatabaseListenerImpl fails to update @RooIdentifier classes until Roo is restarted", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.dbre.DbreDatabaseListenerImpl.java", "org.springframework.roo.addon.entity.IdentifierMetadataProviderImpl.java", "org.springframework.roo.addon.dbre.DbreMetadata.java", "org.springframework.roo.addon.entity.AbstractIdentifierServiceAwareMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 1718, "bug_title": "FileConverter uses Unix-specific check for absolute path names, breaking Windows behavior", "bug_description": "Current code checks if String denoting file name starts with File.separator to treat the name as an absolute path, but Windows doesn&apos;t work like that as it uses drive letters for absolute paths. ", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.shell.jline.JLineShell.java", "org.springframework.roo.support.util.FileUtils.java", "org.springframework.roo.shell.jline.JLineLogHandler.java", "org.springframework.roo.shell.converters.FileConverter.java"], "label": 1, "es_results": []}, {"bug_id": 1687, "bug_title": "Solr plugin does not allow overriding of methods added to bean", "bug_description": "If you attempt to define Bean.indexBean(Collection<Bean> beans) in Bean.java after adding solr to the Bean class, it will cause errors due to the method being declared twice (also in Bean_Roo_SolrSearch.aj). This is different than the way it is done for setters/getters/etc. Redefining this is useful when you only want to search on specific fields.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.solr.SolrMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1746, "bug_title": "DBRE does not handle unique constraints", "bug_description": "Generated class does not have unique=true in @Column annotation", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.dbre.model.Database.java", "org.springframework.roo.addon.dbre.DbreMetadata.java", "org.springframework.roo.addon.dbre.model.Column.java"], "label": 1, "es_results": []}, {"bug_id": 1747, "bug_title": "DBRE does not handle NOT NULL constraint on Foreign Keys", "bug_description": "Although user_id field in \"comment\" table is specified as NOT NULL,\nthe generated Comment class has:\n@ManyToOne\n@JoinColumn(name = \"user_id\", referencedColumnName = \"id\")\nprivate Person Comment.person;\nIn other words NOT NULL on FK is not added as field annotation.\nThe consequence is failed integration test:\nERROR org.hibernate.util.JDBCExceptionReporter - Column &apos;user_id&apos; cannot be null\nAlso I manually add @NotNull in CommentDbManaged.aj, that doesn&apos;t help, since TestDataOnDemand would not be changed automatically.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.dbre.DbreMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1661, "bug_title": " Multiple writable mappings for fields if using database reverse engineering", "bug_description": "I tried the database reverse engineering on a MySQL database Hyperic stores its data in. I use EclipseLink as JPA provider.\nThe result when I start the application is:\nException [EclipseLink-48] (Eclipse Persistence Services - 2.1.0.v20100614-r7608): org.eclipse.persistence.exceptions.DescriptorException\nException Description: Multiple writable mappings exist for the field [HQ.EAM_UI_ATTACH_RSRC.ATTACH_ID].  Only one may be defined as writable, all others must be specified read-only.\nMapping: org.eclipse.persistence.mappings.OneToOneMapping[eamUiAttachment]\nDescriptor: RelationalDescriptor(com.springsource.dbintrospection.domain.EamUiAttachRsrc --> [DatabaseTable(HQ.EAM_UI_ATTACH_RSRC)])\nI attached the ITDs. It appears that it mapped to a relation to another table as well as the primary key. I am not sure how the foreign key relation was reverse engineered but I believe this database design is not so uncommon after all.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.dbre.DbreMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1717, "bug_title": "Standard Scaffold controller methods defined in parent class are not detected", "bug_description": "I have a Roo Controller class called Foo with scaffolding and there is a list method in the FooController_Roo_Controller aspect. If I implement list in my Foo class then Roo detects it and removes it from the aspect as expected.\nIf I now move that list method up into an Abstract base class called ParentOfFoo and change Foo so that it extends ParentOfFoo then Roo puts back the list method into the aspect. This is not what I expect.\nCan we change Roo to detect methods implemented by base classes please?", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadataProviderImpl.java", "org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1763, "bug_title": "ShellStatus does not have a valid hashCode() or equals() method implementation", "bug_description": "In reviewing code for ShellStatus, I noticed it omits the recently-added message field. Need to correct it.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.shell.event.ShellStatus.java"], "label": 1, "es_results": []}, {"bug_id": 1684, "bug_title": "The UTF8 (german and cyrillic) data is not correctly written to the database", "bug_description": "The utf8 characters are not correctly written to database.\na) german special characters (,,,)\nb) cyrillic characters (...)\nSee \nhttp://forum.springsource.org/showthread.php?p=327431#post327431\nand\nhttps://jira.springsource.org/browse/ROO-89?focusedCommentId=60102#action_60102\nI did some tests already, it did not help:\n1. Set the CharacterEncodingFilter filter in web.xml to first place\n2. Set <property name=\"hibernate.connection.charSet\" value=\"UTF-8\" /> in persistence xml\n3. I updated the DB manually with a correct UTF8 data (copied from hsqldb from same application but in grails) and is showed correctly, so the utf8 data is correcly read\\displayed from database.\nI have same application in grails. Same db (hsqldb), db settings, db version.\nHere the sample of data in:\nGrails:\nEntered value \" Mnchen\", \nvalue in db \"INSERT INTO GUETER_EINHEIT VALUES(17,0,&apos;\\u041f\\u0440\\u0438\\u0432\\u0435\\u0442 M\\u00fcnchen&apos;)\"\nRoo:\nEntered value \" mnchen\",\nvalue in the db \"INSERT INTO GUETER_EINHEIT VALUES(2,&apos;\\u00d0\\u009f\\u00d1\\u0080\\u00d0\\u00b8\\u00d0\\u00b2\\ u00d0\\u00b5\\u00d1\\u0082 m\\u00c3\\u00bcnchen&apos;,0)\"\nVery strange, I see in Roo for one special character two unicode characters and the generated unicode of grails and roo is different", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.jpa.JpaOperationsImpl.java", "org.springframework.roo.addon.web.mvc.controller.WebMvcOperations.java", "org.springframework.roo.addon.web.mvc.controller.WebMvcOperationsImpl.java", "org.springframework.roo.addon.security.SecurityOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1714, "bug_title": "Pagination does not reset", "bug_description": "1. generate clinic application and run\n2. create 2 owners\n3. create 9 pets\n4. go to \"List all Pets\" page\n5. change results per page to 5 and go to the second page result.\n6. click \"List all Owners\" in the menu --> no owners found because page number is 2.\nI guess, there must be reset of page number to 1 before entities fetching in this case.\n\n\n\n\n\n\nif (page > maxPages) page = 1;\n\n\n\n\n\n\nThanks\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspMetadataListener.java"], "label": 1, "es_results": []}, {"bug_id": 1782, "bug_title": "Error when using the 'field embedded' command ", "bug_description": "Upon using the &apos;field embedded&apos; command, I ran into the following error/warning: \"The field embedded command is only applicable to JPA @Entity target types\". I&apos;ve checked my classes and the target type had the @RooEntity annotation, so I guess this should work. I&apos;ve temporarily replaced that annotation with the @Entity annotation, performend the same &apos;field embedded&apos; command without any problems. Changing the annotation then again back to &apos;@RooEntity&apos; worked fine and even the unit tests kept working, so not much of a problem, but still a bit of a strange annoyance.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java", "org.springframework.roo.addon.dod.DataOnDemandMetadataProvider.java", "org.springframework.roo.classpath.operations.FieldCommands.java"], "label": 1, "es_results": []}, {"bug_id": 1787, "bug_title": "Setting findAllMethod=\"\" in an Entity removes POST methods in Controller", "bug_description": "My requirement is that I want to limit users to dealing with a searched for entity by rather than given them access to a list of all elements.\nI thought the easiest way to achieve this was to set findAllMethod=\"\" within the entity, so I had the following within my @RooEntity annotation:\n@RooEntity( findAllMethod=\"\" )\n Unfortunately when I did so, I discovered that the controller was modified to remove all POST related methods which is not desirable. \n", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java", "org.springframework.roo.addon.web.mvc.jsp.JspMetadataListener.java"], "label": 1, "es_results": []}, {"bug_id": 1824, "bug_title": "@Transient Service objects in a @RooEntity because Web Scaffold to fail", "bug_description": "Previously reported by someone in the referenced post, but also causing us problems.  \nGiven:\n@RooJavaBean\n@RooEntity\npublic class Money{\n@Autowired\n@Transient\nprivate MoneyService moneyService;\n... other private fields that map to the db\n}\nGet \"Could not scaffold controller for type Money, the referenced type MoneyService cannot be handled\" and roo stops managing the file (or just hangs).\nMy understanding of ActiveRecord is that the Domain objects should encapsulate their business logic, and in our case that involves interacting with other services.  This service object is not itself a @RooEntity (in our case it has a @Service annotation and is being instantiated via Component Scanning\nWhat causes the related Controller Scaffold to error?", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1829, "bug_title": "Integer value for @javax.validation.contraints.Min breaks on generated @DataOnDemand", "bug_description": "When processing @DataOnDemand for an Entity which has JSR-303 validation @javax.validation.constraints.Min if the argument supplied is an integer type the roo console will report the following exception\n [Timer-0] java.lang.Integer cannot be cast to java.lang.Long\n          java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.Long\nchanging the argument type to a long works around this.\ne.g.\n@Min(4)  // kills roo with ClassCastException\nprivate Integer pintsOfBeer;\n@Min(4L) // works but is inconsistent with the annotation&apos;s description (see below)\nprivate Integer pintsOfBeer;\nAccording to javax.validation.contraints.Min\nSupported types are: \nBigDecimal \nBigInteger \nbyte, short, int, long, and their respective wrappers ", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java", "org.springframework.roo.addon.dod.DataOnDemandMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 1836, "bug_title": "Generated application.properties are not sorted", "bug_description": "Properties in WEB-INF/i18n/application.properties are not sorted, but in the code there is an attempt to sort them with calls such as \npropFileOperations.addPropertyIfNotExists(Path.SRC_MAIN_WEBAPP, \"/WEB-INF/i18n/application.properties\", \"label\" + folderName.replace(\"/\", \"\") + \"\" + lcViewName, title, true);\nwhere the last parameter, sorted, is true but has no effects.\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.propfiles.PropFileOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1750, "bug_title": "GWT managed code: Use ProxyForName and ServiceName annotations instead of ProxyFor", "bug_description": "Domain classes should be in the server part, and it is not necessary to share them with gwt.\nIf you use ProxyForName and ServiceName annotations, you could remove these classes from the shared folder and put them in the server side. \nThis change allows us to customize Entity.java files with whatever we need in the server side. \nRight now, it isn&apos;t possible this customization unless introducing aspect files, and it is not possible to remove completely the roo dependencies using the eclipse &apos;Refactor -> Push In&apos; ajdt feature.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.GwtMetadataProvider.java", "org.springframework.roo.addon.gwt.GwtMetadata.java", "org.springframework.roo.addon.gwt.RooGwtMirroredFrom.java"], "label": 1, "es_results": []}, {"bug_id": 1897, "bug_title": "Unknown failure of Roo-Generated MVC app on Google App Enging (GAE)", "bug_description": "OK first off.  Great job on the latest release of roo.  The GAE integration works so well and really hides the idiosyncracies of GAE from the developer.  It let us me concentrate on what is different about my app not what the different environment needs will be.  That being said, My app does not appear to be working on GAE.\nHere is the roo.log\n// Spring Roo 1.1.0.RELEASE [rev 793f2b0] log opened at 2010-12-27 10:47:55\nproject --topLevelPackage net.youngdev.services.global --projectName youngdevservices\npersistence setup --provider DATANUCLEUS --database GOOGLE_APP_ENGINE \nentity --class ~.domain.Faq \nfield string question\nfield string answer\nfield string context\njson all\ncontroller all --package ~.controller \nperform eclipse\nquit\n// Spring Roo 1.1.0.RELEASE [rev 793f2b0] log closed at 2010-12-27 11:00:46\nAfter that, I updated the appengine-web.xml with a version number and a application id for appengine.  \nNext, I deployed it to GAE via mvn gae:deploy\nWhen I hit my site, It just sits there.  Eventually, the screen returns but the page is just a blank white page with no style or text.\nWhen I do a view source, I see this:\n<html xmlns:jsp=\"http://java.sun.com/JSP/Page\" xmlns:c=\"http://java.sun.com/jsp/jstl/core\" xmlns:tiles=\"http://tiles.apache.org/tags-tiles\" xmlns:spring=\"http://www.springframework.org/tags\" xmlns:util=\"urn:jsptagdir:/WEB-INF/tags/util\" >  \n\t<jsp:output doctype-root-element=\"HTML\" doctype-system=\"about:legacy-compat\" />\n\t<jsp:directive.page contentType=\"text/html;charset=UTF-8\" />  \n\t<head>\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n\t\t<meta http-equiv=\"X-UA-Compatible\" content=\"IE=8\" />\t\n\t\t<util:load-scripts />\n\t\t<spring:message code=\"application_name\" var=\"app_name\"/>\n\t\t<title><spring:message code=\"welcome_h3\" arguments=\"$\n{app_name}\n\" /></title>\n\t</head>\n  \t<body class=\"tundra spring\">\n   \t\t<div id=\"wrapper\">\n\t\t    <tiles:insertAttribute name=\"header\" ignore=\"true\" />\n\t\t    <tiles:insertAttribute name=\"menu\" ignore=\"true\" />   \n\t\t    <div id=\"main\">\n\t    \t\t<tiles:insertAttribute name=\"body\"/> \n\t\t    \t<tiles:insertAttribute name=\"footer\" ignore=\"true\"/>\n\t\t    </div>\n\t\t</div>\n\t</body>\n</html>\nAny ideas what is wrong here or when it will be fixed?", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.solr.SolrMetadata.java", "org.springframework.roo.addon.web.mvc.controller.WebMvcOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1905, "bug_title": "database.properties and VMforce config.properties files not written out to disk", "bug_description": "The database.properties and config.properties file in JpaOperationsImpl do not get written out to disk.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.jpa.JpaOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1918, "bug_title": "WebScaffoldMetadata should use its MetadataProvider class name to ensure optimal loop detection semantics", "bug_description": "MemberDetailsScanner uses the passed FQCN string to determine whether to skip a request for a particular metadata provider. It is preferable therefore to present a MetadataProvider&apos;s FQCN if that MetadataProvider caused the MemberDetailsScanner invocation, or one of its helper classes within that MetadataProvider&apos;s control flow caused the invocation. A change to WebScaffoldMetadata is required to reflect this.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1917, "bug_title": "JpaOperationsImpl should close OutputStream", "bug_description": "The OutputStream was not closing, resulting in empty database.properties files.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.jpa.JpaOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1919, "bug_title": "SolrOperations, JpaOperations and LoggingOperations not closing OutputStreams", "bug_description": "The above are working with java.util.Properties and failing to close the OutputStream after a Properties.write(..).", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.jpa.JpaOperationsImpl.java", "org.springframework.roo.addon.logging.LoggingOperationsImpl.java", "org.springframework.roo.addon.solr.SolrOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1863, "bug_title": "Roo chokes on static variables in annotations, even if these annotations are NOT PART of ROO", "bug_description": "\nAdding a non roo annotation. with a final static value inside kills roo code generation.\n// The id\n@org.codehaus.jackson.annotate.JsonProperty(PROPERTY_UUID)\nprivate String uuid;\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.classpath.javaparser.details.JavaParserAnnotationMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1686, "bug_title": "Roo adds unnecessary imports for inner types", "bug_description": "When a class refers to an inner type in a method signature, field type, etc., Roo erroneously adds an import for the type, which triggers Eclipse warnings.\nGiven the following sample class, Roo incorrectly adds \"import example.MyEntity.MyEnum;\" to MyEntity_Roo_JavaBean.aj:\npackage example;\n@Entity\n@RooEntity\n@RooToString\n@RooJavaBean\npublic class MyEntity {\n    private String myName;\n    private MyEnum enumValue;\n    public enum MyEnum \n{ VALUE1, VALUE2 }\n}", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.classpath.itd.ItdSourceFileComposer.java"], "label": 1, "es_results": []}, {"bug_id": 1903, "bug_title": "Selenium test does not work when jetty is used as web container", "bug_description": "I have created selenium test cases for application created using Spring Roo and when I am trying to run those tests against jetty container tests fails. But the same test works with tomcat. I launch jetty and tomcat using maven plugins", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.selenium.SeleniumOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1694, "bug_title": "Roo aborts AJ processing without explanation", "bug_description": "When Roo encounters a JPA @Id field that does not have a public setter, it complains on the she will.  (This is questionable behavior itself, since the ID field may be managed some \"magic\" way, as in the case of a Hibernate foreign-key ID generator.)\nIt appears that encountering this situation causes Roo to abort processing and creating/managing AJ files, but Roo provides no indication of this fact; it merely fails silently because of an apparently unrelated issue.  Instead, if for some reason of internal plumbing Roo really can&apos;t continue, it should inform the user.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.entity.EntityMetadataProviderImpl.java", "org.springframework.roo.addon.entity.EntityMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1840, "bug_title": "View is wrong", "bug_description": "roo>\npersistence setup --database MYSQL --provider HIBERNATE\nentity --class ~.model.Produttore --testAutomatically\nfield string --fieldName nome\nentity --class ~.model.Articolo --testAutomatically\nfield reference --fieldName produttore --type ~.model.Produttore  \nfield string --fieldName nome\ncontroller scaffold --class ~.business.ProduttoreController --entity ~.model.Produttore --path /produttore\ncontroller scaffold --class ~.business.ArticoloController --entity ~.model.Articolo --path /articolo\n\nOn left menu the links to create new entry are correct.\nex.\nhttp://localhost:8080/Magazzino/produttore?form\nhttp://localhost:8080/Magazzino/articolo?form\nBut inside articolo form (when produttore&apos;s table is empty), the link to create new produttore is wrong\nIt&apos;s \nhttp://localhost:8080/Magazzino/produttores?form\nTHK", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspViewManager.java", "org.springframework.roo.addon.web.mvc.jsp.JspMetadataListener.java"], "label": 1, "es_results": []}, {"bug_id": 1906, "bug_title": "Impossible to generate a GWT app when sources are in the package 'shared' or 'server'", "bug_description": "Hi,\nI&apos;m pretty surprised with the implementation of GWT : the main blocking point is that I&apos;m obliged to declare my entities in the [B]client[/B] package : if I declare them on the server package, there are dependencies that are hard coded on the entities (instead of the entities proxies). Trying to resolve the problem by making the entities in the &apos;shared&apos; package makes the command &apos;gwt setup&apos; rollback after a &apos;String index out of range: -1&apos; mysterious error. \nThis is really a blocking design issue since I can&apos;t use the GAE core types like com.google.appengine.api.datastore.Text in my entities for example;", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.GwtMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1867, "bug_title": "creating a field named \"owner\" generates runtime exception", "bug_description": "When running the following attached script in roo we get an exception when trying to add an Entry\nChanging the field name from owner to something else will prevent the error", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.GwtMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1927, "bug_title": "pluginRepository elements are being added to a pom.xml file as repository elements", "bug_description": "When a pluginRepository is added to the pom.xml instead of being added as a pluginRepository under pluginRepositories it is add as a repository under pluginRepositories.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.project.ProjectMetadata.java", "org.springframework.roo.addon.maven.MavenProjectMetadataProvider.java", "org.springframework.roo.addon.jpa.JpaOperationsImpl.java", "org.springframework.roo.project.ProjectMetadataProvider.java", "org.springframework.roo.project.AbstractProjectOperations.java", "org.springframework.roo.project.ProjectOperations.java"], "label": 1, "es_results": []}, {"bug_id": 1711, "bug_title": "\"Perform tests\" problem using app engine datastore.", "bug_description": "Add a project, setup the database using the \"persistence setup --provider DATANUCLEUS --database GOOGLE_APP_ENGINE\" command, an entity, a field and a controller. \nThe \"perform tests\" command produces this error, which is also reported by other forum members(please check the forum post):\n-------------------------------------------------------\n  T E S T S\n -------------------------------------------------------\n Running org.firstats.web.domain.CategoryIntegrationTest\n 2010-11-07 18:10:55,583 [main] ERROR DataNucleus.Transaction - Opera\ntion rollback failed on resource: org.datanucleus.store.appengine.DatastoreXARes\nource@e63606, error code UNKNOWN and transaction: [DataNucleus Transaction, ID=Xid=    enlisted resources=[org.datanucleus.store.appengine.DatastoreXAResource@18ed77a]]\n 2010-11-07 18:14:58,383 [main] ERROR DataNucleus.Transaction - Opera\ntion rollback failed on resource: org.datanucleus.store.appengine.DatastoreXARes\nource@15af049, error code UNKNOWN and transaction: [DataNucleus Transaction, ID=Xid=   enlisted resources=[org.datanucleus.store.appengine.DatastoreXAResource@15af049]]\n Tests run: 9, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 6.5\n8 sec <<< FAILURE!\n Results :\n Tests in error:\n   testCountCategorys(org.firstats.web.domain.CategoryIntegrationTes\n)\n Tests run: 9, Failures: 0, Errors: 1, Skipped: 0\n [INFO] ------------------------------------------------------------\n-----------\n[ERROR] BUILD FAILURE\n[INFO] ------------------------------------------------------------\n-----------\n[INFO] There are test failures.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.entity.EntityMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 1929, "bug_title": "Specifying \"--database DB2400\" on the pers s command and pressing tab changes DB2400 to DB2", "bug_description": "While performing the command \"pers s --database DB2400\" if I tab to get the provider option, Roo changes DB2400 to DB2.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.roo.shell.SimpleParser.java"], "label": 1, "es_results": []}, {"bug_id": 2005, "bug_title": "Tab complete does not work for JPA_TIMESTAMP", "bug_description": "For some reason, tab completion works on JPA_TIME but not JPA_TIMESTAMP. The following will happen:\nfield date...  --persistenceType JPA_TI<TAB>\nJPA_TIME          JPA_TIMESTAMP\nfield date...  --persistenceType JPA_TIMEST<TAB>\nfield date...  --persistenceType JPA_TIME (here it deleted the \"ST\" off the end instead of completing the option)\nJPA_TIME          JPA_TIMESTAMP\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.shell.SimpleParser.java"], "label": 1, "es_results": []}, {"bug_id": 1006, "bug_title": "Roo generated Spring MVC apps should be deployable on GAE", "bug_description": "Currently GAE raises a compilation exception of the Roo generated jspx files in a GAE environment. The problem is the use of jasper-runtime-5.0.28.jar in the current version of GAE alongside geronimo-jsp_2.1_spec-1.0.1.jar. This means that GAE have an API which allows JSP 2.1 and an implementation of Jasper which only supports JSP 2.0. Spring Roo generated MVC apps use a number of JSP 2.1 features (mostly EL related) which are supported by all current Web containers but not GAE. (see http://code.google.com/p/googleappengine/issues/detail?id=1506)\nAs such GAE deployments are currently not supported by Roo generated Spring MVC applications. However, we are in contact with Google to resolve this issue as soon as possible. As a workaround Roo could ship a custom tag library (potentially with reduced functionality) to support JSP 2.0 EL. \nAnother issue which needs to be resolved is the full support of the default GAE data store. This will require changes outlined in ROO-611 to fully support references between domain objects.", "project": "Spring", "sub_project": "ROO", "version": "1.1.0.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.addon.solr.SolrMetadata.java", "org.springframework.roo.addon.web.mvc.controller.WebMvcOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1976, "bug_title": "toString() method of Column class in DBRE causes stack overflow if called ", "bug_description": "A circular reference to the table object in the toString() method causes a stack overflow exception when called.", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.dbre.model.Column.java"], "label": 1, "es_results": []}, {"bug_id": 2012, "bug_title": "Roo she will throws exception when an entity is created without a \".\" in the name if entity was previously created with the same command and then manually deleted", "bug_description": "If an entity was created initially with entity --class Foo (without a period (\".\") in the name, and then is deleted from the file system, the same command executed again will throw an exception because the JavaType created is not valid.", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.classpath.converters.JavaTypeConverter.java"], "label": 1, "es_results": []}, {"bug_id": 2041, "bug_title": "List of DeclaredFieldAnnotationDetails passed to addFieldAnnotation method of ItdTypeDetailsBuilder incorrectly uses List.contains() to check for presented annotation", "bug_description": "The method addFieldAnnotation of ItdTypeDetails checks for the existence of an annotation using the java.util.List contains method. This will not work as the objects compared will never be equal. The solution is to use MemberFindingUtils.getAnnotationOfType(..) instead. ", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.classpath.details.ItdTypeDetailsBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 1983, "bug_title": "JavaBeanMetadata creates an AspectJ file with an \"Employee\" type", "bug_description": "In certain cases, Roo may generate an AspectJ file implementing the JavaBean properties that contains a hard-coded \"Employee\" type.  See the referenced forum posting for details and script file that can be used to duplicate the issue.\nAttached is what I assume is the fix, a one-liner patch file.  I haven&apos;t built the source to confirm this yet, but will do so and update this afterwards.", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.javabean.JavaBeanMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2096, "bug_title": "Minor help error displayed after 'download privacy level' command is used", "bug_description": "roo> download privacy level --privacyLevel DISABLE_UAA\nUAA privacy level updated Tue Feb 08 11:08:25 CET 2011 (use &apos;uaa view&apos; to view the new data)\nroo> uaa view\nCommand &apos;uaa view&apos; not found (for assistance press TAB or type \"hint\" then hit ENTER)\naddon search --requiresCommand \"uaa view\" found no matches\nroo>", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.uaa.UaaCommands.java"], "label": 1, "es_results": []}, {"bug_id": 2104, "bug_title": "Invested in the @RequestMapping get and post methods", "bug_description": "Invested in the @ RequestMapping get and post methods to create a controller with the command \"controller class - class ~. web.FooController\"\n**log.roo**\nproject --topLevelPackage com.example --java 6 --projectName testBug\npersistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY\ncontroller class --class ~.web.FooController\nperform command --mavenCommand compile\nperform command --mavenCommand tomcat:run\n**log.roo**\n**FooController.java**\n@RequestMapping(\"/foo/**\")\n@Controller\npublic class FooController {\n    @RequestMapping(method = RequestMethod.POST, value = \"\n{id}\n\") <======this line should go in the post method\n    public void get(ModelMap modelMap, HttpServletRequest request, HttpServletResponse response) {\n    }\n    public void post(@PathVariable Long id, ModelMap modelMap, HttpServletRequest request, \n                              HttpServletRequest request, HttpServletResponse response) {\n    }\n    @RequestMapping\n    public String index() \n{\n        return \"foo/index\";\n    }\n}\n**FooController.java**", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2085, "bug_title": "Broken link for famfamfam_flag_icons.zip", "bug_description": "As explained on the forum, there is a broken link to http://www.famfamfam.com/lab/icons/flags/famfamfam_flag_icons.zip\nThis file is needed by the command \"addon create i18n\"\nI found the file elsewhere, downloaded it and specified the path on my local file-system using \"--flagGraphic\" parameter :\naddon create i18n --locale fr --messageBundle ../messages_fr.properties --topLevelPackage com.google.code.fr --flagGraphic r:\\famfamfam_flag_icons.zip\nI suggest to put the attached \"famfamfam_flag_icons.zip\" file directly on a Spring Roo server.\nRegards,", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.creator.CreatorOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2114, "bug_title": "Incorrect generated code in one of the IT WOULD's", "bug_description": "I have been reading through the Spring Roo in Action book and trying out the example using the latest STS release. I have run the following commands\nproject --topLevelPackage rooinaction --projectName roogwt --java 6\npersistence setup --provider DATANUCLEUS --database GOOGLE_APP_ENGINE \nentity --class ~.server.domain.Task --testAutomatically \nentity --class ~.server.domain.Project --testAutomatically \nfocus --class ~.server.domain.Task\nfield string --fieldName description\nfield number --fieldName priority --type java.lang.Integer\nfield boolean --fieldName completed\nfield date --fieldName dateCreated --type java.util.Date --dateFormat SHORT \nfield date --fieldName dateDue --type java.util.Date --dateFormat SHORT \nfield date --fieldName dateComplete --type java.util.Date --dateFormat SHORT \nfocus --class ~.server.domain.Project\nfield string --fieldName projectName\nfield set --fieldName tasks --type ~.server.domain.Task --cardinality ONE_TO_MANY --mappedBy project\nI get the following errors in Project_Roo_JavaBean.aj (I have included the generated code below)\n// Error: Annotation removal does not allow values to be specified for the annotation (compiler limitation)\n  declare @field: * Project.tasks: -@OneToMany(cascade = CascadeType.ALL, mappedBy = \"project\");\n// Type mismatch, cannot convert from Task to Employee\n        for (Employee entity : tasks) {\nInterestingly Employee has come from somewhere. This is a brand new STS install STS 2.5.2 Release e3.6.1\nThe code for Project_Roo_JavaBean.aj\n// WARNING: DO NOT EDIT THIS FILE. THIS FILE IS MANAGED BY SPRING ROO.\n// You may push code into the target .java compilation unit if you wish to edit any member(s).\npackage rooinaction.server.domain;\nimport com.google.appengine.api.datastore.Key;\nimport com.google.appengine.api.datastore.KeyFactory;\nimport java.lang.String;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.List;\nimport java.util.Set;\nimport javax.persistence.CascadeType;\nimport javax.persistence.OneToMany;\nimport javax.persistence.Transient;\nimport rooinaction.server.domain.Task;\nprivileged aspect Project_Roo_JavaBean {\n    declare @field: * Project.tasks: -@OneToMany(cascade = CascadeType.ALL, mappedBy = \"project\");\n    declare @field: * Project.tasks: @Transient;\n    private Set<Key> Project.tasksKeys = new HashSet<Key>();\n    public String Project.getProjectName() \n{\n        return this.projectName;\n    }\n\n    public void Project.setProjectName(String projectName) \n{\n        this.projectName = projectName;\n    }\n\n    public Set<Task> Project.getTasks() {\n        Set<rooinaction.server.domain.Task> localTasks = new HashSet<rooinaction.server.domain.Task>();\n        for (Key key : tasksKeys) {\n            rooinaction.server.domain.Task entity = Task.findTask(key.getId());\n            if (entity != null) \n{\n                localTasks.add(entity);\n            }\n        }\n        this.tasks = localTasks;\n        return localTasks;\n    }\n    public void Project.setTasks(Set<Task> tasks) {\n        Set<rooinaction.server.domain.Task> localTasks = new HashSet<rooinaction.server.domain.Task>();\n        List<Long> longIds = new ArrayList<Long>();\n        for (Key key : tasksKeys) {\n            if (!longIds.contains(key.getId())) \n{\n                longIds.add(key.getId());\n            }\n        }\n        for (Employee entity : tasks) {\n            if (!longIds.contains(entity.getId())) \n{\n                longIds.add(entity.getId());\n                tasksKeys.add(KeyFactory.createKey(Task.class.getName(), entity.getId()));\n            }\n            localTasks.add(entity);\n        }\n        this.tasks = localTasks;\n    }\n}\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.javabean.JavaBeanMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2124, "bug_title": "Solr function search(String queryString) throws NullPointerException", "bug_description": "By running \"solr setup\" and \"solr all\" in Roo-She Will the generated solr code contains\n...\npublic static QueryResponse Resolution.search(String queryString) {\nreturn search(new SolrQuery(\"resolution_solrsummary_t:\" + queryString.toLowerCase()));\n}\n...\nIf no queryString is entered in the frontend the execution of \"null.toLowerCase()\" will throw a NullPointerException.\nMy suggestion would be:\npublic static QueryResponse Resolution.search(final String queryString) {\nfinal String searchString = \"resolution_solrsummary_t:\" + queryString;\nreturn search(new SolrQuery(searchString.toLowerCase()));\n}", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.solr.SolrMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2105, "bug_title": "Roo she will ignores entities in non-lower-case packages", "bug_description": "If you manually create a Roo-annotated entity (e.g. via an IDE or text editor as opposed to using the Roo she will&apos;s \"entity\" command) in a package containing upper-case characters, then the Roo she will quietly ignores that class. For example, no ITDs are created.\nI don&apos;t know if this is intended behaviour or a bug, but it would be helpful if the Roo she will could at least output a warning such as \"Ignoring entity com.example.fooBar.Employee; package name is not lower case\". It would be better still if Roo didn&apos;t care about the casing of the package name, especially when Roo-ifying a large legacy project that has a large number of mixed case package names.", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserClassOrInterfaceTypeDetails.java", "org.springframework.roo.model.JavaType.java", "org.springframework.roo.model.JavaTypeTests.java", "org.springframework.roo.classpath.itd.ItdSourceFileComposer.java"], "label": 1, "es_results": []}, {"bug_id": 2139, "bug_title": "Solr add-on not produce stable aspects", "bug_description": "The Solr add-on is producing aspects that change upon each launch of Roo, despite there being no material change to the governor, this causes the *_Roo_SolrSearch aspect to be needlessly rewritten to disk.", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.solr.SolrMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2154, "bug_title": "DataOnDemand overwrites default field values.", "bug_description": "Not sure if this is doable or not, but currently given a @RooEntity as follows:\nclass BaseEntity\nprivate Boolean inactive = Boolean.FALSE;\nRoo generates a BaseEntityDataOnDemand that does this:\nBaseEntity obj = new BaseEntity();\nobj.setInactive(null);\nIs a bit of a pain.  Obvious workarounds, but maybe its an easy fix.", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java", "org.springframework.roo.support.util.StringUtils.java"], "label": 1, "es_results": []}, {"bug_id": 2157, "bug_title": "Fix code to prevent NPEs", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.2.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspViewManager.java", "org.springframework.roo.classpath.javaparser.JavaParserUtils.java", "org.springframework.roo.addon.web.mvc.jsp.JspOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2259, "bug_title": "web.xml filter ordering can create locale/language character encoding issues", "bug_description": "when I type a text like :\netta er i texti\nSpring (on submit) changes the text to : \netta er i texti\neverything seems to be in UTF-8 but somewhere after submit the text entered gets garbled (or changed between character sets)\nThis also translates to database, that is the garbled text gets written to the database.\nMy workaround for this so far is copying a roo project that I had in version 2.5.1.release\nwhich does not seem affected by this problem, deleting all objects there and using that as a base (instead of creating a new roo project in sts 2.5.2 or 2.6.0 release)", "project": "Spring", "sub_project": "ROO", "version": "1.1.1.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.jpa.JpaOperationsImpl.java", "org.springframework.roo.addon.web.mvc.controller.WebMvcOperations.java", "org.springframework.roo.addon.web.mvc.controller.WebMvcOperationsImpl.java", "org.springframework.roo.addon.security.SecurityOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2174, "bug_title": "null initialized String field in entity throws indexoutofboundsexception : -1", "bug_description": "One of many Roo generated entities contained a String field which I added myself and for some reason initialized to null.\nThe result is that the data on demand component blows up @\nDataOnDemandMetadata.storeFieldInitializers(DataOnDemandMetadata.java:640)\nFrom the look of the code, I think this be pretty easy to reproduce, initialize a String field in an entity to null, stop roo, start roo. \nThis really bricked everything for me, no code updates were being done anymore by roo and I had no clue what was going on basically. \nOn great addition would be to more logging, allow through some means a user to enable logging of which files, fields, ... are being processed, relevant status and results etc. This would have saved quite some hours.  \n", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2199, "bug_title": "Addon upgrade all fails for Roo 1.1.2 ", "bug_description": "addon upgrade all fails, and after failure I have to Ctrl_C the system since it does not recognize the commands\nAs of this report a fresh install of ROO says that there are 15 upgrades available. And iterative tries to upgrade fails at 3 upgrades left \nwhich are as follows\nThe following add-ons / components are available for upgrade for level: ANY\n--------------------------------------------------------------------------------\n[level: ANY] org.springframework.roo.felix;1.1.2.RELEASE > 1.1.3.BUILD-SNAPSHOT\n[level: ANY] org.springframework.roo.addon.entity;1.1.2.RELEASE > 1.1.3.BUILD-SNAPSHOT\n[level: ANY] org.springframework.roo.addon.serializable;1.1.2.RELEASE > 1.1.3.BUILD-SNAPSHOT\n--------------------------------------------------------------------------------", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.roobot.client.AddOnRooBotOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2209, "bug_title": "JavaBean does not use an entity's custom identifier field when using GAE", "bug_description": "getId() has been hardcoded in the JavaBean add-on which causes custom identifier fields to be ignored when GAE is being used in a project.", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.javabean.JavaBeanMetadata.java", "org.springframework.roo.addon.javabean.JavaBeanMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2210, "bug_title": "Missing throw keyword in try/catch blocks", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.solr.SolrJspMetadataListener.java", "org.springframework.roo.addon.web.mvc.jsp.menu.MenuOperationsImpl.java", "org.springframework.roo.addon.web.mvc.jsp.JspMetadataListener.java", "org.springframework.roo.addon.web.flow.WebFlowOperationsImpl.java", "org.springframework.roo.addon.web.mvc.jsp.JspOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2218, "bug_title": "Exception thrown when searching for non-existent /div/page element in index-template.jspx", "bug_description": "The element from XPath expression \"/div/page\" does not exist in index-template.jspx and as a result an exception is caught and re-thrown. This was masked prior to ROO-2210 as the IllegalStateException was instantiated instead of being correctly thrown. Processing just continued on as normal.", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2232, "bug_title": "Calendar properties in mvc list views not displayed as dateformats", "bug_description": "List views generated by the mvc addon do not use formatters for java.util.Calendar Items.\nInstead the class name is displayed.", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspViewManager.java"], "label": 1, "es_results": []}, {"bug_id": 2226, "bug_title": "Adding tag attributes starting  with '_'  does not work as expected - They are deleted on re-generation ", "bug_description": "I tried to add a custom attribute \"_multipart\" to the form:create tag.\nAccording too Roo documentation , attributes with leading \"_\" are not included in the hashcode (z attribute) ... So I expected I could use them without intefering with Roo code generation.\nSo, I tried to use this new attribute in a Roo-mangaed view: \n<form:create id=\"fc_...\" _multipart=\"true\" ...>\nBut next time the view was regenerated, this attribute was removed again. Even worse: All changes I had made in the content of the form tag (f.e. some field customization \"rendered=\"false\") were also lost.\nI seems, the whole form element and all of its content has been re-generated...\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.support.util.XmlRoundTripUtils.java"], "label": 1, "es_results": []}, {"bug_id": 2236, "bug_title": "DBRE not updating Db_Managed IT WOULD when fields are removed from the entity's composite PK class", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.support.util.XmlUtils.java", "org.springframework.roo.addon.dbre.DbreDatabaseListenerImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2238, "bug_title": "Code completion for packages broken", "bug_description": "In the Roo she will, code completions for packages / classes seems to be broken.\nLet Us assume, we have entitie in a subpackage domain.\nWhen entering something like  controller scaffold --class ~.  , the code completion offers nothing. One has to enter \"domain\" by hand, and only gets code completion for the class name then.\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.file.monitor.polling.PollingFileMonitorService.java"], "label": 1, "es_results": []}, {"bug_id": 2251, "bug_title": "Wenn adding SOLR support for an entity, a \"find...BySolrServer - failure\" appears in the list of finders", "bug_description": "I have an Entity Artikel and called \nsolr add --class ~.domain.artikel.Artikel\nand then  \nfinder list\nThe last line of the Roo she will output is then: \n\"findArtikelsBySolrServer - failure\"\nIt seems, the introduced field \ntransient SolrServer Artikel.solrServer\nis misinterpreted as some persistent property by the finder addon.", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.finder.DynamicFinderServicesImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2256, "bug_title": "Lack of internet connection causes the GWT add-on to hang Roo", "bug_description": "In order to determine what is a valid type to use on the client side the GWT add-on checks to see if the referenced type is located in a package that has been declared in the application gwt.xml file. During this check a dtd file is downloaded. If no internet connection is present Roo hangs and the throws a \"java.net.UnknownHostException\".", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.GwtTypeServiceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2271, "bug_title": "Incorrect variable generated in findEntity method when GAE is used and the identifierField attribute on @RooEntity is specified", "bug_description": "When the GOOGLE_APP_ENGINE database is configured for use in a Roo project and the user has specified a value in the &apos;identifierField&apos; attribute of @RooEntity, the find method has incorrect code generated. For example, if identifierField is set to &apos;tid&apos;, ie @RooEntity(identifierField = &apos;tid&apos;) the generated find method looks like:\n\n\n\n\n\n\n    @Transactional\n\n\n\n\n    public static Document Document.findDocument(Long id) {\n\n\n\n\n        if (id == null) return null;\n\n\n\n\n        Query query = entityManager().createQuery(\"select o from Document o where o.tid = :id\").setParameter(\"id\",tid);\n\n\n\n\n    ...\n\n\n\n\n\n\nresulting in a compile error.", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.entity.EntityMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2270, "bug_title": "A quit command within scripts hangs Roo", "bug_description": "I was rerunning a script that Roo had generated and because it had quit in the middle of it, Roo hung.  I accept there shouldn&apos;t be a quit in there, but that&apos;s what happens if you run roo multiple times in the same project.  I know it is supposed to be a log, but maybe Roo could remove (or comment out) any trailing quit before adding new lines?\nThe script was:\n// Spring Roo 1.1.2.RELEASE [rev fbc33bb] log opened at 2011-03-27 23:00:34\nproject --topLevelPackage com.springsource.roo.songs --projectName rooSongs --java 6\npersistence setup --database HYPERSONIC_PERSISTENT --provider HIBERNATE \nquit\nentity --class ~.domain.Song --testAutomatically \nentity --class ~.domain.Artist --testAutomatically \nentity --class ~.domain.Album --testAutomatically \nentity --class ~.domain.Label --testAutomatically \nquit\nOutput was:\nroo> script ..\\log.roo\n// Spring Roo 1.1.2.RELEASE [rev fbc33bb] log opened at 2011-03-27 23:00:34\nproject --topLevelPackage com.springsource.roo.songs --projectName rooSongs\nCreated ROOT\\pom.xml\nCreated SRC_MAIN_JAVA\nCreated SRC_MAIN_RESOURCES\nCreated SRC_TEST_JAVA\nCreated SRC_TEST_RESOURCES\nCreated SRC_MAIN_WEBAPP\nCreated SRC_MAIN_RESOURCES\\META-INF\\spring\nCreated SRC_MAIN_RESOURCES\\META-INF\\spring\\applicationContext.xml\nCreated SRC_MAIN_RESOURCES\\log4j.properties\npersistence setup --database HYPERSONIC_PERSISTENT --provider HIBERNATE\nUpdated ROOT\\pom.xml [Removed redundant artifacts]\nUpdated SRC_MAIN_RESOURCES\\META-INF\\spring\\applicationContext.xml\nCreated SRC_MAIN_RESOURCES\\META-INF\\persistence.xml\nCreated SRC_MAIN_RESOURCES\\META-INF\\spring\\database.properties\nUpdated ROOT\\pom.xml [Added dependencies org.hsqldb:hsqldb:1.8.0.10, org.hib\n, org.hibernate.javax.persistence:hibernate-jpa-2.0-api:1.0.0.Final, org.hib\nlib:cglib-nodep:2.2, javax.transaction:jta:1.1, org.springframework:spring-j\nl:commons-pool:1.5.4, commons-dbcp:commons-dbcp:1.3]\nUpdated ROOT\\pom.xml [Added repository https://repository.jboss.org/nexus/co\nquit\nentity --class ~.domain.Song --testAutomatically\nC:\\Users\\chapmanp\\Documents\\workspace-sts-2.6.0.RELEASE\\rooSongs>^C^C^C^C^C\nNote the attempt to use ctrl-C.  I had to kill the Java process from the task manager.", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.shell.AbstractShell.java", "org.springframework.roo.process.manager.ProcessManagerHostedExecutionStrategy.java"], "label": 1, "es_results": []}, {"bug_id": 2265, "bug_title": "Invalid commands makes following valid commands hang or to not be carried out", "bug_description": "this script causes the controller scaffold to not respond until a restart. Other commands may work:\nproject --topLevelPackage com.testing.teststuff --projectName Stuff --java 5\npersistence setup --database MYSQL --provider HIBERNATE --databaseName stuff --userName sa\nentity --class ~.Stuff --testAutomatically\ncontroller scaffold --class ~.web.StuffController --path / --entity ~.Stuff\n//response: Controller base path required\n//controller sacaffold commands stops responding even for valid commands(not the following)\ncontroller scaffold --class ~.web.StuffController --path /* --entity ~.Stuff\ncontroller scaffold --class ~.web.StuffController --path / --entity ~.Stuff \n//this one should work, no?:\n~.Stuff roo> controller --class ~.web.TestController\n//response: Please wait - still loading\n//no controller commands seem to work at this point", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.ControllerCommands.java", "org.springframework.roo.shell.AbstractShell.java"], "label": 1, "es_results": []}, {"bug_id": 2294, "bug_title": "DataOnDemandMetadata assumes @Column annotation length attribute to be greater the one for an Entity attribute", "bug_description": "The following code below (lines 656-665) in DataOnDemandMetadata.java assumes an entity&apos;s @Column annotation&apos;s \"length\" attribute WILL NOT be of size one for a particular column.   This would cause a StringIndexOutOfBoundsException when the code below runs if the entity&apos;s @Column annotation&apos;s  \"length\" attribute is of size one.   When the Roo she will is spawned it will print the console the following info \"String index out of range: -1\".\n                                else {\n\t\t\t\t\t// Check for @Column\n\t\t\t\t\tAnnotationMetadata columnAnnotation = MemberFindingUtils.getAnnotationOfType(field.getAnnotations(), COLUMN);\n\t\t\t\t\tif (columnAnnotation != null) {\n\t\t\t\t\t\tAnnotationAttributeValue<?> lengthValue = columnAnnotation.getAttribute(new JavaSymbolName(\"length\"));\n\t\t\t\t\t\tif (lengthValue != null && (initializer.length() + 2) > (Integer) lengthValue.getValue()) \n{\n\t\t\t\t\t\t\tinitializer = initializer.substring(0, (Integer) lengthValue.getValue() - 2);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2302, "bug_title": "The GWT Add-On fails on updating the ui.xml file when a field is declared in the governor", "bug_description": "The message that is returned is \"NOT_FOUND_ERR: An attempt is made to reference a node in a context where it does not exist.\"", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.GwtMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2312, "bug_title": "DataOnDemandMetadataProvider and IntegrationTestMetadataProvider not responding to relevant external changes due to late dependency registration", "bug_description": "Dependency registrations in DataOnDemandMetadataProvider and IntegrationTestMetadataProvider are occurring too late which means that changes to the external model are not being passed onto the these providers.", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadataProvider.java", "org.springframework.roo.addon.test.IntegrationTestMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2225, "bug_title": "ApplicationConversionServiceFactoryBean does not set all Converters", "bug_description": "When overwriting some Converters for some classes in ApplicationConversionServiceFactoryBean the default roo-generated converters for the other classes are ignored.\nA Workaround is to copy all Converters to the ApplicationConversionServiceFactoryBean.", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.classpath.details.MemberFindingUtils.java", "org.springframework.roo.addon.web.mvc.controller.converter.ConversionServiceMetadata.java", "org.springframework.roo.classpath.itd.ItdSourceFileComposer.java"], "label": 1, "es_results": []}, {"bug_id": 2316, "bug_title": "GWT Add-On adds a method to a proxy type twice in some cases", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.GwtMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2320, "bug_title": "Background thread names incorrectly displayed when she will starts up with developmentMode=false system property", "bug_description": "\"[Spring Roo Process Manager Background Polling Thread]\" incorrectly displays when development mode is false at startup time (eg as per roo.sh startup script).", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.3.RELEASE", "fixed_files": ["org.springframework.roo.shell.jline.JLineLogHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2328, "bug_title": "ROO should not add a dependency to the pom if it is already in the pom as \"provided\"", "bug_description": "Example:\nIf I change the jstl dependency to provided scope in the pom, ROO will re-add the dependency the next time I run the controller scaffold command.  The end result is I now have jstl defined twice in the pom.  Once without scope and once with provided.\nThis should not happen with any dependency, so I am not sure if this is specific to the addon-web-mvc-controller or it would happen with other add ons as well.  \nThis is related to ROO-1006", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.project.Dependency.java"], "label": 1, "es_results": []}, {"bug_id": 2386, "bug_title": "Avoid potential NPE in accessing \"she will\" in AddOnRooBotOperationsImpl", "bug_description": "Though the she will is injected in by Felix and should not be null, it is checked for null after code which calls methods on it. ", "project": "Spring", "sub_project": "ROO", "version": "1.1.2.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.roobot.client.AddOnRooBotOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2344, "bug_title": "JpaOperationsImpl is not removing Plugins from ProjectOperations when carrying out a Plugin removal", "bug_description": "JpaOperationsImpl removes a Plugin from the pom.xml file but doesn&apos;t convey this change to ProjectOperation causing the Plugin state in ProjectOperation to be become out of sync and PluginListeners not be to notified.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.jpa.JpaOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2351, "bug_title": "NPE thrown on bundle.getHeaders().get(\"Bundle-SymbolicName\").toString() ", "bug_description": "The call to the toString() method on bundle.getHeaders().get(\"Bundle-SymbolicName\") throws a NullPointerException if bundle.getHeaders().get(\"Bundle-SymbolicName\") returns null. Not sure why this started happening. ", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.roobot.client.AddOnRooBotOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2353, "bug_title": "NullPointerException on performing \"addon list\" in the Roo she will", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.roobot.client.AddOnRooBotOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2354, "bug_title": "UnknownHostException thrown on Roo startup in DBRE project with no Internet connection", "bug_description": "If a user starts the Roo she will in a DBRE project with no Internet connection, an UnknownHostException stack trace is displayed when Roo  deserializes the database from dbre.xml file due to an attempt to read the Torque database DTD located at db.apache.org", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.dbre.model.DatabaseXmlUtils.java"], "label": 1, "es_results": []}, {"bug_id": 2343, "bug_title": "JavaBean IT WOULD does not refresh when changing to and from GAE", "bug_description": "The JavaBean IT WOULD isn&apos;t being refreshed when changing persistence providers to and from GAE.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.javabean.JavaBeanMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2369, "bug_title": "A certain field variable breaks ROO. It only writes \"Index: 0, Size: 0\" into the console and does not do anything anymore.", "bug_description": "Please see the attached extremely simple ROO project, which reproduces the problem. I created it with ROO and also created a tst directory and a test java file in its src/main/java directory.\nWhat happens is that ROO stops working. It says \"Index: 0, Size: 0\" in the ROO console (started from the command line to be sure...) and does not create any .aj files any more.\n(I did not see that problem with 1.1.2.RELEASE.)\nThanks for having a look at it!", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.javabean.JavaBeanMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2371, "bug_title": "Removing a RooDbManaged annotation from a type whilst Roo is not running and then loading the Roo causes an exception", "bug_description": "The message raised is \"Type for table &apos;employed&apos; could not be found\" for the attached project.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.dbre.DbreMetadata.java", "org.springframework.roo.addon.dbre.DbreMetadataProviderImpl.java", "org.springframework.roo.addon.dbre.DbreDatabaseListenerImpl.java", "org.springframework.roo.classpath.TypeLocationService.java", "org.springframework.roo.classpath.TypeLocationServiceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2368, "bug_title": "Overriding method results in Method '*' already defined in target type", "bug_description": "I had a working project running 1.1.2. I upgraded to 1.1.3 and the following issues began. I have not found a work-around but wonder if there is a technique for overriding methods that I should be using and am not.\nIn my AthleteController I have the following:\nCode:\n@RequestMapping(value = \"/\n{id}\n\", method = RequestMethod.GET)\n    public String show(@PathVariable(\"id\") Long id, Model uiModel) \n{\n\tAthleteController.addBirthdayDateTimeFormatPatterns(uiModel);\n\tuiModel.addAttribute(\"athlete\", Athlete.findAthlete(id));\n\tuiModel.addAttribute(\"itemId\", id);\n\treturn \"athletes/show\";\n    }\n\nand in my roo she will it instantly complains:\nCode:\nMethod &apos;show&apos; already defined in target type &apos;com.blah.controllers.AthleteController&apos; (IT WOULD target &apos;com.blah.controllers.AthleteController_Roo_Controller&apos;)\nFor basically every method that I have overridden in my controllers it complains. (As I fix one, the next one comes up complaining in the she will.) Renaming the method name does stop the complaining,but Roo then also re-gen&apos;s the method in the Roo class.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.scaffold.mvc.WebScaffoldMetadataProviderImpl.java", "org.springframework.roo.addon.web.flow.WebFlowOperationsImpl.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.finder.WebFinderMetadataProviderImpl.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.finder.WebFinderMetadata.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.mvc.WebScaffoldMetadata.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.mvc.WebScaffoldMetadataProvider.java", "org.springframework.roo.classpath.details.MemberFindingUtils.java"], "label": 1, "es_results": []}, {"bug_id": 2362, "bug_title": "Finders not working in WebScaffold", "bug_description": "Just ran the petclinic script with 1.1.3 and saw no sign of the method that actually does call the finder method on the domain object\nThis is ok\n    @RequestMapping(params = \n{ \"find=ByNameAndWeight\", \"form\" }\n, method = RequestMethod.GET)\n    public String PetController.findPetsByNameAndWeightForm(Model uiModel) \n{\n        return \"pets/findPetsByNameAndWeight\";\n    }\n\nThis is missing?\n    @RequestMapping(params = \"find=ByNameAndWeight\", method = RequestMethod.GET)\n    public String PetController.findPetsByNameAndWeight(@RequestParam(\"name\") String name, @RequestParam(\"weight\") Float weight, Model uiModel) \n{\n        uiModel.addAttribute(\"pets\", Pet.findPetsByNameAndWeight(name, weight).getResultList());\n        return \"pets/list\";\n    }\n\nSince this method is missing, spring ends up calling\n    @RequestMapping(method = RequestMethod.GET)\n    public String PetController.list(@RequestParam(value = \"page\", required = false) Integer page, @RequestParam(value = \"size\", required = false) Integer size, Model uiModel) {\nwhich calls Pet.findAllPets()\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.scaffold.finder.WebFinderMetadataProviderImpl.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.finder.WebFinderMetadata.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.finder.WebFinderMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2359, "bug_title": "Finder AspectJ MEMBER OF select statement format incorrect", "bug_description": "Upgraded from 1.1.2 to 1.1.3 finders have been changed so that now using o rather than the entity name e.g.\nSELECT o FROM EntityName AS o WHERE ...\nrather than:\nSELECT EntityName FROM EntityName AS EntityName WHERE ...\nas for 1.1.2\nThis is fine but the MEMBER of statement has not been updated when referencing a collection within the entity e.g.\n1.1.2 code:\nSELECT entityName FROM EntityName AS entityName WHERE :member_item0 MEMBER OF entityName.members\n1.1.3 code:\nSELECT o FROM EntityName AS o WHERE :member_item0 MEMBER OF entityName.members\nthis should be:\nSELECT o FROM EntityName AS o WHERE :member_item0 MEMBER OF o.members\nThe fix for this is to move affected finders into entity class and make appropriate changes.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.scaffold.finder.WebFinderMetadataProviderImpl.java", "org.springframework.roo.addon.finder.FinderMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2350, "bug_title": "GAE - @ManyToOne property never set / inneficient use", "bug_description": "When having a @ManyToOne field with GOOGLE_APP_ENGINE, Spring ROO generates code that never sets the field and re-fetches it every time it is accessed:\n\n\n\n\n\n\n// Spring Roo 1.1.4.BUILD-SNAPSHOT [rev c6e48eb] log opened at 2011-04-15 18:13:20\n\n\n\n\nproject --topLevelPackage com.test\n\n\n\n\npersistence setup --provider DATANUCLEUS --database GOOGLE_APP_ENGINE \n\n\n\n\nentity --class ~.User --serializable --permitReservedWords \n\n\n\n\nfield string --fieldName name --notNull \n\n\n\n\njson all\n\n\n\n\ncontroller scaffold --class ~.web.UserController --entity ~.User\n\n\n\n\nentity --class ~.UserRole --serializable \n\n\n\n\nfield string --fieldName name --notNull \n\n\n\n\nfield reference --fieldName user --type ~.User --cardinality MANY_TO_ONE --permitReservedWords \n\n\n\n\ncontroller scaffold --class ~.web.UserRoleController\n\n\n\n\nfocus --class ~.User\n\n\n\n\nfield set --fieldName roles --type ~.UserRole --cardinality ONE_TO_MANY --mappedBy user \n\n\n\n\nquit\n\n\n\n\n// Spring Roo 1.1.4.BUILD-SNAPSHOT [rev c6e48eb] log closed at 2011-04-15 18:14:49\n\n\n\n\n\n\nGenerates a UserRole class:\n\n\n\n\n\n\n@RooJavaBean\n\n\n\n\n@RooToString\n\n\n\n\n@RooEntity\n\n\n\n\n@RooSerializable\n\n\n\n\npublic class UserRole {\n\n\n\n\n\n\n\n\n\n    @NotNull\n\n\n\n\n    private String name;\n\n\n\n\n\n\n\n\n\n    @ManyToOne\n\n\n\n\n    private User user;\n\n\n\n\n}\n\n\n\n\n\n\nwhich generates UserRole_Roo_JavaBean.aj that contains the getter and setter for the User class\n\n\n\n\n\n\n    public User UserRole.getUser() {\n\n\n\n\n        if (this.userId != null) {\n\n\n\n\n            this.user = User.findUser(this.userId);\n\n\n\n\n        } else {\n\n\n\n\n            this.user = null;\n\n\n\n\n        }\n\n\n\n\n        return this.user;\n\n\n\n\n    }\n\n\n\n\n    \n\n\n\n\n    public void UserRole.setUser(User user) {\n\n\n\n\n        if (user != null) {\n\n\n\n\n            if (user.getId () == null) {\n\n\n\n\n                user.persist();\n\n\n\n\n            }\n\n\n\n\n            this.userId = user.getId();\n\n\n\n\n        } else {\n\n\n\n\n            this.userId = null;\n\n\n\n\n        }\n\n\n\n\n    } \n\n\n\n\n\n\nHOWEVER, every time role.user is accessed, a query is made.  This is very inefficient, especially if you access this property multiple times in a code block.\nSuggestion, take advantage of the field you are marking transient and generate the following instead:\n\n\n\n\n\n\npublic User UserRole.getUser() {\n\n\n\n\n    if (this.userId != null) {\n\n\n\n\n        if (this.user == null || this.user.getId() != this.userId) {\n\n\n\n\n            this.user = User.findUser(this.userId);\n\n\n\n\n        }\n\n\n\n\n    } else {\n\n\n\n\n        this.user = null;\n\n\n\n\n    }\n\n\n\n\n    return this.user;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\npublic void UserRole.setUser(User user) {\n\n\n\n\n    if (user != null) {\n\n\n\n\n        if (user.getId () == null) {\n\n\n\n\n            user.persist();\n\n\n\n\n        }\n\n\n\n\n        this.userId = user.getId();\n\n\n\n\n    } else {\n\n\n\n\n        this.userId = null;\n\n\n\n\n    }\n\n\n\n\n    this.user = user;\n\n\n\n\n}\n\n\n\n\n\n\nThis way the now marked transient field is utilized and subsequent requests don&apos;t result in calls to the database.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.javabean.JavaBeanMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2357, "bug_title": "Error with the generated code in *Roo_Controller.aj, *Roo_DataOnDemand.aj and *Roo_IntegrationTest.aj when an entity class extends an other entiy class", "bug_description": "The code generated with in the aspectJ files has a mix of problems that mean that the project will not compile, for example with in the controller it is calling the mothod findAllPolicys from the parent class rather than calling findAllMotorPolicys, and this is then generating a type conversion error as the List<MotorPolicy> is what is expected but List<Policy> is what is being returned. This is also happening in the IntegrationTest aspects and DataOnDemand. The other issue is that in the DataOnDemand aspects the set methods used to propulate the data is being set with the parameters of ( Policy , int ) rather than ( MotorPolicy, int ). I will attach some of the class and aspect files from the project to show examples as to what is happening.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.classpath.customdata.taggers.MethodMatcher.java", "org.springframework.roo.classpath.scanner.MemberDetailsBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 2295, "bug_title": "GWT raise error using domain hierarhy", "bug_description": "I used nightly build version spring-roo-1.1.3.BUILD-SNAPSHOT_20110404.105742-cff4477.\nThe domain hierarchy doesn&apos;t work properly at runtime stage.\nIt is compiled fine. But error is raised when page is opened in browser. gwt:run is used.\nAdd the following linese to expenses.roo to reproduce error:\nentity --class ~.server.domain.Generic --abstract\nentity --class ~.server.domain.Employee --extends Generic --testAutomatically\nfield string --fieldName test  --class Generic", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.GwtMetadataProviderImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2381, "bug_title": "Generated source code for classes extending abstract classes instantiates superclass instead of subclass for test data on demand depending on class name and top-level package name", "bug_description": "The generated test file <classname>DataOnDemand_Roo_DataOnDemand.aj incorrectly uses the abstract superclass instead of the subclass.  For instance, the method getNewTransient<classname> tries to instantiate the abstract class.  The behavior varies depending on the name of the class, and also depending on the top level package name.  For instance, class name OperationalEnvironment triggers this behavior, while class name AperationalEnvironment does not.  (this name was used while debugging a complex data model).  A similar behavior was observed with name pairs Cloud and CloudProvider.  Changing the top level package name can actually reverse the behavior for these pairs of names.  Sample roo script files attached for both classes.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.classpath.customdata.taggers.MethodMatcher.java", "org.springframework.roo.classpath.scanner.MemberDetailsBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 2374, "bug_title": "web gwt setup results in compilation errors", "bug_description": "I tried to create a simple Spring Roo project with GWT frontend. There are compilation errors after I run the command web gwt setup.\nRelevant portion of the maven build log:\n/21/11 12:59:04 AM EDT: [WARN] Failure to transfer asm:asm/maven-metadata.xml from file:../../local.repository/trunk was cached in the local repository, resolution will not be reattempted until the update interval of local.repository has elapsed or updates are forced. Original error: Could not transfer metadata asm:asm/maven-metadata.xml from/to local.repository (file:../../local.repository/trunk): No connector available to access repository local.repository (file:../../local.repository/trunk) of type legacy using the available factories AsyncRepositoryConnectorFactory, WagonRepositoryConnectorFactory\n4/21/11 12:59:04 AM EDT: Generating sources /ererg/pom.xml\n4/21/11 12:59:05 AM EDT: [WARN] Failure to transfer asm:asm/maven-metadata.xml from file:../../local.repository/trunk was cached in the local repository, resolution will not be reattempted until the update interval of local.repository has elapsed or updates are forced. Original error: Could not transfer metadata asm:asm/maven-metadata.xml from/to local.repository (file:../../local.repository/trunk): No connector available to access repository local.repository (file:../../local.repository/trunk) of type legacy using the available factories AsyncRepositoryConnectorFactory, WagonRepositoryConnectorFactory\n4/21/11 12:59:09 AM EDT: [ERROR] The import com.google.appengine cannot be resolved\n4/21/11 12:59:09 AM EDT: [ERROR] The import com.google.appengine cannot be resolved\n4/21/11 12:59:09 AM EDT: [ERROR] UserService cannot be resolved to a type\n4/21/11 12:59:09 AM EDT: [ERROR] UserServiceFactory cannot be resolved\n4/21/11 12:59:10 AM EDT: [ERROR] The import com.google.appengine cannot be resolved\n4/21/11 12:59:10 AM EDT: [ERROR] User cannot be resolved to a type", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.GwtOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2379, "bug_title": "Push-in of methods from _Roo_Entity.aj causes method to be removed from corresponding Request .java", "bug_description": "Push-in persist method from MyEntity_Roo_Entity.aj to MyEntity.java works if you do manually edit MyEntity. However after editing the persist() in MyEntity, Roo removes the persist() from ~.client.managed.request.MyEntityRequest. This causes a compile error. Manually replacing the method in MyEntityRequest fixes this until MyEntity is edited again. ", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.GwtOperationsImpl.java", "org.springframework.roo.addon.gwt.GwtMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.GwtTemplateDataHolder.java", "org.springframework.roo.addon.gwt.GwtMetadata.java", "org.springframework.roo.addon.entity.EntityMetadata.java", "org.springframework.roo.addon.gwt.GwtTemplateService.java", "org.springframework.roo.addon.gwt.GwtType.java", "org.springframework.roo.addon.gwt.GwtFileManager.java", "org.springframework.roo.addon.gwt.GwtTypeService.java", "org.springframework.roo.addon.gwt.GwtUtils.java", "org.springframework.roo.addon.gwt.GwtTemplateServiceImpl.java", "org.springframework.roo.addon.gwt.GwtTypeServiceImpl.java", "org.springframework.roo.addon.gwt.TemplateResourceLoader.java"], "label": 1, "es_results": []}, {"bug_id": 2388, "bug_title": "Roo Finder is not correctly generated", "bug_description": "public static TypedQuery<Controlway> Controlway.findControlwaysByGroups(Set<Controlgroup> groups) {\n        if (groups == null) throw new IllegalArgumentException(\"The groups argument is required\");\n        EntityManager them = Controlway.entityManager();\n        StringBuilder queryBuilder = new StringBuilder(\"SELECT o FROM Controlway AS o WHERE\");\n        for (int i = 0; i < groups.size(); i++) \n{\n            if (i > 0) queryBuilder.append(\" AND\");\n            queryBuilder.append(\" :groups_item\").append(i).append(\" MEMBER OF controlway.groups\"); // here the &apos;controlway&apos; is wrong if i change it to &apos;o&apos; than it works\n        }\n        TypedQuery<Controlway> q = them.createQuery(queryBuilder.toString(), Controlway.class);\n        int groupsIndex = 0;\n        for (Controlgroup _controlgroup: groups) \n{\n            q.setParameter(\"groups_item\" + groupsIndex++, _controlgroup);\n        }\n        return q;\n    }\nIf I start the Roo she will it will override my changes and this is very annoying", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.scaffold.finder.WebFinderMetadataProviderImpl.java", "org.springframework.roo.addon.finder.FinderMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2392, "bug_title": "ToString add-on removes toString method if MemberDetails is not complete", "bug_description": "Each time ToStringMetadataProvider is called, the toString method is built but if the last pass does not detect any accessors, the toString method is null and is removed from the IT WOULD. This can be demonstrated if fields and accessors are introduced via DBRE", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.tostring.ToStringMetadata.java", "org.springframework.roo.addon.tostring.ToStringMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2396, "bug_title": "pushing in controller method breaks roo she will", "bug_description": "Pushing a controller method in from the generated aspect causes the roo she will to complain about the method already existing in the target type\n\"Method &apos;show&apos; already defined in target type &apos;com.company.web.ThermalSpaceController&apos; (IT WOULD target &apos;com.company.web.ThermalSpaceController_Roo_Controller&apos;)\"\nEven worse, the roo she will apparently fails to continue executing after issuing that warning, so once a method has been pushed in, no changes to any other file in the project will be correctly round-tripped in the she will.  In my case, I made changes to some of my entities, none of which were reflected in the generated aspects - no new methods in toString(), no changes to _Roo_Entity, etc.  It took me a very long time to determine that the problem was that I had pushed in a single controller method.  I didn&apos;t even modify the method.  I hadn&apos;t gotten that far yet.  I pushed the method in, then attempted to modify a couple of entities in a manner that would then require changes to the controller, but I could not get the entities to update.\nYOu can see my original thread about the problem, before I figured out what was causing it, here:\nhttp://forum.springsource.org/showthread.php?t=108776\nI started a second thread to discuss the problem that I eventually discovered:\nhttp://forum.springsource.org/showthread.php?t=108779\nNote - If I change the name of the method in the java file, then the problem goes away.  However, roo continues to generate the equivalent method with the exact same RequestMapping.  So then, when I run the code, I get complaints about ambiguous handler methods.  I&apos;m ok with changing the method name, but roo then needs to match on RequestMapping annotations and strip any methods in the generated aspects which match mappings in the java file.  Or something.  Roo is unusable as it stands today.  Once you&apos;ve modified a single controller, all round-tripping appears to be broken", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.scaffold.mvc.WebScaffoldMetadataProviderImpl.java", "org.springframework.roo.addon.web.flow.WebFlowOperationsImpl.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.finder.WebFinderMetadataProviderImpl.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.finder.WebFinderMetadata.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.mvc.WebScaffoldMetadata.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.mvc.WebScaffoldMetadataProvider.java", "org.springframework.roo.classpath.details.MemberFindingUtils.java"], "label": 1, "es_results": []}, {"bug_id": 2400, "bug_title": "GAE - ROO Auto-generates code for fields marked as @Transient", "bug_description": "I have a class with the following fields:\n\n\n\n\n\n\n    @Transient private Type type;\n\n\n\n\n    @Transient private Category category;\n\n\n\n\n    @Transient private SubCategory subCategory;\n\n\n\n\n\n\nI do not want ROO to generate persistence code for them, but although they are marked as transient, ROO still generated the following:\nImage_Roo_JavaBean.aj\n\n\n\n\n\n\n    private Long Image._typeId;\n\n\n\n\n    \n\n\n\n\n    private Long Image._categoryId;\n\n\n\n\n    \n\n\n\n\n    private Long Image._subCategoryId;\n\n\n\n\n\n\n\n\n\n   public Type Image.getType() {\n\n\n\n\n        if (this._typeId != null) {\n\n\n\n\n            if (this.type == null || this.type.getId() != this._typeId) {\n\n\n\n\n                this.type = Type.findType(this._typeId);\n\n\n\n\n            }\n\n\n\n\n        } else {\n\n\n\n\n            this.type = null;\n\n\n\n\n        }\n\n\n\n\n        return this.type;\n\n\n\n\n    }\n\n\n\n\n    \n\n\n\n\n    public void Image.setType(Type type) {\n\n\n\n\n        if (type != null) {\n\n\n\n\n            if (type.getId () == null) {\n\n\n\n\n                type.persist();\n\n\n\n\n            }\n\n\n\n\n            this._typeId = type.getId();\n\n\n\n\n        } else {\n\n\n\n\n            this._typeId = null;\n\n\n\n\n        }\n\n\n\n\n        this.type = type;\n\n\n\n\n    }\n\n\n\n\n    \n\n\n\n\n    public Long Image.getCategoryId() {\n\n\n\n\n        return this.categoryId;\n\n\n\n\n    }\n\n\n\n\n    \n\n\n\n\n    public void Image.setCategoryId(Long categoryId) {\n\n\n\n\n        this.categoryId = categoryId;\n\n\n\n\n    }\n\n\n\n\n    \n\n\n\n\n    public Category Image.getCategory() {\n\n\n\n\n        if (this._categoryId != null) {\n\n\n\n\n            if (this.category == null || this.category.getId() != this._categoryId) {\n\n\n\n\n                this.category = Category.findCategory(this._categoryId);\n\n\n\n\n            }\n\n\n\n\n        } else {\n\n\n\n\n            this.category = null;\n\n\n\n\n        }\n\n\n\n\n        return this.category;\n\n\n\n\n    }\n\n\n\n\n    \n\n\n\n\n    public void Image.setCategory(Category category) {\n\n\n\n\n        if (category != null) {\n\n\n\n\n            if (category.getId () == null) {\n\n\n\n\n                category.persist();\n\n\n\n\n            }\n\n\n\n\n            this._categoryId = category.getId();\n\n\n\n\n        } else {\n\n\n\n\n            this._categoryId = null;\n\n\n\n\n        }\n\n\n\n\n        this.category = category;\n\n\n\n\n    }\n\n\n\n\n    \n\n\n\n\n    public Long Image.getSubCategoryId() {\n\n\n\n\n        return this.subCategoryId;\n\n\n\n\n    }\n\n\n\n\n    \n\n\n\n\n    public void Image.setSubCategoryId(Long subCategoryId) {\n\n\n\n\n        this.subCategoryId = subCategoryId;\n\n\n\n\n    }\n\n\n\n\n    \n\n\n\n\n    public SubCategory Image.getSubCategory() {\n\n\n\n\n        if (this._subCategoryId != null) {\n\n\n\n\n            if (this.subCategory == null || this.subCategory.getId() != this._subCategoryId) {\n\n\n\n\n                this.subCategory = SubCategory.findSubCategory(this._subCategoryId);\n\n\n\n\n            }\n\n\n\n\n        } else {\n\n\n\n\n            this.subCategory = null;\n\n\n\n\n        }\n\n\n\n\n        return this.subCategory;\n\n\n\n\n    }\n\n\n\n\n    \n\n\n\n\n    public void Image.setSubCategory(SubCategory subCategory) {\n\n\n\n\n        if (subCategory != null) {\n\n\n\n\n            if (subCategory.getId () == null) {\n\n\n\n\n                subCategory.persist();\n\n\n\n\n            }\n\n\n\n\n            this._subCategoryId = subCategory.getId();\n\n\n\n\n        } else {\n\n\n\n\n            this._subCategoryId = null;\n\n\n\n\n        }\n\n\n\n\n        this.subCategory = subCategory;\n\n\n\n\n    }\n\n\n\n\n\n\nThe problem with this is that when I persist my class, I get 3 irrelevant properties in my datastore that are causing me grief.\nAs a workaround, I tried adding my own getters and setters to the class.  This would be ok, but it still generates just the fields:\n\n\n\n\n\n\n    private Long Image._typeId;\n\n\n\n\n    \n\n\n\n\n    private Long Image._categoryId;\n\n\n\n\n    \n\n\n\n\n    private Long Image._subCategoryId;\n\n\n\n\n\n\nHow do I get it to stop?", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.javabean.JavaBeanMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2403, "bug_title": "DBRE throws wrong exception message when content of dbre.xml is invalid", "bug_description": "When content is present in the prolog of the dbre.xml, a less than useful message is given to the user", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.dbre.model.DatabaseXmlUtils.java", "org.springframework.roo.addon.dbre.DbreMetadataProviderImpl.java", "org.springframework.roo.addon.dbre.DbreTypeUtils.java", "org.springframework.roo.addon.dbre.model.DbreModelServiceImpl.java", "org.springframework.roo.addon.dbre.DbreDatabaseListenerImpl.java", "org.springframework.roo.addon.dbre.model.DbreModelService.java", "org.springframework.roo.addon.dbre.DbreOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2404, "bug_title": "ImportRegistrationResolver uses fqn for genric types, even if not necessary", "bug_description": "Let&apos;s assume, we have an IT WOULD, where we use the following types:\njava.util.List<java.lang.String>\njava.util.List<java.lang.Integer>\nFor the first type, the ImportRegistrationResolver sucessfully adds the proper import for java.util.List. So, the type name in the code becomes the short form:  List<String>\nBut when the second type is resolved, ImportRegistrationResolver.isAdditionLegal() will return false, since both types have the same simple type name (List). Thus, the Javatype java.util.List<java.lang.Integer> is not registered as an import.\nThus, the long form is used in the generated code: java.util.List<Integer>\nI think a solution to this problem could be not to keep the full JavaTypes in the Set of registered types in ImportRegistrationResolver.  Instead, the generic type arguments (and probably also array dimesions and so on) should be stripped off.  (Since java.util.List<java.lang.String> ,  java.util.List<java.lang.Integer>, java.util.List<java.lang.String> [] are all the same import statement java.util.List...) \n", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.model.ImportRegistrationResolverImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2419, "bug_title": "In @RooWebScaffold 'exposeJson = true' should consider 'create', 'update' and 'delete'", "bug_description": "When an entity is exposed by JSON in a Controller at @RooWebScaffold annotation with &apos;exposeJson = true&apos; attribute, should be considered same annotation attributes:\n\ncreate\nupdate\ndelete\n\nElse define it own JSON create, update and delete attributes.\nThere is a security problem when create, update or delete is disabled on MVC and not allow disabling on JSON either.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.scaffold.json.WebJsonMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2418, "bug_title": "Wrong encoding content in JSON response", "bug_description": "I have a controller like this:\n\n\n\n\n\n\nTcmnNucleosController.java\n\n\n\n\n\n\n\n\n\n\n\n@RooWebScaffold(path = \"tcmnnucleoses\", formBackingObject = TcmnNucleos.class, create = false, update = false, delete = false, exposeJson=true)\n\n\n\n\n@RequestMapping(\"/tcmnnucleoses\")\n\n\n\n\n@Controller\n\n\n\n\npublic class TcmnNucleosController {\n\n\n\n\n\n\n\n\n\n    @RequestMapping(params = \"find=ByProvincia\", method = RequestMethod.GET) //, headers = \"Accept=application/json\")\n\n\n\n\n    @ResponseBody\n\n\n\n\n    public String jsonFindTcmnNucleosesByProvincia(\n\n\n\n\n            @RequestParam(\"provincia\") String provincia) {\n\n\n\n\n \n\n\n\n\n        return TcmnNucleos.toJsonArray(TcmnNucleos\n\n\n\n\n                .findTcmnNucleosesByProvincia(\n\n\n\n\n                        TcmnProvincias.findTcmnProvincias(provincia))\n\n\n\n\n                .getResultList());\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n\n\nIn &apos;TcmnNucleos&apos; postgreSQL table, enconded in UTF-8, contains data like:\n\n\n\n\n\n\n\n\n\n\n\n\"Pruba\"\n\n\n\n\n\"Quart\"\n\n\n\n\n\"Mislata\"\n\n\n\n\n\"Manresa\"\n\n\n\n\n\n\n\n\n\n\n\nThis call returns this:\n\n\n\n\n\n\n$ wget -O - -S --header=&apos;Accept: application/json,application/javascript&apos; &apos;http://localhost:8080/acuses/tcmnnucleoses/?provincia=1&find=ByProvincia&apos;\n\n\n\n\n--2011-05-11 15:50:15--  http://localhost:8080/acuses/tcmnnucleoses/?provincia=1&find=ByProvincia\n\n\n\n\nResolviendo localhost... ::1, 127.0.0.1\n\n\n\n\nConectando a localhost|::1|:8080... conectado.\n\n\n\n\nPeticin HTTP enviada, esperando respuesta... \n\n\n\n\n  HTTP/1.1 200 OK\n\n\n\n\n  Server: Apache-Coyote/1.1\n\n\n\n\n  Content-Type: application/json;charset=UTF-8\n\n\n\n\n  Content-Length: 1854\n\n\n\n\n  Date: Wed, 11 May 2011 13:50:16 GMT\n\n\n\n\n  Connection: keep-alive\n\n\n\n\nLongitud: 1854 (1,8K) [application/json]\n\n\n\n\nGuardando en: STDOUT\n\n\n\n\n[{...:\"Pruba\",\"dnuclc\":null,...}]\n\n\n\n\n\n\nJSON returned content is encoded in WINDOWS-1252 but http header says application/json;charset=UTF-8\nWeb.xml has no changes.\n\n\n\n\n\n\nweb.xml\n\n\n\n\n\n\n\n\n\n\n\n  <filter>\n\n\n\n\n        <filter-name>CharacterEncodingFilter</filter-name>\n\n\n\n\n        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>\n\n\n\n\n        <init-param>\n\n\n\n\n            <param-name>encoding</param-name>\n\n\n\n\n            <param-value>UTF-8</param-value>\n\n\n\n\n        </init-param>\n\n\n\n\n        <init-param>\n\n\n\n\n            <param-name>forceEncoding</param-name>\n\n\n\n\n            <param-value>true</param-value>\n\n\n\n\n        </init-param>\n\n\n\n\n    </filter>\n\n\n\n\n    \n\n\n\n\n    \n\n\n\n\n    \n\n\n\n\n    <filter>\n\n\n\n\n        <filter-name>HttpMethodFilter</filter-name>\n\n\n\n\n        <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>\n\n\n\n\n    </filter>\n\n\n\n\n    ....\n\n\n\n\n    ....\n\n\n\n\n\n\n\n\n\n   <filter-mapping>\n\n\n\n\n        <filter-name>CharacterEncodingFilter</filter-name>\n\n\n\n\n        <url-pattern>/*</url-pattern>\n\n\n\n\n    </filter-mapping>\n\n\n\n\n    \n\n\n\n\n    ....\n\n\n\n\n    ....\n\n\n\n\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.scaffold.json.WebJsonMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2431, "bug_title": "jspx and conversion service bean needlessly updated when Roo she will starts", "bug_description": "With no changes to the governors, jspx files and the ApplicationConversionServiceFactoryBean_Roo_ConversionService IT WOULD are being updated each time the Roo she will is restarted.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.menu.MenuOperationsImpl.java", "org.springframework.roo.addon.web.mvc.jsp.JspViewManager.java", "org.springframework.roo.addon.solr.SolrJspMetadataListener.java", "org.springframework.roo.support.util.XmlRoundTripUtils.java", "org.springframework.roo.addon.web.mvc.jsp.JspMetadataListener.java", "org.springframework.roo.addon.web.mvc.controller.converter.ConversionServiceMetadataProvider.java", "org.springframework.roo.addon.web.mvc.controller.details.WebMetadataServiceImpl.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.mvc.WebScaffoldMetadataProviderImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2417, "bug_title": "DBRE managed fields do not appear in the generated toString() method if any field exists in the governor", "bug_description": "The toString() accurately shows entries for db-managed fields, however these same fields are removed from the toString() method if a new field is added to the entity&apos;s .java file. Then only the .java file&apos;s fields are displayed in the toString() method.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.dbre.DbreMetadataProviderImpl.java", "org.springframework.roo.addon.dbre.model.DbreModelServiceImpl.java", "org.springframework.roo.addon.tostring.ToStringMetadataProvider.java", "org.springframework.roo.classpath.itd.AbstractItdMetadataProvider.java", "org.springframework.roo.classpath.details.BeanInfoUtils.java"], "label": 1, "es_results": []}, {"bug_id": 2437, "bug_title": "@Temporal annotation missing on PK field produced by DBRE", "bug_description": "@Temporal annotation missing on PK field produced by DBRE. Using Pagila DB from postgres samples.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.entity.IdentifierMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2438, "bug_title": "Missing @MockStaticEntityMethods annotation in test mock", "bug_description": "The generated mock test requires mocking of static entity methods, and as such won&apos;t run as is.  Current code is missing a class-level annotation, @MockStaticEntityMethods, which will make the code function properly.\nIncorrect version: \n\n\n\n\n\n\n\n\n\n\n\npackage org.rooina.coursemanager.model;\n\n\n\n\n\n\n\n\n\nimport org.junit.Test;\n\n\n\n\n\n\n\n\n\npublic class StudentTest {\n\n\n\n\n\n\n\n\n\n    @Test\n\n\n\n\n    public void testMethod() {\n\n\n\n\n        int expectedCount = 13;\n\n\n\n\n        Student.countStudents();\n\n\n\n\n        org.springframework.mock.staticmock.AnnotationDrivenStaticEntityMockingControl.expectReturn(expectedCount);\n\n\n\n\n        org.springframework.mock.staticmock.AnnotationDrivenStaticEntityMockingControl.playback();\n\n\n\n\n        org.junit.Assert.assertEquals(expectedCount, Student.countStudents());\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nCorrect version:\n\n\n\n\n\n\npackage org.rooina.coursemanager.model;\n\n\n\n\n\n\n\n\n\nimport org.junit.Test;\n\n\n\n\nimport org.springframework.mock.staticmock.MockStaticEntityMethods;\n\n\n\n\n\n\n\n\n\n@MockStaticEntityMethods\n\n\n\n\npublic class StudentTest {\n\n\n\n\n\n\n\n\n\n    @Test\n\n\n\n\n    public void testMethod() {\n\n\n\n\n        int expectedCount = 13;\n\n\n\n\n        Student.countStudents();\n\n\n\n\n        org.springframework.mock.staticmock.AnnotationDrivenStaticEntityMockingControl.expectReturn(expectedCount);\n\n\n\n\n        org.springframework.mock.staticmock.AnnotationDrivenStaticEntityMockingControl.playback();\n\n\n\n\n        org.junit.Assert.assertEquals(expectedCount, Student.countStudents());\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.4.RELEASE", "fixed_files": ["org.springframework.roo.addon.test.IntegrationTestOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2453, "bug_title": "json add ignores --disallowedOperations flag on the controller", "bug_description": "If you specify you want to disallow some of the crud operations like update,create or delete on the controller and if you also specify you would like to add the roo managed json annotation to the object, the json add roo she will command will ignore the disallowed operations and instead create all the crud operations.\nEx:\nentity --class ~.domain.PolicySignature \nfield string --fieldName policy\nfield string --fieldName signature\nfield string --fieldName awskeyid\ncontroller scaffold --class ~.web.PolicySignatureService --entity ~.domain.PolicySignature --disallowedOperations update,create,delete\njson add\nThen the resulting PolicySignatureService_Roo_Controller.aj file will have the correct html content type show and list requestmappings but if you set your content type to json you can bypass the restrictions and also put post and delete which I don&apos;t think should happen.\nAlso if you manually try to delete these disallowed operations the roo she will replaces them in the aspect J file. \nThis is what the aspect J file looks like, you&apos;ll notice you have many more operations with content type set to json than you do with the regular content type:\nprivileged aspect PolicySignatureService_Roo_Controller {\n    @RequestMapping(value = \"/\n{id}\", method = RequestMethod.GET)\n    /* ... */\n\n    @RequestMapping(method = RequestMethod.GET)\n    /* ... */\n\n    @ModelAttribute(\"policysignatures\")\n       /* ... */\n\n    @RequestMapping(value = \"/{id}\n\", method = RequestMethod.GET, headers = \"Accept=application/json\")\n    @ResponseBody\n       /* ... */\n    @RequestMapping(headers = \"Accept=application/json\")\n    @ResponseBody\n      /* ... */\n    @RequestMapping(method = RequestMethod.POST, headers = \"Accept=application/json\")\n       /* ... */\n    @RequestMapping(value = \"/jsonArray\", method = RequestMethod.POST, headers = \"Accept=application/json\")\n       /* ... */\n    @RequestMapping(method = RequestMethod.PUT, headers = \"Accept=application/json\")\n      /* ... */\n    @RequestMapping(value = \"/jsonArray\", method = RequestMethod.PUT, headers = \"Accept=application/json\")\n       /* ... */\n    @RequestMapping(value = \"/\n{id}\n\", method = RequestMethod.DELETE, headers = \"Accept=application/json\")\n       /* ... */\n}\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.scaffold.json.WebJsonMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2467, "bug_title": "*.jspx files not being updated when adding a field to the governor", "bug_description": "After running the following script the .jspx files are not update when adding (and then removing) a field to and from the governor. Upon restarting the Roo she will the files are updated.\n\n\n\n\n\n\nproject --topLevelPackage com.foo.empty\n\n\n\n\npersistence setup --provider HIBERNATE --database H2_IN_MEMORY \n\n\n\n\nentity --class ~.domain.Foo\n\n\n\n\ncontroller all --package ~.web\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspMetadataListener.java"], "label": 1, "es_results": []}, {"bug_id": 2508, "bug_title": "@Rooplural annotation prevents \"list all entity\" option from showing in the menu", "bug_description": "When a @Rooplural is added to an entity the \"list all entity\" option from the navigation menu of the app isn&apos;t displayed, that means that the corresponding item in menu.jspx for list the item isn&apos;t added. This seems to be a Roo issue since it happens with recently created projects where no configuration file was changed manually. \nIn the original thread on the forum I reported the issue for version 1.1.3 but recently I confirmed that the 1.1.4 version has the same problem. I don&apos;t know if the usage of @Rooplural was changed in recent versions but in the documentation I don&apos;t found anything. \nThanks for all, regards.", "project": "Spring", "sub_project": "ROO", "version": "1.1.3.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.classpath.customdata.taggers.MethodMatcher.java"], "label": 1, "es_results": []}, {"bug_id": 2449, "bug_title": "Add --scope to maven dependency command", "bug_description": "Add --scope to the options for the dependency add command for installing pom.xml dependencies, so you can install things like the Selenium Java Driver into the test scope only.  Should be optional, could have scopes of test, runtime, provided, compile (the default if none picked).", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.project.AbstractProjectOperations.java", "org.springframework.roo.project.ProjectOperations.java", "org.springframework.roo.project.MavenCommands.java"], "label": 1, "es_results": []}, {"bug_id": 2454, "bug_title": "Roo allows duplicate enum constants in an enumerated type", "bug_description": "Duplicate enum constants because a compile error and should not be allowed to proceed to be created in the Roo she will", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserClassOrInterfaceTypeDetails.java"], "label": 1, "es_results": []}, {"bug_id": 2456, "bug_title": "Finders not created for DBRE fields when any field exists in the governor", "bug_description": "Similar to the issue in ROO-2417, finder methods are not being created for dbre created fields if any field exists in the governor ", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.finder.FinderMetadata.java", "org.springframework.roo.addon.finder.FinderMetadataProviderImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2445, "bug_title": "GWT module's gwt.xml file not found; cannot continue", "bug_description": "The script\nproject --topLevelPackage foo --projectName foo\npersistence setup --provider DATANUCLEUS --database GOOGLE_APP_ENGINE \nentity --class ~.server.domain.Foo\nfield string foo\ngwt setup\nends with the message:\nGWT module&apos;s gwt.xml file not found; cannot continue\nI have tried spring-roo-1.1.4.RELEASE and spring-roo-1.1.4.BUILD-SNAPSHOT_20110517.005036-d4d95d4.\nWith spring-roo-1.1.3.RELEASE, it still worked.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.GwtPath.java", "org.springframework.roo.addon.gwt.GwtOperationsImpl.java", "org.springframework.roo.project.ProjectMetadata.java", "org.springframework.roo.addon.gwt.GwtType.java", "org.springframework.roo.addon.gwt.GwtMetadataProviderImpl.java", "org.springframework.roo.process.manager.internal.DefaultFileManager.java", "org.springframework.roo.addon.gwt.GwtTypeService.java", "org.springframework.roo.addon.gwt.GwtTypeServiceImpl.java", "org.springframework.roo.support.util.TemplateUtils.java", "org.springframework.roo.addon.gwt.GwtMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2459, "bug_title": "GWT Addon does not support multiple modules", "bug_description": "If a project has more than one GWT module file (i.e. ApplicationScaffold.gwt.xml and HelloWorld.gwt.xml), Roo fails to parse any of them.  Any entities created afterwards are ignored by the GWT Addon.  In Roo 1.1.4.RELEASE, the she will gives the message ...\n\"GWT module&apos;s gwt.xml file not found; cannot continue\"\nIn 1.1.4.SNAPSHOT, the she will currently fails to give any failure message.\nThis is unacceptable for many typical uses of Roo.  For instance, during development I create my own GWT Module for my application, but leave the ApplicationScaffold module around to help out with debugging during development.  I never deploy it to production, but it is certainly nice to have around!\nSee comments for a proposed patch.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.GwtTypeServiceImpl.java", "org.springframework.roo.addon.gwt.GwtTypeService.java", "org.springframework.roo.addon.gwt.GwtMetadataProviderImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2465, "bug_title": "DBRE only generates welcome page", "bug_description": "I have an existing Oracle DB and try the DBRE with Roo Version 1.1.3. It works!\nWith version 1.1.4 the command &apos;database reverse engineer --schema ... --includeNonPortableAttributes&apos; creates the domain model but the command\n&apos;controller all --package ~.web&apos; only creates the welcome page. The menu.jspx and the Web UI for the entities are missing.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspMetadataListener.java", "org.springframework.roo.addon.web.mvc.controller.converter.ConversionServiceMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2473, "bug_title": "Fields marked with --sizeMin do not always have \"required\" in prompt  ", "bug_description": "To replicate:\n\nRun clinic.roo\nGo to the \"Create new Owner\" page\nClick into the \"Email\" field; note that the prompt says \"Enter Email\"\nSubmit the form; the email field displays the error \"size must be between 6 and 30\"\n\nIf the form won&apos;t submit without an email addresses entered, then the prompt for that field should say \"Enter Email (required)\".\nThe workaround is to add a JPA @NotNull annotation to the relevant entity field; the MVC addon will then update the relevant JSPX files by adding required=\"true\" to that field. However @NotNull is a persistence-related annotation, not a validation/UI annotation. The presence of the JSR-303 @SizeMin annotation should be enough for the MVC addon to mark the field as required.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspViewManager.java"], "label": 1, "es_results": []}, {"bug_id": 2481, "bug_title": "Two unrelated classes synchronise on same Boolean constant", "bug_description": "These two classes use the same instance of the Boolean class (i.e. Boolean.TRUE) as their \"lock\" synchronisation field:\n\norg.springframework.roo.classpath.scanner.MemberDetailsScannerImpl\norg.springframework.roo.file.monitor.polling.PollingFileMonitorService\n\nThis inadvertent coupling of two unrelated classes could lead to unresponsiveness and possible deadlock.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.file.monitor.polling.PollingFileMonitorService.java", "org.springframework.roo.classpath.scanner.MemberDetailsScannerImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2483, "bug_title": "SolrUtils returns incorrect suffix for java.util.Calendar fields", "bug_description": "The intent of the following line in SolrUtils is clearly to return \"_dt\" for Calendar fields:\n\n\n\n\n\n\n} else if (type.equals(new JavaType(\"java.util.Date\")) || type.equals(\"java.util.Calendar\")) {\n\n\n\n\n\treturn \"_dt\";\n\n\n\n\n} else {\n\n\n\n\n\treturn \"_t\";\n\n\n\n\n}\n\n\n\n\n\n\nHowever because comparing the type (an instance of JavaType) to the literal String \"java.util.Calendar\" will never return true, any Calendar fields will fall through to the else clause and return \"_t\" instead of \"_dt\".", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.solr.SolrUtils.java"], "label": 1, "es_results": []}, {"bug_id": 2450, "bug_title": "tilesViewResolver bean missing in web flow creation", "bug_description": "After creating a new roo project and running &apos;web flow&apos;, I tried to deploy to tomcat but I receive the following Error:\nError creating bean with name &apos;mvcViewFactoryCreator&apos; defined in ServletContext resource [/WEB-INF/spring/webflow-config.xml]: Cannot resolve reference to bean &apos;tilesViewResolver&apos; while setting bean property &apos;viewResolvers&apos;; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named &apos;tilesViewResolver&apos; is defined", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspOperationsImpl.java", "org.springframework.roo.addon.web.flow.WebFlowOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2494, "bug_title": "Conversion service IT WOULD not updated when a previously deleted controller is created again", "bug_description": "After the @RooWebScaffold annotation is added back to a controller class again, the conversion service IT WOULD is not updated until the Roo she will is restarted.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.converter.ConversionServiceMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2496, "bug_title": "Do not allow creation of DataOnDemand class for abstract entities", "bug_description": "Related to https://jira.springsource.org/browse/ROO-321, you can define a DataOnDemand class that is based on an abstract entity.  This should not be allowed as it won&apos;t compile.\nExample:\n\n\n\n\n\n\nentity --class ~.model.Foo\n\n\n\n\ndod --entity ~.model.Foo\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2498, "bug_title": "Cannot remove fields. Missing flush() in org.springframework.roo.classpath.javaparser.JavaParserMutableClassOrInterfaceTypeDetails.removeField  ?", "bug_description": "I tried to remove a field from a class by calling removeField on MutableClassOrInterfaceTypeDetails.\nBut the field does not get deleted at all.\nMaybe the reason is a missing call to flush() in  JavaParserMutableClassOrInterfaceTypeDetails.removeField   ?", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserMutableClassOrInterfaceTypeDetails.java"], "label": 1, "es_results": []}, {"bug_id": 2505, "bug_title": "when use \"json add\",json controller have wrong inner variable name in for loop", "bug_description": "when user json add,web controller aj generated thatlook at the color red content. object name the same as the Class name.\n@RequestMapping(value = \"/jsonArray\", method = RequestMethod.PUT, headers = \"Accept=application/json\")\n    public ResponseEntity<String> TAdController.updateFromJsonArray(@RequestBody String json) {\n        HttpHeaders headers= new HttpHeaders();\n        headers.add(\"Content-Type\", \"application/text\");\n        for ( TAd TAd : TAd.fromJsonArrayToTAds(json)) {\n            if (TAd.merge() == null) \n{\n                return new ResponseEntity<String>(headers, HttpStatus.NOT_FOUND);\n            }\n        }\n        return new ResponseEntity<String>(headers, HttpStatus.OK);\n    }", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.scaffold.mvc.WebScaffoldMetadata.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.json.WebJsonMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2523, "bug_title": "Integration tests fail when column is unique and field length is greater than column length", "bug_description": "When a field, for example, is called \"registration\"  size restriction and unique constraints are placed on field, as like here:\n\n\n\n\n\n\n    @NotNull\n\n\n\n\n    @Column(unique = true)\n\n\n\n\n    @Size(min = 8, max = 8)\n\n\n\n\n    private String registration;\n\n\n\n\n\n\nunit tests will fail as the field initializer is truncated, but is not unique in all cases", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2528, "bug_title": "Two controllers over an entity error because same request mapping", "bug_description": "Creating more than one controller over the same entity causes startup errors because they are created with the same base request mapping name:\n @RequestMapping(\"/owners\")\nTo reproduce, execute next command after clinic.roo script:\n web mvc scaffold --class ~.web.OtherOwnerController --backingType ~.domain.Owner\nOn startup:\n\n\n\n\n\n\n2011-06-27 11:03:09,850 [main] ERROR org.springframework.web.servlet.DispatcherServlet - Context initialization failed\n\n\n\n\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping#0&apos;: Initialization of bean failed; nested exception is java.lang.IllegalStateException: Cannot map handler &apos;ownerController&apos; to URL path [/owners/{id}]: There is already handler of type [class com.springsource.petclinic.web.OtherOwnerController] mapped.\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.ControllerOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2534, "bug_title": "The default @DateTimeFormat with  \"S-\" has MM/dd/yy pattern leading to a bug like Y2K", "bug_description": "as stated from java docs the \"S-\" patter corresponds to something like MM/dd/yy for I think all locales.\nthis combined with the generated widget constructed with the same pattern lead to a Y2K like bug.\ninserting 01/01/1911 will be displayed correctly on the widget but posted as 01/01/11 and translated as 01/01/2011 on the server.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.classpath.operations.FieldCommands.java", "org.springframework.roo.addon.entity.IdentifierMetadata.java", "org.springframework.roo.addon.web.mvc.controller.details.WebMetadataServiceImpl.java", "org.springframework.roo.addon.dbre.DbreMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2539, "bug_title": "DataOnDemand attempts to create identifier class by creating non-existent mutator methods instead of using parmeterized constructor", "bug_description": "It appears the composite key support offered in DoD does not correctly create the identifier class instance. The identifier class does not (and should not) provide public mutators for its fields however DoD is creating code that calls these (non-existent) methods. It should call the constructor instead.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2550, "bug_title": "@mvc controller with custom mapping", "bug_description": "Hi,\nBasically, the issue is that an extra / is shown in the documentation for web mvc controller.\nRoo documentation for web mvc controller shows: optional --preferredMapping: Indicates a specific request mapping path for this controller (eg /foo/); no default value\nWhen creating a custom controller web mvc controller --class ~.admin.LoginController --preferredMapping /admin/login/ (notice the mapping ends with a slash, just as in the documentation), Roo generates double slashes in various places, such as in the controller, *.tagx and views.xml files. Example:\n\n\n\n\n\n\n    @RequestMapping\n\n\n\n\n    public String index() {\n\n\n\n\n        return \"admin/login//index\";\n\n\n\n\n    }\n\n\n\n\n}}\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2553, "bug_title": "Switching persistence providers from a GAE-based app to a normal JPA app does not clean up special provisions in JavaBean artifacts", "bug_description": "Switching persistence providers from a GAE-based app to a normal JPA app does not clean up special provisions in JavaBean artifacts.\nTo replicate, create a simple app with GAE/DN persistence and an entity then invoke the peristence setup command and use EclipseLink/HSQL and attempt to compile the app.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.javabean.JavaBeanMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2556, "bug_title": "Calendar fields need to use java.util.Date for Solr indexing", "bug_description": "For indexing purposes the .getTime() method should be called on Calendar field types.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.solr.SolrMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2560, "bug_title": "[DataNucleus] Introduced findXxx(id) method throws EmptyResultDataAccessException instead of returning null when no data is found", "bug_description": "The following script:\n\n\n\n\n\n\ndomain.roo\n\n\n\n\n\n\npersistence setup --provider DATANUCLEUS --database GOOGLE_APP_ENGINE --applicationId myapp\n\n\n\n\nentity --class ~.server.domain.DomainObject --testAutomatically\n\n\n\n\nfield string --fieldName displayName --notNull\n\n\n\n\nweb gwt setup\n\n\n\n\n\n\nwill generate this \"find by ID\" method:\n\n\n\n\n\n\nDomainObject_Roo_Entity.aj\n\n\n\n\n\n\n@Transactional\n\n\n\n\npublic static DomainObject DomainObject.findDomainObject(Long id) {\n\n\n\n\n    if (id == null) return null;\n\n\n\n\n    try {\n\n\n\n\n        return (DomainObject) entityManager().createQuery(\"SELECT o FROM DomainObject o WHERE o.id = :id\").setParameter(\"id\", id).getSingleResult();\n\n\n\n\n    } catch (javax.persistence.NoResultException e) {\n\n\n\n\n        return null;\n\n\n\n\n    } \n\n\n\n\n}\n\n\n\n\n\n\nIf no row exists with that ID, JpaExceptionTranslatorAspect kicks in and translates the resulting javax.persistence.NoResultException into an org.springframework.dao.EmptyResultDataAccessException before it can be caught in the catch block, meaning that the finder throws the latter exception instead of returning null in that scenario.\nAs evidence of this bug, the generated DomainObjectIntegrationTest.testRemove() method fails with an org.springframework.dao.EmptyResultDataAccessException (thrown from the final assert statement).", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.entity.EntityMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2562, "bug_title": "Stock ticker chart does not appear", "bug_description": "If you run this script:\n\n\n\n\n\n\nscript clinic.roo\n\n\n\n\nweb mvc embed finances --stockSymbol VMW\n\n\n\n\n\n\n... then the URL http://localhost:8080/petclinic/embed/finances displays an empty collapsible pane where the VMware stock price chart (shown here in non-embedded form) should be.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.embedded.provider.FinanceEmbeddedProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2570, "bug_title": "recursiveAntMatch recurses on non-files not on directories", "bug_description": "The issues was discovered when running the expenses script fro a directory in the root of a Windows drive e.g. \"C:\\expenses-test\". Execution of the script failed due to \"C:\\log.roo\" not being able to be found despite it not being in the project&apos;s root directory.", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.file.monitor.polling.PollingFileMonitorService.java"], "label": 1, "es_results": []}, {"bug_id": 2588, "bug_title": "TypeLocationService does not detect types with annotations in project due to eager caching", "bug_description": "TypeLocationService.processTypesWithAnnotation() uses caching based on !fileMonitorService.isDirty(); (line 140 & 162). This leads to skipping of newly written types with the given annotation. I think this is because the file monitor service scans the file system once every 1000ms and if a Roo service invokes MemberFindingUtils.getAnnotationOfType(..) within that timespan it will not see the type because the fileMonitorService is not marked as dirty yet. Assigning to Alan to verify.\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.classpath.TypeLocationServiceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2585, "bug_title": "'web mvc all' seems to have broken availability check", "bug_description": "I just noticed when doing a &apos;help&apos; that &apos;controller all&apos; has been deprecated in favor of &apos;web mvc all&apos;. However, when trying that command on a project that has persistency set up and an entity defined I&apos;m getting an error message stating that the command is not currently available. &apos;controller all&apos; works though, so it seems like there&apos;s a broken availability check for the new spring mvc version of the command. ", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.classpath.operations.HintConverter.java", "org.springframework.roo.classpath.operations.HintCommands.java", "org.springframework.roo.classpath.operations.HintOperations.java", "org.springframework.roo.addon.web.mvc.controller.ControllerCommands.java"], "label": 1, "es_results": []}, {"bug_id": 2517, "bug_title": "GWT and test addons do not support \"id\" domain suffix (i.e. Indonesia)", "bug_description": "If you create a project as follows:\n\n\n\n\n\n\nproject --topLevelPackage id.foo\n\n\n\n\npersistence setup --database HYPERSONIC_IN_MEMORY --provider HIBERNATE\n\n\n\n\nentity --class ~.domain.Pizza\n\n\n\n\nfield string --fieldName name\n\n\n\n\ngwt setup\n\n\n\n\n\n\n... the following Java file is generated:\n\n\n\n\n\n\nsrc/main/java/id/foo/client/managed/ui/PizzaDetailsView_Roo_Gwt.java\n\n\n\n\n\n\n// WARNING: DO NOT EDIT THIS FILE. THIS FILE IS MANAGED BY SPRING ROO.\n\n\n\n\n\n\n\n\n\npackage id.co.foo.client.managed.ui;\n\n\n\n\n\n\n\n\n\nimport com.google.gwt.core.client.GWT;\n\n\n\n\nimport com.google.gwt.dom.client.SpanElement;\n\n\n\n\nimport com.google.gwt.event.dom.client.ClickEvent;\n\n\n\n\nimport com.google.gwt.event.dom.client.HasClickHandlers;\n\n\n\n\nimport com.google.gwt.i18n.client.DateTimeFormat;\n\n\n\n\nimport com.google.gwt.i18n.client.NumberFormat;\n\n\n\n\nimport com.google.gwt.uibinder.client.UiBinder;\n\n\n\n\nimport com.google.gwt.uibinder.client.UiField;\n\n\n\n\nimport com.google.gwt.uibinder.client.UiHandler;\n\n\n\n\nimport com.google.gwt.user.client.Window;\n\n\n\n\nimport com.google.gwt.user.client.ui.Composite;\n\n\n\n\nimport com.google.gwt.user.client.ui.HTMLPanel;\n\n\n\n\nimport com.google.gwt.user.client.ui.Widget;\n\n\n\n\nimport id.co.foo.client.managed.request.PizzaProxy;\n\n\n\n\nimport id.co.foo.client.scaffold.place.ProxyDetailsView;\n\n\n\n\nimport id.co.foo.client.scaffold.place.ProxyListView;\n\n\n\n\n\n\n\n\n\npublic abstract class PizzaDetailsView_Roo_Gwt extends Composite implements ProxyDetailsView<PizzaProxy> {\n\n\n\n\n\n\n\n\n\n    @UiField\n\n\n\n\n    SpanElement id;\n\n\n\n\n\n\n\n\n\n    @UiField\n\n\n\n\n    SpanElement version;\n\n\n\n\n\n\n\n\n\n    @UiField\n\n\n\n\n    SpanElement name;\n\n\n\n\n\n\n\n\n\n    PizzaProxy proxy;\n\n\n\n\n\n\n\n\n\n    @UiField\n\n\n\n\n    SpanElement displayRenderer;\n\n\n\n\n\n\n\n\n\n    public void setValue(PizzaProxy proxy) {\n\n\n\n\n        this.proxy = proxy;\n\n\n\n\n        id.setInnerText(proxy.getId() == null ? \"\" : String.valueOf(proxy.getId()));\n\n\n\n\n        version.setInnerText(proxy.getVersion() == null ? \"\" : String.valueOf(proxy.getVersion()));\n\n\n\n\n        name.setInnerText(proxy.getName() == null ? \"\" : String.valueOf(proxy.getName()));\n\n\n\n\n        displayRenderer.setInnerText(id.co.foo.client.managed.ui.PizzaProxyRenderer.instance().render(proxy));\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\n... in which the following line doesn&apos;t compile, because the \"id\" root package clashes with the IT WOULD&apos;s \"id\" SpanElement field:\n\n\n\n\n\n\ndisplayRenderer.setInnerText(id.co.foo.client.managed.ui.PizzaProxyRenderer.instance().render(proxy));\n\n\n\n\n\n\nThe workaround is to cut-and-paste the setValue method into the target Java class (in this example, PizzaDetailsView.java) and remove the package name as follows:\n\n\n\n\n\n\nPizzaDetailsView.java\n\n\n\n\n\n\ndisplayRenderer.setInnerText(PizzaProxyRenderer.instance().render(proxy));\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.4.RELEASE", "fixed_version": "1.1.5.RELEASE", "fixed_files": ["org.springframework.roo.addon.test.IntegrationTestMetadata.java", "org.springframework.roo.addon.gwt.GwtTemplateServiceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2587, "bug_title": "dbre.xml not inserted into maven-war-plugin as an exclusion when a database reverse engineered", "bug_description": "A copy and paste error since 1.1.4 prevents the dbre.xml resource from being added to the maven-war-plugin as an exclusion.", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.dbre.DbreOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2594, "bug_title": "Inner type field annotations are not written out to ITDs", "bug_description": "Unlike the annotations of inner-type methods, field annotations are not written out.", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.classpath.itd.ItdSourceFileComposer.java"], "label": 1, "es_results": []}, {"bug_id": 2604, "bug_title": "DbreMetadata ignores cascade attributes in dbre.xml", "bug_description": "Though the onUpdate and onDelete cascade attributes obtained from the database metadata are written to the dbre.xml file, the values are not used to create CascadeType attributes in entity relationships", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.addon.dbre.DbreMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2606, "bug_title": "Reverse engineering issue. Generated AJ source file includes the following definition: @Temporal(TemporalType.DATETIME)", "bug_description": "Hi\nI&apos;ve executed the roo database reverse engineering command using the --includeNonPortableAttributes switch on a MSSQL server 2008 R2 database. The dbre.xml file generated by the reverse engineering operation contains the following table definition:\n<table name=\"DAILY_MARKET\">\n  <column name=\"DM_DATE\" primaryKey=\"true\" required=\"true\" scale=\"3\" size=\"23\" type=\"93,datetime\"/>\n  <column name=\"DM_S_SYMB\" primaryKey=\"true\" required=\"true\" scale=\"0\" size=\"15\" type=\"1,char\"/>\n  ...\n</table>\nThe DDL used for generating the table looks like this:\nCREATE TABLE [dbo].[DAILY_MARKET](\n[DM_DATE] [datetime] NOT NULL,\n[DM_S_SYMB] [char](15) NOT NULL,\n...\nThe DailyMarketPK_Roo_Identifier.aj source file generated by roo contains the folloing java code snippet:\nprivileged aspect DailyMarketPK_Roo_Identifier {\n    declare @type: DailyMarketPK: @Embeddable;\n    @Column(name = \"DM_DATE\", columnDefinition = \"datetime\", nullable = false)\n    @Temporal(TemporalType.DATETIME)\n    @DateTimeFormat(style = \"S-\")\n    private Date DailyMarketPK.dmDate;\nThe AJC compiler then complains about the statement @Temporal(TemporalType.DATETIME) since the JPA enum TemporalType does not contain the DATETIME element but only the DATE, TIME and TIMESTAMP elements.\nI&apos;m not sure about the priority of this issue, so please adjust according to your normal conventions.\nBest regards\nJorgen", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.addon.entity.IdentifierMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2584, "bug_title": "Arrow keys stop working under Windows 7 with Roo 1.1.5", "bug_description": "I just tried to create a new project using Roo 1.1.5 and noticed that the arrow keys no longer work in the command line she will on my Windows 7 laptop. Haven&apos;t checked the sources to see what has changed (JLine, Roo she will code), but it&apos;s very annoying. Same thing for the home and end key and the page up/down, BY THE WAY. Under Roo 1.1.4 this problem didn&apos;t exist. ", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.shell.jline.JLineShell.java"], "label": 1, "es_results": []}, {"bug_id": 2615, "bug_title": "Compile error in generated test classes - missing import of BigDecimal in *DataOnDemand.aj aspect", "bug_description": "Hi\nI used Roo to build a web app based on the reverse engineering of a SQL Server 2008 R2 database. The reverse engineering command included the --testAutomatically switch in order to auto generate the associated test classes. \nThe auto generated test code however contains the following compile error:\nerror at CompanyCompetitorPK embeddedIdClass = new CompanyCompetitorPK(BigDecimal.valueOf(index), BigDecimal.valueOf(index), \"c\" + index);                                                            ^\nC:\\Development\\Projects\\Roo\\TCPEx3-hibernate\\src\\test\\java\\org\\tpc\\tpce\\hibernate\\domain\\CompanyCompetitorDataOnDemand_Roo_DataOnDemand.aj:46:0::0 BigDecimal cannot be resolved\nThe auto generated code simply forgets to import the BigDecimal class.\nThe SQL Server database table used for building the CompanyCompetitor entity is defined as follows:\nCREATE TABLE [dbo].[COMPANY_COMPETITOR](\n[CP_CO_ID] [numeric](11, 0) NOT NULL,\n[CP_COMP_CO_ID] [numeric](11, 0) NOT NULL,\n[CP_IN_ID] [char](2) NOT NULL,\nPRIMARY KEY CLUSTERED \n(\n[CP_CO_ID] ASC,\n[CP_COMP_CO_ID] ASC,\n[CP_IN_ID] ASC\n)\nI have attached the Roo project including the offending CompanyCompetitorDataOnDemand_Roo_DataOnDemand.aj file.\nBest regards\nJorgen Fastrup", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2619, "bug_title": "Database reverse engineer a table with a boolean field and property generated incorrectly", "bug_description": "If I reverse engineer the following table:\n\n\n\n\n\n\nCREATE TABLE app_user\n\n\n\n\n(\n\n\n\n\n  id bigint NOT NULL,\n\n\n\n\n  account_expired boolean NOT NULL,\n\n\n\n\n  -- ...\n\n\n\n\n)\n\n\n\n\n\n\nthen the following property code is generated for account_expired:\n\n\n\n\n\n\n \n\n\n\n\n    public Boolean AppUser.getAccountExpired() {\n\n\n\n\n        return this.accountExpired;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    public boolean AppUser.isAccountExpired() {\n\n\n\n\n        return this.accountExpired != null && this.accountExpired;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    public void AppUser.setAccountExpired(Boolean accountExpired) {\n\n\n\n\n        this.accountExpired = accountExpired;\n\n\n\n\n    }\n\n\n\n\n\n\nUnfortunately this causes problems when creating or editing an AppUser in the webapp (after generating a web tier with \"controller all --package ~.web\") - Spring MVC&apos;s doBind method picks up the boolean \"is\" method and decides that the property is read-only as there is no matching set(boolean) method. This means that you can&apos;t set accountExpired from the web tier.\nThe fix for me is simple - remove the code:\n\n\n\n\n\n\n\t\t// Add boolean accessor for Boolean object fields\n\n\n\n\n\t\tif (field.getFieldType().equals(JavaType.BOOLEAN_OBJECT) && !hasBooleanPrimitiveAccessor(field)) {\n\n\n\n\n\t\t\tbuilder.addMethod(getBooleanPrimitiveAccessor(field));\n\n\n\n\n\t\t}\n\n\n\n\n\n\nwhich I believe is redundant. Any reason why this code is there?\nPatch attached.", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.addon.dbre.DbreMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2612, "bug_title": "Entity .merge() method should be generified to accomodate inheritance", "bug_description": "In the clinic.roo example, the Owner and Vet entities inherit their merge() methods from the AbstractPerson superclass. However, since that method is not generifed, it actually returns an AbstractPerson rather than an Owner or Vet, meaning that the following code will not compile:\n\n\n\n\n\n\nOwner updatedOwner = owner.merge();\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.addon.entity.EntityMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2610, "bug_title": "Corrupt characters appearing in Roo she will in OS X Lion 10.7", "bug_description": "Since changing to OS X Lion, the Roo she will is displaying extraneous characters", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.shell.jline.JLineShell.java"], "label": 1, "es_results": []}, {"bug_id": 2603, "bug_title": "Sets and Integers not appearing in some views.", "bug_description": "This is a follow-up to the forum thread:\nhttp://forum.springsource.org/showthread.php?112415-Sets-not-appearing-in-quot-show-quot-views.&p=373337#post373337\nThe following examples refer to the attached domain objects and fields.\nRegarding the fact that some Integers are not displayed: For example a Practice&apos;s\nformalityLevel,\nqualityLevel,\nspeedLevel,\nvalueLevel,\nperceptionLevel and\noutcomeProductionDirectness\nare not displayed on the Practices&apos; list.\nRegarding the fact that some Sets are not displayed: For example a Risk&apos;s Set<OutcomeSufficiency> is correctly displayed on the Risk&apos;s \"list\" view, but not on its \"show\" view.", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspViewManager.java"], "label": 1, "es_results": []}, {"bug_id": 2664, "bug_title": "GwtOperationsImpl not forcing found types to be evicted from the cache prior to retrieval", "bug_description": "As part of running \"gwt setup\" all types are re-requested to ensure that the gwt-addon has a chance to react to the types in the system. To make sure a notify is performed and a cached type isn&apos;t returned the requested type needs to be explicitly evicted from the cache when retrieving it. This explicit eviction isn&apos;t currently being performed.", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.addon.gwt.GwtOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2689, "bug_title": "javax.persistence.TemporalType should only be applied to java.util.Date and java.util.Calendar fields", "bug_description": "Hibernate and EclipseLink report an error if the TemporalType annotation is applied to java.sql.Timestamp fields. The javadocs for the annotation say that Date and Calendar are supported, which is backed up by the messages generated by Hibernate.", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.classpath.operations.FieldCommands.java"], "label": 1, "es_results": []}, {"bug_id": 2701, "bug_title": "MavenProjectMetadataProvider's plugin removal methods use inappropriate criteria", "bug_description": "A plugin&apos;s core identity is its groupId and artifactId. For example, when people talk about the JUnit plugin, they mean groupId = \"org.apache.maven.plugins\" and artifactId = \"maven-surefire-plugin\". In addition to this core identity, a POM using this plugin will usually specify the plugin&apos;s version, and possibly other details such as configuration and executions.\nThere are two methods in MavenProjectMetadataProvider for removing plugins from the generated project&apos;s POM; both of which have problems:\n\n#removeBuildPlugins(List<Plugin>) matches on artifactId and version, i.e. ignores groupId. This means that some unrelated plugin could be accidentally removed if it happened to share its artifactId and version with one that was intended to be removed.\n#removeBuildPlugin(Plugin) will remove any plugins that are \"equal\" to the given one, according to the result of calling Plugin#equals(), which correctly checks groupId and artifactId but wrongly checks version and (if it exists in both Plugins) the configuration. So to remove a plugin using this method, you have to provide a Plugin instance that exactly matches the one in the POM, right down to the details of its configuration.\n\nBased on how these methods are currently used, they should both be changed to remove any plugins that match the groupId and artifactId of the given one(s).", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.project.Resource.java", "org.springframework.roo.addon.gwt.GwtOperationsImpl.java", "org.springframework.roo.support.util.CollectionUtils.java", "org.springframework.roo.project.ProjectMetadata.java", "org.springframework.roo.addon.web.mvc.jsp.menu.MenuOperationsImpl.java", "org.springframework.roo.project.Dependency.java", "org.springframework.roo.project.MavenProjectMetadataProvider.java", "org.springframework.roo.addon.jpa.JpaOperationsImpl.java", "org.springframework.roo.project.Execution.java", "org.springframework.roo.shell.jline.JLineShell.java", "org.springframework.roo.project.ProjectMetadataProvider.java", "org.springframework.roo.project.Plugin.java", "org.springframework.roo.support.util.XmlUtils.java", "org.springframework.roo.project.AbstractProjectOperations.java", "org.springframework.roo.shell.jline.osgi.JLineShellComponent.java"], "label": 1, "es_results": []}, {"bug_id": 2690, "bug_title": "Same POM dependency can be added twice with different versions ", "bug_description": "One way to replicate this bug is as follows:\n\nIn Roo 1.1.5, run the clinic.roo script\nRoo emits this output (in part):\n\n\n\n\n\n\nUpdated ROOT/pom.xml [added dependencies org.hibernate:hibernate-core:3.6.4.Final, org.hibernate:hibernate-entitymanager:3.6.4.Final, org.hibernate.javax.persistence:hibernate-jpa-2.0-api:1.0.0.Final]\n\n\n\n\n\n\nQuit Roo 1.1.5 and run the latest snapshot build\nRerun the persistence command used by clinic.roo, i.e. persistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY\nRoo emits this output:\n\n\n\n\n\n\nUpdated ROOT/pom.xml [added dependencies org.hibernate:hibernate-core:3.6.7.Final, org.hibernate:hibernate-entitymanager:3.6.7.Final, org.hibernate.javax.persistence:hibernate-jpa-2.0-api:1.0.1.Final]\n\n\n\n\n\n\n... and sure enough, each of the following artifacts appears twice in the POM, with different version numbers as shown:\n\n\norg.hibernate:hibernate-core: 3.6.4.Final and 3.6.7.Final\norg.hibernate:hibernate-entitymanager: 3.6.4.Final and 3.6.7.Final\norg.hibernate.javax.persistence:hibernate-jpa-2.0-api: 1.0.0.Final and 1.0.1.Final\n\nObviously it&apos;s bad practice to have the same dependency twice with different versions. Maven will actually use the first occurrence of each dependency in the POM, so in the above case at least, Maven will quietly ignore the newer versions of those artifacts.\nThe bug is due to the fact that:\n\no.s.r.project.ProjectOperations.addDependencies(List<Dependency>) uses the Dependency#equals method (via Set#contains) to check for the existence of a given dependency, and\nDependency#equals checks the dependency&apos;s version field (i.e. two versions of the same artifact are not \"equal\")\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.project.Dependency.java", "org.springframework.roo.project.ProjectMetadata.java", "org.springframework.roo.project.MavenProjectMetadataProvider.java", "org.springframework.roo.project.DependencyType.java", "org.springframework.roo.support.util.XmlUtils.java", "org.springframework.roo.project.DependencyScope.java"], "label": 1, "es_results": []}, {"bug_id": 2704, "bug_title": "ConversionServiceMetadata cannot handle multiple backing types with the same type name but different packages", "bug_description": "If two types exist with same type name but different packages, e.g. com.foo.bar.Test and com.bar.foo.Test, ConversionServiceMetatadata creates methods with the same name and tries to add it to the IT WOULD builder which leads to an exception. This issue can be verified by running Roo with the BrokerSystem project.", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.converter.ConversionServiceMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2726, "bug_title": "DataOnDemand does not honour column constraints for constructing data for embedded identifier types", "bug_description": "If fields of a composite primary key contain column lengths or @Size constraints, the embedded identifier constructor must be passed data that will honour these constraints. Currently tests fail where a column length is smaller than the data passed into the constructor", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2733, "bug_title": "GWT application that previously ran on Google App Engine does not run when persistence switched back to SQL database", "bug_description": "Run expenses.roo and switch persistence to GAE. Also run web gwt gae update. App runs OK in GAE, however, when persistence is changed back Hibernate and H2 for example, the app does not run with mvn gwt:run. The gwt-maven-plugin is not updated back to GWT version and a compile error\n\n\n\n\n\n\nexpenses/src/main/java/org/springsource/roo/extrack/client/scaffold/gae/GaeHelper.java:16:0::0 The constructor GaeLoginWidgetDriver(ApplicationRequestFactory) is undefined\n\n\n\n\n\n\nIf the intended behaviour is that there is no way back from GAE, then close off as won&apos;t fix ", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.addon.gwt.GwtCommands.java"], "label": 1, "es_results": []}, {"bug_id": 2747, "bug_title": "UnsupportedOperationException adding items to AbstractMemberHoldingTypeDetailsBuilder if unmodifiable list previously set", "bug_description": "Found this by code inspection rather than at runtime, so it may not be causing any problems at the moment.\nSee the new test case AbstractMemberHoldingTypeDetailsBuilderTest for the various failure scenarios. In short, an UnsupportedOperationException is thrown upon this sequence of calls:\n\n\n\n\n\n\nAbstractMemberHoldingTypeDetailsBuilder builder = ...; // get a concrete instance\n\n\n\n\nList foos = ....; // get an unmodifiable list of Foos to add, e.g. via Collections#singletonList\n\n\n\n\nbuilder.setFoos(foos);\n\n\n\n\nFoo anotherFoo = ...;\n\n\n\n\nbuilder.addFoo(anotherFoo); // !!! throws an UnsupportedOperationException\n\n\n\n\n\n\nThis bug happens because of poor encapsulation within AbstractMemberHoldingTypeDetailsBuilder, in that lists passed to setters are stored internally rather than being defensively copied. Therefore when you set an unmodifiable list, it can&apos;t be modified later by calling the relevant \"add\" method.", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.M1", "fixed_files": ["org.springframework.roo.classpath.details.FieldMetadataBuilder.java", "org.springframework.roo.classpath.details.AbstractIdentifiableJavaStructureBuilder.java", "org.springframework.roo.classpath.details.ConstructorMetadataBuilder.java", "org.springframework.roo.classpath.details.AbstractMemberHoldingTypeDetailsBuilder.java", "org.springframework.roo.classpath.details.InitializerMetadataBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 2772, "bug_title": "Cannot rename DBRE fields", "bug_description": "After reverse eng. I push-in a field in \"DbManaged.aj\" to \"Entity.java\" and when I rename the pushed-in field, it is created again in \"DbManaged.aj\"\nTo reproduce:\n\nCreate test DB. Attached .sql to create it\nRun attached .roo script\nGo to Areagroups_Roo_DbManaged.aj and push-in field \"areass\"\nGo to Areagroups.java and rename \"areass\" to \"areas\"\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.dbre.DbreMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2788, "bug_title": "Roo failed on entity name \"News\"", "bug_description": "\nproject --topLevelPackage com.aveas.test\npersistence setup --provider HIBERNATE --database HYPERSONIC_PERSISTENT\nentity --class ~.domain.News\nfield string --fieldName name\nweb mvc setup\nweb mvc all --package ~.web\nApplication generated by this script take error on create attempting with message \"argument type mismatch\".\nIn fact, problem detected only with entity name \"News\".", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.details.WebMetadataServiceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2930, "bug_title": "\"web mvc setup\" adds reference to non existing menu.jspx", "bug_description": "When command \"web mvc setup\" executed the \"WEB-INF/layouts/layouts.xml\" file is created with a reference to a non existing file \"/WEB-INF/views/menu.jspx\".", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2702, "bug_title": "DoD not updating on changes to related DoD", "bug_description": "If an entity, the owning entity, has a relationship with another entity, the owned entity) when the owned entity&apos;s DoD is updated or comes into existence sometimes the owning entity&apos;s DoD needs to be updated. This is currently not happening in all circumstances and requires a she will restart for the owning entity&apos;s DoD to be updated to reflect the change or creation of the owned entity&apos;s DoD.", "project": "Spring", "sub_project": "ROO", "version": "1.1.5.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadataProviderImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2754, "bug_title": "Unable to download add-ons with the addon install command", "bug_description": "Due to change which closes an input stream prematurely in org.springframework.roo.felix.HttpPgpUrlStreamHandlerServiceImpl, add-ons including jdbc drivers for DBRE, are prevented from being downloaded when the addon install command is run", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.felix.pgp.PgpServiceImpl.java", "org.springframework.roo.felix.HttpPgpUrlStreamHandlerServiceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2786, "bug_title": "JavaBean IT WOULD not deleted when governor fields have been deleted", "bug_description": "Since 1.2.0.M1, the Roo JavaBean IT WOULD is not deleted after deleting all the fields in the governor, even after a she will restart.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.classpath.itd.AbstractItdMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2789, "bug_title": "Push-in refactor of the Mongo Id field does not remove the getter and setter methods from the Mongo IT WOULD", "bug_description": "When the org.springframework.data.annotation.Id field is created in the governor, the accessor/mutator methods are created in the JavaBean IT WOULD, but not removed from the Mongo IT WOULD", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.layers.repository.mongo.MongoEntityMetadata.java", "org.springframework.roo.addon.layers.repository.mongo.MongoEntityMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2792, "bug_title": "Push-in refactor of the @Repository annotation does not remove the same annotation from the Mongo Repository IT WOULD", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.layers.repository.mongo.RepositoryMongoMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2794, "bug_title": "Empty file - 'compilation unit' - genarates an apparent error message", "bug_description": "If you have an empty java file (or a file with the contents commented out) then ROO reports the following\n.    java.lang.IllegalArgumentException: Compilation unit contents required\nAND appears NOT to go on to parse the other files (well - no \"updated\" messages are produced).  This is NOT the case with 1.1.5. which was happy with empty &apos;compilation units&apos; as is the SUN 1.6.26 compiler. ", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.gwt.request.GwtRequestMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.locator.GwtLocatorMetadataProviderImpl.java", "org.springframework.roo.classpath.javaparser.JavaParserTypeParsingService.java", "org.springframework.roo.addon.gwt.scaffold.GwtScaffoldMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.proxy.GwtProxyMetadataProviderImpl.java", "org.springframework.roo.addon.javabean.JavaBeanMetadataProvider.java", "org.springframework.roo.addon.tostring.ToStringMetadata.java", "org.springframework.roo.addon.tostring.ToStringMetadataProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2816, "bug_title": "Some views show the text \"WEB-INF/views/foo/bar.jspx\" instead of that JSP's contents", "bug_description": "Found this while investigating ROO-2793. The views generated by the following commands show the text \"WEB-INF/views/foo/bar.jspx\" instead of that JSP&apos;s contents:\n\ncontroller class\nweb mvc embed\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.solr.SolrJspMetadataListener.java", "org.springframework.roo.addon.web.mvc.jsp.JspOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2819, "bug_title": "Tiles view definitions not deleted when create or update are disabled in controller", "bug_description": "Found this while investigating ROO-2806. To replicate:\n\nGenerate a project with an MVC layer (e.g. run \"script vote.roo\")\nEdit an entity controller&apos;s @RooWebScaffold annotation to contain \"create = false\" and \"update = false\"\nRoo does not remove the corresponding view definitions from the entity&apos;s views.xml file\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.menu.MenuOperations.java", "org.springframework.roo.addon.solr.SolrJspMetadataListener.java", "org.springframework.roo.support.util.StringUtilsTest.java", "org.springframework.roo.support.util.StringUtils.java", "org.springframework.roo.addon.web.mvc.jsp.tiles.TilesOperations.java", "org.springframework.roo.addon.web.mvc.jsp.JspOperationsImpl.java", "org.springframework.roo.addon.web.mvc.jsp.tiles.TilesOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2806, "bug_title": "\"controller class\" command uses incorrect view name when \"preferredMapping\" contains uppercase characters", "bug_description": "To replicate, run the \"controller class\" command with the \"preferredMapping\" option in mixed case, for example:  \n\n\n\n\n\n\ncontroller class --class ~.web.Hello --preferredMapping helloApp\n\n\n\n\n\n\n1. The view name returned by the controller:\n\n\n\n\n\n\nHello.java\n\n\n\n\n\n\n@RequestMapping\n\n\n\n\npublic String index() {\n\n\n\n\n    return \"helloApp/index\"; // this view name is in mixed case\n\n\n\n\n}\n\n\n\n\n\n\n... does not match the view name in the Tiles views.xml file:\n\n\n\n\n\n\nsrc/main/webapp/WEB-INF/views/helloapp/views.xml\n\n\n\n\n\n\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n\n\n\n\n<!DOCTYPE tiles-definitions PUBLIC \"-//Apache Software Foundation//DTD Tiles Configuration 2.1//EN\" \"http://tiles.apache.org/dtds/tiles-config_2_1.dtd\">\n\n\n\n\n<tiles-definitions>\n\n\n\n\n    <!-- This \"name\" attribute should also be in mixed case -->\n\n\n\n\n    <definition extends=\"default\" name=\"camelcase/index\">\n\n\n\n\n        <!-- The case of this filename only needs to match the file system -->\n\n\n\n\n        <put-attribute name=\"body\" value=\"/WEB-INF/views/camelcase/index.jspx\"/>\n\n\n\n\n    </definition>\n\n\n\n\n</tiles-definitions>\n\n\n\n\n\n\n2. Also, the relative URL in the relevant menu item is in lowercase instead of mixed case:\n\n\n\n\n\n\nsrc/main/webapp/WEB-INF/views/menu.jspx\n\n\n\n\n\n\n<menu:menu id=\"_menu\" z=\"nZaf43BjUg1iM0v70HJVEsXDopc=\">\n\n\n\n\n    <menu:category id=\"c_controller\" z=\"nj8Dm3hojIyIEyPkwE1UMDIs+K8=\">\n\n\n\n\n        <!-- The \"url\" attribute should be in mixed case -->\n\n\n\n\n        <menu:item id=\"i_controller__helloappindex_id\" messageCode=\"global_generic\" url=\"/helloapp/index\" z=\"vDuzy0/jMEErpBRrv8fulF3ZUEw=\"/>\n\n\n\n\n    </menu:category>\n\n\n\n\n</menu:menu>\n\n\n\n\n\n\nThe workaround is to fix the above problems manually.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspOperationsImpl.java", "org.springframework.roo.support.util.StringUtilsTest.java", "org.springframework.roo.addon.web.mvc.jsp.tiles.TilesOperations.java", "org.springframework.roo.addon.web.mvc.jsp.tiles.TilesOperationsImpl.java", "org.springframework.roo.support.util.StringUtils.java"], "label": 1, "es_results": []}, {"bug_id": 2840, "bug_title": "Integration test IT WOULD not updated when entity's plural changes", "bug_description": "To replicate:\n\nRun the vote.roo script\nUsing a text editor or IDE, add the class-level annotation @RooPlural(\"Things\") to Vote.java; Roo correctly updates these files:\n\n\n\n\n\n\nUpdated SRC_MAIN_JAVA/com/springsource/vote/web/VoteController_Roo_Controller.aj\n\n\n\n\nUpdated SRC_MAIN_JAVA/com/springsource/vote/domain/Vote_Roo_Entity.aj\n\n\n\n\nUpdated SRC_MAIN_WEBAPP/WEB-INF/views/votes/list.jspx\n\n\n\n\n\n\nRestart the Roo she will; only now does Roo update the integration test IT WOULD:\n\n\n\n\n\n\nUpdated SRC_TEST_JAVA/com/springsource/vote/domain/VoteIntegrationTest_Roo_IntegrationTest.aj\n\n\n\n\n\n\n\nLikewise, if you delete that annotation to restore the default pluralisation, the same IT WOULD is not updated until you restart the Roo she will.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.test.IntegrationTestMetadataProviderImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2863, "bug_title": "Hint fails after mongo setup", "bug_description": "For a mongodb only project, typing \"hint\" should not require jpa setup\n    ____  ____  ____  \n   / __ \\/ __ \\/ __ \\ \n  / /_/ / / / / / / / \n / , _/ // / /_/ /  \n// ||___/___/    1.2.0.M1 [rev 63a3136]\nWelcome to Spring Roo. For assistance press TAB or type \"hint\" then hit ENTER.\n@scottyfred: Getting started with #SpringRoo and #SQLFire: http://t.co/4QGP1OWQ \nroo> project --topLevelPackage com.test\nCreated ROOT/pom.xml\nCreated SRC_MAIN_JAVA\nCreated SRC_MAIN_RESOURCES\nCreated SRC_TEST_JAVA\nCreated SRC_TEST_RESOURCES\nCreated SRC_MAIN_WEBAPP\nCreated SRC_MAIN_RESOURCES/META-INF/spring\nCreated SRC_MAIN_RESOURCES/log4j.properties\nCreated SRC_MAIN_RESOURCES/META-INF/spring/applicationContext.xml\ncom.test roo> hint\nRoo requires the installation of a JPA provider and associated database.\nType &apos;jpa setup&apos; and then hit TAB three times.\nWe suggest you type &apos;H&apos; then TAB to complete \"HIBERNATE\".\nAfter the --provider, press TAB twice for database choices.\nFor testing purposes, type (or TAB) HYPERSONIC_IN_MEMORY.\nIf you press TAB again, you&apos;ll see there are no more options.\nAs such, you&apos;re ready to press ENTER to execute the command.\nOnce JPA is installed, type &apos;hint&apos; and ENTER for the next suggestion.\ncom.test roo> mongo setup\nCreated SRC_MAIN_RESOURCES/META-INF/spring/database.properties\nCreated SRC_MAIN_RESOURCES/META-INF/spring/applicationContext-mongo.xml\nUpdated ROOT/pom.xml [added repositories http://maven.springframework.org/milestone, https://repository.jboss.org/nexus/content/repositories/releases; added dependencies javax.persistence:persistence-api:1.0, javax.validation:validation-api:1.0.0.GA, org.hibernate:hibernate-validator:4.2.0.Final, org.cloudfoundry:cloudfoundry-runtime:0.8.0, org.springframework.data:spring-data-mongodb:1.0.0.M4]\nUpdated SRC_MAIN_RESOURCES/META-INF/spring/applicationContext-mongo.xml\ncom.test roo> hint\nRoo requires the installation of a JPA provider and associated database.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.classpath.operations.HintCommands.java", "org.springframework.roo.classpath.operations.HintOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2866, "bug_title": "GAE-specific version of gwt-maven-plugin is not added when GAE is selected as database", "bug_description": "This appears to be a regression bug. After the \"web gwt gae update\" command is run when selecting the GAE database from a non-GAE database, the GWT version of the plugin is removed as expected but the GAE version of the same plugin is not added back to the pom", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.gwt.GwtOperationsImpl.java", "org.springframework.roo.project.MavenProjectMetadataProvider.java", "org.springframework.roo.addon.gwt.GwtCommands.java", "org.springframework.roo.addon.gwt.GwtOperations.java", "org.springframework.roo.project.AbstractProjectOperations.java", "org.springframework.roo.project.ProjectOperations.java"], "label": 1, "es_results": []}, {"bug_id": 2827, "bug_title": "'hint' continues to prompt for 'jpa setup' after 'mongo setup'", "bug_description": "I was attempting to follow the tutorial at http://static.springsource.org/spring-roo/reference/html/beginning.html and incorporating the MongoDB as per http://static.springsource.org/spring-roo/reference/html/base-layers.html instead of a JPA source. There is not a &apos;jpa setup --provider&apos; parameter to specify MongoDB, nor does invoking &apos;mongo setup&apos; satisfy Roo&apos;s requirements, so it keeps prompting to call &apos;jpa setup&apos;.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.classpath.operations.HintCommands.java", "org.springframework.roo.classpath.operations.HintOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2888, "bug_title": "Problem with -ActiveRecord false in roo-gwt", "bug_description": "Problem described in:\nhttp://forum.springsource.org/showthread.php?116797-NullPointerException-with-quot-web-gwt-all-quot-when-activeRecord-false&highlight=", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.gwt.GwtTemplateServiceImpl.java", "org.springframework.roo.addon.gwt.locator.GwtLocatorMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.GwtOperationsImpl.java", "org.springframework.roo.addon.gwt.scaffold.GwtScaffoldMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.GwtTypeServiceImpl.java", "org.springframework.roo.addon.gwt.TemplateResourceLoader.java"], "label": 1, "es_results": []}, {"bug_id": 2872, "bug_title": "String index out of range -1 when launching roo from a non empty directory", "bug_description": "I am consistently able to create a \"String index out of range -1\" exception when launching the roo she will from a non-empty directory that contains at least 1 java file.  Attached is the output of the commands that consistently recreate this.\nI am currently using 1.2.0.BUILD-SNAPSHOT [rev babe22d]", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.classpath.TypeLocationServiceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2907, "bug_title": "DBRE should not consider MySQL table called 'SEQUENCE'", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.dbre.model.DatabaseIntrospector.java"], "label": 1, "es_results": []}, {"bug_id": 2908, "bug_title": "web jsf setup command generates incomplete web.xml if apache myfaces is choose", "bug_description": "if you generate a simple jsf app with myfaces as implementation,\nthe web.xml will the myfaces specific listener:\n  <listener>\n    <listener-class>org.apache.myfaces.webapp.StartupServletContextListener</listener-class>\n  </listener>\nthis is the roo script i used:\n=========\nproject --topLevelPackage x\npersistence setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY\nentity jpa --class ~.Person\nfield string --fieldName name --notNull\nweb jsf setup --implementation APACHE_MYFACES \nweb jsf all --package ~.jsf\n=========\nthen trying to deploy it with:\nmvn jetty:tun", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RELEASE", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.jsf.JsfCommands.java", "org.springframework.roo.addon.jsf.JsfOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2914, "bug_title": "GWT Scaffold against multi-module roo project switches module focus to project with entity", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.gwt.GwtCommands.java"], "label": 1, "es_results": []}, {"bug_id": 2920, "bug_title": "Selenium test generation broken", "bug_description": "The correct generation of Selenium test files was broken by Git commit ID 91b7f045137b3d244ed730a7962a3f44d5098e4e.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.web.selenium.SeleniumOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2922, "bug_title": "GWT add-on does not respect paths in a multi-module project", "bug_description": "In a multi-module project where GWT scaffolding is required in a module, the GWT add-on creates artifacts in the root module of the project as well as the intended module. This is due to the use of focused project calls, when it should use the path of the actual module where the GWT scaffolding is required.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.gwt.request.GwtRequestMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.GwtPath.java", "org.springframework.roo.addon.web.mvc.controller.json.WebJsonMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.proxy.GwtProxyMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.scaffold.GwtScaffoldMetadataProviderImpl.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.WebScaffoldMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.GwtTypeService.java", "org.springframework.roo.addon.gwt.locator.GwtLocatorMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.GwtTemplateServiceImpl.java", "org.springframework.roo.addon.gwt.GwtTypeServiceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2923, "bug_title": "DBRE does not respect paths in a multi-module project", "bug_description": "In a multi-module project, when the the Roo she will is started in the root directory of the project, DBRE-generated artifacts are deleted due to not finding the dbre.xml file in the module where the reverse engineering occurred as it is currently only looking for the file in the root (focused) directory. The dbre add-on should search for the file in the correct module", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RC1", "fixed_files": ["org.springframework.roo.addon.dbre.model.DbreModelServiceImpl.java", "org.springframework.roo.addon.dbre.DbreDatabaseListenerImpl.java", "org.springframework.roo.addon.dbre.model.Database.java", "org.springframework.roo.addon.dbre.model.DatabaseXmlUtils.java", "org.springframework.roo.addon.dbre.model.DatabaseContentHandler.java", "org.springframework.roo.addon.dbre.model.DbreModelService.java", "org.springframework.roo.addon.dbre.DbreOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2935, "bug_title": "Resource Not Found single entity jpa", "bug_description": "Built simple single, 2 string field entity with JPA & no active record. Built application, getting Resource Not Found when navigating to the create entity page.\nSee Attached Script: buildme.roo\nSee Attached Log Results: logresults.txt", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.converter.ConversionServiceMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2929, "bug_title": "Unexpected capitalization of instance variable causes compiler error for Entity Types that start with multiple capital letters", "bug_description": "For entity types whose name begins with more than one capital letter, code that does not compile is being generated.\nFor example, in SWOTWeaknessController_Roo_Controller.aj, the following code was generated for the DELETE method:\n  @RequestMapping(value = \"/\n{id}\", method = RequestMethod.DELETE)\n    public String SWOTWeaknessController.delete(@PathVariable(\"id\") Long id, @RequestParam(value = \"page\", required = false) Integer page, @RequestParam(value = \"size\", required = false) Integer size, Model uiModel) {\n        SWOTWeakness SWOTWeakness = SWOTWeakness.findSWOTWeakness(id);   <=== THIS LINE HAS ERROR due to SWOTWeakness instance variable\n        SWOTWeakness.remove();\n\nThe problem is that the instance variable \"SWOTWeakness\" has the same name as the class \"SWOTWeakness\", which results in the error:\n[ERROR] error at SWOTWeakness SWOTWeakness = SWOTWeakness.findSWOTWeakness(id);\n[ERROR] ^^^\n[ERROR] D:\\LYNIADEclipseWorkspace\\LYNHP019\\src\\main\\java\\com\\lyniad\\web\\SWOTWeaknessController_Roo_Controller.aj:93:0::0\n The local variable SWOTWeakness may not have been initialized\n\nThe problem does not occur for classes that follow the more conventional naming of beginning with a single capital letter. For example, the same code for a class for an entity type named \"Tactic\" is fine:\n\n  @RequestMapping(value = \"/{id}\n\", method = RequestMethod.DELETE)\n    public String TacticController.delete(@PathVariable(\"id\") Long id, @RequestParam(value = \"page\", required = false) Integer page, @RequestParam(value = \"size\", required = false) Integer size, Model uiModel) {\n        Tactic tactic = Tactic.findTactic(id);    <=== This line is fine\n        tactic.remove();\nSuggested fix: The code which determines the upper/lower case of the instance variable needs to ensure that the resulting instance variable name is different from the class name\nThe workaround is to simply rename the entity, in the above case to \"SwotWeakness\", although that change must be propagated to object models, documentation, code that references the entity type, etc.  So the workaround is a chore, but doable.\n", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.model.JavaSymbolName.java"], "label": 1, "es_results": []}, {"bug_id": 2940, "bug_title": "jsf managed bean generation fails (using 2 many-to-many fields)", "bug_description": "When running the attached script which generates 1 object which holds 2 sets referencing (many_to_many) a second object, it fails to generate some method/variable names correctly in the xxxBean_Roo_ManagedBean.aj file.\nE.g. xxx.getStreets() instead of xxx.getFirstStreetSet() \nalso xxx.selectedFirstStreetSet and xxx.selectedSecondStreetSet vars get referenced by 2 \"selectedStreets\" references\nnote: I couldn&apos;t issue \"entity jsf\" commands via STS due to another bug, it worked from the command line though", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.jsf.managedbean.JsfManagedBeanMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2932, "bug_title": "Id cannot be resolved or is not a field", "bug_description": "[ERROR] Failed to execute goal org.codehaus.mojo:aspectj-maven-plugin:1.2:compile (default) on project test: Compiler errors :\n[ERROR] error at Entity attached = Entity.findEntity(this.id);\n[ERROR] \n[ERROR] /tmp/test/src/main/java/org/gvnix/test/domain/Entity_Roo_Jpa_ActiveRecord.aj:29:0::0 id cannot be resolved or is not a field\n[ERROR] error at private java.lang.Long Entity.id;\n[ERROR] \n[ERROR] /tmp/test/src/main/java/org/gvnix/test/domain/Entity_Roo_Jpa_Entity.aj:20:0::0 can&apos;t make inter-type field declarations on annotation types.\n[ERROR] error at private java.lang.Integer Entity.version;\n[ERROR] ^^\n[ERROR] /tmp/test/src/main/java/org/gvnix/test/domain/Entity_Roo_Jpa_Entity.aj:24:0::0 can&apos;t make inter-type field declarations on annotation types.\n[ERROR] error at public java.lang.Long Entity.getId() {\n[ERROR] ^^\n[ERROR] /tmp/test/src/main/java/org/gvnix/test/domain/Entity_Roo_Jpa_Entity.aj:26:0::0 can&apos;t make inter-type method declarations on annotation types.\n[ERROR] error at public void Entity.setId(java.lang.Long id) {\n[ERROR] ^^^^^^^^^^^^^^^^^^^\n[ERROR] /tmp/test/src/main/java/org/gvnix/test/domain/Entity_Roo_Jpa_Entity.aj:30:0::0 can&apos;t make inter-type method declarations on annotation types.\n[ERROR] error at public java.lang.Integer Entity.getVersion() {\n[ERROR] ^^^^^^^\n[ERROR] /tmp/test/src/main/java/org/gvnix/test/domain/Entity_Roo_Jpa_Entity.aj:34:0::0 can&apos;t make inter-type method declarations on annotation types.\n[ERROR] error at public void Entity.setVersion(java.lang.Integer version) {\n[ERROR] ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n[ERROR] /tmp/test/src/main/java/org/gvnix/test/domain/Entity_Roo_Jpa_Entity.aj:38:0::0 can&apos;t make inter-type method declarations on annotation types.\n[ERROR] -> [Help 1]", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.classpath.details.AnnotationMetadataUtils.java", "org.springframework.roo.classpath.itd.AbstractItdTypeDetailsProvidingMetadataItem.java", "org.springframework.roo.classpath.javaparser.JavaParserUtils.java", "org.springframework.roo.model.JavaType.java", "org.springframework.roo.addon.dod.DataOnDemandMetadata.java", "org.springframework.roo.classpath.itd.ItdSourceFileComposer.java", "org.springframework.roo.model.ImportRegistrationResolverImpl.java", "org.springframework.roo.addon.dbre.DbreDatabaseListenerImpl.java", "org.springframework.roo.model.JdkJavaType.java", "org.springframework.roo.classpath.details.DefaultItdTypeDetailsTest.java"], "label": 1, "es_results": []}, {"bug_id": 2941, "bug_title": "web mvc scaffold disallowedOperations create does not remove all create tags", "bug_description": "When creating our mvc scaffold we include the \"--disallowedOperations delete, create\" option.  This successfully removed the create link from the default project page. We instead have finders in the menu.  After selecting a finder and searching our objects, a JspTagException is given as the tag&apos;menu_item_xxx_new_label&apos; does not exist.  We added this tag to applications.properties which then allowed us to receive a page back from the finder.  The object list does not include the delete operation, but after the object list, a create operation still exists.  I&apos;m having difficulty finding exactly where this tag is built and placed in the page, but without the create operation it should not exist.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspMetadataListener.java"], "label": 1, "es_results": []}, {"bug_id": 2947, "bug_title": "Roo Integration Test generation fails - Data on demand issue with 2 attributes of same type", "bug_description": "Failure to generate an Integration test for an entity object that has 2 attributes of same custom data type in my example CurrencyAmount is defined with @Embeddable with 2 fields amount and currency, I get the following errors when I try to do anything on my entity, it fails to add any new field or generate Integration tests for this entity\n~.domain.ccti.CreditTransferTxnInfo roo> test integration\nCreated SRC_TEST_JAVA\\com\\acps\\app\\payments\\core\\domain\\cc ti\\CreditTransferTxnInfoDataOnDemand.java\nCreated SRC_TEST_JAVA\\com\\acps\\app\\payments\\core\\domain\\cc ti\\CreditTransferTxnInfoIntegrationTest.java\nUndo create SRC_TEST_JAVA\\com\\acps\\app\\payments\\core\\domain\\cc ti\\CreditTransferTxnInfoIntegrationTest.java\nUndo create SRC_TEST_JAVA\\com\\acps\\app\\payments\\core\\domain\\cc ti\\CreditTransferTxnInfoDataOnDemand.java\njava.lang.IllegalArgumentException: Method &apos;setAmount&apos; already defined in IT WOULD (IT WOULD target &apos;com.acps.app.payments.core.domain.ccti.CreditTran sferTxnInfoDataOnDemand_Roo_DataOnDemand&apos;\n~.domain.ccti.CreditTransferTxnInfo roo>\nMy Class CreditTransferTxnInfo is listed here \nimport com.acps.app.payments.core.domain.embed.CurrencyAmount;\n@RooJavaBean\n@RooToString\n@RooJpaEntity\npublic class CreditTransferTxnInfo {\n@Size(max = 35)\nprivate String instructionId;\n@Size(max = 35)\nprivate String endToEndId;\n@Embedded\nprivate PaymentTypeInfo paymentTypeInfo;\n@Embedded\n@AttributeOverrides( {\n@AttributeOverride(name=\"amount\", column = @Column(name=\"instructedAmount\") ),\n@AttributeOverride(name=\"currencyCode\", column = @Column(name=\"instructedAmount_currency\") )\n} )\nprivate CurrencyAmount instructedAmount;\n@Embedded\n@AttributeOverrides( \n{\n@AttributeOverride(name=\"amount\", column = @Column(name=\"equivalentAmount\") ),\n@AttributeOverride(name=\"currencyCode\", column = @Column(name=\"equivalentAmount_currency\") )\n} )\nprivate CurrencyAmount equivalentAmount;\n\n}\n\nHere is the Definition of CurrencyAmount.java that defines amount and CurrencyCode\n@RooJavaBean\n@RooToString\n@Embeddable\npublic class CurrencyAmount {\nprivate BigDecimal amount;\n@Size(max = 3)\nprivate String currencyCode;\n}\nDoes Roo not support Generating DataOnDemand when there are different properties of same Type? ", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.dod.DataOnDemandMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2948, "bug_title": "repository jpa she will command hangs roo", "bug_description": "roo> jpa setup --provider HIBERNATE --database MSSQL \nroo> database reverse engineer --schema roo_crm --activeRecord false --package ~.model\nroo> repository jpa --interface ~.repository.CartOrder --entity ~.domain.CartOrder\nDBRE works fine - all java and IT WOULD files created correctly. \nrepository jpa cmd prints nothing in output window - not even a roo> prompt, and no actions are taken.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.shell.jline.JLineShell.java", "org.springframework.roo.shell.AbstractShell.java"], "label": 1, "es_results": []}, {"bug_id": 2953, "bug_title": "She Will prompt does not show entity in focus after 'entity jpa' command is run using a fully-qualified name such as com.foo.bar.Bar", "bug_description": "When the &apos;entity jpa&apos; command is run, the Roo prompt does not have the name of the entity in focus if it was created using \n\n\n\n\n\n\nentity jpa --class com.foo.bar.Bar\n\n\n\n\n\n\nOutput is as follows:\n\n\n\n\n\n\nroo> entity jpa --class com.foo.bar.Bar\n\n\n\n\nCreated SRC_MAIN_JAVA/com/foo/bar\n\n\n\n\n8832648 Created SRC_MAIN_JAVA/com/foo/bar/Bar.java\n\n\n\n\n12a9c80 Created SRC_MAIN_JAVA/com/foo/bar/Bar_Roo_Configurable.aj\n\n\n\n\n7ef5378 Created SRC_MAIN_JAVA/com/foo/bar/Bar_Roo_Jpa_ActiveRecord.aj\n\n\n\n\n74c1860 Created SRC_MAIN_JAVA/com/foo/bar/Bar_Roo_ToString.aj\n\n\n\n\n7bcd4a1 Created SRC_MAIN_JAVA/com/foo/bar/Bar_Roo_Jpa_Entity.aj\n\n\n\n\nroo> \n\n\n\n\n\n\nHowever if the command is run using a tilde, the correct output is shown:\n\n\n\n\n\n\nroo> entity jpa --class ~.Foo\n\n\n\n\n5b5e723 Created SRC_MAIN_JAVA/com/foo/bar/Foo.java\n\n\n\n\n9bc166a Created SRC_MAIN_JAVA/com/foo/bar/Foo_Roo_Configurable.aj\n\n\n\n\n2320419 Created SRC_MAIN_JAVA/com/foo/bar/Foo_Roo_Jpa_ActiveRecord.aj\n\n\n\n\nbc732bd Created SRC_MAIN_JAVA/com/foo/bar/Foo_Roo_ToString.aj\n\n\n\n\n8f19a9d Created SRC_MAIN_JAVA/com/foo/bar/Foo_Roo_Jpa_Entity.aj\n\n\n\n\n~.Foo roo> \n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.classpath.converters.JavaTypeConverter.java"], "label": 1, "es_results": []}, {"bug_id": 2925, "bug_title": "GWT Request interface not updated when invoked service is deleted", "bug_description": "To replicate:\n\nCreate a GWT project in which the service layer delegates to active record methods:\n\n\n\n\n\n\nproject --topLevelPackage com.example.gwtbug\n\n\n\n\njpa setup --database HYPERSONIC_IN_MEMORY --provider HIBERNATE\n\n\n\n\nentity jpa --class ~.server.domain.Thing\n\n\n\n\nfield string --fieldName name\n\n\n\n\nservice --interface ~.services.ThingService --entity ~.server.domain.Thing\n\n\n\n\nweb gwt setup\n\n\n\n\nweb gwt all --proxyPackage ~.client.proxy --requestPackage ~.client.request\n\n\n\n\n\n\nExit the Roo she will\nDelete ThingService.java and ThingServiceImpl.java\nRestart the Roo she will; some GWT-related artifacts are updated to reflect the deletion of the ThingService, but the Roo-managed ThingRequest interface still contains its class name and method signatures:\n\n\n\n\n\n\npackage com.example.gwtbug.client.request;\n\n\n\n\n\n\n\n\n\nimport com.example.gwtbug.client.proxy.ThingProxy;\n\n\n\n\nimport com.google.web.bindery.requestfactory.shared.InstanceRequest;\n\n\n\n\nimport com.google.web.bindery.requestfactory.shared.Request;\n\n\n\n\nimport com.google.web.bindery.requestfactory.shared.RequestContext;\n\n\n\n\nimport com.google.web.bindery.requestfactory.shared.ServiceName;\n\n\n\n\nimport org.springframework.roo.addon.gwt.RooGwtRequest;\n\n\n\n\n\n\n\n\n\n@RooGwtRequest(value = \"com.example.gwtbug.server.domain.Thing\", exclude = { \"clear\", \"entityManager\", \"equals\", \"flush\", \"hashCode\", \"merge\", \"toString\" })\n\n\n\n\n@ServiceName(value = \"com.example.gwtbug.services.ThingService\", locator = \"com.example.gwtbug.server.locator.GwtServiceLocator\")\n\n\n\n\npublic interface ThingRequest extends RequestContext {\n\n\n\n\n\n\n\n\n\n    abstract Request<java.lang.Long> countAllThings();\n\n\n\n\n\n\n\n\n\n    abstract Request<java.lang.Void> deleteThing(ThingProxy thing);\n\n\n\n\n\n\n\n\n\n    abstract Request<com.example.gwtbug.client.proxy.ThingProxy> findThing(Long id);\n\n\n\n\n\n\n\n\n\n    abstract Request<java.util.List<com.example.gwtbug.client.proxy.ThingProxy>> findAllThings();\n\n\n\n\n\n\n\n\n\n    abstract Request<java.util.List<com.example.gwtbug.client.proxy.ThingProxy>> findThingEntries(int firstResult, int maxResults);\n\n\n\n\n\n\n\n\n\n    abstract Request<java.lang.Void> saveThing(ThingProxy thing);\n\n\n\n\n\n\n\n\n\n    abstract Request<com.example.gwtbug.client.proxy.ThingProxy> updateThing(ThingProxy thing);\n\n\n\n\n}\n\n\n\n\n\n\nThe most obvious symptom is that the following Roo-managed Java files no longer compile (because they have been correctly updated with the expected Request method names):\n\t\nThingActivitiesMapper_Roo_Gwt.java\nThingDetailsActivity_Roo_Gwt.java\nThingListActivity_Roo_Gwt.java\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.gwt.request.GwtRequestMetadataProviderImpl.java", "org.springframework.roo.addon.layers.service.ServiceLayerProvider.java", "org.springframework.roo.addon.gwt.GwtOperationsImpl.java", "org.springframework.roo.addon.gwt.request.GwtRequestMetadataProvider.java", "org.springframework.roo.classpath.layers.MemberTypeAdditions.java", "org.springframework.roo.classpath.layers.MemberTypeAdditionsTest.java", "org.springframework.roo.addon.layers.repository.mongo.RepositoryMongoLayerMethod.java", "org.springframework.roo.addon.layers.repository.jpa.RepositoryJpaLayerMethod.java", "org.springframework.roo.addon.layers.repository.mongo.RepositoryMongoLayerProvider.java", "org.springframework.roo.addon.gwt.RooGwtRequest.java", "org.springframework.roo.addon.gwt.GwtTypeService.java", "org.springframework.roo.addon.layers.repository.jpa.RepositoryLayerMethodTest.java", "org.springframework.roo.addon.jpa.activerecord.EntityLayerProvider.java", "org.springframework.roo.addon.layers.repository.jpa.RepositoryJpaLayerProvider.java", "org.springframework.roo.addon.gwt.GwtTypeServiceImpl.java", "org.springframework.roo.addon.jpa.activerecord.EntityLayerMethod.java", "org.springframework.roo.addon.jpa.activerecord.EntityLayerMethodTest.java"], "label": 1, "es_results": []}, {"bug_id": 2954, "bug_title": "Ansi chars should not display in STS Roo she will", "bug_description": "", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.support.util.AnsiEscapeCodeTest.java", "org.springframework.roo.support.util.AnsiEscapeCode.java", "org.springframework.roo.shell.jline.JLineLogHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2844, "bug_title": "MVC controller and views not updated when related entity's plural changes", "bug_description": "Found this bug while working on ROO-2839; it&apos;s similar to ROO-2840. To replicate:\n\nRun the vote.roo script.\nEdit Choice.java to include the class-level annotation @RooPlural(\"Options\")\n\nRoo updates the Choice-related files:\n\n\n\n\n\n\nUpdated SRC_TEST_JAVA/com/springsource/vote/domain/ChoiceIntegrationTest_Roo_IntegrationTest.aj\n\n\n\n\nUpdated SRC_MAIN_JAVA/com/springsource/vote/web/ChoiceController_Roo_Controller.aj\n\n\n\n\nUpdated SRC_MAIN_JAVA/com/springsource/vote/domain/Choice_Roo_Jpa_ActiveRecord.aj\n\n\n\n\nUpdated SRC_MAIN_WEBAPP/WEB-INF/views/choices/list.jspx\n\n\n\n\n\n\n... but not the Vote-related files, until the she will is restarted:\n\n\n\n\n\n\nUpdated SRC_MAIN_JAVA/com/springsource/vote/web/VoteController_Roo_Controller.aj\n\n\n\n\nUpdated SRC_MAIN_WEBAPP/WEB-INF/views/votes/create.jspx\n\n\n\n\nUpdated SRC_MAIN_WEBAPP/WEB-INF/views/votes/update.jspx\n\n\n\n\n\n\nLikewise, the same three files are skipped when the annotation is removed.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.plural.PluralMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2957, "bug_title": "validationMessageCode is erroneously added to boolean attributes in jspx files", "bug_description": "When a scaffold is generated for a JPA entity with a Boolean field, a validationMessageCode attribute is erroneously added to the jspx file:\n\n\n\n\n\n\n <field:checkbox field=\"emailAllowed\"\n\n\n\n\n\tid=\"c_com_kn_core_domain_KnEmailSource_emailAllowed\"\n\n\n\n\n\tvalidationMessageCode=\"field_invalid_email\"\n\n\n\n\n\tz=\"wTN+Jq4iS1yreKGSzQx31kMngEI=\" />\n\n\n\n\n\n\n... which generates an error when the page is loaded.\nAccording to the TLD, the validationMessageCode attribute is invalid for the checkbox tag.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.jsp.JspViewManager.java"], "label": 1, "es_results": []}, {"bug_id": 2965, "bug_title": "JSON responses have Content-Type \"application/text\" instead of \"application/json\"", "bug_description": "According to section 6 of RFC 4627, the correct MIME media type for JSON responses is \"application/json\", however the JSON-generating methods created by Roo set the HTTP \"Content-Type\" header to \"application/text\".", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.json.WebJsonMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2967, "bug_title": "WebScaffoldMetadata copies from wrong method's builder when generating \"populateXxx\" methods", "bug_description": "Found this while refactoring in preparation for ROO-2514. WebScaffoldMetadata#getPopulateMethods() contains this code:\n\n\n\n\n\n\nif (javaTypePersistenceMd != null && javaTypePersistenceMd.getFindAllMethod() != null) {\n\n\n\n\n    bodyBuilder.appendFormalLine(\"return \" + javaTypePersistenceMd.getFindAllMethod().getMethodCall() + \";\");\n\n\n\n\n    javaTypePersistenceMd.getFindMethod().copyAdditionsTo(builder, governorTypeDetails); // !!!\n\n\n\n\n}\n\n\n\n\n\n\nOn the line marked \"!!!\", copyAdditionsTo is invoked on the MemberTypeAdditions of the \"find\" method instead of the \"findAll\" method. This could cause the generated \"populateXxx\" method not to compile if:\n\nthere was no \"find\" method (unlikely)\nthe \"find\" method was provided by a different layer component (service, repository, active record, etc.) to the \"find all\" method (more likely, but still pretty unlikely)\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.scaffold.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2969, "bug_title": "Some Roo annotations are retained at runtime", "bug_description": "I found while testing Spring 3.1 for ROO-2894 that the following Roo annotations have the default retention, i.e. java.lang.annotation.RetentionPolicy.RUNTIME:\n\nRooGwtLocator\nRooJpaEntity\nRooWebFinder\nRooWebJson\n\nObviously this violates the core Roo design goal of the user project having no runtime dependencies upon Roo itself.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.finder.RooWebFinder.java", "org.springframework.roo.addon.jpa.entity.RooJpaEntity.java", "org.springframework.roo.addon.web.mvc.controller.json.RooWebJson.java", "org.springframework.roo.addon.gwt.RooGwtLocator.java"], "label": 1, "es_results": []}, {"bug_id": 2972, "bug_title": "NPE when creating class in src/test/java default package", "bug_description": "Creating a simple class with no annotations at all in the default package of a project such as petclinic causes a NullPointerException in JavaParserTypeResolutionService#getPackage when attempting to evaluate compilationUnit.getPackage().\n", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.classpath.javaparser.JavaParserTypeResolutionService.java"], "label": 1, "es_results": []}, {"bug_id": 2974, "bug_title": "JSON-accepting controller methods are handling non-JSON requests", "bug_description": "Create a simple project with JSON support as follows:\n\n\n\n\n\n\nproject --topLevelPackage com.json\n\n\n\n\njpa setup --database HYPERSONIC_IN_MEMORY --provider HIBERNATE \n\n\n\n\nentity jpa --class ~.domain.Thing\n\n\n\n\nfield string name\n\n\n\n\njson all\n\n\n\n\nweb mvc setup\n\n\n\n\nweb mvc all --package ~.web\n\n\n\n\nweb mvc json all\n\n\n\n\n\n\nThen start Jetty or Tomcat. Clicking on the \"List all Things\" link returns the JSON response \"[]\" (meaning an empty list of Things) instead of the HTML page saying \"No Thing found.\", with the navigation pane, header, footer, etc.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.M1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.mvc.controller.scaffold.WebScaffoldMetadata.java"], "label": 1, "es_results": []}, {"bug_id": 2975, "bug_title": "\"web flow\" command does not add required message codes to application.properties", "bug_description": "\nCreate a project without Spring Web Flow (e.g. run vote.roo)\nRun the \"web flow\" she will command; note that the she will does not update the application.properties message bundle:\n\n\n\n\n\n\nroo> web flow \n\n\n\n\nCreated SRC_MAIN_WEBAPP/WEB-INF/spring/webflow-config.xml\n\n\n\n\nCreated SRC_MAIN_WEBAPP/WEB-INF/views/sampleflow\n\n\n\n\nCreated SRC_MAIN_WEBAPP/WEB-INF/views/sampleflow/flow.xml\n\n\n\n\nCreated SRC_MAIN_WEBAPP/WEB-INF/views/sampleflow/view-state-1.jspx\n\n\n\n\nCreated SRC_MAIN_WEBAPP/WEB-INF/views/sampleflow/view-state-2.jspx\n\n\n\n\nCreated SRC_MAIN_WEBAPP/WEB-INF/views/sampleflow/end-state.jspx\n\n\n\n\nCreated SRC_MAIN_WEBAPP/WEB-INF/views/sampleflow/views.xml\n\n\n\n\nUpdated SRC_MAIN_WEBAPP/WEB-INF/spring/webmvc-config.xml\n\n\n\n\nUpdated SRC_MAIN_WEBAPP/WEB-INF/views/sampleflow/flow.xml\n\n\n\n\nUpdated SRC_MAIN_WEBAPP/WEB-INF/views/menu.jspx\n\n\n\n\nUpdated ROOT/pom.xml [added dependency org.springframework.webflow:spring-webflow:2.2.1.RELEASE]\n\n\n\n\nUpdated SRC_MAIN_WEBAPP/WEB-INF/spring/webflow-config.xml\n\n\n\n\n\n\nRun the application and go to http://localhost/vote\nThe home page fails to load, with this error in the server log:\n\n\n\n\n\n\nNo message found under code &apos;menu_category_flows_label&apos; for locale &apos;en&apos;.\n\n\n\n\n\n\n\nIf you add this code to application.properties and restart the application, another message code is reported as missing:\n\n\n\n\n\n\nNo message found under code &apos;menu_item_sampleflow_label&apos; for locale &apos;en&apos;.\n\n\n\n\n\n\nAnd if you fix that, you get:\n\n\n\n\n\n\nNo message found under code &apos;Sampleflow&apos; for locale &apos;en&apos;.\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RC1", "fixed_version": "1.2.0.RELEASE", "fixed_files": ["org.springframework.roo.addon.web.flow.WebFlowOperationsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2978, "bug_title": "Cyclic dependency in multi-module project when business module focussed after web scaffold", "bug_description": "\nRun this script:\n\n\n\n\n\n\nproject --topLevelPackage com.sample\n\n\n\n\nmodule create --topLevelPackage ~.core --moduleName my\n\n\n\n\njpa setup --database H2_IN_MEMORY --provider HIBERNATE\n\n\n\n\nentity jpa --class ~.Book\n\n\n\n\nfield string --fieldName title\n\n\n\n\nmodule focus --moduleName ~\n\n\n\n\nmodule create --topLevelPackage ~.web --moduleName web\n\n\n\n\nweb mvc setup\n\n\n\n\nweb mvc scaffold --backingType my|~.Book --class web|~.BookController\n\n\n\n\nmodule focus --moduleName my\n\n\n\n\n\n\nRoo incorrectly makes the \"my\" module depend on the \"web\" module:\n\n\n\n\n\n\n...\n\n\n\n\nUpdated my|ROOT/pom.xml [added dependency com.sample.web:web:0.1.0.BUILD-SNAPSHOT]\n\n\n\n\n...\n\n\n\n\n\n\nYou can confirm this is invalid by running \"mvn validate\":\n\n\n\n\n\n\n[INFO] Scanning for projects...\n\n\n\n\n[ERROR] The projects in the reactor contain a cyclic reference: Edge between &apos;Vertex{label=&apos;com.sample.web:web:0.1.0.BUILD-SNAPSHOT&apos;}&apos; and &apos;Vertex{label=&apos;com.sample.core:my:0.1.0.BUILD-SNAPSHOT&apos;}&apos; introduces to cycle in the graph com.sample.core:my:0.1.0.BUILD-SNAPSHOT --> com.sample.web:web:0.1.0.BUILD-SNAPSHOT --> com.sample.core:my:0.1.0.BUILD-SNAPSHOT -> [Help 1]\n\n\n\n\n[ERROR] \n\n\n\n\n[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.\n\n\n\n\n[ERROR] Re-run Maven using the -X switch to enable full debug logging.\n\n\n\n\n[ERROR] \n\n\n\n\n[ERROR] For more information about the errors and possible solutions, please read the following articles:\n\n\n\n\n[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/ProjectCycleException\n\n\n\n\n\n\n\nThe workaround is to edit the \"my\" module&apos;s POM and delete the dependency on the \"web\" module&apos;s WAR file.\nThe bug doesn&apos;t occur if you remove the final \"module focus\" command from the above script (running it separately via the she will doesn&apos;t add the dependency, oddly).\nThe impact of this is that scripts need to issue all necessary commands to the non-web modules (e.g. creating entities, services, and repositories) before creating any web modules.", "project": "Spring", "sub_project": "ROO", "version": "1.2.0.RELEASE", "fixed_version": "1.2.1.RELEASE", "fixed_files": ["org.springframework.roo.project.AbstractProjectOperations.java", "org.springframework.roo.project.Dependency.java", "org.springframework.roo.project.maven.Pom.java", "org.springframework.roo.project.maven.PomTest.java", "org.springframework.roo.addon.security.SecurityOperationsImpl.java", "org.springframework.roo.project.DependencyTest.java"], "label": 1, "es_results": []}, {"bug_id": 3447, "bug_title": "Comment structures added by a builder are not written in the IT WOULD", "bug_description": "Builders allow comment structures from Metadata, but  not included in the AJ file when write to disk.\nIt is possible same problem affects comments into properties, classes, methods, ...\nExample:\n\n\n\n\n\n\n...\n\n\n\n\nCommentStructure comments = new CommentStructure();\n\n\n\n\nJavadocComment javadoc = new JavadocComment(\"My javadoc comment\");\n\n\n\n\ncomments.addComment(javadoc, CommentStructure.CommentLocation.BEGINNING);\n\n\n\n\n...\n\n\n\n\nMethodMetadataBuilder methodBuilder = new MethodMetadataBuilder(...);\n\n\n\n\nmethodBuilder.setCommentStructure(comments);\n\n\n\n\n...\n\n\n\n\nbuilder.addMethod(methodBuilder.build());\n\n\n\n\nitdTypeDetails = builder.build();\n\n\n\n\n\n", "project": "Spring", "sub_project": "ROO", "version": "1.2.4.RELEASE", "fixed_version": "2.0.0.M2", "fixed_files": ["org.springframework.roo.classpath.itd.ItdSourceFileComposer.java"], "label": 1, "es_results": []}, {"bug_id": 3505, "bug_title": "Spring Roo does not start with JDK 1.8", "bug_description": "I am using Spring Roo 1.2.5.RELEASE on OS X 10.9.2 and java version 1.8.0_05.\nWhen I try to start roo.sh I get a ton of unresolved constraints (log file attached). After searching the web I found this (http://forum.spring.io/forum/spring-projects/roo/106193-error-staring-the-roo-she will) and tried to replace the felix.jar in the Spring Roo distribution (by version 4.4.0) and could start the she will successfully.", "project": "Spring", "sub_project": "ROO", "version": "1.2.5.RELEASE", "fixed_version": "1.3.0.RELEASE", "fixed_files": ["org.springframework.roo.project.ApplicationContextOperationsImpl.java", "org.springframework.roo.project.packaging.AbstractPackagingProvider.java", "org.springframework.roo.project.packaging.JarPackaging.java", "org.springframework.roo.felix.FelixDelegator.java", "org.springframework.roo.shell.SimpleParser.java", "org.springframework.roo.shell.osgi.SimpleParserComponent.java", "org.springframework.roo.project.MavenCommands.java", "org.springframework.roo.addon.javabean.JavaBeanMetadataProvider.java", "org.springframework.roo.addon.web.mvc.jsp.JspCommands.java", "org.springframework.roo.support.util.XmlUtils.java", "org.springframework.roo.shell.osgi.converters.FileConverterComponent.java", "org.springframework.roo.shell.jline.osgi.JLineShellComponent.java", "org.springframework.roo.project.PathResolvingAwareFilenameResolver.java", "org.springframework.roo.project.ProjectPathMonitoringInitializer.java", "org.springframework.roo.project.MavenProjectMetadataProvider.java", "org.springframework.roo.project.Plugin.java", "org.springframework.roo.project.MavenPathResolvingStrategy.java", "org.springframework.roo.project.maven.PomFactoryImpl.java", "org.springframework.roo.project.DelegatePathResolver.java", "org.springframework.roo.project.maven.Pom.java", "org.springframework.roo.project.AbstractProjectOperations.java", "org.springframework.roo.project.MavenOperationsImpl.java", "org.springframework.roo.project.DefaultPathResolvingStrategy.java", "org.springframework.roo.process.manager.internal.DefaultFileManager.java", "org.springframework.roo.process.manager.internal.DefaultProcessManager.java", "org.springframework.roo.process.manager.ProcessManagerHostedExecutionStrategy.java", "org.springframework.roo.process.manager.ProcessManagerCommands.java", "org.springframework.roo.process.manager.internal.ProcessManagerDiagnosticsListener.java", "org.springframework.roo.metadata.AbstractHashCodeTrackingMetadataNotifier.java", "org.springframework.roo.metadata.DefaultMetadataService.java", "org.springframework.roo.classpath.itd.AbstractMemberDiscoveringItdMetadataProvider.java", "org.springframework.roo.classpath.operations.AbstractOperations.java", "org.springframework.roo.classpath.DefaultPhysicalTypeMetadataProvider.java", "org.springframework.roo.classpath.itd.AbstractItdMetadataProvider.java", "org.springframework.roo.classpath.persistence.PersistenceMemberLocatorImpl.java", "org.springframework.roo.classpath.layers.LayerServiceImpl.java", "org.springframework.roo.classpath.scanner.MemberDetailsScannerImpl.java", "org.springframework.roo.classpath.ItdDiscoveryServiceImpl.java", "org.springframework.roo.classpath.TypeLocationServiceImpl.java", "org.springframework.roo.classpath.javaparser.JavaParserTypeResolutionService.java", "org.springframework.roo.classpath.javaparser.JavaParserTypeParsingService.java", "org.springframework.roo.classpath.antlrjavaparser.JavaParserTypeResolutionService.java", "org.springframework.roo.classpath.antlrjavaparser.details.JavaParserClassOrInterfaceTypeDetailsBuilder.java", "org.springframework.roo.classpath.antlrjavaparser.JavaParserTypeParsingService.java", "org.springframework.roo.addon.web.mvc.jsp.i18n.languages.GermanLanguage.java", "org.springframework.roo.addon.web.mvc.jsp.i18n.languages.DuchLanguage.java", "org.springframework.roo.addon.web.mvc.jsp.i18n.languages.ItalianLanguage.java", "org.springframework.roo.addon.web.mvc.jsp.JspOperationsImpl.java", "org.springframework.roo.addon.web.mvc.jsp.JspMetadataListener.java", "org.springframework.roo.addon.web.mvc.jsp.i18n.I18nConverter.java", "org.springframework.roo.addon.web.mvc.jsp.i18n.languages.EnglishLanguage.java", "org.springframework.roo.addon.web.mvc.jsp.JspViewManager.java", "org.springframework.roo.addon.web.mvc.jsp.menu.MenuOperationsImpl.java", "org.springframework.roo.addon.web.mvc.jsp.i18n.I18nComponent.java", "org.springframework.roo.addon.web.mvc.jsp.i18n.languages.SpanishLanguage.java", "org.springframework.roo.addon.web.mvc.jsp.i18n.languages.SwedishLanguage.java", "org.springframework.roo.addon.web.mvc.embedded.provider.FinanceEmbeddedProvider.java", "org.springframework.roo.addon.web.mvc.embedded.provider.VideoStreamEmbeddedProvider.java", "org.springframework.roo.addon.web.mvc.embedded.provider.DocumentEmbeddedProvider.java", "org.springframework.roo.addon.web.mvc.embedded.provider.MicrobloggingEmbeddedProvider.java", "org.springframework.roo.addon.web.mvc.embedded.provider.MapEmbeddedProvider.java", "org.springframework.roo.addon.web.mvc.embedded.provider.VideoEmbeddedProvider.java", "org.springframework.roo.addon.web.mvc.embedded.provider.WaveEmbeddedProvider.java", "org.springframework.roo.addon.web.mvc.embedded.provider.PhotoEmbeddedProvider.java", "org.springframework.roo.addon.web.mvc.controller.converter.ConversionServiceMetadataProviderImpl.java", "org.springframework.roo.addon.web.mvc.controller.json.WebJsonMetadataProviderImpl.java", "org.springframework.roo.addon.web.mvc.controller.details.WebMetadataServiceImpl.java", "org.springframework.roo.addon.web.mvc.controller.scaffold.WebScaffoldMetadataProviderImpl.java", "org.springframework.roo.addon.web.mvc.controller.finder.WebFinderMetadataProviderImpl.java", "org.springframework.roo.addon.web.mvc.controller.WebMvcOperationsImpl.java", "org.springframework.roo.addon.tostring.ToStringMetadataProvider.java", "org.springframework.roo.addon.test.IntegrationTestMetadataProviderImpl.java", "org.springframework.roo.addon.tailor.service.DefaultConfigurationLocator.java", "org.springframework.roo.addon.tailor.service.DefaultActionLocator.java", "org.springframework.roo.addon.tailor.DefaultTailorImpl.java", "org.springframework.roo.addon.solr.SolrJspMetadataListener.java", "org.springframework.roo.addon.solr.SolrMetadataProvider.java", "org.springframework.roo.addon.solr.SolrWebSearchMetadataProvider.java", "org.springframework.roo.addon.serializable.SerializableMetadataProviderImpl.java", "org.springframework.roo.addon.security.PermissionEvaluatorMetadataProvider.java", "org.springframework.roo.addon.security.SecurityOperationsImpl.java", "org.springframework.roo.addon.roobot.client.AddOnRooBotOperationsImpl.java", "org.springframework.roo.addon.property.editor.EditorMetadataProvider.java", "org.springframework.roo.addon.plural.PluralMetadataProviderImpl.java", "org.springframework.roo.addon.op4j.Op4jMetadataProvider.java", "org.springframework.roo.addon.layers.service.ServiceLayerProvider.java", "org.springframework.roo.addon.layers.service.ServiceInterfaceMetadataProvider.java", "org.springframework.roo.addon.layers.service.ServiceClassMetadataProvider.java", "org.springframework.roo.addon.layers.repository.mongo.MongoOperationsImpl.java", "org.springframework.roo.addon.layers.repository.mongo.RepositoryMongoMetadataProviderImpl.java", "org.springframework.roo.addon.layers.repository.mongo.MongoEntityMetadataProviderImpl.java", "org.springframework.roo.addon.layers.repository.jpa.RepositoryJpaMetadataProviderImpl.java", "org.springframework.roo.addon.layers.repository.jpa.RepositoryJpaOperationsImpl.java", "org.springframework.roo.addon.json.JsonMetadataProvider.java", "org.springframework.roo.addon.jsf.converter.JsfConverterMetadataProviderImpl.java", "org.springframework.roo.addon.jsf.application.JsfApplicationBeanMetadataProviderImpl.java", "org.springframework.roo.addon.jsf.JsfOperationsImpl.java", "org.springframework.roo.addon.jsf.managedbean.JsfManagedBeanMetadataProviderImpl.java", "org.springframework.roo.addon.jpa.activerecord.JpaActiveRecordMetadataProviderImpl.java", "org.springframework.roo.addon.jpa.JpaOperationsImpl.java", "org.springframework.roo.addon.jpa.entity.JpaEntityMetadataProviderImpl.java", "org.springframework.roo.addon.jpa.GaeOperationsImpl.java", "org.springframework.roo.addon.jpa.identifier.IdentifierMetadataProviderImpl.java", "org.springframework.roo.addon.jpa.DatabaseDotComOperationsImpl.java", "org.springframework.roo.addon.gwt.request.GwtRequestMetadataNotificationListener.java", "org.springframework.roo.addon.gwt.request.GwtRequestMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.scaffold.GwtScaffoldMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.proxy.GwtProxyMetadataProviderImpl.java", "org.springframework.roo.addon.gwt.locator.GwtLocatorMetadataProviderImpl.java", "org.springframework.roo.addon.git.GitShellEventListener.java", "org.springframework.roo.addon.finder.FinderOperationsImpl.java", "org.springframework.roo.addon.finder.FinderMetadataProviderImpl.java", "org.springframework.roo.addon.equals.EqualsMetadataProviderImpl.java", "org.springframework.roo.addon.dod.DataOnDemandMetadataProviderImpl.java", "org.springframework.roo.addon.dbre.DbreMetadataProviderImpl.java", "org.springframework.roo.addon.dbre.DbreDatabaseListenerImpl.java", "org.springframework.roo.addon.configurable.ConfigurableMetadataProviderImpl.java", "org.springframework.roo.uaa.UaaShellStatusListener.java", "org.springframework.roo.uaa.ShellListeningUaaRegistrationFacility.java", "org.springframework.roo.uaa.UaaRelatedComponentRegistrationHelper.java", "org.springframework.roo.startlevel.Activator.java", "org.springframework.roo.felix.HttpPgpUrlStreamHandlerServiceImpl.java", "org.springframework.roo.felix.JdkDelegatingLogListener.java", "org.springframework.roo.bootstrap.Main.java"], "label": 1, "es_results": []}, {"bug_id": 303, "bug_title": "LdapUserDetailsMapper should check that an attribute has actually been retrieved before attempting to map it to a role", "bug_description": "If a particular attribute has not been retrieved from the directory (e.g. because it doesn&apos;t exist, or the user doesn&apos;t have permissions to read it), then in the code\n            Attribute roleAttribute = attributes.get(roleAttributes[i]);\n            NamingEnumeration attributeRoles = roleAttribute.getAll();\nroleAttribute may be null and the second line will cause  a NullPointerException. A check should be made that the value isn&apos;t null and a debug message logged if it is.", "project": "Spring", "sub_project": "SEC", "version": "1.0.0", "fixed_version": "1.0.1", "fixed_files": ["org.acegisecurity.userdetails.ldap.LdapUserDetailsMapper.java"], "label": 1, "es_results": []}, {"bug_id": 311, "bug_title": "equals(Object object) in SecurityConfig does not obey symmetry requirement of the interface contract", "bug_description": "The SecurityConfig.equals(Object object) method violates the symmetry requirement imposed by the Object.equals(Object object) contract. If the &apos;other&apos; Object is a String, it compares that String to the attribute String stored in the SecurityConfig.\nConsider the following situation:\n[code]\nString myString = \"CONFIG\";\nSecurityConfig myConfig = new SecurityConfig(\"CONFIG\");\n[/code]\nWhile [code]myConfig.equals(myString)[/code] will return true, [code]myString.equals(myConfig)[/code] will return false, violating the equals symmetry.\nI&apos;ve checked the 1.1-SNAPSHOT (via http://www.acegisecurity.org/multiproject/acegi-security/clover/org/acegisecurity/SecurityConfig.html) and the equals method of SecurityConfig apparently has not changed.", "project": "Spring", "sub_project": "SEC", "version": "1.0.0", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.securechannel.ChannelDecisionManagerImplTests.java", "org.acegisecurity.SecurityConfigTests.java", "org.acegisecurity.SecurityConfig.java"], "label": 1, "es_results": []}, {"bug_id": 293, "bug_title": "BasicAclEntryAfterInvocationCollectionFilteringProvider causes ConcurrentModificationExceptio", "bug_description": "The BasicAclEntryAfterInvocationCollectionFilteringProvider.CollectionFilterer has been modified is may 2005 to gain performance at the cost of risking a ConcurrentModificationException. The current version now unnecessary complex. In addition, the debug message no longer prints the correct original size.", "project": "Spring", "sub_project": "SEC", "version": "1.0.0", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.afterinvocation.BasicAclEntryAfterInvocationCollectionFilteringProvider.java"], "label": 1, "es_results": []}, {"bug_id": 341, "bug_title": "Retrieving User after AuthenticationException", "bug_description": "In AbstractUserDetailsAuthenticationProvider the authenticate() method calls the additionalAuthenticationChecks() method in a try block and can catch an AuthenticationException.  The code in the catch block (line 147 for rel 1.0.1) calls the retrieveUser() and additionalAuthenticationChecks() methods.  If the user details used for the call in the try block came from the cache, I understand why this makes sense.  However, if cacheWasUsed is false, the call to retrieve the user details obtains the exact same user details.\nPerhaps the catch block should only repeat those method calls if cacheWasUsed is true, and throws the caught AuthenticationException if cacheWasUsed is false.", "project": "Spring", "sub_project": "SEC", "version": "1.0.0", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.providers.dao.AbstractUserDetailsAuthenticationProvider.java"], "label": 1, "es_results": []}, {"bug_id": 297, "bug_title": "defaultTargetUrl Scheme", "bug_description": "Documentation regarding inclusion of http://or https:// scheme in the defaultTargetUrl :\ndefaultTargetUrl indicates the URL that should be used for redirection if the HttpSession attribute named ACEGI_SAVED_REQUEST_KEY does not indicate the target URL once authentication is completed successfully. eg: /. The defaultTargetUrl will be treated as relative to the web-app&apos;s context path, and should include the leading /. Alternatively, inclusion of a scheme name (eg http:// or https://) as the prefix will denote a fully-qualified URL and this is also supported.\nSnippet of acegi configuration file:\n    <bean id=\"authenticationProcessingFilter\" class=\"org.acegisecurity.ui.webapp.AuthenticationProcessingFilter\">\n        <property name=\"authenticationManager\"><ref local=\"authenticationManager\"/></property>\n        <property name=\"authenticationFailureUrl\"><value>/login.do?error=true</value></property>\n        <property name=\"defaultTargetUrl\"><value>https://bpz.fluxweb.com/ctxroot/home.do?method=home</value></property>\n        <property name=\"filterProcessesUrl\"><value>/j_security_check</value></property>\n    </bean>\nHowever the defaultTargetUrl is always prefixed with the context root (based on the debugging information below):\n[app] DEBUG [TP-Processor2] AbstractProcessingFilter.successfulAuthentication(384) | Redirecting to target URL from HTTP Session (or default): /ctxroothttps://bpz.fluxweb.com/ctxroot/home.do?method=home", "project": "Spring", "sub_project": "SEC", "version": "1.0.0", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.ui.AbstractProcessingFilter.java", "org.acegisecurity.ui.AbstractProcessingFilterTests.java", "org.acegisecurity.ui.webapp.SiteminderAuthenticationProcessingFilterTests.java"], "label": 1, "es_results": []}, {"bug_id": 395, "bug_title": "HttpSessionEventPublisher causes a NullPointerException", "bug_description": "As explained in...\nhttp://forum.springframework.org/showthread.php?t=30766\nThe code naively assumes that one intance of the HttpSessionEventPublisher will be created by the container. In Websphere 5.1.1 at least, this is not true.\nThe code will be modified to get the ApplicationContext in an as needed basis rather than storing it in a field.", "project": "Spring", "sub_project": "SEC", "version": "1.0.0", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.ui.session.HttpSessionEventPublisherTests.java", "org.acegisecurity.ui.session.HttpSessionEventPublisher.java"], "label": 1, "es_results": []}, {"bug_id": 305, "bug_title": "HttpSessionContextIntegrationFilter to retain SecurityContext when rendering error pages", "bug_description": "This happens when you want to set up error pages as described in SRV.9.9.2 Error Pages in Java Servlet Specification\nVersion 2.4.\nIf for example want to display the current user name on an error page, the security context does not contain the authenticated user.\nThe reason is believed to be that HttpSessionContextIntegrationFilter is only applied once per request.\nSeehttp://forum.springframework.org/showthread.php?t=21534", "project": "Spring", "sub_project": "SEC", "version": "1.0.0", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.context.HttpSessionContextIntegrationFilter.java", "org.acegisecurity.context.HttpSessionContextIntegrationFilterTests.java"], "label": 1, "es_results": []}, {"bug_id": 321, "bug_title": "PathBasedFilterInvocationDefinitionMap ignores text after the last question mark instead of the first", "bug_description": "In some of our legacy code, we actually have URLs that contain successURLs as a request parameter. This means it is possible to have more than one question mark in the URL. For example,\n/Register?cmd=initial&Security_steps=All&Security_successUrl=https://localhost/appName/servletName?cmd=Start\nCheck out line 89 and 90 of PathBasedFilterInvocationDefinitionMap:\n// Strip anything after a question mark symbol, as per SEC-161.\nint firstQuestionMarkIndex = url.lastIndexOf(\"?\");\nShould this be changed to\nint firstQuestionMarkIndex = url.indexOf(\"?\");\nso that all query parameters are ignored?", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.intercept.web.PathBasedFilterDefinitionMapTests.java", "org.acegisecurity.intercept.web.PathBasedFilterInvocationDefinitionMap.java"], "label": 1, "es_results": []}, {"bug_id": 350, "bug_title": "Second access to database when NullUserCache is used", "bug_description": "I am use DaoAuthenticationProvider.\nWhen user enter right login and wrong  password, AbstractUserDetailsAuthenticationProvider makes 2 queries to database.\nThis happends when this class uses NullUserCache (by default) for user caching.\nIn these lines we load user details from database if there is no user in the cache (and remember that in cacheWasUsed) :\n        UserDetails user = this.userCache.getUserFromCache(username);\n        if (user == null) {\n            cacheWasUsed = false;\n            try \n{\n                user = retrieveUser(username,\n                    (UsernamePasswordAuthenticationToken) authentication);\n                    ......\n            }\n....\n        }\nBut when user enter wrong password we just load user one more time:\n       // This check must come here, as we don&apos;t want to tell users\n        // about account status unless they presented the correct credentials\n        try \n{\n            additionalAuthenticationChecks(user,\n                (UsernamePasswordAuthenticationToken) authentication);\n        }\n catch (AuthenticationException exception) \n{\n            // There was a problem, so try again after checking we&apos;re using latest data\n            cacheWasUsed = false;\n            user = retrieveUser(username,\n                    (UsernamePasswordAuthenticationToken) authentication);\n            additionalAuthenticationChecks(user,\n                (UsernamePasswordAuthenticationToken) authentication);\n        }", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.providers.dao.AbstractUserDetailsAuthenticationProvider.java"], "label": 1, "es_results": []}, {"bug_id": 290, "bug_title": "MethodInvocationUtils.createFromClass creates wrong MethodInvocation", "bug_description": "The utility class MethodInvocationUtils.createFromClass  creates a SimpleMethodInvocation but uses the parameter types as the object arguments. The proper signature should be: createFromClass(Class clazz, String methodName, Class[] classArgs, Object[] args).\nImpact is low because this class is not used in critical places.", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.intercept.method.MethodInvocationPrivilegeEvaluatorTests.java", "org.acegisecurity.util.MethodInvocationUtils.java"], "label": 1, "es_results": []}, {"bug_id": 328, "bug_title": "AbstractUserDetailsAuthenticationProvider makes two hits when no cache is used", "bug_description": "if you look at AbstractUserDetailsAuthenticationProvider.authenticate, you&apos;ll notice that in case of failure, Acegi suppose that it is due to a cache synchronization problem and make a second retrieveUser.\nBut if you use no cache, your information were already up to date and retrieveUser is still called...\nI think that this snippet (l. 148-151):\n // There was a problem, so try again after checking we&apos;re using latest data\ncacheWasUsed = false;\nuser = retrieveUser(username, (UsernamePasswordAuthenticationToken) authentication);\nadditionalAuthenticationChecks(user, (UsernamePasswordAuthenticationToken) authentication);\nhas to be changed to that :\nif(cacheWasUsed) \n{\n            // There was a problem, so try again after checking we&apos;re using latest data\n            cacheWasUsed = false;\n            user = retrieveUser(username, (UsernamePasswordAuthenticationToken) authentication);\n            additionalAuthenticationChecks(user, (UsernamePasswordAuthenticationToken) authentication);\n }\n else {\n            throw exception\n}\nIt&apos;ll avoid an useless double check...", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.providers.dao.AbstractUserDetailsAuthenticationProvider.java"], "label": 1, "es_results": []}, {"bug_id": 349, "bug_title": "RememberMeAuthenticationToken throws IllegalArgumentException on empty authorities list", "bug_description": "When a user is authenticated via remember me, in RememberMeAuthenticationToken:56 (called from TokenBasedRememberMeServices:190) an IllegalArgumentException is thrown if the user object has no authorities granted. This is inconsistent with other authentication schemes which allow authentications without granted authorities. I can&apos;t see any reason for throwing an exception in this case, because nothing is wrong with a user who is signed in and gets no authorities granted.", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.providers.rememberme.RememberMeAuthenticationTokenTests.java", "org.acegisecurity.providers.rememberme.RememberMeAuthenticationToken.java"], "label": 1, "es_results": []}, {"bug_id": 330, "bug_title": "UserMap should work with UserDetails, not User concrete class", "bug_description": "The UserMap.getUser method returns a User object, however the UserMap.addUser method takes in the UserDetails interface as a parameter.so if a user-defined class that implements the UserDetails interface is used a ClassCastException is exception is thrown since the object will not be of type Uer.\nThe suggested change to the getUser method is return the UserDetails interface along with actually changing the implementation of the getUserMethod from:\n     public User getUser(String username) throws UsernameNotFoundException {\n        User result = (User) this.userMap.get(username.toLowerCase());\n        if (result == null) \n{\n            throw new UsernameNotFoundException(\"Could not find user: \"\n                + username);\n        }\n        return result;\n    }\nTo \n    public User getUser(String username) throws UsernameNotFoundException {\n        UserDetails result = (UserDetails) this.userMap.get(username.toLowerCase());\n        if (result == null) \n{\n            throw new UsernameNotFoundException(\"Could not find user: \"\n                + username);\n        }\n        return result;\n    }", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.userdetails.memory.UserMap.java"], "label": 1, "es_results": []}, {"bug_id": 338, "bug_title": "Serialization Issues for Authentication implementations", "bug_description": "When used in a distributed environment, several Serialization issues have appeared. \n1. GrantedAuthority interface does not implement serializable, thus poses a potential problem for its implementations, when being sent over the wire.\n2. Authentication implementations do not explicitly overwride the serialVersionUID, which have caused a Serialization exception when different patch versions of acegi where loaded in the VM on different ends of the wire (1.0.0 and 1.0.1).  The problem was the AnonymousAuthenticationToken object which had an extra constructor added in one and not the other, but potential exists that any future minor or patch releases of the same major could alter the structure of the class, thus preventing it to serialize to a backwards-compatable lower version.", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.GrantedAuthorityImpl.java", "org.acegisecurity.providers.rememberme.RememberMeAuthenticationToken.java", "org.acegisecurity.providers.cas.CasAuthenticationToken.java", "org.acegisecurity.userdetails.User.java", "org.acegisecurity.ui.switchuser.SwitchUserGrantedAuthority.java", "org.acegisecurity.runas.RunAsUserToken.java", "org.acegisecurity.providers.jaas.JaasGrantedAuthority.java", "org.acegisecurity.adapters.PrincipalAcegiUserToken.java", "org.acegisecurity.providers.x509.X509AuthenticationToken.java", "org.acegisecurity.providers.TestingAuthenticationToken.java", "org.acegisecurity.GrantedAuthority.java", "org.acegisecurity.providers.anonymous.AnonymousAuthenticationToken.java", "org.acegisecurity.adapters.jetty.JettyAcegiUserToken.java", "org.acegisecurity.providers.UsernamePasswordAuthenticationToken.java", "org.acegisecurity.providers.jaas.JaasAuthenticationToken.java", "org.acegisecurity.userdetails.ldap.LdapUserDetailsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 348, "bug_title": "CASProvider tries to autenticate on every request", "bug_description": "I am using CAS provider with a httpinvoker based swing client, that sends _cas_stateless as\nusername and a ST as password (obtained directly from CAS). In the server side I use \ntwo filters: httpsessionintegrationFilter and basicProcessingFilter.\nIn the first time the basicProcessingFilter validates the ticket against CAS, and the\nsessionIntegration filter puts the autentication in the session, as desired.\nThe next time, the client sends the same jsessionId, the httpsessionintegrationfilter \ncorretly extracts the context from the previously created session but basic processing\nfilter tries to autenticate again (validade CAS ST AGAIN).\nThe line 138 of the class BasicProcessingFilter, it checks if it need to reauthenticate \nby checking (among other things) if the existingAuths username (obtained from session) is \nequals to the username that came from the HTTP Header. If they are not equal, the filter tries\nto reauthenticate. Since http headers username is always equals to \"cas_stateless\" and\nexistingAuths username is equals to the auhtenticated user, they are never the same, and the \nbasicprocessingfilter will try to validade the ticket again. The correct behaviour would be\nto just revalidate the ticket when the session does not carry a valid authentication anymore.", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.2", "fixed_files": ["org.acegisecurity.ui.basicauth.BasicProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 361, "bug_title": "<auth:authorize ifNotGranted=\"ROLE_ANONYMOUS\"> does not work sometimes", "bug_description": "web.xml:\n...........\n<error-page>\n  <error-code>404</error-code>\n  <location>/common/documentnotfound.do</location>\n</error-page>\n...........\nIf the requested page not found tomcat redirect user to the pointed url (documentnotfount.do) and in this case <auth:authorize ifNotGranted=\"ROLE_ANONYMOUS\"> doesn&apos;t work.\nSecurityContextHolder.getContext() = org.acegisecurity.context.SecurityContextImpl@ffffffff: Null authentication (AuthorizeTag.java: 129)\nSecurityContextHolder.getContext().getAuthentication() = null (AuthorizeTag.java: 129)\ngranted = [] (AuthorizeTag.java: 80)\nevaledIfNotGranted = ROLE_ANONYMOUS (AuthorizeTag.java: 82)\ngrantedCopy = [] (AuthorizeTag.java: 86)", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.3", "fixed_files": ["org.acegisecurity.context.HttpSessionContextIntegrationFilter.java", "org.acegisecurity.context.HttpSessionContextIntegrationFilterTests.java"], "label": 1, "es_results": []}, {"bug_id": 364, "bug_title": "TokenBasedRememberMeServices not properly using context path when setting cookie paths (SEC-206 only partially fixed) ", "bug_description": "SEC-206 addressed an issue to ensure the context path is properly used when setting remember me cookie paths by using the code:\ncookie.setPath(request.getContextPath());\nHowever, http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/http/HttpServletRequest.html#getContextPath() states that &apos;For servlets in the default (root) context, this method returns \"\" &apos;.\nAn empty cookie path results in inconsistent behavior between ie and firefox: ie presumes \"/\" whereas firefox presumes the leading path for the current request.\nIf request.getContextPath() returns \"\", the cookie path should be set to \"/\" to properly reflect a cookie set for the root context.\nThis fix should be applied to both methods: makeValidCookie and makeCancelCookie of TokenBasedRememberMeServices.", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.3", "fixed_files": ["org.acegisecurity.ui.rememberme.TokenBasedRememberMeServices.java"], "label": 1, "es_results": []}, {"bug_id": 355, "bug_title": "Scheme not supported in AbstractProcessingFilter.defaultTargetUrl", "bug_description": "The JavaDoc for AbstractProcessingFilter states that the defaultTargetUrl supports absolute URLs by starting with a scheme name (the JavaDoc says: The <code>defaultTargetUrl</code> will be treated as relative to the web-app&apos;s context path, and should include the leading <code>/</code>. Alternatively, inclusion of a scheme name (eg http:// or https://) as the prefix will denote a fully-qualified URL and this is also supported.)\nHowever, the actual code that builds the redirect URL looks like:\n            targetUrl = request.getContextPath() + getDefaultTargetUrl();\nand therefore the full URL just gets appended to the contextPath.\nAs an aside, it would also be useful if the code for determining the targetUrl was factored out so that it could be overridden easily. \nRegards,\nDamien", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.3", "fixed_files": ["org.acegisecurity.ui.AbstractProcessingFilter.java", "org.acegisecurity.ui.AbstractProcessingFilterTests.java", "org.acegisecurity.ui.webapp.SiteminderAuthenticationProcessingFilterTests.java"], "label": 1, "es_results": []}, {"bug_id": 359, "bug_title": "LogoutFilter ordering", "bug_description": "When a user does not have a session and attempts to logout, the LogoutFilter does nothing.  The is because the Authentication object returned from the SessionContext is null\n            Authentication auth = SecurityContextHolder.getContext().getAuthentication();\n            if (logger.isDebugEnabled()) \n{\n                logger.debug(\"Logging out user &apos;\" + auth + \"&apos; and redirecting to logout page\");\n            }\n\n            if (auth != null) {\n                for (int i = 0; i < handlers.length; i++) \n{\n                    handlers[i].logout(httpRequest, httpResponse, auth);\n                }\n            }\nThis happens because the SecurityContext was not read from the Session and the filters that make it available have not executed yet.\nBy moving the logoutFilter to after the rememberMeFilter, the problem seems to be resolved:\nhttpSessionContextIntegrationFilter,authenticationProcessingFilter,basicProcessingFilter,contextHolderAwareRequestFilter,rememberMeProcessingFilter,logoutFilter,anonymousProcessingFilter,exceptionTranslationFilter,filterInvocationInterceptor\nRegards,\nDamien", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.3", "fixed_files": ["org.acegisecurity.ui.logout.LogoutFilter.java"], "label": 1, "es_results": []}, {"bug_id": 356, "bug_title": "Changes to Authentication leak into synchronous requests when using HttpSessionContextIntegrationFilter", "bug_description": "HttpSessionContextIntegrationFilter will read an existing SecurityContext object from the session and attach it to the Http request thread by calling: SecurityContextHolder#setContext. This means that simultaneous requests get the same SecurityContext object. If one of those threads changes the authentication attached to the context (for example, to enable some \"Run As\" functionality such as in org.acegisecurity.intercept.AbstractSecurityInterceptor) that authentication will be seen to change in all the request threads and may enable those threads to be able to gain access that they shouldn&apos;t have.\n", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.3", "fixed_files": ["org.acegisecurity.context.HttpSessionContextIntegrationFilter.java"], "label": 1, "es_results": []}, {"bug_id": 378, "bug_title": "Authz taglib not working for group names with spaces", "bug_description": "I am evaluating Acegi and have it setup against our corporate Active Directory. Things seems to be working fine.\nBut, all our groups in AD contains spaces eg. \"CPHG AD ADMINS\". The authz taglib does not seem to support this?\nI can use eg. request.isUserInRole(\"CPHG AD ADMINS\") and all groups are listed if I print getAuthorities() from authentication.\nI tried creating a role with no spaces and it worked. \nIs there any reason not to support spaces in role/group names ?", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.3", "fixed_files": ["org.acegisecurity.taglibs.authz.AuthorizeTag.java", "org.acegisecurity.taglibs.authz.AuthorizeTagTests.java"], "label": 1, "es_results": []}, {"bug_id": 322, "bug_title": "SavedRequest : ClassCastException when calling parameters.get(paramName)", "bug_description": "If you are using WebSphere and IBM JSF, the following problem happens:\nThe fact that WebSphere container puts non-string array objects into the request parameter maps such as String object\ncauses ClassCastException when ExceptionTranslator instanciates a new SavedRequest instance, \nwhich executes the following code in its constructor(Line #113):\n//SavedRequest class\n.\n.\n.\n// Parameters\nMap parameters = request.getParameterMap();\nIterator paramNames = parameters.keySet().iterator();\nwhile (paramNames.hasNext()) {\n\tString paramName = (String) paramNames.next();\n\tString[] paramValues = (String[]) parameters.get(paramName);\n\tthis.addParameter(paramName, paramValues);\n}\n.\n.\n.\nSince it&apos;s happening in the constructor, I can&apos;t override this behavior,so \nI have to write my own SavedRequest class that does string-array type check before casting the returned value from the parameter map.\n//Custom SavedRequest class\n.\n.\n.\n// Parameters\nMap parameters = request.getParameterMap();\nIterator paramNames = parameters.keySet().iterator();\nwhile (paramNames.hasNext()) {\n\tString paramName = (String) paramNames.next();\n\tObject o =  parameters.get(paramName);\n\tif(o instanceof String[])\n{\n\t\tString[] paramValues = (String[])o;\n\t\tthis.addParameter(paramName, paramValues);\n\t}\n\telse\n{\n\t\t//log\n\t\t.\n\t\t.\n\t\t.\n\t}\n}\n.\n.\n.\nThe bad thing was I also had to modify other classes which referenced the original SavedRequest object.\nDo you think you can fix this issue in the next release?", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.3", "fixed_files": ["org.acegisecurity.ui.savedrequest.SavedRequest.java"], "label": 1, "es_results": []}, {"bug_id": 423, "bug_title": "CLONE -SEC 356 Introduces New Bug: Changes to Authentication leak into synchronous requests when using HttpSessionContextIntegrationFilter", "bug_description": "HttpSessionContextIntegrationFilter will read an existing SecurityContext object from the session and attach it to the Http request thread by calling: SecurityContextHolder#setContext. This means that simultaneous requests get the same SecurityContext object. If one of those threads changes the authentication attached to the context (for example, to enable some \"Run As\" functionality such as in org.acegisecurity.intercept.AbstractSecurityInterceptor) that authentication will be seen to change in all the request threads and may enable those threads to be able to gain access that they shouldn&apos;t have.\n", "project": "Spring", "sub_project": "SEC", "version": "1.0.1", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.context.HttpSessionContextIntegrationFilter.java"], "label": 1, "es_results": []}, {"bug_id": 375, "bug_title": "AuthorizedEvent published by before filter but not by after filter", "bug_description": "All of the interceptors (filter, method, aspectj) do a before pass and an after pass on the request. \nThe before and after filtering methods are shared among the filtere and are implemented in the base class AbstractSecurityInterceptor.\nThe method AbstractSecurityInterceptor.before publishes an AuthorizedEvent if the authorization is successful.\nThe method AbstractSecurityInterceptor.after \n    delegates to the afterInvocationManager\n    if you use the AfterInfocationProviderManager, that invokes a List of Providers in turn.\nThere is no AuthorizedEvent published if the authorization succeeds.   To be consistent, the AuthorizedEvent should be published whenever the authorization succeeds. ", "project": "Spring", "sub_project": "SEC", "version": "1.0.2", "fixed_version": "1.0.3", "fixed_files": ["org.acegisecurity.event.authorization.AuthorizationFailureEvent.java", "org.acegisecurity.intercept.AbstractSecurityInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 371, "bug_title": "AbstractTicketValidator should not use LogFactory.getLog(CasProxyTicketValidator.class)", "bug_description": "The first line in org.acegisecurity.providers.cas.ticketvalidator.AbstractTicketValidator contains\nLogFactory.getLog(CasProxyTicketValidator.class) \nIt should probably use\nLogFactory.getLog(AbstractTicketValidator.class).", "project": "Spring", "sub_project": "SEC", "version": "1.0.2", "fixed_version": "1.0.3", "fixed_files": ["org.acegisecurity.providers.cas.ticketvalidator.AbstractTicketValidator.java"], "label": 1, "es_results": []}, {"bug_id": 401, "bug_title": "AclEntryVoter and BasicAclEntryVoter use startsWith for configuration attribute matching", "bug_description": "AclEntryVoter and BasicAclEntryVoter both use String.startsWith(String) for determining whether they apply to a given secure object invocation. Instead equals(String) should be used.", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.vote.BasicAclEntryVoter.java", "org.acegisecurity.vote.AclEntryVoter.java"], "label": 1, "es_results": []}, {"bug_id": 404, "bug_title": "Logout when not logged in because NullPointerException", "bug_description": "When a user attempts to logout when they aren&apos;t logged in (e.g. when their session has expired) a NullPointerException occurs in TokenBasedRememberMeServices.logout(TokenBasedRememberMeServices.java:295).\nThe line that fails is:\n        cancelCookie(request, response, \"Logout of user \" + authentication.getName());\nI guess the cookie should still be cancelled, so the change might simply be to change the line to something like:\n        cancelCookie(request, response, \"Logout of user \" + authentication == null ? \"Unknown\" : authentication.getName());\nRegards,\nDamien", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.ui.rememberme.TokenBasedRememberMeServices.java"], "label": 1, "es_results": []}, {"bug_id": 438, "bug_title": "exceptionMappings in ProviderManager cannot be added from subclasses", "bug_description": "The subclasses of ProviderManager cannot add exceptionMappings to raise custom events on custom exceptions as the doAfterPropertiesSet() is passed DEFAULT_EXCEPTION_MAPPINGS instead of instance variable exceptionMappings.\nPlease also look at thread on the forums\nhttp://forum.springframework.org/showthread.php?t=35052\n", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.providers.ProviderManager.java"], "label": 1, "es_results": []}, {"bug_id": 478, "bug_title": "Incorrect decoding of base64 cookie value by TokenBasedRememberMeServices.autoLogin", "bug_description": "This bug can be observed by using the contact example application and trying to login with dianne/emu while using the \"remember me option\". This user mght not be remembered, as it is the case for other users. this, however, might not be reproductible under certain conditions.\nThe heart of the problem is that a user will not be remembered if the resulting base64 encoded value stored in in cookie has a number of significant caracters that is not an exact multiple of 4. In such condition, according to thee base64 specification, the value is padded with trailing \"=\". The result is a cookie value padded with \"%3D\", which is ok.\nWhen the cookie value is retrieved by the autoLogin method, the trailing \"=\" are lost. Although on might think this should be detected by Base64.Base64.isArrayByteBase64(), it is not because this method returns true if the value contains only valid character, even if the value itself is not valid.\nWorkaround :\nA simple workaround is to add the missing trailing \"=\" to the retrieved value, which can be done with the following code :\n  public Authentication autoLogin(HttpServletRequest request, HttpServletResponse response) {\n    Cookie[] cookies = request.getCookies();\n    if ((cookies == null) || (cookies.length == 0)) \n{\n      return null;\n    }\n\n    for (int i = 0; i < cookies.length; i++) {\n      if (ACEGI_SECURITY_HASHED_REMEMBER_ME_COOKIE_KEY.equals(cookies[i].getName())) {\n        String cookieValue = cookies[i].getValue();\n        /*************************\n          PATCH BEGINS HERE\n         *************************/\n        for (int j = 0; j < cookieValue.length() % 4; j++) \n{\n          cookieValue = cookieValue + \"=\";\n        }\n        /************************\n        PATCH ENDS HERE\n        *************************/\n        if (Base64.isArrayByteBase64(cookieValue.getBytes())) {\n          if (logger.isDebugEnabled()) \n{\n            logger.debug(\"Remember-me cookie detected\");\n          }\n\nFix: \nThe real fix would probably concern either Base64.decodeBase64 or Cookie.getValue", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.ui.rememberme.TokenBasedRememberMeServices.java"], "label": 1, "es_results": []}, {"bug_id": 474, "bug_title": "TokenBasedRememberMeServices fail with empty password", "bug_description": "In case of an empty password, the service fails because of the Assert.hasLength(password) in the loginSuccess method.\nFails heavily, with 500 page shown to the user.\nHowever I could not find any contract that the password can&apos;t be empty. Could you please change this behaviour to simply skip cookie creation in case of an empty username/password?\nLike:\n\t\tif (StringUtils.hasLength(username) && StringUtils.hasLength(password)) \n{\n\n\t\t\tlong expiryTime = System.currentTimeMillis()\n\t\t\t\t\t+ (getTokenValiditySeconds() * 1000);\n\t\t\t// And so on\n\t\t}", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.ui.rememberme.TokenBasedRememberMeServices.java"], "label": 1, "es_results": []}, {"bug_id": 461, "bug_title": "HttpSessionContextIntegrationFilter with cloneFromHttpSession = true causes problems at login", "bug_description": "The cloneFromHttpSession feature of the HttpSessionContextIntegrationFilter is fantastic - just what I needed, but it has a bug. \nOn line 172, it checks to see if the clone feature is turned on and then asserts that the context from the session is an instance of Cloneable.  However, the context from the session might be null at this point.  The check for cloneFromHttpSession should be moved inside the next if() statement so that it only checks when the context in the session is non-null. ", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.context.HttpSessionContextIntegrationFilter.java"], "label": 1, "es_results": []}, {"bug_id": 459, "bug_title": "Incorrect MessageSource constructor used", "bug_description": "Here&apos;s one example from BasicAclEntryAfterInvocationProvider:\n                if ((acls == null) || (acls.length == 0)) {\n                    throw new AccessDeniedException(messages.getMessage(\n                            \"BasicAclEntryAfterInvocationProvider.noPermission\",\n                            new Object[] \n{authentication.getName(), returnedObject}\n,\n                            \"Authentication \n{0}\n has NO permissions at all to the domain object \n{1}\n\"));\n                }\nIt&apos;s missing the locale parameter at the end, so it&apos;s using an unintended constructor resulting in the string being logged verbatim without the substitutions. This makes debugging any security problems very hard. \n", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.afterinvocation.BasicAclEntryAfterInvocationProvider.java"], "label": 1, "es_results": []}, {"bug_id": 453, "bug_title": "CasAuthenticationHandler does not log root because of AuthenticationException.", "bug_description": "Excerpt from org.acegisecurity.adapters.cas3.CasAuthenticationHandler&apos;s authenticateUsernamePasswordInternal() method:\n----- excerpt begin -----\ntry {\n  this.authenticationManager.authenticate(authenticationRequest);\n} catch (final org.acegisecurity.AuthenticationException e) {\n  if (log.isDebugEnabled()) \n{\n    log.debug(\"Authentication request for \" + credentials.getUsername() + \"failed: \" + e.toString());\n  }\n\n  return false;\n}\n------ excerpt end ------\nProblems (both with the log.debug() call):\n\nThe log.debug call does not print the stack trace.  This could be solved by changing the log.debug() call to:\n    log.debug(\"Authentication request for \" + credentials.getUsername() + \"failed: \", e);\nThere needs to be a space between the credentials.getUsername() and the word \"failed\".\n\n", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.adapters.cas3.CasAuthenticationHandler.java"], "label": 1, "es_results": []}, {"bug_id": 439, "bug_title": "AclEntryAfterInvocationProvider.decide() returns null when result object not applicable to the provider", "bug_description": "Maybe I&apos;m confused but I&apos;m using ACL_AFTER_READ to control access to instances of my DomainObjectAclAware objects.  In my afterAclRead bean I define:\n<property name=\"processDomainObjectClass\"><value>foo.DomainObjectAclAware</value></property>\nI stepped through code while retrieving an object that was not an instance of DomainObjectAclAware and the provider returned null anyway as if I do not have access to the object.  See lines 90-96 of org.acegisecurity.afterinvocation.AclEntryAfterInvocationProvider:\n                if (!getProcessDomainObjectClass().isAssignableFrom(returnedObject.getClass())) {\n                    if (logger.isDebugEnabled()) \n{\n                        logger.debug(\"Return object is not applicable for this provider, skipping\");\n                    }\n\n                    return null;\n                }\nShouldn&apos;t this return the object instead of null?", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.afterinvocation.AclEntryAfterInvocationProvider.java"], "label": 1, "es_results": []}, {"bug_id": 451, "bug_title": "Empty context path in LogoutFilter and AbstractProcessingFilter", "bug_description": "When context path is empty, LogoutFilter erroneously believes \"/anything/before/j_acegi_logout\" is a logout URL.  The requiresLogout() method should use uri.equals(request.getContextPath() + filterProcessesUrl) instead of uri.endsWith(request.getContextPath() + filterProcessesUrl), or more simple, uri.endsWith(filterProcessesUrl) to detect any URL ending with j_acegi_logout.", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.ui.AbstractProcessingFilter.java", "org.acegisecurity.ui.logout.LogoutFilter.java"], "label": 1, "es_results": []}, {"bug_id": 411, "bug_title": "SecurityContextHolderAwareRequestWrapper does not define required constructor", "bug_description": "SecurityContextHolderAwareRequestFilter requires that any request wrapper configured for it must provide a public constructor that accepts two arguments (HttpServletRequest and PortResolver). SecurityContextHolderAwareRequestWrapper does not provide this constructor.", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.wrapper.SecurityContextHolderAwareRequestWrapperTests.java", "org.acegisecurity.wrapper.SavedRequestAwareWrapper.java", "org.acegisecurity.wrapper.SecurityContextHolderAwareRequestWrapper.java"], "label": 1, "es_results": []}, {"bug_id": 419, "bug_title": "org.acegisecurity.afterinvocation.CollectionFilterer's logger error", "bug_description": "class CollectionFilterer implements Filterer {\n    //~ Static fields/initializers =====================================================================================\n    protected static final Log logger = LogFactory.getLog(BasicAclEntryAfterInvocationCollectionFilteringProvider.class);\nBasicAclEntryAfterInvocationCollectionFilteringProvider.class should be CollectionFilterer.class", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.4", "fixed_files": ["org.acegisecurity.afterinvocation.CollectionFilterer.java"], "label": 1, "es_results": []}, {"bug_id": 512, "bug_title": "Method FilterBasedLdapUserSearch#searchForUser(String username) creates an unsed  DirContext which never closed", "bug_description": "The org.acegisecurity.ldap.searchFilterBasedLdapUserSearch#searchForUser(String username)  method create an DirContext in the first line. This DirContext create/use a connection to ldap server. This DirContext is only used for an debug level log output. The great problem is that this DirContext is never closed and the ldap connection is not closed or released to connection pool. ", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.5", "fixed_files": ["org.acegisecurity.ldap.search.FilterBasedLdapUserSearch.java", "org.acegisecurity.ldap.search.FilterBasedLdapUserSearchTests.java"], "label": 1, "es_results": []}, {"bug_id": 502, "bug_title": "LabelBasedAclVoter Tests fail ", "bug_description": "Unit tests for LabelBasedAclVoter error on loading applicationcontest,\n(test resource org.acegisecurity.vote.labelBasedSecurityApplicationContext.xml).\nDue to the fact the with Spring 1.2.8 (not sure about other versions), an application context uses a \norg.apache.commons.collections.map.LinkedMap which implements java.util.Map, but not \njava.util.HashMap which org.acegisecurity.vote.LabelBasedAclVoter.setLabelMap(..) expects.\nSolution.\nchange org.acegisecurity.vote.LabelBasedAclVoter labelMap member var to be of type java.util.Map (was java.util.HashMap)\nand change signature of setLabelMap(..)\nfrom public void setLabelMap(HashMap labelMap)\nto  public void setLabelMap(Map labelMap)\n", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.5", "fixed_files": ["org.acegisecurity.vote.LabelBasedAclVoter.java", "org.acegisecurity.vote.LabelBasedAclVoterTests.java"], "label": 1, "es_results": []}, {"bug_id": 408, "bug_title": "Add getFilterProcessesUrl() to org.acegisecurity.ui.logout.LogoutFilter", "bug_description": "Please add a getFilterProcessesUrl() method to LogoutFilter to give sub-classes access to the filterProcessesUrl field.\nFor the JAMWiki project (jamwiki.org) we have a need to use a custom redirect, and therefore have created a subclass of LogoutFilter to implement a custom version of the sendRedirect() method.  Unfortunately this subclass cannot access the filterProcessesUrl field because it is private in the LogoutFilter class and there is no get method in LogoutFilter.  We have worked around the problem by extending the setFilterProcessesUrl() method in our subclass, but it would be much cleaner to just be able to call a parent getFilterProcessesUrl() method.", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.5", "fixed_files": ["org.acegisecurity.ui.logout.LogoutFilter.java"], "label": 1, "es_results": []}, {"bug_id": 549, "bug_title": "AuthenticationProcessingFilter should trim white space from user name", "bug_description": "When a user logs in with either leading or trailing white space in their user name, authentication still succeeds (we are using a org.acegisecurity.providers.ldap.authenticator.BindAuthenticator), authorities are correctly populated.  However the leading or trailing white space is never removed from the user name, so auth.getName() will include the white space.\nLater when JdbcMutableAclService searches for the ACL_SID table or inserts into the ACL_SID table the unwanted white space is used in the where clause or even worse in the insert (if the SID record is being created for the user).\nI&apos;m not 100% sure if the ACL queries are incorrect and should perform a trim() on the ACL_SID.sid column, or whether the problem is more fundamental, and the AuthenticationProcessingFilter should perform a trim() after it obtains the user name from the request.\nMy current thinking leads me to believe the AuthenticationProcessingFilter is at fault, and it should perform the trim() on the user name, as allowing trailing or leading white space in user names sounds like a recipe for confusion.\n", "project": "Spring", "sub_project": "SEC", "version": "1.0.3", "fixed_version": "1.0.6", "fixed_files": ["org.acegisecurity.ui.webapp.AuthenticationProcessingFilterTests.java", "org.acegisecurity.ui.webapp.AuthenticationProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 522, "bug_title": "LogoutFilter do not exclude query parameters in the matching test", "bug_description": "protected boolean requiresLogout(HttpServletRequest request, HttpServletResponse response) \n{\n        String uri = request.getRequestURI();\n        int pathParamIndex = uri.indexOf(&apos;;&apos;);\n//////////////////////////////////////\nreplace with :\nint pathParamIndex = uri.indexOf(&apos;?&apos;);\nor find the min of the index of &apos;?&apos;, &apos;=&apos;, ....\n////////////////////////////////////// \n        if (pathParamIndex > 0) \n{\n            // strip everything after the first semi-colon\n            uri = uri.substring(0, pathParamIndex);\n        }\n\n        if (\"\".equals(request.getContextPath())) \n{\n        \treturn uri.endsWith(filterProcessesUrl);\n        }\n\n        return uri.endsWith(request.getContextPath() + filterProcessesUrl);\n}\n", "project": "Spring", "sub_project": "SEC", "version": "1.0.4", "fixed_version": "1.0.5", "fixed_files": ["org.acegisecurity.ui.logout.LogoutFilter.java"], "label": 1, "es_results": []}, {"bug_id": 506, "bug_title": "DigestProcessingFilter improperly parsing Authorization request header when individual values contain commas", "bug_description": "DigestProcessingFilter improperly parses the Authorization request header. It converts the header to an array of strings based on the assumption that the individual values don&apos;t contain comma.\nI ran into the problem when the query string of a URL contained commas. RFC 1738 has the following to say about commas:\n    Thus, only alphanumerics, the special characters \"$-_.+!*&apos;(),\", and\n    reserved characters used for their reserved purposes may be used\n    unencoded within a URL.\nAs you can see, the comma is in the list of \"special characters\" that may be used unencoded.\nDigestProcessingFilter works correctly when I URL encode the commas but I should not be expected to encode the commas according to the RFC. Also, what about the other pieces of the Authorization header such as username, realm, etc? DigestProcessingFilter should properly handle the case when they contain commas.", "project": "Spring", "sub_project": "SEC", "version": "1.0.4", "fixed_version": "1.0.5", "fixed_files": ["org.acegisecurity.ui.digestauth.DigestProcessingFilterTests.java", "org.acegisecurity.util.StringSplitUtils.java", "org.acegisecurity.util.StringSplitUtilsTests.java", "org.acegisecurity.ui.digestauth.DigestProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 501, "bug_title": "convertUrlToLowercaseBeforeComparison in PathBasedFilterInvocationDefinitionMap  is not consistent", "bug_description": "if convertUrlToLowercaseBeforeComparison is true the url is converted to lower case before URL comparison but the pathMatcher still use the URL defined in the configurations without using toLowerCase and this may lead insorrect result \nsee this forum for more details http://forum.springframework.org/showthread.php?t=39492", "project": "Spring", "sub_project": "SEC", "version": "1.0.4", "fixed_version": "1.0.5", "fixed_files": ["org.acegisecurity.intercept.web.PathBasedFilterDefinitionMapTests.java", "org.acegisecurity.intercept.web.PathBasedFilterInvocationDefinitionMap.java"], "label": 1, "es_results": []}, {"bug_id": 500, "bug_title": "Provide a getFilterProcessesUrl (protected or public) method in org.acegisecurity.ui.logout.LogoutFilter so that subclasses can access this parameter", "bug_description": "Provide a getFilterProcessesUrl (protected or public) method in org.acegisecurity.ui.logout.LogoutFilter so that subclasses can access this parameter.", "project": "Spring", "sub_project": "SEC", "version": "1.0.4", "fixed_version": "1.0.5", "fixed_files": ["org.acegisecurity.ui.logout.LogoutFilter.java"], "label": 1, "es_results": []}, {"bug_id": 636, "bug_title": "ref attribute of PasswordEncoderParser not implemented and causes exception to occur", "bug_description": "The implementation of PasswordEncoderParser doesn&apos;t seem to support the ref attribute and an exception will occur when the ref attribute is specified.\nSuggested implementation and more details  : http://forum.springframework.org/showthread.php?t=48779", "project": "Spring", "sub_project": "SEC", "version": "2.0.0.M1", "fixed_version": "2.0.0.M2", "fixed_files": ["org.springframework.security.config.PasswordEncoderParser.java"], "label": 1, "es_results": []}, {"bug_id": 630, "bug_title": "The \"properties\" attribute of the <user-service> element does not do anything", "bug_description": "The properties attribute of the user-service element is included in the XML schema, but UserServiceBeanDefinitionParser never looks at it.\nThe attached patch implements this; as implemented, the properties attribute takes precedence over nested <user> elements.", "project": "Spring", "sub_project": "SEC", "version": "2.0.0.M1", "fixed_version": "2.0.0.M2", "fixed_files": ["org.springframework.security.config.UserServiceBeanDefinitionParser.java", "org.springframework.security.config.BeanIds.java"], "label": 1, "es_results": []}, {"bug_id": 644, "bug_title": "NtlmProcessingFilter broken", "bug_description": "NtlmProcessingFilter no longer calls chain.doFilter(request, response) to progress down the filter chain.\nThis was broken when it was changed to subclass SpringSecurityFilter instead of HttpFilter", "project": "Spring", "sub_project": "SEC", "version": "2.0.0.M1", "fixed_version": "2.0.0.M2", "fixed_files": ["org.springframework.security.ui.ntlm.NtlmProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 662, "bug_title": "ProviderManager should not pass null authenitication to ConcurrentSessionController.checkAuthenticationAllowed()", "bug_description": "It is valid for an AuthenticationProvider to return null, but this will cause ConcurrentSessionController to throw an exception. An extra null check is needed in ProviderManager.doAuthentication", "project": "Spring", "sub_project": "SEC", "version": "2.0.0.M1", "fixed_version": "2.0.0.M2", "fixed_files": ["org.springframework.security.providers.ProviderManager.java"], "label": 1, "es_results": []}, {"bug_id": 725, "bug_title": "PasswordEncoderParser: <security:password-encoder> element does not pick up 'base64' attribute value", "bug_description": "In my Spring configuration I have the following fragment:\nCode:\n<security:authentication-provider>\n    <security:password-encoder hash=\"md5\" base64=\"true\"/>\n    ......\n</security:authentication-provider>\nThe problem is that even although I specified base64=\"true\" the configuration parser does not pick it up. My PasswordEncoder is still installed with &apos;encodeHashAsBase64&apos; property &apos;false&apos;.\nAnalysis: After debugging I was able to locate the reason for the bug. It is located on the line 73 of class org.springframework.security.config.PasswordEncoderParser in the method parse(Element element, ParserContext parserContext)\nThis code goes like this:\nCode:\nprivate void parse(Element element, ParserContext parserContext) {\n    ...\n    if (StringUtils.hasText(ref)) \n{\n            ....\n    }\n else {\n      Class beanClass = (Class) ENCODER_CLASSES.get(hash);\n      RootBeanDefinition beanDefinition = new RootBeanDefinition(beanClass);\n      beanDefinition.setSource(parserContext.extractSource(element));\n      if (useBase64) {\n         if (beanClass.isAssignableFrom(BaseDigestPasswordEncoder.class)) \n{\n            beanDefinition.getPropertyValues().addPropertyValue(\"encodeHashAsBase64\", \"true\");\n         }\n else \n{\n            logger.warn(ATT_BASE_64 + \" isn&apos;t compatible with \" + OPT_HASH_LDAP_SHA + \" and will be ignored\");\n         }\n      }\n      passwordEncoder = beanDefinition;\n  }\nThe problematic part is here:\nif (beanClass.isAssignableFrom(BaseDigestPasswordEncod er.class)) {\nbeanDefinition.getPropertyValues().addPropertyValue(\"encodeHashAsBase64\", \"true\");\n} else {\nlogger.warn(ATT_BASE_64 + \" isn&apos;t compatible with \" + OPT_HASH_LDAP_SHA + \" and will be ignored\");\n}\nThe condition in the &apos;if&apos; statement should be coded the other way around, i.e.\nif (BaseDigestPasswordEncoder.class.isAssignableFrom(b eanClass))\n{...}\n to set up \"encodeHashAsBase64\" properly.\nAlso: the warning message in the &apos;else&apos; clause of &apos;if&apos; statment above is incorrect too. No matter what algorithm you configure in your <securityassword-encoder> it always outputs &apos;\n{sha}\n&apos;. The reason is that insead of the runtime &apos;hash&apos; parameter the message hardcodes OPT_HASH_LDAP_SHA.", "project": "Spring", "sub_project": "SEC", "version": "2.0.0.M2", "fixed_version": "2.0.0.RC1", "fixed_files": ["org.springframework.security.config.PasswordEncoderParser.java", "org.springframework.security.config.AuthenticationProviderBeanDefinitionParserTests.java"], "label": 1, "es_results": []}, {"bug_id": 676, "bug_title": "Children Acls are not removed from cache when parent is deleted", "bug_description": "Calling jdbcMutableAclService.deleteAcl(parentOid, true) should remove the parent acl and, also, its children. The records are deleted from database, but the children related entries from cache are not removed.\nThe element in cache was built using an ObjectIdentityImpl that received as parameters a string as class name and a Long as domain object id. But, calling JdbcAclService.findChildren() the domain objects returned are created using two strings as parameters and because of this the children are not found in cache and, thus, not removed.\nA possible solution could be the creation of ObjectIdentityImpl objects in JdbcAclService.findChildren() method using a Long as the id of the domain object.\nThe test method demonstrating this behavior is found JdbcAclServiceTests - testDeleteAclAlsoDeletesChildren.", "project": "Spring", "sub_project": "SEC", "version": "2.0.0.M1", "fixed_version": "2.0.0", "fixed_files": ["org.springframework.security.acls.jdbc.JdbcAclService.java", "org.springframework.security.acls.jdbc.JdbcAclServiceTests.java"], "label": 1, "es_results": []}, {"bug_id": 655, "bug_title": "When inserting ACE's in a parent ACL it is possible to end up with a child ACL that has a stale reference to its parent", "bug_description": "The JdbcMutableAclService in its updateAcl method evicts the ObjectIdentity from the cache. However, it should probably evict child ObjectIdentities too whose parent ACL now is no longer in cache.", "project": "Spring", "sub_project": "SEC", "version": "2.0.0.M1", "fixed_version": "2.0.0", "fixed_files": ["org.springframework.security.acls.jdbc.JdbcAclService.java", "org.springframework.security.acls.jdbc.JdbcMutableAclService.java", "org.springframework.security.acls.jdbc.JdbcAclServiceTests.java"], "label": 1, "es_results": []}, {"bug_id": 754, "bug_title": "Wrong byte array lenght used in Md4PasswordEncoder#encodePassword", "bug_description": "Part of patch for bug #SEC-728 has been incorrectly applied.\nThe line\nmd4.update(passBytes, 0, saltedPass.length());\nshould read\nmd4.update(passBytes, 0, passBytes.length());\nThe current (2.0RC1) version is incorrect, since the number of chars in an UTF-8 string is generally NOT equal to it number of bytes!", "project": "Spring", "sub_project": "SEC", "version": "2.0.0.RC1", "fixed_version": "2.0.0", "fixed_files": ["org.springframework.security.providers.encoding.Md5PasswordEncoderTests.java", "org.springframework.security.providers.encoding.Md4PasswordEncoderTests.java", "org.springframework.security.providers.encoding.Md4PasswordEncoder.java"], "label": 1, "es_results": []}, {"bug_id": 750, "bug_title": "Support for JPA PersistenceContext annotation broken", "bug_description": "When Spring Security is used, JPA annotations auto-wiring is not supported : the @PersistenceContext EntityManager is not injected in the DAO layer, which results in NullPointerExceptions\n", "project": "Spring", "sub_project": "SEC", "version": "2.0.0.RC1", "fixed_version": "2.0.0", "fixed_files": ["org.springframework.security.config.HttpSecurityConfigPostProcessor.java", "org.springframework.security.config.ConfigUtils.java", "org.springframework.security.config.HttpSecurityBeanDefinitionParserTests.java", "org.springframework.security.config.HttpSecurityBeanDefinitionParser.java", "org.springframework.security.config.BeanIds.java"], "label": 1, "es_results": []}, {"bug_id": 768, "bug_title": "Namespace throws IllegalStateException if no namespace filters are used and a entry-point-ref is not set", "bug_description": "The cas client sample is an example. It doesn&apos;t use basic, form or OpenID login through the namespace. An error should be reported through the parserContext rather than throwing an exception.", "project": "Spring", "sub_project": "SEC", "version": "2.0.0.RC1", "fixed_version": "2.0.0", "fixed_files": ["org.springframework.security.config.HttpSecurityBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 788, "bug_title": "x509 authentication does not work properly", "bug_description": "x509 authentication does not work properly\nI have an application with x509 authentication configured.\nFirst:\nIn RC1 release my application startup properly. In final 2.0.0 release this exception occur:\norg.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: No AuthenticationEntryPoint could be established.\nIf I write the entry point bean like this:\n<bean id=\"x509EntryPoint\" class=\"org.springframework.security.ui.x509.X509ProcessingFilterEntryPoint\" />\neverything work properly.\nI think 2.0.0 should work automatic like RC1 \"OR\" x509 documentation section in the reference manual should document it.\nSecond:\nWhen I do the first login with x509 certificate in my application, a 403 http status code occurs.\nThis happens only if a http->https redirection is needed. \nExample:\nFirst page is \"IS_AUTHENTICATED_ANONYMOUSLY\" and HTTP. Then user goes to a secure page over HTTPS.\nThe browser dialog appers to select the certificate. Then a 403 occur.\nIf the first page is HTTPS everything work properly.\nI will attach the applicationContext and the error log.\nSorry for my bad english.", "project": "Spring", "sub_project": "SEC", "version": "2.0.0", "fixed_version": "2.0.1", "fixed_files": ["org.springframework.security.config.HttpSecurityBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 783, "bug_title": "GlobalMethodSecurityBeanDefinitionParser should support AfterInvocationProviders", "bug_description": "Even I define an AfterInvocationProviderManager, it can&apos;t be auto-wired into the MethodSecurityInterceptor when I use <global-method-security> to secure methods with @Secured. So the AfterInvocationProviders don&apos;t work with the @Secured annotations. I can only use <security:intercept-methods> to have my AfterInvocationProviders work!", "project": "Spring", "sub_project": "SEC", "version": "2.0.0", "fixed_version": "2.0.1", "fixed_files": ["org.springframework.security.config.ConfigUtils.java", "org.springframework.security.config.SecurityNamespaceHandler.java", "org.springframework.security.config.Elements.java", "org.springframework.security.config.BeanIds.java", "org.springframework.security.config.GlobalMethodSecurityBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 787, "bug_title": "ACL SQL statements have inconsistent use of case (mixed upper and  lower).", "bug_description": "SQL statements in ACL package have mixed upper and lower case table names.  This causes problems on case sensitive systems such as linux.", "project": "Spring", "sub_project": "SEC", "version": "2.0.0", "fixed_version": "2.0.1", "fixed_files": ["org.springframework.security.acls.jdbc.JdbcAclService.java", "org.springframework.security.acls.jdbc.JdbcMutableAclService.java", "org.springframework.security.acls.jdbc.BasicLookupStrategy.java"], "label": 1, "es_results": []}, {"bug_id": 792, "bug_title": "Filters should only be added to the default stack if they are labelled using custom-filter.", "bug_description": "At the moment FilterChainProxyPostProcessor is adding any filters whose class names begin with org.springframework.security. A user may have a separate FilterChainProxy configured with different filters and these shouldn&apos;t be added to the namespace instance. The list of filter beans should be registered independently and added to by custom-filter and the namespace parser. This separate list should be used for the final configuration of the namespace FilterChainProxy instance.", "project": "Spring", "sub_project": "SEC", "version": "2.0.0", "fixed_version": "2.0.1", "fixed_files": ["org.springframework.security.config.HttpSecurityBeanDefinitionParserTests.java", "org.springframework.security.config.FilterChainProxyPostProcessor.java", "org.springframework.security.config.OrderedFilterBeanDefinitionDecorator.java", "org.springframework.security.config.HttpSecurityBeanDefinitionParser.java", "org.springframework.security.config.RememberMeBeanDefinitionParser.java", "org.springframework.security.config.ConfigUtils.java", "org.springframework.security.config.BasicAuthenticationBeanDefinitionParser.java", "org.springframework.security.config.ConcurrentSessionsBeanDefinitionParser.java", "org.springframework.security.config.LogoutBeanDefinitionParser.java", "org.springframework.security.config.AnonymousBeanDefinitionParser.java", "org.springframework.security.config.X509BeanDefinitionParser.java", "org.springframework.security.config.BeanIds.java"], "label": 1, "es_results": []}, {"bug_id": 793, "bug_title": "ldap-authentication-provider element parser ignores hash attribute.", "bug_description": "The parser only handles the <password-encoder> child element. Probably the attribute should have been left out of the namespace schema, but since it&apos;s there we need to handle it. The workaround is to use password-encoder.", "project": "Spring", "sub_project": "SEC", "version": "2.0.0", "fixed_version": "2.0.1", "fixed_files": ["org.springframework.security.config.LdapProviderBeanDefinitionParserTests.java", "org.springframework.security.config.LdapProviderBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 1224, "bug_title": "BasicLookupStrategy, JdbcAclService, and JdbcMutableAclService should support Catalog and Schema", "bug_description": "Some systems may have security objects and normal application objects seperated in to different domains, and those domains may be defined in different database catalogs and/or schemas.\nThe BasicLookupStrategy, JdbcAclService, and JdbcMutableAclService classes should account for a database catalog and schema.  A developer and/or integrator should be able to specify the catalog and schema for said classes when defining the beans in their context configurations.", "project": "Spring", "sub_project": "SEC", "version": "2.0.0", "fixed_version": "3.0.0.RC1", "fixed_files": ["org.springframework.security.acls.jdbc.JdbcAclService.java", "org.springframework.security.acls.jdbc.JdbcMutableAclService.java", "org.springframework.security.acls.jdbc.BasicLookupStrategy.java"], "label": 1, "es_results": []}, {"bug_id": 818, "bug_title": "SEC-757 fix breakes scenarios with using property placeholders in URL definitions", "bug_description": "We are using property placeholders for configuring well known application URLs in application condex descriptor. \nfor example:\n\t<bean id=\"applicationPropertyPlaceholderConfigurer\" class=\"org.springframework.web.context.support.ServletContextPropertyPlaceholderConfigurer\">\n\t\t<property name=\"properties\">\n\t\t\t<value>\n\t\t\t\tloginPath=/login\n\t\t\t\tlogoutPath=/logout\n\t\t\t</value>\n\t\t</property>\n\t</bean>\n \t<util:map id=\"exportSymbols\">\n\t\t<entry key=\"application.logoutURI\" value=\"$\n{logoutPath}\"/>\n\t</util:map>\n\n\t<security:http  access-decision-manager-ref=\"accessDecisionManager\" path-type=\"regex\" realm=\"TAO Realm\">\n\t\t<security:logout logout-url=\"${logoutPath}\n\"/>\n\t</security:http>\nSo, we need to define real URI once, and do not bothering if it will cahnge later. But SEC-757 fix do not allow using placeholders more, becouse now spring-security checks URLs for validity. Plese, can you check URI for validity after PropertyPlaceholderConfigurer done his job.", "project": "Spring", "sub_project": "SEC", "version": "2.0.1", "fixed_version": "2.0.2", "fixed_files": ["org.springframework.security.concurrent.ConcurrentSessionFilter.java", "org.springframework.security.config.HttpSecurityBeanDefinitionParserTests.java", "org.springframework.security.ui.AbstractProcessingFilter.java", "org.springframework.security.config.ConfigUtils.java", "org.springframework.security.ui.AccessDeniedHandlerImpl.java", "org.springframework.security.ui.logout.LogoutFilter.java", "org.springframework.security.util.UrlUtils.java"], "label": 1, "es_results": []}, {"bug_id": 817, "bug_title": "NPE in org.springframework.security.config.FilterChainProxyPostProcessor", "bug_description": "The NPE occurs in the method \"FilterChainProxyPostProcessor.postProcessBeforeInitialization\" when the beanName argument is null. In my case this argument is null when using beans that are configured using the @Configurable annotation and the AspectJ AnnotationBeanConfigurerAspect.\nI also noticed that this NPE might happen in the other BeanPostProcessor implementations in spring-security. An easy fix would be to change the order of operands in the string comparison: beanName.equals(BeanIds.FILTER_CHAIN_PROXY) => BeanIds.FILTER_CHAIN_PROXY.equals(beanName)", "project": "Spring", "sub_project": "SEC", "version": "2.0.1", "fixed_version": "2.0.2", "fixed_files": ["org.springframework.security.config.MethodSecurityInterceptorPostProcessor.java", "org.springframework.security.config.FilterChainProxyPostProcessor.java", "org.springframework.security.config.RememberMeServicesInjectionBeanPostProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 822, "bug_title": "TokenBasedRememberMeServices calculate expiryTime: explicit cat to long is needed", "bug_description": "\npublic class TokenBasedRememberMeServices extends AbstractRememberMeServices {\n  public void onLoginSuccess(HttpServletRequest request,\n      HttpServletResponse response, Authentication successfulAuthentication) {\n    String username = retrieveUserName(successfulAuthentication);\n    String password = retrievePassword(successfulAuthentication);\n    // If unable to find a username and password, just abort as\n    // TokenBasedRememberMeServices is\n    // unable to construct a valid token in this case.\n    if (!StringUtils.hasLength(username) || !StringUtils.hasLength(password)) \n{\n      return;\n    }\n\n    int tokenLifetime = calculateLoginLifetime(request,\n        successfulAuthentication);\n    long expiryTime = System.currentTimeMillis() + 1000 * tokenLifetime;\n    String signatureValue = makeTokenSignature(expiryTime, username, password);\n    setCookie(new String[] \n{ username, Long.toString(expiryTime),\n        signatureValue }\n, tokenLifetime, request, response);\n    if (logger.isDebugEnabled()) \n{\n      logger.debug(\"Added remember-me cookie for user &apos;\" + username\n          + \"&apos;, expiry: &apos;\" + new Date(expiryTime) + \"&apos;\");\n    }\n  }\n}\ntokenLifetime is an integer. When the tokenLifetime is 1 month => value = 2678400 seconds => 1000 * 2678400 > Integer.MAX_VALUE => negative integer.\nIn the calculation, there should be an explicit cast to long\nSo \nlong expiryTime = System.currentTimeMillis() + 1000 * tokenLifetime;\nshould be \nlong expiryTime = System.currentTimeMillis() + 1000 * [B](long)[/B] tokenLifetime;", "project": "Spring", "sub_project": "SEC", "version": "2.0.1", "fixed_version": "2.0.2", "fixed_files": ["org.springframework.security.ui.rememberme.TokenBasedRememberMeServices.java", "org.springframework.security.ui.rememberme.TokenBasedRememberMeServicesTests.java"], "label": 1, "es_results": []}, {"bug_id": 837, "bug_title": "SpringSecurityLdapTemplate.searchForSingleAttributeValues, no string escape for formattedFilter", "bug_description": "When formattedFilter looks like this: (member=CN=Jozwicki\\, Jakub, ou=IT, dc=example, dc=com)\n\nplease notice \"\\\" before first comma, search doesn&apos;t return any results.\n\nI don&apos;t know if it is MS AD specific but I had to add code replacing \\ with :\nString formattedFilter = MessageFormat.format(filter, params);\nformattedFilter = formattedFilter.replaceAll(\"\\\\\\\\\", \"\\\\\\\\\\\\\\\\\");\n-------\nStandalone code:\npublic class LDAPSearch {\n\tpublic final static void main(String[] args) throws Exception {\n\t\tHashtable env = new Hashtable();\n\t\tenv.put(Context.INITIAL_CONTEXT_FACTORY, \"com.sun.jndi.ldap.LdapCtxFactory\");\n\t\tenv.put(Context.PROVIDER_URL, \"ldap://192.168.1.191:389\");\n\t\tenv.put(Context.SECURITY_PRINCIPAL, \"pld1jjozwic\");\n\t\tenv.put(Context.SECURITY_CREDENTIALS, \"*******\");\n\t\tDirContext ctx = new InitialDirContext(env);\n\t\tSearchControls controls = new SearchControls();\n\t\tcontrols.setSearchScope(SearchControls.SUBTREE_SCOPE);\n\t\tcontrols.setReturningObjFlag(true);\n\t\tcontrols.setReturningAttributes(null);\n\t\tNamingEnumeration result = ctx.search(\"dc=pld1,dc=net\", \"(member=CN=Jozwicki\\\\\\\\, Jakub, OU=IT, DC=pld1, DC=net)\", controls);\n\t\twhile (result.hasMoreElements()) \n{\n\t\t\tSystem.out.println(result.next()+\"\\n\");\n\t\t}\n \n\t}\n}\nproved that  is needed.", "project": "Spring", "sub_project": "SEC", "version": "2.0.1", "fixed_version": "2.0.2", "fixed_files": ["org.springframework.security.ldap.SpringSecurityLdapTemplateTests.java", "org.springframework.security.ldap.populator.DefaultLdapAuthoritiesPopulatorTests.java", "org.springframework.security.ldap.search.FilterBasedLdapUserSearchTests.java", "org.springframework.security.ldap.SpringSecurityLdapTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 835, "bug_title": "SEC-790 changes incompatible with J2EE 1.3", "bug_description": "The changes made for issue SEC-790 break the DefaultLoginPageGeneratingFilter under J2EE 1.3.  Line 79 in DefaultLoginPageGeneratingFilter uses the setCharacterEncoding method, which was introduced in J2EE 1.4.  The same thing can be accomplished with the setContentType method instead, with response.setContentType(\"text/html; charset=utf-8\").", "project": "Spring", "sub_project": "SEC", "version": "2.0.1", "fixed_version": "2.0.2", "fixed_files": ["org.springframework.security.ui.webapp.DefaultLoginPageGeneratingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 850, "bug_title": "custom-authentication-provider Registering Separate Bean Definitions in App Context and Providers List", "bug_description": "I&apos;m seeing multiple instances of the LdapAuthenticationProvider bean when using the traditional bean config. In the namespace config I only see one instance. \nSo in the samples-ldap app I&apos;m seeing two instances when using the traditional bean config w/ the namespace config commented out and the scope=\"singleton\" attribute applied to the secondLdapProvider bean definition. \nIn my app I&apos;m seeing three instances of the LdapAuthenticationProvider bean. It&apos;s like the prototype scope is getting applied.  There&apos;s one instance that&apos;s getting used for authentication, a second instance for a dependency injection bean, not sure about the third instance. I only want ONE shared instance of the LdapAuthenticationProvider bean.", "project": "Spring", "sub_project": "SEC", "version": "2.0.1", "fixed_version": "2.0.2", "fixed_files": ["org.springframework.security.config.CustomAuthenticationProviderBeanDefinitionDecoratorTests.java", "org.springframework.security.config.CustomAuthenticationProviderBeanDefinitionDecorator.java"], "label": 1, "es_results": []}, {"bug_id": 856, "bug_title": "GroupManager JdbcUserDetailsManager implementation: addGroupAuthority() method does not work.", "bug_description": "In addGroupAuthority(String groupName, GrantedAuthority authority) there is wrong parameter type in FindGroupIdQuery. Must be VARCHAR instead of INTEGER.\nprivate class FindGroupIdQuery extends MappingSqlQuery {\n        public FindGroupIdQuery(DataSource ds) \n{\n            super(ds, findGroupIdSql);\n            declareParameter(new SqlParameter(Types.INTEGER));\n            compile();\n        }\n\n        protected Object mapRow(ResultSet rs, int rowNum) throws SQLException \n{\n            return new Integer(rs.getInt(1));\n        }\n    }", "project": "Spring", "sub_project": "SEC", "version": "2.0.1", "fixed_version": "2.0.2", "fixed_files": ["org.springframework.security.userdetails.jdbc.JdbcUserDetailsManager.java"], "label": 1, "es_results": []}, {"bug_id": 864, "bug_title": "Duplicate OpenID providers being registered by HttpSecurityBeanDefinitionParser", "bug_description": "There should only be the one. Currently a separate instance is being added to the AuthenticationManager and isn&apos;t being injected with a UserDetailsService", "project": "Spring", "sub_project": "SEC", "version": "2.0.1", "fixed_version": "2.0.2", "fixed_files": ["org.springframework.security.config.HttpSecurityBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 819, "bug_title": "Integer IDs are not supported despite documentation ensures they are", "bug_description": "The documentation (reference) says that int domain object ids are supported (Chapter 23.3):\n\"Hopefully ObjectIdentityImpl will prove sufficient, as it provides a large number of ways in which it can be used. Most\npeople will have domain objects that contain a public Serializable getId() method. If the return type is\nlong, or compatible with long (eg an int), you will find you need not give further consideration to\nObjectIdentity issues.\"\nUnfortunately I&apos;m getting assertion failures when using ints as IDs:\njava.lang.IllegalArgumentException: This class requires ObjectIdentity.getIdentifier() to be a LongObject of class [java.lang.Integer] must be an instance of class java.lang.Long\n\torg.springframework.util.Assert.isInstanceOf(Assert.java:337)\n\torg.springframework.security.acls.jdbc.BasicLookupStrategy$1.setValues(BasicLookupStrategy.java:296)\n\torg.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:621)\n\torg.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:566)\n\torg.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:616)\n\torg.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:645)\n\torg.springframework.security.acls.jdbc.BasicLookupStrategy.lookupObjectIdentities(BasicLookupStrategy.java:289)\n\torg.springframework.security.acls.jdbc.BasicLookupStrategy.readAclsById(BasicLookupStrategy.java:421)\n\torg.springframework.security.acls.jdbc.JdbcAclService.readAclsById(JdbcAclService.java:114)\n\torg.springframework.security.acls.jdbc.JdbcAclService.readAclById(JdbcAclService.java:99)", "project": "Spring", "sub_project": "SEC", "version": "2.0.1", "fixed_version": "2.0.3", "fixed_files": ["org.springframework.security.acls.jdbc.JdbcAclServiceTests.java", "org.springframework.security.acls.jdbc.BasicLookupStrategyTests.java", "org.springframework.security.acls.jdbc.BasicLookupStrategy.java", "org.springframework.security.acls.objectidentity.ObjectIdentityImpl.java"], "label": 1, "es_results": []}, {"bug_id": 831, "bug_title": "JdbcAclService incompatible with postgres", "bug_description": "JdbcAclService contains the following definition:\nprivate static final String selectAclObjectWithParent = \"select obj.object_id_identity obj_id, class.class class \"\n        + \"from acl_object_identity obj, acl_object_identity parent, acl_class class \"\n        + \"where obj.parent_object = parent.id and obj.object_id_class = class.id \"\n        + \"and parent.object_id_identity = ? and parent.object_id_class = (\"\n        + \"select id FROM acl_class where acl_class.class = ?)\";\nPostgres cannot execute this query as it requires the AS keyword for aliasing.\nThe following query works in postgres:\nselect obj.object_id_identity AS obj_id, class.class AS class  from acl_object_identity obj, acl_object_identity parent, acl_class class where obj.parent_object = parent.id and obj.object_id_class = class.id and parent.object_id_identity = ? and parent.object_id_class = (select id FROM acl_class where acl_class.class = ?)\nIt would be desirable if this and other sql statements were configurable.", "project": "Spring", "sub_project": "SEC", "version": "2.0.1", "fixed_version": "2.0.3", "fixed_files": ["org.springframework.security.acls.jdbc.JdbcAclService.java", "org.springframework.security.acls.jdbc.JdbcMutableAclService.java"], "label": 1, "es_results": []}, {"bug_id": 832, "bug_title": "NamingEnumeration.hasMore fails on MS AD with PartialResultException", "bug_description": "Implementation of org.springframework.security.ldap.searchForSingleEntry doesn&apos;t work with MS AD.\nWhen calling results.hasMore with base=\"\" a PartialResultException is thrown. The call hasMore should\nbe replaced with hasMoreElements() and whole method should look like this:\npublic DirContextOperations searchForSingleEntry(final String base, final String filter, final Object[] params) {\n        return (DirContextOperations) executeReadOnly(new ContextExecutor() {\n\t\t\t        public Object executeWithContext(DirContext ctx)\n\t\t\t            throws NamingException {\n\t\t\t            try {\n\t\t\t\t\t\t\tNamingEnumeration results = ctx.search(base, filter, params, searchControls);\n\t\t\t\t\t\t\tif (!results.hasMoreElements())\n\t\t\t\t\t\t\t\tthrow new IncorrectResultSizeDataAccessException(1, 0);\n\t\t\t\t\t\t\tSearchResult searchResult = (SearchResult) results.next();\n\t\t\t\t\t\t\tlogger.debug(\"searchResult=\"+searchResult);\n\t\t\t\t\t\t\tif (results.hasMoreElements()) \n{\n\t\t\t\t\t\t\t\tif (!searchResult.equals((SearchResult) results.next()))\n\t\t\t\t\t\t\t\t\tthrow new IncorrectResultSizeDataAccessException(1, 2);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Work out the DN of the matched entry\n\t\t\t\t\t\t\tStringBuffer dn = new StringBuffer(searchResult.getName());\n\t\t\t\t\t\t\tif (base.length() > 0) \n{\n\t\t\t\t\t\t\t    dn.append(\",\");\n\t\t\t\t\t\t\t    dn.append(base);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn new DirContextAdapter(searchResult.getAttributes(),\n\t\t\t\t\t\t\t        new DistinguishedName(dn.toString()), new DistinguishedName(ctx.getNameInNamespace()));\n\t\t\t\t\t\t}\n\t\t\t            catch (Exception e) \n{\n\t\t\t            \tNamingException ne = new NamingException(e.getMessage());\n\t\t\t\t\t\t\tne.setStackTrace(e.getStackTrace());\n\t\t\t\t\t\t\tthrow ne;\n\t\t\t\t\t\t}\n\t\t\t        }\n\t\t\t    });\t\t       \n    }", "project": "Spring", "sub_project": "SEC", "version": "2.0.1", "fixed_version": "2.0.4", "fixed_files": ["org.springframework.security.ldap.SpringSecurityLdapTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 875, "bug_title": "SavedRequestAwareRequestWrapper causes duplication of URL parameters", "bug_description": "The changes for SEC-830 and SEC-857 appear to have because an issue with duplicate parameter values appearing when getParameterValues() is called on the wrapper. This will only apply to URL parameters. When deciding how to combine the values from the saved and wrapped request (or if we should), then whether they both contain the same values should be take into account.", "project": "Spring", "sub_project": "SEC", "version": "2.0.2", "fixed_version": "2.0.3", "fixed_files": ["org.springframework.security.wrapper.SavedRequestAwareWrapper.java", "org.springframework.security.wrapper.SavedRequestAwareWrapperTests.java"], "label": 1, "es_results": []}, {"bug_id": 890, "bug_title": "RememberMeBeanDefinitionParser uses wrong name for data source", "bug_description": "The parser attempts to use data-source-ref as the bean property name (i.e. the namespace attribute)\nhttp://forum.springframework.org/showthread.php?t=56057", "project": "Spring", "sub_project": "SEC", "version": "2.0.2", "fixed_version": "2.0.3", "fixed_files": ["org.springframework.security.config.RememberMeBeanDefinitionParser.java", "org.springframework.security.config.HttpSecurityBeanDefinitionParserTests.java"], "label": 1, "es_results": []}, {"bug_id": 892, "bug_title": "Value of attribute create-session in schema based configuration should set property ExceptionTranslationFilter.createSessionAllowed", "bug_description": "I am trying to set up a security configuration for a simple web service application using basic (and digest) authentication. There is a requirement that my application should never create HttpSessions, but this is violated as a result of the default value of ExceptionTranslationFilter.createSessionAllowed (true). There seems to be no way to set the value of this property when using schema based configuration.\nIn my opinion the attribute create-session should affect the value of ExceptionTranslationFilter.createSessionAllowed;\nifRequired: true\nalways: true\nnever: false\nA relatively easy workaround is to not use schema based configuration......", "project": "Spring", "sub_project": "SEC", "version": "2.0.2", "fixed_version": "2.0.3", "fixed_files": ["org.springframework.security.config.HttpSecurityBeanDefinitionParserTests.java", "org.springframework.security.config.HttpSecurityBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 953, "bug_title": "Query string is not ignored while url - filterchain pattern matching", "bug_description": "While upgrading from Acegi Security 1.0.7 to Spring Security 2.0.2 I noticed that url matching doesn&apos;t work as it was before.\nIn Acegi I used the following url - filter chaing mapping:\n<bean id=\"filterChainProxy\" class=\"org.acegisecurity.util.FilterChainProxy\">\n    <property name=\"filterInvocationDefinitionSource\">\n\t<value>\n\t     CONVERT_URL_TO_LOWERCASE_BEFORE_COMPARISON \n\t     PATTERN_TYPE_APACHE_ANT\n                  j_acegi_security_check=httpSessionContextIntegrationFilter,....................\t\t\t\n\t    j_acegi_logout=httpSessionContextIntegrationFilter,.......................\n                 /*/.htm=httpSessionContextIntegrationFilter,.....................\n            </value>\n  </property>\n</bean>\nI Spring Security the same mapping looks as follows:\n<bean id=\"filterChainProxy\" class=\"org.springframework.security.util.FilterChainProxy\">\n    <security:filter-chain-map path-type=\"ant\">\n            <security:filter-chain pattern=\"/j_spring_security_check\" filters=\"httpSessionContextIntegrationFilter, ...............\" />\n\t<security:filter-chain pattern=\"/j_spring_security_logout\" filters=\"httpSessionContextIntegrationFilter,.....\" />\n\t<security:filter-chain pattern=\"/*/.htm\" filters=\"httpSessionContextIntegrationFilter,.....\" />\t\t\t\n    </security:filter-chain-map>\t\n</bean>\nBut  I received NullPointerException while performing some requests.  It appears because these requests bypass filterchain and Security Context isn&apos;t integrated into a session. Such situation occurs for requests which includes parameters in url.\nFor instance, request url &apos;page1.htm&apos; matches to pattern &apos;/*/.htm&apos; but url &apos;page1.htm?param=value&apos; doesn&apos;t. \nIt caused by changes in url - filterchain pattern matching. In Acegi PathBasedFilterInvocationDefinitionMap ignores query string (any symbols after first &apos;?&apos;) but in Spring FilterChainProxy provides full requests url to matcher (in this case AntUrlPathMatcher) :\npublic void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)\n            throws IOException, ServletException \n{\n\n        FilterInvocation fi = new FilterInvocation(request, response, chain);\n        List filters = getFilters(fi.getRequestUrl());\n       .................\n\n}\n\npublic List getFilters(String url)  {\n      Iterator filterChains = filterChainMap.entrySet().iterator();\n        while (filterChains.hasNext()) {\n            Map.Entry entry = (Map.Entry) filterChains.next();\n            Object path = entry.getKey();\n            if (matcher.requiresLowerCaseUrl()) {\n                url = url.toLowerCase();\n                if (logger.isDebugEnabled()) \n{\n                    logger.debug(\"Converted URL to lowercase, from: &apos;\" + url + \"&apos;; to: &apos;\" + url + \"&apos;\");\n                }\n            }\n            boolean matched = matcher.pathMatchesUrl(path, url);\n             ......\n}\nTo keep backward compatibility I offer to change doFilter() implementation to pass request url without query string into getFilters() method.\n", "project": "Spring", "sub_project": "SEC", "version": "2.0.2", "fixed_version": "2.0.4", "fixed_files": ["org.springframework.security.config.HttpSecurityBeanDefinitionParser.java", "org.springframework.security.util.FilterChainProxyTests.java", "org.springframework.security.util.FilterChainProxy.java", "org.springframework.security.config.HttpSecurityBeanDefinitionParserTests.java"], "label": 1, "es_results": []}, {"bug_id": 913, "bug_title": "SwitchUserProcessingFilter modifies the switchFailureUrl member variable on failure", "bug_description": "The code in redirectToFailureUrl() prepends the contextPath to the member variable every time there is a failure. If the contextPath isn&apos;t \"\" this means that the second time there is a failure the client will be redirected to an invalid page. Here&apos;s the faulty code:\n        if (switchFailureUrl != null) \n{\n            switchFailureUrl = request.getContextPath() + switchFailureUrl;\n            response.sendRedirect(response.encodeRedirectURL(switchFailureUrl));\n        }\n else {\nWhy not use the sendRedirect() method which is used for targetUrl? E.g.:\n        if (switchFailureUrl != null) \n{\n            sendRedirect(request, response, switchFailureUrl);\n        }\n else {\nThis fix also means that the useRelativeContext property will actually be used also on failures. I think the user of SwitchUserProcessingFilter would expect that.", "project": "Spring", "sub_project": "SEC", "version": "2.0.3", "fixed_version": "2.0.4", "fixed_files": ["org.springframework.security.ui.switchuser.SwitchUserProcessingFilterTests.java", "org.springframework.security.ui.switchuser.SwitchUserProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 903, "bug_title": "Wrong attribute mapping when using jdbc-user-service bean", "bug_description": "The JdbcUserServiceBeanDefinitionParser adds the wrong property when detecting groupAuthoritiesByUsernameQuery.\nIt adds authoritiesByUsernameQuery instead of groupAuthoritiesByUsernameQuery.\nThus after that the JdbcDaoImpl use its default value for groupAuthoritiesByUsernameQuery instead of the one passed \nin parameter by the bean.\nI guess that if authoritiesByusernameQuery is passed also, there should be a mismatch between the two queries. \nThis is a side effect.\nCorrection tested :\nIn the class JdbcUserServiceBeanDefinitionParser   \nif (StringUtils.hasText(groupAuthoritiesQuery)) {\n   builder.addPropertyValue(\"enableGroups\", Boolean.TRUE);\n   //builder.addPropertyValue(\"authoritiesByUsernameQuery\", groupAuthoritiesQuery);\n   // should be\n   builder.addPropertyValue(\"groupAuthoritiesByUsernameQuery\", groupAuthoritiesQuery);\n   // end correction\n}\nWith that the JdbcDaoImplTests testLookupFailsIfUserHasNoGrantedAuthorities() will fail.\nWhen looking at it, it seems that it is not functionaly correct.\n", "project": "Spring", "sub_project": "SEC", "version": "2.0.3", "fixed_version": "2.0.4", "fixed_files": ["org.springframework.security.config.JdbcUserServiceBeanDefinitionParserTests.java", "org.springframework.security.config.JdbcUserServiceBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 899, "bug_title": "GrantedAuthorityImpl.compareTo should handle null roles", "bug_description": "when mixing GrantedAuthorityImpl with other more specialized implementations that return null from getAuthority, GrantedAuthorityImpl.compareTo fails with an NPE.", "project": "Spring", "sub_project": "SEC", "version": "2.0.3", "fixed_version": "2.0.4", "fixed_files": ["org.springframework.security.GrantedAuthorityImplTests.java", "org.springframework.security.GrantedAuthorityImpl.java"], "label": 1, "es_results": []}, {"bug_id": 923, "bug_title": "OpenId integration and support for discovering relying parties", "bug_description": "Hi,\nI am using the excellent openId support in Spring Security but I noticed that with Yahoo, I keep seeing the following message on Yahoo&apos;s openid page:\n\"Warning: This website has not confirmed its identity with Yahoo! and might be fraudulent. Do not share any personal information with this website unless you are certain it is legitimate. \"\nI looked into this issue and found that  the reason is that Yahoo implements a feature in OpenId 2.0 where it verifies if the return_to URL is a relying party endpoint (see http://openid.net/specs/openid-authentication-2_0-12.html#realms, section 9.2.1). In this case the return_to URL is http://<website>/j_spring_openid_security_check.\nI also followed the tutorial here http://blog.nerdbank.net/2008/06/why-yahoo-says-your-openid-site.html but with no success. \nI can actually see on my webserver log a Yahoo IP address hitting the following URL after I post the OpenId authentication request:\n68.142.241.108 - - [15/Jul/2008:02:49:06 +0000] \"GET /j_spring_openid_security_check HTTP/1.1\" 302 -\nafter which Yahoo&apos;s openId page shows the warning. Note that the login works fine if I click on the \"Let me in\" button.\nPlease help.\nflorin", "project": "Spring", "sub_project": "SEC", "version": "2.0.3", "fixed_version": "2.0.4", "fixed_files": ["org.springframework.security.ui.openid.consumers.OpenID4JavaConsumer.java", "org.springframework.security.ui.openid.consumers.MockOpenIDConsumer.java", "org.springframework.security.ui.openid.OpenIDConsumer.java", "org.springframework.security.ui.openid.OpenIDAuthenticationProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 943, "bug_title": "DefaultSpringSecurityContextSource should support escaped spaces in URL.", "bug_description": "When working out the base name, it uses URI.getPath() when it should probably use URI.getRawPath(). Otherwise it gets confused by the returned space and assumes that there are multiple URLs in the string.", "project": "Spring", "sub_project": "SEC", "version": "2.0.3", "fixed_version": "2.0.4", "fixed_files": ["org.springframework.security.ldap.DefaultSpringSecurityContextSourceTests.java"], "label": 1, "es_results": []}, {"bug_id": 947, "bug_title": "<custom-filter before=\"FIRST\" /> causes filter to be placed last in the filters chain", "bug_description": "With this configuration:\n<bean id=\"myFilter\" class=\"SomeFilterClass\">\n  <custom-filter before=\"FIRST\" />\n</s:bean>\nmyFilter will be placed last in the filters chain, because of this line in OrderedFilterBeanDefinitionDecorator class:\nreturn Integer.toString(FilterChainOrder.getOrder(before) - 1);\nFilterChainOrder.getOrder(before) returns Integer.MIN_VALUE for filterName \"FIRST\" and then decrement (-1) causes numerical buffer overflow so that order returned becomes Integer.MAX_VALUE not MIN_VALUE.\nWORKAROUND: use this instead:\n<bean id=\"myFilter\" class=\"SomeFilterClass\">\n  <custom-filter before=\"CHANNEL_FILTER\" />\n</s:bean>", "project": "Spring", "sub_project": "SEC", "version": "2.0.3", "fixed_version": "2.0.4", "fixed_files": ["org.springframework.security.config.OrderedFilterBeanDefinitionDecorator.java"], "label": 1, "es_results": []}, {"bug_id": 936, "bug_title": "NPE in AbstractFallbackMethodDefinitionSource", "bug_description": "A NullPointerException occurs in the following code while calling mi.getThis().getClass():\n    public ConfigAttributeDefinition getAttributes(Object object) throws IllegalArgumentException {\n        Assert.notNull(object, \"Object cannot be null\");\n        if (object instanceof MethodInvocation) \n{\n        \tMethodInvocation mi = (MethodInvocation) object;\n            return getAttributes(mi.getMethod(), mi.getThis().getClass());\n        }\n\nI guess the mi.getThis() method returns null when there is no target object. This is the case, for example, when the last interceptor in the chain handles the method call instead of a &apos;real&apos; target object (like Spring&apos;s HttpInvokerClientInterceptor). \nI think the getAttributes() method accepts a null targetClass, so a simple mi.getThis()==null?null:mi.getThis().getClass() would fix this issue.\n", "project": "Spring", "sub_project": "SEC", "version": "2.0.3", "fixed_version": "2.0.4", "fixed_files": ["org.springframework.security.intercept.method.AbstractFallbackMethodDefinitionSource.java", "org.springframework.security.intercept.method.MapBasedMethodDefinitionSource.java", "org.springframework.security.config.GlobalMethodSecurityBeanDefinitionParserTests.java"], "label": 1, "es_results": []}, {"bug_id": 960, "bug_title": "DN Encoding in LDAPUserDetailsManager.changePassword() causes bind errors", "bug_description": "Please see the write-up here:\nhttp://forum.springframework.org/showthread.php?t=53118\nThis prevents changepassword operations by binding as the user.  Normally, binding as the admin to change the password will work, but certain LDAP directory servers (such as Novell eDirectory) have a policy that sets the user&apos;s account to expire after some small time period whenever an admin user changes a password.  However, this side-effect is undesirable when it&apos;s actually the user changing the password.\n", "project": "Spring", "sub_project": "SEC", "version": "2.0.3", "fixed_version": "2.0.4", "fixed_files": ["org.springframework.security.userdetails.ldap.LdapUserDetailsManagerTests.java", "org.springframework.security.userdetails.ldap.LdapUserDetailsManager.java"], "label": 1, "es_results": []}, {"bug_id": 975, "bug_title": "Namespace access-denied-page attribute does not work with property placeholders", "bug_description": "Hello,\nI am trying to use a property inside Spring security:\n\t<security:http \n\t\taccess-denied-page=\"$\n{security.errorPage}\n\"\n ...>\n\t\t...\n\t</security:http>\nWhere security.errorPage is a property defined in a property file loaded by a org.springframework.beans.factory.config.PropertyPlaceholderConfigurer bean.\nBut it is not interpreted.\nLooking at org.springframework.security.config.HttpSecurityBeanDefinitionParser I got the confirmation it is not a case.\nI don&apos;t know if it is a feature but I think it may be useful.\nPhilippe.", "project": "Spring", "sub_project": "SEC", "version": "2.0.3", "fixed_version": "2.0.5.RELEASE", "fixed_files": ["org.springframework.security.config.HttpSecurityBeanDefinitionParserTests.java", "org.springframework.security.config.HttpSecurityBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 992, "bug_title": "SpringSecurityLdapTemplate: clearing the returningObjFlag of SearchControls contradicts contract with LdapTemplate", "bug_description": "In method searchForSingleAttributeValues(String, String, Object[], String) of class SpringSecurityLdapTemplate, on line 168, there is this call:\nctls.setReturningObjFlag(false);\nThen the search(String, String, Object[], String) method is called with a context mapper, which implies that  returnObj must be true in SearchControls. LdapTemplate checks the returningObjFlag state, and if it is false, sets it to true. It also emits an INFO log entry about the inconsistency.\nThe documentation of class SearchControls states for the controls argument:\n\"The <code>SearchControls</code> to use in the search. If the\n\nreturnObjFlag is not set in the <code>SearchControls</code>,\nthis method will set it automatically, as this is required for\nthe <code>ContextMapper</code> to work.\n\"\n\nSetting the returningObjFlag to false is at best superfluous, at worst some behavior of the search is desired, which cannot be achieved this way.", "project": "Spring", "sub_project": "SEC", "version": "2.0.3", "fixed_version": "3.0.0.M1", "fixed_files": ["org.springframework.security.ldap.SpringSecurityLdapTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 925, "bug_title": "BasicLookupStrategy - support for schema qualifier", "bug_description": "The current impl of this class works great - I would like to avoid writing my own custom strategy wherever possible.  The JavaDocs for BasicLookupStrategy state that it&apos;s not design for extension which I understand.\nIt would be great, however, if a property could be set in the bean config that would allow the referenced tables in the SQL to be qualified by a schema.  Projects often run into such requirements based on the conventions used by a DBA group.  In our particular case, we&apos;re using DB2 and the ACL tables are being created in a schema that is not the default schema.", "project": "Spring", "sub_project": "SEC", "version": "2.0.3", "fixed_version": "3.0.0.RC1", "fixed_files": ["org.springframework.security.acls.jdbc.JdbcAclService.java", "org.springframework.security.acls.jdbc.JdbcMutableAclService.java", "org.springframework.security.acls.jdbc.BasicLookupStrategy.java"], "label": 1, "es_results": []}, {"bug_id": 1006, "bug_title": "AccessControlListTag class Javadoc incorrect", "bug_description": "The class-level Javadoc for AccessControlListTag incorrectly states that there must be exactly one SidRetrievalStrategy bean on the application context. While the tag will complain if multiple such beans exist, there is no issue if no SidRetrievalStrategy implementations exist. In that event AccessControlListTag simply creates a SidRetrievalStrategyImpl instance and uses that.\n", "project": "Spring", "sub_project": "SEC", "version": "2.0.4", "fixed_version": "3.0.0.M1", "fixed_files": ["org.springframework.security.taglibs.authz.AccessControlListTag.java"], "label": 1, "es_results": []}, {"bug_id": 1143, "bug_title": "Using Namespace will not set sessionRegistry for form-login", "bug_description": "When using concurrent session using namespace like :\n<security:concurrent-session-control max-sessions=\"1\" expired-url=\"/login-page.html\" session-registry-ref=\"onlineManager\"/>     \nthe onlineManager is my own sessionRegistry\nI found when login it always register a new session and then remove it. I dig it found it is in AbstractProcessingFilter.java line 367:\nSessionUtils.startNewSessionIfRequired(request, migrateInvalidatedSessionAttributes, sessionRegistry);\nAnd the  AbstractProcessingFilter.java has \n    public void setSessionRegistry(SessionRegistry sessionRegistry) \n{\n        this.sessionRegistry = sessionRegistry;\n    }\nBut I can&apos;t find any description for form-login in spring-security-2.0.4.xsd.\nI can using just bean define to solve this.But this must bei xsd problem or namespace inplement.", "project": "Spring", "sub_project": "SEC", "version": "2.0.4", "fixed_version": "3.0.0.M1", "fixed_files": ["org.springframework.security.config.FormLoginBeanDefinitionParser.java", "org.springframework.security.util.FieldUtils.java", "org.springframework.security.config.HttpSecurityBeanDefinitionParserTests.java"], "label": 1, "es_results": []}, {"bug_id": 1121, "bug_title": "InMemoryResource.equals() is wrong", "bug_description": "Here is org.springframework.security.util.InMemoryResource.equals method code:\n  public boolean equals(Object res) {\n        if (res instanceof InMemoryResource) \n{\n            return false;\n        }\n\n        return Arrays.equals(source, ((InMemoryResource)res).source);\n    }\n\nObviously, this should be:\n\n  public boolean equals(Object res) {\n        if (!(res instanceof InMemoryResource)) {            return false;        }\n\n        return Arrays.equals(source, ((InMemoryResource)res).source);\n    }", "project": "Spring", "sub_project": "SEC", "version": "2.0.4", "fixed_version": "3.0.0.M1", "fixed_files": ["org.springframework.security.util.InMemoryResource.java"], "label": 1, "es_results": []}, {"bug_id": 1145, "bug_title": "When connecting to ldap for authentication user can login using old and new password", "bug_description": "Login to application\nChange windows password\nLogout of application\nLogin to application using old password\nThis succeeds when it should not.\nLogin to application using new password. This succeeds and it should.\nReboot application, old password still works and still shouldn&apos;t.\nReboot machine, old password still works and still shouldn&apos;t.\nConfig:\n<bean id=\"contextSource\" class=\"org.springframework.security.ldap.DefaultSpringSecurityContextSource\">\n\t\t<constructor-arg value=\"$\n{ldap.url}\n\"/>\n\t\t<property name=\"userDn\" value=\"CN=svc-ldap-deliveries,OU=Service Accounts,DC=MYDC,DC=com\"/> \n\t\t<property name=\"password\" value=\"pwd\"/> \n\t\t<property name=\"referral\" value=\"follow\" />\n\t</bean> \n\t<bean id=\"secondLdapProvider\"\n\t\t  class=\"org.springframework.security.providers.ldap.LdapAuthenticationProvider\">\n\t\t<security:custom-authentication-provider /> \n\t\t<constructor-arg> \n\t\t\t<bean class=\"org.springframework.security.providers.ldap.authenticator.BindAuthenticator\">\n\t\t\t\t<constructor-arg ref=\"contextSource\"/> \n\t\t\t\t<property name=\"userSearch\">\n\t\t\t\t\t<bean id=\"userSearch\" class=\"org.springframework.security.ldap.search.FilterBasedLdapUserSearch\">\n\t\t\t\t\t\t<constructor-arg index=\"0\" value=\"\"/> \n\t\t\t\t\t\t<constructor-arg index=\"1\" value=\"sAMAccountName=\n{0}\"/> \n\t\t\t\t\t\t<constructor-arg index=\"2\" ref=\"contextSource\" /> \n\t\t\t\t\t</bean> \n\t\t\t\t</property> \n\t\t\t</bean> \n\t\t</constructor-arg>\n\n\t \t<constructor-arg> \t\t\n\t\t\t<bean class=\"org.springframework.security.ldap.populator.DefaultLdapAuthoritiesPopulator\">\n\n\t\t\t\t<constructor-arg ref=\"contextSource\" /> \n\t\t\t\t<constructor-arg value=\"OU=DLS File Permissions\" />\n\t\t\t\t<property name=\"rolePrefix\" value=\"ROLE_\"/> \t\t\t\n\t\t\t\t<property name=\"convertToUpperCase\" value=\"false\"/> \t\t\t\t\t\n\t\t\t\t<property name=\"groupRoleAttribute\" value=\"cn\"></property>\t\t\t\n\t\t\t\t<property name=\"groupSearchFilter\" value=\"(member={0}\n)\"/>\n\t\t\t\t<property name=\"searchSubtree\" value=\"true\"></property>\n\t\t\t</bean> \n\t\t</constructor-arg>\n\t</bean>\nSpring core 2.0.4 and spring ldap 1.3.0", "project": "Spring", "sub_project": "SEC", "version": "2.0.4", "fixed_version": "2.0.5.RELEASE", "fixed_files": ["org.springframework.security.ldap.DefaultSpringSecurityContextSourceTests.java"], "label": 1, "es_results": []}, {"bug_id": 1151, "bug_title": "Check on acl bounds not correct", "bug_description": "On line 130 of AclImpl.java in trunk (line number is different in other releases) a check is performed on the upper bound of the list of access control entries.\nCode is:\n        if (aceIndex > this.aces.size()) {\nshould be:\n        if (aceIndex >= this.aces.size()) {\nResult is that exception out of underlying list impl is thrown.  Minor.", "project": "Spring", "sub_project": "SEC", "version": "2.0.5.RELEASE", "fixed_version": "3.0.0.M1", "fixed_files": ["org.springframework.security.acls.domain.AclImpl.java", "org.springframework.security.acls.domain.AclImplTests.java"], "label": 1, "es_results": []}, {"bug_id": 1308, "bug_title": "Jdbc[Mutable]AclService  can allow (all) sql statements to be configured", "bug_description": "I&apos;m providing a candidate patch for consideration. It&apos;s an enhancement to jdbc acl service that allows all sql statement strings to be configured by via spring. Please review and incorporate if desired.\nThe attached patch contains:\n1) Interface for AclSQLSource (not sure if setters should really be part of this or not. I decided to include them.)\n2) DefaultAclSQLSource - contains the usual Postgres SQL statements and setters for Spring configuration. Additional constructor takes a map with property and sql map entries.\n3) Changes to JdbcAclService and JdbcMutableAclService to read statements from the AclSQLSource.\n===\nSample configuration:\n\t<bean id=\"sqlSource\"\n\t\tclass=\"org.springframework.security.acls.jdbc.DefaultAclSQLSource\">\n\t\t<constructor-arg>\n\t\t\t<map>\n\t\t\t\t<entry key=\"classIdentityQuery\" value=\"SELECT ACL_CLASS_ID_SEQ.CURRVAL FROM DUAL\" />\n\t\t\t\t<entry key=\"sidIdentityQuery\" value=\"SELECT ACL_SID_ID_SEQ.CURRVAL FROM DUAL\" />\n\t\t\t\t<entry key=\"selectSidPrimaryKey\"\n\t\t\t\t\tvalue=\"select id from acl_sid where principal=DECODE(?,&apos;TRUE&apos;,&apos;1&apos;,&apos;Y&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;FALSE&apos;,&apos;0&apos;,&apos;N&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;) and sid=?\" />\n\t\t\t\t<entry key=\"insertSid\"\n\t\t\t\t\tvalue=\"insert into acl_sid (principal, sid) values (DECODE(?,&apos;TRUE&apos;,&apos;1&apos;,&apos;Y&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;FALSE&apos;,&apos;0&apos;,&apos;N&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;), ?)\" />\n\t\t\t</map>\n\t\t</constructor-arg>\n\t</bean>\n\t<bean id=\"aclService\"\n\t\tclass=\"org.springframework.security.acls.jdbc.JdbcMutableAclService\">\n\t\t<constructor-arg ref=\"secDataSource\" index=\"0\"/>\n\t\t<constructor-arg ref=\"lookupStrategy\" index=\"1\"/>\n\t\t<constructor-arg ref=\"aclCache\" index=\"2\"/>\n\t\t<constructor-arg ref=\"sqlSource\" index=\"3\"/>\n\t</bean>\n===", "project": "Spring", "sub_project": "SEC", "version": "2.0.5.RELEASE", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.acls.jdbc.JdbcAclService.java", "org.springframework.security.acls.jdbc.JdbcMutableAclService.java", "org.springframework.security.acls.jdbc.BasicLookupStrategy.java"], "label": 1, "es_results": []}, {"bug_id": 1520, "bug_title": "Enumerator not closed or fully-enumerated", "bug_description": "1- SpringSecurityLdapTemplate.java, in compare (called by the LDAP password authenticator)\nNamingEnumeration<SearchResult> results = ctx.search(dn, comparisonFilter, new Object[] \n{value}, ctls);\nreturn Boolean.valueOf(results.hasMore());\n\nshould be more like this\nNamingEnumeration<SearchResult> results = ctx.search(dn, comparisonFilter, new Object[] {value}\n, ctls);\nboolean rtn = Boolean.valueOf(results.hasMore());\ntry {\n  results.close();\n} catch (NamingException ignored) {\n  // Ignore naming exception on close.\n}\nreturn rtn;\n2- DefaultDirContextValidator.validateDirContext has a similar problem, but I think that class has been refactored or eliminated.", "project": "Spring", "sub_project": "SEC", "version": "2.0.5.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.ldap.SpringSecurityLdapTemplate.java", "org.springframework.security.ldap.LdapUtils.java"], "label": 1, "es_results": []}, {"bug_id": 1223, "bug_title": "BindAuthenticator should use first successful return from bindWithDn", "bug_description": "Regression issue. Loop should end when first non-null user is returned.", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.M1", "fixed_version": "3.0.0.M2", "fixed_files": ["org.springframework.security.ldap.authentication.BindAuthenticator.java"], "label": 1, "es_results": []}, {"bug_id": 1236, "bug_title": "Using HTTP Method-specific intercept-urls causes patterns with no method to be ignored", "bug_description": "With this configuration the URLs with /user/** pattern does not get intercepted:\n<http>\n\t<http-basic/>\n\t<intercept-url pattern=\"/user/**\" access=\"ROLE_USER\"/>\n\t<intercept-url pattern=\"/teller/**\" access=\"ROLE_TELLER\" method=\"GET\"/>\n</http>\nthis is beacause org.springframework.security.web.access.intercept.DefaultFilterInvocationSecurityMetadataSource never search for null key.\nHere is the current code:\n Map<Object, List<ConfigAttribute>> requestMap = httpMethodMap.get(method);\n // If no method-specific map, use the general one stored under the null key\n if (requestMap == null) \n{\n   requestMap = httpMethodMap.get(null);\n }\n\nBecause \"method\" is never \"null\", in the first line the variable \"requestMap\" will either, so the \"if\"&apos;s condition is never \"true\".\nAttached is a working version of the class.", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.M1", "fixed_version": "3.0.0.RC1", "fixed_files": ["org.springframework.security.web.access.intercept.DefaultFilterInvocationSecurityMetadataSourceTests.java", "org.springframework.security.web.access.intercept.DefaultFilterInvocationSecurityMetadataSource.java"], "label": 1, "es_results": []}, {"bug_id": 1241, "bug_title": "SavedRequest not destroyed after successful authentication", "bug_description": "SUMMARY:\nAfter an anonymous user authenticates in order to access a protected resource, the RequestCacheAwareFilter does not destroy the saved request. \nAfter successfully replaying the original request for the protected resource, the saved request is no longer valid/useful and should be destroyed.\nBACKGROUND:\nI have a form handler registered at:\nhttp://foo.com/app/form\nA handler is defined with two methods (one for GET and one for POST). The form posts back to the same url as the GET request for the form (a relatively common practice?).\nSo for example:\nGET: /app/form\n<form action=\"/app/form\" method=\"POST\"> ... </form>\nThe URL \"/app/form\" is protected by Spring Security and requires \"IS_AUTHENTICATED_FULLY\".\nWhen an anonymous user  attempts to access the protected resource, they are correctly redirected to the login form. Once authentication is successful, the user is directed back to the protected resource.\nUpon submitting the form, though, the POST fails, because the session still contains a cached copy of the original GET request.\nBecause the session still contains a copy of the original GET request, SavedRequest.doesRequestMatch (line 166) erroneously returns true. However, the requests do NOT match: the current request is a POST, whereas the saved request was a GET.\nAdditionally, after successfully completing the saved request after authentication, RequestCacheAwareFilter.doFilter (line 36) does not remove the saved request from the cache.\nAs a result, when the user attempts to POST the form, the result is the user being directed back to the GET view of the form, with no form-processing actions taking place. Debugging confirms that the requests are mapped to the handler&apos;s GET method.\nI would consider this a critical if not blocking issue, as it prevents normal form processing to occur after authenticating. \nI am still looking, but I have not yet discovered a way to configure Spring Security to use a custom class in-place-of the RequestCacheAwareFilter - so I cannot easily extend or remove the Filter.\nAs a work around, I can change the form handler&apos;s POST methods to map to a different URL than the GET method - however, this breaks any RESTful contracts I might have wished to adhere to.\nAdditionally, I can configure a custom AuthenticationSuccessHandler (namely, using the SimpleUrlAuthenticationSuccessHandler instead of the SavedRequestAwareAuthenticationSuccessHandler). Doing so effectively stops the Security layer from trying to replay the original request, but this has a jarring impact on the user experience in that users always get redirected back to the default URL after authenticating.\nCONCLUSION\nAny other suggestions are welcome, and I am happy to provide more concrete code examples if necessary...", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.M2", "fixed_version": "3.0.0.RC1", "fixed_files": ["org.springframework.security.web.savedrequest.RequestCache.java", "org.springframework.security.web.savedrequest.HttpSessionRequestCache.java"], "label": 1, "es_results": []}, {"bug_id": 1240, "bug_title": "{ssha} is specified in the Spring Security password-encoder schema, but is not handled by code", "bug_description": "Pretty minor, but I noticed that the \n{ssha}\n option for LDAP SSHA is an allowable value in the schema for password-encoder&apos;s hash attribute, but it isn&apos;t handled by PasswordEncoderParser.", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.M2", "fixed_version": "3.0.0.RC1", "fixed_files": ["org.springframework.security.config.authentication.PasswordEncoderParser.java"], "label": 1, "es_results": []}, {"bug_id": 1269, "bug_title": "Combining <form-login> and <open-id> fails to find entry point", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC1", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.config.http.AuthenticationConfigBuilder.java", "org.springframework.security.config.http.HttpSecurityBeanDefinitionParserTests.java", "org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1282, "bug_title": "Possible Bug - UnanimousBased Incorrectly Grants When One Of The Votes Is An Absension", "bug_description": "Overall Spring Security is AWESOME and you guys are doing a great job!\nHowever, I am convinced I found either a bug or Doc error in UnanimousBased AccessDecisionManager.  \nThe API doc says \"grants access if only grant votes were received\" but I am certain I got it to grant access when one of the votes was an Abstention.\nOr if this is not a bug, please clarify API to say \n\"grants access if only grant or abstained votes were received\"\nThanks so much and keep up the great work!!\nSpring Security Rocks!", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC1", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.access.vote.UnanimousBased.java"], "label": 1, "es_results": []}, {"bug_id": 1281, "bug_title": "RememberMeAuthenticationProvider is created with default \"key\" parameter instead of my own specified", "bug_description": "I tried to define my own RememberMeService as shown\n<security:remember-me \n   services-ref=\"rememberMeServices\" \n   key=\"$\n{app.security.key.rememberMe}\"/>\n\n<bean id=\"rememberMeServices\" class=\"org.springframework.security.web.authentication.rememberme.PersistentTokenBasedRememberMeServices\">\n        <property name=\"key\" value=\"${app.security.key.rememberMe}\n\"/>\n        <property name=\"cookieName\" value=\"rememberme-ref\"/>\n        <property name=\"parameter\" value=\"j_rememberme\"/>\n        <property name=\"tokenValiditySeconds\" value=\"1209600\"/>\n        <property name=\"tokenRepository\" ref=\"rememberMeDao\"/>\n        <property name=\"userDetailsService\" ref=\"userDetailsDao\" />\n</bean>\nBut RememberMeAuthenticationProvider instance is created with default \"SpringSecured\" key instead of my own so RememberMeAuthenticationProvider.authenticate never succeeds.\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC1", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.config.http.AuthenticationConfigBuilder.java", "org.springframework.security.config.http.RememberMeBeanDefinitionParser.java", "org.springframework.security.config.http.HttpSecurityBeanDefinitionParserTests.java"], "label": 1, "es_results": []}, {"bug_id": 1283, "bug_title": "AuthenticationConfigBuilder.createAnonymousFilter uses httpElt instead of anonymousElt", "bug_description": "I think lines 378-383 should refer to anonymousElt, not httpElt. As it stands,  <security:anonymous /> namespace attributes are ignored.\n        if (anonymousElt != null) \n{\n            grantedAuthority = httpElt.getAttribute(\"granted-authority\");\n            username = httpElt.getAttribute(\"username\");\n            key = httpElt.getAttribute(\"key\");\n            source = pc.extractSource(anonymousElt);\n        }", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC1", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.config.http.AuthenticationConfigBuilder.java", "org.springframework.security.config.http.HttpSecurityBeanDefinitionParserTests.java"], "label": 1, "es_results": []}, {"bug_id": 1289, "bug_title": "Successful registration event", "bug_description": "With 3.0M2 and before I used the following code to register successful registrations and save client&apos;s IPs\n[code]\npublic class AuthenticationListener implements ApplicationListener {\n    @Override\n    public void onApplicationEvent(ApplicationEvent event) {\n        if (event instanceof AuthenticationSuccessEvent) \n{\n            onAuthenticationSuccessEvent((AuthenticationSuccessEvent) event);\n        }\n    }\n    public void onAuthenticationSuccessEvent(AuthenticationSuccessEvent authenticationSuccessEvent) \n{\n        // my code\n    }\n}\n[/code]\nWith 3.0RC1 there are no AuthenticationSuccessEvent events any more. I&apos;ve found the following comment for org.springframework.security.authentication.DefaultAuthenticationEventPublisher\n\"The default strategy used by <tt>ProviderManager</tt> for publishing authentication events.\"\nBut when I looked in ProviderManager I&apos;ve found that the default strategy is NullEventPublisher which is created by private field&apos;s initializer.\nI thought that it&apos;s possible to inject DefaultAuthenticationEventPublisher with default XML security scheme but I&apos;ve found no entry point to do this.", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC1", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.config.authentication.AuthenticationManagerBeanDefinitionParserTests.java", "org.springframework.security.config.authentication.AuthenticationManagerBeanDefinitionParser.java", "org.springframework.security.authentication.DefaultAuthenticationEventPublisher.java"], "label": 1, "es_results": []}, {"bug_id": 1272, "bug_title": "<authentication-manager> does not register default event handler DefaultAuthenticationEventPublisher", "bug_description": "When using the namespace configuration, creating an <authentication-manager> should automatically register a default event publisher. This allows applications to be notified about security events such as logins and login failures - for example I want these notifications so that I can write audit logs of failed logins. \nThe Javadoc on org.springframework.security.authentication.ProviderManager states that such a default event publisher is automatically registered when using the namespace. It says: \n\"The standard implementation is DefaultAuthenticationEventPublisher which maps common exceptions to events (in the case of authentication failure) and publishes an AuthenticationSuccessEvent if authentication succeeds. If you are using the namespace then an instance of this bean will be used automatically by the <http> configuration, so you will receive events from the web part of your application automatically.\"\nHowever ProviderManager does not actually register a DefaultAuthenticationEventPublisher! It uses its private NullEventPublisher class that does nothing. That means that if you use the namespace configuration you don&apos;t actually receive the default events. The only way to receive those events is to manually create a ProviderManager bean and inject a DefaultAuthenticationEventPublisher bean into it.\nI think that:\n\n<authentication-manager> should use DefaultAuthenticationEventPublisher instead of NullEventPublisher\n<authentication-manager> should allow the AuthenticationEventPublisher on ProviderManager to be overridden if desired\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC1", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.config.authentication.AuthenticationManagerBeanDefinitionParserTests.java", "org.springframework.security.config.authentication.AuthenticationManagerBeanDefinitionParser.java", "org.springframework.security.authentication.DefaultAuthenticationEventPublisher.java"], "label": 1, "es_results": []}, {"bug_id": 1287, "bug_title": "Regression with fix SEC-1022 - cannot register custom permissions w/BasicLookupStrategy", "bug_description": "With the fix for SEC-1002 in 3.0RC1 and the removal of the static methods in BasePermission, unfortunately it is now impossible to use BasicLookupStrategy with custom permissions. This is because the PermissionFactory member of BasicLookupStrategy is private, with no accessor and no setter or constructor injection possible. While this wasn&apos;t available in prior versions of 3.0 either, at least in prior versions you could use the static methods to register permissions.\nCan you expose the PermissionFactory member on BasicLookupStrategy, either through an overloaded constructor or setter?", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC1", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.acls.jdbc.BasicLookupStrategyTests.java", "org.springframework.security.acls.jdbc.BasicLookupStrategy.java"], "label": 1, "es_results": []}, {"bug_id": 1286, "bug_title": "toString misformatting for Acl.java", "bug_description": "Line 348:\nsb.append(\"parent: \").append((this.parentAcl == null) ? \"Null\" : this.parentAcl.getObjectIdentity().toString());\nThere should be a space after &apos;Null&apos;, as it stands you get output with \"NullaclAuthorizationStrategy\".\nExample:\nAccessControlEntryImpl[id: 3539; granting: true; sid: GrantedAuthoritySid[IS_AUTHENTICATED_ANONYMOUSLY]; permission: BasePermission[...............................R=1]; auditSuccess: false; auditFailure: false]\ninheriting: true; parent: NullaclAuthorizationStrategy: org.springframework.security.acls.domain.AclAuthorizationStrategyImpl@1c7e73f; auditLogger: org.springframework.security.acls.domain.ConsoleAuditLogger@11efef0]", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC1", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.acls.domain.AclImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1306, "bug_title": "OpenIDAttribute class is not marked as Serializable", "bug_description": "SEC-935 adds the OpenIDAttribute class. Because the OpenIDAuthenticationToken class (which is Serializable) has a List<OpenIDAttribute>, OpenIDAttribute should be Serializable too.\nThis interface should be no problem to add to the OpenIDAttribute class, because all its members are primitives or Strings and therefore already Serializable themselves.\nP.S. while you&apos;re at it, OpenIDAttribute#toString() should probably be annotated with @Override (and in OpenIDAuthenticationStatus too).", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC1", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.openid.OpenIDAttribute.java"], "label": 1, "es_results": []}, {"bug_id": 1295, "bug_title": "Placing Security on Roo Aspected methods fails", "bug_description": "When using @Secured on generated Roo_Entity methods a NPE is thrown due to target and _this information being missing when AspectJ creates the Join Point over an already aspected class. this NPE is thrown in AbstractMethodSecurityMetadataSource.getAttributes as there is a check against the Target to get the class. \nHave found that this information can also be retrieved from the signature.\nThis is using AspectJSecurityInterceptor configuration as opposed to SpringAOP, which we know doesn&apos;t work with Roo at all - yet   The configuration is based on the aspects sample within Spring Security.\nI have changed the following within AbstractMethodSecurityMetadataSource and it seems to work.... \nClass<?> targetClass = jp.getTarget().getClass();\nTo the following - though it too could just use one line and only call the signature:\n            Class<?> targetClass = null;\n            if(jp.getTarget() != null)\n            {\n                targetClass = jp.getTarget().getClass();\n            }\n            else\n            {\n                //this class has already been aspected, hence see if we can get the info from the\n                //static part\n                targetClass = jp.getStaticPart().getSignature().getDeclaringType();\n            }\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC1", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.access.method.AbstractMethodSecurityMetadataSource.java"], "label": 1, "es_results": []}, {"bug_id": 1317, "bug_title": "Http configuration with no internal AuthenticationProviders causes Exception", "bug_description": "The the internal ProviderManager, which is created by the <http> namespace element (SEC-1195), fails if it has no providers. Either a null provider should be added if the provider list is empty or the use of an internal instance should be skipped completely.", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC1", "fixed_version": "3.0.0.RC2", "fixed_files": ["org.springframework.security.config.http.HttpSecurityBeanDefinitionParserTests.java", "org.springframework.security.authentication.ProviderManager.java", "org.springframework.security.authentication.ProviderManagerTests.java"], "label": 1, "es_results": []}, {"bug_id": 1333, "bug_title": "Invalid 'authentication-failure-url' attribute results in assertion failure", "bug_description": "If I set the &apos;authentication-failure-url&apos; attribute of a <openid-login> or <form-login> element to something like \"XXX/secure/login.html\".  I get a bean wiring failure whose message says \"java.lang.IllegalArgumentException: [Assertion failed] - this expression must be true\".\nStacktrace attached.", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RC2", "fixed_version": "3.0.0.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1346, "bug_title": "SessionManagementFilter: should \"return;\" after \"redirectStrategy.sendRedirect(request, response, invalidSessionUrl);\"", "bug_description": "java.lang.IllegalStateException: Cannot create a session after the response has been committed\n\torg.apache.catalina.connector.Request.doGetSession(Request.java:2313)\n\torg.apache.catalina.connector.Request.getSession(Request.java:2074)\n\torg.apache.catalina.connector.RequestFacade.getSession(RequestFacade.java:833)\n\torg.apache.catalina.connector.RequestFacade.getSession(RequestFacade.java:844)\n\tjavax.servlet.http.HttpServletRequestWrapper.getSession(HttpServletRequestWrapper.java:224)\n\torg.springframework.security.web.savedrequest.HttpSessionRequestCache.saveRequest(HttpSessionRequestCache.java:38)\n\torg.springframework.security.web.access.ExceptionTranslationFilter.sendStartAuthentication(ExceptionTranslationFilter.java:177)\n\torg.springframework.security.web.access.ExceptionTranslationFilter.handleException(ExceptionTranslationFilter.java:158)\n\torg.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:118)\n\torg.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:356)\n\torg.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:95)\n\torg.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:356)\n\torg.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:79)\n\torg.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:356)\n\torg.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:55)\n\torg.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:356)\n\torg.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:36)\n\torg.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:356)\n\torg.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:188)\n\torg.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:356)\n\torg.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:106)\n\torg.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:356)\n\torg.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)\n\torg.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:356)\n\torg.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:150)\n\torg.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)\n\torg.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.web.concurrent.ConcurrentSessionFilterTests.java", "org.springframework.security.web.session.SessionManagementFilter.java", "org.springframework.security.web.util.UrlUtils.java", "org.springframework.security.web.session.SessionManagementFilterTests.java", "org.springframework.security.web.session.ConcurrentSessionFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1353, "bug_title": "SessionManagementFilter can invoke other filters after sending redirect", "bug_description": "SessionManagementFilter::doFilter() fails to stop request processing in branch \"No security context or authentication present\" (at SessionManagementFilter.java:89). More precisely, it does not return after calling redirectStrategy.sendRedirect(), but passes to the next filter.\nThis causes an error if there are controllers that define methods taking a HttpSession argument, because in this case AnnotationMethodHandlerAdapter attempts to call request.getSession(), which is not permitted after a redirect had been sent.", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.web.concurrent.ConcurrentSessionFilterTests.java", "org.springframework.security.web.session.SessionManagementFilter.java", "org.springframework.security.web.util.UrlUtils.java", "org.springframework.security.web.session.SessionManagementFilterTests.java", "org.springframework.security.web.session.ConcurrentSessionFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1357, "bug_title": "Use reader context classloader when checking for web classes in namespace handler", "bug_description": "Following discussion with Christian. In some situations (e.g. tooling), ClassUtils.getDefaultClassLoader() will fail to locate the web classes.  parserContext.getReaderContext().getBeanClassLoader() should be used instead.", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.config.SecurityNamespaceHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1358, "bug_title": "DefaultWebInvocationPrivilegeEvaluator fails with empty context path", "bug_description": "There is currently an assertion which checks that the context path has a length > 0, when in fact this is unnecessary.", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.web.access.DefaultWebInvocationPrivilegeEvaluator.java"], "label": 1, "es_results": []}, {"bug_id": 1359, "bug_title": "Typo in the Reference doc appendix B", "bug_description": "http://static.springsource.org/spring-security/site/docs/3.0.x/reference/appendix-namespace.html\nIn B.1.1 > realm\nproerty should read property ", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.java", "org.springframework.security.web.authentication.AbstractAuthenticationTargetUrlRequestHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1364, "bug_title": "Missing markup in the reference documentation section 8.4", "bug_description": "http://static.springsource.org/spring-security/site/docs/3.0.x/reference/core-web-filters.html#form-login-filter\nIn the first paragraph:\n<form-login>\nshould be wrapped within <tt></tt> to appear in monospace font", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.java", "org.springframework.security.web.authentication.AbstractAuthenticationTargetUrlRequestHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1367, "bug_title": "Type in the Reference documentation in section 19.2", "bug_description": "http://static.springsource.org/spring-security/site/docs/3.0.x/reference/taglibs.html#d4e2693\nIn the 1st paragraph:\n\"WebSecurityExpressionHandlder\"\nshould read\n\"WebSecurityExpressionHandler\"", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.java", "org.springframework.security.web.authentication.AbstractAuthenticationTargetUrlRequestHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1361, "bug_title": "Bad markup in Javadoc for UsernamePasswordAuthenticationFilter", "bug_description": "In the class description of clasa\norg.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter\nat\nhttp://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/web/authentication/UsernamePasswordAuthenticationFilter.html\nThe first <tt> tag is not well-balanced and the rest of the text shows up in monospace font.\n\"<tt>AuthenticationProcessingFilter<tt>\"\nshould be\n\"<tt>AuthenticationProcessingFilter</tt>\"", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.java", "org.springframework.security.web.authentication.AbstractAuthenticationTargetUrlRequestHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1366, "bug_title": "Typo in the reference documentation section 8.4.1", "bug_description": "http://static.springsource.org/spring-security/site/docs/3.0.x/reference/core-web-filters.html#form-login-flow-handling\nIn the 2nd paragraph:\n\"approprate\"\nshould read\n\"appropriate\"", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.java", "org.springframework.security.web.authentication.AbstractAuthenticationTargetUrlRequestHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1365, "bug_title": "Missing markup in the reference documentation section 8.4.1", "bug_description": "http://static.springsource.org/spring-security/site/docs/3.0.x/reference/core-web-filters.html#form-login-flow-handling\nIn the 2nd paragraph:\nAuthenticationSuccessHandler should be wrapped within <tt></tt> tags", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.java", "org.springframework.security.web.authentication.AbstractAuthenticationTargetUrlRequestHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1360, "bug_title": "Typo in the Javadoc for class AbstractAuthenticationTargetUrlRequestHandler", "bug_description": "In the JavaDoc for class\norg.springframework.security.web.authentication.AbstractAuthenticationTargetUrlRequestHandler\nat\nhttp://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/web/authentication/AbstractAuthenticationTargetUrlRequestHandler.html#setTargetUrlParameter(java.lang.String)\n\"...as the target URL if resent.\"\nshould read\n\"...as the target URL if present.\"", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.java", "org.springframework.security.web.authentication.AbstractAuthenticationTargetUrlRequestHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1363, "bug_title": "Type in the Reference documentation in section 6.1", "bug_description": "http://static.springsource.org/spring-security/site/docs/3.0.x/reference/core-services.html\nIn the 3rd paragraph:\n\"ProviderMananger\"\nshould read\n\"ProviderManager\"", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.java", "org.springframework.security.web.authentication.AbstractAuthenticationTargetUrlRequestHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1369, "bug_title": "Springbeans gets registered twice", "bug_description": "When Spring&apos;s beans-overriding property is set to false (bean overriding is forbidden), errors regarding duplicated beans are thrown (from Spring).\nAfter some debugging, I found the source of this problem in the following (and similar) lines inside the spring-security-config module.\nString id = pc.getReaderContext().registerWithGeneratedName(provider);\npc.registerBeanComponent(new BeanComponentDefinition(provider, id));\nThe problem is, that within the method registerWithGeneratedName, the method registerBeanDefinition is called (as the name says). This is also done when calling registerBeanComponent afterwards. \nIn my opinion, the solution is to replace the codelines above with:\nString id = pc.getReaderContext().generateBeanName(provider);\npc.registerBeanComponent(new BeanComponentDefinition(provider, id));\nThe problematic code fragment can be found in different classes of the module multiple times. \nReplacing all occurrences solved the problem on our test cases. Also, all the tests of the whole Spring Security framework were passed successfully.\nI attach a patch which includes the modification that i have done. \nThis was created from / for the 3.0.0.RELEASE tag.\nI hope, this can be helpful and will be integrated into the next release. \nCheers\nJonas", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.1.RELEASE", "fixed_files": ["org.springframework.security.config.authentication.AbstractUserDetailsServiceBeanDefinitionParser.java", "org.springframework.security.config.method.GlobalMethodSecurityBeanDefinitionParser.java", "org.springframework.security.config.http.RememberMeBeanDefinitionParser.java", "org.springframework.security.config.util.InMemoryXmlApplicationContext.java", "org.springframework.security.config.http.AuthenticationConfigBuilder.java", "org.springframework.security.config.http.HttpConfigurationBuilder.java", "org.springframework.security.config.http.HttpSecurityBeanDefinitionParser.java", "org.springframework.security.config.authentication.AuthenticationManagerBeanDefinitionParser.java", "org.springframework.security.config.http.FilterInvocationSecurityMetadataSourceParser.java"], "label": 1, "es_results": []}, {"bug_id": 1372, "bug_title": "SessionRegistryImpl.getAllSessions returns null, Interface says it should not", "bug_description": "The documentation for org.springframework.security.core.session.SessionRegistry#getAllSessions(Object, boolean) says \"Returns: the matching sessions for this principal (should not return null).\" However, the default implementation org.springframework.security.core.session.SessionRegistryImpl#getAllSessions(Object, boolean) returns null if \"final Set<String> sessionsUsedByPrincipal = principals.get(principal)\" is null.\nIt should, instead, return an empty list, per the interface specification and per good code practices such that methods that return lists should never return null, only empty lists when needed.", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.2.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy.java", "org.springframework.security.core.session.SessionRegistryImplTests.java", "org.springframework.security.core.session.SessionRegistryImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1392, "bug_title": "Cannot use custom PermissionEvaluator", "bug_description": "I created a PermissionEvaluator to use with the new security expressions. I wrote a unit test and I&apos;m trying to test it. If I use the default configuration, it works and denies the access to the secured method, since it is the default behavior, this is the configuration (I&apos;m omitting the authenticationmanager part) :\n<sec:global-method-security pre-post-annotations=\"enabled\">\nBut if I change the configuration in order to add my PermissionEvaluator, I get a NullPointerException while Spring initializes, this is my new config:\n    <sec:global-method-security pre-post-annotations=\"enabled\">\n        <sec:expression-handler ref=\"expressionHandler\"/>\n    </sec:global-method-security>\n    <bean id=\"expressionHandler\" class=\"org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler\">\n        <property name=\"permissionEvaluator\" ref=\"myPermissionEvaluator\"/>\n    </bean>\nAttached you&apos;ll see the stack-trace.\nthanks", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.2.RELEASE", "fixed_files": ["org.springframework.security.access.PermissionEvaluator.java", "org.springframework.security.config.method.GlobalMethodSecurityBeanDefinitionParserTests.java", "org.springframework.security.access.expression.method.MethodSecurityExpressionHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1404, "bug_title": "Expression not expanded in intercept-url pattern", "bug_description": "Expression is not expanded in intercept-url pattern.\nHere is my configuration :\n\n\n\n\n\n\n\t<security:http>\n\n\n\n\n\t\t<security:form-login login-page=\"${security.admin.loginPageUrl}\" login-processing-url=\"${security.admin.loginProcessingUrl}\" default-target-url=\"${security.admin.loginTargetUrl}\" always-use-default-target=\"true\" />\n\n\n\n\n\t\t<security:intercept-url pattern=\"${security.admin.loginPageUrl}\" filters=\"none\" />\n\n\n\n\n\t\t<security:intercept-url pattern=\"/restricted/**\" access=\"ROLE_ADMIN\" />\n\n\n\n\n\t\t<security:intercept-url pattern=\"/**\" access=\"ROLE_USER\" />\n\n\n\n\n\t</security:http>\n\n\n\n\n\n\nand the error I get :\n\n\n\n\n\n\norg.springframework.beans.factory.BeanDefinitionStoreException: Invalid bean definition with name &apos;org.springframework.security.filterChainProxy&apos; defined in null: Could not resolve placeholder &apos;security.admin.loginpageurl&apos;\n\n\n\n\n\n\nThe same expression works well in form-login#login-page attribute, but not in intercept-url#pattern attribute.\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.0.2.RELEASE", "fixed_files": ["org.springframework.security.config.http.HttpSecurityBeanDefinitionParser.java", "org.springframework.security.config.http.HttpConfigurationBuilder.java", "org.springframework.security.config.http.HttpSecurityBeanDefinitionParserTests.java", "org.springframework.security.web.access.expression.WebSecurityExpressionRoot.java"], "label": 1, "es_results": []}, {"bug_id": 1446, "bug_title": "Malformed Base64 in Basic Authentication header causes BasicAuthenticationFilter to throw a RuntimeException", "bug_description": "\nSince Base64.decode throws a RuntimeException if it detects bad characters in the input string, org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter throws the RTE if the Authentication header contains malformed base 64. The effect is that http servers return 500 rather than  401.\nMy fix just adds an additional check by calling Base64.isBase64, and if that fails, continues processing as if the Authentication header were missing.\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.web.authentication.www.BasicAuthenticationFilter.java", "org.springframework.security.web.authentication.www.BasicAuthenticationFilterTests.java"], "label": 1, "es_results": []}, {"bug_id": 1722, "bug_title": "HttpSession Destroyed/Created Event API confusion", "bug_description": "The api doc of HttpSessionCreatedEvent says:\n\"Published by the HttpSessionEventPublisher when a HttpSession is destroyed by the container\"\nis the HttpSessionDestroyedEvent should been fire when HttpSession is destroyed by the container?\nhttp://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/index.html", "project": "Spring", "sub_project": "SEC", "version": "3.0.0.RELEASE", "fixed_version": "3.1.0.RC2", "fixed_files": ["org.springframework.security.web.session.HttpSessionCreatedEvent.java"], "label": 1, "es_results": []}, {"bug_id": 1380, "bug_title": "\"access\" attribute in \"intercept-url\" should trim whitespace from attributes", "bug_description": "Currently \"ROLE_A, ROLE_B\" will map to two attributes, the second being \" ROLE_B\". Whitespace should be trimmed.", "project": "Spring", "sub_project": "SEC", "version": "3.0.1.RELEASE", "fixed_version": "3.0.2.RELEASE", "fixed_files": ["org.springframework.security.config.http.HttpSecurityBeanDefinitionParserTests.java", "org.springframework.security.access.SecurityConfig.java"], "label": 1, "es_results": []}, {"bug_id": 1384, "bug_title": "DefaultWebInvocationPrivilegeEvaluator bypass the accessDecisionManager when authorities are empty", "bug_description": "defaultWebInvocationPrivilegeEvaluator.isAllowed(...) always return false when authorities are empty.\nHere is the simple security configuration used:\n\t<http access-decision-manager-ref=\"accessDecisionManager\">\n\t\t<intercept-url pattern=\"/images/**\" filters=\"none\" />\n\t\t<intercept-url pattern=\"/scripts/**\" filters=\"none\" />\n\t\t<intercept-url pattern=\"/styles/**\" filters=\"none\" />\n\t\t<intercept-url pattern=\"/csmprobe.html*\" filters=\"none\" />\n\t\t<intercept-url pattern=\"/login.htm*\" access=\"ROLE_ANONYMOUS\" />\n\t\t<intercept-url pattern=\"/**\" access=\"IS_AUTHENTICATED_FULLY\" />\n\t\t<form-login login-page=\"/login.htm\"\n\t\t\talways-use-default-target=\"true\"\n\t\t\tdefault-target-url=\"/siteSelection.htm\"\n\t\t\tauthentication-failure-url=\"/login.htm?login_error=1\" />\n\t\t<logout />\n\t</http>\n\t<ldap-server\n\t\turl=\"$\n{ldap.url}\n/$\n{ldap.base}\n\"\n\t\tmanager-dn=\"$\n{ldap.managerDn}\n\"\n\t\tmanager-password=\"$\n{ldap.managerPassword}\n\" />\n\t<authentication-manager alias=\"authenticationManager\">\n\t\t<ldap-authentication-provider user-search-filter=\"(uid=\n{0}\n)\"\n\t\t\tuser-search-base=\"$\n{ldap.userSearchBase}\n\"\n\t\t\tgroup-search-base=\"$\n{ldap.groups}\n\" />\n\t</authentication-manager>\n\t<beans:bean id=\"accessDecisionManager\" class=\"org.springframework.security.access.vote.AffirmativeBased\">\n\t\t<beans:property name=\"decisionVoters\">\n\t\t\t<beans:list>\n\t\t\t\t<beans:bean class=\"org.springframework.security.access.vote.AuthenticatedVoter\" />\n\t\t\t\t<beans:bean class=\"org.springframework.security.access.vote.RoleVoter\" />\n\t\t\t</beans:list>\n\t\t</beans:property>\n\t</beans:bean>\nUsers with no authorities have access to all pages (IS_AUTHENTICATED_FULLY) according to the filter configuration but defaultWebInvocationPrivilegeEvaluator.isAllowed(...) says the opposite. The implementation has this check: \n        if (authentication == null || authentication.getAuthorities().isEmpty()) \n{\n            return false;\n        }\n\nauthentication.getAuthorities().isEmpty() should be removed to allow decision voters do their work.", "project": "Spring", "sub_project": "SEC", "version": "3.0.1.RELEASE", "fixed_version": "3.0.2.RELEASE", "fixed_files": ["org.springframework.security.web.access.DefaultWebInvocationPrivilegeEvaluator.java"], "label": 1, "es_results": []}, {"bug_id": 1412, "bug_title": "Login page redisplays when used with Spring 3's ShallowEtagHeaderFilter", "bug_description": "Adding ShallowEtagHeaderFilter to a web application that uses Spring Security will cause the redisplay of the Spring Security login page on the second login attempt. This was initially reported widely within the Spring Roo community and resulted in bug report ROO-579.\nThe problem can be seen by:\n1. Active ShallowEtagHeaderFilter in a Spring Security application that has a normal login page\n2. Visit the home page, attempt to access a secure page, and view the login page\n3. Complete the login page, submit, and you should see the secure page (correct)\n4. Logout\n5. Attempt to access the same secure page again\n6. The login page will display (correct)\n7. Enter valid credentials and submit\n   --> The login page will re-display (incorrect)\n   --> What should have happened is the secure page would display, as you&apos;ve now authenticated\nI have reproduced this with the Spring Security tutorial 3.0.1 web application WAR. I have made no changes to the WAR except modifying the web.xml to the following (I have included both filters for clarification of the order):\n\n\n\n\n\n\n    <filter>\n\n\n\n\n        <filter-name>springSecurityFilterChain</filter-name>\n\n\n\n\n        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>\n\n\n\n\n    </filter>\n\n\n\n\n\n\n\n\n\n\t<filter>\n\n\n\n\n\t\t<filter-name>etagFilter</filter-name>\n\n\n\n\n\t\t<filter-class>org.springframework.web.filter.ShallowEtagHeaderFilter</filter-class>\n\n\n\n\n\t</filter>\n\n\n\n\n\n\n\n\n\n    <filter-mapping>\n\n\n\n\n      <filter-name>springSecurityFilterChain</filter-name>\n\n\n\n\n      <url-pattern>/*</url-pattern>\n\n\n\n\n    </filter-mapping>\n\n\n\n\n\n\n\n\n\n\t<filter-mapping>\n\n\n\n\n\t\t<filter-name>etagFilter</filter-name>\n\n\n\n\n\t\t<url-pattern>/*</url-pattern>\n\n\n\n\n\t</filter-mapping>\n\n\n\n\n\n\nI have attached the tutorial WAR where you can see the problem by deploying to Tomcat. Simply access the \"secure page\", login as normal, and it will display. Then logout and click to view the \"secure page\" again. The login page will display. Login as normal, and on submission you will erroneously see the login page again. The problem can be avoided by disabling the ShallowEtagHeaderFilter in web.xml.", "project": "Spring", "sub_project": "SEC", "version": "3.0.1.RELEASE", "fixed_version": "3.0.2.RELEASE", "fixed_files": ["org.springframework.security.web.savedrequest.DefaultSavedRequest.java", "org.springframework.security.web.savedrequest.DefaultSavedRequestTests.java"], "label": 1, "es_results": []}, {"bug_id": 1410, "bug_title": "Remember Me does not work with OpenID urls contatining \"https://\"", "bug_description": "As of 3.0.1, AbstractRememberMeServices.decodeCookie() treats usernames with \"http://\" as a special case for compatibility with OpenID. But some OpenID providers use \"https://...\" in their identity urls, and cookies with such usernames are decoded incorrectly.", "project": "Spring", "sub_project": "SEC", "version": "3.0.1.RELEASE", "fixed_version": "3.0.2.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.rememberme.AbstractRememberMeServices.java", "org.springframework.security.web.authentication.rememberme.AbstractRememberMeServicesTests.java"], "label": 1, "es_results": []}, {"bug_id": 1454, "bug_title": "@PreAutorize(#username == principal.username) issues - when target is AOPProxy", "bug_description": "Hi Luke/Anybody,\nWhen used @PreAutorize(#username == principal.username) issues - when target is AOPProxy I always get an NullPointerExpression in MethodSecurityEvaluationContext addArgumentsAsVariables method. I have compiled with debug info, no issues with that. \nI have looked at the bug report which is the same case for Genrics http://jira.springframework.org/browse/SEC-1448\nHowever, in my case my target object is wrapped in a AOPproxy(JdkDynamicProxy), but when used with AopUtils.getMostSpecificMethod(method, target) it always returns the class as $Proxy which cannot be read by the parameterDiscoverer. May be I have a wrapper of AOPProxy inside another AOPProxy which wraps my target. I guess it is a valid case. \nI could able to get around it by having custom EvaluationContext which first try run through a loop and get the target object as below \nwhile (candidate instanceof TargetClassAware) { // This is to ensure that we get to the final target object - most specific.\nif (candidate instanceof TargetSource) {\ncandidate = ((TargetSource)candidate).getTarget(); \n} else if (candidate instanceof Advised){\ncandidate =((Advised) candidate).getTargetSource();\n}\n}\nreturn AopUtils.getTargetClass(candidate);\nHowever I still consider this as a work around and it would be nice that spring-security supports this out of the box, as it is so common that we use AOPproxy&apos;s as target object. \n-----------------------------------------------------------------------------------------------------------\nI just copy below source code from Spring-sec MethodSecurityEvaluationContext class\nprivate void addArgumentsAsVariables() {\nObject[] args = mi.getArguments();\nObject targetObject = mi.getThis();\nMethod method = ClassUtils.getMostSpecificMethod(mi.getMethod(), targetObject.getClass());\nString[] paramNames = parameterNameDiscoverer.getParameterNames(method);\nfor(int i=0; i < args.length; i++) {\nsuper.setVariable(paramNames[i], args[i]);\n}\n}\nI was talking about targetObject in this method, which is the class/interface that is annotated with preAuthorize. And in my application context the bean is wrapped in multi levels of AOPproxy&apos;s. \nI am not sure whether it is Spring issue or Spring sec issue, because in 3.0.3 even spring sec uses AopUtils.getMostSpecificmethod(method, target) this issue will not be solved as AopUtils just looks one level not recursively until it hits the right target. \nI would open a JIRA issue, if possible with a test case.\nLuke,\nI told I will open JIRA with a test case, but it is difficult that I trim down my application context to make this test case. Please let me know if you cannot reproduce it then i will fetch some time to create a test case. ", "project": "Spring", "sub_project": "SEC", "version": "3.0.1.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.access.expression.method.MethodSecurityEvaluationContext.java"], "label": 1, "es_results": []}, {"bug_id": 1413, "bug_title": "AbstractRetryEntryPoint should use RedirectStrategy", "bug_description": "For consistency, AbstractRetryEntryPoint should probably use RedirectStrategy as implemented in SEC-1226. Possible use cases include URL pre-processing, which users might want consistently applied.\nLet me know if you agree and I am happy to supply a patch.", "project": "Spring", "sub_project": "SEC", "version": "3.0.1.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.web.access.channel.RetryWithHttpEntryPointTests.java", "org.springframework.security.web.access.channel.AbstractRetryEntryPoint.java", "org.springframework.security.web.access.channel.RetryWithHttpsEntryPointTests.java"], "label": 1, "es_results": []}, {"bug_id": 1133, "bug_title": "Allow setting authenticationDetailsSource ref via form-login namespace URL", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.0.1.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.config.http.AuthenticationConfigBuilder.java", "org.springframework.security.config.http.FormLoginBeanDefinitionParser.java", "org.springframework.security.config.http.HttpSecurityBeanDefinitionParser.java", "org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1561, "bug_title": "HttpSecurityContextRepository fails to store security context to a newly authenticated session", "bug_description": "When a second (or later subsequent) authentication attempt arrives on an already authenticated session and session attribute migration is disabled the security context is not always persisted to the new session.\nWith an existing authenticated session, subsequent POST requests to the form-login login-processing url will destroy the old session and create a new session. Occasionally the hash code of the persisted security context does not change and so the HttpSecurityContextRepository does not \"update\" the context stored in the session. The problem is that the old session held the unchanged security context but the new session does not hold any security context. After successfully authenticating another authentication is required because the new session does not contain a SecurityContext.\nOne factor causing the HttpSecurityContextRepository to not update/store the SecurityContext is that the session id stored in the security context is the old session id, even after that session has been destroyed and a new one created to replace it. This allows the SecurityContext hashCode to remain the same even though some aspect of the SecurityContext has indeed changed.\nThe check to set the security context attribute in HttpSecurityContextRepository.SaveToSessionResponseWrapper.saveContext should probably include something to ensure that the current session actually does contain the context, whether it has changed or not. In the case that the context has not changed, but the session has, the context should be stored to the new session.", "project": "Spring", "sub_project": "SEC", "version": "3.0.1.RELEASE", "fixed_version": "3.1.0.M2", "fixed_files": ["org.springframework.security.web.context.HttpSessionSecurityContextRepository.java"], "label": 1, "es_results": []}, {"bug_id": 1661, "bug_title": "LDAP search base should not require JNDI escaping in addition to LDAP escaping for special characters", "bug_description": "Having double quotes in the base dn (search base) does not work.  \nThe following base dn value is valid, but does not work:\n\nOU=\"Admin Users\",OU=TEST-NC,DC=TESTCustomers,DC=Com\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.1.RELEASE", "fixed_version": "3.1.0.RC1", "fixed_files": ["org.springframework.security.ldap.AbstractLdapIntegrationTests.java", "org.springframework.security.ldap.SpringSecurityLdapTemplate.java", "org.springframework.security.ldap.authentication.BindAuthenticatorTests.java"], "label": 1, "es_results": []}, {"bug_id": 1425, "bug_title": "AbstractRememberMeServices not handling properly empty cookie", "bug_description": "Whwn empty cookie is sent to AbstractRememberMeServices, it will throw java.lang.ArrayIndexOutOfBoundsException instead of org.springframework.security.web.authentication.rememberme.InvalidCookieException\nThis can be fixed by adding \nif (tokens.length == 0) {\n    throw new InvalidCookieException( \"No cookie!?\");\n}\nafter \nString[] tokens = StringUtils.delimitedListToStringArray(cookieAsPlainText, DELIMITER);\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.2.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.web.authentication.rememberme.AbstractRememberMeServices.java", "org.springframework.security.web.authentication.rememberme.AbstractRememberMeServicesTests.java"], "label": 1, "es_results": []}, {"bug_id": 1432, "bug_title": "UserMap should convert supplied maps to lower case", "bug_description": "Since it converts a username to lower-case before doing a lookup in the map, it makes sense that the keys should also be converted when a new map is supplied.", "project": "Spring", "sub_project": "SEC", "version": "3.0.2.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.config.authentication.UserServiceBeanDefinitionParserTests.java", "org.springframework.security.config.authentication.UserServiceBeanDefinitionParser.java", "org.springframework.security.core.userdetails.memory.UserMap.java"], "label": 1, "es_results": []}, {"bug_id": 1439, "bug_title": "getRequest() / getResponse() is not public in org.springframework.security.web.context.HttpRequestResponseHolder", "bug_description": "Custom SecurityContextRepository implementation relies on HttpRequestResponseHolder parameter in method  \npublic SecurityContext loadContext(HttpRequestResponseHolder requestResponseHolder).\nSince getters and setters of HttpRequestResponseHolder properties are not public, pluggable repository mechanism is broken. \n", "project": "Spring", "sub_project": "SEC", "version": "3.0.2.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.web.context.HttpRequestResponseHolder.java"], "label": 1, "es_results": []}, {"bug_id": 1443, "bug_title": "Jsr250Voter will return access denied for allowed roles", "bug_description": "Method vote() from Jsr250Voter.java will return ACCESS_DENIED if the FIRST role from definition does not exists in authentication.getAuthorities() list.\n public int vote(Authentication authentication, Object object, Collection<ConfigAttribute> definition) {\n        for (ConfigAttribute attribute : definition) {\n           //...\n            if (supports(attribute)) {\n                // Attempt to find a matching granted authority\n                for (GrantedAuthority authority : authentication.getAuthorities()) {\n                    if (attribute.getAttribute().equals(authority.getAuthority())) \n{\n                        return ACCESS_GRANTED;\n                    }\n                }\n                // No match - deny access\n                return ACCESS_DENIED; // <-------- will return ACCESS_DENIED too soon\n            }\n        } \n        return ACCESS_ABSTAIN;\n    }", "project": "Spring", "sub_project": "SEC", "version": "3.0.2.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.access.annotation.Jsr250Voter.java"], "label": 1, "es_results": []}, {"bug_id": 1444, "bug_title": "BindAuthentiator Fails for Active Directory DN Containing Special Chars", "bug_description": "BindAuthenticator.java (3.0.2) line 115, change userDN:\nAttributes attrs = ctx.getAttributes(userDn, getUserAttributes());\nto fullDn:\nAttributes attrs = ctx.getAttributes(fullDn, getUserAttributes());\nThe reason is that when you use fullDn the DN string is generated using the LdapEncoder from Spring-LDAP.   If you use the raw userDn string that encoding isn&apos;t used, so special characters in a username (admittedly rare) can prevent the user from authenticating.\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.2.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.ldap.search.FilterBasedLdapUserSearchTests.java", "org.springframework.security.ldap.authentication.BindAuthenticator.java", "org.springframework.security.ldap.SpringSecurityLdapTemplate.java", "org.springframework.security.ldap.authentication.BindAuthenticatorTests.java"], "label": 1, "es_results": []}, {"bug_id": 1480, "bug_title": "LdapUserDetailsImpl does not override equals/hashCode", "bug_description": "result is that namespace session management config does not work with default LdapUserDetailsImpl.", "project": "Spring", "sub_project": "SEC", "version": "3.0.2.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.ldap.userdetails.LdapUserDetailsImpl.java", "org.springframework.security.ldap.userdetails.InetOrgPersonTests.java"], "label": 1, "es_results": []}, {"bug_id": 1500, "bug_title": "Target-URL changes while switching between secure and insecure channel, when it was encoded according to RFC 3986", "bug_description": "This issue is simmilar to the issue SEC-1255 \"Target-URL after successfull login differes from original URL, when it was encoded according to RFC 3986\"\nhttp://jira.springframework.org/browse/SEC-1255\nWhen switching the channel, AbstractRetryEntryPoint rebuilds the URL from its decoded parts.\nSo, when switching on a URL, that containes a special character (like &apos;?&apos;), which is encoded according to RFC 3986, it changes the URL.\nFor example, the URL \"/foo%3Fbar.html\", where \"%3F\" encodes the \"?\", becomes \"/foo?bar.html\", which is not encoded correctly, thus resulting in a 404-Error.\nEncoding the rebuild URL would not work, becaus all special characters (like contained slashes for example) would be encoded than, which is, as far as I know, not correct. \nI fixed the issue in my local git repository by calling the UrlUtils, which were fixed in issue SEC-1255, for building the redirect URL.\nI will apply my patch to this bug-report.\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.2.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.web.access.channel.RetryWithHttpEntryPointTests.java", "org.springframework.security.web.access.channel.AbstractRetryEntryPoint.java", "org.springframework.security.web.util.UrlUtils.java", "org.springframework.security.web.access.channel.RetryWithHttpsEntryPointTests.java"], "label": 1, "es_results": []}, {"bug_id": 1501, "bug_title": "Documention uses incorrect package in example bean definition", "bug_description": "The JavaDoc page for SwitchUserFilter lists an example bean definition:\n <bean id=\"switchUserProcessingFilter\" class=\"org.springframework.security.web.authentication.SwitchUserFilter\">\n    <property name=\"userDetailsService\" ref=\"userDetailsService\" />\n    <property name=\"switchUserUrl\"><value>/j_spring_security_switch_user</value></property>\n    <property name=\"exitUserUrl\"><value>/j_spring_security_exit_user</value></property>\n    <property name=\"targetUrl\"><value>/index.jsp</value></property></bean>\nThe package is incorrectly stated as org.springframework.security.web.authentication; it should be org.springframework.security.web.authentication.switchuser", "project": "Spring", "sub_project": "SEC", "version": "3.0.2.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.web.authentication.switchuser.SwitchUserFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1543, "bug_title": "IpAddressMatcher does not act like expected", "bug_description": "When configuring a constraint like \"hasIpAddress(&apos;X.X.X.X&apos;)\", Spring-Security usees the class org.springframework.security.web.util.IpAddressMatcher to compare the given IP with the IP from the request.\nUnfortunatly, IpAddressMatcher throws an IllegalArgumentException, when the given IP and the IP from the request are of different type. This happens for example, when the request uses an IPv6-Address, but the Address used in \"hasIpAddress()\" was an IPv4-Address. The unexpected outcome of this behavior is, that any IPv6-request matching the resource will only see an error-page!\nI suggest, that IpAddressMatcher responds with \"false\", if the given Address and the Address in the Request are of different type. That would solve this issue and is also the behavior I would expect: two IP-Addresses of different type are simply always not equal!", "project": "Spring", "sub_project": "SEC", "version": "3.0.2.RELEASE", "fixed_version": "3.1.0.M2", "fixed_files": ["org.springframework.security.web.util.IpAddressMatcher.java"], "label": 1, "es_results": []}, {"bug_id": 1592, "bug_title": "CAS proxy receptor requests must not pass through the filter chain", "bug_description": "I configured spring-security-cas in my webapp for generating proxy tickets.\nDuring ticket validation we provide a pgtUrl parameter and then the CAS server tries\nto connect to our webapp (using the configured proxyReceptorUrl) to determine is this\nURL is a valid end-point but it result in a 404 because the request is passed trough\nthe servlet but is not handled (because no controller is mapped for this URL).\nIf we set the grails.plugins.springsecurity.rejectIfNoRule parameter [1] to true or if I mark this\nproxy receptor URL with the role \"IS_AUTHENTICATED_REMEMBERED\" then it works:\n\nthe ping request [2] result in a 302 (redirection to CAS because the request needs to be authenticated)\nthe pgtId/pgtIou request result also in a 302 (therefore without the proper XML fragment) but the mapping is stored\n\nThis works because the CAS server is not strict about the expected XML fragment,\nonly the a proper status code is mandatory [2].\nCurrent workaround is to create a controller for this URL with anonymous access and\nalways respond with a 200 and some text.\nI believe this issue is not related to Grails and may impact any webapp using\nspring-security-cas and wanting to generate proxy tickets.\nFurthermore, the default behaviour in cas-client [3] is already to stop processing the\nrequest once it has been handled by the Cas20ProxyReceivingTicketValidationFilter [3].\n[1] http://burtbeckwith.github.com/grails-spring-security-core/docs/manual/index.html\n[2] https://source.jasig.org/cas3/tags/cas-3-3-5-1-final/cas-server-core/src/main/java/org/jasig/cas/authentication/handler/support/HttpBasedServiceCredentialsAuthenticationHandler.java\n[2] https://source.jasig.org/cas3/tags/cas-3-3-5-1-final/cas-server-core/src/main/java/org/jasig/cas/util/HttpClient.java\n[3] https://source.jasig.org/cas-clients/java-client/tags/cas-client-3.1.12/cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ProxyReceivingTicketValidationFilter.java\n[3] https://source.jasig.org/cas-clients/java-client/tags/cas-client-3.1.12/cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractTicketValidationFilter.java", "project": "Spring", "sub_project": "SEC", "version": "3.0.2.RELEASE", "fixed_version": "3.1.0.RC1", "fixed_files": ["org.springframework.security.cas.web.CasAuthenticationFilterTests.java", "org.springframework.security.cas.web.CasAuthenticationFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1519, "bug_title": "Uninitialized auditLogger and aclAuthorizationStrategy fields in EhCacheBasedAclCache ", "bug_description": "The \"auditLogger\" and \"aclAuthorizationStrategy\" fields of EhCacheBasedAclCache class are initialized by the first \"putInCache\" method call:\n...\n        if (this.aclAuthorizationStrategy == null) {\n            if (acl instanceof AclImpl) \n{\n                this.aclAuthorizationStrategy = (AclAuthorizationStrategy) FieldUtils.getProtectedFieldValue(\"aclAuthorizationStrategy\", acl);\n                this.auditLogger = (AuditLogger) FieldUtils.getProtectedFieldValue(\"auditLogger\", acl);\n            }\n        }\n...\nIn a clustered EhCache environment, with cache configured for replication, the problem is that if you invoke \"initializeTransientFields\" (through getFromCache methods) on a node before any \"putInCache\", both fields are null so a NullPointerException is thrown similarly to SEC-1514.\nI think the solution is very simple: remove the initialization of \"auditLogger\" and \"aclAuthorizationStrategy\" from the \"putInCache\" method and use constructor (or method) injection of both properties.", "project": "Spring", "sub_project": "SEC", "version": "3.0.3.RELEASE", "fixed_version": "3.1.0.M1", "fixed_files": ["org.springframework.security.acls.domain.EhCacheBasedAclCache.java"], "label": 1, "es_results": []}, {"bug_id": 1578, "bug_title": "ThreadLocalSecurityContextHolderStrategy.clearContext() should use ThreadLocal.remove()", "bug_description": "It appears that calling ThreadLocal.set(null) causes some memory problems that can be fixed as of JDK 1.5 using ThreadLocal.remove() It may be wise to update ThreadLocalSecurityContextHolderStrategy.clearContext() to use remove now that Spring Security relies on JDK 1.5. This is also consistent with other portions of Spring https://jira.springsource.org/browse/SPR-7441", "project": "Spring", "sub_project": "SEC", "version": "3.0.3.RELEASE", "fixed_version": "3.1.0.M2", "fixed_files": ["org.springframework.security.core.context.InheritableThreadLocalSecurityContextHolderStrategy.java", "org.springframework.security.core.context.ThreadLocalSecurityContextHolderStrategy.java"], "label": 1, "es_results": []}, {"bug_id": 1583, "bug_title": "wrong info in Docs", "bug_description": "from Docs http://static.springsource.org/spring-security/site/docs/3.0.x/reference/ns-config.html\n@PreAuthorize(\"hasAuthority(&apos;ROLE_TELLER&apos;)\")\nbut \"hasAuthority\" is wrong. work around is to use \"hasRole\" instead.\n<intercept-url pattern=\"/login.jsp*\" access=\"IS_AUTHENTICATED_ANONYMOUSLY\"/> also is not working.\njava.lang.IllegalArgumentException: Failed to evaluate expression &apos;IS_AUTHENTICATED_ANONYMOUSLY&apos;\nwork around is to use:\n<intercept-url pattern=\"/login.jsp*\" access=\"permitAll\" />\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.3.RELEASE", "fixed_version": "3.1.0.M2", "fixed_files": ["org.springframework.security.access.expression.SecurityExpressionRootTests.java", "org.springframework.security.access.expression.SecurityExpressionRoot.java"], "label": 1, "es_results": []}, {"bug_id": 1590, "bug_title": "WebAuthenticatonDetails.doPopulateAdditionalInformation should be removed", "bug_description": "I have a class that extends org.springframework.security.web.authentication.WebAuthenticationDetails class and implements org.springframework.security.core.authority.GrantedAuthoritiesContainer.\nIt overrides the method doPopulateAdditionalInformation to retrieve the additional information from the request headers.\nWhen running the application I receive an illegalArgumentException thrown from Assert.notNull, with the message \"Cannot pass a null GrantedAuthority collection\".\nInvestigating this showed that the WebAuthenticationDetails constructor calls doPopulateAdditionalInformation as its last step, this does initialize my members with correct values, but after the constructor returns, my derived class constructor gets called, re-initializing the fields again, re-setting my List<GrantedAuthority> back to null.\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.3.RELEASE", "fixed_version": "3.1.0.M2", "fixed_files": ["org.springframework.security.web.authentication.WebAuthenticationDetails.java"], "label": 1, "es_results": []}, {"bug_id": 1587, "bug_title": "HttpSessionSecurityContextRepository should clear session context when current context is anonmous or empty", "bug_description": "I have written a LogoutFilter which does not redirect to a logout page. It just logs out the user and goes on with the filter chain.\n(it&apos;s needed because we have different areas and the user should be logged out when switching to another \"area\")\nBefore it comes to saving the security context with HttpSessionSecurityContextRepository the anonymousFilter sets an AnonymousAuthentication. So when it comes to saving the context, it is not saved.\nThis is because of this code in HttpSessionSecurityContextRepository\nprotected void saveContext(SecurityContext context) {\n            // See SEC-776\n   if (authenticationTrustResolver.isAnonymous(context.getAuthentication())) {\n                if (logger.isDebugEnabled()) \n{\n                    logger.debug(\"SecurityContext contents are anonymous - context will not be stored in HttpSession. \");\n                }\n                return;\n    }\nBY THE WAY my LogoutFilter is configured with invalidateHttpSession=false otherwise this bug wouldn&apos;t occur i guess.\nSo imho, there should be another check to see what is actually saved in the session.\nregards\nJanning", "project": "Spring", "sub_project": "SEC", "version": "3.0.3.RELEASE", "fixed_version": "3.1.0.M2", "fixed_files": ["org.springframework.security.web.context.HttpSessionSecurityContextRepositoryTests.java", "org.springframework.security.web.context.HttpSessionSecurityContextRepository.java"], "label": 1, "es_results": []}, {"bug_id": 1545, "bug_title": "Missing I18N Keys in messages.properties", "bug_description": "spring-security-core&apos;s default message.properties is missing at least one i18n key (LdapAuthenticationProvider.badCredentials).\nI haven&apos;t gotten time to look for others, and it would be nice to address other potentials. Unless the bug assignee beats me to it, in the next couple days I can write a quick script that will get all the missing ones. I will then post a patch for the messages that I can do (i.e. if there isn&apos;t already a translation I probably cannot submit a fix for that language).\nAnyone viewing this bug can easily work around this issue by providing their own message.properties as outlined in the spring security reference [1].\n[1] http://static.springsource.org/spring-security/site/docs/3.0.x/reference/technical-overview.html#localization", "project": "Spring", "sub_project": "SEC", "version": "3.0.3.RELEASE", "fixed_version": "3.1.0.RC1", "fixed_files": ["org.springframework.security.ldap.authentication.LdapAuthenticationProvider.java", "org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy.java", "org.springframework.security.web.authentication.preauth.x509.SubjectDnX509PrincipalExtractor.java", "org.springframework.security.core.SpringSecurityMessageSourceTests.java", "org.springframework.security.acls.afterinvocation.AclEntryAfterInvocationProvider.java", "org.springframework.security.ldap.authentication.BindAuthenticator.java", "org.springframework.security.authentication.AccountStatusUserDetailsChecker.java"], "label": 1, "es_results": []}, {"bug_id": 1607, "bug_title": "Spring Security version checking reports Spring Version instead of Spring Security version", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.0.4.RELEASE", "fixed_version": "3.1.0.M2", "fixed_files": ["org.springframework.security.core.SpringSecurityCoreVersion.java"], "label": 1, "es_results": []}, {"bug_id": 1608, "bug_title": "FirewalledRequest.reset() is not called for a resource with no filters", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.0.4.RELEASE", "fixed_version": "3.1.0.M2", "fixed_files": ["org.springframework.security.web.FilterChainProxyTests.java", "org.springframework.security.web.FilterChainProxy.java"], "label": 1, "es_results": []}, {"bug_id": 1614, "bug_title": "Status 404 with Apache Tiles", "bug_description": "We use Apache Tiles 2.1.4 to render our pages. After we&apos;ve upgraded to Spring Security 3.0.4 we received a \"HTTP Status 404\" error page from tomcat when accessing some pages.\nWhen we use a custom HttpFirewall and FirewalledRequest, which does nothing, the errors disappear.\nAs far as I found out all pages are impacted which are \"excluded\" from Spring Security&apos;s FilterChainProxy, as our login and logout pages for example.\nI think that issue is related to SEC-1608. \nTiles does various forwards/includes during the rendering phase which (obviously) will change the ServletPath and PathInfo\nTo track down the error, I&apos;ve developed a custom \"RequestWrapper\" which outputs the original and stripped version of the ServletPath and PathInfo:\nConstructor - StrippedServletPath: /main - StrippedPathInfo: /login/login.htm\ngetServletPath() - stripPaths: true - strippedServletPath: /main - servletPath: /main\ngetPathInfo() - stripPaths: true - strippedPathInfo: /login/login.htm - pathInfo: /login/login.htm\ngetServletPath() - stripPaths: true - strippedServletPath: /main - servletPath: /main\ngetServletPath() - stripPaths: true - strippedServletPath: /main - servletPath: /main\ngetServletPath() - stripPaths: true - strippedServletPath: /main - servletPath: /main\ngetPathInfo() - stripPaths: true - strippedPathInfo: /login/login.htm - pathInfo: /login/login.htm\ngetServletPath() - stripPaths: true - strippedServletPath: /main - servletPath: /WEB-INF/layouts/plain.jsp\nAs you can see at the end of the request the \"strippedServletPath\" and \"servletPath\" are different while \"stripPaths\" is still true. Therefore the \"wrong\" stripped ServletPath gets returned and Tiles fails to render the response correctly.\ngetPathInfo() - stripPaths: true - strippedPathInfo: /login/login.htm - pathInfo: null", "project": "Spring", "sub_project": "SEC", "version": "3.0.4.RELEASE", "fixed_version": "3.1.0.M2", "fixed_files": ["org.springframework.security.web.FilterChainProxyTests.java", "org.springframework.security.web.FilterChainProxy.java"], "label": 1, "es_results": []}, {"bug_id": 1670, "bug_title": "SpringSecurityLdapTemplate should use a CompositeName to remove JNDI escaping from SearchResult.getName()", "bug_description": "SearchResult.getName() returns a CompositeName syntax, so JNDI special characters will be escaped, which we don&apos;t want in a pure-LDAP name. The result should be wrapped in a CompositeName() before passing to the constructor for DistinguishedName. The latter knows how to deal with CompositeNames.\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.5.RELEASE", "fixed_version": "3.1.0.RC1", "fixed_files": ["org.springframework.security.ldap.authentication.BindAuthenticator.java", "org.springframework.security.ldap.SpringSecurityLdapTemplate.java", "org.springframework.security.ldap.AbstractLdapIntegrationTests.java", "org.springframework.security.ldap.authentication.BindAuthenticatorTests.java"], "label": 1, "es_results": []}, {"bug_id": 1705, "bug_title": "Namespace creates spurious OpenIDAuthenticationFilter bean", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.0.5.RELEASE", "fixed_version": "3.1.0.RC2", "fixed_files": ["org.springframework.security.config.http.AuthenticationConfigBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 1768, "bug_title": "Using the \"*\" wildcard in intercept-method does not include implemented interfaces", "bug_description": "Created on behalf of client, with the following use case:\n1.  Bean is secured via the intercept-methods tag.\n2.  The method attributed of the protect tag is set to \"*\"\n3.  Bean implements an interface and is annotated with @Transactional.\n4.  None of the methods on the interface are protected unless the interface is explicitly defined in the method attribute.\nIn this case only the methods on the bean, not the interface are secured when the method is \"\".  They feel that in addition to the methods declared on the bean, all implemented interface methods should also be secured when the \"\" is specified for the method.\nAttached is a sample test case illustrating the behavior.", "project": "Spring", "sub_project": "SEC", "version": "3.0.5.RELEASE", "fixed_version": "3.0.6.RELEASE", "fixed_files": ["org.springframework.security.access.method.AbstractMethodSecurityMetadataSource.java", "org.springframework.security.config.TestBusinessBeanImpl.java", "org.springframework.security.config.method.InterceptMethodsBeanDefinitionDecorator.java", "org.springframework.security.config.method.InterceptMethodsBeanDefinitionDecoratorTests.java"], "label": 1, "es_results": []}, {"bug_id": 1782, "bug_title": "Incorrect Javadoc in LdapAuthenticationProvider", "bug_description": "This page:\nhttp://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/ldap/authentication/LdapAuthenticationProvider.html\nHas instructions for wiring up a BindAuthenticator. But the package name of the BindAuthenticator has changed recently. So the package name is now wrong.\nIn the text BindAuthenticator is here:\norg.springframework.security.authentication.ldap.authenticator.BindAuthenticator\nBut in the latest version it&apos;s actually here:\norg.springframework.security.ldap.authentication.BindAuthenticator", "project": "Spring", "sub_project": "SEC", "version": "3.0.5.RELEASE", "fixed_version": "3.0.6.RELEASE", "fixed_files": ["org.springframework.security.ldap.authentication.LdapAuthenticationProvider.java"], "label": 1, "es_results": []}, {"bug_id": 1772, "bug_title": "Unneeded URL decode in SimpleUrlLogoutSuccessHandler", "bug_description": "URLDecoder.decode(targetUrl, \"UTF-8\") call is not needed in org.springframework.security.web.authentication.logout.SimpleUrlLogoutSuccessHandler and it breaks URLs with GET parameters escaped in them.\np.s. also isUseReferer() is missing.", "project": "Spring", "sub_project": "SEC", "version": "3.0.5.RELEASE", "fixed_version": "3.1.0.RC3", "fixed_files": ["org.springframework.security.web.authentication.AbstractAuthenticationTargetUrlRequestHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1792, "bug_title": "NullPointerException in RunAsUserToken#toString() when originalAuthentication is null", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.0.5.RELEASE", "fixed_version": "3.1.0.RC3", "fixed_files": ["org.springframework.security.access.intercept.RunAsUserTokenTests.java", "org.springframework.security.access.intercept.RunAsUserToken.java"], "label": 1, "es_results": []}, {"bug_id": 1790, "bug_title": "URL spring-security-redirect parameters vulnerable to CRLF injection by default.", "bug_description": "AbstractAuthenticationTargetUrlRequestHandler#determineTargetUrl(HttpServletRequest, HttpServletResponse) calls URLDecoder.decode, and the result is directly feed to DefaultRedirectStrategy by default, which does not filter line feeds, injecting a custom header after \"Location\"\nRequest:\nGET\n/mywebapp/logout/spring-security-redirect=%0d%0a%20SomeCustomInjectedHeader%3ainjected_\nby_wvs HTTP/1.1\nResponse:\nHTTP/1.1 302 Moved Temporarily\nDate: Tue, 19 Jul 2011 15:28:57 GMT\nLocation: xxxxxxxxxxxxxxx\nSomeCustomInjectedHeader: injected_by_wvs\nContent-Length: 0\nConnection: close\nContent-Type: text/plain; charset=UTF-8\nYou need to restrict CR(0x13) and LF(0x10) from the user input or properly encode the output in order to prevent the injectino of custom HTTP headers.", "project": "Spring", "sub_project": "SEC", "version": "3.0.5.RELEASE", "fixed_version": "3.1.0.RC3", "fixed_files": ["org.springframework.security.web.firewall.DefaultHttpFirewall.java"], "label": 1, "es_results": []}, {"bug_id": 1795, "bug_title": "Changing ACL parent causes a NPE", "bug_description": "Changing the the parent ACL of an AclImpl when it has a parent already causes a NullpointException in AclImpl.equals(.)\nThe unit test (paste into AclImplTests.java) proves it.\n@Test\n  public void testChangeParent() throws Exception\n  {\n    AclImpl parentAcl = new AclImpl(objectIdentity, 1L, mockAuthzStrategy, mockAuditLogger);\n    AclImpl childAcl = new AclImpl(objectIdentity, 2L, mockAuthzStrategy, mockAuditLogger);\n    AclImpl changeParentAcl = new AclImpl(objectIdentity, 3L, mockAuthzStrategy, mockAuditLogger);\n\n    // This works\n    childAcl.setParent(parentAcl);\n    childAcl.setParent(null);                        // setting to null first avoids NPE\n    childAcl.setParent(changeParentAcl);\n\n    // This causes an NPE\n    childAcl.setParent(parentAcl);\n  }", "project": "Spring", "sub_project": "SEC", "version": "3.0.5.RELEASE", "fixed_version": "3.1.0.RC3", "fixed_files": ["org.springframework.security.acls.domain.AclImpl.java", "org.springframework.security.acls.domain.AclImplTests.java"], "label": 1, "es_results": []}, {"bug_id": 1802, "bug_title": "RFC 1738 / 3986 compliant schemes will not be recognized as valid schemes.", "bug_description": "org.springframework.security.web.util.UrlUtils.isAbsoluteUrl(String) checks whether the given URL is absolute. It will be done by checking the URL is starting  with a valid scheme. But some valid schemes (RFC 1738 / 3986) will not be accepted (e.g. http1). In general all schemes containing digits will be rejected.", "project": "Spring", "sub_project": "SEC", "version": "3.0.5.RELEASE", "fixed_version": "3.1.0.RELEASE", "fixed_files": ["org.springframework.security.web.util.UrlUtils.java", "org.springframework.security.web.util.UrlUtilsTests.java"], "label": 1, "es_results": []}, {"bug_id": 1735, "bug_title": "Logged out immediately after logging in on some browsers", "bug_description": "This bug is closely related to SEC-1587.\nI start at my log in screen, log into the system, see the logged in view and then the next navigation I make I end up being redirect back to the login screen.\nIt happens periodly, not every time.  It happens the most when using Internet Explorer 6.\nAfter I debugged the problem I figured out that the httpSession.removeAttribute(SPRING_SECURITY_CONTEXT_KEY); call in HttpSessionSecurityContextRepository was destroying my newly created authentication object.\nHere&apos;s how it happens:\n1. Browser requests jsf.js.faces during the loading of the login screen.  This request passes through the httpSessionContextIntegrationFilter along with all .faces requests.\n2. Browser holds on to connection after getting the javascript file.  (Browsers do this as an optimization to prevent lots of new tcp connects)\n3. I log into my app from the login page.  This adds the security context to the session.\n4. Browser makes another javascript request from the open connection which causes the thread working on jsf.js.faces to finish up (come back out through the filters)\n5. On the request thread of jsf.js.faces the original security context had a null authenication so httpSession.removeAttribute(SPRING_SECURITY_CONTEXT_KEY); is called which wipes up the new authenication.\nI&apos;ve worked around the problem by created my own version of HttpSessionSecurityContextRepository and just changing the lines:\n                if (httpSession != null) \n{\n                    // SEC-1587 A non-anonymous context may still be in the session\n                    httpSession.removeAttribute(SPRING_SECURITY_CONTEXT_KEY);\n                }\n                return;\n\nto\n\n                if (httpSession != null && contextHashBeforeChainExecution != -1) {                    // SEC-1587 A non-anonymous context may still be in the session                    httpSession.removeAttribute(SPRING_SECURITY_CONTEXT_KEY);                }\n                return;\nThis means that the security context is only reset if there was one at the beginning of the request. (Hash of -1 means no authenication)", "project": "Spring", "sub_project": "SEC", "version": "3.0.5.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.web.context.HttpSessionSecurityContextRepositoryTests.java", "org.springframework.security.web.context.HttpSessionSecurityContextRepository.java"], "label": 1, "es_results": []}, {"bug_id": 1848, "bug_title": "AbstractLdapAuthenticator must escape username", "bug_description": "AbstractLdapAuthenticator.getUserDns() must escape provided username before fomatting it into userDnFormat. It should use LdapEncoder.nameEncode().", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.ldap.authentication.BindAuthenticatorTests.java", "org.springframework.security.ldap.authentication.AbstractLdapAuthenticator.java"], "label": 1, "es_results": []}, {"bug_id": 1857, "bug_title": "ContextPropagatingRemoteInvocation does not correctly propagate the principal", "bug_description": "ContextPropagatingRemoteInvocation was changed so that the principal and credentials were propagated via the toString method (see https://jira.springsource.org/browse/SEC-1741), as follows: \nprincipal = currentUser.getPrincipal().toString(); \ncredentials = currentUser.getCredentials().toString(); \nHowever, this only works if the toString method actually returns the principals name and in the case of principal of type org.springframework.security.core.userdetails.User it returns a description of the User object, not the name.\nI suggest the solution is as follows (it works for me at least): \nprincipal = currentUser.getName(); \ncredentials = currentUser.getCredentials().toString();\nAny more info required just let me know.", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.remoting.rmi.ContextPropagatingRemoteInvocation.java"], "label": 1, "es_results": []}, {"bug_id": 1880, "bug_title": "Mislead exception text \"Use logout-url or success-handler-ref, but not both\"", "bug_description": "In org.springframework.security.config.http.LogoutBeanDefinitionParser there is an mistake in exception message composing. \nInstead of: \"Use \" + ATT_LOGOUT_URL + \" or \" + ATT_LOGOUT_HANDLER + \", but not both\"\nShould be: \"Use \" + ATT_LOGOUT_SUCCESS_URL + \" or \" + ATT_LOGOUT_HANDLER + \", but not both\"", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.config.http.LogoutBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 1968, "bug_title": "PreAuthenticatedProcessingFilter does not clear out the security context causing user to unintentionally remain authenticated", "bug_description": "When the pre-authenticated user is null, the previously authenticated user&apos;s security context remains, and as such, the previous user remains authenticated.\nIt seems like the AbstractPreAuthenticatedProcessingFilter should clear out the security context in doAuthenticate if the principal is null.  I can override the getPreAuthenticatedPrincipal call to do this (if I return  null for the principal), but it seems that this is not something the user should have to manage.  And, it seems like a side-effect / hack to put something like that in a method that should just be getting the principal, and doAuthenticate itself is private.  This is dangerous because later in the chain, in AbstractSecurityInterceptor.beforeInvocation(Object object) the security context is not null, even though it should be, and so, no exception is thrown from:\n        if (SecurityContextHolder.getContext().getAuthentication() == null) \n{\n            credentialsNotFound(messages.getMessage(\"AbstractSecurityInterceptor.authenticationNotFound\",\n                    \"An Authentication object was not found in the SecurityContext\"), object, attributes);\n        }\n\nIt could also possibly be argued that the security context should be cleared in AbstractPreAuthenticatedFilter.requiresAuthentication in the session invalidation on a principal change - namely in here:\n        if (invalidateSessionOnPrincipalChange) {\n            HttpSession session = request.getSession(false);\n            if (session != null) \n{\n                logger.debug(\"Invalidating existing session\");\n                session.invalidate();\n                request.getSession();\n            }\n        }\nI have attached a test application that demonstrates this in the simplest format I could come up with. Basically the pre-authentication occurs by grabbing a username from a request parameter, and then it displays the logged in user&apos;s username on the home page.\nSo if I go to http://localhost:8080/security/?username=bob the application will display &apos;Hello bob&apos;.  If I hit http://localhost:8080/security/?username=jimi, it will switch to saying &apos;Hello jimi&apos;, but if I do http://localhost:8080/security/?username= it will remain at &apos;Hello jimi&apos; (or whatever the previously authenticated user was), instead of requiring authentication.\nHowever, if in getPreAuthenticatedPrincipal() I call SecurityContextHolder.clearContext(), then hitting http://localhost:8080/security/?username= will result in taking me to the login page which I think is the desired behavior if the user is not pre-authenticated - indicated by getPreAuthenticatedPrincipal() returning null.", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilterTests.java", "org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1850, "bug_title": "ConcurrentSessionFilter should be by default injected with the same logout handlers as LogoutFilter when using namespace config", "bug_description": "I have an app configured to prevent concurrent sessions:\n                <sec:session-management session-fixation-protection=\"migrateSession\">\n                           <sec:concurrency-control max-sessions=\"1\" expired-url=\"/sessionExpired.do\" session-registry-ref=\"sessionRegistry\"/>\n                </sec:session-management>\nAlso we are using remember me functionality:\n                <sec:remember-me key=\"someKey\" services-ref=\"rememberMeServices\"  />\nnow with this config the logout filter is injected with both SecurityContextLogoutHandler and our TokenBasedRememberMeServices bean which implements LogoutHandler.This is the expected config and it correctly executes both handlers (where in this case, remember me cookie will be canceled by TokenBasedRememberMeServices)  ..\nHowever, if the user exceeds his max sessions and the ConcurrentSessionFilter logouts the user, it uses the default SecurityContextLogoutHandler which is declared inside:\n                private LogoutHandler[] handlers = new LogoutHandler[] \n{new SecurityContextLogoutHandler()}\n;\nI think ConcurrentSessionFilter should be injected with the same logout handlers as LogoutFilter so the user will be properly logged out (i.e clearing remeber me cookie for example)...", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.config.http.AuthenticationConfigBuilder.java", "org.springframework.security.config.http.HttpSecurityBeanDefinitionParser.java", "org.springframework.security.config.http.LogoutBeanDefinitionParser.java", "org.springframework.security.config.http.HttpConfigurationBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 2013, "bug_title": "AbstractAuthenticationProcessingFilter is missing space in log message", "bug_description": "I have custom FORM_LOGIN_FILTER class (extends UsernamePasswordAuthenticationFilter). When I have (expected) SessionAuthenticationException I see the following log messages:\n2012-07-19 16:38:50,311 [btpool0-4] DEBUG FormAuthenticationFilter - Authentication request failed: org.springframework.security.web.authentication.session.SessionAuthenticationException: Only concurrent sessions for the same principal are allowed\n2012-07-19 16:38:50,311 [btpool0-4] DEBUG FormAuthenticationFilter - Updated SecurityContextHolder to contain null Authentication\n2012-07-19 16:38:50,311 [btpool0-4] DEBUG FormAuthenticationFilter - Delegating to authentication failure handlerorg.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler@5226e4c9\nAs you can see \"Delegating to authentication failure handlerorg.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler@5226e4c9\" message has no space.\nThe missing space is in the AbstractAuthenticationProcessingFilter class (see Reference URL).", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 2005, "bug_title": "SecurityContext should be persisted immediately when the response is committed", "bug_description": "Summary of findings\nSpring Security should persist the SecurityContext immediately if any of the following methods are invoked since they commit the response and can hand control back to the client immediately. This is similar to SEC-398.\n\nHttpServletResponse.flushBuffer()\nHttpServletResponse.getWriter().close()\nHttpServletResponse.getWriter().flush()\nHttpServletRespose.getOutputStream().close()\nHttpServletRespose.getOutputStream().flush()\n\nOriginal description\nDuring stress/loadtesting of our web application we are experiencing some severe-error issues regarding the freshness of a spring-security security context.\nThe referenced forum post contains a bit more detail but here is a summary.\nA single loadtest client (during high tomcat-7/server load) can execute a \"login\" establishing a security context and a subsequent API call requiring a security context will fail.  The loadtest client (grinder/jython single threaded (per client)) uses a CommonsHttpInvokerRequestExecutor sending and receiving hessian content over a \"typical\" http request/response.\nThe login request is handled by our login service bean which establishes a spring security context.  That security context is persisted in spring-security scope in a \"finally\" block of SecurityContextPersistenceFilter.doFilter.  \nHowever, the underlying components (take your pick here... tomcat-7 Connector thread, java input/output streams, etc...) have sent the http response content-length number of bytes across the wire and therefore completed the HTTP request and response pair.\nThe completion of the HTTP request is realized by the loadtest client (and any client I suppose) and moves on to the next HTTP request expecting the proper cookie handling and security context to be applied to the next request.  \nThis next HTTP request is accepted by the appserver and processed by spring and further spring-security before the finally block on the previous request has executed.  Therefore the spring security context is not available in this subsequent request.  \nIf I place a client-side delay (100ms or so), that is typically enough time to ensure that the complete spring stack has executed and the spring security context is valid.\nWe also have this semantically similar issue during \"logout\".  Prior to logout, we make a call to our server that requires a security context (the last API call of our loadtest workflow).  This call appears \"complete\" to our clients because the http reqeust/response is complete.  So we continue our loadtest workflow sending a \"logout\" command.  This clears the spring security context before the finally block of the previous call has executed therefore the completion of the previous request throws an exception because the session is invalid.\nOnce again, if we place a 100ms delay prior to the logout, no race condition occurs and things work as expected.", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.web.context.HttpSessionSecurityContextRepositoryTests.java", "org.springframework.security.web.context.SaveContextOnUpdateOrErrorResponseWrapper.java"], "label": 1, "es_results": []}, {"bug_id": 1975, "bug_title": "AuthenticationSimpleHttpInvokerRequestExecutor and AnonymousAuthenticationToken", "bug_description": "Hi,\nI am working with AuthenticationSimpleHttpInvokerRequestExecutor to add http basic authentication to HTTPInvoker requests. When using the AnonymousAuthenticationFilter to create an AnonymousAuthenticationToken the request executor will extract \"anonymousUser\" and some randomly generated credentials. In the backend, I have no chance to generate meaningful UserDetails for \"anonymousUser\".\nSo wouldn&apos;t it be better to check in prepareConnection() if the Authentication is a UsernamePasswordAuthenticationToken, since these are anyway the only usable tokens for http basic authentication?", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.remoting.httpinvoker.AuthenticationSimpleHttpInvokerRequestExecutorTests.java", "org.springframework.security.remoting.httpinvoker.AuthenticationSimpleHttpInvokerRequestExecutor.java"], "label": 1, "es_results": []}, {"bug_id": 2057, "bug_title": "ConcurrentSessionFilter documentation incorrectly states it does not rely on SecurityContextHolder, results in null to all logout handlers Authentication object", "bug_description": "According to the docs here:\nhttp://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#d0e3278\nThe location of the filter is:\n\"2) ConcurrentSessionFilter, because it doesn&apos;t use any SecurityContextHolder functionality...\"\nBut as you can see in this line here, it is used. \nhttps://github.com/SpringSource/spring-security/blob/master/web/src/main/java/org/springframework/security/web/session/ConcurrentSessionFilter.java#L133\nIt never gets populated due to the location in the filter chain and the Authentication object is always null.\n", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.config.http.SecurityFilters.java"], "label": 1, "es_results": []}, {"bug_id": 2025, "bug_title": "HttpSessionSecurityContextRepository restores authentication to the new session if session is invalidated from another thread", "bug_description": "HttpSessionSecurityContextRepository restores authentication to the session if session is invalidated from another thread if SecurityContextPersistenceFilter execution takes significant amount of time.\nI am using Spring + JSF + DWR framework + GWT event service (ajax push). In any time there is at least one thread waiting at the server side for push events. This request is handled by SecurityContextPersistenceFilter which remembers the authentication at the moment of request&apos;s arriving to the server. If during the processing of this filter the session is being invalidated (by clicking logout in another tab of invalidating session by id from admin area) then HttpSessionSecurityContextRepository put the outdated authentication to the new session(which is created by JSF framework, so the session is changed during the processing of SecurityContextPersistenceFilter ).\nThis easily reproducable if some processing delay is inserted to SecurityContextPersistenceFilter.\nSaveToSessionResponseWrapper should remember the initial HttpSession and check if the original session was invalidated so it won&apos;t set the current authentication to the new session.", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.logout.SecurityContextLogoutHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2031, "bug_title": "PreInvocationAuthorizationAdviceVoter checks in support(Class<?>) for super and not for child class", "bug_description": "The method PreInvocationAuthorizationAdviceVoter.support(Class<?> clazz) checks if clazz is a super class of MethodInvocation and not if its a subclass.", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.access.prepost.PreInvocationAuthorizationAdviceVoter.java"], "label": 1, "es_results": []}, {"bug_id": 2187, "bug_title": "OpenIDAuthenticationFilter should encode URL parameters", "bug_description": "OpenIDAuthenticationFilter has the ability to propagate existing query parameters on the request through the return_to URL submitted as part of the OpenID authentication process. However, these values are not encoded as application/x-www-form-urlencoded, leading to potential ambiguities later on if these values contain reserved characters.", "project": "Spring", "sub_project": "SEC", "version": "3.0.7.RELEASE", "fixed_version": "3.2.0.RC1", "fixed_files": ["org.springframework.security.openid.OpenIDAuthenticationFilter.java", "org.springframework.security.openid.OpenIDAuthenticationFilterTests.java"], "label": 1, "es_results": []}, {"bug_id": 1549, "bug_title": "AclPermissionCacheOptimizer should not attempt to load Acls for empty object list", "bug_description": "BasicLookupStrategy will raise an exception if passed an empty OID list, so we shouldn&apos;t call it if the optimizer is passed an empty collection of objects.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.M1", "fixed_version": "3.1.0.M2", "fixed_files": ["org.springframework.security.acls.AclPermissionCacheOptimizer.java"], "label": 1, "es_results": []}, {"bug_id": 1553, "bug_title": "WebAuthenticationDetails should be Serializable", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.M1", "fixed_version": "3.1.0.M2", "fixed_files": ["org.springframework.security.web.authentication.WebAuthenticationDetails.java"], "label": 1, "es_results": []}, {"bug_id": 1628, "bug_title": "add authentication-success-handler to <remember-me> tag", "bug_description": "We are using an AuthenticationSuccessHandler to post-process login information to cache attributes into the HttpSession (we&apos;re using a third-party servlet that can handle some database queries by itself but needs the appropriate keys, etc.).  However, after a remember-me login, there is no way to insert a success handler to perform the appropriate initialization for the new session.\nIt would be helpful to have an authentication-success-handler-ref attribute on the <remember-me> tag analogous to the attribute on the <*-login> tags, triggered after the RememberMeServices handles a persistent login.\n(The forum link is not my post, but there appears to be a significant desire for this feature.)", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.M1", "fixed_version": "3.1.0.RC1", "fixed_files": ["org.springframework.security.config.http.RememberMeBeanDefinitionParser.java", "org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilterTests.java", "org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1603, "bug_title": "Add authentication-success-handler-ref attribute to <remember-me> tag", "bug_description": "IMHO, I think it would be extremely helpful to some web developers to be able to specify a specific page to be loaded when a user is \"logged in\" via rememberMeServices, right out of the box. This is especially true for developers who set the always-use-default-target=\"true\" in the <form-login> tag.  If you want the <remember-me> tag to act in the same manor, the learning curve gets pretty steep.\nIt would also be useful if the user&apos;s session always needs to be re-iniated by the web application after an expired session.  Having the target-url go to a page the tells the user their session has expired, they are being redirected to a \"start page\", and automatically logged-in is helpful.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.M2", "fixed_version": "3.1.0.RC1", "fixed_files": ["org.springframework.security.config.http.RememberMeBeanDefinitionParser.java", "org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilterTests.java", "org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1653, "bug_title": "spring security sample war config < remember-me / > fails to properly register the requested bean", "bug_description": "spring security config : < remember-me / > yields an error \"Factory bean &apos;org.springframework.security.userDetailsServiceFactory&apos; not found\".\nthis can be reproduced by import spring-security-samples-tutorial-3.1.0.M2.war from spring 3.1.0.M2 distribution on a freshly installed STS 2.5.1 installer from the spring website. After import -> war, add spring nature and enable \"Load NameSpaceHandlers and XSDs from projects classpath\" from project properties.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.M2", "fixed_version": "3.1.0.RC1", "fixed_files": ["org.springframework.security.config.http.AuthenticationConfigBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 1679, "bug_title": "delete-cookies should trim cookie names", "bug_description": "If multiple cookie names are supplied, with spaces in the string, then spaces won&apos;t be trimmed , resulting in incorrect cookie names.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RC1", "fixed_version": "3.1.0.RC2", "fixed_files": ["org.springframework.security.config.http.LogoutBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 1683, "bug_title": "Documentation typo for RequestHeaderAuthenticationFilter", "bug_description": "In the JavaDoc for org.springframework.security.web.authentication.preauth.RequestHeaderAuthenticationFilter, there is a typo for the exceptionIfHeaderMissing property in the class description.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RC1", "fixed_version": "3.1.0.RC2", "fixed_files": ["org.springframework.security.web.authentication.preauth.RequestHeaderAuthenticationFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1712, "bug_title": "Typo in RegexRequestMatcher class javadoc", "bug_description": "In RegexRequestMatcher class javadoc instead of \"\n{@code caseInsentitive}\n\" it should be \"\n{@code caseInsensitive}\n\"", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RC1", "fixed_version": "3.1.0.RC2", "fixed_files": ["org.springframework.security.web.util.RegexRequestMatcher.java"], "label": 1, "es_results": []}, {"bug_id": 1714, "bug_title": "RegexRequestMatcher's matches should append question mark after path info and before query", "bug_description": "\n\n\n\n\n\n        if (pathInfo != null || query != null) {\n\n\n\n\n            StringBuilder sb = new StringBuilder(url);\n\n\n\n\n\n\n\n\n\n            if (pathInfo != null) {\n\n\n\n\n                sb.append(pathInfo);\n\n\n\n\n            }\n\n\n\n\n\n\n\n\n\n            if (query != null) {\n\n\n\n\n                sb.append(query);\n\n\n\n\n            }\n\n\n\n\n            url = sb.toString();\n\n\n\n\n        }\n\n\n\n\n\n\nshould be replaced with something similar to\n\n\n\n\n\n\n        if (pathInfo != null || query != null) {\n\n\n\n\n            StringBuilder sb = new StringBuilder(url);\n\n\n\n\n\n\n\n\n\n            if (pathInfo != null) {\n\n\n\n\n                sb.append(pathInfo);\n\n\n\n\n            }\n\n\n\n\n\n\n\n\n\n            if (query != null) {\n\n\n\n\n                sb.append(\"?\").append(query);\n\n\n\n\n            }\n\n\n\n\n            url = sb.toString();\n\n\n\n\n        }\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RC1", "fixed_version": "3.1.0.RC2", "fixed_files": ["org.springframework.security.web.util.RegexRequestMatcher.java"], "label": 1, "es_results": []}, {"bug_id": 1699, "bug_title": "DefaultFilterChainValidator's check if login page is not protected is broken", "bug_description": "DefaultFilterChainValidator near the end of checkLoginPageIsntProtected method issues a call to\n\n\n\n\n\n\nfsi.getAccessDecisionManager().decide(token, new Object(), attributes);\n\n\n\n\n\n\nwhich throws exception\n\n\n\n\n\n\njava.lang.ClassCastException: java.lang.Object cannot be cast to org.springframework.security.web.FilterInvocation\n\n\n\n\n\n\nAccessDecisionManager is org.springframework.security.access.vote.AffirmativeBased and when it asks\norg.springframework.security.web.access.expression.WebExpressionVoter to vote passing Object instead of FilterInvocation, ClassCastException is thrown.\nProbably either AffirmativeBased AccessDecisionManager should first check if voter(s) support Object.class before giving them chance to vote, or DefaultFilterChainValidator should pass in FilterInvocation when checking in web environment.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RC1", "fixed_version": "3.1.0.RC2", "fixed_files": ["org.springframework.security.config.http.DefaultFilterChainValidator.java"], "label": 1, "es_results": []}, {"bug_id": 1752, "bug_title": "Null character appended to TextEncryptor.decrypt(String) results", "bug_description": "The following test fails:\n\n\n\n\n\n\n@Test\n\n\n\n\npublic void test() {\n\n\n\n\n\tTextEncryptor encryptor = Encryptors.queryableText(\"password\", \"salt\");\n\n\n\n\n\tString encrypted = encryptor.encrypt(\"6048b75ed560785c\");\n\n\n\n\n\tString decrypted = encryptor.decrypt(encrypted);\n\n\n\n\n\tassertEquals(\"6048b75ed560785c\", decrypted);\n\n\n\n\n}\n\n\n\n\n\n\nThis is because the value of the decrypted variable has a null byte (%00) at the end.  To get the test to pass, I called trim():\n\n\n\n\n\n\n@Test\n\n\n\n\npublic void test() {\n\n\n\n\n\tTextEncryptor encryptor = Encryptors.queryableText(\"password\", \"salt\");\n\n\n\n\n\tString encrypted = encryptor.encrypt(\"6048b75ed560785c\");\n\n\n\n\n\tString decrypted = encryptor.decrypt(encrypted).trim();\n\n\n\n\n\tassertEquals(\"6048b75ed560785c\", decrypted);\n\n\n\n\n}\n\n\n\n\n\n\nI&apos;m not sure why this is happening at this stage, or the appropriate resolution.  The AesBytesEncryptor is using AES with PKCS5 which should care for padding handling for both encrypt/decrypt operations. I&apos;m puzzled as to why a null byte is being tacked on.\nThis problem manifested itself in the Greenhouse reference application as a OAuth Signature Verification Failure.  The NUL (%00) byte is the culprit.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RC2", "fixed_version": "3.1.0.RC3", "fixed_files": ["org.springframework.security.crypto.codec.Utf8.java"], "label": 1, "es_results": []}, {"bug_id": 1751, "bug_title": "Encryptors.queryableText(String String) is not useable in present state", "bug_description": "The role of Encryptors.queryableText(String, String) is to allow for data to be encrypted for storage, then for the data to be queried against in its encrypted form.  A good example of the need for this is the storage of OAuth Consumer Keys.  Such keys should be encrypted when stored, and need to be queried when applications request authorization.\nFor this to work, the same message e.g. \"6048b75ed560785c\" must produce the same cipher text each time e.g. \"5e37a66db5d48321050d17365d4f4e6fd217caade54d777bbecf6a458036e34b6fcbf0bebf2aa2a03ca5d5171ba5de7a\"\n. Unfortunately, this is not happening beyond container restarts since the \"shared\" initialization vector is initialized each time a queryable TextEncryptor instance is constructed.\nThe following simple test case demonstrates the issue:\n\n\n\n\n\n\n\t@Test\n\n\n\n\n\tpublic void test() {\n\n\n\n\n\t\tTextEncryptor encryptor = Encryptors.queryableText(\"password\", \"salt\");\n\n\n\n\n\t\tSystem.out.println(encryptor.encrypt(\"6048b75ed560785c\"));\n\n\n\n\n\t\tSystem.out.println(encryptor.encrypt(\"6048b75ed560785c\"));\n\n\n\n\n\t}\n\n\n\n\n\n\nEach time this test case is run, across all VM instances, the cipher text should be the same.  If you run it more than once, you&apos;ll see the cipher text change.  This is not correct behavior.\nThe fix is most likely to not apply an iV at all for a \"queryable\" TextEncryptor.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RC2", "fixed_version": "3.1.0.RC3", "fixed_files": ["org.springframework.security.crypto.encrypt.AesBytesEncryptor.java", "org.springframework.security.crypto.encrypt.Encryptors.java"], "label": 1, "es_results": []}, {"bug_id": 1733, "bug_title": "IpAddressMatcher does not match 0-bit subnet mask correctly", "bug_description": "I&apos;m using IpAddressMatcher for address matching outside Spring Security.\nNetwork 0.0.0.0/0 should match to any IP address, but only matches to 0.0.0.0. If mask is given as \"0\", the matches() method handles the mask as if it was not given at all (or was given as 32). Perhaps differentiate the situations by assigning nMaskBits a null value if it&apos;s not defined at all?\nIt would also be nice to have a version of the matches() method that takes a String network address instead of a HttpServletRequest as a parameter.\nAttached is a different from my fix.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RC1", "fixed_version": "3.1.0.RC3", "fixed_files": ["org.springframework.security.web.util.IpAddressMatcher.java", "org.springframework.security.web.util.IpAddressMatcherTests.java"], "label": 1, "es_results": []}, {"bug_id": 1771, "bug_title": "TokenBasedRememberMeServices will not work with erased credentials", "bug_description": "TokenBasedRememberMeServices attempts to obtain the user&apos;s password from the Authentication object, after it has been erased by the ProviderManager, meaning that remember-me won&apos;t work. It will probably need to load it from the UserDetailsService when the password isn&apos;t directly available.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RC2", "fixed_version": "3.1.0.RC3", "fixed_files": ["org.springframework.security.web.authentication.rememberme.TokenBasedRememberMeServices.java"], "label": 1, "es_results": []}, {"bug_id": 1820, "bug_title": "NPE in OpenID4JavaConsumer.fetchAxAttributes", "bug_description": "I am not sure what more details I need to provide - please let me know.\n\n\n\n\n\n\njava.lang.NullPointerException\n\n\n\n\n    org.springframework.security.openid.OpenID4JavaConsumer.fetchAxAttributes(OpenID4JavaConsumer.java:205)\n\n\n\n\n    org.springframework.security.openid.OpenID4JavaConsumer.endConsumption(OpenID4JavaConsumer.java:184)\n\n\n\n\n    org.springframework.security.openid.OpenIDAuthenticationFilter.attemptAuthentication(OpenIDAuthenticationFilter.java:143)\n\n\n\n\n    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:199)\n\n\n\n\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)\n\n\n\n\n    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)\n\n\n\n\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)\n\n\n\n\n    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)\n\n\n\n\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)\n\n\n\n\n    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)\n\n\n\n\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)\n\n\n\n\n    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:175)\n\n\n\n\n    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)\n\n\n\n\n    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RC2", "fixed_version": "3.1.0.RELEASE", "fixed_files": ["org.springframework.security.openid.OpenID4JavaConsumer.java"], "label": 1, "es_results": []}, {"bug_id": 1833, "bug_title": "HttpSessionSecurityContextRepository is missing setter for securityContextClass in 3.1.0 RC3", "bug_description": "This setter used to be there in 3.0.x and is still referenced in the Javadoc for generateNewContext()", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RC3", "fixed_version": "3.1.0.RELEASE", "fixed_files": ["org.springframework.security.web.context.HttpSessionSecurityContextRepository.java"], "label": 1, "es_results": []}, {"bug_id": 1870, "bug_title": "HttpSessionDestroyedEvent#getSecurityContexts() broken", "bug_description": "The implementation of HttpSessionDestroyedEvent#getSecurityContexts() is broken. See the code snippet from the source below. The code retrieves the names of the session attributes which are Strings and test the Strings to be instances of SecurityContext in the loop. Strings are most likely not SecurityContexts, so the result of the method is always an empty list.\n\n\n\n\n\n\nEnumeration<String> attributes = session.getAttributeNames();\n\n\n\n\n\n\n\n\n\nArrayList<SecurityContext> contexts = new ArrayList<SecurityContext>();\n\n\n\n\n\n\n\n\n\nwhile(attributes.hasMoreElements()) {\n\n\n\n\n    Object attribute = attributes.nextElement();\n\n\n\n\n    if (attribute instanceof SecurityContext) {\n\n\n\n\n        contexts.add((SecurityContext) attribute);\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.1.RELEASE", "fixed_files": ["org.springframework.security.web.session.HttpSessionDestroyedEvent.java"], "label": 1, "es_results": []}, {"bug_id": 1868, "bug_title": "SecurityNamespaceHandler should not log an error if the web classes are not available", "bug_description": "Currently the SecurityNamespaceHandler logs an error if the FilterChainProxy is not available on the classpath.\nThis should be turned back to an if instead of a try/catch and it should definitely not log an error message ", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.1.RELEASE", "fixed_files": ["org.springframework.security.config.SecurityNamespaceHandler.java", "org.springframework.security.config.SecurityNamespaceHandlerTests.java"], "label": 1, "es_results": []}, {"bug_id": 1885, "bug_title": "Adding <debug/> causes NoSuchMethodException when FilterChainProxy's relies on beans that have Autowired Constructors", "bug_description": "An example would be if a configuration used <debug/> and a custom AuthenticationProvider or UserDetailsService which had an Autowired constructor one might get an exception similar to NoSuchMethodException MyCustomAuthenticationProvider.<init>()", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.1.RELEASE", "fixed_files": ["org.springframework.security.config.util.InMemoryXmlApplicationContext.java", "org.springframework.security.config.debug.SecurityDebugBeanFactoryPostProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 1927, "bug_title": "SessionManagementFilter does not add space between ID and session ID", "bug_description": "The class org.springframework.security.web.session.SessionManagementFilter logs a wrong session ID in one of the debug log entries. In line 91 there is a missing space between the word &apos;ID&apos; in the log message and the value:\nlogger.debug(\"Requested session ID\" + request.getRequestedSessionId() + \" is invalid.\");\nThat leads to e.g. the following line:\n\"Requested session IDBD230F0B1B30002A89B47B182FD2874E is invalid.\"\nIf the reader of such a line is not mindful enough, he would looking for a session IDBD230F0B1B30002A89B47B182FD2874E which doesn&apos;t exists. It should be read:\n\"Requested session ID BD230F0B1B30002A89B47B182FD2874E is invalid.\"", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.1.RELEASE", "fixed_files": ["org.springframework.security.web.session.SessionManagementFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1893, "bug_title": "Default https 8443 port mappings redirection", "bug_description": "Port-mappings does not work properly,\nwhen it setup in spring xml configuration such as:\n<ss:port-mappings>\n    <ss:port-mapping http=\"8181\" https=\"8080\"/>\n</ss:port-mappings>\nwith:\n<ss:form-login login-page=\"/access/login.html\"\n            username-parameter=\"username\"\n            password-parameter=\"password\"\n            login-processing-url=\"/app/loginuser\"\n            default-target-url=\"/app/\" />\nSpring security redirected me to url (https://localhost:8443/access/login.html must be https://localhost:8080/access/login.html) with 8443 port (by default in the org/springframework/security/web/PortMapperImpl.java) when I try to access protected page.\nI edited PortMapperImpl.java:\n    public PortMapperImpl() \n{\n        httpsPortMappings = new HashMap<Integer, Integer>();\n        httpsPortMappings.put(Integer.valueOf(8080), Integer.valueOf(8080));\n    }\n\nand redirection is working now to 8080 https.\nI think that when <ss:port-mappings>...</ss:port-mappings> setted,\nPortMapperImpl.java:\nprivate final Map<Integer, Integer> httpsPortMappings;\n\"httpsPortMappings\" not cleaned properly, and previously key value are available.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.1.RELEASE", "fixed_files": ["org.springframework.security.config.http.AuthenticationConfigBuilder.java", "org.springframework.security.config.http.FormLoginBeanDefinitionParser.java", "org.springframework.security.config.http.HttpSecurityBeanDefinitionParser.java", "org.springframework.security.config.http.HttpConfigurationBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 1901, "bug_title": "Forwarding to /j_spring_security_check results in 404", "bug_description": "In a JSF environment, RequestDispatcher is used to forward request to /j_spring_security_check to do user login. In Spring Security 3.1.0, doing so results in 404 error. The same code works fine with 3.0.7.\nCurrently I use a custom filter to invoke UsernamePasswordAuthenticationFilter directly to work around the problem. As such, I suspect FilterChainProxy is not run when the request is forwarded.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.1.RELEASE", "fixed_files": ["org.springframework.security.config.debug.DebugFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1900, "bug_title": "sec:authorize ifAllGranted does not work if Authorities are deprecated GrantedAuthorityImpl", "bug_description": "<sec:authorize ifAllGranted=\"ROLE_ADMIN\">\ndid not work for me after upgrading to 3.1.0 \nreason: i added some role manually in my own UserDetails like this:\n  GrantedAuthority granted = new GrantedAuthorityImpl(rolle.toString());\n  authorities.add(granted);\nGrantedAuthorityImpl is deprecated and ifAllGranted, too. But i think it is still a bug.\nYou can fix it by using simpleGrantedAuthority\nGrantedAuthority granted = new SimpleGrantedAuthority(rolle.toString());\nauthorities.add(granted);\nthe bug is somewhere in the Collection class in an equals method. It checks if the containing element is of class SimpleGrantedAuthority.\n", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.1.RELEASE", "fixed_files": ["org.springframework.security.taglibs.authz.AuthorizeTagCustomGrantedAuthorityTests.java", "org.springframework.security.taglibs.authz.AbstractAuthorizeTag.java"], "label": 1, "es_results": []}, {"bug_id": 1965, "bug_title": "Passivity DefaultWebSecurityExpressionHandler no longer implements WebSecurityExpressionHandler", "bug_description": "The DefaultWebSecurityExpressionHandler no longer implements WebSecurityExpressionHandler which causes issues when using spring-webflow&apos;s AbstractAuthorizeTag which looks up the WebExpressionHandler for authorize statements. We should probably also look into getting webflow to use the provided AbstractAuthorizeTag (I haven&apos;t had time to investigate why they might have their own copy of this tag).", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.1.RELEASE", "fixed_files": ["org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler.java", "org.springframework.security.web.access.expression.WebSecurityExpressionHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1980, "bug_title": "Misleading warning about incorrect redirect URL", "bug_description": "We&apos;ve started using SpEL expressions to avoid duplicating URL patterns between security.xml and our MVC controller mappings.\nE.g.\n\n\n\n\n\n\n<form-login \n\n\n\n\n    login-page=\"#{T(com.acme.Sitemap).LOGIN}\" \n\n\n\n\n    authentication-failure-url=\"#{T(com.acme.Sitemap).AUTH_ERROR}\"/>\n\n\n\n\n\n\nNow we keep seeing spurious warnings like\n\n\n\n\n\n\nFailFastProblemReporter - Configuration problem: #{ T(com.acme.Sitemap).AUTH_ERROR} is not a valid redirect URL (must start with &apos;/&apos; or http(s))\n\n\n\n\n\n\nThis appears to be caused by WebConfigUtils.validateHttpRedirect() which checks for a &apos;$&apos; placeholder character but not for a &apos;#&apos; SpEL character.\n", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.config.http.WebConfigUtils.java"], "label": 1, "es_results": []}, {"bug_id": 1964, "bug_title": "PersistentTokenBasedRememberMeServices provides improper error message with non existent series", "bug_description": "Sometimes I have a error in my logs about toke series: \"Querying token for series &apos;qF0PD5V64BRvlxTHU577ZQ==&apos; returned more than one value. Series should be unique\"\nLooks like series generator generates not unique values and it causes some problems later.\nAlso the class logic is not clear for me. \n1. In case of broken tokens they are never removed from the database because JdbcTokenRepositoryImpl returns null but PersistentTokenBasedRememberMeServices does nothing in this case:\n\n\n\n\n\n\nPersistentTokenBasedRememberMeServices.java\n\n\n\n\n\n\n        if (token == null) {\n\n\n\n\n            // No series match, so we can&apos;t authenticate using this cookie\n\n\n\n\n            throw new RememberMeAuthenticationException(\"No persistent token found for series id: \" + presentedSeries);\n\n\n\n\n        }\n\n\n\n\n\n\n2. I have a lot browsers. At least 3 but when I have incorrect token in one browser, for example, all other marked as broken:\n\n\n\n\n\n\nPersistentTokenBasedRememberMeServices.java\n\n\n\n\n\n\n        if (!presentedToken.equals(token.getTokenValue())) {\n\n\n\n\n            // Token doesn&apos;t match series value. Delete all logins for this user and throw an exception to warn them.\n\n\n\n\n            tokenRepository.removeUserTokens(token.getUsername());\n\n\n\n\n\n\n\n\n\n            throw new CookieTheftException(messages.getMessage(\"PersistentTokenBasedRememberMeServices.cookieStolen\",\n\n\n\n\n                    \"Invalid remember-me token (Series/token) mismatch. Implies previous cookie theft attack.\"));\n\n\n\n\n        }\n\n\n\n\n\n\nWhy all my tokens are removed if only one is broken?\n3. If token is expired it&apos;s not removed from DB:\n\n\n\n\n\n\nPersistentTokenBasedRememberMeServices.java\n\n\n\n\n\n\n        if (token.getDate().getTime() + getTokenValiditySeconds()*1000L < System.currentTimeMillis()) {\n\n\n\n\n            throw new RememberMeAuthenticationException(\"Remember-me login has expired\");\n\n\n\n\n        }\n\n\n\n\n\n\nAt this moment my database has a lot of broken tokens.\n", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImplTests.java", "org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2011, "bug_title": "SessionFixationProtectionStrategy Javadoc states to inject SessionRegistry but does not contain that field", "bug_description": "The SessionFixationProtectionStrategy Javadoc says:\n\n\n\n\n\n\nIf concurrent session control is in use, then a SessionRegistry must be injected. \n\n\n\n\n\n\nHowever, this feature is offered by the subclass ConcurrentSessionControlStrategy. Another reference to the session registry is in the org.springframework.security.web.authentication.session.SessionFixationProtectionStrategy.onAuthentication(Authentication, HttpServletRequest, HttpServletResponse) Javadoc:\n\n\n\n\n\n\nThe sessionRegistry will be updated with the new session information.\n\n\n\n\n\n\nOnce again, this is done by the org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy.onAuthentication(Authentication, HttpServletRequest, HttpServletResponse) instead.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.session.SessionFixationProtectionStrategy.java", "org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy.java"], "label": 1, "es_results": []}, {"bug_id": 2012, "bug_title": "Javadoc for UserDetails.getPassword() says that the password is never null; however it may be", "bug_description": "The Javadoc for org.springframework.security.core.userdetails.UserDetails.getPassword() says:\n\n\n\n\n\n\nReturns the password used to authenticate the user. Cannot return null.\n\n\n\n\n\n\n\n\n\nReturns:\n\n\n\n\nthe password (never null)\n\n\n\n\n\n\nHowever, if the concrete implementation of UserDetails also implements org.springframework.security.core.CredentialsContainer (and this is the case for org.springframework.security.core.userdetails.User, for instance), then the password may actually be null if the credentials have been deleted by a call to org.springframework.security.core.CredentialsContainer.eraseCredentials(). See org.springframework.security.core.userdetails.User.eraseCredentials(), for instance.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.core.userdetails.UserDetails.java"], "label": 1, "es_results": []}, {"bug_id": 1940, "bug_title": "ProviderManager does not publish AccountStatusException", "bug_description": "When using a simple configuration, an authentication provider throwing a LockedException doesn&apos;t because an AuthenticationFailureLockedEvent to be published. The writeup&apos;s in the Spring forum reference. I can&apos;t be sure this is a bug, but it seems too weird to be expected behavior.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.authentication.ProviderManager.java", "org.springframework.security.authentication.ProviderManagerTests.java"], "label": 1, "es_results": []}, {"bug_id": 1919, "bug_title": "AuthenticationServiceException logged on DEBUG level", "bug_description": "When LDAP server is not available AuthenticationServiceException should be logged on the ERROR level not on DEBUG.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilterTests.java", "org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.java", "org.springframework.security.ldap.authentication.LdapAuthenticationProvider.java", "org.springframework.security.authentication.AuthenticationServiceException.java", "org.springframework.security.ldap.authentication.LdapAuthenticationProviderTests.java"], "label": 1, "es_results": []}, {"bug_id": 2036, "bug_title": "CookieClearingLogoutHandler does not work with IE for default context", "bug_description": "The CookieClearingLogoutHandler uses request.getContextPath() to unset the cookie(s). \n\n\n\n\n\n\n for (String cookieName : cookiesToClear) {\n\n\n\n\n            Cookie cookie = new Cookie(cookieName, null);\n\n\n\n\n            cookie.setPath(request.getContextPath());\n\n\n\n\n            cookie.setMaxAge(0);\n\n\n\n\n            response.addCookie(cookie);\n\n\n\n\n        }\n\n\n\n\n\n\nSo in default context this method return \"\" (empty string).\nThe empty cookie path semantic is expected as \"/\" by browsers. They all interpret it except IE.\nIn my case, I use Simple Hash-Based RememberMe Token that can&apos;t be unset and so, users can&apos;t logout from IE.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.3.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.logout.CookieClearingLogoutHandlerTests.java", "org.springframework.security.web.authentication.logout.CookieClearingLogoutHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2045, "bug_title": "AbstractAuthorizeTag cannot specify which WebInvocationPrivilegeEvaluator", "bug_description": "AbstractAuthorizeTag uses the first WebInvocationPrivilegeEvaluator which causes problems when evaluating the url attribute and having multiple <http> elements.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.3.RELEASE", "fixed_files": ["org.springframework.security.web.WebAttributes.java", "org.springframework.security.taglibs.authz.AbstractAuthorizeTag.java", "org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilterTests.java", "org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1939, "bug_title": "SwitchUserFilter is outputting false error logging.", "bug_description": "The code introduced in SEC-1763 calls code expecting an exception to be thrown.  It catches the exception in some cases as noop but logs it as an error.  This happens the first time a user logins as using the SwitchUserFilter.  \nSwitchUserFilter:296:\n        try \n{\n            // SEC-1763. Check first if we are already switched.\n            currentAuth = attemptExitUser(request);\n        }\n catch (AuthenticationCredentialsNotFoundException e) \n{\n            currentAuth = SecurityContextHolder.getContext().getAuthentication();\n        }\n\nSee how it calls attemptExitUser(request).  If it is the first time being switched, an exception will be called and treated as a no-op.\nHere&apos;s attemptExitUser():\n        if (original == null) \n{\n            logger.error(\"Could not find original user Authentication object!\");\n            throw new AuthenticationCredentialsNotFoundException(messages.getMessage(\n                    \"SwitchUserFilter.noOriginalAuthentication\",\n                    \"Could not find original Authentication object\"));\n        }\n\nThat logger.error statement should be removed.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.3.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.switchuser.SwitchUserFilter.java"], "label": 1, "es_results": []}, {"bug_id": 1890, "bug_title": "BCryptPasswordEncoder throws IllegalArgumentException: Encoded password cannot be null or empty if password is empty (i.e. not encoded)", "bug_description": "Example stacktrace:\n\n\n\n\n\n\njava.lang.IllegalArgumentException: Encoded password cannot be null or empty\n\n\n\n\norg.springframework.security.crypto.bcrypt.BCryptPasswordEncoder.matches(BCryptPasswordEncoder.java:77) \n\n\n\n\norg.springframework.security.authentication.dao.DaoAuthenticationProvider$1.isPasswordValid(DaoAuthenticationProvider.java:148) \n\n\n\n\norg.springframework.security.authentication.dao.DaoAuthenticationProvider.additionalAuthenticationChecks(DaoAuthenticationProvider.java:84) \n\n\n\n\norg.springframework.security.authentication.dao.AbstractUserDetailsAuthenticationProvider.authenticate(AbstractUserDetailsAuthenticationProvider.java:149) \n\n\n\n\norg.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:156) \n\n\n\n\norg.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:174) \n\n\n\n\norg.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.attemptAuthentication(UsernamePasswordAuthenticationFilter.java:94) \n\n\n\n\norg.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:195) \n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "3.1.1.RELEASE", "fixed_files": ["org.springframework.security.crypto.bcrypt.BCryptPasswordEncoderTests.java", "org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder.java"], "label": 1, "es_results": []}, {"bug_id": 2615, "bug_title": "accesscontrollist tag documentation incorrectly states hasPermission is an or", "bug_description": "Updated Description\nIn 3.1 the accesscontrollist tag began performing an and on the permissions. This may have been accidental, but I think that it is more intuitive & secure for it to behave this way. When compared to hasAnyRole and hasRoles the hasPermission tag implies it is an and. If users end up needing OR support, then the authorize tag can be used along with the hasPermission expression. For example:\n\n\n\n\n\n\n<sec:authorize access=\"hasPermission(#domain, &apos;read&apos;) or hasPermission(#domain, &apos;write&apos;) \">\n\n\n\n\n\n\nIn general, the authorize tag should be preferred as it is the more powerful way of performing authorization checks.\nOriginal\nAccording to section 4.4 of the Spring Security reference guide:\nIt checks a comma-separated list of required permissions for a specified domain object. If the current user has any of those permissions, then the tag body will be evaluated. If they do not, it will be skipped.\nhttp://docs.spring.io/spring-security/site/docs/3.2.4.RELEASE/reference/htmlsingle/#the-accesscontrollist-tag\nHowever, the tag seems to check that the user must have all the permissions listed in the hasPermission attribute.\nIt looks like SEC-1560 introduced the problem.  I believe that means it impacts versions 3.1 through the current version.\nI&apos;m attaching a different that I believe will get the tag working as documented again.", "project": "Spring", "sub_project": "SEC", "version": "3.1.0.RELEASE", "fixed_version": "4.0.0.RC1", "fixed_files": ["org.springframework.security.taglibs.authz.AuthorizeTagTests.java", "org.springframework.security.taglibs.authz.AccessControlListTag.java"], "label": 1, "es_results": []}, {"bug_id": 2020, "bug_title": "Using http@authentication-manager-ref prevents authentication-manager@erase-credential from working", "bug_description": "In\n\n\n\n\n\n\n<sec:http realm=\"sample-realm\" authentication-manager-ref=\"sampleAuthenticationManager\"\n\n\n\n\n      pattern=\"/sample\">\n\n\n\n\n      <sec:intercept-url pattern=\"/sample/*\" access=\"ROLE_ADMIN\" />\n\n\n\n\n      <sec:http-basic />\n\n\n\n\n</sec:http>\n\n\n\n\n\n\n\n\n\n<sec:authentication-manager id=\"sampleAuthenticationManager\" erase-credentials=\"false\">\n\n\n\n\n    <sec:authentication-provider ref=\"sampleAuthenticationProvider\" />\n\n\n\n\n</sec:authentication-manager>\n\n\n\n\n\n\nHttpSecurityBeanDefinitionParser wraps \"sampleAuthenticationManager\" inside a new instance but forgets to pass the value associated to \"erase-credentials\".\n\n\n\n\n\n\nprivate BeanReference createAuthenticationManager(Element element, ParserContext pc,\n\n\n\n\n            ManagedList<BeanReference> authenticationProviders) {\n\n\n\n\n        String parentMgrRef = element.getAttribute(ATT_AUTHENTICATION_MANAGER_REF);\n\n\n\n\n        BeanDefinitionBuilder authManager = BeanDefinitionBuilder.rootBeanDefinition(ProviderManager.class);\n\n\n\n\n        authManager.addConstructorArgValue(authenticationProviders);\n\n\n\n\n\n\n\n\n\n        if (StringUtils.hasText(parentMgrRef)) {\n\n\n\n\n            authManager.addConstructorArgValue(new RuntimeBeanReference(parentMgrRef));\n\n\n\n\n[...]\n\n\n\n\n\n\nCredentials get always erased even with erase-credentials=\"false\" in the parent.", "project": "Spring", "sub_project": "SEC", "version": "3.1.1.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.config.http.HttpSecurityBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 2017, "bug_title": "ActiveDirectoryLdapAuthenticationProvider.doAuthentication() does not catch IncorrectResultSizeException", "bug_description": "The mentioned method uses Spring LDAP Template to search for the given user in AD. However, if the given user does not exist at all in the directory, the template throws IncorrectResultSizeException and not NamingException, as expected.\n\n\n\n\n\n\nSample stack-trace in Tomcat:\n\n\n\n\norg.springframework.dao.IncorrectResultSizeDataAccessException: Incorrect result size: expected 1, actual 0\n\n\n\n\n\torg.springframework.security.ldap.SpringSecurityLdapTemplate.searchForSingleEntryInternal(SpringSecurityLdapTemplate.java:239)\n\n\n\n\n\torg.springframework.security.ldap.authentication.ad.ActiveDirectoryLdapAuthenticationProvider.searchForUser(ActiveDirectoryLdapAuthenticationProvider.java:258)\n\n\n\n\n\torg.springframework.security.ldap.authentication.ad.ActiveDirectoryLdapAuthenticationProvider.doAuthentication(ActiveDirectoryLdapAuthenticationProvider.java:114)\n\n\n\n\n\torg.springframework.security.ldap.authentication.AbstractLdapAuthenticationProvider.authenticate(AbstractLdapAuthenticationProvider.java:61)\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.1.1.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.ldap.authentication.ad.ActiveDirectoryLdapAuthenticationProviderTests.java", "org.springframework.security.ldap.authentication.ad.ActiveDirectoryLdapAuthenticationProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2022, "bug_title": "sec:accesscontrollist hasPermission no longer supports list of values", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.1.1.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.taglibs.authz.AccessControlListTagTests.java", "org.springframework.security.taglibs.authz.AccessControlListTag.java"], "label": 1, "es_results": []}, {"bug_id": 2023, "bug_title": "sec:accesscontrollist hasPermission no longer supports integer bitmasks", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.1.1.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.taglibs.authz.AccessControlListTagTests.java", "org.springframework.security.taglibs.authz.AccessControlListTag.java"], "label": 1, "es_results": []}, {"bug_id": 2027, "bug_title": "FilterChainProxy clearing context causes forwards to clear authentication from the session", "bug_description": "SEC-1950 added a finally block to the FilterChainProxy doFilter method.\nAs a result, it seems that when attempting to render a model and view, the forward from tomcat (using 7.0.28) to get the JSP will be allowed.  However, when the SecurityContextPersistenceFilter calls saveContext from its doFilter method, the context is removed from the session as the context after chain execution now has a null authentication object.\nWith a second forward in place (using sitemesh) the attempt to get the decorator JSP is denied and the user is redirected back to the login page.\nI debugged under eclipse, put a break point at the following:\n\ndoFilter in the security context persistence filter\nwrapRequest (tomcat - ApplicationDispatcher) -> forward\nsave context (from the finally block of do filter of security context persistence filter)\n\nObserved:\n\ndo filter is called, which then calls chain.doFilter to continue the chain after creating the session\nwrap request is called (signalling the forward is occuring to get the jsp)\nsave context is then called which removes the context from the session as it now has a null authentication object\n\nThe next request is redirected back to the login page since no authentication attribute exists in the session.\nReverted to spring security 3.1.0 and things work fine.\nI have a hard time believing that the change under SEC-1950 was implemented without attempting to render a single model and view, so this may be something funky about our application.  However, given that reverted to 3.1.0 allows everything to function correctly, I figured it was worth creating this issue.\nOf note: our JSPs are located in our web application as opposed to statically served so they required authentication.  Perhaps this is abnormal configuration?", "project": "Spring", "sub_project": "SEC", "version": "3.1.1.RELEASE", "fixed_version": "3.1.2.RELEASE", "fixed_files": ["org.springframework.security.web.FilterChainProxyTests.java", "org.springframework.security.web.FilterChainProxy.java"], "label": 1, "es_results": []}, {"bug_id": 2055, "bug_title": "SaveContextServletOutputStream should delegate flush and close methods to wrapped ServletOutputStream", "bug_description": "In flush() and close() methods, SaveContextServletOutputStream calls super.flush() and super.close() respectively. These methods do nothing in superclass. Instead,this.delegate.flush() and this.delegate.close() should be called to ensure proper flushing and closing by the wrapped output stream", "project": "Spring", "sub_project": "SEC", "version": "3.1.2.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.web.context.HttpSessionSecurityContextRepositoryTests.java", "org.springframework.security.web.context.SaveContextOnUpdateOrErrorResponseWrapper.java"], "label": 1, "es_results": []}, {"bug_id": 2038, "bug_title": "initFilterBean() is not called within AbstractPreAuthenticatedProcessingFilter", "bug_description": "AbstractPreAuthenticatedProcessingFilter overrides afterPropertiesSet() method thus initFilterBean() from GenericFilterBean is never called. I guess it should by the contract.", "project": "Spring", "sub_project": "SEC", "version": "3.1.2.RELEASE", "fixed_version": "3.0.8.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilterTests.java", "org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 2072, "bug_title": "<security:anonymous> no longer supports multiple authories", "bug_description": "Description from the forum:\nHi. I&apos;m using this configuration\n\n\n\n\n\n\n<security:anonymous granted-authority=\"ROLE_INVITADO,ROLE_PROFILE_INVITADO,ROLE_GRUPO_PUBLICO\" username=\"invitado\" />\n\n\n\n\n\n\nSo the guest has 3 roles. Up until spring 3.1.1.RELEASE if I did\n\n\n\n\n\n\nSecurityContextHolder.getContext().getAuthentication().getAuthorities()\n\n\n\n\n\n\nI got 3 authorities (as expected).\nIn Spring 3.1.2.RELEASE I get only one authority and it&apos;s value is\n\n\n\n\n\n\n\"ROLE_INVITADO,ROLE_PROFILE_INVITADO,ROLE_GRUPO_PUBLICO\"\n\n\n\n\n\n\nSo those 3 comma separated values are not being split in 3.1.2 as they were in 3.1.1.\nI&apos;m not sure if it was originally intended to support mutiple roles separating them by comma or not. Was it? Is it now? Any othe way to set that up? Is this a bug in 3.1.2?\nI don&apos;t see this change in the version changes, maybe it was an unintended consecuence of some other change.", "project": "Spring", "sub_project": "SEC", "version": "3.1.2.RELEASE", "fixed_version": "3.2.0.M1", "fixed_files": ["org.springframework.security.config.http.AuthenticationConfigBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 2103, "bug_title": "Querying token for series: thread dump for info level ", "bug_description": "In case of empty remember me tokens JdbcTokenRepositoryImpl writes thread dump to log file that is not required because it&apos;s clear from context:\n\n\n\n\n\n\n        catch(EmptyResultDataAccessException zeroResults) {\n\n\n\n\n            if(logger.isInfoEnabled()) {\n\n\n\n\n                logger.info(\"Querying token for series &apos;\" + seriesId + \"&apos; returned no results.\", zeroResults);\n\n\n\n\n            }\n\n\n\n\n        }\n\n\n\n\n\n\nIs it possible to change level to debug or remove thread dump (better for me)?", "project": "Spring", "sub_project": "SEC", "version": "3.1.2.RELEASE", "fixed_version": "3.1.5.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImplTests.java", "org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2177, "bug_title": "DefaultRedirectStrategy could be less vulnerable to open redirect phishing attacks", "bug_description": "We have the the following configuration of the\norg.springframework.security.web.authentication.AuthenticationSuccessHandler\n\n\n\n\n\n\n  <bean id=\"simpleUrlAuthenticationSuccessHandler\"\n\n\n\n\n        class=\"org.springframework.security.web.authentication.SimpleUrlAuthenticationSuccessHandler\">\n\n\n\n\n    <property name=\"targetUrlParameter\" value=\"continue\"/>\n\n\n\n\n    <property name=\"defaultTargetUrl\" value=\"/\"/>\n\n\n\n\n    <property name=\"redirectStrategy\">\n\n\n\n\n      <bean class=\"org.springframework.security.web.DefaultRedirectStrategy\">\n\n\n\n\n        <property name=\"contextRelative\" value=\"true\"/>\n\n\n\n\n      </bean>\n\n\n\n\n    </property>\n\n\n\n\n  </bean>\n\n\n\n\n\n\nWe were hoping that setting redirectStrategy to be context relative would help us deal with open redirect vulnerability. It works fine for forged URLs like:\nhttp://example.com/login?continue=http://unsecure.com\nbecause user will not leave our service. Unfortunately, it works only for one occurrence of scheme declaration. The following URL\nhttp://example.com/login?continue=http://http://unsecure.com\nwill still perform a redirect request to the outer service. This behaviour could be easily extended by changing the following line of org.springframework.security.web.DefaultRedirectStrategy\n\n\n\n\n\n\nurl = url.substring(url.indexOf(\"://\") + 3); // strip off scheme\n\n\n\n\n\n\nto \n\n\n\n\n\n\nurl = url.substring(url.lastIndexOf(\"://\") + 3); // strip off scheme\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.1.2.RELEASE", "fixed_version": "3.2.3.RELEASE", "fixed_files": ["org.springframework.security.web.DefaultRedirectStrategyTests.java", "org.springframework.security.web.DefaultRedirectStrategy.java"], "label": 1, "es_results": []}, {"bug_id": 2136, "bug_title": "Injecting Bean in a class used in custom PermissionEvaluator leads to NoSuchBeanDefinitionException", "bug_description": "Autowiring a bean in a class used in a custom PermissionEvaluator leads to NoSuchBeanDefinitionException. If the @Autowire annotation is commented in code, the context loads correctly (but tests obviously then fail).\nThis is similar to referenced post in spring forums.\n\n\n\n\n\n\n\n\n\n\n\npublic class TestEntityPermission extends AbstractPermission {\n\n\n\n\n\n\n\n\n\n    @Autowired // comment this and context loads\n\n\n\n\n    private TestEntityService testEntityService;\n\n\n\n\n    \n\n\n\n\n    public boolean isAllowed(Authentication authentication, Object targetDomainObject,\n\n\n\n\n            String permissionType) {\n\n\n\n\n        //...\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\npublic class DefaultPermissionEvaluator implements PermissionEvaluator {\n\n\n\n\n\n\n\n\n\n    private Map<String, Permission> permissionNameToPermissionMap = new HashMap<>();\n\n\n\n\n\n\n\n\n\n\tprivate boolean checkPermissionByDomainObject(Authentication authentication,\n\n\n\n\n            Object targetDomainObject, String permissionValue) {\n\n\n\n\n        String permissionType = getPermissionType(permissionValue);\n\n\n\n\n        String permissionName = getPermissionTarget(permissionValue);\n\n\n\n\n        verifyPermissionIsDefined(permissionName);\n\n\n\n\n        Permission permission = permissionNameToPermissionMap.get(permissionName);\n\n\n\n\n        return permission.isAllowed(authentication, targetDomainObject, permissionType);\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n}\n\n\n\n\n\n\nAttached is a sample App (maven) with the according test case.", "project": "Spring", "sub_project": "SEC", "version": "3.1.3.RELEASE", "fixed_version": "3.2.0.M2", "fixed_files": ["org.springframework.security.config.method.GlobalMethodSecurityBeanDefinitionParser.java", "org.springframework.security.access.expression.method.ExpressionBasedAnnotationAttributeFactory.java"], "label": 1, "es_results": []}, {"bug_id": 2140, "bug_title": "AclAuthorizationStrategyImpl javadoc should list actions in correct order", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.1.3.RELEASE", "fixed_version": "3.2.0.M2", "fixed_files": ["org.springframework.security.acls.domain.AclAuthorizationStrategyImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2078, "bug_title": "Pre-authentication fails when using check for principal change and using non String principals", "bug_description": "The problem occurs when using pre-authentication with \"check for principal change\" set and the class there extends org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilter using non String principals but e.g. java.security.Principal.\nThe problem is that the authentication manager will always authenticate even the principal has no changed, this can give problems with the authentication provider, and performance in the code.\nThe error is in line 145 in the AbstractPreAuthenticatedProcessingFilter class, the code:\n  if (currentUser.getName().equals(principal)) \n{\n    return false;\n  }\n\nshould be changed to something like:\n  if (principal instanceof Principal) \n{\n    return !currentUser.getName().equals(((Principal)principal).getName());\n  }\n  else \n{\n    return !currentUser.getName().equals(principal.toString());\n  }\n\nThe original code will only function when the passed principal parameter is of the type String. The code suggested will function for all type of objects there either implements the java.security.Principal interface or override the toString method.", "project": "Spring", "sub_project": "SEC", "version": "3.1.3.RELEASE", "fixed_version": "3.2.6.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilterTests.java", "org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 2223, "bug_title": "FirewallRequest#reset() has incomplete javadoc", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.1.4.RELEASE", "fixed_version": "3.2.0.RC1", "fixed_files": ["org.springframework.security.web.firewall.FirewalledRequest.java"], "label": 1, "es_results": []}, {"bug_id": 2295, "bug_title": "Remove ERROR log when Spring Security is embedded into an UberJar", "bug_description": "We embed Spring Security and Spring DI into a common Uber-Jar as part of a Dropwizard application.\nWe use the Gradle Shadow plugin to do this (the Gradle version of the Maven Shade plugin).\nHowever, as soon as we add an implementation version to the generated JAR\nSpring Security logs an ERROR at start up:\ne.g.\nERROR [2013-08-29 15:09:23,322] org.springframework.security.core.SpringSecurityCoreVersion: *** Spring Major version &apos;3&apos; expected, but you are running with version: 1.1.4-SNAPSHOT. Please check your classpath for unwanted jar files.\nThis error should be changed to either a WARN or an INFO. \nIt is very unnerving for customers to see an ERROR like this at start up and they will raise support tickets or alert sysadmins.\nAlternatively, there should be a way to disable this check programmatically or via configuration.\nSee reproducible test case:\nhttps://github.com/jacek99/dropwizard-spring-di-security-onejar-example\ngit clone it and then using Gradle 1.6 or higher execute\ngradle runShadow\nYou will see the error on the screen.", "project": "Spring", "sub_project": "SEC", "version": "3.1.4.RELEASE", "fixed_version": "3.2.0.RC2", "fixed_files": ["org.springframework.security.core.SpringSecurityCoreVersionTests.java", "org.springframework.security.core.SpringSecurityCoreVersion.java"], "label": 1, "es_results": []}, {"bug_id": 2308, "bug_title": "DefaultSpringSecurityContextSource should accept empty Base DNs", "bug_description": "If DefaultSpringSecurityContextSource is constructed through DefaultSpringSecurityContextSource(List<String> urls, String baseDn) with an empty string for baseDn,it fails as follows in line 127\n\n\n\n\n\n\n            if (trimmedUrl.contains(trimmedBaseDn)) {\n\n\n\n\n                throw new IllegalArgumentException(\"LDAP URL string must not include the base DN! &apos;\" + trimmedUrl + \"&apos;\");\n\n\n\n\n            }\n\n\n\n\n\n\n\n\n\n\n\nThis check is over-eager if the Base DN is empty. This is the case with at least one of our customers, where their directory has an anonymous base.\nI suggest to amend that check with a condition that trimmedBaseDn is longer than zero.", "project": "Spring", "sub_project": "SEC", "version": "3.1.4.RELEASE", "fixed_version": "3.2.0.RC2", "fixed_files": ["org.springframework.security.ldap.DefaultSpringSecurityContextSource.java", "org.springframework.security.ldap.DefaultSpringSecurityContextSourceTests.java"], "label": 1, "es_results": []}, {"bug_id": 2246, "bug_title": "HttpSessionRequestCache.getRequest performs cast to concrete DefaultSavedRequest instead of interface SavedRequest", "bug_description": "org.springframework.security.web.savedrequest.HttpSessionRequestCache.getRequest loads the SavedRequest object form session. The method signature is using the correct SavedRequest interface. The implementation performs a cast to DefaultSavedRequest. \nUsing a custom implementation of the interface SavedRequest in the security context causes ClassCastException when the method is used to load the SavedRequest.\nThe interface should be used for cast since the method getRequest itself is not using any method of the concrete default implementation.", "project": "Spring", "sub_project": "SEC", "version": "3.1.4.RELEASE", "fixed_version": "3.2.0.RC2", "fixed_files": ["org.springframework.security.web.savedrequest.HttpSessionRequestCacheTests.java", "org.springframework.security.web.savedrequest.HttpSessionRequestCache.java"], "label": 1, "es_results": []}, {"bug_id": 2327, "bug_title": "Document SecurityExpressionRoot", "bug_description": "None of the methods in SecurityExpressionRoot have any API documentation. Without reading the code, it&apos;s not clear what some of them do. For example, it&apos;s not clear that hasRole and hasAuthority are just synonyms and don&apos;t do anything different.\nNormally I&apos;d look for help in the reference documentation for the root expressions, but it&apos;s missing most of the methods (probably hasn&apos;t been updated since 3.0, and maybe earlier).\nThe documentation for this class (Javadoc) and the expressions (reference) could be improved a good deal.", "project": "Spring", "sub_project": "SEC", "version": "3.1.4.RELEASE", "fixed_version": "3.2.0.RELEASE", "fixed_files": ["org.springframework.security.access.expression.SecurityExpressionRoot.java", "org.springframework.security.access.expression.SecurityExpressionOperations.java"], "label": 1, "es_results": []}, {"bug_id": 2410, "bug_title": "AclFormattingUtils.printBinary does not handle negative", "bug_description": "When printBinary in invoked with negative argument i it will either throw StringIndexOutOfBoundsException or return wrong result. All versions are affected.\nProblem is in Integer.toString(i, 2) which is prepending minus sign in the front of the string for negative numbers.\nSolution is to replace that call by Integer.toBinaryString\nAttached are different with patch and two simple tests that are failing with current implementation.", "project": "Spring", "sub_project": "SEC", "version": "3.1.4.RELEASE", "fixed_version": "3.2.0.RELEASE", "fixed_files": ["org.springframework.security.acls.AclFormattingUtilsTests.java", "org.springframework.security.acls.domain.AclFormattingUtils.java"], "label": 1, "es_results": []}, {"bug_id": 2096, "bug_title": "Dependency on spring-*-SNAPSHOT", "bug_description": "The 3.2 release&apos;s poms point to spring-*SNAPSHOT jars", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.M1", "fixed_version": "3.2.0.M2", "fixed_files": ["org.springframework.security.core.SpringSecurityCoreVersion.java"], "label": 1, "es_results": []}, {"bug_id": 2143, "bug_title": "Error message still mentioning version 3.1", "bug_description": "The error message in the SecurityNamespaceHandler.parse() method still mentions Spring Security Version 3.1 if an old xsd is used.", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.M1", "fixed_version": "3.2.0.M2", "fixed_files": ["org.springframework.security.config.SecurityNamespaceHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2191, "bug_title": "AuthenticationManagerBuilder requires a ObjectPostProcessor", "bug_description": "In order to function properly, AuthenticationManagerBuilder requires an ObjectPostProcessor other than QUIESCENT_POSTPROCESSOR. We should provide a way to make use of AuthenticationManagerBuilder easier.\nFor example instead of:\n\n\n\n\n\n\n@Configuration\n\n\n\n\n@EnableGlobalMethodSecurity(prePostEnabled=true)\n\n\n\n\npublic class SampleWebSecurityConfig {\n\n\n\n\n\n\n\n\n\n  @Bean\n\n\n\n\n  public AuthenticationManager authenticationManager() throws Exception {\n\n\n\n\n    return new AuthenticationManagerBuilder()\n\n\n\n\n        .inMemoryAuthentication()\n\n\n\n\n          .withUser(\"user\").password(\"password\").roles(\"USER\").and()\n\n\n\n\n        .build();\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n\nWe should support:\n\n\n\n\n\n\n@Configuration\n\n\n\n\n@EnableGlobalMethodSecurity(prePostEnabled=true)\n\n\n\n\npublic class SampleWebSecurityConfig {\n\n\n\n\n\n\n\n\n\n  @Autowired\n\n\n\n\n  public void authenticationManager(AuthenticationManagerBuilder auth) throws Exception {\n\n\n\n\n    auth\n\n\n\n\n        .inMemoryAuthentication()\n\n\n\n\n          .withUser(\"user\").password(\"password\").roles(\"USER\");\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.M2", "fixed_version": "3.2.0.RC1", "fixed_files": ["org.springframework.security.config.annotation.AbstractConfiguredSecurityBuilder.java", "org.springframework.security.config.annotation.web.configuration.EnableWebSecurity.java", "org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter.java", "org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity.java", "org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder.java", "org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 2215, "bug_title": "Injecting AuthenticationManager to SecurityContextHolderAwareRequestFilter", "bug_description": "I am trying to use servletApi() of Spring Security 3.2 M2 at my embedded Jetty 9.x application but could not be successful. AuthenticationManager seems null at SecurityContextHolderAwareRequestFilter. And because of this HttpServlet3RequestFactory is created with null authenticationManager. \nHere is the implementation of my Security Config:\n\n\n\n\n\n\n@Configuration\n\n\n\n\n@EnableWebSecurity\n\n\n\n\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   @Override\n\n\n\n\n   protected void registerAuthentication(AuthenticationManagerBuilder auth) throws Exception {\n\n\n\n\n      auth\n\n\n\n\n         .inMemoryAuthentication()\n\n\n\n\n         .withUser(\"user\").password(\"password\").roles(\"USER\")\n\n\n\n\n         .and();\n\n\n\n\n   }\n\n\n\n\n\n\n\n\n\n   @Bean\n\n\n\n\n   @Override\n\n\n\n\n   public AuthenticationManager authenticationManagerBean()  throws Exception {\n\n\n\n\n      return super.authenticationManagerBean();\n\n\n\n\n   }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   @Override\n\n\n\n\n   protected void configure(HttpSecurity http) throws Exception {\n\n\n\n\n      http\n\n\n\n\n//         .exceptionHandling().and()\n\n\n\n\n         .sessionManagement()\n\n\n\n\n            .sessionCreationPolicy(SessionCreationPolicy.ifRequired)\n\n\n\n\n            .sessionRegistry(new StarSessionRegistry()).and().and()\n\n\n\n\n         .securityContext().and()\n\n\n\n\n//         .requestCache().and()\n\n\n\n\n//         .anonymous().and()\n\n\n\n\n         .servletApi().and()\n\n\n\n\n//         .apply(new DefaultLoginPageConfigurer<HttpSecurity>()).and()\n\n\n\n\n//         .logout()\n\n\n\n\n//         .and()\n\n\n\n\n         .authorizeUrls()\n\n\n\n\n         .antMatchers(\"/login\").permitAll()\n\n\n\n\n         .antMatchers(\"/**\").authenticated();\n\n\n\n\n   }\n\n\n\n\n}\n\n\n\n\n\n\nAs a workaround I have implemented a custom beanpostprocessor which is injecting an authenticationManager. \nI am very new to Spring Security but I have checked test cases and sample applications but could not find something useful. ", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.M2", "fixed_version": "3.2.0.RC1", "fixed_files": ["org.springframework.security.config.annotation.web.configurers.LogoutConfigurer.java", "org.springframework.security.config.annotation.web.configurers.ServletApiConfigurer.java", "org.springframework.security.config.annotation.web.configurers.ExceptionHandlingConfigurer.java"], "label": 1, "es_results": []}, {"bug_id": 2198, "bug_title": "http.httpBasic() does not properly default the AuthenticationEntryPoint", "bug_description": "The following code should use BasicAuthenticationEntryPoint\n\n\n\n\n\n\n@Override\n\n\n\n\nprotected void configure(HttpSecurity http) throws Exception {\n\n\n\n\n    http\n\n\n\n\n        .authorizeUrls()\n\n\n\n\n            .anyRequest().authenticated()\n\n\n\n\n            .and()\n\n\n\n\n        .httpBasic();       \n\n\n\n\n}\n\n\n\n\n\n\nA workaround for now is:\n\n\n\n\n\n\n\n\n\n\n\n@Bean\n\n\n\n\npublic BasicAuthenticationEntryPoint entryPoint() {\n\n\n\n\n    BasicAuthenticationEntryPoint basicAuthEntryPoint = new BasicAuthenticationEntryPoint();\n\n\n\n\n    basicAuthEntryPoint.setRealmName(\"My Realm\");\n\n\n\n\n    return basicAuthEntryPoint;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n@Override\n\n\n\n\nprotected void configure(HttpSecurity http) throws Exception {\n\n\n\n\n\n\n\n\n\n    http\n\n\n\n\n        .exceptionHandling()\n\n\n\n\n            .authenticationEntryPoint(entryPoint())\n\n\n\n\n            .and()\n\n\n\n\n        .authorizeUrls()\n\n\n\n\n            .anyRequest().authenticated()\n\n\n\n\n            .and()\n\n\n\n\n        .httpBasic();       \n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.M2", "fixed_version": "3.2.0.RC1", "fixed_files": ["org.springframework.security.config.annotation.web.configurers.HttpBasicConfigurer.java"], "label": 1, "es_results": []}, {"bug_id": 2222, "bug_title": "Javadoc error - WebSecurityConfigurerAdapter.registerAuthentication & EnableWebSecurity refer to wrong parameter", "bug_description": "The example for WebSecurityConfigurerAdapter.registerAuthentication and EnableWebSecurity refer to &apos;registry&apos; rather than &apos;auth&apos;.", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.M2", "fixed_version": "3.2.0.RC1", "fixed_files": ["org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter.java", "org.springframework.security.config.annotation.web.configuration.EnableWebSecurity.java"], "label": 1, "es_results": []}, {"bug_id": 2205, "bug_title": "Create UserDetailsServiceDelegator", "bug_description": "Ordering issues can cause the UserDetailsService to be null. To resolve this, a UserDetailsServiceDelegator should be created. An example workaround can be found below:\n\n\n\n\n\n\n@Configuration\n\n\n\n\n@EnableWebSecurity\n\n\n\n\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n\n\n\n    private UserDetailsServiceDelegator userDetailsService = new UserDetailsServiceDelegator();\n\n\n\n\n\n\n\n\n\n    @Bean\n\n\n\n\n    @Override\n\n\n\n\n    public UserDetailsService userDetailsServiceBean() throws Exception {\n\n\n\n\n        return userDetailsService;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    @Override\n\n\n\n\n    protected void registerAuthentication(\n\n\n\n\n            AuthenticationManagerBuilder auth) throws Exception {\n\n\n\n\n        userDetailsService.setBuilder(auth);\n\n\n\n\n        ...\n\n\n\n\n    }\n\n\n\n\n    \n\n\n\n\n    static final class UserDetailsServiceDelegator implements UserDetailsService {\n\n\n\n\n        private AuthenticationManagerBuilder delegateBuilder;\n\n\n\n\n        private UserDetailsService delegate;\n\n\n\n\n        private final Object delegateMonitor = new Object();\n\n\n\n\n\n\n\n\n\n        private void setBuilder(AuthenticationManagerBuilder authentication) {\n\n\n\n\n            this.delegateBuilder = authentication;\n\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n        public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException { \n\n\n\n\n            if(delegate != null) {\n\n\n\n\n                return delegate.loadUserByUsername(username);\n\n\n\n\n            }\n\n\n\n\n\n\n\n\n\n            synchronized(delegateMonitor) {\n\n\n\n\n                if (delegate == null) {\n\n\n\n\n                    delegate = this.delegateBuilder.getDefaultUserDetailsService();\n\n\n\n\n                    this.delegateBuilder = null;\n\n\n\n\n                }\n\n\n\n\n            }\n\n\n\n\n\n\n\n\n\n            return delegate.loadUserByUsername(username);\n\n\n\n\n        }\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.M2", "fixed_version": "3.2.0.RC1", "fixed_files": ["org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter.java"], "label": 1, "es_results": []}, {"bug_id": 2280, "bug_title": "Fix SessionFixationConfigurer#changeSessionId Javadoc", "bug_description": "The Javadoc for SessionFixationConfigurer#changeSessionId() was copied and pasted from SessionFixationConfigurer#none() and never updated. It is incorrect. This commit fixes that. It also adds a newline at the end of the file, which the file was missing, causing Git to complain.\nPull request https://github.com/SpringSource/spring-security/pull/42", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC1", "fixed_version": "3.2.0.RC2", "fixed_files": ["org.springframework.security.config.annotation.web.configurers.SessionManagementConfigurer.java"], "label": 1, "es_results": []}, {"bug_id": 2296, "bug_title": "HttpServletRequest.login should throw ServletException if already authenticated", "bug_description": "http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#login%28java.lang.String,%20java.lang.String%29", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC1", "fixed_version": "3.2.0.RC2", "fixed_files": ["org.springframework.security.web.servletapi.HttpServlet3RequestFactory.java", "org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilterTests.java"], "label": 1, "es_results": []}, {"bug_id": 2301, "bug_title": "GlobalMethodSecurityConfiguration's DefaultWebSecurityExpressionHandler has null BeanResolver", "bug_description": "\nthis blog post got me started with java config, and everything worked fine until i tried to use @PreAuthorize annotation that uses my custom authentication service (via @myCustomService) expression. I get an error that\nNo bean resolver registered in the context to resolve access to bean myCustomService\nLooking at M2 and RC1 source code, it seems that when WebSecurity is created in WebSecurityConfiguration and the default DefaultWebSecurityExpressionHandler is used and it has no BeanResolver set (from AbstractSecurityExpressionHandler).\nMight this be a bug in the java based configuration?", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC1", "fixed_version": "3.2.0.RC2", "fixed_files": ["org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 2304, "bug_title": "GlobalMethodSecurityConfiguration has two methods for the Expression Handler", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC1", "fixed_version": "3.2.0.RC2", "fixed_files": ["org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 2328, "bug_title": "Java configuration missing hasAnyRole", "bug_description": "Java configuration for restricting access to a URI has methods hasAuthority, hasAnyAuthority, and hasRole. It is missing hasAnyRole. This is not a big deal since you can work around it with hasAnyAuthority, but it&apos;s still not consistent with using string expressions in access or annotations.", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC1", "fixed_version": "3.2.0.RC2", "fixed_files": ["org.springframework.security.config.annotation.web.configurers.ExpressionUrlAuthorizationConfigurer.java"], "label": 1, "es_results": []}, {"bug_id": 2302, "bug_title": "Allow filters to register in front of SpringSecurityFilterChain", "bug_description": "With an AbstractSecurityWebApplicationInitializer in place its imposible to register an other filter in front of SpringSecurityFilterChain.", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC1", "fixed_version": "3.2.0.RC2", "fixed_files": ["org.springframework.security.web.context.AbstractSecurityWebApplicationInitializer.java"], "label": 1, "es_results": []}, {"bug_id": 2303, "bug_title": "WebSecurity's default expression handler does not have the bean resolver set", "bug_description": "Similar to SEC-2301", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC1", "fixed_version": "3.2.0.RC2", "fixed_files": ["org.springframework.security.config.annotation.web.builders.WebSecurity.java", "org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration.java", "org.springframework.security.config.annotation.web.configurers.ExpressionUrlAuthorizationConfigurer.java"], "label": 1, "es_results": []}, {"bug_id": 2350, "bug_title": "Warning when using 3.2.0.RC2 with Spring Framework 4.0", "bug_description": "When starting an application running Spring Framework 4.0 and Spring Security 3.2.0.RC2, the following message is logged:\n12:19:08.129 [localhost-startStop-1]   WARN  org.springframework.security.core.SpringSecurityCoreVersion org.springframework.security.core.SpringSecurityCoreVersion.performVersionChecks(SpringSecurityCoreVersion.java:53): *** Spring Major version &apos;3&apos; expected, but you are running with version: 4.0.0.BUILD-SNAPSHOT. Please check your classpath for unwanted jar files.\nSpring Security should certainly warn if Spring Framework is older than supported, but it should not warn if Spring Framework is newer that expected. At the very least, 3.2.0 should support Spring Framework 4.", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC1", "fixed_version": "3.2.0.RELEASE", "fixed_files": ["org.springframework.security.core.SpringSecurityCoreVersionTests.java", "org.springframework.security.core.SpringSecurityCoreVersion.java"], "label": 1, "es_results": []}, {"bug_id": 2418, "bug_title": "[patch] toString method in LdapUserDetailsImpl never prints \"Not granted any authorities\"", "bug_description": "In my application, my LDAP users have zero granted authorities, but the toString method does not print \"Not granted any authorities\", this is because the authorities collection is a non-null empty collection.", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC2", "fixed_version": "3.2.0.RELEASE", "fixed_files": ["org.springframework.security.ldap.userdetails.LdapUserDetailsImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2367, "bug_title": "ProviderManager does not report InternalAuthenticationServiceExceptions", "bug_description": "If the ProviderManager has multiple AuthenticationProviders and one of the earlier providers throws an InternalAuthenticationServiceException then it will not be reported if a later provider throws any kind of AuthenticationException.\nI experienced this when the errors that were occurring from a misconfigured LDAP provider were masked by the UsernameNotFoundException from the subsequent dao provider.\nGiven the javadocs for InternalAuthenticationServiceException it sounds like these errors should be logged even if a subsequent authentication provider succeeds (or fails).  Perhaps ProviderManager.authenticate() should have a special case for handling IASEs like it does for {{AccountStatusException}}s.", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC1", "fixed_version": "3.2.0.RELEASE", "fixed_files": ["org.springframework.security.authentication.ProviderManager.java", "org.springframework.security.authentication.ProviderManagerTests.java"], "label": 1, "es_results": []}, {"bug_id": 2422, "bug_title": "Session timeout not detected when enable CSRF protection", "bug_description": "settings is following:\n\n\n\n\n\n\n    <sec:http auto-config=\"true\" use-expressions=\"true\">\n\n\n\n\n        <sec:session-management \n\n\n\n\n            invalid-session-url=\"/error/sessionError\"\n\n\n\n\n            session-authentication-strategy-ref=\"sessionAuthenticationStrategy\" />\n\n\n\n\n    </sec:http>\n\n\n\n\n\n\nDetected the session time-out when called GET method, but not detected session time-out  when called POST method.\nWhen called POST method, occurred the CSRF token error.\nThis behavior are best practice in the spring security?\nAlso When called POST method, i wanted to detect the session time-out.\nIf wanted to detect the session timeout when called POST method, what should I do?", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC2", "fixed_version": "3.2.0.RELEASE", "fixed_files": ["org.springframework.security.config.annotation.web.configurers.CsrfConfigurer.java", "org.springframework.security.config.http.HttpConfigurationBuilder.java", "org.springframework.security.config.annotation.web.configurers.SessionManagementConfigurer.java", "org.springframework.security.web.csrf.InvalidCsrfTokenException.java", "org.springframework.security.config.http.CsrfBeanDefinitionParser.java", "org.springframework.security.web.csrf.CsrfFilter.java"], "label": 1, "es_results": []}, {"bug_id": 2439, "bug_title": "HttpSessionCsrfTokenRepository setHeaderName uses parameterName", "bug_description": "In HttpSessionCsrfTokenRepository, setHeaderName should use headerName, not parameterName (probably a copy/paste bug):\n\n\n\n\n\n\n    /**\n\n\n\n\n     * Sets the header name that the {@link CsrfToken} is expected to appear on\n\n\n\n\n     * and the header that the response will contain the {@link CsrfToken}.\n\n\n\n\n     *\n\n\n\n\n     * @param parameterName\n\n\n\n\n     *            the new parameter name to use\n\n\n\n\n     */\n\n\n\n\n    public void setHeaderName(String parameterName) {\n\n\n\n\n        Assert.hasLength(parameterName, \"parameterName cannot be null or empty\");\n\n\n\n\n        this.parameterName = parameterName;\n\n\n\n\n    }\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RC2", "fixed_version": "3.2.0.RELEASE", "fixed_files": ["org.springframework.security.web.csrf.HttpSessionCsrfTokenRepositoryTests.java", "org.springframework.security.web.csrf.HttpSessionCsrfTokenRepository.java"], "label": 1, "es_results": []}, {"bug_id": 2455, "bug_title": "form@login-processing-url and logout@logout-url produce warnings", "bug_description": "On upgrading to 3.2.0 RELEASE, we encountered this warning in the <http> block in the namespace configuration. \n<form-login> and <logout>\nThe warning says that setFilterProcessesUrl (which is inherited from AbstractAuthenticationProcessingFilter whose subclass be used by http@form-login and http@logout) is deprecated. Did we miss on replacing the deprecated method with the new method to be used? Can we remove this method altogether? Or is this warning here to stay? What does this warning mean?", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RELEASE", "fixed_version": "3.2.1.RELEASE", "fixed_files": ["org.springframework.security.config.http.AuthenticationConfigBuilder.java", "org.springframework.security.config.http.FormLoginBeanDefinitionParser.java", "org.springframework.security.web.authentication.logout.LogoutFilter.java", "org.springframework.security.config.http.LogoutBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 2461, "bug_title": "Multiple WebSecurityConfiguration instances because null springSecurityFilterChain", "bug_description": "See SpringApplicationHierarchyTests within https://github.com/rwinch/spring-boot/tree/SEC-2461", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RELEASE", "fixed_version": "3.2.1.RELEASE", "fixed_files": ["org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration.java", "org.springframework.security.config.annotation.web.configuration.sec2377.b.Sec2377BConfig.java"], "label": 1, "es_results": []}, {"bug_id": 2392, "bug_title": "Unexpectedly long key created by KeyBasedPersistenceTokenService.allocateToken()", "bug_description": "The method allocateToken in KeyBasedPersistenceTokenService creates a token with an unexpectedly long key.\nThe reason for this is that the attribute pseudoRandomNumberBits (default = 256) is not converted to a number of bytes in the method generatePseudoRandomNumber() :\n\n\n\n\n\n\n    private String generatePseudoRandomNumber() {\n\n\n\n\n        byte[] randomizedBits = new byte[pseudoRandomNumberBits];\n\n\n\n\n        secureRandom.nextBytes(randomizedBits);\n\n\n\n\n        return new String(Hex.encode(randomizedBits));\n\n\n\n\n    }\n\n\n\n\n\n\nThis string is then concatenated to others to create the final key of the Token :\n\n\n\n\n\n\n        String content = Long.toString(creationTime) + \":\" + pseudoRandomNumber + \":\" + extendedInformation;\n\n\n\n\n\n\n\n\n\n        // Compute key\n\n\n\n\n        String sha512Hex = Sha512DigestUtils.shaHex(content + \":\" + serverSecret);\n\n\n\n\n        String keyPayload = content + \":\" + sha512Hex;\n\n\n\n\n        String key = Utf8.decode(Base64.encode(Utf8.encode(keyPayload)));\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RELEASE", "fixed_version": "3.2.1.RELEASE", "fixed_files": ["org.springframework.security.core.token.KeyBasedPersistenceTokenService.java"], "label": 1, "es_results": []}, {"bug_id": 2492, "bug_title": "ExpressionUrlAuthorizationConfigurer.interceptUrl Javadoc incorrect", "bug_description": "Looks like refactoring garbage. As stated in javadoc comment method could be chained, but now it is private.", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RELEASE", "fixed_version": "3.2.1.RELEASE", "fixed_files": ["org.springframework.security.config.annotation.web.configurers.ExpressionUrlAuthorizationConfigurer.java"], "label": 1, "es_results": []}, {"bug_id": 2683, "bug_title": "Spelling Mistake in AuthenticationPrincipalArgumentResolver", "bug_description": "In AuthenticationPrincipalArgumentResolver, line 109, assignable is misspelled as \"assiable\" in the Exception reason.", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RELEASE", "fixed_version": "3.2.5.RELEASE", "fixed_files": ["org.springframework.security.web.bind.support.AuthenticationPrincipalArgumentResolver.java"], "label": 1, "es_results": []}, {"bug_id": 2574, "bug_title": "Default JavaConfig SessionRegistryImpl does not receive SessionDestroyedEvents", "bug_description": "SessionManagementConfigurer creates a default SessionRegistryImpl directly, without wiring it as a Spring bean. So, the SessionRegistryImpl does not receive SessionDestroyedEvents and does not maintain an accurate list of current sessions.\nOnce consequence of this is that concurrency control will work off inaccurate data, and in the worst case prevents users from ever logging in a second time with maximumSessions(1) and maxSessionPreventsLogin(true).\nA workaround is for an application to define its own @Bean sessionRegistry(), and use it with \"ConcurrencyControlConfigurer.sessionRegistry(sessionRegistry())\". But this shouldn&apos;t be necessary.", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RELEASE", "fixed_version": "4.0.0.RC1", "fixed_files": ["org.springframework.security.config.annotation.web.configurers.SessionManagementConfigurer.java", "org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 2493, "bug_title": "Javadoc for DefaultLdapAuthoritiesPopulator lists wrong class name & incorrect property", "bug_description": "http://docs.spring.io/spring-security/site/docs/3.2.0.RELEASE/apidocs/org/springframework/security/ldap/userdetails/DefaultLdapAuthoritiesPopulator.html\nshows\n\n\n\n\n\n\n<bean id=\"ldapAuthoritiesPopulator\"\n\n\n\n\n       class=\"org.springframework.security.authentication.ldap.populator.DefaultLdapAuthoritiesPopulator\">\n\n\n\n\n   <constructor-arg ref=\"contextSource\"/>\n\n\n\n\n   <constructor-arg value=\"ou=groups\"/>\n\n\n\n\n   <property name=\"groupRoleAttribute\" value=\"ou\"/>\n\n\n\n\n <!-- the following properties are shown with their default values -->\n\n\n\n\n   <property name=\"searchSubTree\" value=\"false\"/>\n\n\n\n\n   <property name=\"rolePrefix\" value=\"ROLE_\"/>\n\n\n\n\n   <property name=\"convertToUpperCase\" value=\"true\"/>\n\n\n\n\n </bean>\n\n\n\n\n\n\nbut should be\n\n\n\n\n\n\n<bean id=\"ldapAuthoritiesPopulator\"\n\n\n\n\n       class=\"org.springframework.security.ldap.userdetails.DefaultLdapAuthoritiesPopulator\">\n\n\n\n\n   <constructor-arg ref=\"contextSource\"/>\n\n\n\n\n   <constructor-arg value=\"ou=groups\"/>\n\n\n\n\n   <property name=\"groupRoleAttribute\" value=\"ou\"/>\n\n\n\n\n <!-- the following properties are shown with their default values -->\n\n\n\n\n   <property name=\"searchSubTree\" value=\"false\"/>\n\n\n\n\n   <property name=\"rolePrefix\" value=\"ROLE_\"/>\n\n\n\n\n   <property name=\"convertToUpperCase\" value=\"true\"/>\n\n\n\n\n </bean>\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.2.0.RELEASE", "fixed_version": "3.2.8.RELEASE", "fixed_files": ["org.springframework.security.ldap.userdetails.DefaultLdapAuthoritiesPopulator.java"], "label": 1, "es_results": []}, {"bug_id": 2511, "bug_title": "Remove double ALLOW-FROM from X-Frame-Options header", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.2.1.RELEASE", "fixed_version": "3.2.2.RELEASE", "fixed_files": ["org.springframework.security.web.header.writers.frameoptions.AbstractRequestParameterAllowFromStrategyTests.java", "org.springframework.security.web.header.writers.frameoptions.WhiteListedAllowFromStrategyTests.java", "org.springframework.security.web.header.writers.frameoptions.RegExpAllowFromStrategyTests.java", "org.springframework.security.web.header.writers.frameoptions.AbstractRequestParameterAllowFromStrategy.java"], "label": 1, "es_results": []}, {"bug_id": 2507, "bug_title": "WebExpressionVoter - supported secured object class", "bug_description": "It&apos;s probably a typo - WebExpressionVoter has the following method:\n\n\n\n\n\n\npublic boolean supports(Class<?> clazz) {\n\n\n\n\n    return clazz.isAssignableFrom(FilterInvocation.class);\n\n\n\n\n}\n\n\n\n\n\n\nI think it should be:\n\n\n\n\n\n\npublic boolean supports(Class<?> clazz) {\n\n\n\n\n    return FilterInvocation.class.isAssignableFrom(clazz);\n\n\n\n\n}\n\n\n\n\n\n\nbecause WebExpressionVoter should support subclasses of FilterInvocation.", "project": "Spring", "sub_project": "SEC", "version": "3.2.1.RELEASE", "fixed_version": "3.1.6.RELEASE", "fixed_files": ["org.springframework.security.web.access.expression.WebExpressionVoter.java", "org.springframework.security.web.access.expression.WebExpressionVoterTests.java"], "label": 1, "es_results": []}, {"bug_id": 2533, "bug_title": "Global AuthenticationManagerBuilder#eraseCredentials=false does not work", "bug_description": "The following configuration still clears out the credentials since nothing is associating the configuration from the parent (global configuration) to the child (HttpSecurity&apos;s authentication used for formLogin, openid, etc support) AuthenticationManager:\n\n\n\n\n\n\n@EnableWebSecurity\n\n\n\n\n@Configuration\n\n\n\n\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n\n\n\n    @Autowired\n\n\n\n\n    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n\n\n\n\n        auth\n\n\n\n\n            .eraseCredentials(false)\n\n\n\n\n            .inMemoryAuthentication()\n\n\n\n\n                .withUser(\"user\").password(\"password\").roles(\"USER\")\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.2.2.RELEASE", "fixed_version": "3.2.3.RELEASE", "fixed_files": ["org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 2973, "bug_title": "SecurityContext should be persisted when the response body reaches the content length", "bug_description": "I was struggling with the same kind of issue that was fixed by SEC-2005\nin my app, i have a specialized SecurityContextRepository that is load/saving some extra information related to the context into a cookie\nEverything works fine, the loading and the saving methods are called nicely, except that for the saving the call was happening long after the commit of the response (so&apos; don&apos;t reach the client).\nThen, I have tried to trace down the problem and figured out that the internal private class SaveContextPrintWriter in SaveContextOnUpdateOrErrorResponseWrapper.java sounds to be the because of the problem\nThis internal class is using a delegation pattern to allow to save the context when intentionally flushing or closing the PrintWriter from the caller. \n(flush or close are causing the commit of the response)\nThe problem is that the PrintWriter might also call internally its flush method when you are writing in it and there is a long buffer pending. This internal call cannot be intercepted by the delegation pattern. As it is out of the control, the only way to enforce a context save is to add an explicit call to doSaveContext() on every  write*, print*, format*, append* of the internal private class SaveContextPrintWriter, before calling the delegated method  \nby the way, the append methods must also be changed to return this (and not the delegated writer). It helps to keep the wrapped PrintWriter if the caller is doing thing like\nnew SaveContextPrintWriter(response.getPrintWriter).append(\"111\").append(\"222\").flush();\nfinally, what is applicable for SaveContextPrintWriter must also be applied to SaveContextServletOutputStream = every write method must fist call the doSaveContext()\nexample of change \n\n\n\n\n\n\n    public PrintWriter append(CharSequence csq) {\n\n\n\n\n            doSaveContext();\n\n\n\n\n            delegate.append(csq);\n\n\n\n\n            return this;\n\n\n\n\n        }\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.2.2.RELEASE", "fixed_version": "3.2.8.RELEASE", "fixed_files": ["org.springframework.security.web.context.SaveContextOnUpdateOrErrorResponseWrapper.java"], "label": 1, "es_results": []}, {"bug_id": 2549, "bug_title": "java.lang.IllegalAccessError: class org.springframework.security.config.annotation.authentication.configuration.$Proxy90 cannot access its superinterface <omitted>.AuthenticationConfiguration$LazyBean", "bug_description": "Is it possible to change the visibility of LazyBean marker interface to `public`?\nWe are planning to pull up spring dependencies as JBoss EAP \"module\" (shared libraries) to be shared among all of our applications.\nEach \"module\" has its own isolated ClassLoader, and is parallel to the war \"module\" ClassLoader, so we have to emulate the class loading hierarchy ourselves for compatibility.\nThe problem is that the aggregated ClassLoader (delegates to \"module\" classLoader and then the applications&apos;s ClassLoader) cannot sees the private LazyBean marker.", "project": "Spring", "sub_project": "SEC", "version": "3.2.3.RELEASE", "fixed_version": "3.2.4.RELEASE", "fixed_files": ["org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter.java", "org.springframework.security.config.annotation.authentication.configuration.AuthenticationConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 2571, "bug_title": "Failures in UserDetailsService should produce errors in the console", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.2.3.RELEASE", "fixed_version": "3.2.4.RELEASE", "fixed_files": ["org.springframework.security.authentication.dao.DaoAuthenticationProvider.java", "org.springframework.security.authentication.dao.DaoAuthenticationProviderTests.java"], "label": 1, "es_results": []}, {"bug_id": 2543, "bug_title": "Logout Does Not Require POST even though CSRF is enabled", "bug_description": "The documentation says \"Adding CSRF will update the LogoutFilter to only use HTTP POST. This ensures that log out requires a CSRF token and that a malicious user cannot forcibly log out your users.\": http://docs.spring.io/spring-securit...e/#csrf-logout\nHowever, in my testing, I can still logout with a GET to /logout using the following Java-based security configuration:\n\n\n\n\n\n\nSecurityConfig.java\n\n\n\n\n\n\n@Configuration\n\n\n\n\n@EnableWebMvcSecurity\n\n\n\n\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n\n\n\n    @Override\n\n\n\n\n    protected void configure(final AuthenticationManagerBuilder auth)\n\n\n\n\n            throws Exception {\n\n\n\n\n        auth.inMemoryAuthentication()//\n\n\n\n\n                .withUser(\"user\").password(\"password\").roles(\"USER\")//\n\n\n\n\n                .and()//\n\n\n\n\n                .withUser(\"admin\").password(\"password\").roles(\"USER\", \"ADMIN\");\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    @Override\n\n\n\n\n    protected void configure(final HttpSecurity http) throws Exception {\n\n\n\n\n        http.authorizeRequests()//\n\n\n\n\n                .antMatchers(\"/admin/**\").hasRole(\"ADMIN\")//\n\n\n\n\n                .antMatchers(\"/**\").permitAll().and()//\n\n\n\n\n                .formLogin();\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "3.2.3.RELEASE", "fixed_version": "3.2.4.RELEASE", "fixed_files": ["org.springframework.security.config.annotation.web.configurers.LogoutConfigurer.java"], "label": 1, "es_results": []}, {"bug_id": 2578, "bug_title": "HttpSessionSecurityContextRepository should traverse HttpServletResponseWrapper", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.2.3.RELEASE", "fixed_version": "3.2.4.RELEASE", "fixed_files": ["org.springframework.security.web.context.HttpSessionSecurityContextRepositoryTests.java", "org.springframework.security.web.context.HttpSessionSecurityContextRepository.java"], "label": 1, "es_results": []}, {"bug_id": 2606, "bug_title": "ApacheDSServerIntegrationTests should scan for available port", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.2.3.RELEASE", "fixed_version": "3.2.4.RELEASE", "fixed_files": ["org.springframework.security.ldap.AbstractLdapIntegrationTests.java", "org.springframework.security.ldap.ApacheDSServerIntegrationTests.java", "org.springframework.security.ldap.DefaultSpringSecurityContextSourceTests.java", "org.springframework.security.ldap.SpringSecurityLdapTemplateITests.java"], "label": 1, "es_results": []}, {"bug_id": 2697, "bug_title": "Invalid warning logged when using Spring 3.2.10.RELEASE", "bug_description": "I&apos;m using Spring Framework (version 3.2.10.RELEASE).\nDuring application startup I&apos;m getting following warning:\n\norg.springframework.security.core.SpringSecurityCoreVersion - **** You are advised to use Spring 3.2.8.RELEASE or later with this version. You are running: 3.2.10.RELEASE\nIt seems that versions are compared using String.compareTo().\nUsing this method \"3.2.10.RELEASE\" is lower then \"3.2.8.RELEASE\".", "project": "Spring", "sub_project": "SEC", "version": "3.2.4.RELEASE", "fixed_version": "3.2.5.RELEASE", "fixed_files": ["org.springframework.security.core.SpringSecurityCoreVersionTests.java", "org.springframework.security.core.SpringSecurityCoreVersion.java"], "label": 1, "es_results": []}, {"bug_id": 2815, "bug_title": "@EnableGlobalMethodSecurity prevents postprocessing of DataSource bean", "bug_description": "Adding `@EnableGlobalMethodSecurity` annotation to my extension of `WebSecurityConfigurerAdapter` prevents embedded database initialization in integration testing.\nThe problem is very nicely summarized here -> https://gist.github.com/dsyer/ebeb25d5afbdd9242cd5", "project": "Spring", "sub_project": "SEC", "version": "3.2.5.RELEASE", "fixed_version": "3.2.6.RELEASE", "fixed_files": ["org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 2791, "bug_title": "Chrome/safari: cookie not set AbstractRememberMeServices should have a setter for cookie version", "bug_description": "RememberMe cookie is not set in chrome and safari because only Expires field is set, not max age and they both ignore cookies.\nMaxAge is only set in jetty when version is >= 1.", "project": "Spring", "sub_project": "SEC", "version": "3.2.5.RELEASE", "fixed_version": "3.2.6.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.rememberme.AbstractRememberMeServices.java", "org.springframework.security.web.authentication.rememberme.AbstractRememberMeServicesTests.java"], "label": 1, "es_results": []}, {"bug_id": 2832, "bug_title": "CSRF Request attributes not updated on authentication", "bug_description": "The CsrfFilter sets request attributes on each request, exposing the current CsrfToken for later use.  However, if authentication happens during this request, the SessionManagementFilter will cause the CsrfAuthenticationStrategy to fire which will generate a new token.  However, the request attributes are not updated.  As a result, if there is a form being rendered in the response using the CsrfRequestDataValueProcessor, it will use the old CsrfToken instead of the newly generated one.  As a result, when the form is submitted, the request will fail due to CSRF protection.", "project": "Spring", "sub_project": "SEC", "version": "3.2.5.RELEASE", "fixed_version": "3.2.6.RELEASE", "fixed_files": ["org.springframework.security.web.csrf.CsrfAuthenticationStrategyTests.java", "org.springframework.security.web.csrf.CsrfAuthenticationStrategy.java"], "label": 1, "es_results": []}, {"bug_id": 2879, "bug_title": "JdbcTokenRepositoryImpl updateToken should use lastUsed arg", "bug_description": "", "project": "Spring", "sub_project": "SEC", "version": "3.2.5.RELEASE", "fixed_version": "3.2.6.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImplTests.java", "org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2908, "bug_title": "Example given in javadoc does not work", "bug_description": "The code below is copied from the javadoc of HttpSecurity HttpSecurity .requestMatcher(RequestMatcher requestMatcher):\n\n\n\n\n\n\n @Configuration\n\n\n\n\n @EnableWebSecurity\n\n\n\n\n public class RequestMatchersSecurityConfig extends WebSecurityConfigurerAdapter {\n\n\n\n\n\n\n\n\n\n     @Override\n\n\n\n\n     protected void configure(HttpSecurity http) throws Exception {\n\n\n\n\n         http\n\n\n\n\n             .requestMatchers()\n\n\n\n\n                 .antMatchers(\"/api/**\")\n\n\n\n\n                 .and()\n\n\n\n\n             .requestMatchers()\n\n\n\n\n                 .antMatchers(\"/oauth/**\")\n\n\n\n\n                 .and()\n\n\n\n\n             .authorizeRequests()\n\n\n\n\n                 .antMatchers(\"/**\").hasRole(\"USER\").and()\n\n\n\n\n                 .httpBasic();\n\n\n\n\n     }\n\n\n\n\n\n\n\n\n\n     @Override\n\n\n\n\n     protected void configure(AuthenticationManagerBuilder auth)\n\n\n\n\n             throws Exception {\n\n\n\n\n         auth\n\n\n\n\n             .inMemoryAuthentication()\n\n\n\n\n                 .withUser(\"user\")\n\n\n\n\n                     .password(\"password\")\n\n\n\n\n                     .roles(\"USER\");\n\n\n\n\n     }\n\n\n\n\n }\n\n\n\n\n\n\nthe request matcher only matches /oauth/** exptected an OrMatcher on /api/** and /oauth/**\n\n\n\n\n\n\n2015-03-17 14:55:10.448  INFO 35782 --- [           main] o.s.s.web.DefaultSecurityFilterChain     : Creating filter chain: OrRequestMatcher [requestMatchers=[Ant [pattern=&apos;/oauth/**&apos;]]], [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6956e01, org.springframework.security.web.context.SecurityContextPersistenceFilter@4708993a, org.springframework.security.web.header.HeaderWriterFilter@448d9973, org.springframework.security.web.csrf.CsrfFilter@624f1602, org.springframework.security.web.authentication.logout.LogoutFilter@79b04c7, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@306eb59c, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@292e39db, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@501cc8a5, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3c690707, org.springframework.security.web.session.SessionManagementFilter@1516d73d, org.springframework.security.web.access.ExceptionTranslationFilter@110f9f2f, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@364adedd]\n\n\n\n\n\n\n\n\n\n\n\nNotice OrRequestMatcher [requestMatchers=[Ant [pattern=&apos;/oauth/**&apos;]]] in log.", "project": "Spring", "sub_project": "SEC", "version": "3.2.5.RELEASE", "fixed_version": "4.0.0.RELEASE", "fixed_files": ["org.springframework.security.config.annotation.web.builders.HttpSecurity.java"], "label": 1, "es_results": []}, {"bug_id": 2897, "bug_title": "ActiveDirectoryLdapAuthenticationProvider should use bindPrincipal not username", "bug_description": "Shouldn&apos;t the lines\nreturn SpringSecurityLdapTemplate.searchForSingleEntryInternal(context, searchControls,\n                   searchRoot, searchFilter, new Object[]\n{username}\n);\nactually be\nreturn SpringSecurityLdapTemplate.searchForSingleEntryInternal(context, searchControls,\n                   searchRoot, searchFilter, new Object[]\n{bindPrincipal}\n);\n?\nThis currently breaks our authentication.", "project": "Spring", "sub_project": "SEC", "version": "3.2.6.RELEASE", "fixed_version": "3.2.7.RELEASE", "fixed_files": ["org.springframework.security.ldap.authentication.ad.ActiveDirectoryLdapAuthenticationProviderTests.java", "org.springframework.security.ldap.authentication.ad.ActiveDirectoryLdapAuthenticationProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2913, "bug_title": "Default JavaConfig session fixation AuthenticationStrategy has NullEventPublisher", "bug_description": "Debugging into a ChangeSessionIdAuthenticationStrategy in a working app I noticed that the applicationEventPublisher was a no-op. Seems like maybe it didn&apos;t get configured somewhere in Spring Security Javaconfig?", "project": "Spring", "sub_project": "SEC", "version": "3.2.6.RELEASE", "fixed_version": "3.2.7.RELEASE", "fixed_files": ["org.springframework.security.config.annotation.web.configurers.SessionManagementConfigurer.java"], "label": 1, "es_results": []}, {"bug_id": 3045, "bug_title": "EnableGlobalMethodSecurity mode=ASPECTJ creates proxies if InfrastructureAdvisorAutoProxyCreator is Added", "bug_description": "If InfrastructureAdvisorAutoProxyCreator exists, then Spring Security will create proxies for security related classes when @EnableGlobalMethodSecurity(mode=ASPECTJ, ....\nThis is due to the fact that GlobalMethodSecurityConfiguration creates a MethodSecurityMetadataSourceAdvisor.\nInstead we should conditionally create MethodSecurityMetadataSourceAdvisor in an ImportBeanDefintionRegistrar only when using proxies for Spring Security.", "project": "Spring", "sub_project": "SEC", "version": "3.2.7.RELEASE", "fixed_version": "4.0.2.RELEASE", "fixed_files": ["org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration.java", "org.springframework.security.config.annotation.method.configuration.GlobalMethodSecuritySelector.java"], "label": 1, "es_results": []}, {"bug_id": 3109, "bug_title": "Concurrent/ThreadPoolTaskScheduler do not work with DelegatingSecurityContextExecutor", "bug_description": "We have a setup with Spring Boot with scheduling. To use method security with background jobs we want to use the DelegatingSecurityContextScheduledExecutorService like described here: http://www.petrikainulainen.net/programming/spring-framework/spring-from-the-trenches-invoking-a-secured-method-from-a-scheduled-job/ (see \"Spring Security 3.2: It Is Almost Like Magic!\").\nI suspect this stopped working with SEC-3031, because now DelegatingSecurityContextRunnable/Callable doesn&apos;t set/clear the security context if run on the same thread as they were created.\nAs Concurrent/TheadPoolTaskScheduler uses a ReschedulingRunnable for the trigger mechanic (we use cron triggers), so the rescheduling is done on the pool thread. So random subsequent calls executed on the same pool thread might fail, because the SecurityContext is not set.\nGetting DelegatingSecurityContextExecutor to set the enableOnOriginalThread property on DelegatingSecurityContextRunnable to true would fix that issue.", "project": "Spring", "sub_project": "SEC", "version": "3.2.8.RELEASE", "fixed_version": "3.2.9.RELEASE", "fixed_files": ["org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilterTests.java", "org.springframework.security.concurrent.DelegatingSecurityContextCallableTests.java", "org.springframework.security.concurrent.DelegatingSecurityContextRunnable.java", "org.springframework.security.concurrent.DelegatingSecurityContextRunnableTests.java", "org.springframework.security.concurrent.DelegatingSecurityContextCallable.java"], "label": 1, "es_results": []}, {"bug_id": 3082, "bug_title": "SavedRequest parameters are treated as case-insensitive", "bug_description": "The DefaultSavedRequest stores parameters in a case-insensitive TreeMap, but with a normal HttpServletRequest parameter names are case-sensitive.\nBasically, this TreeMap should not use a case-insensitive comparator: https://github.com/spring-projects/spring-security/blob/c79bceab03555df0825b5d0c96fc9bc38eb88b9a/web/src/main/java/org/springframework/security/web/savedrequest/DefaultSavedRequest.java#L65\nSomeone already noticed this mistake in the past, see the comment at the test class: https://github.com/spring-projects/spring-security/blob/c79bceab03555df0825b5d0c96fc9bc38eb88b9a/web/src/test/java/org/springframework/security/web/savedrequest/DefaultSavedRequestTests.java#L35\nHeader names should be case-insensitive, so that&apos;s fine.", "project": "Spring", "sub_project": "SEC", "version": "3.2.8.RELEASE", "fixed_version": "3.2.9.RELEASE", "fixed_files": ["org.springframework.security.web.savedrequest.DefaultSavedRequest.java", "org.springframework.security.web.savedrequest.DefaultSavedRequestTests.java"], "label": 1, "es_results": []}, {"bug_id": 2651, "bug_title": "Update Thymeleaf to use Spring 4 variants in samples", "bug_description": "The update to Spring 4 caused failures in Thymeleaf&apos;s automatic inclusion of Spring Security&apos;s CSRF. We should update the Thymeleaf dependencies to match the Spring version. ", "project": "Spring", "sub_project": "SEC", "version": "4.0.0.M1", "fixed_version": "4.0.0.M2", "fixed_files": ["org.springframework.security.samples.mvc.config.CustomMvcConfig.java", "org.springframework.security.samples.mvc.config.WebMvcConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 2719, "bug_title": "authenticated().withRoles(...) is order-sensitive", "bug_description": "The following test always fails for me.\n\n\n\n\n\n\n\t\n\n\n\n\n@Test\n\n\n\n\n\tpublic void usuarioLogadoAcessaPagina() throws Exception {\n\n\n\n\n\t\tmvc.perform(get(\"/\").with(user(\"fulano\").roles(\"USER\", \"SELLER\")))\n\n\n\n\n\t\t\t.andExpect(authenticated().withRoles(\"SELLER\", \"USER\"))\n\n\n\n\n\t\t\t.andExpect(authenticated().withRoles(\"USER\", \"SELLER\"));\t\t\t\n\n\n\n\n\t}\n\n\n\n\n\n ", "project": "Spring", "sub_project": "SEC", "version": "4.0.0.M2", "fixed_version": "4.0.0.RC1", "fixed_files": ["org.springframework.security.test.web.servlet.response.SecurityMockMvcResultMatchers.java"], "label": 1, "es_results": []}, {"bug_id": 2819, "bug_title": " SimpDestinationMessageMatcher(String pattern, SimpMessageType type) never passes type param to this() constructor", "bug_description": "\n\n\n\n\n\nSimpDestinationMessageMatcher.java\n\n\n\n\n\n\npublic SimpDestinationMessageMatcher(String pattern, SimpMessageType type) {\n\n\n\n\n        this(pattern, null, new AntPathMatcher());\n\n\n\n\n}\n\n\n\n\n\n\nAlways passes null as SimpMessageType parameter instead of type param therefore ignoring it completely.", "project": "Spring", "sub_project": "SEC", "version": "4.0.0.RC1", "fixed_version": "4.0.0.RC2", "fixed_files": ["org.springframework.security.messaging.util.matcher.SimpDestinationMessageMatcherTests.java", "org.springframework.security.messaging.util.matcher.SimpMessageTypeMatcher.java", "org.springframework.security.messaging.util.matcher.SimpDestinationMessageMatcher.java"], "label": 1, "es_results": []}, {"bug_id": 2845, "bug_title": "Exception when using AbstractSecurityWebSocketMessageBrokerConfigurer with anonymous authentication", "bug_description": "When using an AbstractSecurityWebSocketMessageBrokerConfigurer and trying to use messaging with an anonymous authentication (i.e. not logged in), i see the following exception:\n\n\n\n\n\n\norg.springframework.messaging.MessageDeliveryException: Failed to send message to ExecutorSubscribableChannel[clientInboundChannel];\n\n\n\n\nnested exception is org.springframework.security.authentication.AuthenticationCredentialsNotFoundException: An Authentication object was not found in the SecurityContext\n\n\n\n\n\n\nthrown here: https://github.com/spring-projects/spring-security/blob/master/core/src/main/java/org/springframework/security/access/intercept/AbstractSecurityInterceptor.java#L200\na wild guess would be that an anonymous authentication is not put into the message headers, so the SecurityContextChannelInterceptor does not populate the SecurityContext and then again AbstractSecurityInterceptor just gets null instead of an anonymous Authentication.\nbut i am sure you got a better idea what is going on there (or if i am just missing sth.) \nthanks, zyro", "project": "Spring", "sub_project": "SEC", "version": "4.0.0.RC1", "fixed_version": "4.0.0.RC2", "fixed_files": ["org.springframework.security.messaging.context.SecurityContextChannelInterceptor.java", "org.springframework.security.messaging.context.SecurityContextChannelInterceptorTests.java"], "label": 1, "es_results": []}, {"bug_id": 2882, "bug_title": "DefaultLoginPageGeneratingFilter grabs /**/login", "bug_description": "I have the following Groovy security configuration in a Spring Boot web app:\n\n\n\n\n\n\n@Configuration\n\n\n\n\n@EnableWebSecurity\n\n\n\n\nclass SecurityConfig extends WebSecurityConfigurerAdapter {\n\n\n\n\n\n\n\n\n\n    @Override\n\n\n\n\n    protected void configure(HttpSecurity http) throws Exception {\n\n\n\n\n        http.\n\n\n\n\n            authorizeRequests().\n\n\n\n\n                antMatchers(\"/scratch/secured\").hasRole(\"USER\").\n\n\n\n\n                antMatchers(\"/**\").permitAll().\n\n\n\n\n                anyRequest().authenticated().\n\n\n\n\n            and().\n\n\n\n\n            formLogin();\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nThis does get me the built-in login form at /login, but it also hijacks /foo/something/login. DefaultLoginPageGeneratingFilter#matches appears to treat the url as a suffix instead of as an absolute path. Even though the context path should be /foo/something/login, the conditional at 262 evaluates to true, and the endsWith comparison is used. I can&apos;t get Eclipse to dump the contents of request.getContextPath() right there during debugging.", "project": "Spring", "sub_project": "SEC", "version": "4.0.0.RC1", "fixed_version": "4.0.0.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.DefaultLoginPageGeneratingFilterTests.java", "org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter.java"], "label": 1, "es_results": []}, {"bug_id": 2919, "bug_title": "DefaultLoginGeneratingFilter incorrectly used if login-url=\"/login\"", "bug_description": "If an application specifies form-login@login-url=\"/login\" then the DefaultLoginGeneratingFilter is incorrectly used. This means that the custom login page cannot be specified with the URL \"/login\". For example:\n\n\n\n\n\n\n<http ...>\n\n\n\n\n\t<form-login login-page=\"/login\" ... />\n\n\n\n\n</http>\n\n\n\n\n\n\nWorkaround\nUsing a different URL\nOne workaround is to use a different URL for the login page. For example, one could use \"/authenticate\".\nUsing a BeanDefinitionRegistryPostProcessor\nAlternatively, the following BeanDefinitionRegistryPostProcessor will fix the issue by removing the DefaultLoginPageGeneratingFilter. To use it simply ensure to register the BeanDefinitionRegistryPostProcessor as a Bean.\n\n\n\n\n\n\nimport java.util.Iterator;\n\n\n\n\nimport java.util.List;\n\n\n\n\n\n\n\n\n\nimport org.springframework.beans.BeansException;\n\n\n\n\nimport org.springframework.beans.factory.config.BeanDefinition;\n\n\n\n\nimport org.springframework.beans.factory.config.ConfigurableListableBeanFactory;\n\n\n\n\nimport org.springframework.beans.factory.support.BeanDefinitionRegistry;\n\n\n\n\nimport org.springframework.beans.factory.support.BeanDefinitionRegistryPostProcessor;\n\n\n\n\nimport org.springframework.security.web.DefaultSecurityFilterChain;\n\n\n\n\nimport org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter;\n\n\n\n\n\n\n\n\n\npublic class Sec2919PostProcessor implements BeanDefinitionRegistryPostProcessor {\n\n\n\n\n\t@Override\n\n\n\n\n\tpublic void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry)\n\n\n\n\n\t\t\tthrows BeansException {\n\n\n\n\n\t\tString[] beanDefinitionNames = registry.getBeanDefinitionNames();\n\n\n\n\n\t\tfor(String name : beanDefinitionNames) {\n\n\n\n\n\t\t\tBeanDefinition beanDefinition = registry.getBeanDefinition(name);\n\n\n\n\n\t\t\tif(beanDefinition.getBeanClassName().equals(DefaultSecurityFilterChain.class.getName())) {\n\n\n\n\n\t\t\t\tList<Object> filters = (List<Object>) beanDefinition.getConstructorArgumentValues().getArgumentValue(1, List.class).getValue();\n\n\n\n\n\t\t\t\tIterator<Object> iFilters = filters.iterator();\n\n\n\n\n\t\t\t\twhile(iFilters.hasNext()) {\n\n\n\n\n\t\t\t\t\tObject f = iFilters.next();\n\n\n\n\n\t\t\t\t\tif(f instanceof BeanDefinition) {\n\n\n\n\n\t\t\t\t\t\tBeanDefinition bean = (BeanDefinition) f;\n\n\n\n\n\t\t\t\t\t\tif(bean.getBeanClassName().equals(DefaultLoginPageGeneratingFilter.class.getName())) {\n\n\n\n\n\t\t\t\t\t\t\tiFilters.remove();\n\n\n\n\n\t\t\t\t\t\t}\n\n\n\n\n\t\t\t\t\t}\n\n\n\n\n\t\t\t\t}\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t}\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n\t@Override\n\n\n\n\n\tpublic void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory)\n\n\n\n\n\t\t\tthrows BeansException {\n\n\n\n\n\t}\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "4.0.0.RELEASE", "fixed_version": "4.0.1.RELEASE", "fixed_files": ["org.springframework.security.config.http.AuthenticationConfigBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 2930, "bug_title": "Review hasRole/hasAuthority documentation in SecurityExpressionOperations", "bug_description": "1. After the changes from SEC-2758 the hasRole/hasAuthority methods are not 100% synonyms.\n2. hasAuthority(String) is described as a synonym for itself", "project": "Spring", "sub_project": "SEC", "version": "4.0.0.RC2", "fixed_version": "4.0.1.RELEASE", "fixed_files": ["org.springframework.security.access.expression.SecurityExpressionOperations.java"], "label": 1, "es_results": []}, {"bug_id": 3034, "bug_title": "AclPermissionEvaluator.resolvePermission fails with Turkish Locale", "bug_description": "When a permission name like \"write\" is passed into AclPermissionEvaluator.resolvePermission method, it first tries to resolve it as is. If not, it then calls permString.toUpperCase() and tries so. However, lowercase \"write\" is changed into \"WRTE\" (I with dotted above) when system&apos;s default Locale is tr_TR. Hence, it is not resolved among BasePermissions.\nObvious solution is calling permString.toUpperCase() with Locale.US input parameter.", "project": "Spring", "sub_project": "SEC", "version": "4.0.0.RELEASE", "fixed_version": "3.2.7.RELEASE", "fixed_files": ["org.springframework.security.acls.AclPermissionEvaluator.java", "org.springframework.security.acls.AclPermissionEvaluatorTests.java"], "label": 1, "es_results": []}, {"bug_id": 2948, "bug_title": "Incorrect message when upgrading to 4.0.x with the wrong xml schema declarations", "bug_description": "During migration from 3.2.x to 4.0.1 I came across the following error message when using the 4.0.1 library with an XML config file with 3.2 schema declarations...\n\n\n\n\n\n\nSEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener\n\n\n\n\norg.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: You cannot use a spring-security-2.0.xsd or spring-security-3.0.xsd or spring-security-3.1.xsd schema with Spring Security 3.2. Please update your schema declarations to the 3.2 schema.\n\n\n\n\nOffending resource: class path resource [foo/bar/spring/spring-security.xml]\n\n\n\n\n\n\nThe error message needs to be updated to...\nYou cannot use a spring-security-2.0.xsd or spring-security-3.0.xsd or spring-security-3.1.xsd or spring-security-3.2.xsd schema with Spring Security 4.0. Please update your schema declarations to the 4.0 schema.\nXML Declarations that because the error...\n\n\n\n\n\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n\n\n\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n\n\n\n\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\n\n\n\n    xmlns:aop=\"http://www.springframework.org/schema/aop\"\n\n\n\n\n    xmlns:context=\"http://www.springframework.org/schema/context\"\n\n\n\n\n    xmlns:security=\"http://www.springframework.org/schema/security\"\n\n\n\n\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd\n\n\n\n\n    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd\n\n\n\n\n    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd\n\n\n\n\n    http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.2.xsd\"\n\n\n\n\n    >\n\n\n\n\n\n", "project": "Spring", "sub_project": "SEC", "version": "4.0.1.RELEASE", "fixed_version": "4.0.2.RELEASE", "fixed_files": ["org.springframework.security.config.SecurityNamespaceHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2931, "bug_title": "CsrfFilter JavaDoc incomplete and session less token repository appreciated ", "bug_description": "The Java Doc for CsrfFilter says:\nTypically the CsrfTokenRepository implementation chooses to store the CsrfToken in HttpSession with HttpSessionCsrfTokenRepository. This is preferred to storing the token in a cookie which. \"\nThat last part does not look like a sentence .\nIt would also be great to have a CsrfTokenRepository implementation not based on a servlet container session to allow for stateless web apps. ", "project": "Spring", "sub_project": "SEC", "version": "4.0.1.RELEASE", "fixed_version": "3.2.8.RELEASE", "fixed_files": ["org.springframework.security.web.csrf.CsrfFilter.java"], "label": 1, "es_results": []}, {"bug_id": 3019, "bug_title": "BasicAuthenticationFilter ignores remember-me authentication", "bug_description": "Repro:\n\nConfigure an application to use httpBasic auth and rememberMe authentication.\nNotice that no remember-me cookie is set by the server, even on a successful authentication\n\nProblem: the RememberMeServices and other related configuration set up by the rememberMe() configurer is never propagated to the BasicAuthenticationFilter&apos;s setRememberMeServices method. BasicAuthenticationFilter retains it&apos;s default NullRememberMeServices instance assigned at construction time, which means that all remember-me operations are a no-op.\nWorkaround:\n\nHere is a gist of the changes that were necessary to propagate the remember me configuration through to the BasicAuthenticationFilter using a Spring Security ObjectPostProcessor: https://gist.github.com/cbeams/f3c36caae7046b03609a. (Note that it was also attempted to use a BeanPostProcessor, but this caused lifecycle issues due to dependence on other Spring beans.)\n\nWith this configuration in place, everything works as expected for remember-me authentication.\nDocumentation:\n\nIf and when this issue is fixed, i.e. BasicAuthenticationFilter begins to respect rememberMe settings, the first sentence of this section of the Spring Security documentation should be removed: http://docs.spring.io/spring-security/site/docs/4.0.1.RELEASE/reference/htmlsingle/#remember-me-impls\n\n", "project": "Spring", "sub_project": "SEC", "version": "4.0.1.RELEASE", "fixed_version": "3.2.8.RELEASE", "fixed_files": ["org.springframework.security.config.annotation.web.configurers.HttpBasicConfigurer.java"], "label": 1, "es_results": []}, {"bug_id": 3020, "bug_title": "HttpServletRequest.isUserInRole(\"ROLE_<anything>\") returns false with defaults", "bug_description": "I&apos;m just trying to upgrade from Spring Security 3.1 to 4.0.1 and have discovered a breaking change in the behaviour of request.isUserInRole().\nIn Spring 3.1 the following was returning true and now returns false:\nrequest.isUserInRole(\"ROLE_REMEMBER_ME\")\nIn Spring 4.0.1 I had to change it to the following:\nrequest.isUserInRole(\"REMEMBER_ME\")", "project": "Spring", "sub_project": "SEC", "version": "4.0.1.RELEASE", "fixed_version": "4.0.2.RELEASE", "fixed_files": ["org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestWrapperTests.java", "org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestWrapper.java"], "label": 1, "es_results": []}, {"bug_id": 2964, "bug_title": "CsrfTokenArgumentResolver has improperly formatted javadoc", "bug_description": "CsrfTokenArgumentResolver has broken javadoc, see http://docs.spring.io/spring-security/site/docs/4.0.1.RELEASE/apidocs/org/springframework/security/web/method/annotation/CsrfTokenArgumentResolver.html\nThe source code snippet of RestController is missing.", "project": "Spring", "sub_project": "SEC", "version": "4.0.1.RELEASE", "fixed_version": "4.0.2.RELEASE", "fixed_files": ["org.springframework.security.web.method.annotation.CsrfTokenArgumentResolver.java"], "label": 1, "es_results": []}, {"bug_id": 3108, "bug_title": "DigestAuthenticationFilter should use SecurityContextHolder.createEmptyContext()", "bug_description": "When using Digest authentication and there are concurrent requests from the same session, it is possible that the Authentication object returned by SessionContextHolder.getContext().getAuthentication() does not have its authorities set. Then, e.g. HttpServletRequest.isUserInRole() returns sometimes incorrectly false even if the user actually has that role.\nThis happens because with Digest authentication, constructing the Authentication object is done in two steps, but the incomplete Authentication object is made visible to another threads after first step.\nConsider the following scenario:\n\nUser logs in to the system, a session is created, JSESSIONID is set, and user uses the system for some time.\nUser makes request 1 to the server. This request has a header \"Authorization: Digest ...\"\nDigestAuthenticationFilter starts the authentication process and places an incomplete Authentication object (without authorities) into SecurityContext.\nSimultaneously with request 1, the same user makes request 2 to the server. This request does not have \"Authorization: Digest ...\" header, so no re-authentication is done. While processing request 2, request.isUserInRole() returns now false, because the Authentication object in SecurityContext does not have any authorities. User gets incorrectly a 403 Forbidden response.\nRequest 1 continues the authentication process, and in AbstractSecurityInterceptor, a fully populated Authentication object is created and put into SecurityContext.\n\nI could set createAuthenticatedToken = true in DigestAuthenticationFilter, but the comment on the set method says that user flags like isEnabled() or isAccountNonExpired() are not checked in that case, so this is not a solution.", "project": "Spring", "sub_project": "SEC", "version": "4.0.2.RELEASE", "fixed_version": "3.2.9.RELEASE", "fixed_files": ["org.springframework.security.web.authentication.www.DigestAuthenticationFilter.java", "org.springframework.security.web.authentication.www.DigestAuthenticationFilterTests.java"], "label": 1, "es_results": []}, {"bug_id": 3147, "bug_title": "Include the error parameter into authentication-failure-url when login-page is customized", "bug_description": "If XML Config used, parameter that indicate error does not include into authentication-failure-url.\n[XML Config]\n\nlogin-page : /loginForm\nauthentication-failure-url : /loginForm\n\n[Java Config]\n\nlogin-page : /loginForm\nauthentication-failure-url : /loginForm?error\n\nI think should be include error parameter (?error) into authentication-failure-url.", "project": "Spring", "sub_project": "SEC", "version": "4.0.3.RELEASE", "fixed_version": "3.2.10.RELEASE", "fixed_files": ["org.springframework.security.config.http.FormLoginBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 3158, "bug_title": "findRequiredWebApplicationContext requires Spring 4.2.x", "bug_description": "Inside AbstractAuthorizeTag the static method SecurityWebApplicationContextUtils.findRequiredWebApplicationContext(...) is called, which in turn calls\nWebApplicationContextUtils.findWebApplicationContext(...)\nwhich does not exist in spring-framework 4.1.x (it can be found in the master branch only).", "project": "Spring", "sub_project": "SEC", "version": "4.0.3.RELEASE", "fixed_version": "4.0.4.RELEASE", "fixed_files": ["org.springframework.security.web.context.support.SecurityWebApplicationContextUtils.java"], "label": 1, "es_results": []}, {"bug_id": 167, "bug_title": "Token Service default in <authorization-server/> incorrect", "bug_description": "If a token-services-ref is not provided in the authorization-server definition, the value appears to be defaulted to an instance of a token store instead being defaulted with an instance of a token service. This results in the bean definition failing to initialize.\nWorkaround is to initialize the auth-server with a token services bean.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.M5", "fixed_version": "1.0.0.M6", "fixed_files": ["org.springframework.security.oauth2.config.ProviderBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 194, "bug_title": "Invalid Redirect URI is detected but still redirected anyway", "bug_description": "If you have a client with a registered redirect URI and you specify an invalid redirect when requesting an authorization code, the invalid redirect URI will be detected but the client is redirected to the invalid URI anyway, with an error appended.\nHere&apos;s an example using sparklr: \nmy-client-with-registered-redirect has a registered redirect URI of http://anywhere\n1. Go to http://localhost:8080/sparklr/oauth/authorize?response_type=code&client_id=my-client-with-registered-redirect&scope=trust&redirect_uri=http://www.google.com\n2. Sign in and authorize\n3. Client is redirected to http://www.google.com/?error=redirect_uri_mismatch&error_description=Invalid%20redirect\nThe spec says,\nIf the request fails due to a missing, invalid, or mismatching redirection URI, or if the client identifier is missing or invalid, the authorization server SHOULD inform the resource owner of the error, and MUST NOT automatically redirect the user-agent to the invalid redirection URI.\n", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.M5", "fixed_version": "1.0.0.M6", "fixed_files": ["org.springframework.security.oauth2.provider.TestAuthorizationCodeProvider.java"], "label": 1, "es_results": []}, {"bug_id": 224, "bug_title": "Implicit Access Grant response should preserve state if passed in authorization request", "bug_description": "org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.appendAccessToken() should preserve state if passed\neg.\n\tString state = authorizationRequest.getState();\n\tif (state != null) \n{\n\t\turl.append(\"&state=\").append(state);\n\t}", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.M6", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.java", "org.springframework.security.oauth2.provider.endpoint.TestAuthorizationEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 216, "bug_title": "Refresh token is removed before refreshing access token", "bug_description": "If an exception (AccessTokenRequiredException) is caught in the OAuth2ClientContextFilter:90 because the access token has expired, line 93 goes on doing the following:\n    oauth2Context.removeAccessToken(resourceThatNeedsAuthorization);\nfurther down at line 112 we are trying to fetch the same accesstoken from the oauth context using the same key, of course it returns null and thus we don&apos;t get any existingToken.\nAs I understand it, it is the existingToken that shall hold the refreshToken to use for refreshing the access token in AccessTokenProviderChain:73\nThe existingToken will be null when we want to refresh the access token so we never reach \n    accessToken = refreshAccessToken(resource, refreshToken, request);\nat AccessTokenProviderChain:78\nSee the code here:\nhttps://github.com/SpringSource/spring-security-oauth/blob/master/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/filter/OAuth2ClientContextFilter.java\nhttps://github.com/SpringSource/spring-security-oauth/blob/master/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/token/AccessTokenProviderChain.java", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.M6", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.security.oauth2.client.token.grant.password.ResourceOwnerPasswordAccessTokenProvider.java"], "label": 1, "es_results": []}, {"bug_id": 234, "bug_title": "oauth1 provider ignores authentication-failed-url attribute", "bug_description": "When configuring a <oauth:provider authentication-failed-url=\"\" />, the authorization filter will not use the given URL, but the default (e.g.: send a 401 response).\nThis is caused by the configuration parser not injecting the failurehandler properly into the filter. See referenced forum thread.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.M6", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.security.oauth.config.OAuthProviderBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 236, "bug_title": "Wrong error being reported by DefaultWebResponseExceptionTranslator", "bug_description": "\nBug in DefailWebResponseExceptionTranslator:\nMore precisely, it should not do this: (around line 55)\nCode:\n\t\tif (ase instanceof AuthenticationException) \n{\n\t\t\treturn handleOAuth2Exception(new InvalidTokenException(e.getMessage(), e));\n\t\t}\n\n\nWrongly create an InvalidTokenException when the original exception thrown by ClienDetailsServiceImpl is a InvalidClientException.\nThis will result in incorrect error code in the HTTP Response.\n", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RELEASE", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.security.oauth2.config.ResourceServerBeanDefinitionParser.java", "org.springframework.security.oauth2.provider.error.DefaultWebResponseExceptionTranslator.java", "org.springframework.security.oauth2.provider.TestResourceOwnerPasswordProvider.java", "org.springframework.security.oauth2.provider.TestAuthorizationCodeProvider.java", "org.springframework.security.oauth2.provider.error.OAuth2AuthenticationEntryPoint.java", "org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter.java", "org.springframework.security.oauth2.provider.error.TestOAuth2AuthenticationEntryPoint.java"], "label": 1, "es_results": []}, {"bug_id": 266, "bug_title": "Fragment not URL encoded in some parts of error response from implicit grant", "bug_description": "Fragment not URL encoded in some parts of error response from implicit grant.  In particular it looks like the scope values are space separated.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.M6", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 284, "bug_title": "Redirect URI not preserved across auth code flow if using pre-registered value", "bug_description": "Redirect URI not preserved across auth code flow if using pre-registered value.  The AuthorizationCodeAccessTokenProvider has to be very careful to send the same redirect URI in both legs of the flow.  It is using preserved state, which is fine, but it need sto be set to the value that is required in the token endpoint.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.M6", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.security.oauth2.client.token.grant.code.TestAuthorizationCodeAccessTokenProvider.java", "org.springframework.security.oauth2.client.token.grant.code.AuthorizationCodeAccessTokenProvider.java", "org.springframework.security.oauth2.client.token.OAuth2AccessTokenSupport.java"], "label": 1, "es_results": []}, {"bug_id": 295, "bug_title": "Oauth2 AuthorizationEndpoint ignores user approval flag for implicit grant", "bug_description": "The current implementation of the AuthorizationEndpoint contains a method \"approveOrDeny\" that is used to redirect a client based on the UsersApproval.  It currently does not test the result of such approval leading to all possible requests being issued a token/code regardless of the users approval decision, as per code below:\n\n\n\n\n\n\n\t\t\tauthorizationRequest = authorizationRequest.addApprovalParameters(approvalParameters);\n\n\n\n\n\t\t\tauthorizationRequest = resolveRedirectUriAndCheckApproval(authorizationRequest, (Authentication) principal);\n\n\n\n\n\t\t\tif (responseTypes.contains(\"token\")) {\n\n\n\n\n\t\t\t\treturn getImplicitGrantResponse(authorizationRequest).getView();\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t\treturn getAuthorizationCodeResponse(authorizationRequest, (Authentication) principal);\n\n\n\n\n\n\nIt is suggested that the above snippet is replaced with (tested locally and conforms to latest draft spec):\n\n\n\n\n\n\n\t\t\tauthorizationRequest = authorizationRequest.addApprovalParameters(approvalParameters);\n\n\n\n\n\t\t\tauthorizationRequest = resolveRedirectUriAndCheckApproval(authorizationRequest, (Authentication) principal);\n\n\n\n\n\t\t\tif (authorizationRequest.isApproved()) {\n\n\n\n\n\t\t\t\tif (responseTypes.contains(\"token\")) {\n\n\n\n\n\t\t\t\t\treturn getImplicitGrantResponse(authorizationRequest).getView();\n\n\n\n\n\t\t\t\t}\n\n\n\n\n\t\t\t\treturn getAuthorizationCodeResponse(authorizationRequest, (Authentication) principal);\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t\treturn new RedirectView(getUnsuccessfulRedirect(authorizationRequest, OAuth2Exception.create(OAuth2Exception.ACCESS_DENIED, \"User denied access\"),\n\n\n\n\n\t\t\t\t\ttrue), false);\n\n\n\n\n\n\nThanks - G.\n", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.M6", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.java", "org.springframework.security.oauth2.provider.endpoint.TestAuthorizationEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 313, "bug_title": "AccessToken did not get enhanced after refreshed", "bug_description": "RefreshTokenGranter will create new AccessToken via DefaultTokenService.refreshAccessToken(). After create AccessToken by DefaultTokenService.createAccessToken(OAuth2Authentication authentication, OAuth2RefreshToken refreshToken) i found out that the accessToken didn&apos;t get Enhanced. and i can&apos;t get token enhanced before access token expired because of token reused.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.security.oauth2.provider.token.DefaultTokenServices.java", "org.springframework.security.oauth2.provider.token.AbstractTestDefaultTokenServices.java"], "label": 1, "es_results": []}, {"bug_id": 315, "bug_title": "Auth code grant does not copy all properties from pending request to final authentication", "bug_description": "", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RELEASE", "fixed_version": "1.0.0.RC1", "fixed_files": ["org.springframework.security.oauth2.provider.code.AuthorizationCodeTokenGranter.java", "org.springframework.security.oauth2.provider.code.TestAuthorizationCodeTokenGranter.java"], "label": 1, "es_results": []}, {"bug_id": 316, "bug_title": "Auth code grant overwrites requested scopes in token endpoint", "bug_description": "The token endpoint does not accept a scope= parameter in general from the client during an auth code grant, but it still uses it if there, and (worse) the default auth request factory overwrites the existing value if the input has no explicit scope.  This means that the client actually must supply scope parameter to the token endpoint where actually it should be ignored (I suspect).", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.security.oauth2.provider.endpoint.TokenEndpoint.java", "org.springframework.security.oauth2.provider.endpoint.TestTokenEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 311, "bug_title": "Class AbstractJaxbMessageConverter is not thread safe", "bug_description": "JAXB marshallers and unmarshallers are not thread safe (http://jaxb.java.net/guide/Performance_and_thread_safety.html) and should be created separately in each thread. The class AbstractJaxbMessageConverter incorrectly caches the marshaller and unmarshaller which may cause ArrayIndexOutofBoundsExceptions amongst others.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.security.oauth2.http.converter.jaxb.AbstractJaxbMessageConverter.java", "org.springframework.security.oauth2.http.converter.jaxb.TestJaxbOAuth2AccessTokenMessageConverter.java", "org.springframework.security.oauth2.http.converter.jaxb.TestJaxbOAuth2ExceptionMessageConverter.java", "org.springframework.security.oauth2.http.converter.jaxb.BaseJaxbMessageConverterTest.java"], "label": 1, "es_results": []}, {"bug_id": 320, "bug_title": "Wrong http code (500 instead of 403) returned on InsufficientScopeException when using SpEL expressions for security contstraints", "bug_description": "\nI have the following configuration:\n\n\n\n\n\n\n<http pattern=\"/service/**\" entry-point-ref=\"oauthAuthenticationEntryPoint\" use-expressions=\"true\" xmlns=\"http://www.springframework.org/schema/security\">\t\t\n\n\n\n\n    <intercept-url pattern=\"/service/**\" \n\n\n\n\n        method=\"GET\" \n\n\n\n\n        access=\"#oauth2.clientHasRole(&apos;ROLE_CLIENT&apos;) and hasRole(&apos;ROLE_USER&apos;) and #oauth2.hasScope(&apos;SCOPE&apos;)\"  />\n\n\n\n\n    <custom-filter ref=\"resourceServerFilter\" after=\"PRE_AUTH_FILTER\" />\n\n\n\n\n    <access-denied-handler ref=\"oauthAccessDeniedHandler\"/>\n\n\n\n\n    <expression-handler ref=\"oauthWebExpressionHandler\" />\n\n\n\n\n</http>\n\n\n\n\n\n\nWhen I try to do a request with the wrong scope a InsufficientScopeException is thrown. But it is exception is just handled by Tomcat from what I can see, not before. This results in a \"500 Internal Server Error\", not a \"403 Forbidden\" which I expected. ", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.security.oauth2.provider.expression.OAuth2SecurityExpressionMethods.java", "org.springframework.security.oauth2.provider.expression.TestOAuth2SecurityExpressionMethods.java"], "label": 1, "es_results": []}, {"bug_id": 308, "bug_title": "Validation of authorization request is bypassed if auto-approved", "bug_description": "", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RC2", "fixed_files": ["org.springframework.security.oauth2.provider.endpoint.TestAuthorizationEndpoint.java", "org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.java", "org.springframework.security.oauth2.provider.endpoint.DefaultScopeValidator.java"], "label": 1, "es_results": []}, {"bug_id": 314, "bug_title": "Authorization Code error response slightly off spec", "bug_description": "When attempting to access $\n{APP_ROOT}\n/$\n{AUTH_ENDPOINT_URL}\n without providing any parameters, e.g., http://localhost:8080/sparklr2/oauth/authorize, one receives a 405 error response stating \"Request method &apos;GET&apos; not supported\" with an Allow header of POST only.\nHowever, the spec seems to indicate otherwise: http://tools.ietf.org/html/draft-ietf-oauth-v2-31#section-4.1.2.1\n\"If the resource owner denies the access request or if the request fails for reasons other than a missing or invalid redirection URI, the authorization server informs the client by adding the following parameters to the query component of the redirection URI using the \"application/x-www-form-urlencoded\" format, per Appendix B:\n   error\n         REQUIRED.  A single ASCII [USASCII] error code from the\n         following:\n         invalid_request\n               The request is missing a required parameter, includes an\n               invalid parameter value, includes a parameter more than\n               once, or is otherwise malformed.\n\"\nCompare the response of:\nhttp://localhost:8080/sparklr2/oauth/authorize\nto:\nhttp://localhost:8080/sparklr2/oauth/authorize?response_type=foo\nhttp://localhost:8080/sparklr2/oauth/authorize?response_type=code\nhttp://localhost:8080/sparklr2/oauth/authorize?response_type=code&client_id=foo\nhttp://localhost:8080/sparklr2/oauth/authorize?response_type=code&client_id=tonr\nfor further illustration.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC1", "fixed_version": "1.0.0.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.TestJdbcClientDetailsService.java", "org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 329, "bug_title": "Implicit Flow serializer drops String values from OAuth2AccessToken ", "bug_description": "Inside the AuthorizationEndpoint&apos;s appendAccessToken function, which is called during the implicit flow, there was a check to see whether the value of the map was either a primitive or a wrapped primitive, using Spring&apos;s ClassUtils. This check ruled out the String class being used in additionalInformation. Removal of the check allows Strings, and indeed all other objects with an appropriate .toString() call, to be serialized as expected. \nI should point out that without this change, we can&apos;t issue id_tokens from the implicit flow since they come through as Strings.\nPull request removes this check and adds documentation to the token interface&apos;s \"getAdditionalInformation\" method.\nThis almost mirrors what happens in the Jackson serializer, which uses a JSON object writer instead of a simple toString. Therefore, a possible longer-term solution would be to use a pluggable serialization system for data to be tacked to the return URI. But barring that, this solution works for the basic case.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.M6", "fixed_version": "1.0.0.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.java", "org.springframework.security.oauth2.common.OAuth2AccessToken.java"], "label": 1, "es_results": []}, {"bug_id": 333, "bug_title": "redirect_uri should not be mandatory field when obtaining an OAuth2 access token", "bug_description": "When an oauth client redirects to the authorization endpoint (oauth2/authorize?response_type=code&client_id=client&scope=read) and does not specify the redirect_uri then the redirect_uri is taken from the pre-configured value in the clientDetails. This is ok as the redirect_uri is not required in this call. However the fetched redirect_uri is then stored on the authorizationRequest (AuthorizationEndpoint#resolveRedirectUriAndCheckApproval). If the client subsequently tries to obtain an access-token by presenting his authorizationCode and again does not specify a redirect_uri (which is only required if he did so during the authorize request) then a RedirectMismatchException is thrown as it (wrongfully) seems as the authorize request was done with the redirect_uri parameter. There is no way of telling if the redirect_uri in the authorizationRequest that was stored (either in memory or jdbc) was the &apos;enhanced&apos; one from the clientDetails or the parameter redirect_uri in the original oauth2/authorize request. So the current implementation implicitly requires a redirect_uri parameter in the token request. This is not conform spec (http://tools.ietf.org/html/draft-ietf-oauth-v2-31#section-4.1.3). I don&apos;t mind making a pull request, but before I do, I would like confirmation if this is indeed a bug or intentional design. ", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.code.AuthorizationCodeTokenGranter.java", "org.springframework.security.oauth2.provider.DefaultAuthorizationRequest.java", "org.springframework.security.oauth2.provider.code.TestAuthorizationCodeTokenGranter.java", "org.springframework.security.oauth2.provider.endpoint.TestAuthorizationEndpoint.java", "org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.java", "org.springframework.security.oauth2.provider.endpoint.RedirectResolver.java"], "label": 1, "es_results": []}, {"bug_id": 337, "bug_title": "Refresh token is always issued irrespective of client configuration", "bug_description": "Refresh token is always issued irrespective of client configuration.  A refresh token should only be issued on an auth code grant  and only if the client is allowed it.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.token.TestDefaultTokenServicesWithInMemory.java", "org.springframework.security.oauth2.provider.token.DefaultTokenServices.java", "org.springframework.security.oauth2.provider.token.AbstractTestDefaultTokenServices.java"], "label": 1, "es_results": []}, {"bug_id": 339, "bug_title": "When supplying multiple wrong oauth2 parameters, a 500 is returned with stacktrace is returned", "bug_description": "When there are multiple problems with an authorization request, the ExceptionHandler in AuthorizationEndpoint itself fails with a RuntimeException that is not handled.\nThis results in a 500 Internal Server Error with a stacktrace.\nTo reproduce, start Sparklr2, and performs one of the following requests.\n1. (valid client_id, invalid response type, no redirect_uri)\nhttp://localhost:8080/sparklr2/oauth/authorize?client_id=tonr&response_type=asdf\n2. (invalid client_id, invalid response_type)\nhttp://localhost:8080/sparklr2/oauth/authorize?client_id=foobar&response_type=asdf\nIn the current implementation of AuthorizationEndpoint.handleException(), a try-catch block is already used:\n\n\n\n\n\n\n\t\ttry {\n\n\n\n\n\t\t\terrorRequest = getAuthorizationRequestForError(webRequest);\n\n\n\n\n\t\t}\n\n\n\n\n\t\tcatch (OAuth2Exception ex) {\n\n\n\n\n\t\t\t// If an AuthorizationRequest cannot be created from the incoming parameters it must be\n\n\n\n\n\t\t\t// an error. OAuth2Exception can be handled this way. Other exceptions will generate a standard 500\n\n\n\n\n\t\t\t// response.\n\n\n\n\n\t\t\treturn new ModelAndView(errorPage, Collections.singletonMap(\"error\", translate.getBody()));\n\n\n\n\n\t\t}\n\n\n\n\n\n\nPerhaps this block should be extended to include the rest of the method as well?", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 349, "bug_title": "JdbcTokeStore could be more robust against serialization errors", "bug_description": "JdbcTokeStore could be more robust against serialization errors, since it is really just a cache a serialization problem (e.g. caused by a change in the Authentication) should just be a cache miss.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC2", "fixed_version": "1.0.0.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.token.JdbcTokenStore.java"], "label": 1, "es_results": []}, {"bug_id": 353, "bug_title": "DefaultAccessTokenRequest is not Serializable", "bug_description": "As I explained in the issue https://jira.springsource.org/browse/SECOAUTH-345, the class DefaultOAuth2ClientContext must be serializable. Or it contains a field of type AccessTokenRequest implemented by DefaultAccessTokenRequest, which is not serializable (it doesn&apos;t implements the interface nor extends a class implementing it). Sorry I should have checked this before creating the previous issue.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.security.oauth2.client.DefaultOAuth2ClientContext.java", "org.springframework.security.oauth2.client.token.DefaultAccessTokenRequest.java"], "label": 1, "es_results": []}, {"bug_id": 357, "bug_title": "Access TokenEndpoint hard coded to not return Content-Type parameter in specification", "bug_description": "I am on Spring OAuth 1.0.0.RC3. The TokenEndpoint#getResponse method returns \"Content-Type: application/json\". Specification is for it to return \"Content-Type: application/json;charset=UTF-8\".", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC2", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.TestResourceOwnerPasswordProvider.java", "org.springframework.security.oauth2.provider.endpoint.TokenEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 354, "bug_title": "Sparklr sample should not use OAuth2AuthenticationEntryPoint for /oauth/token", "bug_description": "Sparklr sample should not use OAuth2AuthenticationEntryPoint for /oauth/token (clients should get WWW-Authenticate with Basic not Bearer).", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.TestResourceOwnerPasswordProvider.java"], "label": 1, "es_results": []}, {"bug_id": 359, "bug_title": "Missing grant type in TokenEnpoint results in default container (no HTML) error", "bug_description": "The response status is correct (400) but the rendering is done by the container because Spring can&apos;t find a handler method for a token request with no grant type.  The fix is easy.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.TestResourceOwnerPasswordProvider.java", "org.springframework.security.oauth2.provider.endpoint.TokenEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 365, "bug_title": "OAuth2ClientContextFilter does not store REAL current uri", "bug_description": "the current uri that is created and stored by the filter is not the exact uri used in the request.\n1.) if the code parameter is not the first parameter in the request it will result in a \"&&\" entry in the created uri\n2.) the ordering of parameters that is returned by request.getParameterNames() is not the same ordering as it is in the request uri. this results in a \"wrong\" ordering in the created current-uri.\nI&apos;m not sure if this is a jetty issue but this way the created current-uri can not be used to exchange auth codes with certain oauth2 providers (for example Facebook).", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.security.oauth2.client.filter.OAuth2ClientContextFilter.java", "org.springframework.security.oauth2.client.filter.TestOAuth2ClientContextFilter.java"], "label": 1, "es_results": []}, {"bug_id": 363, "bug_title": "OAuth2 responses due to an Exception do not contain the \"Pragma: no-cache\" header as per specification", "bug_description": "The \"Pragma: no-cache\" header and value is not returned when an exception is thrown within the context of a TokenEndpoint instance. I suggest the DefaultWebResponseExceptionTranslator#handleOAuth2Exception should be modified to set this value.\nI have worked around this by creating a bean that gets loaded after the \"oauth2TokenEndpoint\" bean, has a property that references the \"oauth2TokenEndpoint\" bean, and also has an \"afterPropertiesSet\" method implementation that sets the \"oauth2TokenEndpoint\" bean with a custom class that extends DefaultWebResponseExceptionTranslator. The custom class overrides the \"translate\" method to add this header and value into the super&apos;s returned result.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RELEASE", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.error.DefaultWebResponseExceptionTranslator.java"], "label": 1, "es_results": []}, {"bug_id": 318, "bug_title": "sparklr2 admin endpoints restricted to POST", "bug_description": "After doing the OAuth dance in tonr/sparklr with \"marissa\", a GET request to the admin endpoints passing the correct access token fails.\n>\nGET http://localhost:8080/sparklr2/oauth/users/marissa/tokens\nAuthorization: Bearer (token)\n<\n403 Forbidden\n{\"error\":\"access_denied\",\"error_description\":\"Access is denied\"}\n\nHowever, a POST request works.\n<\n200 OK\n[\n{\"access_token\":\"(access-token)\",\"token_type\":\"bearer\",\"refresh_token\":\"(refresh-token)\",\"expires_in\":26603,\"scope\":\"read\",\"client_id\":\"client1\"}\n]\nThis appears to conflict with sparklr2&apos;s configuration:\n<intercept-url pattern=\"/oauth/users/.*\"\naccess=\"#oauth2.clientHasRole(&apos;ROLE_CLIENT&apos;) and (hasRole(&apos;ROLE_USER&apos;) or #oauth2.isClient()) and #oauth2.hasScope(&apos;read&apos;)\"\nmethod=\"GET\" />", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.0.RC1", "fixed_version": "1.0.1.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.TestResourceOwnerPasswordProvider.java"], "label": 1, "es_results": []}, {"bug_id": 386, "bug_title": "OAuthProviderProcessingFilter should delegate its error handling to an AuthenticationEntryPoint", "bug_description": "OAuthProviderProcessingFilter.fail uses response.sendError to send the exception to the client. That leads to inability to process exceptions using ExceptionTranslationFilter and therefore exception handling have to be done in several places by overriding provider filter classes. ExceptionTranslationFilter should be supported properly.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.1.RELEASE", "fixed_version": "1.0.3.RELEASE", "fixed_files": ["org.springframework.security.oauth.provider.filter.OAuthProviderProcessingFilter.java", "org.springframework.security.oauth.provider.OAuthProcessingFilterEntryPoint.java"], "label": 1, "es_results": []}, {"bug_id": 394, "bug_title": "No response parameter for scope when using implicit grant (and scopes are different than requested)", "bug_description": "According to RFC 6749 Section 4.2.2, the scope response parameter is a required parameter if the granted scopes are different than those requested. However, looking at the AuthorizationEndpoint.appendAccessToken in the 1.0.2.RELEASE, the scope parameter is never appended to the redirect URL.", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.2.RELEASE", "fixed_version": "1.0.3.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.java", "org.springframework.security.oauth2.provider.endpoint.TestAuthorizationEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 400, "bug_title": "Default scopes appended to redirect in implicit grant are not properly encoded", "bug_description": "SECOAUTH-394 exposed this bug (which actually relates to all implicit grants, but hardly ever was seen before)", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.3.RELEASE", "fixed_version": "1.0.4.RELEASE", "fixed_files": ["org.springframework.security.oauth2.provider.TestImplicitProvider.java", "org.springframework.security.oauth2.provider.ServerRunning.java", "org.springframework.security.oauth2.client.token.OAuth2AccessTokenSupport.java", "org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.java", "org.springframework.security.oauth2.provider.endpoint.TestAuthorizationEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 404, "bug_title": "OAuthConsumerContextFilter contains an autowired field portResolver", "bug_description": "In my spring security context, there is multi instance of \"http\" element, for example:\n<http pattern=\"/api/**\">\n    ......\n</http> \n<http pattern=\"/web/**\" name=\"web-filter-chain\">\n    ......\n</http> \nthen I try to add spring security oauth1 support\n<oauth:consumer resource-details-service-ref=\"resourceDetails\"\n\t\toauth-failure-page=\"/oauth_error.jsp\" filter-chain-ref=\"web-filter-chain\">\n\t\t<oauth:url pattern=\"/web/oauth/spring/twitter\" resources=\"twitter\"  />\n</oauth:consumer>\nan error is reported:\norg.springframework.beans.factory.NoUniqueBeanDefinitionException: No qualifying bean of type [org.springframework.security.web.PortResolver] is defined: expected single matching bean but found 2\nIt seems not a good idea to have an autowired field in a library.\n", "project": "Spring", "sub_project": "SECOAUTH", "version": "1.0.4.RELEASE", "fixed_version": "2.0.0.RELEASE", "fixed_files": ["org.springframework.security.oauth.consumer.filter.OAuthConsumerContextFilter.java"], "label": 1, "es_results": []}, {"bug_id": 46, "bug_title": "In the InstantiatorFactoryBean provide a way to disable registration distribution", "bug_description": "The InstantiatorFactoryBean contains the following \nif (autoRegister) {\n            for (Instantiator instantiator : list) \n{\n                Instantiator.register(instantiator);\n            }\n        }\ncould this be changed so that we can provide a distribute flag to the Instantiator.register like so,\nif (autoRegister) {\n            for (Instantiator instantiator : list) \n{\n                Instantiator.register(instantiator, distribute);\n            }\n        }", "project": "Spring", "sub_project": "SGF", "version": "v1.0.0.RELEASE", "fixed_version": "v1.0.1.RELEASE", "fixed_files": ["org.springframework.data.gemfire.serialization.InstantiatorFactoryBean.java", "org.springframework.data.gemfire.serialization.WiringInstantiator.java"], "label": 1, "es_results": []}, {"bug_id": 255, "bug_title": "The <gfe:eviction> element's 'threshold' attribute is required even when the Eviction type is 'HEAP_PERCENTAGE'.", "bug_description": "Currently, the Spring Data GemFire XML schema (XSD) requires the threshold attribute on the <gfe:eviction> element in SDG XML namespace configuration meta-data.  The <gfe:eviction> is used to set Evictions settings on a Region such as (maximums, action and algorithm/type) where the threshold corresponds to the maximum value for ENTRY_COUNT and MEMORY_SIZE.  However, the threshold has no meaning for the HEAP_PERCENTAGE Eviction type/algorithm and therefore should not be required.\nThe \"threshold\", or rather percentage when Regions employ the HEAP_LRU algorithm for Eviction comes from the Resource Manager&apos;s configuration applied at the Cache-level, and in SDG, that means the <gfe:cache> element&apos;s  values for critical-heap-percentage and eviction-heap-percentage.", "project": "Spring", "sub_project": "SGF", "version": "v1.0.0.RELEASE", "fixed_version": "v1.3.4.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.EvictionAttributesFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 24, "bug_title": "CqInvalidException removed in 6.5", "bug_description": "CqInvalidException has been removed in GemFire 6.5 GA - the exception is still referred to by SGF for exception translation.", "project": "Spring", "sub_project": "SGF", "version": "v1.0.0.M1", "fixed_version": "v1.0.0.M2", "fixed_files": ["org.springframework.data.gemfire.GemfireTemplate.java", "org.springframework.data.gemfire.GemfireCacheUtils.java", "org.springframework.data.gemfire.CacheFactoryBean.java", "org.springframework.data.gemfire.GemfireAccessor.java", "org.springframework.data.gemfire.GemfireQueryException.java"], "label": 1, "es_results": []}, {"bug_id": 39, "bug_title": "WiringInstantiator should not register instantiators using the method that causes distribution", "bug_description": "When using a WiringInstantiator, the instantiator needs to be set up on each machine by the Spring application context. Unfortunately, the corrent code causes the created instantiators to be distributed, so the first server works, but second one fails.\nIn WiringInstantiator:\n\tpublic void afterPropertiesSet() {\n\t\tif (configurer == null) \n{\n\t\t\tconfigurer = new BeanConfigurerSupport();\n\t\t\tconfigurer.setBeanFactory(beanFactory);\n\t\t\tconfigurer.afterPropertiesSet();\n\t\t}\n\n\t\tif (autoRegister) \n{\nhere -->\t\tInstantiator.register(this);\n\n\t\t}\n\t}\nShould be:\n\t\tif (autoRegister) \n{\nhere -->\t\tInstantiator.register(this,false);\n\t\t}\n\nFalse will not distribute this to the other nodes.", "project": "Spring", "sub_project": "SGF", "version": "v1.0.0.RELEASE", "fixed_version": "v1.0.1.RELEASE", "fixed_files": ["org.springframework.data.gemfire.serialization.InstantiatorFactoryBean.java", "org.springframework.data.gemfire.serialization.WiringInstantiator.java"], "label": 1, "es_results": []}, {"bug_id": 40, "bug_title": "AbstractBeanDefinitionParser automatically uses the region name to create bean aliases for regions", "bug_description": "This side-effect is surprising as it pollutes the container with multiple bean names.", "project": "Spring", "sub_project": "SGF", "version": "v1.0.0.RELEASE", "fixed_version": "v1.0.1.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.ParsingUtils.java", "org.springframework.data.gemfire.config.ReplicatedRegionParser.java", "org.springframework.data.gemfire.config.ReplicatedRegionNamespaceTest.java", "org.springframework.data.gemfire.config.PartitionedRegionParser.java", "org.springframework.data.gemfire.config.LookupRegionParser.java", "org.springframework.data.gemfire.config.ClientRegionParser.java", "org.springframework.data.gemfire.config.ClientRegionNamespaceTest.java"], "label": 1, "es_results": []}, {"bug_id": 501, "bug_title": "Add serialVersionUID to ListRegionsOnServerFunction", "bug_description": "The SDG ListRegionsOnServerFunction class used by the <gfe-data:datasource/> element in the SDG Data XML namespace implements the GemFire Function interface, which is indirectly java.io.Serializable by implementing GemFire&apos;s Identifiable interface.  As a result, ListRegionsOnServerFunction should set the serialVersionUID property to avoid any ill de/serialization side-effects.", "project": "Spring", "sub_project": "SGF", "version": "1.0.0.APACHE-GEODE-INCUBATING-M2", "fixed_version": "1.8.2.RELEASE", "fixed_files": ["org.springframework.data.gemfire.support.ListRegionsOnServerFunction.java"], "label": 1, "es_results": []}, {"bug_id": 502, "bug_title": "DiskStoreAndEvictionRegionParsingTest fails when building with Maven due to missing Disk Store sub-directory.", "bug_description": "The DiskStoreAndEvictionRegionParsingTest class fails when SDG is built with Maven since the test class assumes the project is being built with Gradle and the Disk Store sub-directory is relative to the Gradle build directory ($PWD/build).", "project": "Spring", "sub_project": "SGF", "version": "1.0.0.APACHE-GEODE-INCUBATING-M2", "fixed_version": "1.8.2.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.DiskStoreAndEvictionRegionParsingTest.java"], "label": 1, "es_results": []}, {"bug_id": 81, "bug_title": "use-bean-factory-locator attribute not parsed from the namespace", "bug_description": "The use-bean-factory-locator attribute is not parsed from the namespace resulting in inability to disable BeanFactory lookup.", "project": "Spring", "sub_project": "SGF", "version": "v1.1.0.RELEASE", "fixed_version": "v1.1.1.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.CacheParser.java", "org.springframework.data.gemfire.config.CacheNamespaceTest.java"], "label": 1, "es_results": []}, {"bug_id": 80, "bug_title": "ClientRegionFactoryBean bug because client only create local region", "bug_description": "1. I use flollowing configproperty shortcut no effect \n\n\n\n\n\n\n<gfe:client-region id=\"nkqueryRegion\" name=\"NKeyQuery\" cache-ref=\"clientCache\" shortcut=\"PROXY\" />\n\n\n\n\n\n\n2. then in ClientRegionFactoryBean class,lookupFallback method, there always set shortcut to LOCAL the code like this:\n\n\n\n\n\n\nClientRegionShortcut s = null;\n\n\n\n\n\n\n\n\n\nif (shortcut == null) {\n\n\n\n\n  if (dataPolicy != null) {\n\n\n\n\n\t  \n\n\n\n\n  }\n\n\n\n\n\ts = ClientRegionShortcut.LOCAL;\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SGF", "version": "v1.1.0.RELEASE", "fixed_version": "v1.1.1.RELEASE", "fixed_files": ["org.springframework.data.gemfire.client.ClientRegionFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 69, "bug_title": "ClientRegionFactoryBean Adds Region Listeners Twice", "bug_description": "CacheListeners are added twice to the ClientRegionFactory (one inside if (attributes != null) \n{ ...}\n and again immediately after).\nNot serious for a simple logging listener but could be an issue for more complex listeners.", "project": "Spring", "sub_project": "SGF", "version": "v1.1.0.M2", "fixed_version": "v1.1.0.M3", "fixed_files": ["org.springframework.data.gemfire.client.ClientRegionFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 68, "bug_title": "regex-interest seems to have broken in 1.0.1.M2", "bug_description": "see email from customer\nQuestion #3, after moving up to Spring-GemFire 1.1.0.M2 the regex-interest seems to fail the spring bootstrap:\n    <gfe:client-region cache-ref=\"gemfire-cache\" id=\"assetEntityRegion\" name=\"assetEntityRegion\" pool-name=\"alerter-server-pool\">\n        <gfe:cache-listener>\n            <bean class=\"au.com.fairfax.media.alerterserver.listener.impl.AssetEntityRegionListenerImpl\">\n                <constructor-arg index=\"0\" ref=\"instantAlerter\"/>\n            </bean>\n        </gfe:cache-listener>\n        <gfe:regex-interest pattern=\".*\"/>\n    </gfe:client-region>\nIt works fine if I downgrade to 1.1.0.M1 or comment out regex-interest. (BY THE WAY, we&apos;re on GemFire 6.5.1.4 version)\nAttached is the stack trace.\nDo you know why this is happening?\nCustomers email address: Lenming Yeung <lyeung@fairfaxdigital.com.au> ", "project": "Spring", "sub_project": "SGF", "version": "v1.1.0.M2", "fixed_version": "v1.1.0.M3", "fixed_files": ["org.springframework.data.gemfire.client.ClientRegionFactoryBean.java", "org.springframework.data.gemfire.RegionLookupFactoryBean.java", "org.springframework.data.gemfire.client.RegionIntegrationTest.java", "org.springframework.data.gemfire.RegionFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 92, "bug_title": "GemfireRepositoryFactory should report missing Region configuration", "bug_description": "GemfireRepositoryFactory currently throws a NullPointerException in case no Region instance can be found for the domain class the repository shall be created for. We should throw a more meaningful exception here to indicate the region configuration is missing.", "project": "Spring", "sub_project": "SGF", "version": "v1.2.0.M1", "fixed_version": "v1.2.0.RC1", "fixed_files": ["org.springframework.data.gemfire.repository.support.GemfireRepositoryFactoryIntegrationTests.java", "org.springframework.data.gemfire.repository.support.GemfireRepositoryFactory.java"], "label": 1, "es_results": []}, {"bug_id": 101, "bug_title": "The repository deleteall() method only works for replicated regions", "bug_description": "The repository deleteAll() method calls the gemfire region clear() method which is unsupported for partitioned regions.  As there does not yet exist a removeAll() in GemFire, the proper implementation should be to individually delete all entries in the region specified by the repository.", "project": "Spring", "sub_project": "SGF", "version": "v1.2.0.M1", "fixed_version": "v1.2.0.RC1", "fixed_files": ["org.springframework.data.gemfire.repository.support.AbstractGemfireRepositoryFactoryIntegrationTests.java", "org.springframework.data.gemfire.repository.sample.Person.java", "org.springframework.data.gemfire.repository.sample.PersonRepository.java", "org.springframework.data.gemfire.repository.support.SimpleGemfireRepository.java"], "label": 1, "es_results": []}, {"bug_id": 121, "bug_title": "Client Region data-policy attribute not working", "bug_description": "", "project": "Spring", "sub_project": "SGF", "version": "v1.2.0.RC1", "fixed_version": "v1.2.0.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.LocalRegionNamespaceTest.java", "org.springframework.data.gemfire.client.ClientRegionFactoryBean.java", "org.springframework.data.gemfire.config.ClientRegionParser.java"], "label": 1, "es_results": []}, {"bug_id": 124, "bug_title": "Gateway configuration issues", "bug_description": "Gateway support has a few problems. The Gateway is not automatically started which it should be by default. Also if the Gateway queue includes a disk-store-ref, I get an error that the disk store does not exist (since Spring hasn&apos;t created it yet.", "project": "Spring", "sub_project": "SGF", "version": "v1.2.0.RC1", "fixed_version": "v1.2.0.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.GatewayHubParser.java", "org.springframework.data.gemfire.wan.GatewayProxy.java", "org.springframework.data.gemfire.wan.GatewayHubFactoryBean.java", "org.springframework.data.gemfire.RegionFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 127, "bug_title": "Repository section in documents references the wrong namespace", "bug_description": "", "project": "Spring", "sub_project": "SGF", "version": "v1.2.0.RC1", "fixed_version": "v1.2.0.RELEASE", "fixed_files": ["org.springframework.data.gemfire.mapping.MappingPdxSerializerUnitTests.java", "org.springframework.data.gemfire.mapping.MappingPdxSerializer.java", "org.springframework.data.gemfire.mapping.MappingPdxSerializerIntegrationTest.java"], "label": 1, "es_results": []}, {"bug_id": 131, "bug_title": "Repository count() returns the incorrect value for client regions. ", "bug_description": "Should use OQL select count from /region to return consistent results", "project": "Spring", "sub_project": "SGF", "version": "v1.2.0.RC1", "fixed_version": "v1.2.0.RELEASE", "fixed_files": ["org.springframework.data.gemfire.repository.support.SimpleGemfireRepository.java"], "label": 1, "es_results": []}, {"bug_id": 145, "bug_title": "It should be valid to configure a disk store with a non-persistent region for overflow", "bug_description": "Currently it appears that (from RegionFactoryBean.java) \"it is invalid to specify a disk store if &apos;persistent&apos; is set to false.\" In GemFire, this is not always the case, partition_overflow and replicate_overflow regions, though not persistent, can use a user configured disk store. This effect of this limitation in Spring GemFire is that non-persistent regions with overflow are forced to use the default disk store.", "project": "Spring", "sub_project": "SGF", "version": "v1.2.2.RELEASE", "fixed_version": "v1.3.0.M1", "fixed_files": ["org.springframework.data.gemfire.RegionFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 173, "bug_title": "Function Execution throws exception on void return. ", "bug_description": "", "project": "Spring", "sub_project": "SGF", "version": "v1.3.0.RELEASE", "fixed_version": "v1.3.1.RELEASE", "fixed_files": ["org.springframework.data.gemfire.function.execution.GemfireOnMemberFunctionTemplate.java", "org.springframework.data.gemfire.function.execution.AbstractFunctionTemplate.java", "org.springframework.data.gemfire.function.execution.GemfireOnRegionOperations.java", "org.springframework.data.gemfire.function.execution.GemfireOnRegionFunctionTemplate.java", "org.springframework.data.gemfire.function.execution.AbstractFunctionExecution.java", "org.springframework.data.gemfire.function.execution.GemfireFunctionOperations.java", "org.springframework.data.gemfire.function.execution.FunctionIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 159, "bug_title": "isRollbackOnCommitFailure flag is ignored by GemfireTransactionManager when transaction fails.", "bug_description": "Bug was found with version 1.2.2.RELEASE of spring-data-gemfire, gemfire 7.0 and Spring framework 3.2.0.RELEASE.\nMethod doCommit of GemfireTransactionManager catches org.springframework.transaction.TransactionException while com.gemstone.gemfire.cache.CacheTransactionManager.commit() throws com.gemstone.gemfire.cache.TransactionException when commit fails.\nSo gemfire exception is ignored by GemfireTransactionManager and is caught in\norg.springframework.transaction.support.AbstractPlatformTransactionManager (line 779) as RuntimeException and isRollbackOnCommitFailure is ignored.\nRoll back attempt fails with \"java.lang.IllegalStateException: Thread does not have an active transaction\" exception.\nHere are code fragments from AbstractPlatformTransactionManager:\n-------------\n                        catch (TransactionException ex) {\n                                // can only be caused by doCommit\n                                if (isRollbackOnCommitFailure()) \n{\n                                        doRollbackOnCommitException(status, ex);\n                                }\n                                else \n{\n                                        triggerAfterCompletion(status, TransactionSynchronization.STATUS_UNKNOWN);\n                                }\n                                throw ex;\n                        }\n                        catch (RuntimeException ex) {\n                                if (!beforeCompletionInvoked) \n{\n                                        triggerBeforeCompletion(status);\n                                }\n                                doRollbackOnCommitException(status, ex);\n                                throw ex;\n                        }\n-------------\nand GemfireTransactionManager:\n        @Override\n        protected void doCommit(DefaultTransactionStatus status) throws TransactionException {\n                // CacheTransactionObject txObject = (CacheTransactionObject)\n                // status.getTransaction();\n                if (status.isDebug()) \n{\n                        logger.debug(\"Committing Gemfire local transaction on Cache [\" + cache + \"]\");\n                }\n                try \n{\n                        cache.getCacheTransactionManager().commit();\n                }\n                catch (IllegalStateException ex) \n{\n                        throw new NoTransactionException(\n                                        \"No transaction associated with the current thread; are there multiple transaction managers ?\", ex);\n                }\n                catch (TransactionException ex) \n{\n                        throw new GemfireTransactionCommitException(\"Unexpected failure on commit of Cache local transaction\", ex);\n                }\n        }", "project": "Spring", "sub_project": "SGF", "version": "v1.2.2.RELEASE", "fixed_version": "v1.3.1.RELEASE", "fixed_files": ["org.springframework.data.gemfire.GemfireTransactionManager.java"], "label": 1, "es_results": []}, {"bug_id": 192, "bug_title": "client region ignores destroy and close settings", "bug_description": "<client-region .../> parser ignores close and destroy attributes. By default they are both false.", "project": "Spring", "sub_project": "SGF", "version": "v1.3.1.RELEASE", "fixed_version": "v1.3.2.RELEASE", "fixed_files": ["org.springframework.data.gemfire.client.ClientCacheTest.java", "org.springframework.data.gemfire.listener.ContinuousQueryListenerContainer.java", "org.springframework.data.gemfire.config.ClientRegionParser.java", "org.springframework.data.gemfire.config.MultipleCacheTest.java", "org.springframework.data.gemfire.client.PoolFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 189, "bug_title": "Spring Gemfire does not allow persistence for a local region even though this is supported in Gemfire", "bug_description": "The LocalRegionFactoryBean.setPersistent method throws an UnsupportedOperationException.  However, persistence is supported for local regions in Gemfire, so Spring Gemfire should allow persistence.", "project": "Spring", "sub_project": "SGF", "version": "v1.3.1.RELEASE", "fixed_version": "v1.3.2.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.LocalRegionNamespaceTest.java", "org.springframework.data.gemfire.LocalRegionFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 185, "bug_title": "@OnServers fails when pool attribute is set - cannot specify both pool and cache", "bug_description": "The problem arises because the OnServers annotation defaults the cache attribute to \"gemfireCache\". Setting the pool attribute causes the error. The default should be removed.  Meanwhile the workaround is \n\n\n\n\n\n\n@OnServers(cache=\"\",pool=\"somePool\")\n\n\n\n\n\n", "project": "Spring", "sub_project": "SGF", "version": "v1.3.1.RELEASE", "fixed_version": "v1.3.2.RELEASE", "fixed_files": ["org.springframework.data.gemfire.function.config.ServerBasedExecutionBeanDefinitionBuilder.java", "org.springframework.data.gemfire.function.annotation.OnServers.java"], "label": 1, "es_results": []}, {"bug_id": 198, "bug_title": "BeanCurrentlyInCreationException when injecting async-event-queue to a Gemfire replicated region", "bug_description": "Getting BeanCurrentlyInCreationException when injecting a async-event-queue to a region such as the following.\nError:\norg.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name &apos;async-event-queue&apos;: Requested bean is currently in creation: Is there an unresolvable circular reference?\nGemfire region configuration:\n<gfe:async-event-queue id=\"async-event-queue\" \n    batch-size=\"10\" \n    persistent=\"true\" \n    disk-store-ref=\"gemfirePersistenceStore\" \n    maximum-queue-memory=\"50\" \n    parallel=\"true\"\n    batch-conflation-enabled=\"true\"\n    batch-time-interval=\"3\"\n    dispatcher-threads=\"4\"\n    disk-synchronous=\"true\"\n    order-policy=\"KEY\">\n        <gfe:async-event-listener>\n          <bean class=\"some.AsyncCacheEventListener\"/>\n        </gfe:async-event-listener>\n    </gfe:async-event-queue>\n<gfe:partitioned-region id=\"policy\" persistent=\"true\" disk-store-ref=\"gemfirePersistenceStore\" disk-synchronous=\"true\"\nrecovery-delay=\"6000\">\n<gfe:async-event-queue-ref bean=\"async-event-queue\"/>\n</gfe:partitioned-region>", "project": "Spring", "sub_project": "SGF", "version": "v1.3.1.RELEASE", "fixed_version": "v1.3.3.RELEASE", "fixed_files": ["org.springframework.data.gemfire.wan.AsyncEventQueueFactoryBean.java", "org.springframework.data.gemfire.config.AsyncEventQueueParser.java"], "label": 1, "es_results": []}, {"bug_id": 247, "bug_title": "boolean based repository queries generate UnsupportedOperationException in non PDX serialized entities", "bug_description": "Without using PDX serialization, boolean based queries throw on unsupported operation out of Predicates.getOperator. The type:Type parameter to the method comes in as TRUE or FALSE, however neither of these are supported in the getOperator method.\nI have attached a patch file that I believe corrects the issue completely as well as a test project to replicate the issue.\nExact error messages are:", "project": "Spring", "sub_project": "SGF", "version": "v1.3.1.RELEASE", "fixed_version": "v1.3.3.RELEASE", "fixed_files": ["org.springframework.data.gemfire.repository.query.PredicatesUnitTests.java", "org.springframework.data.gemfire.repository.query.Predicates.java"], "label": 1, "es_results": []}, {"bug_id": 176, "bug_title": "Missing Functionality: time to live and entry idle time on a local client region", "bug_description": "In Gemfire it is possible to set <entry-idle-time> and <entry-time-to-live> on a client&apos;s region whereas in Spring Gemfire this functionality seems to be missing. \nFor example In gemfire, I can do the following for a client\n<client-cache>\n\t<pool name=\"client\" subscription-enabled=\"true\">\n\t\t<server host=\"localhost\" port=\"40404\" />\n\t</pool>\n\t<region name=\"exampleRegion\">\n\t\t<region-attributes refid=\"CACHING_PROXY\">\n\t\t<entry-idle-time>\n\t\t\t<expiration-attributes timeout=\"10\" action=\"destroy\" />\n\t\t\t</entry-idle-time>\n\t\t</region-attributes>\n\t</region>\n</client-cache>\nWhen I try to do the similar in Spring Gemfire, the line <gfe:entry-tti timeout=\"100\" action=\"DESTROY\"/>  does not seem to be supported by schema.\n  <gfe:client-cache pool-name=\"client\" />\n<gfe:pool id=\"client\" subscription-enabled=\"true\">\n<gfe:server host=\"localhost\" port=\"40404\" />\n</gfe:pool>\n<gfe:client-region id=\"Customer\" shortcut=\"CACHING_PROXY\">\n<gfe:entry-tti timeout=\"100\" action=\"DESTROY\"/> \n</gfe:client-region>\n</beans>\nThe line   <gfe:entry-tti timeout=\"100\" action=\"DESTROY\"/> is supported for Server cache. For example, the following works fine\n.\n.\n.\n  <gfe:cache-server/>\n    <gfe:replicated-region id=\"Customer\">\n        <gfe:cache-listener>\n            <bean class=\"org.springframework.data.gemfire.examples.util.LoggingCacheListener\"/>\n        </gfe:cache-listener>\n        <gfe:entry-tti timeout=\"100\" action=\"DESTROY\"/> \n    </gfe:replicated-region>\n</beans>", "project": "Spring", "sub_project": "SGF", "version": "v1.3.1.RELEASE", "fixed_version": "v1.3.2.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.ClientRegionParser.java", "org.springframework.data.gemfire.config.ClientRegionNamespaceTest.java"], "label": 1, "es_results": []}, {"bug_id": 194, "bug_title": "Nested region do not work", "bug_description": "Both client and server configurations for sub regions do not work. Although the server configuration will run it does not create the actual sub regions in the cluster as can be seen from the gemfire logs, gfsh and pulse.\nThe client xsd configuration does not allow for sub regions either.\nAll of this functionality is critical to a client delivery as we are using SI and SGF extensively.  ", "project": "Spring", "sub_project": "SGF", "version": "v1.3.2.RELEASE", "fixed_version": "v1.3.3.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.LookupRegionParser.java", "org.springframework.data.gemfire.test.StubGatewayReceiverFactory.java", "org.springframework.data.gemfire.config.AbstractRegionParser.java", "org.springframework.data.gemfire.config.SubRegionNamespaceTest.java", "org.springframework.data.gemfire.SubRegionFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 219, "bug_title": "Unable to register GemFire CacheListeners on SubRegions.", "bug_description": "When registering a GemFire CacheListener on a GemFire SubRegion  using Spring Data GemFire context configuration meta-data, like so...\n\n\n\n\n\n\n  <gfe:replicated-region id=\"STREAM\" data-policy=\"empty\">\n\n\n\n\n    <gfe:replicated-region name=\"OrganizationUnits\" scope=\"distributed-ack\"/>\n\n\n\n\n    <gfe:replicated-region name=\"GeoFences\" scope=\"distributed-ack\"/>\n\n\n\n\n    <gfe:replicated-region name=\"Subscriptions\" scope=\"distributed-ack\">\n\n\n\n\n      <gfe:cache-listener>\n\n\n\n\n        <bean id=\"STREAM_Subscriptions_StreamSubscriptionListener\" class=\"com.gopivotal.rti.telco.refdata.StreamSubscriptionListener\" />\n\n\n\n\n      </gfe:cache-listener>\n\n\n\n\n    </gfe:replicated-region>\n\n\n\n\n  </gfe:replicated-region>\n\n\n\n\n\n\nThe following Spring container error occurs...\n\n\n\n\n\n\n2013-11-08 08:59:36,800 [main] ERROR com.gopivotal.rti.boot.spring.AbstractXmlSpringInitializer - \n\n\n\n\n  Could not start Spring Container from resources [classpath:/spring/distgrid-context.xml]\n\n\n\n\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;/STREAM/Subscriptions&apos;: \n\n\n\n\n  Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: \n\n\n\n\n  Invalid property &apos;cacheListeners&apos; of bean class [org.springframework.data.gemfire.SubRegionFactoryBean]: \n\n\n\n\n  Bean property &apos;cacheListeners&apos; is not writable or has an invalid setter method. Did you mean &apos;cacheListener&apos;?\n\n\n\n\n\n\nThere is only one Cache Listener defined.", "project": "Spring", "sub_project": "SGF", "version": "v1.3.2.RELEASE", "fixed_version": "v1.3.3.RELEASE", "fixed_files": ["org.springframework.data.gemfire.SubRegionFactoryBean.java", "org.springframework.data.gemfire.RegionFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 218, "bug_title": "The Eviction Policy on Client Subscription when configuring a GemFire Cache Server is not being properly set; always defaults to \"NONE\".", "bug_description": "During testing for the fix of bug SGF-217, I uncovered another bug... Spring Data GemFire does not properly set the Eviction Policy based on the eviction-type attribute because it is pulling the attribute value from the wrong XML element (i.e. the eviction-type attribute value is being pulled from the <gfe:cache-server/> parent element) in the Spring context configuration meta-data as seen in the parseSubscription(..) method of the org.springframework.data.gemfire.server.CacheServerFactoryBean) class...\n\n\n\n\n\n\n\tprivate void parseSubscription(BeanDefinitionBuilder builder, Element element) {\n\n\n\n\n\t\tElement subConfig = DomUtils.getChildElementByTagName(element, \"subscription-config\");\n\n\n\n\n\t\tif (subConfig == null) {\n\n\n\n\n\t\t\treturn;\n\n\n\n\n\t\t}\n\n\n\n\n\n\n\n\n\n\t\tParsingUtils.setPropertyValue(subConfig, builder, \"capacity\", \"subscriptionCapacity\");\n\n\n\n\n\t\tParsingUtils.setPropertyValue(subConfig, builder, \"disk-store\", \"subscriptionDiskStore\");\n\n\n\n\n\t\tString attr = element.getAttribute(\"eviction-type\");\n\n\n\n\n\t\tif (StringUtils.hasText(attr)) {\n\n\n\n\n\t\t\tbuilder.addPropertyValue(\"subscriptionEvictionPolicy\", attr.toUpperCase());\n\n\n\n\n\t\t}\n\n\n\n\n\t}\n\n\n\n\n\n\nThe element.getAttribute(\"eviction-type\") should read subConfig.getAttribute(\"eviction-type\").  As a result, unfortunately the Eviction Policy always defaults, or is set to \"none\".", "project": "Spring", "sub_project": "SGF", "version": "v1.3.2.RELEASE", "fixed_version": "v1.3.3.RELEASE", "fixed_files": ["org.springframework.data.gemfire.test.StubCacheServer.java", "org.springframework.data.gemfire.config.CacheServerNamespaceTest.java", "org.springframework.data.gemfire.config.CacheServerParser.java", "org.springframework.data.gemfire.server.CacheServerFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 217, "bug_title": "When configuring CacheServer with a Disk Store (used for client subscription queue overflow), the Cache Server fails to start up with an error.", "bug_description": "When configuring CacheServer with a Disk Store (used for client subscription queue overflow), the Cache Server fails to start up with the following error:\n\n\n\n\n\n\n2013-11-07 07:54:20,034 [main] ERROR com.gopivotal.rti.boot.spring.AbstractXmlSpringInitializer -  \n\n\n\n\n    Could not start Spring Container from resources [classpath:/spring/distgrid-context.xml]\n\n\n\n\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;DistGridCacheServer&apos;: \n\n\n\n\n    Invocation of init method failed; nested exception is java.io.FileNotFoundException: \n\n\n\n\n    class path resource [DEFAULT] cannot be resolved to URL because it does not exist\n\n\n\n\n\n\nI&apos;ve tried changing the placement of the DiskStore and CacheServer elements in different positions, but the result is the same.  The bottom-line is that the CacheServer&apos;s disk-store attribute needs the referenced DiskStore to be instantiated first. ", "project": "Spring", "sub_project": "SGF", "version": "v1.3.2.RELEASE", "fixed_version": "v1.3.3.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.CacheServerParser.java", "org.springframework.data.gemfire.server.CacheServerFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 203, "bug_title": "The treatment of 'persistence' is wrong.", "bug_description": "The treatment of &apos;persistence&apos; is wrong.  Overflow is not persistence, it only stores the data that won&apos;t fit in memory.  The assumption that turning on persistence could result in storing all the data would be in error if the other settings result in overflow.  The Gemfire settings, data policy and the shortcut should be passed to Gemfire without modification to prevent this from happening.", "project": "Spring", "sub_project": "SGF", "version": "v1.3.2.RELEASE", "fixed_version": "v1.3.3.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.ParsingUtils.java", "org.springframework.data.gemfire.config.GemfireV7GatewayNamespaceTest.java", "org.springframework.data.gemfire.config.AsyncEventQueueParser.java", "org.springframework.data.gemfire.PartitionedRegionFactoryBean.java", "org.springframework.data.gemfire.config.AbstractRegionParser.java", "org.springframework.data.gemfire.LocalRegionFactoryBean.java", "org.springframework.data.gemfire.client.ClientRegionFactoryBean.java", "org.springframework.data.gemfire.config.ClientRegionParser.java", "org.springframework.data.gemfire.config.ClientRegionNamespaceTest.java", "org.springframework.data.gemfire.client.ClientRegionFactoryBeanTest.java", "org.springframework.data.gemfire.RegionFactoryBeanTest.java", "org.springframework.data.gemfire.DataPolicyConverterTest.java", "org.springframework.data.gemfire.RegionLookupFactoryBean.java", "org.springframework.data.gemfire.RegionFactoryBean.java", "org.springframework.data.gemfire.ReplicatedRegionFactoryBean.java", "org.springframework.data.gemfire.LocalRegionFactoryBeanTest.java"], "label": 1, "es_results": []}, {"bug_id": 225, "bug_title": "Inconsistent data policy defaults for subregions that are replicated regions", "bug_description": "When defining replicated regions that are subregions, the same data-policy heuristics that are used for top-level replicated regions should be applied. Eg.\n<gfe:replicated-region id=\"FOO\">\n   <gfe:replicated-region\n\tname=\"BAR\"\n        scope=\"distributed-ack\" />\nFor the FOO region, the heuristics in ReplicatedRegionFactoryBean#resolveDataPolicy will figure out a data-policy. But, for the /FOO/BAR subregion, the raw SubRegionFactoryBean is used, which does not have the same logic in it.", "project": "Spring", "sub_project": "SGF", "version": "v1.3.3.RELEASE", "fixed_version": "v1.4.0.M1", "fixed_files": ["org.springframework.data.gemfire.config.ClientRegionUsingDataPolicyAndShortcutTest.java", "org.springframework.data.gemfire.RegionLookupFactoryBean.java", "org.springframework.data.gemfire.config.ParsingUtils.java", "org.springframework.data.gemfire.RegionFactoryBean.java", "org.springframework.data.gemfire.test.MockRegionFactory.java", "org.springframework.data.gemfire.config.ReplicatedRegionParser.java", "org.springframework.data.gemfire.config.GemfireNamespaceHandler.java", "org.springframework.data.gemfire.config.SubRegionNamespaceTest.java", "org.springframework.data.gemfire.config.PartitionedRegionParser.java", "org.springframework.data.gemfire.ReplicatedRegionFactoryBean.java", "org.springframework.data.gemfire.config.LocalRegionParser.java", "org.springframework.data.gemfire.SubRegionFactoryBean.java", "org.springframework.data.gemfire.config.AbstractRegionParser.java", "org.springframework.data.gemfire.config.LookupRegionParser.java", "org.springframework.data.gemfire.config.ClientRegionParser.java"], "label": 1, "es_results": []}, {"bug_id": 238, "bug_title": "\"jndi-prop\" is not parced correctly", "bug_description": "According to schema definition jndi-prop element should be a child of jndi-binding one. Though CacheParser.parseJndiBindings expects this element to be a child of cache (on the same level as indi-binding). \nSee line 186 in CacheParser.java:\nList<Element> jndiProps = DomUtils.getChildElementsByTagName(element, \"jndi-prop\");\nelement here is the reference to cache, not jndi-binding", "project": "Spring", "sub_project": "SGF", "version": "v1.3.3.RELEASE", "fixed_version": "v1.3.4.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.CacheParser.java", "org.springframework.data.gemfire.config.JndiBindingsTest.java", "org.springframework.data.gemfire.CacheFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 239, "bug_title": "The value \"XaPooledDataSource\" of jndi-binding \"type\" attribute should be changed to \"XAPooledDataSource\"", "bug_description": "Gemfire expects \"XAPooledDataSource\" JNDI binding type but schema defines \"XaPooledDataSource\" enumeration value (I am wondering how does this work for you and whether this functionality was tested at all?).\nA workaround could be to turn off validation before refreshing Spring context.", "project": "Spring", "sub_project": "SGF", "version": "v1.3.3.RELEASE", "fixed_version": "v1.3.4.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.CacheParser.java", "org.springframework.data.gemfire.config.JndiBindingsTest.java", "org.springframework.data.gemfire.CacheFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 244, "bug_title": "The nested <gfe:gateway-sender/>, <gfe:event-filter/> element is missing the ref attribute in the XSD.", "bug_description": "<gfe:gateway-sender id=\"modelTransferAlpha\"\n                        remote-distributed-system-id=\"$\n{alpha.dsi}\n\"\n                        batch-size=\"1\"\n                        batch-time-interval=\"10\"\n                        persistent=\"false\">\n        <gfe:event-filter ref=\"alphaSenderFilter\"/>\n    </gfe:gateway-sender>\nDoesn&apos;t like the ref attribute.", "project": "Spring", "sub_project": "SGF", "version": "v1.3.3.RELEASE", "fixed_version": "v1.4.0.M1", "fixed_files": ["org.springframework.data.gemfire.config.GemfireV7GatewayNamespaceTest.java"], "label": 1, "es_results": []}, {"bug_id": 295, "bug_title": "Enable Local Region Eviction action to be set to 'LOCAL_DESTROY', which is allowed in GemFire using the public API or in cache.xml.", "bug_description": "Currently, SDG \"fixes\" the Eviction action policy to \"OVERFLOW_TO_DISK\", on Local (client) Regions, however GemFire does support \"LOCAL_DESTROY\" for Local (client) Regions as well.", "project": "Spring", "sub_project": "SGF", "version": "v1.4.0.RELEASE", "fixed_version": "v1.4.2.RELEASE", "fixed_files": ["org.springframework.data.gemfire.config.LocalRegionParser.java", "org.springframework.data.gemfire.test.MockRegionFactory.java"], "label": 1, "es_results": []}, {"bug_id": 273, "bug_title": "OrderBy (static) and Sort parameter (dynamic) Repository Queries do not work!", "bug_description": "Presently, when a Spring Data GemFire user defines a GemFire Repository interface extension query, such as...\n\n\n\n\n\n\nList<Person> findDistinctByFirstNameEqualOrderByLastNameAsc(String firstName);\n\n\n\n\n\n\nThe OrderBy clause is completely ignored and the \"statically\" generated Sort meta-data is not applied to the generated GemFire OQL Select Query.\nFurthermore, if a user defines a query interface method with a org.springframework.data.domain.Sort parameter, like so...\n\n\n\n\n\n\nList<Person> findDistinctByLastName(String lastName, Sort orderBy);\n\n\n\n\n\n\nThe Sort parameter is ignored and not used when generating the OQL Select Query.", "project": "Spring", "sub_project": "SGF", "version": "v1.4.0.M1", "fixed_version": "v1.4.0.RC1", "fixed_files": ["org.springframework.data.gemfire.repository.query.QueryStringUnitTests.java", "org.springframework.data.gemfire.repository.query.QueryString.java", "org.springframework.data.gemfire.repository.query.PartTreeGemfireRepositoryQuery.java", "org.springframework.data.gemfire.repository.query.GemfireQueryCreator.java", "org.springframework.data.gemfire.repository.sample.PersonRepository.java", "org.springframework.data.gemfire.repository.sample.SubRegionRepositoryIntegrationTest.java", "org.springframework.data.gemfire.repository.query.QueryBuilder.java", "org.springframework.data.gemfire.repository.support.SimpleGemfireRepository.java"], "label": 1, "es_results": []}, {"bug_id": 304, "bug_title": "OnMembers function execution with Gemfire Group calls onMember (wrong method)", "bug_description": "In class GroupMemberFunctionExecution, line 40:\n\t@Override\n\tprotected Execution getExecution() \n{\n\t\treturn FunctionService.onMember(this.groups);\n\t}\n\nThe problem is that it is calling the SINGULAR version of the function, the right one is the PLURAL onMembers method.", "project": "Spring", "sub_project": "SGF", "version": "v1.4.1.RELEASE", "fixed_version": "v1.4.4.RELEASE", "fixed_files": ["org.springframework.data.gemfire.function.execution.GroupMembersFunctionExecution.java", "org.springframework.data.gemfire.function.execution.GemfireOnMembersFunctionTemplate.java", "org.springframework.data.gemfire.function.execution.GroupMemberFunctionExecution.java", "org.springframework.data.gemfire.function.execution.GemfireOnMemberFunctionTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 338, "bug_title": "Both <gfe:custom-entry-ttl> and <gfe:custom-entry-tti> SDG XML namespace elements allow for more than one 'CustomExpiry' bean to be set in the Region Expiration Attributes although GemFire only allows one!", "bug_description": "The &apos;<gfe:custom-entry-ttl>&apos; and &apos;<gfe:custom-entry-tti>&apos; SDG XML namespace elements allow for more than one inner, nested bean definition, for example...\n\n\n\n\n\n\n<gfe:replicated-region id=\"Example\" statistics=\"true\">\n\n\n\n\n  <gfe:custom-entry-tti>\n\n\n\n\n    <bean class=com.example.MyClass\"/>\n\n\n\n\n    <bean class=com.example.AnotherClass\"/>\n\n\n\n\n    <bean class=com.example.YetAnotherClass\"/>\n\n\n\n\n    ...\n\n\n\n\n  </gfe:custom-entry-tti>\n\n\n\n\n</gfe:replicated-region>\n\n\n\n\n\n\nHowever, the GemFire com.gemstone.gemfire.cache.RegionFactory interface only allows one CustomExpiry to be specified for both Region Entry TTL (Time-To-Live) as well as Entry TTI (Idle-Timeout).  \n\n\n\n\n\n\n  RegionFactory<K,V> setCustomEntryTimeToLive(CustomExpiry<K,V> custom);\n\n\n\n\n\n\n\n\n\n  RegionFactory<K,V> setCustomEntryIdleTimeout(CustomExpiry<K,V> custom);\n\n\n\n\n\n\nAs well, the com.gemstone.gemfire.cache.RegionAttributes interface only return a single CustomExpiry from...\n\n\n\n\n\n\n  CustomExpiry<K,V> getCustomEntryTimeToLive()\n\n\n\n\n\n\n\n\n\n  CustomExpiry<K,V> getCustomEntryIdleTimeout()\n\n\n\n\n\n\nTherefore, SDG&apos;s XML namespace and schema (XSD) need to be changed.", "project": "Spring", "sub_project": "SGF", "version": "v1.4.4.RELEASE", "fixed_version": "v1.6.0.M1", "fixed_files": ["org.springframework.data.gemfire.config.RegionEvictionAttributesNamespaceTest.java", "org.springframework.data.gemfire.config.ParsingUtils.java"], "label": 1, "es_results": []}, {"bug_id": 330, "bug_title": "Add missing 'disk-synchronous' attribute to the <gfe:gateway-sender> element in the SDG XML namespace (XSD)", "bug_description": "The Spring Data GemFire XML namespace (XSD) <gfe:gateway-sender> element is missing the &apos;disk-synchronous&apos; attribute.", "project": "Spring", "sub_project": "SGF", "version": "v1.4.4.RELEASE", "fixed_version": "v1.4.5.RELEASE", "fixed_files": ["org.springframework.data.gemfire.test.StubGatewaySenderFactory.java", "org.springframework.data.gemfire.config.GemfireV7GatewayNamespaceTest.java"], "label": 1, "es_results": []}, {"bug_id": 310, "bug_title": "The <gfe:client-region> element is missing the 'concurrency-level' attribute, which is supported by GemFire's ClientRegionFactory API.", "bug_description": "The <gfe:client-region> element is missing an attribute for &apos;concurrency-level&apos;, which is a property of GemFire&apos;s {{CientRegionFactory} API.", "project": "Spring", "sub_project": "SGF", "version": "v1.5.0.M1", "fixed_version": "v1.5.0.RELEASE", "fixed_files": ["org.springframework.data.gemfire.test.MockRegionFactory.java", "org.springframework.data.gemfire.config.SubRegionNamespaceTest.java", "org.springframework.data.gemfire.config.ReplicatedRegionNamespaceTest.java", "org.springframework.data.gemfire.config.DiskStoreAndEvictionRegionParsingTest.java", "org.springframework.data.gemfire.config.ClientRegionNamespaceTest.java", "org.springframework.data.gemfire.client.ClientRegionFactoryBean.java", "org.springframework.data.gemfire.config.ClientRegionParser.java"], "label": 1, "es_results": []}, {"bug_id": 311, "bug_title": "ClientRegionFactoryBean does not properly set the 'concurrency-checks-enabled' attribute and property of GemFire's ClientRegionFactory class.", "bug_description": "The Spring Data GemFire ClientRegionFactoryBean does not properly set the &apos;concurrencyChecksEnabled&apos; property (corresponding to the &apos;concurrency-checks-enabled&apos; attribute of the <gfe:client-region> element in the SDG XSD) of GemFire&apos;s ClientRegionFactory class.", "project": "Spring", "sub_project": "SGF", "version": "v1.5.0.M1", "fixed_version": "v1.5.0.RELEASE", "fixed_files": ["org.springframework.data.gemfire.test.MockRegionFactory.java", "org.springframework.data.gemfire.config.SubRegionNamespaceTest.java", "org.springframework.data.gemfire.config.ReplicatedRegionNamespaceTest.java", "org.springframework.data.gemfire.config.DiskStoreAndEvictionRegionParsingTest.java", "org.springframework.data.gemfire.config.ClientRegionNamespaceTest.java", "org.springframework.data.gemfire.client.ClientRegionFactoryBean.java", "org.springframework.data.gemfire.config.ClientRegionParser.java"], "label": 1, "es_results": []}, {"bug_id": 312, "bug_title": "The <gfe:partitioned-region> element in the SDG XSD does not properly support multiple PartitionListener bean definitions or references.", "bug_description": "The &apos;<gfe:partitioned-region>&apos; element in the SDG XSD does not properly support and register multiple PartitionListener bean definitions on a PARTITION Region.", "project": "Spring", "sub_project": "SGF", "version": "v1.5.0.M1", "fixed_version": "v1.5.0.RELEASE", "fixed_files": ["org.springframework.data.gemfire.test.MockRegionFactory.java", "org.springframework.data.gemfire.config.SubRegionNamespaceTest.java", "org.springframework.data.gemfire.config.ReplicatedRegionNamespaceTest.java", "org.springframework.data.gemfire.config.DiskStoreAndEvictionRegionParsingTest.java", "org.springframework.data.gemfire.config.PartitionedRegionParser.java", "org.springframework.data.gemfire.config.ParsingUtils.java", "org.springframework.data.gemfire.PartitionAttributesFactoryBean.java", "org.springframework.data.gemfire.config.PartitionedRegionNamespaceTest.java"], "label": 1, "es_results": []}, {"bug_id": 432, "bug_title": "IndexFactoryBean traps IndexExistsException instead of IndexNameConflictException.", "bug_description": "GemFire throws several Index related Exceptions on attempts to create Indexes. The one that is currently caught by spring-data-gemfire is IndexExistsException, which occurs when an Index of the same definition exists. GemFire also throws IndexNameConflictException, which occurs when an Index with the same name exists.\nIn at least GemFire 6.6.3 and 7.0.2.3, the IndexNameConflictException is the Exception thrown when two instances of an Index with the same name and definition are created simultaneously. In spring-data-gemfire 1.5.2.RELEASE and onwards, Exceptions are no longer swallowed during Index creation, so the IndexNameConflictException is thrown and not handled, while the IndexExistsException is handled, but may return null as the Index may not be named identically.", "project": "Spring", "sub_project": "SGF", "version": "v1.5.2.RELEASE", "fixed_version": "1.7.1.RELEASE", "fixed_files": ["org.springframework.data.gemfire.GemfireIndexException.java", "org.springframework.data.gemfire.IndexFactoryBean.java", "org.springframework.data.gemfire.IndexFactoryBeanTest.java"], "label": 1, "es_results": []}, {"bug_id": 385, "bug_title": "Local region does remote put in addition to local put in client cache.", "bug_description": "I need to create a local region in client cache to store some data locally. I config my local region using SDG. When I do region.put, it updates cache server as well (found by using a loggingCacheListener, afterUpdate on server side is triggered).\n\n\n\n\n\n\n<gfe:client-region id=\"analyticsInfoRegion\" cache-ref=\"gemfireCache\" shortcut=\"LOCAL\">\n\n\n\n\n    <gfe:cache-listener ref=\"loggingCacheListener\" />\n\n\n\n\n</gfe:client-region>\n\n\n\n\n\n\nDAO (before):\n\n\n\n\n\n\n@Resource(name = GBCConstants.REGION_ANALYTICS_INFO)\n\n\n\n\npublic void setRegion(final Region<AnalyticsKey, AnalyticsInfo> region) {\n\n\n\n\n    this.region = region;\n\n\n\n\n}\n\n\n\n\n\n\nTherefore, I had to switch to GemFire API to create this local region in my Dao. \nDAO (after):\n\n\n\n\n\n\n@PostConstruct\n\n\n\n\npublic void init() {\n\n\n\n\n    ClientCache clientCache = ClientCacheFactory.getAnyInstance();\n\n\n\n\n    this.region = clientCache.<AnalyticsKey, AnalyticsInfo>createClientRegionFactory(ClientRegionShortcut.LOCAL)\n\n\n\n\n        .addCacheListener(loggingCacheListener)\n\n\n\n\n        .create(GBCConstants.REGION_ANALYTICS_INFO);\n\n\n\n\n}\n\n\n\n\n\n\nOne thing I realized when looking at the detail in debug mode is that the local region has server pool attached (\"srp\") when it&apos;s configured using SDG. However, when it&apos;s configured using GemFire API, its \"srp\" is NULL.", "project": "Spring", "sub_project": "SGF", "version": "v1.5.2.RELEASE", "fixed_version": "1.5.3.RELEASE", "fixed_files": ["org.springframework.data.gemfire.client.ClientRegionFactoryBeanTest.java", "org.springframework.data.gemfire.client.PoolFactoryBean.java", "org.springframework.data.gemfire.config.CacheNamespaceTest.java", "org.springframework.data.gemfire.test.MockClientCacheFactoryBean.java", "org.springframework.data.gemfire.config.PoolNamespaceTest.java", "org.springframework.data.gemfire.config.GemfireConstants.java", "org.springframework.data.gemfire.test.MockCacheFactoryBean.java", "org.springframework.data.gemfire.client.ClientCacheTest.java", "org.springframework.data.gemfire.client.ClientCacheFactoryBean.java", "org.springframework.data.gemfire.RegionLookupIntegrationTests.java", "org.springframework.data.gemfire.client.ClientRegionFactoryBean.java", "org.springframework.data.gemfire.CacheFactoryBean.java", "org.springframework.data.gemfire.config.PoolParser.java"], "label": 1, "es_results": []}, {"bug_id": 423, "bug_title": "Handle improper ClassCastException thrown from SDG's Function Execution interface and annotation-based support when a GemFire Function throws an Exception.", "bug_description": "Currently, when a GemFire-defined Function is invoked using Spring Data GemFire&apos;s Function Execution Annotation support and interface-based declarations, and the GemFire Function throws an Exception and the Function has a single value return-type, a ClassCastException is thrown because SDG&apos;s Function infrastructure tries to cast the Exception to the Function Execution interface method return type.\nFor instance, if I defined a Function Execution interface like so...\n\n\n\n\n\n\n@OnServer\n\n\n\n\npublic interface ExceptionThrowingFunctionExecution {\n\n\n\n\n\tInteger exceptionThrowingFunction();\n\n\n\n\n}\n\n\n\n\n\n\nAnd the exceptionThrowingFunction GemFire Function throws a (Runtime)Exception..\n\n\n\n\n\n\npublic static class ExceptionThrowingFunction extends FunctionAdapter {\n\n\n\n\n\t@Override\n\n\n\n\n\tpublic String getId() {\n\n\n\n\n\t\treturn \"exceptionThrowingFunction\";\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n\t@Override\n\n\n\n\n\tpublic void execute(final FunctionContext context) {\n\n\n\n\n\t\tcontext.getResultSender().sendException(new IllegalArgumentException(\"TEST\"));\n\n\n\n\n\t}\n\n\n\n\n}\n\n\n\n\n\n\nThen the following error occurs in SDG&apos;s Function Execution infrastructure...\njava.lang.ClassCastException: java.lang.IllegalArgumentException cannot be cast to java.lang.Integer", "project": "Spring", "sub_project": "SGF", "version": "1.6.2.RELEASE", "fixed_version": "1.7.0.RELEASE", "fixed_files": ["org.springframework.data.gemfire.function.config.FunctionExecutionConfiguration.java", "org.springframework.data.gemfire.function.config.AbstractFunctionExecutionConfigurationSource.java", "org.springframework.data.gemfire.function.config.FunctionExecutionBeanDefinitionRegistrar.java", "org.springframework.data.gemfire.function.execution.AbstractFunctionExecution.java", "org.springframework.data.gemfire.function.execution.ServerFunctionExecution.java", "org.springframework.data.gemfire.function.execution.GemfireFunctionProxyFactoryBean.java", "org.springframework.data.gemfire.function.config.ServerBasedExecutionBeanDefinitionBuilder.java", "org.springframework.data.gemfire.function.execution.AbstractFunctionTemplate.java", "org.springframework.data.gemfire.function.execution.GemfireOnServerFunctionTemplate.java", "org.springframework.data.gemfire.function.config.FunctionExecutionBeanDefinitionParser.java", "org.springframework.data.gemfire.function.config.MemberBasedExecutionBeanDefinitionBuilder.java", "org.springframework.data.gemfire.function.config.OnMemberExecutionBeanDefinitionBuilder.java", "org.springframework.data.gemfire.function.config.OnMembersExecutionBeanDefinitionBuilder.java", "org.springframework.data.gemfire.function.config.OnRegionExecutionBeanDefinitionBuilder.java", "org.springframework.data.gemfire.FunctionServiceFactoryBean.java", "org.springframework.data.gemfire.function.execution.OnRegionFunctionProxyFactoryBean.java", "org.springframework.data.gemfire.function.config.OnServersExecutionBeanDefinitionBuilder.java", "org.springframework.data.gemfire.config.FunctionServiceParser.java", "org.springframework.data.gemfire.function.config.OnServerExecutionBeanDefinitionBuilder.java", "org.springframework.data.gemfire.function.config.XmlConfiguredFunctionExecutionIntegrationTests.java", "org.springframework.data.gemfire.function.config.FunctionExecutionBeanDefinitionBuilderFactory.java", "org.springframework.data.gemfire.function.config.AbstractFunctionExecutionBeanDefinitionBuilder.java", "org.springframework.data.gemfire.function.config.FunctionExecutionIntegrationTests.java"], "label": 1, "es_results": []}, {"bug_id": 425, "bug_title": "Allow early initialization and re-initialization of LazyWiringDeclarableSupport instances.", "bug_description": "A problem occurs when a GemFire Function extends the LazyWiringDeclarableSupport class and is redeployed using the Gfsh deploy command to the update the GemFire-defined Function.\nThis results in the Declarable init(parameters:Properties) method being called twice which is guarded by the LazyWiringDeclarableSupport class.\nIt would also be nice to completely replace the WiringDeclarableSupport with the more recent and capable LazyWiringDeclarableSupport class.", "project": "Spring", "sub_project": "SGF", "version": "1.6.2.RELEASE", "fixed_version": "1.7.0.RELEASE", "fixed_files": ["org.springframework.data.gemfire.WiringDeclarableSupport.java", "org.springframework.data.gemfire.LazyWiringDeclarableSupport.java", "org.springframework.data.gemfire.GemfireBeanFactoryLocatorTest.java", "org.springframework.data.gemfire.LazyWiringDeclarableSupportTest.java", "org.springframework.data.gemfire.support.SpringContextBootstrappingInitializerTest.java", "org.springframework.data.gemfire.DeclarableSupport.java", "org.springframework.data.gemfire.support.SpringContextBootstrappingInitializer.java", "org.springframework.data.gemfire.GemfireBeanFactoryLocator.java"], "label": 1, "es_results": []}, {"bug_id": 448, "bug_title": "GemfireRepositoryConfigurationExtension needs to override the RepositoryConfigurationExtensionSupport postProcess(:BeanDefinitionBuilder, :AnnotationRepositoryConfigurationSource) method.", "bug_description": "GemfireRepositoryConfigurationExtension needs to override the RepositoryConfigurationExtensionSupport postProcess(..) method with the AnnotationRepositoryConfigurationSource method parameter in order to properly handle and process @EnableGemfireRepositories mappingContextRef values.\nRefer to the comments in the gs-accessing-gemfire-data-rest Spring Getting Started Guide issue 1.", "project": "Spring", "sub_project": "SGF", "version": "1.6.2.RELEASE", "fixed_version": "1.7.2.RELEASE", "fixed_files": ["org.springframework.data.gemfire.repository.config.GemfireRepositoryConfigurationExtension.java"], "label": 1, "es_results": []}, {"bug_id": 449, "bug_title": "GemfireRepositoryFactoryBean.setGemfireMappingContext needs to call RepositoryFactoryBeanSupport.setMappingContext.", "bug_description": "Refer to the comments in the gs-accessing-gemfire-data-rest Spring Getting Started Guide issue 1.", "project": "Spring", "sub_project": "SGF", "version": "1.6.2.RELEASE", "fixed_version": "1.7.2.RELEASE", "fixed_files": ["org.springframework.data.gemfire.repository.support.GemfireRepositoryFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 474, "bug_title": "Fix the NPE in the MappingPdxSerializer", "bug_description": "When an Exception occurs in the Spring Data GemFire MappingPdxSerializer.fromData(..) method during normal processing and conversion from PDX back to the application domain object type, it is possible that the value may never have been initialized, thus causing a NullPointerException in the Exception handler, which then causes the original Exception to be eaten!", "project": "Spring", "sub_project": "SGF", "version": "1.6.2.RELEASE", "fixed_version": "1.7.5.RELEASE", "fixed_files": ["org.springframework.data.gemfire.mapping.MappingPdxSerializerUnitTests.java", "org.springframework.data.gemfire.mapping.MappingPdxSerializer.java", "org.springframework.data.gemfire.repository.sample.Person.java", "org.springframework.data.gemfire.mapping.MappingPdxSerializerIntegrationTest.java"], "label": 1, "es_results": []}, {"bug_id": 499, "bug_title": "Prevent SDG-defined Pools from being destroyed before the Regions that use them", "bug_description": "Currently, when a Spring configured, GemFire client cache application is shutdown, SDG does not prescribe an orderly shutdown between client Regions and client Pools possibly referred to by those Regions.  As a result, GemFire will throw an error when an attempt is made to close/destroy the Pool that a Region may currently be configured to use during shutdown of the Spring application context.\n\n\n\n\n\n\n11:34:44.957 WARN o.s.b.f.s.DisposableBeanAdapter - Invocation of destroy method failed on bean with name &apos;gemfirePool&apos;: java.lang.IllegalStateException: Pool could not be destroyed because it is still in use by 16 regions \n\n\n\n\n\n\nWhile the error is reported as a warning and is mostly benign (since it only happens during shutdown), more careful coordination between the Regions and their Pools should be considered.", "project": "Spring", "sub_project": "SGF", "version": "1.8.1.RELEASE", "fixed_version": "1.8.2.RELEASE", "fixed_files": ["org.springframework.data.gemfire.repository.config.GemfireRepositoryConfigurationExtension.java", "org.springframework.data.gemfire.RegionFactoryBean.java", "org.springframework.data.gemfire.repository.support.GemfireRepositoryFactoryBean.java", "org.springframework.data.gemfire.config.PoolParserTest.java", "org.springframework.data.gemfire.config.GemfireDataNamespaceHandler.java", "org.springframework.data.gemfire.client.ClientRegionFactoryBean.java", "org.springframework.data.gemfire.client.ClientCachePoolTests.java", "org.springframework.data.gemfire.config.PoolParser.java"], "label": 1, "es_results": []}, {"bug_id": 96, "bug_title": "FsShell.text throws exception when passed in a file URI", "bug_description": "", "project": "Spring", "sub_project": "SHDP", "version": "v1.0.0.M2", "fixed_version": "v1.0.0.RC1", "fixed_files": ["org.springframework.data.hadoop.fs.AbstractFsShellTest.java", "org.springframework.data.hadoop.fs.FsShell.java"], "label": 1, "es_results": []}, {"bug_id": 130, "bug_title": "DistributedCacheFactoryBean closes filesystem causing hadoop 2.x app to fail", "bug_description": "DistributedCacheFactoryBean in afterPropertiesSet creates and closes filsystem instance. because in hadoop 2 filesystem instance are singletons, further talking to hdfs is not possible.\nfix is simple: in DistributedCacheFactoryBean change line 117 to\n\tHdfsResourceLoader loader = new HdfsResourceLoader(fs);\nits regression from RC1, please fix it as soon as possible.", "project": "Spring", "sub_project": "SHDP", "version": "v1.0.0.RELEASE", "fixed_version": "v1.0.1.RELEASE", "fixed_files": ["org.springframework.data.hadoop.fs.DistributedCacheFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 181, "bug_title": "Add Spring 4.0 as an option for compile & test", "bug_description": "Add a build option -Dspring4 to allow compile and test against latest Spring 4.0 release", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.M1", "fixed_version": "v2.0.0.M2", "fixed_files": ["org.springframework.data.hadoop.scripting.ScriptingTest.java"], "label": 1, "es_results": []}, {"bug_id": 197, "bug_title": "File distribution fails with same client and localizer with multiple submits", "bug_description": "If same client and localizer is used to submit multiple app instances, localizer does distribution only once. This is a problem if we use staging dir and appmaster clears files at the end.", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.M1", "fixed_version": "v2.0.0.M2", "fixed_files": ["org.springframework.yarn.client.AbstractYarnClient.java", "org.springframework.yarn.fs.DefaultResourceLocalizer.java", "org.springframework.yarn.am.container.DefaultContainerLauncher.java"], "label": 1, "es_results": []}, {"bug_id": 247, "bug_title": "ConfigurationFactoryBean sets wrong rm address property", "bug_description": "internalConfig.set(\"yarn.resource.manager\", rmUri.trim()); is wrong, it should be yarn.resourcemanager.address. ", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.M4", "fixed_version": "v2.0.0.M5", "fixed_files": ["org.springframework.data.hadoop.configuration.ConfigurationFactoryBean.java", "org.springframework.data.hadoop.config.ConfigurationNamespaceTests.java"], "label": 1, "es_results": []}, {"bug_id": 246, "bug_title": "OutputStreamWriter Incorrect Logic in flush()", "bug_description": "\n\n\n\n\n\n\t@Override\n\n\n\n\n\tpublic void flush() throws IOException {\n\n\n\n\n\t\tif (streamsHolder == null) {\n\n\n\n\n\t\t\tstreamsHolder.getStream().flush();\n\n\n\n\n\t\t}\n\n\n\n\n\t}\n\n\n\n\n\n\nShould be streamsHolder != null.", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.M4", "fixed_version": "v2.0.0.M5", "fixed_files": ["org.springframework.data.hadoop.store.output.OutputStreamWriter.java"], "label": 1, "es_results": []}, {"bug_id": 269, "bug_title": "Update to Boot RC2", "bug_description": "There are some breaking changes which are causing compile errors. Nothing major, some boot classes has been moved/renamed, etc.", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.M5", "fixed_version": "v2.0.0.M6", "fixed_files": ["org.springframework.yarn.boot.support.YarnBootClientApplicationListener.java"], "label": 1, "es_results": []}, {"bug_id": 335, "bug_title": "NPE in TextFileWriter class", "bug_description": "There&apos;s an NPE in org.springframework.data.hadoop.store.output.TextFileWriter class in method flush. The condition should be (streamsHolder != null) and not (streamsHolder==null)\n@Override\n\tpublic synchronized  void flush() throws IOException {\n\t\tif (streamsHolder == null) \n{\n\t\t\tstreamsHolder.getStream().flush();\n\t\t}\n\t}", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.RC2", "fixed_version": "v2.0.0.RC3", "fixed_files": ["org.springframework.data.hadoop.store.output.TextFileWriter.java"], "label": 1, "es_results": []}, {"bug_id": 350, "bug_title": "HashMethodExecutor does not work with negative values ", "bug_description": "We should always get accurate partitioning by a bucket size. With java a simple modulo doesn&apos;t work with negative values so this needs to be adjusted accordingly.", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.RC4", "fixed_version": "v2.0.0.RELEASE", "fixed_files": ["org.springframework.data.hadoop.store.expression.HashMethodExecutor.java"], "label": 1, "es_results": []}, {"bug_id": 349, "bug_title": "YarnInfoApplication using wrong source", "bug_description": "YarnInfoApplication should add itself as source for SpringApplicationBuilder instead of YarnPushApplication. Currently doesn&apos;t break anything because from boot point of view those two are identical.", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.RC4", "fixed_version": "v2.0.0.RELEASE", "fixed_files": ["org.springframework.yarn.boot.app.YarnInfoApplication.java"], "label": 1, "es_results": []}, {"bug_id": 365, "bug_title": "Store writer should not fail on lifecycle", "bug_description": "OutputStoreObjectSupport is trying to initialize a state by listing output directory for existing files. This operation will fail if hdfs is not available and we would expect things to go south. Problem is that this happens during the bean lifecycle which is extremely inconvenient for user of this component.\nWe should not fail during the lifecycle start and then do any init work when hdfs is available. ", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.RELEASE", "fixed_version": "v2.0.2.RELEASE", "fixed_files": ["org.springframework.data.hadoop.store.support.OutputStoreObjectSupport.java", "org.springframework.data.hadoop.store.TextFileStoreTests.java"], "label": 1, "es_results": []}, {"bug_id": 373, "bug_title": "Test failure in MindIntegrationRawTests", "bug_description": "Random test failures somehow because by ports. There has been similar issues i.e. with SHDP-138 but these current problems only happen with CI builds.", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.RELEASE", "fixed_version": "v2.0.2.RELEASE", "fixed_files": ["org.springframework.yarn.integration.ip.mind.MindIntegrationRawTests.java"], "label": 1, "es_results": []}, {"bug_id": 394, "bug_title": "Cannot run mapreduce job in local mode", "bug_description": "I would like to run the mapreduce jobs without running any hadoop server or having HDFS to test them. So I use mapreduce.framework.name=local. Unfortunately the org.springframework.data.hadoop.mapreduce.JobUtils#getRunningJob sets this configuration like this:\n\n\n\n\n\n\n\t\t\t\tConfiguration cfg = job.getConfiguration();\n\n\n\n\n\t\t\t\tcfg.set(\"mapreduce.framework.name\", \"yarn\");\n\n\n\n\n\n\nI could override this while debugging and could run the job but can&apos;t do this from configuration. Can you tell me why is this here and can you remove it or make it configurable or tell me why should I not use local mode?\nI only tested this with 2.0.0-RELEASE but the code is there in version 2.1.0.M1 too.", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.RELEASE", "fixed_version": "v2.0.3.RELEASE", "fixed_files": ["org.springframework.data.hadoop.mapreduce.JobUtils.java"], "label": 1, "es_results": []}, {"bug_id": 356, "bug_title": "Remove unsupported lzo codecs.", "bug_description": "Docs are a little misleading for usage of LZO, SLZO, LZOP and SLZOP. Let Us just leave lzo there because additional split work by twitter is not truly split stream on codec level. Or at least they never implemented the SplittableCompressionCodec interface which makes is unusable outside of MR record reader.", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.0.RELEASE", "fixed_version": "v2.1.0.M3", "fixed_files": ["org.springframework.data.hadoop.store.codec.Codecs.java", "org.springframework.data.hadoop.store.TextFileStoreTests.java"], "label": 1, "es_results": []}, {"bug_id": 408, "bug_title": "DatasetTemplate does not close writer if exception is thrown", "bug_description": "If org.springframework.data.hadoop.store.dataset.DatasetTemplate.write(Collection) gets into trouble when underlying writer throws an exception, writer is not closed and dfs client lease is not cleared. Vanilla hadoop 2.5.1 and  cdh5(2.5.0-cdh5.2.0) barks this in logs.\n\n\n\n\n\n\n17:38:22,522  WARN      org.apache.hadoop.hdfs.LeaseRenewer: 458 - Failed to renew lease for [DFSClient_NONMAPREDUCE_-1719730779_11] for 30 seconds.  Will retry shortly ...\n\n\n\n\njava.net.ConnectException: Call From neo.localdomain/127.0.1.1 to localhost:39583 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused\n\n\n\n\n\n\nIn these tests minicluster has already been shutdown but dfs client background thread is still trying to renew a lease which will never going to happen. This can be seen i.e. using test org.springframework.data.hadoop.store.dataset.DatasetTemplateNoNullsTests.testWritePojoWithNullValuesShouldFail()", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.1.RELEASE", "fixed_version": "v2.0.3.RELEASE", "fixed_files": ["org.springframework.data.hadoop.store.dataset.DatasetTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 390, "bug_title": "Remote batch step exit code not updated", "bug_description": "When remote batch steps are executed on yarn containers, exit_code field is not updated in a database. As shown below exit_code is left to &apos;executing&apos; when is should &apos;completed&apos; or something else depending if step failed.\n\n\n\n\n\n\nSTEP_EXECUTION_ID  STEP_NAME               STATUS     EXIT_CODE\n\n\n\n\n-----------------  ----------------------  ---------  ---------\n\n\n\n\n                0  master1                 COMPLETED  COMPLETED\n\n\n\n\n                1  remoteStep1:partition1  COMPLETED  EXECUTING\n\n\n\n\n                2  remoteStep1:partition0  COMPLETED  EXECUTING\n\n\n\n\n                3  master2                 FAILED     FAILED\n\n\n\n\n                4  remoteStep2:partition1  FAILED     EXECUTING\n\n\n\n\n                5  remoteStep2:partition0  FAILED     EXECUTING\n\n\n\n\n                6  master                  COMPLETED  COMPLETED\n\n\n\n\n                7  remoteStep:partition0   COMPLETED  COMPLETED\n\n\n\n\n                8  remoteStep:partition1   COMPLETED  COMPLETED\n\n\n\n\n\n", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.2.RELEASE", "fixed_version": "v2.1.0.M1", "fixed_files": ["org.springframework.yarn.batch.repository.bindings.StepExecutionType.java", "org.springframework.yarn.batch.repository.JobRepositoryRpcFactory.java", "org.springframework.yarn.batch.partition.AbstractPartitionHandler.java", "org.springframework.yarn.batch.container.DefaultBatchYarnContainer.java"], "label": 1, "es_results": []}, {"bug_id": 423, "bug_title": "Partition writer does not clean resources", "bug_description": "AbstractPartitionDataStoreWriter keeps individual writers in a map which doesn&apos;t get cleared when writer closed by a timer. This is a problematic for long running partition writers with a lot of newly created partitions.", "project": "Spring", "sub_project": "SHDP", "version": "v2.0.3.RELEASE", "fixed_version": "v2.1.0.M2", "fixed_files": ["org.springframework.data.hadoop.store.output.AbstractPartitionDataStoreWriter.java", "org.springframework.data.hadoop.store.output.PartitionTextFileWriter.java", "org.springframework.data.hadoop.store.output.TextFileWriter.java", "org.springframework.data.hadoop.store.PartitionTextFileWriterTests.java"], "label": 1, "es_results": []}, {"bug_id": 430, "bug_title": "YarnContainerClusterMvcEndpoint registered twice", "bug_description": "It looks like we get YarnContainerClusterMvcEndpoint under `/yarn_containercluster` and `/yarn_containercluster/yarn_containercluster`. I think this is caused by @RequestMapping which I believe is not needed anymore in boot mvc endpoints and now causes this double.", "project": "Spring", "sub_project": "SHDP", "version": "v2.1.0.M2", "fixed_version": "v2.1.0.M3", "fixed_files": ["org.springframework.yarn.boot.actuate.endpoint.mvc.YarnContainerClusterMvcEndpointTests.java", "org.springframework.yarn.boot.actuate.endpoint.mvc.YarnContainerClusterMvcEndpoint.java", "org.springframework.yarn.boot.actuate.endpoint.mvc.YarnContainerClusterWithCustomProjectionsMvcEndpointTests.java"], "label": 1, "es_results": []}, {"bug_id": 447, "bug_title": "PartitionTextFileWriter does not stop TextFileWriter", "bug_description": "In `PartitionTextFileWriter.createWriter(Configuration, Path, CodecInfo)` we create anonymous TextFileWriter to override its `close()` method order to clear writers away from AbstractPartitionDataStoreWriter. However we don&apos;t shutdown `TextFileWriter` and thus its idle timeout task is kept running which later is causing trouble to clear correct writers away from partition writer.", "project": "Spring", "sub_project": "SHDP", "version": "v2.1.0.M2", "fixed_version": "v2.1.0.M3", "fixed_files": ["org.springframework.data.hadoop.store.output.PartitionTextFileWriterSmokeTests.java", "org.springframework.data.hadoop.store.output.PartitionTextFileWriter.java", "org.springframework.data.hadoop.store.output.TextFileWriter.java", "org.springframework.data.hadoop.store.support.OutputStoreObjectSupport.java"], "label": 1, "es_results": []}, {"bug_id": 460, "bug_title": "Fix typo in YarnPushCommand", "bug_description": "YarnPushCommand prints wrong info.\n\n\n\n\n\n\nhandleOutput(\"New instance submitted\");\n\n\n\n\n\n\nshould be something like `New application pushed\".", "project": "Spring", "sub_project": "SHDP", "version": "v2.1.0.M3", "fixed_version": "v2.1.0.RC1", "fixed_files": ["org.springframework.yarn.boot.cli.YarnPushCommand.java"], "label": 1, "es_results": []}, {"bug_id": 469, "bug_title": "DefaultYarnContainer should not exit without @YarnComponent", "bug_description": "DefaultYarnContainer is a default when run/configured via boot and is really expected to be used together with one or more @YarnComponent. Possible method return values are then used to send event which ContainerLauncherRunner catches and does a real context/app exit. However if no @YarnComponent methods are used, thus not results, container exists immediately which something we don&apos;t want or something user expects.\nWe should simple disable container end state processing if there are no @YarnComponent and thus there are no results. This is better expected functionality especially if container simply fires up rest methods and want to stay running. Order to exit gracefully from container user can still add @YarnComponent method and either sleep there or return Future and set return value later using a Future handle.", "project": "Spring", "sub_project": "SHDP", "version": "v2.1.0.RC1", "fixed_version": "v2.1.0.RELEASE", "fixed_files": ["org.springframework.yarn.container.DefaultYarnContainerTests.java", "org.springframework.yarn.container.DefaultYarnContainer.java"], "label": 1, "es_results": []}, {"bug_id": 482, "bug_title": "TextFileWriter unable to continue after close errors", "bug_description": "If we have a TextFileWriter with naming rollover and other normal settings we get into trouble if datanode dies or is restarted. ", "project": "Spring", "sub_project": "SHDP", "version": "v2.1.0.RELEASE", "fixed_version": "v2.1.1.RELEASE", "fixed_files": ["org.springframework.data.hadoop.store.output.TextFileWriter.java"], "label": 1, "es_results": []}, {"bug_id": 476, "bug_title": "Annotation config does not always use beans", "bug_description": "AbstractImportingAnnotationConfiguration is used to hook adapter model in cases where bean definition is created manually using an import selector. Looks like build command to processing framework happens too early and @Bean methods inside @Configuration are not yet created.\ni.e. in below example @Bean &apos;partitionStrategy&apos; ended up to be a different instance that the one returned by a to partitionStrategy() from a configure method.\n\n\n\n\n\n\n@Configuration\n\n\n\n\n@EnableDataStorePartitionTextWriter(name=WRITER5_ID)\n\n\n\n\nstatic class Config5 extends SpringDataStoreTextWriterConfigurerAdapter {\n\n\n\n\n\n\n\n\n\n\t@Override\n\n\n\n\n\tpublic void configure(DataStoreTextWriterConfigurer config) throws Exception {\n\n\n\n\n\t\tconfig\n\n\n\n\n\t\t\t.basePath(\"/tmp/foo4\")\n\n\n\n\n\t\t\t.withPartitionStrategy()\n\n\n\n\n\t\t\t\t.custom(partitionStrategy());\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n\t@Bean\n\n\n\n\n\tpublic PartitionStrategy<String, String> partitionStrategy() {\n\n\n\n\n\t\treturn new PartitionStrategy<String, String>() {\n\n\n\n\n\n\n\n\n\n\t\t\t@Override\n\n\n\n\n\t\t\tpublic PartitionResolver<String> getPartitionResolver() {\n\n\n\n\n\t\t\t\treturn null;\n\n\n\n\n\t\t\t}\n\n\n\n\n\n\n\n\n\n\t\t\t@Override\n\n\n\n\n\t\t\tpublic PartitionKeyResolver<String, String> getPartitionKeyResolver() {\n\n\n\n\n\t\t\t\treturn null;\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t};\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SHDP", "version": "v2.1.0.RELEASE", "fixed_version": "v2.1.1.RELEASE", "fixed_files": ["org.springframework.data.hadoop.config.common.annotation.AbstractImportingAnnotationConfiguration.java", "org.springframework.data.hadoop.store.config.annotation.configurers.DefaultRolloverStrategyConfigurer.java", "org.springframework.data.hadoop.store.config.annotation.builders.DataStoreTextWriterBuilder.java", "org.springframework.data.hadoop.store.config.annotation.SpringTextWriterConfigurationTests.java", "org.springframework.data.hadoop.store.config.annotation.SpringDataStoreWriterConfigs.java", "org.springframework.data.hadoop.store.config.annotation.configurers.DefaultNamingStrategyConfigurer.java", "org.springframework.data.hadoop.store.config.annotation.configuration.SpringDataStoreTextWriterConfiguration.java", "org.springframework.data.hadoop.store.config.annotation.builders.SpringDataStoreTextWriterBuilder.java", "org.springframework.data.hadoop.store.config.annotation.configurers.DefaultPartitionStrategyConfigurer.java"], "label": 1, "es_results": []}, {"bug_id": 515, "bug_title": "Support dots in yarn container group names", "bug_description": "If we have a group name `foo.jee`, request for `/yarn_containercluster/foo.jee` fails because on default Spring MVC bindings will remove `.jee` assuming it is a file delimiter.", "project": "Spring", "sub_project": "SHDP", "version": "v2.2.0.RELEASE", "fixed_version": "v2.3.0.M2", "fixed_files": ["org.springframework.yarn.boot.actuate.endpoint.mvc.YarnContainerClusterMvcEndpointTests.java", "org.springframework.yarn.boot.actuate.endpoint.mvc.YarnContainerClusterMvcEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 531, "bug_title": "AppmasterLauncherRunner can call exit() twice causing jvm to block", "bug_description": "Its possible for the AppmasterLauncherRunners.class to receive two appmaster state events when being used with StaticAppmaster. This causes System.exit to be called twice and is  causing the jvm to block indefinitely. From the jvm docs for Runtime.exit(),\n\"If this method is invoked after the virtual machine has begun its shutdown sequence then if shutdown hooks are being run this method will block indefinitely. If shutdown hooks have already been run and on-exit finalization has been enabled then this method halts the virtual machine with the given status code if the status is nonzero; otherwise, it blocks indefinitely.\nThe System.exit method is the conventional and convenient means of invoking this method.\"\nI get two of these lines in my logs, the second being the last entry.\nINFO [Thread-2]  CommandLineRunnerSupport: About to exit using code= 0", "project": "Spring", "sub_project": "SHDP", "version": "v2.3.0.RC1", "fixed_version": "v2.3.0.RC2", "fixed_files": ["org.springframework.yarn.boot.support.AppmasterLauncherRunner.java"], "label": 1, "es_results": []}, {"bug_id": 532, "bug_title": "Container cluster may start wrong member", "bug_description": "Defining two groups and starting only one may result first allocated container to get matched from a group which is not running, effectively starting a wrong container. Looks to be caused be a fact that grid projection is attached to projected grid when cluster is created thus allowing projection to get matched there.\nShould handle this so that attach doesn&apos;t happen until group is started.", "project": "Spring", "sub_project": "SHDP", "version": "v2.3.0.RC1", "fixed_version": "v2.3.0.RC2", "fixed_files": ["org.springframework.yarn.boot.actuate.endpoint.mvc.YarnContainerClusterMvcEndpointTests.java", "org.springframework.yarn.am.cluster.AbstractContainerClusterAppmaster.java", "org.springframework.yarn.am.cluster.ContainerClusterStateMachineConfiguration.java", "org.springframework.yarn.am.cluster.ManagedContainerClusterAppmasterMultiTests.java", "org.springframework.yarn.am.cluster.AbstractManagedContainerClusterAppmasterTests.java"], "label": 1, "es_results": []}, {"bug_id": 562, "bug_title": "Missing trailing slash on spring.yarn.applicationDir path fails to localize", "bug_description": "If the trailing slash is not included in the spring.yarn.applicationDir property then the relevant files are distributed to HDFS but they are not then localized to the appmaster/container.\nThere are two minor issues with this:\n\nThis could be automatically handled to allow the files to be localized correctly.\nThe only error is when launch_container.sh fails with Error: Unable to access jarfile, which does not help with identifying the issue.\n\n", "project": "Spring", "sub_project": "SHDP", "version": "v2.3.0.RELEASE", "fixed_version": "v2.4.0.RC1", "fixed_files": ["org.springframework.yarn.boot.support.SpringYarnBootUtils.java"], "label": 1, "es_results": []}, {"bug_id": 56, "bug_title": "SHL contains a lot of duplicated classes from Spring", "bug_description": "Based on the Spring Roo import, SHL ended up with a lot of utility classes coopied from Spring Framework (because Spring wasn&apos;t a dependency of Spring Roo).\nThis not only adds a lot of untested baggage but it also creates confusion between what class to use.\nSince the utility classes in Spring are maintained and provide the same functionality, a lot of the util classes can be safely removed.", "project": "Spring", "sub_project": "SHL", "version": "v1.0.0.M1", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.shell.samples.helloworld.commands.MyBannerProvider.java"], "label": 1, "es_results": []}, {"bug_id": 48, "bug_title": "Remove duplicated classes from Spring Framework and old Roo code base in util package", "bug_description": "There are many classes that were copied and pasted from Spring Framework placed into the &apos;util&apos; package, e.g. ObjectUtils, CollectionUtils, etc.  (Look for Juergen, Arjen, Rob, etc for author tags).\nAs we now depend on Spring there is no need for this duplication. ", "project": "Spring", "sub_project": "SHL", "version": "v1.0.0.M1", "fixed_version": "1.1.0.RC1", "fixed_files": ["org.springframework.shell.samples.helloworld.commands.MyBannerProvider.java"], "label": 1, "es_results": []}, {"bug_id": 153, "bug_title": "Date command should assume user localization.", "bug_description": "", "project": "Spring", "sub_project": "SHL", "version": "1.1.0.RELEASE", "fixed_version": "1.1.0.RC4", "fixed_files": ["org.springframework.shell.commands.DateCommands.java"], "label": 1, "es_results": []}, {"bug_id": 187, "bug_title": "Build and Test fail on Windows", "bug_description": "Attempt to compile results in numerous errors of the following form:\n\n\n\n\n\n\nX:\\git\\spring-she will\\src\\main\\java\\org\\springframework\\she will\\table\\BorderStyle.java:43: error: unmappable character for encoding Cp1252\n\n\n\n\n        fancy_heavy(&apos;&apos;, &apos;?&apos;),\n\n\n\n\n                              ^\n\n\n\n\n...\n\n\n\n\n\n\nAfter fixing this, ran into test failures:\n\n\n\n\n\n\n:test\n\n\n\n\n\n\n\n\n\norg.springframework.she will.table.BorderFactoryTest > testFullBorder FAILED\n\n\n\n\n    java.lang.AssertionError at BorderFactoryTest.java:47\n\n\n\n\n...\n\n\n\n\n\n\nBoth of these are result of presence of Unicode characters that are not supported by Windows&apos; default encoding (CP1252).", "project": "Spring", "sub_project": "SHL", "version": "v1.2.0.M1", "fixed_version": "v1.2.0.RC1", "fixed_files": ["org.springframework.shell.table.AbstractTestWithSample.java"], "label": 1, "es_results": []}, {"bug_id": 52, "bug_title": "TwitterTemplate does not work with other Locale than Locale.ENGLISH", "bug_description": "The creation date of a Tweet is build up with the Dateformat: EEE, d MMM yyyy HH:mm:ss Z\nSee in TwitterTemplate:209\n\n\n\n\n\n\nprivate DateFormat dateFormat = new SimpleDateFormat(\"EEE, d MMM yyyy HH:mm:ss Z\");\n\n\n\n\n\n\n\n\n\nprivate Date toDate(String dateString) {\n\n\n\n\n\ttry {\n\n\n\n\n\t     return dateFormat.parse(dateString);\n\n\n\n\n\t} catch (ParseException e) {\n\n\n\n\n             return null;\n\n\n\n\n\t}\n\n\n\n\n}\n\n\n\n\n\n\nSo a date String is for example:\nTue, 16 Nov 2010 10:32:32 +0000\nBecause of the english abbreviation for Tuesday this only works with the english Locale.\nIn all other cases every Tweet has null as his creation date\nA possible but not realistic workaround is to alter the default Locale:\n\n\n\n\n\n\n \n\n\n\n\nLocale.setDefault(Locale.ENGLISH);\n\n\n\n\n\n", "project": "Spring", "sub_project": "SOCIAL", "version": "v1.0.0.M1", "fixed_version": "v1.0.0.M2", "fixed_files": ["org.springframework.social.twitter.TwitterTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 224, "bug_title": "ConnectController caches displayed pages", "bug_description": "The connect controler caches the generated pages based on whatever settings the environment has. It should add no cache headers to prevent caching.", "project": "Spring", "sub_project": "SOCIAL", "version": "v1.0.0.RC1", "fixed_version": "v1.0.0.RC2", "fixed_files": ["org.springframework.social.connect.web.ConnectController.java"], "label": 1, "es_results": []}, {"bug_id": 258, "bug_title": "ConnectController should consider servlet path (if available) when performing redirect.", "bug_description": "So that an application can change the DispatcherServlet path, connectionStatusRedirect() should use the servlet path (if available) when performing the redirect.", "project": "Spring", "sub_project": "SOCIAL", "version": "v1.0.0.RELEASE", "fixed_version": "v1.0.1.RELEASE", "fixed_files": ["org.springframework.social.connect.web.ConnectController.java"], "label": 1, "es_results": []}, {"bug_id": 273, "bug_title": "wrong method definition in documentation", "bug_description": "Spring social 1.0.0.RELEASE documentation at:\nhttp://static.springsource.org/spring-social/docs/1.0.x/reference/html/signin.html\nThere is a wrong return value specified for method:\nvoid signIn(String userId, Connection<?> connection, NativeWebRequest request);\nIt should be:\nString signIn(String userId, Connection<?> connection, NativeWebRequest request);\n", "project": "Spring", "sub_project": "SOCIAL", "version": "v1.0.0.RELEASE", "fixed_version": "v1.0.1.RELEASE", "fixed_files": ["org.springframework.social.oauth2.OAuth2Version.java"], "label": 1, "es_results": []}, {"bug_id": 283, "bug_title": "JdbcConnectionRepository#findConnectionToUsers potential NPE on access", "bug_description": "If, for whatever reason, the providerUsers parameter is null, then a NPE is guaranteed to happen in the line doing the check.  \n\t\tif (providerUsers.isEmpty()) \n{\n\t\t\tthrow new IllegalArgumentException(\"Unable to execute find: no providerUsers provided\");\n\t\t}\n\nA better way would be to guard like the following\nif(providerUser == null || providerUsers.isEmpty()) {\n  ...\n}\n", "project": "Spring", "sub_project": "SOCIAL", "version": "v1.0.1.RELEASE", "fixed_version": "v1.0.2.RELEASE", "fixed_files": ["org.springframework.social.connect.jdbc.JdbcConnectionRepository.java"], "label": 1, "es_results": []}, {"bug_id": 282, "bug_title": "Profile Requested 4 times in login", "bug_description": "The is a bug in the org.springframework.social.connect.support.AbstractConnection class in the sign-in process the valuesInitialized flag is not set.\nCalling the following methods getDisplayName(), getProfileUrl() and getImageUrl() get the profile from facebook every time instead of using the data already set on the class. If the setValues() method is called is should check if the valuesInitialized flag is set, if not call the apiAdapter, else just return a new new values object.\nAt present the login for me takes around 12 seconds if the repeated calls to retrieve the profile can be eliminated it should be around 5 seconds.\nThanks\nGraham", "project": "Spring", "sub_project": "SOCIAL", "version": "v1.0.1.RELEASE", "fixed_version": "v1.0.2.RELEASE", "fixed_files": ["org.springframework.social.connect.support.AbstractConnection.java"], "label": 1, "es_results": []}, {"bug_id": 318, "bug_title": "Cannot find the JdbcMultiUserConnectionRepository.sql mentioned in javadoc for JdbcUsersConnectionRepository", "bug_description": "The version is 1.1.0-BUILD-SNAPSHOT.\nI think it&apos;s just a javadoc bug - shouldn&apos;t it say JdbcUsersConnectionRepository.sql instead?", "project": "Spring", "sub_project": "SOCIAL", "version": "v1.0.2.RELEASE", "fixed_version": "v1.1.0.M1", "fixed_files": ["org.springframework.social.connect.jdbc.JdbcUsersConnectionRepository.java"], "label": 1, "es_results": []}, {"bug_id": 426, "bug_title": "APIException alternate constructor, provider id is not being set", "bug_description": "When an UncategorizedApiException is constructed, the provider ID is never set.\n\n\n\n\n\n\npublic ApiException(String providerId, String message) {\n\n\n\n\n    super(message);\n\n\n\n\n    this.providerId = providerId;\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\npublic ApiException(String providerId, String message, Throwable because) {\n\n\n\n\n    super(message, because);\n\n\n\n\n}\n\n\n\n\n\n\nCan be simplified and fixed:\n\n\n\n\n\n\npublic ApiException(String providerId, String message) {\n\n\n\n\n    this(providerId, message, null);\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\npublic ApiException(String providerId, String message, Throwable because) {\n\n\n\n\n    super(message, because);\n\n\n\n\n    this.providerId = providerId;\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SOCIAL", "version": "v1.1.0.RC1", "fixed_version": "v1.1.0.RELEASE", "fixed_files": ["org.springframework.social.ApiException.java"], "label": 1, "es_results": []}, {"bug_id": 427, "bug_title": "getProviderIdFromRequest leads to redirectloops", "bug_description": "So, I finally figureg out why my site often experiences redirect loops on authentication problems. Spring Social passes as providerId google/ in stead of google. This is because of the hackish way in which the providerId is extracted from the url getProviderIdFromRequest. \nAnd it&apos;s a private method. So, I can&apos;t fix this by overriding the method\n", "project": "Spring", "sub_project": "SOCIAL", "version": "v1.1.0.RC1", "fixed_version": "v1.1.0.RELEASE", "fixed_files": ["org.springframework.social.connect.web.ReconnectFilter.java"], "label": 1, "es_results": []}, {"bug_id": 409, "bug_title": "ReconnectFilter does not redirect to correct URL", "bug_description": "ReconnectFilter does not perform redirection correctly in case of expired token. See thread on Stack Overflow for details and proposed code change: http://stackoverflow.com/questions/21188573/how-to-handle-expiredauthorizationexception-happening-in-spring-social-facebook", "project": "Spring", "sub_project": "SOCIAL", "version": "v1.1.0.M4", "fixed_version": "v1.1.0.RELEASE", "fixed_files": ["org.springframework.social.connect.support.OAuth2Connection.java"], "label": 1, "es_results": []}, {"bug_id": 432, "bug_title": "non pointer exception on set applicationUrl on ProviderSignInController", "bug_description": "In the past, we initialized connection support at declaration in the ProviderSignInController.\nprivate final ConnectSupport webSupport = new ConnectSupport();\nit works fine while I am setting properties on the providerSignInController.\ne.g.\npublic void setApplicationUrl(String applicationUrl) {\n\t\twebSupport.setApplicationUrl(applicationUrl);\n}\nNow, we initialize connection support at\n\t// From InitializingBean\n\tpublic void afterPropertiesSet() throws Exception \n{\n\t\tthis.connectSupport = new ConnectSupport(sessionStrategy);\n\t\tthis.connectSupport.setUseAuthenticateUrl(true);\n\t}\n;\nI got null object on this.connectSupport while setting the properties:\npublic void setApplicationUrl(String applicationUrl) {\n\t\twebSupport.setApplicationUrl(applicationUrl);\n}", "project": "Spring", "sub_project": "SOCIAL", "version": "v1.1.0.RC1", "fixed_version": "1.1.1.RELEASE", "fixed_files": ["org.springframework.social.connect.web.ConnectController.java", "org.springframework.social.connect.web.ConnectControllerTest.java", "org.springframework.social.connect.web.ProviderSignInController.java", "org.springframework.social.connect.web.ProviderSignInControllerTest.java"], "label": 1, "es_results": []}, {"bug_id": 33, "bug_title": "NPE when FB sends back data for likes instead of count", "bug_description": "Sometimes Facebook sends back a count for the number of people who have \"liked\" a post and sometimes they send back data containing references to those people who liked the post. Currently, PostMixin is written to assume that it will receive the count and will fail when it receives reference data. This should be written to more gracefully handle either situation.", "project": "Spring", "sub_project": "SOCIALFB", "version": "v1.0.0.RELEASE", "fixed_version": "v1.0.1.RELEASE", "fixed_files": ["org.springframework.social.facebook.api.impl.json.PostMixin.java"], "label": 1, "es_results": []}, {"bug_id": 42, "bug_title": "FacebookErrorHandler will be handle 404 Not Found Error as org.springframework.social.ResourceNotFoundException.", "bug_description": "as you know, org.springframework.social.facebook.api.impl.FacebookErrorHandler doesn&apos;t handle there 404 Not found error.\nthey (404 not found error) still handle by handleUncategorizedError (DefaultResponseErrorHandler.handleError detect and make HttpClientErrorException, and FacebookErrorHandler caught all of exception & translate to UncategorizedApiException)\nit&apos;s harmful if you using spring-social-facebook on your project.\n(that&apos; why i catch UncategorizedApiException and check that&apos;s rootCause is instanceof HttpClientErrorException, and another check HttpStatus is equal to HttpStatus.NOT_FOUND (404), then finally i can do what i want.)\nand there org.springframework.social.SocialException hierarchy still there. (and i want 404 Not Found Error translate to org.springframework.social.ResourceNotFoundException. no more Uncategorized Exception)", "project": "Spring", "sub_project": "SOCIALFB", "version": "v1.0.0.RELEASE", "fixed_version": "1.1.0.M1", "fixed_files": ["org.springframework.social.facebook.api.impl.FacebookErrorHandler.java", "org.springframework.social.facebook.api.ErrorHandlingTest.java"], "label": 1, "es_results": []}, {"bug_id": 80, "bug_title": "OperationNotPermittedException thrown when an InsufficientPermissionException should have been thrown.", "bug_description": "Facebook has recently started improving its errors from the Graph API. This is a good thing (the existing errors left much to be desired). However, the side effect of this is that FacebookErrorHandler may now throw the wrong exception in some cases.\nOne such case is when the user has not authorized an application to post to their feed and a post is attempted. An InsufficientPermissionException is expected, but instead an OperationNotPermittedException is thrown. \nThis issue addresses this specific case. A separate task will be created for reviewing Facebook&apos;s new errors and updating FacebookErrorHandler appropriately for all cases.", "project": "Spring", "sub_project": "SOCIALFB", "version": "v1.0.0.RELEASE", "fixed_version": "1.1.0.M1", "fixed_files": ["org.springframework.social.facebook.api.impl.FacebookErrorHandler.java", "org.springframework.social.facebook.api.ErrorHandlingTest.java"], "label": 1, "es_results": []}, {"bug_id": 92, "bug_title": "Changes to page pictures property will break API binding", "bug_description": "On 10/3/2012 the Facebook API will be changed such that the pictures property on page objects will no longer be a string, but will instead be an object. This will break the existing API binding when trying to deserialize the picture property. In mid-August 2012, Facebook applied this breaking change, but apps can be reconfigured (temporarily) to opt out of the change.\nSee https://developers.facebook.com/roadmap/#october-2012 for details.\nThe Spring Social Facebook API binding should be fixed to address this change in time for the October 3rd change. ", "project": "Spring", "sub_project": "SOCIALFB", "version": "v1.0.1.RELEASE", "fixed_version": "1.0.2.RELEASE", "fixed_files": ["org.springframework.social.facebook.api.impl.json.PageMixin.java", "org.springframework.social.facebook.api.impl.json.VideoMixin.java", "org.springframework.social.facebook.api.MediaTemplateTest.java", "org.springframework.social.facebook.api.Video.java", "org.springframework.social.facebook.api.Photo.java", "org.springframework.social.facebook.api.impl.json.PostMixin.java", "org.springframework.social.facebook.api.FeedTemplateTest.java", "org.springframework.social.facebook.api.Post.java", "org.springframework.social.facebook.api.impl.json.PhotoMixin.java", "org.springframework.social.facebook.api.LikeTemplateTest.java", "org.springframework.social.facebook.api.Page.java"], "label": 1, "es_results": []}, {"bug_id": 97, "bug_title": "FacebookTemplate.initialize() is called twice if constructing with accessToken only.", "bug_description": "public FacebookTemplate(String accessToken) {\n\tthis(accessToken, null);\n\tinitialize();\n}\nomit initialize() call as it is already called by FacebookTemplate(accessToken, applicationNamespace)", "project": "Spring", "sub_project": "SOCIALFB", "version": "v1.1.0.RELEASE", "fixed_version": "1.1.0.M1", "fixed_files": ["org.springframework.social.facebook.api.impl.FacebookTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 128, "bug_title": "Error 405 using CanvasSignInController", "bug_description": "Error 405 is encountered using CanvasSignInController. Steps to reproduce are below - \n1. Log out of Facebook\n2. Close Browser\n3. Go to http://apps.facebook.com/springsocialcanvas/\n4. Enter user credential\n5. Error is recreated", "project": "Spring", "sub_project": "SOCIALFB", "version": "v1.1.0.M2", "fixed_version": "v1.1.0.M4", "fixed_files": ["org.springframework.social.facebook.web.CanvasSignInController.java"], "label": 1, "es_results": []}, {"bug_id": 141, "bug_title": "LikeOperations.getPagesLiked does not get cover obj and link", "bug_description": "I tested directly the fb graph api explorer and got the full information. In the Java LikesOPerations call I get all the information less the cover object (id, image url, offsetx, offsety) and the link of the link\nApparently the permissions are the same in the graph api explorer and the fb connect (user_likes,friends_likes,publish_stream,user_photos,offline_access,friends_birthday,friends_location,read_friendlists)\nGET me/friends?fields=likes.fields(link,name,website,cover),name,link&limit=5", "project": "Spring", "sub_project": "SOCIALFB", "version": "v1.1.0.M4", "fixed_version": "v1.1.0.RELEASE", "fixed_files": ["org.springframework.social.facebook.api.LikeTemplateTest.java", "org.springframework.social.facebook.api.impl.LikeTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 138, "bug_title": "Jackson Map Exception on checkinposts", "bug_description": "Some checkins do not provide a complete location mapping, only a String telling the location. \nI suggest adding a location deserializer like this:\n\t@Override\n\tpublic Location deserialize(JsonParser jp, DeserializationContext ctxt) throws IOException, JsonProcessingException {\n\t\ttry\n{\n\t\t\tLocation node = jp.readValueAs(Location.class);\n\t\t\treturn node;\n\t\t}\ncatch (Exception e)\n{\n\t\t\tLocation location = new Location(jp.getText());\n\t\t\treturn null;\n\t\t}\n\t}", "project": "Spring", "sub_project": "SOCIALFB", "version": "v1.1.0.M4", "fixed_version": "v1.1.0.RC1", "fixed_files": ["org.springframework.social.facebook.api.impl.json.PageMixin.java", "org.springframework.social.facebook.api.PlacesTemplateTest.java", "org.springframework.social.facebook.api.Location.java"], "label": 1, "es_results": []}, {"bug_id": 168, "bug_title": "PagingParameters must use paging token", "bug_description": "When fetching the posts of a page, the response from facebook contains the paging links \"next\" and \"previous\". Those will have a \"until\" or \"since\" parameter and additionally a parameter \"__paging_token\"\nThe PagingParameters implementation ignores the paging token, but with only \"until\" the last post from the previous page is returned as first item of the next page.\nUntil seems to be the time of the last post on the previous page.\nAnd of course there might be more than one post at this time, so facebook returns all posts starting with this time. The paging token seems to add additional information for facebook so that the next page will start really at the next post.\nExample call...\nfacebook.feedOperations().getPosts(facebookPageId, new PagingParameters(10, 0, null, null));\nExample next link returned from facebook:\nhttps://graph.facebook.com/v1.0/1234567890/posts?limit=10&until=1402415239&__paging_token=enc_Aew9rTpQB8B9zCX9BYus-GhWKOtQzhoiKlV9vpk7D4y-QgcEoCH09rNOydIOOr76wGbTxX-2pV9tMf__6bjs2_DqGcBLFDirt315VXS6_zgG7N", "project": "Spring", "sub_project": "SOCIALFB", "version": "v1.1.0.RELEASE", "fixed_version": "v2.0.0.RC1", "fixed_files": ["org.springframework.social.facebook.api.PagingParameters.java", "org.springframework.social.facebook.api.impl.FeedTemplate.java", "org.springframework.social.facebook.api.impl.PagedListUtils.java"], "label": 1, "es_results": []}, {"bug_id": 165, "bug_title": "In Spring soical facebook 2.0.0.M release, though i set the birthdate in facebook and get the age range using the spring social Facebook api it returns only UNKNOW value", "bug_description": "FacebookProfile prof=con.getApi().userOperations().getUserProfile();\nSystem.out.println(prof.getAgeRange().toString());\nResult:\nThe above output generates UNKNOWN as its value, though we set up the birthdate field in facebook.", "project": "Spring", "sub_project": "SOCIALFB", "version": "v2.0.0.M1", "fixed_version": "v2.0.0.RC1", "fixed_files": ["org.springframework.social.facebook.api.UserTemplateTest.java", "org.springframework.social.facebook.api.UserOperations.java", "org.springframework.social.facebook.api.impl.UserTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 169, "bug_title": "Add updated_time property to UserOperations.PROFILE_FIELDS", "bug_description": "", "project": "Spring", "sub_project": "SOCIALFB", "version": "v2.0.0.M1", "fixed_version": "v2.0.0.RC1", "fixed_files": ["org.springframework.social.facebook.api.UserOperations.java"], "label": 1, "es_results": []}, {"bug_id": 189, "bug_title": "Error deserializing null into primitives when using Jackson 2.6", "bug_description": "Prior to Jackson 2.6 custom deserializers apparently weren&apos;t even used if the field to be deserialized was null...consequently, they would remain at the default value. An int, for example, would be left as 0.\nStarting with Jackson 2.6, the custom deserializer will be used even if the field is null, resulting in a NPE attempting to deserialize null into a non-nullable primitive.\nThis can be fixed by overriding the getNullValue() method in any custom deserializers such as AchievementPointsDeserializer. ", "project": "Spring", "sub_project": "SOCIALFB", "version": "v2.0.1.RELEASE", "fixed_version": "v2.0.2.RELEASE", "fixed_files": ["org.springframework.social.facebook.api.impl.json.PostMixin.java", "org.springframework.social.facebook.api.impl.json.AchievementTypeMixin.java"], "label": 1, "es_results": []}, {"bug_id": 14, "bug_title": "People search URI malformed causes LinkedIn to response with 400 Bad Request Error", "bug_description": "URI for HTTP GET request for people search on LinkedIn REST API is badly formed.\nIt adds a & sign before keywords field and adds one extra & sign after the values that causes the 400 Bad Request Error response from LinkedIn ", "project": "Spring", "sub_project": "SOCIALLI", "version": "v1.0.0.M4", "fixed_version": "v1.0.0.M5", "fixed_files": ["org.springframework.social.linkedin.api.impl.AbstractTemplate.java", "org.springframework.social.linkedin.api.impl.ProfileTemplate.java", "org.springframework.social.linkedin.api.impl.NetworkUpdateTemplateTest.java", "org.springframework.social.linkedin.api.SearchParameters.java", "org.springframework.social.linkedin.api.impl.NetworkUpdateTemplate.java", "org.springframework.social.linkedin.api.impl.ProfileTemplateTest.java", "org.springframework.social.linkedin.api.impl.JobTemplateTest.java"], "label": 1, "es_results": []}, {"bug_id": 21, "bug_title": "NetworkUpdateOperations.createNetworkUpdate uses wrong HTTP request method", "bug_description": "NetworkUpdateTemplate.createNetworkUpdate uses PUT while LinkedIn requires a POST request for this kind of operation causing error \"405 Method Not Allowed\". (see post-network-update)\n", "project": "Spring", "sub_project": "SOCIALLI", "version": "v1.0.0.RC1", "fixed_version": "v1.0.0.RC2", "fixed_files": ["org.springframework.social.linkedin.api.impl.NetworkUpdateTemplateTest.java"], "label": 1, "es_results": []}, {"bug_id": 31, "bug_title": "Error in JSON mapping when call to network updates", "bug_description": "In network updates the field likable is mapped with LinkedInNetworkUpdateMixin, but the property has an typing error. \nThe correct way is \"likable\" but the property is typed \"likeable\".", "project": "Spring", "sub_project": "SOCIALLI", "version": "v1.0.0.RC2", "fixed_version": "v1.0.0.RELEASE", "fixed_files": ["org.springframework.social.linkedin.api.impl.json.LinkedInNetworkUpdateMixin.java", "org.springframework.social.linkedin.api.impl.AbstractLinkedInApiTest.java", "org.springframework.social.linkedin.api.impl.NetworkUpdateTemplateTest.java"], "label": 1, "es_results": []}, {"bug_id": 33, "bug_title": "Error while performing commentOnNetworkUpdate", "bug_description": "Getting an HTTP 405 when called commentOnNetworkUpdate.", "project": "Spring", "sub_project": "SOCIALLI", "version": "v1.0.0.RC3", "fixed_version": "v1.0.0.RELEASE", "fixed_files": ["org.springframework.social.linkedin.api.impl.NetworkUpdateTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 14, "bug_title": "Daily trends date format incorrect", "bug_description": "Twitter recently changed the date format in the JSON returned for the /trends/daily endpoint from \"yyyy-MM-dd HH:mm:ss\" to \"yyyy-MM-dd HH:mm\". This causes the date to not be parsed correctly and ultimately in a NullPointerException when calling searchOperations().getDailyTrends().\nChanging the format to \"yyyy-MM-dd HH:mm\" will fix this.", "project": "Spring", "sub_project": "SOCIALTW", "version": "v1.0.0.RELEASE", "fixed_version": "v1.0.1.RELEASE", "fixed_files": ["org.springframework.social.twitter.api.impl.DailyTrendsList.java"], "label": 1, "es_results": []}, {"bug_id": 27, "bug_title": "RateLimitExceededException not thrown when user hit's their daily status update limit. ", "bug_description": "I&apos;ve discovered TwitterErrorHandler does not handle when the user has exceeded their daily status update limit (or part thereof) as determined by Twitter. Whenever a HttpStatus.FORBIDDEN status code is returned; duplicate status; status too long; and invalid recipient are checked before throwing a general OperationNotPermittedException. However the text \"User is over daily status update limit\" is not checked which should result in a RateLimitExceeded exception being thrown. \nAdding this exception would make it consistent with the spring-social-facebook. ", "project": "Spring", "sub_project": "SOCIALTW", "version": "v1.0.1.RELEASE", "fixed_version": "v1.0.2.RELEASE", "fixed_files": ["org.springframework.social.twitter.api.impl.TwitterErrorHandler.java", "org.springframework.social.twitter.api.impl.ApiErrorTest.java"], "label": 1, "es_results": []}, {"bug_id": 57, "bug_title": "TwitterErrorHandler does not detect 401 from streaming API", "bug_description": "Using TwitterTemplate to invoke the streaming API, if I deliberately get a 401, it isn&apos;t handled by TwitterErrorHandler. The extractErrorDetailsFromResponse method returns null, so the handleClientErrors method returns immediately. The result is a UncategorizedApiException, whereas a NotAuthorizedException would be preferable.", "project": "Spring", "sub_project": "SOCIALTW", "version": "v1.0.5.RELEASE", "fixed_version": "v1.1.0.M3", "fixed_files": ["org.springframework.social.twitter.api.impl.TwitterErrorHandler.java", "org.springframework.social.twitter.api.impl.ApiErrorTest.java"], "label": 1, "es_results": []}, {"bug_id": 58, "bug_title": "Posting a status with a star symbol (*) fails authentication", "bug_description": "Any attempt to call timelineOperations().updateStatus with a star symbol in the message fails with a NotAuthorizedException.  Exception message is \"Could not authenticate you\".\nI suspect the problem is in the oauth signature when a * exists in the additionalParameters map, but I don&apos;t know enough about OAuth to figure out a fix.\nExample failing message: \"* Test\"", "project": "Spring", "sub_project": "SOCIALTW", "version": "v1.0.5.RELEASE", "fixed_version": "v1.1.0.M4", "fixed_files": ["org.springframework.social.twitter.api.impl.TimelineTemplateTest.java", "org.springframework.social.twitter.api.impl.TwitterTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 64, "bug_title": "page size for searching users does not work", "bug_description": "page size for searching users doesn&apos;t work , it always queries 20 entities regardless of the parameter. The problem is spring social twitter api execute the url \"https://api.twitter.com/1.1/users/search.json?page=1&per_page=1&q=text\"\nbut the twitter url that should be executed is : \"https://api.twitter.com/1.1/users/search.json?count=3&page=1&q=text\". The problem is in the class UserTemplate.java the method - \"public List<TwitterProfile> searchForUsers(String query, int page, int pageSize)\" calls the method in \"PagingUtils PagingUtils.buildPagingParametersWithPerPage(...)\". It should call the method \n\"PagingUtils.buildPagingParametersWithCount (...)\".", "project": "Spring", "sub_project": "SOCIALTW", "version": "v1.1.0.M3", "fixed_version": "v1.1.0.M4", "fixed_files": ["org.springframework.social.twitter.api.impl.UserTemplate.java", "org.springframework.social.twitter.api.impl.PagingUtils.java", "org.springframework.social.twitter.api.impl.UserTemplateTest.java"], "label": 1, "es_results": []}, {"bug_id": 71, "bug_title": "TwitterEscapingFormHttpMessageConverter corrupting images", "bug_description": "Since 1.1.0.M4 updateStatus with media results in an corrupted image.\nThe normal FormHttpMessageConverter works fine. ", "project": "Spring", "sub_project": "SOCIALTW", "version": "v1.1.0.M4", "fixed_version": "v1.1.0.RC1", "fixed_files": ["org.springframework.social.twitter.api.impl.TwitterEscapingFormHttpMessageConverter.java"], "label": 1, "es_results": []}, {"bug_id": 5406, "bug_title": "Make Tiles 2 easier to configure in Spring MVC", "bug_description": "Simple thing we can do:\n\nProvide a TilesViewResolver subclass of UrlBasedViewResolver that configures the viewClass to be TilesView as a convenience\n\nFirst noticed this when explaining configuring you need to configure a URL resolver for Tiles view proved quite complex.  It&apos;s simpler to just say configure a Tiles view resolver.", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.M1", "fixed_version": "v3.0.0.M4", "fixed_files": ["org.springframework.core.io.ResourceEditorTests.java", "org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.java", "org.springframework.beans.factory.xml.XmlBeanDefinitionReaderTests.java"], "label": 1, "es_results": []}, {"bug_id": 5924, "bug_title": "REOPENED -PathVariable mappings are greedy over hard coded mappings", "bug_description": "Hard coded request mapping values should take precedence over path variables.  Wild card patterns in a path are currently inferior to explicit values.  Path variables should be applied after explicit paths and before wild cards.\nFor example:\n@RequestMapping(value = \"/resources/new/\", method = RequestMethod.GET)\nis currently trumped by\n@RequestMapping(value = \"/resources/\n{resourceName}/\", method = RequestMethod.GET)\n\n@RequestMapping(value = \"/resources/new/\", method = RequestMethod.GET)\ncurrently trumps\n@RequestMapping(value = \"/resources/*/\", method = RequestMethod.GET)\n\n\n@RequestMapping(value = \"/resources/new/\", method = RequestMethod.GET)\nshould trump\n@RequestMapping(value = \"/resources/{resourceName}\n/\", method = RequestMethod.GET)\nshould trump\n@RequestMapping(value = \"/resources/*/\", method = RequestMethod.GET)", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.M1", "fixed_version": "v3.0.0.M4", "fixed_files": ["org.springframework.util.AntPathMatcher.java", "org.springframework.util.AntPathMatcherTests.java"], "label": 1, "es_results": []}, {"bug_id": 6093, "bug_title": "MVC Annotation Inheritance", "bug_description": "I currently run a patched M4 build to work around problems with @ExceptionHandler methods (and @ResponseStatus on them) not functioning with overridden methods (in my case it&apos;s due to @Transactional CGlib proxies). While patching these issues, I also changed handling of some other annotations which were being queried using Method.getAnnotation/Method.isAnnotationPresent as opposed to AnnotationUtils.findAnnotation.\nI have attached my patch as a starting point. I believe I found all instances where AnnotationUtils.findAnnotation was not being used and fixed them. However, I only updated the tests for AnnotationMethodHandlerExceptionResolver. I did not feel confident with the amount of time I had to update the tests for AnnotationMethodHandlerAdapter.\nI think these changes are in line with a recent checkin (revision 1852) related to inheritance of JMX annotations (SPR-3635 SPR-5039 and SPR-5813).\n", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.M4", "fixed_version": "v3.0.0.RC1", "fixed_files": ["org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerExceptionResolverTests.java", "org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.java", "org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerExceptionResolver.java"], "label": 1, "es_results": []}, {"bug_id": 6366, "bug_title": "Cannot import bean definitions using classpath*: resource location", "bug_description": "Cannot import bean definitions using classpath*: resource location. Somewhere between RC1 and RC2 the behaviour of <import resource=\"classpath*:...\"/> changed so that it is now treated as a relative resource, where clearly it is not.", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.RC2", "fixed_version": "v3.0.0.RC3", "fixed_files": ["org.springframework.core.io.ResourceEditorTests.java", "org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.java", "org.springframework.beans.factory.xml.XmlBeanDefinitionReaderTests.java"], "label": 1, "es_results": []}, {"bug_id": 6378, "bug_title": "RC2: Issue with RequestMethod.GET differs from M2", "bug_description": "I have a demo for Spring 3 Web that I&apos;ve been running for some time... the upgrade to RC2 broke the demo.  The code is listed below.  What we need is details on the order of requestmappings... I thought I saw that earlier this year in the forums, but I can&apos;t find it anymore.  Can someone please provide the details on the order of requestmappings... thanks.\nThe code below (which worked before) now fails for a GET request against the list method or http://localhost:8080/mvc/book/list\nI had specified the GET and POST for clarification before on the create methods... after some investigation, I discovered that if I remove the method = RequestMethod.GET on the create method that the app begins to work.  So I can work around this.  What behavior should be expected?\n\n\n\n\n\n\n@Controller\n\n\n\n\npublic class BookController {\n\n\n\n\n\n\n\n\n\n    @Autowired\n\n\n\n\n    BookDAO dao;\n\n\n\n\n\n\n\n\n\n    // http://localhost:8080/mvc/book/list\n\n\n\n\n    @RequestMapping(\"list\")\n\n\n\n\n    public List<Book> list() {\n\n\n\n\n        return dao.findAllBooks();\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    // http://localhost:8080/mvc/book/book?id=12\n\n\n\n\n    @RequestMapping(\"book\")\n\n\n\n\n    public Book book(@RequestParam(required = true) Long id) {\n\n\n\n\n\n\n\n\n\n        Book book = dao.getBook(id);\n\n\n\n\n        return book;\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    @RequestMapping(method = RequestMethod.GET)\n\n\n\n\n    public Book create() {\n\n\n\n\n        return new Book();\n\n\n\n\n\n\n\n\n\n    }\n\n\n\n\n\n\n\n\n\n    // http://localhost:8080/mvc/book/create (POST)\n\n\n\n\n    @RequestMapping(method = RequestMethod.POST)\n\n\n\n\n    public String create(@ModelAttribute Book book, BindingResult results) {\n\n\n\n\n\n\n\n\n\n        if (book == null)\n\n\n\n\n            return null;\n\n\n\n\n\n\n\n\n\n        dao.save(book);\n\n\n\n\n\n\n\n\n\n        return \"redirect:list\";\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.RC2", "fixed_version": "v3.0.0.RC3", "fixed_files": ["org.springframework.web.servlet.handler.AbstractUrlHandlerMapping.java", "org.springframework.web.servlet.mvc.annotation.ServletAnnotationControllerTests.java", "org.springframework.web.servlet.HandlerMapping.java", "org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.java"], "label": 1, "es_results": []}, {"bug_id": 6525, "bug_title": "SpEL context is wrong in method parameter resolution", "bug_description": "SpEL context is wrong in method parameter resolution.  Instead of using the current context for the stack (which refers to the method target), parameters should have a current context equal to the context root.  This test would fail in EvaluationTests():\n\n\n\n\n\n\n\t@Test\n\n\n\n\n\tpublic void testNestedMethod() {\n\n\n\n\n\t\tevaluate(\"placeOfBirth.doubleIt(inventions.length)\", 18, Integer.class);\n\n\n\n\n\t}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.RC3", "fixed_version": "v3.0.0.RELEASE", "fixed_files": ["org.springframework.expression.spel.ast.MethodReference.java", "org.springframework.expression.spel.EvaluationTests.java"], "label": 1, "es_results": []}, {"bug_id": 6493, "bug_title": "Regression about the suppport of the tag <import resource=\"...\"/>", "bug_description": "The tag <import resource=\"...\"/> acts differently in version 3.0.0 and 2.5.6.\nFor example, consider these two xml configuration files, located in a package \"context\".\nFile: dependent-context.xml\n---------------------------\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd\">\n\t<bean id=\"myBean\" class=\"java.lang.String\" />\n</beans>\nFile: super-context.xml\n-----------------------\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd\">\n\t<import resource=\"dependent-context.xml\" />\n</beans>\nWe load the latter, using the following: \nnew ClassPathXmlApplicationContext(\"context/super-context.xml\");\nHere is the log using Spring 2.5.6.SEC01:\n-----------------------------------------\n11:47:58,903 INFO  [ClassPathXmlApplicationContext] Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@19efb05: display name [org.springframework.context.support.ClassPathXmlApplicationContext@19efb05]; startup date [Wed Dec 02 11:47:58 CET 2009]; root of context hierarchy\n11:47:58,949 INFO  [XmlBeanDefinitionReader] Loading XML bean definitions from class path resource [context/super-context.xml]\n11:47:59,027 INFO  [XmlBeanDefinitionReader] Loading XML bean definitions from class path resource [context/dependent-context.xml]\n11:47:59,059 INFO  [ClassPathXmlApplicationContext] Bean factory for application context [org.springframework.context.support.ClassPathXmlApplicationContext@19efb05]: org.springframework.beans.factory.support.DefaultListableBeanFactory@47393f\n11:47:59,059 INFO  [DefaultListableBeanFactory] Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@47393f: defining beans [myBean]; root of factory hierarchy\nNote that the dependent-context.xml file is loaded as \"class path resource [context/dependent-context.xml]\"\nHere is the log using Spring 3.0.0.RC3:\n-----------------------------------------\n12:06:57,312 INFO  [ClassPathXmlApplicationContext] Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@8814e9: startup date [Wed Dec 02 12:06:57 CET 2009]; root of context hierarchy\n12:06:57,608 INFO  [XmlBeanDefinitionReader] Loading XML bean definitions from class path resource [context/super-context.xml]\n12:06:57,686 INFO  [XmlBeanDefinitionReader] Loading XML bean definitions from URL file:/C:/Workspace/__Test/target/classes/context/dependent-context.xml\n12:06:57,795 INFO  [DefaultListableBeanFactory] Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@1a9334: defining beans [myBean]; root of factory hierarchy\nNote that the dependent-context.xml file is new loaded as \"URL file:/C:/Workspace/__Test/target/classes/context/dependent-context.xml\"\nIf the two file are located in different folders on the file system, as it is often the case, the loading fails.\nThis difference generates several major regressions in our existing projects.", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.RC3", "fixed_version": "v3.0.0.RELEASE", "fixed_files": ["org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.java"], "label": 1, "es_results": []}, {"bug_id": 6656, "bug_title": "ScheduledAnnotationBeanPostProcessor registers schedules twice in web application", "bug_description": "ScheduledAnnotationBeanPostProcessor.onApplicationEvent is first run when the Root WebApplicationContext initializes. Then run again when the FrameworkServlet initializes. Each time onApplicationEvent runs a new schedule is registered.\nI have modified the task-basic sample from https://src.springframework.org/svn/spring-samples/task-basic/trunk/ to run as a web application for verification. Will attach the source and war file.\nThis is the console output of task-basic in jetty. It&apos;s the same in tomcat. Notice the \"processing next 10...\" text that shows up twice every 30 seconds. When the application runs from a main class outside a web server the \"processing next 10...\" text only shows up once every 30 seconds.\n\n\n\n\n\n\n2010-01-08 10:38:22.612::INFO:  Logging to STDERR via org.mortbay.log.StdErrLog\n\n\n\n\n2010-01-08 10:38:22.738::INFO:  jetty-6.1.17\n\n\n\n\n2010-01-08 10:38:23.212:/task-basic:INFO:  Initializing Spring root WebApplicationContext\n\n\n\n\nINFO : org.springframework.web.context.ContextLoader - Root WebApplicationContext: initialization started\n\n\n\n\nINFO : org.springframework.web.context.support.XmlWebApplicationContext - Refreshing Root WebApplicationContext: startup date [Fri Jan 08 10:38:23 CET 2010]; root of context hierarchy\n\n\n\n\nINFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from class path resource [org/springframework/samples/task/basic/annotation/config.xml]\n\n\n\n\nINFO : org.springframework.beans.factory.support.DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@144b9ff: defining beans [scheduledProcessor,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.scheduling.annotation.internalAsyncAnnotationProcessor,org.springframework.scheduling.annotation.internalScheduledAnnotationProcessor]; root of factory hierarchy\n\n\n\n\nINFO : org.springframework.web.context.ContextLoader - Root WebApplicationContext: initialization completed in 13801 ms\n\n\n\n\nprocessing next 10 at Fri Jan 08 10:38:37 CET 2010\n\n\n\n\nINFO : org.springframework.web.servlet.DispatcherServlet - FrameworkServlet &apos;SpringServlet&apos;: initialization started\n\n\n\n\nINFO : org.springframework.web.context.support.XmlWebApplicationContext - Refreshing WebApplicationContext for namespace &apos;SpringServlet-servlet&apos;: startup date [Fri Jan 08 10:38:37 CET 2010]; parent: Root WebApplicationContext\n\n\n\n\nINFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from ServletContext resource [/servlet-context.xml]\n\n\n\n\n2010-01-08 10:38:37.139:/task-basic:INFO:  Initializing Spring FrameworkServlet &apos;SpringServlet&apos;\n\n\n\n\nINFO : org.springframework.beans.factory.support.DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@fffa61: defining beans []; parent: org.springframework.beans.factory.support.DefaultListableBeanFactory@144b9ff\n\n\n\n\nINFO : org.springframework.web.servlet.DispatcherServlet - FrameworkServlet &apos;SpringServlet&apos;: initialization completed in 4407 ms\n\n\n\n\nprocessing next 10 at Fri Jan 08 10:38:41 CET 2010\n\n\n\n\n2010-01-08 10:38:41.557::INFO:  Opened C:\\Users\\Christian\\Programmer\\jetty-6.1.17\\logs\\2010_01_08.request.log\n\n\n\n\n2010-01-08 10:38:41.641::INFO:  Started SelectChannelConnector@0.0.0.0:8080\n\n\n\n\nprocessing next 10 at Fri Jan 08 10:39:07 CET 2010\n\n\n\n\nprocessing next 10 at Fri Jan 08 10:39:11 CET 2010\n\n\n\n\nprocessing next 10 at Fri Jan 08 10:39:37 CET 2010\n\n\n\n\nprocessing next 10 at Fri Jan 08 10:39:41 CET 2010\n\n\n\n\n\n", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.RELEASE", "fixed_version": "v3.0.1.RELEASE", "fixed_files": ["org.springframework.scheduling.annotation.ScheduledAnnotationBeanPostProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 6858, "bug_title": "Push the Java 5 simplifications in SimpleJdbcTemplate up to JdbcTemplate", "bug_description": "Since Spring 3 targets Java 5, I wouldn&apos;t expect to need SimpleJdbcTemplate anymore.  I&apos;d expect Java 5 functionality to be incorporated in the base JdbcTemplate so I could take advantage of simplifications there without having to bring in another class.  Then I would only ever want to work with JdbcTemplate.\nThe most useful feature of SimpleJdbcTemplate not in JdbcTemplate is the ability to specify args using var args.", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.RELEASE", "fixed_version": "v3.0.1.RELEASE", "fixed_files": ["org.springframework.jdbc.core.JdbcOperations.java", "org.springframework.jdbc.core.JdbcTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 7703, "bug_title": "improve the process of finding actual methods for servlet and portlet handlers", "bug_description": "The process of finding the methods to be invoked for each http dispatch could be improved. While it has been already addressed in a previous released, there are still some minor improvements to be made.", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.RELEASE", "fixed_version": "v3.0.6.RELEASE", "fixed_files": ["org.springframework.web.portlet.mvc.annotation.AnnotationMethodHandlerAdapter.java", "org.springframework.web.portlet.mvc.annotation.AnnotationMethodHandlerExceptionResolver.java", "org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerExceptionResolver.java", "org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.java"], "label": 1, "es_results": []}, {"bug_id": 6180, "bug_title": "Upgrade Apache HttpClient to version 4.0", "bug_description": "Folks,\nPlease consider upgrading HttpClient to version 4.0 which is the latest stable (GA) version of the library. Commons HttpClient 3.1 is very likely to be deprecated / officially declared end of life very soon (3 - 6 months). There have been no bug fixes in the 3.x branch for over a year. \nPatch attached. Unfortunately I was unable to fix the Ivy build which I am not very familiar with.\nOleg ", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.RC1", "fixed_version": "v3.1.0.M2", "fixed_files": ["org.springframework.http.client.CommonsClientHttpResponse.java", "org.springframework.web.client.RestTemplateIntegrationTests.java", "org.springframework.http.client.CommonsClientHttpRequest.java", "org.springframework.http.client.CommonsClientHttpRequestFactory.java", "org.springframework.http.client.AbstractHttpRequestFactoryTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 6922, "bug_title": "Deprecate SimpleJdbcTemplate in favor of JdbcTemplate", "bug_description": "also add public int[] batchUpdate(String sql, List<Object[]> batchArgs) as well as any other methods that exist only on SimpleJdbcTemplate at that time.", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.RC2", "fixed_version": "v3.1.0.M2", "fixed_files": ["org.springframework.jdbc.core.simple.SimpleJdbcTemplate.java", "org.springframework.jdbc.core.JdbcOperations.java", "org.springframework.jdbc.core.simple.SimpleJdbcDaoSupport.java", "org.springframework.jdbc.core.JdbcTemplate.java", "org.springframework.jdbc.core.namedparam.SqlParameterSourceUtils.java", "org.springframework.jdbc.core.simple.SimpleJdbcOperations.java", "org.springframework.jdbc.core.JdbcTemplateTests.java", "org.springframework.jdbc.core.metadata.CallMetaDataProvider.java", "org.springframework.jdbc.core.simple.package-info.java"], "label": 1, "es_results": []}, {"bug_id": 6482, "bug_title": "@RequestMapping handled incorrectly when value contains \".\" (dot) character", "bug_description": "At the moment in my code exist method with such signature:\n\n\n\n\n\n\n@RequestMapping(value = \"/projects/{filter}/{order}-{direction}\", method = RequestMethod.GET)\n\n\n\n\npublic String filteredProjectListing(@PathVariable(\"filter\") String filter, @PathVariable(\"order\") String order,\n\n\n\n\n            @PathVariable(\"direction\") String direction, ModelMap model) {\n\n\n\n\n ...\n\n\n\n\n}\n\n\n\n\n\n\norder is String variable containing ognl-like expresssion ie. \"raging.result\" (which I later use for BeanComparator) but this mapping is in version RC3 is not found, which is different behaviour from RC2 where there is no such problem.\nLog message with example of given fault result is:\n\n\n\n\n\n\n2009-12-01 16:38:02,459 WARN [org.springframework.web.servlet.PageNotFound] - <No mapping found for HTTP request with URI [/Example/projects/all/rate.result-asc.html] in DispatcherServlet with name &apos;Example&apos;>\n\n\n\n\n\n\nThere is no problem with handling path which doesn&apos;t contain more &apos;.&apos; (dot) characters, so this can probably help you with analysis of the problem. ", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.RC3", "fixed_version": "v3.0.0.RELEASE", "fixed_files": ["org.springframework.util.AntPathStringMatcher.java", "org.springframework.web.servlet.mvc.annotation.UriTemplateServletAnnotationControllerTests.java", "org.springframework.util.AntPathMatcher.java", "org.springframework.util.AntPathMatcherTests.java"], "label": 1, "es_results": []}, {"bug_id": 6752, "bug_title": "RestTemplate throws IllegalArgumentException when HTTP status is not in the HttpStatus enum ", "bug_description": "Using RestTemplate to connect to a server that occasionally throws HTTP Status of 420, I am getting IllegalArgumentExceptions when accessing the HttpStatus object in my implementation of the ResponseErrorHandler interface.  When I removed that, and started pulling the status from the Headers directly, RestTemplate started throwing errors due to the logger.warn call in RestTemplate.handleResponseError().  I&apos;ve gotten around this by not using the HttpStatus enum (getting status from the HttpHeaders directly) and by turning up the log level for RestTemplate to ERROR.  Shouldn&apos;t this support any HTTP status value?", "project": "Spring", "sub_project": "SPR", "version": "v3.0.0.RELEASE", "fixed_version": "v3.0.1.RELEASE", "fixed_files": ["org.springframework.http.HttpStatus.java"], "label": 1, "es_results": []}, {"bug_id": 6871, "bug_title": "Spring MVC regression: binding to indexed properties is broken", "bug_description": "When you submit a form, with databinding on a command object with indexed properties, the indexed properties of the command object are not filled in.\nI think this bug is related to the correction that happened in SPR-6840.\nThe characters [ and ] are not only removed from the id attrbute of the HTML elements, but also (unnessesary) from the name attribute of the HTML elements.\nYou can see it happening via next example.\nWhen you type 10 and 20 in the input fields, the output to the console is: \n{Belgium=null, Switzerland=null}\nwhile the output should have been \n{Belgium=10, Switzerland=20}\n\nThe class that acts as command object:\n--------------------------------------\npackage org.example.entities;\nimport java.util.LinkedHashMap;\nimport java.util.Map;\npublic class Continent {\n  // key = name of country\n  // Integer= number of inhabitants\n  private Map<String, Integer> countries = new LinkedHashMap<String, Integer>();\n  public Continent() \n{\n    countries.put(\"Belgium\", null);\n    countries.put(\"Switzerland\", null);\n  }\n\n  public void setCountries(Map<String, Integer> countries) \n{\n    this.countries = countries;\n  }\n\n  public Map<String, Integer> getCountries() \n{\n    return countries;\n  }\n}\nThe Controller class:\n---------------------\npackage org.example.web;\nimport org.example.entities.Continent;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.validation.BindingResult;\nimport org.springframework.web.bind.annotation.ModelAttribute;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RequestMethod;\n@Controller\npublic class ContinentController {\n  @RequestMapping(value = \"/continent.htm\", method = RequestMethod.GET)\n  public String continentForm(Model model) \n{\n    Continent continent = new Continent();\n    model.addAttribute(continent);\n    return \"continent.jsp\";\n  }\n\n  @RequestMapping(value = \"/continent.htm\", method = RequestMethod.POST)\n  public String continentForm(@ModelAttribute Continent continent,\n      BindingResult bindingResult) \n{\n    System.out.println(continent.getCountries()); // Here you can see the bug\n    return \"continent.jsp\";\n  }\n}\ncontinent.jsp\n-------------\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<%@page contentType=\"text/html\" pageEncoding=\"UTF-8\" session=\"false\"%>\n<%@taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\"%>\n<%@taglib prefix=\"form\" uri=\"http://www.springframework.org/tags/form\"%>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\"\n\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"nl\" lang=\"nl\">\n<head>\n<title>Continent example</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n</head>\n<body>\n<form:form commandName=\"continent\">\n<c:forEach items=\"$\n{continent.countries}\n\" var=\"entry\">\n<div>\n<form:label path=\"countries[$\n{entry.key}]\">${entry.key}\n</form:label>\t\n<form:input path=\"countries[$\n{entry.key}]\" />\n<form:errors path=\"countries[${entry.key}\n]\" />\n</div>\n</c:forEach> \n<div><input type=\"submit\" /></div>\n</form:form>\n</body>\n</html>", "project": "Spring", "sub_project": "SPR", "version": "v3.0.1.RELEASE", "fixed_version": "v3.0.2.RELEASE", "fixed_files": ["org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.java", "org.springframework.web.servlet.tags.form.CheckboxTagTests.java", "org.springframework.web.servlet.tags.form.AbstractCheckedElementTag.java"], "label": 1, "es_results": []}, {"bug_id": 7004, "bug_title": "CronTrigger is not triggered at correct time", "bug_description": "When running CronTrigger on short interval I get the task triggered sooner then requested and also get duplicates.\npublic void initScheduler() {\n    \tSystem.out.println(\"Got initScheduler\");\n    \ttaskExecutor = new ThreadPoolTaskScheduler();\n    \ttaskExecutor.initialize();\n    \ttaskExecutor.schedule(new Runnable() {\n\t\t\t@Override\n\t\t\tpublic void run() \n{\n\t\t\t\tSystem.out.println(new Date());\t\t\t\t\n\t\t\t}\n\t\t},new CronTrigger(\"0/5 * * * * ?\"));\n}  \nThe output is:\nGot initScheduler\nThu Mar 18 17:08:19 IST 2010\nThu Mar 18 17:08:24 IST 2010\nThu Mar 18 17:08:24 IST 2010\nThu Mar 18 17:08:25 IST 2010\nThu Mar 18 17:08:29 IST 2010\nThu Mar 18 17:08:30 IST 2010", "project": "Spring", "sub_project": "SPR", "version": "v3.0.1.RELEASE", "fixed_version": "v3.0.3.RELEASE", "fixed_files": ["org.springframework.scheduling.support.CronTriggerTests.java", "org.springframework.scheduling.support.CronSequenceGenerator.java", "org.springframework.scheduling.support.CronTrigger.java"], "label": 1, "es_results": []}, {"bug_id": 6901, "bug_title": "Tomcat does not shutdown correctly when using task:scheduled-taks", "bug_description": "Using the regular task:scheduler element in conjunction with the task:scheduled-tasks element, results, at least with Tomcat, in a server that is unable to shut down.\nThe server hangs after having logged the following statement:\nDestroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@d81cda: defining beans []; parent: org.springframework.beans.factory.support.DefaultListableBeanFactory@1d49247\nManually defining a task scheduler and setting the threads to run as daemon provides a workaround:\n\t<task:scheduled-tasks scheduler=\"taskScheduler\">\n\t\t<task:scheduled ref=\"myTask\" method=\"run\" cron=\"0 0 0 * * ?\"/>\n\t</task:scheduled-tasks>\n\t<bean id=\"taskScheduler\" class=\"org.springframework.scheduling.concurrent.ThreadPoolTaskScheduler\">\n\t\t<property name=\"daemon\" value=\"true\"/>\n\t</bean>\nHowever this is only a workaround, and the default behavior should work out of the box. As you can see from the forum post reference, I am not the only one facing this issue.", "project": "Spring", "sub_project": "SPR", "version": "v3.0.1.RELEASE", "fixed_version": "v3.0.3.RELEASE", "fixed_files": ["org.springframework.scheduling.config.ScheduledTaskRegistrar.java", "org.springframework.scheduling.config.TaskExecutorFactoryBean.java"], "label": 1, "es_results": []}, {"bug_id": 6902, "bug_title": "@ResponseBody does not work with @ExceptionHandler", "bug_description": "When this method is executed\n\n\n\n\n\n\n@ExceptionHandler\n\n\n\n\n@ResponseBody\n\n\n\n\npublic String dummyExceptionHandler(Exception e) {\n\n\n\n\n    return e.getMessage();\n\n\n\n\n}\n\n\n\n\n\n\nSpring mvc tries to resolve the view using the method output --> 404.\nAs the method is annotated with @ResponseBody, it should directly write the method output to the response.", "project": "Spring", "sub_project": "SPR", "version": "v3.0.1.RELEASE", "fixed_version": "v3.1.0.M1", "fixed_files": ["org.springframework.web.servlet.config.AnnotationDrivenBeanDefinitionParser.java", "org.springframework.web.servlet.config.MvcNamespaceTests.java", "org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerExceptionResolverTests.java", "org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerExceptionResolver.java"], "label": 1, "es_results": []}, {"bug_id": 7289, "bug_title": "StackOverflowError when converting nested Lists", "bug_description": "The following simple unit test demonstrates the problem:\nConversionService service = ConversionServiceFactory.createDefaultConversionService();\nList<List<String>> list = Collections.singletonList(Collections.singletonList(\"Foo\"));\nAssert.assertNotNull(service.convert(list, String.class));\nMost probably the problem stems from the changed method in TypeDescriptor\npublic synchronized TypeDescriptor getElementTypeDescriptor() {\n\tif (this.elementType == null) \n{\n\t\tthis.elementType = forElementType(resolveElementType());\n\t}\n\treturn this.elementType;\n}\nand the fact that forElementType returns this in this case.", "project": "Spring", "sub_project": "SPR", "version": "v3.0.3.RELEASE", "fixed_version": "v3.0.4.RELEASE", "fixed_files": ["org.springframework.core.convert.support.GenericConversionService.java", "org.springframework.core.convert.support.ObjectToObjectConverter.java", "org.springframework.core.convert.support.CollectionToStringConverter.java", "org.springframework.core.convert.support.CollectionToCollectionConverter.java", "org.springframework.core.convert.support.GenericConversionServiceTests.java", "org.springframework.core.convert.support.MapToMapConverter.java", "org.springframework.core.convert.TypeDescriptor.java", "org.springframework.core.convert.support.ConversionUtils.java"], "label": 1, "es_results": []}, {"bug_id": 7795, "bug_title": "ServletRequestDataBinder does not bind MultipartFile with HiddenHttpMethodFilter and Multipart Request", "bug_description": "I have setup a MultipartFilter and HtmlHiddenMethodFilter following the instructions in SPR-6594 and the javadoc.  \nI have a java bean that has a org.springframework.web.multipart.MultipartFile property. I attempt to bind my bean with the standard @ModelAttribute annotation. The rest of its properties get resolved correctly but the MultipartFile property is set to null. \nI believe the issue is that on line 106 of the ServletRequestDataBinder it does an instanceof check: \"request instanceof MultipartRequest\" which will return false because its the HttpMethodRequestWrapper class from the HtmlHiddenMethodFilter. \nHowever, if I move the property out of my javabean and bind it via a RequestParam annoation, it works correctly. \npublic ModelAndView uploadFile(@RequestParam(\"file\") MultipartFile file) {\n   // code\n}", "project": "Spring", "sub_project": "SPR", "version": "v3.0.4.RELEASE", "fixed_version": "v3.0.6.RELEASE", "fixed_files": ["org.springframework.web.context.request.ServletWebRequest.java", "org.springframework.web.portlet.context.PortletWebRequest.java", "org.springframework.web.portlet.util.PortletUtils.java", "org.springframework.web.util.WebUtils.java", "org.springframework.web.portlet.bind.PortletRequestDataBinder.java", "org.springframework.web.bind.ServletRequestDataBinder.java"], "label": 1, "es_results": []}, {"bug_id": 7842, "bug_title": "DataBinder should be able to define a different strategy for BeanWrapperImpl how autogrowing should handle gaps in collection properties", "bug_description": "DataBinder which is used by WebRequestDataBinder and ServletRequestDataBinder grows automatically collections when \"autoGrowNestedPaths\" is on (AFAIK this is the default for the DataBinder).\nThe behaviour of DataBinder when \"autoGrowNestedPaths\" is that a property with a given index N will result in growing a collection to size N if the collection is not large enough. Collection elements with index < N will be initialized with default objects of the collection&apos;s type.\nBased on WebRequestDataBinder it&apos;s therefore easily possible to DoS a web application if it&apos;s allowed to bind against a collection property and the client POSTs a single property using a very large index.\nSending a single request containing a parameter for a collection property with index 99999999 caused an OOM on a JVM on MacOsX with default memory settings (64MB?). The list type in this case contained 7 String properties and 2 Longs.\nI think there are several things to follow-up:\n1) It would be safer to set autoGrowNestedPaths to false by default. Use of DataBinder and autoGrowNestedPaths then would be more restrictive by default and require explicit action to enable autoGrowing.\n2) The creation of \"default\" values in BeanWrapperImpl should be more flexible. A strategy for creating default values would allow clients to define how such default values should be created. In the case of WebRequestDataBinder creating empty (null) collection elements instead of default objects is certainly safer to fill the gaps in the collection - especially for exposed applications to the public. Furthermore this does not expose unwanted restrictions like a maximum allowed index limitation etc.\n3) Presumably this could be solved with CustomPropertyEditors. However the majority of developers probably tries to stick with what is available out-of-the box and as the DataBinding in general for \"standard\" use-cases works fine dealing with the described issue is not obvious and could lead to wide-spread holes.", "project": "Spring", "sub_project": "SPR", "version": "v3.0.5.RELEASE", "fixed_version": "v3.0.6.RELEASE", "fixed_files": ["org.springframework.beans.BeanWrapper.java", "org.springframework.beans.BeanWrapperAutoGrowingTests.java", "org.springframework.beans.BeanWrapperImpl.java", "org.springframework.validation.BeanPropertyBindingResult.java", "org.springframework.validation.DataBinder.java", "org.springframework.validation.DataBinderTests.java"], "label": 1, "es_results": []}, {"bug_id": 7931, "bug_title": "Checking for @XmlRootElement annotation should be made optional in Jaxb2Marshaller ", "bug_description": "The Jaxb2Marshaller is only supporting classes annotated with @XmlRootElement currently and there&apos;s no way to override that behaviour as supportsInternal(Class, boolean) is private. There are cases when you want to (un)marshal classes that are @XmlType annotated only. Especially when working with XJC, you get the @XmlRootElement annotation only for classes that have their xsd:simpleType or xsd:complexType nested inside the xsd:element declaration (see this blog entry for why that&apos;s the case). However, if you have a type that can be reused and used as a root element&apos;s type, XJC will not create the @XmlRootElement annotation but rather a factory method inside the ObjectFactory class. To get those classes (un)marshalled, you currently have to copy large parts of Jaxb2Marshaller as there&apos;s no way to disable the check for the annotation. So it would be cool if this was configurable through a bean property or at least changeable so that a subclass could potentially call supportsInternal(clazz, false).", "project": "Spring", "sub_project": "SPR", "version": "v3.0.7.RELEASE", "fixed_version": "v3.1.0.RC1", "fixed_files": ["org.springframework.oxm.jaxb.Jaxb2MarshallerTests.java", "org.springframework.oxm.jaxb.Jaxb2Marshaller.java"], "label": 1, "es_results": []}, {"bug_id": 8808, "bug_title": "Allow @Configuration classes to self-@ComponentScan", "bug_description": "I am using AnnotationConfigWebApplicationContext and XML-free testing support with @ContextConfiguration(classes=...). When pointed @Configuration class contains @ComponentScan with a package containing that class:\n\n\n\n\n\n\npackage com.example.foo;\n\n\n\n\n\n\n\n\n\n@Configuration\n\n\n\n\n@ComponentScan(basePackages = \"com.example.foo\")\n\n\n\n\npublic class Config { }\n\n\n\n\n\n\nI get unexpected exception:\n\n\n\n\n\n\norg.springframework.context.annotation.ConflictingBeanDefinitionException: Annotation-specified bean name &apos;config&apos; for bean class [com.example.foo.Config] conflicts with existing, non-compatible bean definition of same name and class [com.example.foo.Config]\n\n\n\n\n\n\nWhile I understand why it happens, IMHO Spring should handle this case and simply ignore @Configuration found in scanned package if it has already been provided in AnnotationConfigWebApplicationContext.\nTest case attached. On branch master you&apos;ll find a test case failing, branch fix fixes the problem by simply @Config to another package.", "project": "Spring", "sub_project": "SPR", "version": "v3.1.0.RC1", "fixed_version": "v3.1.0.RC2", "fixed_files": ["org.springframework.web.servlet.config.annotation.EnableWebMvc.java"], "label": 1, "es_results": []}, {"bug_id": 8986, "bug_title": "Add the ability to Scan Packages for JAXB Marshalling (java example provided)", "bug_description": "Hi,\nIn our application we have a rapidly growing number of JAXB2 annotated classes. It is a right pain to add these classes manually to the \"classesToBeBound\" property in the Jaxb2Marshaller. Given that other components (I&apos;m looking at you Hibernate : AnnotationSessionFactoryBean) have the ability to automatically add classes from packages that match annotations, why not then for the Jaxb2Marshaller (having to key in the classes manually is so old skool).\nI&apos;ve extended Jaxb2Marshaller (file attached) that scans on the classpath for appropriately annotated classes. Please do review and I hope that this can be incorporated into the next release. I&apos;m happy to make changes to the codebase if required to bring it up to Spring coding standards.\nIt&apos;s a pity that afterPropertiesSet is marked as Final in Jaxb2Marshaller since I can&apos;t override that method to set up the setClassesToBeBound before then calling the super afterPropertiesSet. Currently as the code stands, I have to provide a dummy setClassesToBeBound and setLazyInit to be true. This dummy is then replaced by overriding the getJaxbContext. I think this needs rewriting.\nAn example of use:\n\n\n\n\n\n\n<bean id=\"marshaller\" class=\"foo.bar.AnnotationJaxb2Marshaller\">\n\n\n\n\n    <property name=\"lazyInit\" value=\"true\" />\n\n\n\n\n    <property name=\"classesToBeBound\">\n\n\n\n\n       <list>\n\n\n\n\n           <value>foo.bar.Class</value>\n\n\n\n\n       </list>\n\n\n\n\n    </property>\n\n\n\n\n    <property name=\"packagesToScan\">\n\n\n\n\n        <list>\n\n\n\n\n            <value>foo.bar.jaxb.model</value>\n\n\n\n\n        </list>\n\n\n\n\n    </property>\n\n\n\n\n</bean>\n\n\n\n\n\n\n=david=", "project": "Spring", "sub_project": "SPR", "version": "v3.1.0.RELEASE", "fixed_version": "v3.1.1.RELEASE", "fixed_files": ["org.springframework.http.client.HttpComponentsClientHttpResponse.java", "org.springframework.http.client.SimpleClientHttpResponse.java", "org.springframework.http.client.BufferingClientHttpResponseWrapper.java", "org.springframework.http.client.InterceptingClientHttpRequestFactoryTests.java", "org.springframework.http.client.ClientHttpResponse.java", "org.springframework.http.client.CommonsClientHttpResponse.java", "org.springframework.http.HttpStatusTests.java", "org.springframework.http.HttpStatus.java", "org.springframework.oxm.jaxb.Jaxb2MarshallerTests.java", "org.springframework.oxm.jaxb.Jaxb2Marshaller.java"], "label": 1, "es_results": []}, {"bug_id": 8992, "bug_title": "@ActiveProfiles are not cascaded down to contexts loaded via @ImportResource", "bug_description": "Given:\n\n\n\n\n\n\n@RunWith(SpringJUnit4ClassRunner.class)\n\n\n\n\n@ActiveProfiles(profiles = \"test\")\n\n\n\n\n@ContextConfiguration(classes = MyClass.class)\n\n\n\n\n@ImportResource(\"/appContext.xml\")\n\n\n\n\npublic class MyClass {\n\n\n\n\n  @Autowired\n\n\n\n\n  private ProfileSpecificResource resource;\n\n\n\n\n\n\n\n\n\n  @Bean\n\n\n\n\n  public String aBean() {...}\n\n\n\n\n\n\n\n\n\n  @Test\n\n\n\n\n  public void aTest() {...}\n\n\n\n\n}\n\n\n\n\n\n\nSpring is not cascading/passing through the active profile(s) down to the imported resource (where profile specific beans are defined).\nIf the tests are invoked with the -Dspring.profiles.active=test argument, the tests run as expected.", "project": "Spring", "sub_project": "SPR", "version": "v3.1.0.RELEASE", "fixed_version": "v3.1.1.RELEASE", "fixed_files": ["org.springframework.context.annotation.ConfigurationClassPostProcessor.java", "org.springframework.context.annotation.ConfigurationClassBeanDefinitionReader.java"], "label": 1, "es_results": []}, {"bug_id": 14080, "bug_title": "DefaultCorsProcessor's origin comparison is restrictive and inefficient", "bug_description": "This plays in part with SPR-13691 but is more do to the nature of how DefaultCorsProcessor does its checks.\nWith the DefaultCorsProcessor auto on. It will always trip the check at line 71 \"WebUtils.isSameOrigin(serverRequest)\" of DefaultCorsProcessor even if I&apos;ve already dealt with CORS headers within my own filter beforehand. \nHowever this is not the core issue, an issue that I&apos;m dealing with now. Because this check uses the java.net.URI class to do its parsing its now requiring super strict Request URIs against the webapp. Which is resulting in a number of rejected requests against our app.\nThe other issue here isn&apos;t just the strict nature of URI but just the general use of it in the first place. Its way to overweight for a large number of things its being used for and results in slowness within the app.  As well as its suffers from the Charset lock issue at high concurrency. (Nice write-up from the Evernote team on that issue here https://blog.evernote.com/tech/2011/06/21/fast-string-handling-a-frayed-knot/)\nCurrently the only work around to this is to wrap the HttpServletRequest and hide the Origin header from above. So that the check on line 64 \"!CorsUtils.isCorsRequest(request)\" will pass and stop further processing. \nIdeally it would be great to be able to disable DefaultCorsProcessor at the very least. If anything for the nature of giving the developer the choice not making it for them. However the true solution would be to stop using URI for parsing just a host and port and use a simple regex or string token. As this would still let DefaultCorsProcessor be used.  ", "project": "Spring", "sub_project": "SPR", "version": "v4.2.5.RELEASE", "fixed_version": "v4.2.6.RELEASE", "fixed_files": ["org.springframework.web.util.UriComponentsBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 239, "bug_title": "type attribute in the <repository/> tag is not read for configuration", "bug_description": "In Spring Web Flow 1.0.1, the type attribute of the new <repository/> tag is not read property.  This results in an error on start up.  An example is discussed in this forum thread: http://forum.springframework.org/showthread.php?t=33615", "project": "Spring", "sub_project": "SWF", "version": "v1.0.1", "fixed_version": "v1.0.2", "fixed_files": ["org.springframework.webflow.config.WebFlowConfigNamespaceHandlerTests.java", "org.springframework.webflow.config.ExecutorBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 244, "bug_title": "SessionBindingConversationManager does not update ConversationContainer in HTTP session every time.", "bug_description": "The SessionBindingConversationManager does not update the ConversationContainer in the HttpSession every time (for every request). This can give problems in a clustered environment since the servlet engine will not detect any changes in the HttpSession contents and as a result will not push the updated session out to the cluster.\nWe should also revise the ConversationManager and Conversation interfaces to make sure the have all the hooks required. E.g. how do you know that a client (the FlowExecutionRepo) is done with the ConversationManager, e.g. to commit transaction? Does the unlock() method signal this or do we need another hook?\nAs a proof of concept we should probably build a DB backed ConversationManager.", "project": "Spring", "sub_project": "SWF", "version": "v1.0.1", "fixed_version": "v1.0.2", "fixed_files": ["org.springframework.webflow.conversation.impl.ContainedConversation.java", "org.springframework.webflow.execution.repository.continuation.ContinuationFlowExecutionRepositoryTests.java", "org.springframework.webflow.conversation.impl.SessionBindingConversationManager.java", "org.springframework.webflow.conversation.ConversationId.java", "org.springframework.webflow.execution.repository.FlowExecutionRepository.java", "org.springframework.webflow.conversation.impl.SessionBindingConversationManagerTests.java", "org.springframework.webflow.execution.repository.support.SimpleFlowExecutionRepositoryTests.java", "org.springframework.webflow.execution.repository.continuation.ContinuationFlowExecutionRepository.java", "org.springframework.webflow.executor.FlowExecutorImpl.java", "org.springframework.webflow.execution.repository.continuation.FlowExecutionContinuationGroupTests.java", "org.springframework.webflow.execution.repository.continuation.ClientContinuationFlowExecutionRepositoryTests.java", "org.springframework.webflow.conversation.Conversation.java"], "label": 1, "es_results": []}, {"bug_id": 262, "bug_title": "Make ThreadLocal variables final", "bug_description": "See:\nhttp://opensource.atlassian.com/projects/spring/browse/SPR-2442", "project": "Spring", "sub_project": "SWF", "version": "v1.0.1", "fixed_version": "v1.0.2", "fixed_files": ["org.springframework.webflow.context.ExternalContextHolder.java"], "label": 1, "es_results": []}, {"bug_id": 261, "bug_title": "InvocationTargetException when second Exception is thrown", "bug_description": "Reported on the forums:\nhttp://forum.springframework.org/showthread.php?t=35874", "project": "Spring", "sub_project": "SWF", "version": "v1.0.1", "fixed_version": "v1.0.2", "fixed_files": ["org.springframework.webflow.engine.impl.FlowExecutionImpl.java", "org.springframework.webflow.engine.impl.FlowExecutionImplTests.java"], "label": 1, "es_results": []}, {"bug_id": 264, "bug_title": "Spring-binding type conversion tries to convert to a target type even if type is assignment compatible with the source", "bug_description": "See http://forum.springframework.org/showthread.php?t=36094", "project": "Spring", "sub_project": "SWF", "version": "v1.0.1", "fixed_version": "v1.0.2", "fixed_files": ["org.springframework.webflow.config.RepositoryType.java", "org.springframework.webflow.engine.support.NotTransitionCriteria.java", "org.springframework.webflow.execution.FlowSessionStatus.java", "org.springframework.webflow.execution.repository.continuation.ContinuationCreationException.java", "org.springframework.webflow.definition.registry.FlowDefinitionConstructionException.java", "org.springframework.webflow.execution.repository.support.InvalidContinuationIdException.java", "org.springframework.webflow.engine.builder.xml.XmlFlowBuilder.java", "org.springframework.webflow.execution.repository.continuation.ContinuationNotFoundException.java", "org.springframework.binding.convert.support.DefaultConversionServiceTests.java", "org.springframework.binding.convert.support.GenericConversionService.java"], "label": 1, "es_results": []}, {"bug_id": 260, "bug_title": "BeanInvokingActionFactory exception when invoking an intercepted bean", "bug_description": "As reported in the following thread on the forum:\nhttp://forum.springframework.org/showthread.php?t=35210\nShould be investigated.", "project": "Spring", "sub_project": "SWF", "version": "v1.0.1", "fixed_version": "v1.0.2", "fixed_files": ["org.springframework.webflow.engine.ActionExecutor.java", "org.springframework.binding.method.MethodKey.java", "org.springframework.binding.method.Parameter.java", "org.springframework.binding.method.Parameters.java"], "label": 1, "es_results": []}, {"bug_id": 270, "bug_title": "Url encoding problems with ClientContinuationFlowExecutionRepository", "bug_description": "See forum:\nhttp://forum.springframework.org/showthread.php?t=36225", "project": "Spring", "sub_project": "SWF", "version": "v1.0.1", "fixed_version": "v1.0.2", "fixed_files": ["org.springframework.webflow.execution.repository.continuation.ClientContinuationFlowExecutionRepository.java"], "label": 1, "es_results": []}, {"bug_id": 255, "bug_title": "The combination of evaluate-action and on-exception does not work", "bug_description": "From:\nhttp://forum.springframework.org/showthread.php?t=35256\nSee attachment file, please.\non-exception=\"foo.FooException\" and on-exception=\"foo.BarException\" are ignored.", "project": "Spring", "sub_project": "SWF", "version": "v1.0.1", "fixed_version": "v1.0.2", "fixed_files": ["org.springframework.binding.expression.support.OgnlExpression.java", "org.springframework.webflow.engine.impl.FlowExecutionImplTests.java"], "label": 1, "es_results": []}, {"bug_id": 236, "bug_title": "Flow redirection parameter incorrectly mapped in a portlet environment", "bug_description": "&apos;ve run into an issue similar to SWF-153\nThe problem is that while exposing parameters to a render request (in PortletFlowController, line 221 in 1.0) with response.setRenderParameters(redirect.getExecution Input()); a map passed to response.setRenderParameters has kays beeing strings and values also beeing string.\nUnfortunatelly, response.setRenderParameters expect a map of keys beeing strings and values beeing ARRAYS of strings.\nSo, after trying to pass a redirect parameter a portlet container will fail (in case of pluto it is a IllegalArgumentException).\nI&apos;ve created a simple flow with which we can test the issue described:\nCode:\n<start-state idref=\"page1\"/>\n<view-state id=\"page1\" view=\"/test/page1.jsp\" >\n\t\t<transition on=\"next\" to=\"testAend\"/>\n</view-state>\n<view-state id=\"testAend\" view=\"flowRedirect:testB?paramName=testValue\" />", "project": "Spring", "sub_project": "SWF", "version": "v1.0.2", "fixed_version": "v1.0.3", "fixed_files": ["org.springframework.webflow.executor.mvc.PortletFlowController.java"], "label": 1, "es_results": []}, {"bug_id": 304, "bug_title": "CONVERSATION_CONTAINER_KEY should be unique per FlowExecutor ", "bug_description": "Background: If you configure a FlowExecutor within a single web app using a FlowExecutorFactoryBean, a SessionBindingConversationManager will be instantiated by default as your ConversationManager. This SessionBindingConversationManager will then store a ConversationContainer in the HTTP session under the key \"webflow.conversation.container\". In addition, you can configure the maxConversations to 1 if you like. This works as expected as long as you only configure only one such FlowExecutor.\nUnintuitive behavior: if you configure multiple, unique FlowExecutors within a single web app using FlowExecutorFactoryBean as described above with maxConversations=1, you will then notice that both FlowExecutors ultimately use the same session key and thus conflict with each other. For example, if you start one flow for FlowExecutor #1 and start another flow which is handled by FlowExecutor #2, the execution of the 2nd flow will destroy the execution of the 1st flow.\nThe issue lies in the interpretation of the semantics of maxConversations. As it is currently implemented (i.e., with a single, global session key), the maxConversations takes effect for all configured FlowExecutors within a single web app.\nI believe that this is unintuitive and actually not the desired behavior. If I configure two completely separate FlowExecutors with different flow repositories within a single web app, I expect that the configuration of one of them will not conflict with the configuration of the other.\nSee also:\nhttp://forum.springframework.org/showthread.php?t=38156", "project": "Spring", "sub_project": "SWF", "version": "v1.0.3", "fixed_version": "v1.0.4", "fixed_files": ["org.springframework.webflow.conversation.impl.ContainedConversation.java", "org.springframework.webflow.conversation.impl.SessionBindingConversationManager.java", "org.springframework.webflow.conversation.impl.ConversationSizeTests.java", "org.springframework.webflow.execution.repository.continuation.FlowExecutionContinuationGroupTests.java", "org.springframework.webflow.conversation.impl.ConversationContainer.java"], "label": 1, "es_results": []}, {"bug_id": 305, "bug_title": "SWF-JSF: ExternalContext ThreadLocal not properly released in exceptional situations", "bug_description": "Currently bypassing render response (either via a earlier response complete or unhandled exception) results in the ExternalContext ThreadLocal from not being cleaned up.", "project": "Spring", "sub_project": "SWF", "version": "v1.0.3", "fixed_version": "v1.0.4", "fixed_files": ["org.springframework.webflow.executor.jsf.FlowNavigationHandlerArgumentExtractorTests.java", "org.springframework.webflow.executor.jsf.FlowNavigationHandler.java", "org.springframework.webflow.executor.jsf.JsfExternalContext.java", "org.springframework.webflow.executor.jsf.FlowPhaseListener.java"], "label": 1, "es_results": []}, {"bug_id": 307, "bug_title": "Unit tests cannot override beans defined in a flow local application context", "bug_description": "See the following forum thread:\nhttp://forum.springframework.org/showthread.php?t=38319", "project": "Spring", "sub_project": "SWF", "version": "v1.0.3", "fixed_version": "v1.0.4", "fixed_files": ["org.springframework.webflow.engine.builder.xml.XmlFlowBuilder.java", "org.springframework.webflow.engine.builder.xml.NamedActionXmlFlowBuilderTests.java", "org.springframework.webflow.test.execution.AbstractXmlFlowExecutionTests.java", "org.springframework.webflow.engine.builder.xml.LocalFlowServiceLocator.java", "org.springframework.webflow.engine.builder.xml.LocalFlowServiceRegistry.java"], "label": 1, "es_results": []}, {"bug_id": 335, "bug_title": "Remove dependency on OGNL", "bug_description": "The implicit constructor of BaseFlowBuilder constructs a BaseFlowServiceLocator which in turn constructors a ExpressionParser using: \nprivate ExpressionParser expressionParser = DefaultExpressionParserFactory.getExpressionParser();\nThe problem here is that this makes it impossible to swap the ExpressionParser for a different implementation that doesn&apos;t rely on OGNL. In my case I want to impl an ExpressionParser that using Groovy&apos;s GPath and OGNL is not currently a dependency of Grails nor do I want it to be", "project": "Spring", "sub_project": "SWF", "version": "v1.0.3", "fixed_version": "v1.0.4", "fixed_files": ["org.springframework.webflow.core.DefaultExpressionParserFactoryTests.java", "org.springframework.webflow.core.DefaultExpressionParserFactory.java", "org.springframework.webflow.engine.builder.BaseFlowServiceLocator.java"], "label": 1, "es_results": []}, {"bug_id": 337, "bug_title": "Converters attempt type conversion even if source object is already assignment compatible with target class.", "bug_description": "As noted here: http://opensource.atlassian.com/projects/spring/browse/SWF-323.\nThis could be a general issue with the Conversion facility in spring-binding.  To research for 1.0.4.", "project": "Spring", "sub_project": "SWF", "version": "v1.0.3", "fixed_version": "v1.0.4", "fixed_files": ["org.springframework.binding.convert.ConversionExecutor.java", "org.springframework.binding.convert.ConversionException.java"], "label": 1, "es_results": []}, {"bug_id": 343, "bug_title": "MapAccessor does not correctly handle null values", "bug_description": "See the following forum thread:\nhttp://forum.springframework.org/showthread.php?t=40620", "project": "Spring", "sub_project": "SWF", "version": "v1.0.4", "fixed_version": "v1.0.5", "fixed_files": ["org.springframework.binding.collection.MapAccessor.java"], "label": 1, "es_results": []}, {"bug_id": 531, "bug_title": "DefaultExpressionFactoryUtils should not automatically set the javax.el.ExpressionFactory system property", "bug_description": "DefaultExpressionFactoryUtils should not automatically set the javax.el.ExpressionFactory system property to configure the ExpressionFactory implementation, as it causes problems with JSP containers using the newest version of the el-api (i.e., Jetty).", "project": "Spring", "sub_project": "SWF", "version": "v2.0-m4", "fixed_version": "v2.0.0.RC1", "fixed_files": ["org.springframework.binding.expression.el.DefaultExpressionFactoryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 529, "bug_title": "DefaultExpressionFactoryUtils breaks backward compatiblity to JDK 1.4", "bug_description": "The Method createExpressionFactory() in org.springframework.binding.expression.el.DefaultExpressionFactoryUtils tries to throw an IllegalStateException with arguments of type String and Throwable. \nThe Class IllegalStateException in JDK doesn&apos;t allow for an throwable in it&apos;s constructor. This feature is first introduced in JDK1.5", "project": "Spring", "sub_project": "SWF", "version": "v2.0-m4", "fixed_version": "v2.0.0.RC1", "fixed_files": ["org.springframework.binding.expression.el.DefaultExpressionFactoryUtils.java"], "label": 1, "es_results": []}, {"bug_id": 527, "bug_title": "org.springframework.faces.webflow.FlowVariableResolver not working with JDK1.4", "bug_description": "The FlowVariableResolver is automatically configured by the faces jar (spring-faces-2.0-m4.jar, /META-INF/faces-config.xml). \nIn it&apos;s static initializer it tries to create an instance of SpringBeanWebFlowELResolver which inherits from \norg.springframework.beans.factory.access.el.SpringBeanELResolver, but SpringBeanELResolver is not compatible with JDK1.4. \nIn turn it might simply be an oversight to make SpringBeanELResolver JDK1.4 compatible (should be fairly easy to replace StringBuilder)?", "project": "Spring", "sub_project": "SWF", "version": "v2.0-m4", "fixed_version": "v2.0.0.RC1", "fixed_files": ["org.springframework.faces.webflow.FlowVariableResolver.java"], "label": 1, "es_results": []}, {"bug_id": 537, "bug_title": "FlowViewStateManager set repeatedly on application instance after application initialization", "bug_description": "This looks like a hack. Why are we doing this?\nSee http://forum.springframework.org/showthread.php?t=51210", "project": "Spring", "sub_project": "SWF", "version": "v2.0-m4", "fixed_version": "v2.0.0.RC1", "fixed_files": ["org.springframework.faces.webflow.FlowFacesContext.java"], "label": 1, "es_results": []}, {"bug_id": 570, "bug_title": "No way to specify parent flow registry from flow-registry tag", "bug_description": "Look into a parent attribute...", "project": "Spring", "sub_project": "SWF", "version": "v2.0-m4", "fixed_version": "v2.0.0.RC1", "fixed_files": ["org.springframework.webflow.config.FlowRegistryFactoryBean.java", "org.springframework.webflow.config.FlowRegistryBeanDefinitionParser.java", "org.springframework.webflow.definition.registry.FlowDefinitionRegistryImpl.java", "org.springframework.webflow.config.FlowRegistryBeanDefinitionParserTests.java", "org.springframework.webflow.definition.registry.FlowDefinitionRegistry.java"], "label": 1, "es_results": []}, {"bug_id": 573, "bug_title": "flow-execution-repository type attribute should be optional", "bug_description": "given DefaultFlowExecutionRepository.", "project": "Spring", "sub_project": "SWF", "version": "v2.0-m4", "fixed_version": "v2.0.0.RC1", "fixed_files": ["org.springframework.webflow.config.FlowExecutorFactoryBean.java", "org.springframework.webflow.config.FlowExecutorBeanDefinitionParser.java", "org.springframework.webflow.config.FlowExecutorBeanDefinitionParserTests.java"], "label": 1, "es_results": []}, {"bug_id": 530, "bug_title": "org.springframework.webflow.execution.repository.impl.DefaultFlowExecutionRepository not extensible/appropriately pluggable", "bug_description": "There is no method to support customizing/replacing the org.springframework.webflow.execution.repository.continuation.FlowExecutionContinuationFactory used during the construction of a org.springframework.webflow.execution.repository.impl.DefaultFlowExecutionRepository inside the constructor. This will force anyone wishing to replace/override/ehance the default org.springframework.webflow.execution.repository.continuation.SerializedFlowExecutionContinuationFactory to duplicate/re-implement functionality in org.springframework.webflow.execution.repository.impl.DefaultFlowExecutionRepository\n\nSean\n\n", "project": "Spring", "sub_project": "SWF", "version": "v2.0-m4", "fixed_version": "v2.0.0.RELEASE", "fixed_files": ["org.springframework.webflow.execution.repository.impl.DefaultFlowExecutionRepository.java"], "label": 1, "es_results": []}, {"bug_id": 604, "bug_title": "ResourceServlet allows http access to sensitive files", "bug_description": "The ResourceServlet allows access to files that should be protected.\nhttp://richweb.springframework.org/swf-booking-faces/resources/WEB-INF/web.xml\nAccess should be denied to WEB-INF or made configurable.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.0.RC1", "fixed_version": "v2.0.0.RELEASE", "fixed_files": ["org.springframework.js.resource.ResourceServlet.java"], "label": 1, "es_results": []}, {"bug_id": 583, "bug_title": "View-state programming model needs to be consistent between MVC and JSF", "bug_description": "Currently JSF doesn&apos;t do anything with the \"model\" attribute, but it should be consistency with what MVC does: invoke model validation logic if it exits.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.0.RC1", "fixed_version": "v2.0.0.RELEASE", "fixed_files": ["org.springframework.faces.webflow.JsfView.java", "org.springframework.faces.webflow.JsfViewTests.java"], "label": 1, "es_results": []}, {"bug_id": 626, "bug_title": "Piecemeal validation in FormAction does not work", "bug_description": "See http://forum.springframework.org/showthread.php?p=175983\nCustom validator methods, specified by the evaluate attribute &apos;validatorMethod&apos; are not invoked.\n", "project": "Spring", "sub_project": "SWF", "version": "v2.0.0.RC1", "fixed_version": "v2.0.0.RELEASE", "fixed_files": ["org.springframework.webflow.execution.Action.java", "org.springframework.webflow.engine.AnnotatedAction.java", "org.springframework.webflow.action.FormActionTests.java", "org.springframework.webflow.action.AbstractAction.java", "org.springframework.webflow.engine.ActionExecutor.java", "org.springframework.webflow.engine.model.builder.xml.XmlFlowModelBuilderTests.java", "org.springframework.webflow.engine.impl.RequestControlContextImpl.java", "org.springframework.webflow.core.collection.MutableAttributeMap.java", "org.springframework.webflow.engine.AnnotedActionTests.java", "org.springframework.webflow.test.MockRequestContext.java", "org.springframework.webflow.execution.RequestContext.java", "org.springframework.webflow.core.collection.LocalAttributeMap.java"], "label": 1, "es_results": []}, {"bug_id": 596, "bug_title": "MessageContext is not preserving the order of source messages", "bug_description": "The order in which messages are added should be preserved.\nSee http://forum.springframework.org/forumdisplay.php?f=36.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.0.RC1", "fixed_version": "v2.0.0.RELEASE", "fixed_files": ["org.springframework.binding.message.DefaultMessageContextFactoryTests.java", "org.springframework.binding.message.DefaultMessageContext.java"], "label": 1, "es_results": []}, {"bug_id": 599, "bug_title": "Use of Implicit input/output set value (lvalue) expressions are documented but not implemented", "bug_description": "A oversight in RC1. See http://forum.springframework.org/showthread.php?t=52604", "project": "Spring", "sub_project": "SWF", "version": "v2.0.0.RC1", "fixed_version": "v2.0.0.RELEASE", "fixed_files": ["org.springframework.webflow.engine.builder.model.FlowModelFlowBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 632, "bug_title": "eventId value in ActionExecutingView is retrived only by the attribute name '_eventId' (should use the same logic as MvcView.findParameter(String logicalParameterName, ParameterMap parameters))", "bug_description": "See http://forum.springframework.org/showthread.php?t=53019", "project": "Spring", "sub_project": "SWF", "version": "v2.0.0.RC1", "fixed_version": "v2.0.0.RELEASE", "fixed_files": ["org.springframework.webflow.engine.support.ActionExecutingViewFactory.java"], "label": 1, "es_results": []}, {"bug_id": 656, "bug_title": "MvcView.render() incorrectly assumes \"requestContext.getFlowExecutionContext().getKey()\" is not null", "bug_description": "A flow key is not created, for example, when the flow execution path runs through actions only and reaches directly an end state that declares a view.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.0.RC1", "fixed_version": "v2.0.0.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowActionListener.java", "org.springframework.faces.webflow.FlowActionListenerTests.java"], "label": 1, "es_results": []}, {"bug_id": 657, "bug_title": "AjaxTilesView does not resolve deeply nested tiles attributes for rendering as fragments if the containing view has not previously been rendered.", "bug_description": "If a particular view has not been previously rendered by a standard JSP request, nested Tiles attributes (i.e., those in a nested definition that is filling in the attribute of a parent definition) will not have been initialized as expected when they are requested for rendering via Ajax.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.0.RELEASE", "fixed_version": "v2.0.1.RELEASE", "fixed_files": ["org.springframework.js.ajax.tiles2.AjaxTilesView.java"], "label": 1, "es_results": []}, {"bug_id": 653, "bug_title": "FileNotFoundException while using Weblogic10 and SWF classpath flow-location-pattern", "bug_description": "Hello,\nWe are using Spring2.5.3+SWF2.0RC1 under jdk5/weblogic 10.\nWE are defing our flows as follow:\n<webflow:flow-registry id=\"flowRegistry\" flow-builder-services=\"flowBuilderServices\" >\t\n\t\t<webflow:flow-location-pattern value=\"classpath:modules/*/flows/.xml\"/>\n</webflow:flow-registry>\nOur xml file flows are packaged under WEB-INF/classes. Using Tomcat application runs perfectly.\nUsing weblogic 10, war file is splitted in several jars at deployement time in a working folder.\norg.springframework.util.ResourceUtils.getFile(URI, String) then compares computed URI protocol-> zip but expects a file protocol.\nThis leads to a FileNotFoundException.\nClearly, we think this is a Spring issue more or less related in SPR-994, but coming from a different use case.\nThanks to have a look.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.0.RC1", "fixed_version": "v2.0.1.RELEASE", "fixed_files": ["org.springframework.webflow.engine.model.builder.xml.XmlFlowModelBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 645, "bug_title": "Trinidad partial rendering not working correctly when used with Spring Faces", "bug_description": "Trinidad&apos;s partial rendering features don&apos;t seem to be working correctly in combination with Spring Faces.  A JavaScript error similar to the following is being raised in the browser when the response is returned:\n[\"Invalid PPR response. The response-headers were:\\nServer: Apache-Coyote/1.1\\nPragma: no-cache\\nExpires:...\"]DebugCommon1_2_7.... (line 16422)\n[\"Error \", TypeError: responseDocument has no properties message=responseDocument has no properties, \" delivering XML request status changed to \", function()]DebugCommon1_2_7.... (line 16422\nI was able to reproduce this in a simple Trinidad test project.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.0.RELEASE", "fixed_version": "v2.0.1.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowFacesContext.java", "org.springframework.faces.webflow.FlowViewStateManager.java"], "label": 1, "es_results": []}, {"bug_id": 692, "bug_title": "Link in header of dataTable", "bug_description": "A commandLink or a commandButton inside a <f:facet name=\"header\"> of dataTable do not work. An IllegalArgumentException is thrown.\nSee this forum thread:\nhttp://forum.springframework.org/showthread.php?t=54479", "project": "Spring", "sub_project": "SWF", "version": "v2.0.1.RELEASE", "fixed_version": "v2.0.2.RELEASE", "fixed_files": ["org.springframework.webflow.samples.booking.JpaBookingService.java", "org.springframework.webflow.samples.booking.SearchCriteria.java", "org.springframework.faces.model.OneSelectionTrackingListDataModel.java", "org.springframework.faces.model.ManySelectionTrackingListDataModel.java"], "label": 1, "es_results": []}, {"bug_id": 700, "bug_title": "ajaxEnabled=\"false\" causing JavaScript error with <sf:commandLink>", "bug_description": "", "project": "Spring", "sub_project": "SWF", "version": "v2.0.1.RELEASE", "fixed_version": "v2.0.2.RELEASE", "fixed_files": ["org.springframework.faces.ui.ProgressiveCommandButtonRenderer.java", "org.springframework.faces.ui.ProgressiveCommandLinkRenderer.java", "org.springframework.webflow.samples.booking.JpaBookingService.java", "org.springframework.webflow.samples.booking.SearchCriteria.java"], "label": 1, "es_results": []}, {"bug_id": 712, "bug_title": "<sf:ajaxEvent> for <h:selectOneRadio> worked in RC1 but stopped working in 2.0.1", "bug_description": "I have defined the following in my JSF page:\nHTML Code:\n            <sf:ajaxEvent id=\"changeDriverAjax\" action=\"changeDriver\" event=\"onchange\">\n              <h:selectOneRadio id=\"Driver_currentRowIndex\" \n                                value=\"#\n{driverDataModel.rowIndex}\n\">\n                <f:selectItems value=\"#\n{drivers}\n\"/>\n              </h:selectOneRadio>\n            </sf:ajaxEvent>\nThe radio&apos;s value is the index of the Data Model, i.e. 0, 1, 2 etc.\nThis used to work in RC1 but stopped working in 2.0.1. \nI tried to debug, and this is the difference that I found:\nRC1:\nSpring.advisors.push(new Spring.RemoteEventAdvisor(\n{event:&apos;onchange&apos;, targetId: &apos;mainForm:Driver_currentRowIndex&apos;, sourceId : &apos;mainForm:changeDriverAjax&apos;, formId : &apos;mainForm&apos;, processIds : &apos;mainForm:changeDriverAjax&apos;}\n));\n2.0.1:\nSpring.addDecoration(new Spring.AjaxEventDecoration({event:&apos;onchange&apos;, elementId: &apos;mainForm:Driver_currentRowIndex&apos;, formId : &apos;mainForm&apos;, params: \n{processIds : &apos;mainForm:changeDriverAjax&apos;, ajaxSource : &apos;mainForm:changeDriverAjax&apos;}\n }));\nIf sourceId is empty, the underlying remoting handler that calls Dojo uses elementId. This is where the code path between RC1 and 2.0.1 starts to differ. In RC1, dojo.byId() tries to look for the <sf:ajaxEvent> (which doesn&apos;t exist in the DOM), whereas in 2.0.1, it tries to look for &apos;main: Driver_currentRowIndex&apos; (which in the DOM is a <table> hosting the radio buttons).\nBecause of this difference, when I inspect the HTTP Post in Firebug, the value submitted for the radio button is:\nRC1:\nmainForm:Driver_currentRowIndex\t0\n2.0.1:\nmainForm:Driver_currentRowIndex\tmainForm:Driver_currentRowIndex\nThe second one eventually fails when the radio button tries to update my Data Model index.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.1.RELEASE", "fixed_version": "v2.0.2.RELEASE", "fixed_files": ["org.springframework.faces.ui.AjaxEventInterceptorRenderer.java"], "label": 1, "es_results": []}, {"bug_id": 736, "bug_title": "Spring Faces Dojo validation tags not rendering 'propercase' attribute.", "bug_description": "The .tld fspecifies propercase as a valid attribute of the Spring Faces client-side validation tags but the attribute is not rendered when included.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.1.RELEASE", "fixed_version": "v2.0.2.RELEASE", "fixed_files": ["org.springframework.faces.ui.DojoDecoration.java"], "label": 1, "es_results": []}, {"bug_id": 719, "bug_title": "Faces does not set components to valid on restore", "bug_description": "I believe that during the restore stage of a JSF lifecycle all UIInput components should be set back to a valid state.  Looking at MyFaces 1.1.5 the org.apache.myfaces.lifecycle.RestoreViewExecutor class seems to do this using RestoreStateUtils.recursivelyHandleComponentReferencesAndSetValid.\nI have a JSF component to highlight validation failures with a CSS style, this component uses the isValid() component method and now show failures even when a user has corrected them when.  This shows up when they navigate back to a screen.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.1.RELEASE", "fixed_version": "v2.0.2.RELEASE", "fixed_files": ["org.springframework.faces.webflow.JsfViewFactory.java", "org.springframework.faces.webflow.JsfViewFactoryTests.java"], "label": 1, "es_results": []}, {"bug_id": 723, "bug_title": "Component bindings not executed for components in Facets", "bug_description": "The JsfViewFactory processComponentBinding method does not iterate over facets when recursing.  This means that any components within a facet will not be rebound.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.1.RELEASE", "fixed_version": "v2.0.2.RELEASE", "fixed_files": ["org.springframework.faces.webflow.JsfViewFactory.java", "org.springframework.faces.webflow.JsfViewFactoryTests.java"], "label": 1, "es_results": []}, {"bug_id": 706, "bug_title": "ResourceServlet allows HTTP access to sensitive files", "bug_description": "As described in SWF-604 it&apos;s possible to get sensitive files. This was fixed for the WEB-INF folder, but the persistence.xml for example can still be accessed via HTTP:\nhttp://richweb.springframework.org/swf-booking-faces/resources/persistence.xml", "project": "Spring", "sub_project": "SWF", "version": "v2.0.1.RELEASE", "fixed_version": "v2.0.2.RELEASE", "fixed_files": ["org.springframework.js.resource.ResourceServlet.java", "org.springframework.js.resource.ResourceServletTests.java"], "label": 1, "es_results": []}, {"bug_id": 751, "bug_title": "FacesMessage.detail does not propagate through FlowFacesContext", "bug_description": "Hello !\nFacesMessage consists of summary and detail part of message. In FlowFacesContext.addMessage(String clientId, FacesMessage message), the detail value of FacesMessage is not read and saved to RequestContext.messageContext thus its value is thrown away.\nOne result of this is that validation messages are not displayed correctly when <h:messages showDetail=\"true\"/> is on. Actually, detail holds and shows the value of summary (probably as a result of fallback somewhere in SWF). \nAs a matter of fact, many jsf built-in validation and conversion error messages specify detail part of message and those could never be displayed as well.\nThis issue can be simulated on booking-faces, when <h:messages errorClass=\"errors\" showDetail=\"true\" showSummary=\"true\" /> is used and invalid date is given as input to &apos;Check In Date&apos; assuming that javascript is switched off in browser preferences to disable javascript validations (in IE it can be done on Security tab of Internet Options, attribute &apos;Active scripting&apos;). I provide a different with changes for quick simulation.\nI think this is quite serious issue, because it blocks JSF feature that is quite common even in built-in jsf components.\nMichal\nOff topic: I think that integration of SWF with JSF as well as SWF itself is perfectly done in very clean and concise way. It was a pleasure to traverse through the sources. It shows that you took your time on SWF design. Good job, really!", "project": "Spring", "sub_project": "SWF", "version": "v2.0.1.RELEASE", "fixed_version": "v2.0.3.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowFacesContext.java", "org.springframework.faces.webflow.FlowFacesContextTests.java"], "label": 1, "es_results": []}, {"bug_id": 752, "bug_title": "FacesMessage.SEVERITY_FATAL does not propagate through FlowFacesContext", "bug_description": "FacesMessage specifies severity of the message as one of\nSEVERITY_INFO = new Severity(\"Info\", 1);\nSEVERITY_WARN = new Severity(\"Warn\", 2);\nSEVERITY_ERROR = new Severity(\"Error\", 3);\nSEVERITY_FATAL = new Severity(\"Fatal\", 4);\nIn FlowFacesContext.addMessage(String clientId, FacesMessage message), the severity of FacesMessage is read and mapped to org.springframework.binding.message.Severity which can be one of\nINFO = new Severity(0, \"Info\");\nWARNING = new Severity(1, \"Warning\");\nERROR = new Severity(2, \"Error\");\nAs a matter of fact, FacesMessage.SEVERITY_FATAL is not mapped to its sole value in org.springframework.binding.message.Severity and that causes FATAL messages to be merged with ERROR messages. That is NOT good for applications (like ours , where these two severities have different meanings and processing.\nThank you.\nMichal", "project": "Spring", "sub_project": "SWF", "version": "v2.0.1.RELEASE", "fixed_version": "v2.0.3.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowFacesContext.java", "org.springframework.binding.message.MessageBuilderTests.java", "org.springframework.faces.webflow.FlowFacesContextTests.java", "org.springframework.binding.message.Severity.java", "org.springframework.binding.message.MessageBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 753, "bug_title": "Spring Webflow 2.0.2 decorator's uppercase attribute is not working", "bug_description": "The uppercase attribute of sf:clientTextValidator is not working as documented.\ne.g.\n<sf:clientTextValidator uppercase=\"true\">\n<h:inputText id=\"middleInitial\" value=\"#\n{users.contacts.middleInitial}\n\" required=\"false\" title=\"Middle Initial\" />\n</sf:clientTextValidator>\nWhen the page gets rendered, the uppercase property is not copied into the created Dojo widget\nAffected version: Spring web flow 2.0.2 RELEASE", "project": "Spring", "sub_project": "SWF", "version": "v2.0.2.RELEASE", "fixed_version": "v2.0.3.RELEASE", "fixed_files": ["org.springframework.faces.ui.DojoDecoration.java"], "label": 1, "es_results": []}, {"bug_id": 767, "bug_title": "spring-js uses java 1.5 method calls", "bug_description": "The ResourceServlet uses Java 1.5 Method calls.\nwhen running in Tomcat 5.5.26 with compat package and JDK 1.4,\ni&apos;ll get: java.lang.NoSuchMethodError: java.lang.String.contains(Ljava/lang/CharSequence;)Z\n133:\t\tif (gzipEnabled && StringUtils.hasText(acceptEncoding) && acceptEncoding.contains(\"gzip\")\n134:\t\t\t\t&& compressedMimeTypes.contains(mimeType)) {\nthis stands against the release notes:\nWeb Flow 2 requires Java 1.4 or greater and runs on all major Java EE platforms including Tomcat, Jetty, Websphere, WebLogic, and JBoss.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.2.RELEASE", "fixed_version": "v2.0.3.RELEASE", "fixed_files": ["org.springframework.js.resource.ResourceServlet.java"], "label": 1, "es_results": []}, {"bug_id": 782, "bug_title": "ResourceServlet returns wrong 404 page", "bug_description": "The ResourceServlet returns the server default error page even when custom 404 page defined.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.2.RELEASE", "fixed_version": "v2.0.3.RELEASE", "fixed_files": ["org.springframework.js.resource.ResourceServlet.java"], "label": 1, "es_results": []}, {"bug_id": 785, "bug_title": "Spring Faces creates XHTML-incompatible JavaScript scripts", "bug_description": "Spring Faces creates JavaScript-blocks that are not compatible with XHTMl standards and because validation errors:\nFor example the following JSF taglet:\n<sf:commandLink styleClass=\"cmd\" id=\"showDetailData\" value=\"#\n{d.firstName}\n #\n{d.lastName}\n\" action=\"select\"/>\ncreates (among other things) the following JavaScript block:\n<script>Spring.addDecoration(new Spring.CommandLinkDecoration(\n{elementId : &apos;users:data:24:showDetailData&apos;, linkHtml : users_data_24_showDetailData_link}\n));</script>\nThis is wrong for several reasons: (a) No type for the script is defined (required by XHTML), (b) The content of the script block is not correctly uncommented in browsers not supporting JavaScript.\nThe correct block looks like this (type added and correct commenting for all types and versions of browsers added):\n<script type=\"text/javascript\"><Unable to render embedded object: File (--//--><) not found.[CDATA[//><!--\nSpring.addDecoration(new Spring.CommandLinkDecoration(\n{elementId : &apos;users:data:1:showDetailData&apos;, linkHtml : users_data_1_showDetailData_link}\n));\n//--><!]]> </script>\nMuch more verbose but according to our knowledge the only correct way to do it (we will propose a much less verbose style more up to date with current state of the art JavaScript programming later on once we get through the current bugs .\nSince we right now are busy with a project for the German public sector, this poses a critical problem for us, since XHTML conformance is required by binding software architecture agreements specified by the German government (SAGA 4.x). Without this conformance it will not be possible to have the system approved by the German government.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.2.RELEASE", "fixed_version": "v2.0.3.RELEASE", "fixed_files": ["org.springframework.faces.ui.DojoDecorationRenderer.java", "org.springframework.faces.ui.BaseSpringJavascriptComponentRenderer.java", "org.springframework.faces.ui.resource.FlowResourceHelperTests.java", "org.springframework.faces.ui.AjaxEventInterceptorRenderer.java", "org.springframework.faces.ui.BaseDojoComponentRenderer.java", "org.springframework.faces.ui.ResourceGroupRenderer.java", "org.springframework.faces.ui.ResourceRenderer.java", "org.springframework.faces.ui.ValidateAllRenderer.java", "org.springframework.faces.ui.ProgressiveCommandLinkRenderer.java", "org.springframework.faces.ui.AjaxViewRoot.java", "org.springframework.faces.ui.resource.ResourceHelper.java", "org.springframework.faces.ui.BaseSpringJavascriptDecorationRenderer.java", "org.springframework.faces.ui.DojoStyleRenderer.java"], "label": 1, "es_results": []}, {"bug_id": 770, "bug_title": "sf:commandLink fails on IE 6 when javascript disabled", "bug_description": "When using the sf:commandLink component with javascript disabled the renderer falls back to the ProgressiveCommandButtonRenderer.  This renders <button> elements.\nUnfortunately due to a feature of IE 6 button elements are all submitted, regardless of the button that was actually clicked.  (see http://www.kopz.org/public/documents/css/multiple_buttons_ie_workaround.html).  The means that if two links are on the page the action fired might be incorrect.\nCould the ProgressiveCommandButtonRenderer be changed to render <input type=\"submit\"> elements instead?", "project": "Spring", "sub_project": "SWF", "version": "v2.0.2.RELEASE", "fixed_version": "v2.0.4.RELEASE", "fixed_files": ["org.springframework.faces.ui.ProgressiveCommandButtonRenderer.java", "org.springframework.faces.ui.ProgressiveCommandLinkRenderer.java"], "label": 1, "es_results": []}, {"bug_id": 786, "bug_title": "sf:commandLink breaks on IE 6 for multiple buttons", "bug_description": "The following JSF taglet \n<sf:commandLink styleClass=\"cmd\" id=\"showDetailData\" value=\"#\n{d.firstName}\n #\n{d.lastName}\n\" action=\"select\"/>\ncreates (among other things) the following HTML code:\n<button id=\"users:data:0:showDetailData\" class=\"cmd\" name=\"users:data:0:showDetailData\" type=\"submit\" value=\"Leonie Lalente\"><script type=\"text/javascript\" src=\"/BVL_Layout/resources/spring/Spring.js\"></script><script type=\"text/javascript\" src=\"/BVL_Layout/resources/dojo/dojo.js\"></script><script type=\"text/javascript\" src=\"/BVL_Layout/resources/spring/Spring-Dojo.js\"></script>Leonie Lalente</button><script type=\"text/javascript\">var users_data_0_showDetailData_link = \"<a id=\\\"users:data:0:showDetailData\\\" class=\\\"cmd progressiveLink\\\" href=\\\"#\\\" name=\\\"users:data:0:showDetailData\\\" type=\\\"submit\\\" onclick=\\\"this.submitFormFromLink(&apos;users&apos;,&apos;users:data:0:showDetailData&apos;, []); return false;\\\">Leonie Lalente</a>\nNow the bug is the following: In Internet Explorer 6 it is not possible to have more than one <button> tag per form, as IE 6 always sends (name, value) pairs of all buttons defined in the page and not only of the button that was pressed. Consequently it is not possible to find the actual button that was pressed.\nThe correct code thus would look like this:\n<input type=\"submit\" id=\"users:data:0:showDetailData\" class=\"cmd\" name=\"users:data:0:showDetailData\" value=\"Leonie Lalente\"><script type=\"text/javascript\" src=\"/BVL_Layout/resources/spring/Spring.js\"></script><script type=\"text/javascript\" src=\"/BVL_Layout/resources/dojo/dojo.js\"></script><script type=\"text/javascript\" src=\"/BVL_Layout/resources/spring/Spring-Dojo.js\"></script>Leonie Lalente</button><script type=\"text/javascript\">var users_data_0_showDetailData_link = \"<a id=\\\"users:data:0:showDetailData\\\" class=\\\"cmd progressiveLink\\\" href=\\\"#\\\" name=\\\"users:data:0:showDetailData\\\" type=\\\"submit\\\" onclick=\\\"this.submitFormFromLink(&apos;users&apos;,&apos;users:data:0:showDetailData&apos;, []); return false;\\\">Leonie Lalente</a>\nConsequently you use some functionality with IE 6 (e.g. button images and the use of the actual button value instead of the displayed button value) but that&apos;s still better than not being able to use IE 6.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.2.RELEASE", "fixed_version": "v2.0.4.RELEASE", "fixed_files": ["org.springframework.faces.ui.ProgressiveCommandButtonRenderer.java", "org.springframework.faces.ui.ProgressiveCommandLinkRenderer.java"], "label": 1, "es_results": []}, {"bug_id": 856, "bug_title": "When using JSF getMaximumSeverity on the FlowFacesContext returns null even if a message has been added", "bug_description": "If a converter creates a FacesMessage instance the message does appear as a result of the h:messages and h:message tags, but if the FacesContext is queried using the getMaximumSeverity method, the method returns null.  I was able to replicate the issue using the swf-booking-faces example by modifing the enterBookingDetails.xhtml.  I will attach the file once the issue has been created.  To reproduce, I removed the client side checking for one of the date entry boxes, and entered an incorrect date.  At the top of the page above the converter message should be the message \"Please Correct the following errors:\" which should only be rendered if any errors were detected.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.2.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowFacesContext.java", "org.springframework.faces.webflow.FlowFacesContextTests.java"], "label": 1, "es_results": []}, {"bug_id": 823, "bug_title": "MessageContextErrors implementation does not implement all Errors methods", "bug_description": "See http://forum.springframework.org/showthread.php?t=58249", "project": "Spring", "sub_project": "SWF", "version": "v2.0.3.RELEASE", "fixed_version": "v2.0.4.RELEASE", "fixed_files": ["org.springframework.binding.message.MessageContextErrors.java", "org.springframework.binding.message.MessageContextErrorsTests.java"], "label": 1, "es_results": []}, {"bug_id": 900, "bug_title": "Obtaining flow context when doing programmatic validation", "bug_description": "Please implement support for obtaining some sort of flow context when doing programmatic validation e.g. it would be very useful to be able to obtain information which transition event has occurred and triggered validator.\nThis feature was initial discussed on Spring forum (see thread http://forum.springframework.org/showthread.php?t=59625 )", "project": "Spring", "sub_project": "SWF", "version": "v2.0.3.RELEASE", "fixed_version": "v2.0.4.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowActionListener.java", "org.springframework.webflow.samples.booking.Booking.java", "org.springframework.webflow.mvc.view.AbstractMvcView.java"], "label": 1, "es_results": []}, {"bug_id": 735, "bug_title": "Partial/Conditional Validation", "bug_description": "I am working with SWF 2.0 and Spring MVC and I&apos;m facing a problem when I have to conditionally validate a subset of fields of my model object depending on the transition that triggered validation. That is, if the user clicked on button A, then transition T1 is triggered and a particular subset of the model object fields have to be validated. But if the user clicked on button B, then T2 is triggered and then I have to validate a different subset of fields.\nI am aware of 3 ways of performing programmatic validation, namely:\n1) Implementing org.springframework.validation.Validator\npublic void validate(Object obj, Errors errors)\n2) Implementing a model validate method\npublic void validate$\n{state}(MessageContext context)\n\n3) Create a class that defines a public method with the name validate${state}\n, where state is the id of your view-state\npublic void validate$\n{state}\n(yourModelObject, MessageContext context)\nThe problem is that none of these 3 ways let me figure out which transition triggered the validation and thus I am not able to determine which subset of fields I have to validate.\n*************\nAnswer to this post by Keith Donald:\nInteresting use case. Yes, this is currently not supported, though we can certainly support it by allowing the id of the user event that occurred to be an argument to the validation method. Would you mind creating a New Feature JIRA to track this? It&apos;s a minor new feature, so we can look at introducing it in a maintenance revision (most likely 2.0.3, as 2.0.2 is about to go out).", "project": "Spring", "sub_project": "SWF", "version": "v2.0.3.RELEASE", "fixed_version": "v2.0.4.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowActionListener.java", "org.springframework.webflow.samples.booking.Booking.java", "org.springframework.webflow.mvc.view.AbstractMvcView.java"], "label": 1, "es_results": []}, {"bug_id": 916, "bug_title": "AjaxTilesView fails for nested tiles-definition in case of an ajaxRequest", "bug_description": "The AjaxTilesView does not resolve nested tiles-definition in case of an ajax request.\nFor the following tiles-definition the tiles \"form\" is not added to the flattenedAttributeMap and hence a partial rendering of the form-tiles is not possible.\n<tiles-definitions>\n    <definition name=\"index\" template=\"/WEB-INF/jsp/index.jsp\">\n        <put-attribute name=\"form\" value=\"simpleform\" />\n        <put-attribute name=\"result\" value=\"/WEB-INF/jsp/result.jsp\" />\n    </definition>\n   <definition name=\"simpleform\" template=\"/WEB-INF/jsp/searchForm.jsp\">\n\t\t<put-attribute name=\"errorform\" value=\"error\" />\n\t</definition>\n\t<definition name=\"base.error\" template=\"/WEB-INF/jsp/base.error.jsp\">\n\t\t<put-attribute name=\"formobject\" value=\"errorFBO\" />\n\t</definition>\n\t<definition name=\"error\" extends=\"base.error\">\n\t\t<put-attribute name=\"formobject\" value=\"childErrorFBO\" />\n\t</definition>\n</tiles-definitions>\nIn the attached zip-file I provide a possible fix  - see line 123 in the AjaxTilesView-class. Here I add a nested definition to the result map.\nAdditionally I provide a junit-test for testing the changes. To make this work I had to change the signature of the flattenAttributeMap-method from private to protected.\n-------------\nfiles changed:\nsrc/main/java/org/springframework/js/ajax/tiles2/AjaxTilesView\npom.xml\nfiles added:\nsrc/test/resources/tiles-views.xml\nsrc/test/java/org/springframework/js/ajax/tiles2/AjaxTilesViewTest", "project": "Spring", "sub_project": "SWF", "version": "v2.0.3.RELEASE", "fixed_version": "v2.0.4.RELEASE", "fixed_files": ["org.springframework.js.ajax.tiles2.AjaxTilesView.java"], "label": 1, "es_results": []}, {"bug_id": 897, "bug_title": "Merging Transitions doens't consider on-exceptions", "bug_description": "Suppose we have a flow called FLOW_A containing a global transition like the following: \n    <global-transitions>\n        <transition on=\"something\" to=\"somewhere\">\n            <evaluate expression=\"myHandler.doSomething()\"/>\n        </transition>  \n    </global-transitions>\nSuppose FLOW_A has a parent abstract flow FLOW_B also containing some global transitions containing on-exceptions like the following:\n    <global-transitions>\n        <transition on-exception=\"Exception1\" to=\"somewhere\">\n            <evaluate expression=\"exceptionHandler.handleException1(rootCauseException)\"/>\n        </transition>\n        <transition on-exception=\"Exception2\" to=\"somewhere\">\n            <evaluate expression=\"exceptionHandler.handleException2(rootCauseException)\"/>\n        </transition>\n    </global-transitions>\nDuring the merge of both global transitions the result will be something like:\n    <global-transitions>\n        <transition on=\"something\" to=\"somewhere\">\n            <evaluate expression=\"myHandler.doSomething()\"/>\n        </transition>  \n        <transition on-exception=\"Exception1\" to=\"somewhere\">\n            <evaluate expression=\"exceptionHandler.handleException2(rootCauseException)\"/>\n            <evaluate expression=\"exceptionHandler.handleException1(rootCauseException)\"/>\n        </transition>\n    </global-transitions>\ninstead of \n    <global-transitions>\n        <transition on=\"something\" to=\"somewhere\">\n            <evaluate expression=\"myHandler.doSomething()\"/>\n        </transition>  \n        <transition on-exception=\"Exception1\" to=\"somewhere\">\n            <evaluate expression=\"exceptionHandler.handleException1(rootCauseException)\"/>\n        </transition>\n        <transition on-exception=\"Exception2\" to=\"somewhere\">\n            <evaluate expression=\"exceptionHandler.handleException2(rootCauseException)\"/>\n        </transition>\n    </global-transitions>\nThis is because in the org.springframework.webflow.engine.model.TransitionModel.isMergeableWith(Model model) method only the \"on\" is considered and not \"on-exception\": \n    public boolean isMergeableWith(Model model) {\n        if (!(model instanceof TransitionModel)) \n{\n            return false;\n        }\n        TransitionModel transition = (TransitionModel) model;\n        return ObjectUtils.nullSafeEquals(getOn(), transition.getOn());\n    }\n\ninstead of \n\n    public boolean isMergeableWith(Model model) {\n        if (!(model instanceof TransitionModel)) {            return false;        }\n        TransitionModel transition = (TransitionModel) model;\n        return ObjectUtils.nullSafeEquals(getOn(), transition.getOn())\n                && ObjectUtils.nullSafeEquals(getOnException(), transition.getOnException());\n    }\n", "project": "Spring", "sub_project": "SWF", "version": "v2.0.3.RELEASE", "fixed_version": "v2.0.4.RELEASE", "fixed_files": ["org.springframework.webflow.engine.model.TransitionModelTests.java", "org.springframework.webflow.engine.model.TransitionModel.java"], "label": 1, "es_results": []}, {"bug_id": 923, "bug_title": "Global Transitions do not fire listeners", "bug_description": "Global transitions do not appear to fire listeners.  I think that transitionExecuting should be fired.\nI think that Flow.handleEvent should call \"return context.execute(transition);\" instead of  \"return transition.execute(currentState, context);\" as this will fire the events.\n", "project": "Spring", "sub_project": "SWF", "version": "v2.0.3.RELEASE", "fixed_version": "v2.0.4.RELEASE", "fixed_files": ["org.springframework.webflow.engine.Flow.java"], "label": 1, "es_results": []}, {"bug_id": 930, "bug_title": "Development mode flag not set for flows registered using flow-location-pattern", "bug_description": "Factory method needs to be added to flow definition resource factory that applies attributes to all flow resources and invoked by createResource.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.3.RELEASE", "fixed_version": "v2.0.4.RELEASE", "fixed_files": ["org.springframework.webflow.config.FlowRegistryFactoryBean.java", "org.springframework.webflow.config.FlowDefinitionResourceFactory.java"], "label": 1, "es_results": []}, {"bug_id": 899, "bug_title": "FlowResourceELResolver does not work outside of Web Flow environment", "bug_description": "Throws a NPE if the request context is null  resolution using resourceBundle is not possible when a jsf view is rendered by spring mvc directly", "project": "Spring", "sub_project": "SWF", "version": "v2.0.3.RELEASE", "fixed_version": "v2.0.5.RELEASE", "fixed_files": ["org.springframework.webflow.expression.el.ScopeSearchingELResolver.java", "org.springframework.webflow.expression.el.FlowResourceELResolver.java", "org.springframework.webflow.expression.el.ImplicitFlowVariableELResolver.java"], "label": 1, "es_results": []}, {"bug_id": 839, "bug_title": "After JSF validation/conversion errors, state is not returned correctly", "bug_description": "My page is showing both searchform and searchresults.\nWhen a user inputs wrong data in the searchform, validation errors are shown correctly to the user (request 1). When he then corrects the error and resubmits, everything works fine (request 2). When he then chages any input field and submits, the search is done using the new values (request 3...n), but the page is rerendered with the values of request 2.\nI was able to reproduce this on other pages (simple test pages, with 2 input fields) as well.\nThis issue might be related to issue 738.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.3.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowViewHandler.java", "org.springframework.faces.webflow.JsfView.java", "org.springframework.faces.webflow.JsfViewTests.java", "org.springframework.faces.webflow.JsfViewFactoryTests.java"], "label": 1, "es_results": []}, {"bug_id": 985, "bug_title": "Multiple JSF validators duplicate messages", "bug_description": "If a component contains multiple validators that each attach a message to the FacesContext <h:messages> components will return duplicate results.\nThis is due to FlowFacesContext.getClientIdsWithMessages() returning duplicate client IDs.\nOne method of fixing this is to change the IdentifiedMessageCriteria class to filter duplicate IDs:\n\tprivate class IdentifiedMessageCriteria implements MessageCriteria {\n\t\tString nullSummaryId = null + SUMMARY_MESSAGE_KEY;\n\t\tprivate Set identifiedMessageSources = new HashSet();\n\t\tpublic boolean test(Message message) {\n\t\t\tif (message.getSource() == null || message.getSource().equals(\"\")\n\n\n message.getSource().equals(nullSummaryId)\n\n\n message.getSource().toString().endsWith(DETAIL_MESSAGE_KEY)) \n{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn identifiedMessageSources.add(message.getSource());\n\t\t}\n\t}\n\n\nI will update the patch in SWF-716 for this.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.3.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowFacesContext.java", "org.springframework.faces.webflow.FlowFacesContextTests.java"], "label": 1, "es_results": []}, {"bug_id": 939, "bug_title": "Locating of flow definitions broken when base-path not being used", "bug_description": "A previously functional SWF 2.0.3 based application has stopped working after upgrading to SWF 2.0.4\nFlow definitions are no longer being found due to the change re: using flow definition path as the flow id, rather than the flow definition file name.\n\t<webflow:flow-executor id=\"flowExecutor\" flow-registry=\"flowRegistry\">\n\t\t<webflow:flow-execution-repository max-executions=\"1\" max-execution-snapshots=\"30\" />\n\t   \t<webflow:flow-execution-listeners>\n\t\t\t<webflow:listener ref=\"securityFlowExecutionListener\" />\n\t\t</webflow:flow-execution-listeners>\n\t</webflow:flow-executor>\n\t<!-- The registry of executable flow definitions -->\n\t<webflow:flow-registry id=\"flowRegistry\" flow-builder-services=\"facesFlowBuilderServices\">\n\t\t<webflow:flow-location-pattern value=\"/WEB-INF/flow/*/.xml\"/>\n\t</webflow:flow-registry>\n\t<!-- Configures the Spring Web Flow JSF integration -->\n\t<faces:flow-builder-services id=\"facesFlowBuilderServices\" />\nThe flow definition located at /WEB-INF/flow/login/login.xml gets stored in the flowDefinitionRegistry\nwith an id of \"login\" in both SWF 2.0.3 and 2.0.4.\nHowever, when attempting to request the flow - SWF 2.0.3 looks for \"login\" in the registry,\nwhere as SWF 2.0.4 looks for \"flow/login\" and fails to find it.\nI believe this is due to a shift in approach to wishing to use the flow definition&apos;s path as the flow id, rather than the flow name.\nThe piece of code for determining the flow id when a request comes in is DefaultFlowUrlHandler.getFlowId().\nSWF 2.0.3 implementation returns \"login\" as the id -\n\tpublic String getFlowId(HttpServletRequest request) {\n\t\tString pathInfo = request.getPathInfo();\n\t\tif (pathInfo != null) \n{\n\t\t\treturn pathInfo.substring(1);\n\t\t}\n else \n{\n\t\t\t. . . \n\t\t}\n\t}\nSWF 2.0.4 implementation returns \"flow/login\" as the id -\n\tpublic String getFlowId(HttpServletRequest request) \n{\n\t\treturn WebUtils.extractFilenameFromUrlPath(urlPathHelper.getLookupPathForRequest(request));\n\t}\n\nAs SWF 2.0.4 is a point release hopefully it shouldn&apos;t be breaking existing applications.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.4.RELEASE", "fixed_version": "v2.0.5.RELEASE", "fixed_files": ["org.springframework.webflow.mvc.servlet.FlowController.java"], "label": 1, "es_results": []}, {"bug_id": 948, "bug_title": "Base path behavior inconsistent between flow-location and flow-location-pattern", "bug_description": "WORKS\n<webflow:flow-registry id=\"flowRegistry\" flow-builder-services=\"facesFlowBuilderServices\" base-path=\"/WEB-INF/\">\n<webflow:flow-location path=\"hotel/search/search.xml\" />\n</webflow:flow-registry>\nWORKS\n<webflow:flow-registry id=\"flowRegistry\" flow-builder-services=\"facesFlowBuilderServices\" base-path=\"/WEB-INF/\">\n<webflow:flow-location-pattern value=\"*/.xml\" />\n</webflow:flow-registry>\nWORKS\n<webflow:flow-registry id=\"flowRegistry\" flow-builder-services=\"facesFlowBuilderServices\" base-path=\"/WEB-INF\">\n<webflow:flow-location-pattern value=\"*/.xml\" />\n</webflow:flow-registry>\nWORKS\n<webflow:flow-registry id=\"flowRegistry\" flow-builder-services=\"facesFlowBuilderServices\" base-path=\"/WEB-INF\">\n<webflow:flow-location-pattern value=\"/*/.xml\" />\n</webflow:flow-registry>\nDOES NOT WORK\n<webflow:flow-registry id=\"flowRegistry\" flow-builder-services=\"facesFlowBuilderServices\" base-path=\"/WEB-INF\">\n<webflow:flow-location path=\"hotel/search/search.xml\" />\n</webflow:flow-registry>\nDOES NOT WORK\n<webflow:flow-registry id=\"flowRegistry\" flow-builder-services=\"facesFlowBuilderServices\" base-path=\"/WEB-INF\">\n<webflow:flow-location path=\"/hotel/search/search.xml\" />\n</webflow:flow-registry>\n", "project": "Spring", "sub_project": "SWF", "version": "v2.0.4.RELEASE", "fixed_version": "v2.0.5.RELEASE", "fixed_files": ["org.springframework.webflow.config.FlowDefinitionResourceFactory.java"], "label": 1, "es_results": []}, {"bug_id": 953, "bug_title": "View data binding results lost after Action phase in Portlet environment, not propogating to Render phase.", "bug_description": "This has been confirmed, see:\nhttp://forum.springframework.org/showthread.php?t=60740\nMost likely the entire View instance needs to span the action/render request cycle.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.4.RELEASE", "fixed_version": "v2.0.5.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowViewHandler.java", "org.springframework.faces.webflow.JsfView.java", "org.springframework.webflow.mvc.portlet.PortletMvcView.java", "org.springframework.webflow.mvc.portlet.PortletMvcViewFactory.java", "org.springframework.webflow.mvc.portlet.PortletMvcViewTests.java", "org.springframework.webflow.mvc.view.AbstractMvcView.java"], "label": 1, "es_results": []}, {"bug_id": 964, "bug_title": "Redirect after POST causes UI to be inconsistent with model", "bug_description": "See forum thread: http://forum.springframework.org/showthread.php?t=63597", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowViewHandler.java", "org.springframework.faces.webflow.JsfView.java", "org.springframework.faces.webflow.JsfViewTests.java", "org.springframework.faces.webflow.JsfViewFactoryTests.java"], "label": 1, "es_results": []}, {"bug_id": 963, "bug_title": "Render phase ignores facesContext.responseComplete", "bug_description": "It seems that the render response phase of the JSF lifecycle is executed regardless of whether facesContext.responseComplete() has been called before.\nPerhaps, JsfView can check for this condition and return without rendering if it is true. \nAlso, just from a quick look into it, shouldn&apos;t externalContext.recordResponseComplete be set when facesContext.responseComplete() is called so that a redirect is also prevented?\nSee forum thread: http://forum.springframework.org/showthread.php?t=63607", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowFacesContext.java", "org.springframework.faces.webflow.JsfView.java", "org.springframework.faces.webflow.JsfViewTests.java"], "label": 1, "es_results": []}, {"bug_id": 976, "bug_title": "SimpleELContext is not thread-safe", "bug_description": "Class SimpleELContext extends javax.el.Context. \nJavadoc http://java.sun.com/products/jsp/2.1/docs/jsp-2_1-pfd2/javax/el/ELContext.html said :\n\"\"\"\" Because it stores state during expression evaluation, an ELContext object is not thread-safe \"\"\".\nInstance of SimpleELContext is stored in ELDelegatingPropertyResolver and ELDelegatingVariableResolver, which are application singletons, so this instance of SimpleELContext is shared for all sessions.\nThis bug is very strange, because in single user development/testing everything works fine, but in production with more users, we got usually NullPointerException on bizzarre places in program like this :\n>        String label = getItemLabel() != null ? getItemLabel().toString() : null;\nAttachment contains a patch, which helps me.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.faces.expression.ELDelegatingVariableResolver.java", "org.springframework.faces.expression.ELDelegatingPropertyResolver.java"], "label": 1, "es_results": []}, {"bug_id": 992, "bug_title": "Flow Id not properly calculated when using \"classpath*:\" style resources in base-path", "bug_description": "I am attempting to define flows in the following manner:\n    <webflow:flow-registry id=\"flowRegistry\" base-path=\"classpath*:/project\">\n      <webflow:flow-location-pattern value=\"/**/webflow.xml\"/>\n    </webflow:flow-registry>\nI have a webflow.xml in a jar file at the path:\nproject/proof/create/webflow.xml\nIdeally, the flowId would be \"proof/create\".\nWhen I do this, the flowId ends up being the full url (including the system file path, the jar url protocol, etc). If I change my flow-registry definition to:\n    <webflow:flow-registry id=\"flowRegistry\" base-path=\"classpath:/project\">\n      <webflow:flow-location-pattern value=\"/proof/create/webflow.xml\"/>\n    </webflow:flow-registry>\nit works fine. However, I lose a lot of flexibility this way (I intend to add many more flows, in multiple jar files).\nIt seems the culprit is in FlowDefinitionResourceFactory, in the \"removeClasspathScheme\" method. It strips \"classpath:\" from the front of the basePath, but doesn&apos;t look for \"classpath*:\". If I strip the \"classpath*:\" from the front of the basePath (with a debugger), it works as expected.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.webflow.config.FlowDefinitionResourceFactoryTests.java", "org.springframework.webflow.config.FlowDefinitionResourceFactory.java"], "label": 1, "es_results": []}, {"bug_id": 998, "bug_title": "FlowDefinitionResourceFactory.getFlowId does not remove the classpath scheme if the resource implements ContextResource", "bug_description": "In order to solve some other business requirements, I have created a custom Resource implementation that is returned when using \"classpath*:\" type resource patterns.  (It&apos;s essentially a UrlResource that implements ContextResource).  However, when FlowDefinitionResourceFactory attempts to calculate the flow id, it removes the classpath scheme from the beginning of the base path for every instance (where base path is used) except for if the resource implements ContextResource.  Looking at the code, I don&apos;t see any reason to skip it in this case, as in the common cases, invoking removeClasspathScheme will have no effect, while not artificially limiting any resource type that implements ContextResource.  \nI am attaching a patch that does this.  ", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.webflow.config.FlowDefinitionResourceFactory.java"], "label": 1, "es_results": []}, {"bug_id": 1016, "bug_title": "Richfaces rich:fileUpload transfer error", "bug_description": "Concerning the forum-conversation: http://forum.springframework.org/showthread.php?t=59485. According to this conversation this problem did not occur in SWF version 2.0.0. \nThe rich:fileUpload does not complete properly. It does upload the file but it doesn&apos;t complete correctly at clientside. i.e. the statusupdate in the component always puts a SERVER_TRANSFER_ERROR as message.\nThe fileUploadListener method of the backingbean fires correct but afterwards the component does not receive a correct AJAX acknowledge from the server. ", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.faces.webflow.TreeStructureManager.java", "org.springframework.faces.webflow.FlowViewStateManager.java"], "label": 1, "es_results": []}, {"bug_id": 1017, "bug_title": "FlowFacesContext does not return the same FacesMessages instances", "bug_description": "I am currently using a phase listener to fix up faces messages before they are displayed (a method described here http://www.oracle.com/technology/pub/articles/masterj2ee/j2ee_wk7.html).  Unfortunately FlowFacesContext creates a new FacesMessage adapted from spring messages on each call to FacesContext.getMessages().  This means that any set method called on the message is lost.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowFacesContext.java", "org.springframework.faces.webflow.FlowFacesContextTests.java"], "label": 1, "es_results": []}, {"bug_id": 1000, "bug_title": "JsfViewFactory not correctly checking if viewAlreadySet", "bug_description": "propose adding the viewName to method as in below:\n\tprivate boolean viewAlreadySet(FacesContext facesContext, String viewName) {\n\t\tif (facesContext.getViewRoot() != null && facesContext.getViewRoot().getViewId().equals(viewName)) \n{\n\t\t\t// the corner case where a before RESTORE_VIEW PhaseListener has handled setting the UIViewRoot\n\t\t\treturn true;\n\t\t}\n else \n{\n\t\t\treturn false;\n\t\t}\n\t}", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.faces.webflow.JsfViewFactory.java"], "label": 1, "es_results": []}, {"bug_id": 1025, "bug_title": "'valid' property of input components gets lost before JSF render phase in portlet", "bug_description": "The request cycle of a portlet usually constists of an seperate ActionRequest and RenderRequest.\nSpring Faces does bridge these two independant Requests. Specific to the portlet environment the ViewRoot of the JSF component tree is saved at the end of the ActionRequest and restored before JSF enters the render response phase. This way the component tree itself and its state is correcly preserved for rendering. The ViewRoot gets restored in JsfViewFactory.getView(). In this method JsfViewFactory.processTree() also gets called and resets the &apos;valid&apos; property of EditableValueHolder componets to &apos;true&apos;. \nThis might be correct before JSF processes the ActionRequest but is NOT correct before JSF enters the render response phase within the RenderRequest. \nThe state information of the &apos;valid&apos; property is lost and components whose rendering depend on that property (set to &apos;false&apos; in the ActionRequest because of an validation error) display incorrectly.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.6.RELEASE", "fixed_files": ["org.springframework.faces.webflow.JsfViewFactory.java"], "label": 1, "es_results": []}, {"bug_id": 1082, "bug_title": "SelectionTrackingActionListener throws NPE when component's parent is null", "bug_description": "SelectionTrackingActionListener tries to inspect current UIComponent if it is child component of a parent UIComponent which uses SelectionAware. When I try to use SWF 2.0.5 together with JBoss&apos;s Gravel JSF components there are cases when parent component of UIComponent which signals current ActionEvent is NULL. In such a case we simply get NPE in trackSelection method.\nA simple null check like below will suffice to get rid of this little bug:\nprivate void trackSelection(UIComponent component) {\n             // Find parent component with a SelectionAware model if it exists\n            UIComponent currentComponent = component;\n            while (currentComponent.getParent() != null && !(currentComponent.getParent() instanceof UIViewRoot)) {\n...\n}\n", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.7.RELEASE", "fixed_files": ["org.springframework.faces.model.SelectionTrackingActionListener.java"], "label": 1, "es_results": []}, {"bug_id": 1021, "bug_title": "AbstractFlowExecutionTests.assertFlowExecutionOutcomeEquals() has jUnit arguments reversed", "bug_description": "junit.framework.ComparisonFailure: The flow execution outcome is wrong expected:<[actual]> but was:<[expected]>\nThe error message for a unit test failure has its arguments reversed - the \"expected\" value is being shown as the \"actual\" value.\nThe other assert helper methods appear to be correct.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.8.RELEASE", "fixed_files": ["org.springframework.webflow.test.execution.AbstractFlowExecutionTests.java"], "label": 1, "es_results": []}, {"bug_id": 1027, "bug_title": "FilenameFlowUrlHandler does not implement createFlowDefinitionUrl", "bug_description": "FilenameFlowUrlHandler, which was introduced in 2.0.4, extracts the flow id from an http request. However, it fails to construct the correct URL given the flow id. I think this should be implemented by overriding createFlowDefinitionUrl.\nTest case:\n1) configure a flow executor repository with max-executions=\"1\"\n2) Start a flow \"X\". \n3) Now start another flow \"Y\" by navigating to the URL of the \"Y\" flow. \n4) Press back on the browser. If the createFlowDefinitionUrl method works correctly then the system should take you to the beginning of a new flow \"X\".", "project": "Spring", "sub_project": "SWF", "version": "v2.0.5.RELEASE", "fixed_version": "v2.0.8.RELEASE", "fixed_files": ["org.springframework.webflow.context.servlet.FilenameFlowUrlHandlerTests.java", "org.springframework.webflow.context.servlet.FilenameFlowUrlHandler.java", "org.springframework.webflow.context.servlet.DefaultFlowUrlHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1066, "bug_title": "ManySelectionTrackingListDataModel and OneSelectionTrackingListDataModel do not track selections correctly when using a <rich:dataScroller> component", "bug_description": "Using an eagerly loaded DataModel (i.e., loading an entire list of results into memory at once and then scrolling through that list via subsequent requests) uncovers a bug in the setCurrentRowSelected implementations in ManySelectionTrackingListDataModel and OneSelectionTrackingListDataModel where the selections potentially get \"lost\" across requests.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.6.RELEASE", "fixed_version": "v2.0.7.RELEASE", "fixed_files": ["org.springframework.faces.model.OneSelectionTrackingListDataModel.java", "org.springframework.faces.model.ManySelectionTrackingListDataModel.java"], "label": 1, "es_results": []}, {"bug_id": 1092, "bug_title": "AjaxTilesView composite definition traversal algorithm ignores AttributeType", "bug_description": "When looking for a fragment of a composite view to render, the AjaxTilesView traverses nested definitions on the composite.  Unfortunately, it is also treating template and string attributes as definition ids, which can cause the wrong definition to render when the name of the attribute is the same as another, unrelated definition.\nThe algorithm in AjaxTilesView should only consider definition attributes...\nThis is a potential security risk as it could allow a client to render unrelated composites outside control of server, so I&apos;m marking it critical for 2.0.7.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.6.RELEASE", "fixed_version": "v2.0.7.RELEASE", "fixed_files": ["org.springframework.js.ajax.tiles2.AjaxTilesView.java"], "label": 1, "es_results": []}, {"bug_id": 1098, "bug_title": "Execution key is not always incremented.", "bug_description": "It&apos;s easy to reproduce with booking-mvc. Enter Book Hotel data, go to confirm (e1s2). Press Back and press Proceed again (e1s2). I should see e1s3.\nA specific use case where this is an issue is where a page has links that open browser popup windows. Each browser popup ends up with the same execution key, which is initially fine but if you try to refresh the first browser popup you get the content of the second.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.6.RELEASE", "fixed_version": "v2.0.7.RELEASE", "fixed_files": ["org.springframework.webflow.execution.repository.impl.DefaultFlowExecutionRepository.java", "org.springframework.webflow.execution.repository.support.AbstractFlowExecutionRepository.java", "org.springframework.webflow.execution.repository.impl.FlowExecutionSnapshotGroup.java", "org.springframework.webflow.execution.repository.impl.SimpleFlowExecutionSnapshotGroup.java"], "label": 1, "es_results": []}, {"bug_id": 1112, "bug_title": "JSF 1.2-specific call to StateManager.saveView should be replaced with saveSerializedView for JSF 1.1 compatibiliy", "bug_description": "See SWF-1096 for the reason this call was introduced in 2.0.7. Jeremy suggests to use saveSerializedView instead of saveView; the latter doesn&apos;t exist in JSF 1.1 apparently. Currently, this causes a NoSuchMethodError for\njavax/faces/application/StateManager.saveView(Ljavax/faces/context/FacesContext;)Ljava/lang/Object; ", "project": "Spring", "sub_project": "SWF", "version": "v2.0.7.RELEASE", "fixed_version": "v2.0.8.RELEASE", "fixed_files": ["org.springframework.faces.webflow.JsfView.java"], "label": 1, "es_results": []}, {"bug_id": 1115, "bug_title": "Id handling of Spring AjaxViewRoot causes problems to RichFaces AjaxViewRoot", "bug_description": "There is a serious problem when combining Spring-faces ajax components and Rich faces Ajax components.\nThis is most easily noticed since 2.0.7, when the jsf view state is saved as part of the flow history. To reproduce open a spring popup view-state using an sf:commandButton and cancel it by pressing Esc or X. After that, no rich-faces ajax requests will be able to work.\nThe reason seems to be the following: Spring&apos;s AjaxViewRoot effectively replaces in its constructor the ID of the underlying ViewRoot with a newly generated unique id appended by \"_ajax\". This ID remains in the state of the original ViewRoot even after Spring - AjaxViewRoot has finished its job. RichFaces - AjaxViewRoot relies on its ID to determine which part of the component tree to process. Therefore, since its ID has been replaced, the processing never happens on the whole ViewRoot as it should.\nThis is also easily reproduced by firing an sf:commandButton action that does not transition to another view. After that request is processed, subsequent rich-faces ajax requests will not work.\nYou may consider the small patch I am attaching. This should be ok unless you think there are deeper complications here.\nThanks and regards.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.7.RELEASE", "fixed_version": "v2.0.8.RELEASE", "fixed_files": ["org.springframework.faces.ui.AjaxViewRoot.java"], "label": 1, "es_results": []}, {"bug_id": 1144, "bug_title": "NPE in FlowHandlerAdapter.sendFlowDefinitionRedirect when flowRedirect does not have parameters appended to it", "bug_description": "When defining a flowRedirect without a ? appended to it, a NPE is thrown at FlowHandlerAdapter.sendFlowDefinitionRedirect as the input map from context.getFlowRedirectFlowInput() is null. \nFor example, defining a <view-state id=\"test\" view=\"flowRedirect:other-test\"/>, this NPE will be encountered. \nSo far, what I can find is that when there is no ? appended to the end of the flowRedirect:<flow>, the input map is not created. The corresponding code in the FlowDefinitionRedirectAction.doExecute is \nint index = encodedRedirect.indexOf(&apos;?&apos;);\nString flowDefinitionId;\nLocalAttributeMap executionInput = null;\nif (index != -1) {\n  flowDefinitionId = encodedRedirect.substring(0, index);\n  String[] parameters = StringUtils.delimitedListToStringArray(encodedRedirect.substring(index + 1), \"&\");\n  executionInput = new LocalAttributeMap(parameters.length, 1);\n  for (int i = 0; i < parameters.length; i++) {\n    String nameAndValue = parameters[i];\n    index = nameAndValue.indexOf(&apos;=&apos;);\n    if (index != -1) \n{\n      executionInput.put(nameAndValue.substring(0, index), nameAndValue.substring(index + 1));\n    }\n else \n{\n      executionInput.put(nameAndValue, \"\");\n    }\n  }\n} else {\n  flowDefinitionId = encodedRedirect;\n}\nexecutionInputMap is only created if there is a ? in the flow redirect. If it does not exist, the map continues to remain null, whilst the flowRedirect action is created. ", "project": "Spring", "sub_project": "SWF", "version": "v2.0.7.RELEASE", "fixed_version": "v2.0.8.RELEASE", "fixed_files": ["org.springframework.webflow.context.portlet.PortletExternalContextTests.java", "org.springframework.webflow.context.portlet.PortletExternalContext.java", "org.springframework.webflow.context.servlet.ServletExternalContext.java", "org.springframework.webflow.context.servlet.ServletExternalContextTests.java"], "label": 1, "es_results": []}, {"bug_id": 1146, "bug_title": "Validator only runs if signature matches exact model object Class", "bug_description": "when writing a Validator component, (matching the conventions of name), the signature of the method must match exactly the command object type.\nLet&apos;s say my validation method is :\nvalidateMyViewId(MyObject command, ValidationContext ctx) (...)\nThen the validator will not run if command object is of type MyExtendedObject (extends MyObject)\nThis is a critical behaviour, in case the command object changes during the webflow, then validation won&apos;t be run anymore.\n(The match is done in ValidationHelper class)", "project": "Spring", "sub_project": "SWF", "version": "v2.0.7.RELEASE", "fixed_version": "v2.0.8.RELEASE", "fixed_files": ["org.springframework.webflow.validation.ValidationHelper.java", "org.springframework.webflow.validation.StubModelMessageContext.java", "org.springframework.webflow.validation.ValidationHelperTests.java"], "label": 1, "es_results": []}, {"bug_id": 1133, "bug_title": "Endless Redirects happens when more then one request Parameter is present on redirect", "bug_description": "If you implement your own FlowUrlHandler that re adds request parameter to the url even in case of a redirect you get endless redirects. This is caused by the simple implementation inside the JsfView for UserEvents:\n\tpublic boolean userEventQueued() \n{\n\t\treturn requestContext.getRequestParameters().size() > 1;\n\t}\n\nWhich answers true to having a user event queued if more the one parameter (assuming the one is the flow execution key) is present.  If that request is not a Ajax request you get a new redirect (and a new and a new). Problem is i could remove the parameters inside our FlowUrlHandlers createFlowExecutionUrl method but then those parameters would not be present at url after the redirect which can lead to wrong bookmarking or wrong behavouir after a reload.\nNot sure if this is really a bug from your side. But atleast its a undesireable implementation in my eyes.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.7.RELEASE", "fixed_version": "v2.0.8.RELEASE", "fixed_files": ["org.springframework.faces.webflow.JsfView.java"], "label": 1, "es_results": []}, {"bug_id": 1187, "bug_title": "MyFaces bugs causes FacesMessage serialization failure in a clustered environment", "bug_description": "One of changes in webflow 2.07 causes the message context to be stored across redirects, unfortunately a current MyFaces bug (https://issues.apache.org/jira/browse/MYFACES-1347) causes serialization failure when running in a clustered environment.\nSince the MyFaces issue has been opened since 2006 here is a work around patch that could be applied to webflow.\nAs this is a MyFaces issue you might not want to apply the patch but I will post it here anyway in case anyone else hits the same issue.", "project": "Spring", "sub_project": "SWF", "version": "v2.0.7.RELEASE", "fixed_version": "v2.0.9.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowFacesContextTests.java", "org.springframework.faces.webflow.FlowFacesContextMessageDelegate.java"], "label": 1, "es_results": []}, {"bug_id": 1213, "bug_title": "Problem with clustered sessions", "bug_description": "Problem described in the forum at http://forum.springsource.org/showthread.php?t=86144\nIt seems fairly easy to fix this at the source, re-put the conversationContainer at end of FlowExecutorImpl.launchExecution (or at end of SessionBindingConversationManager.beginConversation() as mentioned in forum).\nWorkaround right now is using a custom filter with the app which re-puts the conversationContainer at end of every request. Something like below filter:\npublic class SpringWebflowWorkaroundFilter implements Filter {\n  private static final String WEBFLOW_CONVERSATION_CONTAINER_KEY = \"webflowConversationContainer\";\n  public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException,\n      ServletException \n{\n    chain.doFilter(request, response);\n    springWebflowWorkaround(((HttpServletRequest) request).getSession());\n  }\n  private void springWebflowWorkaround(HttpSession session) {\n    if (session == null) return;\n    // reput the conversationContainer after every request\n    Object conversationContainer = session.getAttribute(WEBFLOW_CONVERSATION_CONTAINER_KEY);\n    if (conversationContainer != null) \n{\n      session.setAttribute(WEBFLOW_CONVERSATION_CONTAINER_KEY, conversationContainer);\n    }\n  }\n}", "project": "Spring", "sub_project": "SWF", "version": "v2.0.8.RELEASE", "fixed_version": "v2.0.9.RELEASE", "fixed_files": ["org.springframework.webflow.executor.FlowExecutorImpl.java", "org.springframework.webflow.executor.FlowExecutorImplTests.java"], "label": 1, "es_results": []}, {"bug_id": 1229, "bug_title": "Converter to Collection type is wrapped with a second Collection", "bug_description": "When creating a custom converter from a String to a List, the org.springframework.binding.convert.converters.ObjectToCollection converter is wrapping the proper type with an extra collection.\nFor example, the user would type \"a,b,k\" in the input and the custom converter would create a list of Fruit objects \"Apple\", \"Banana\", and \"Kiwi\". What is being set is a list containing the list of fruit returned by the custom converter.\nlist[list[\"Apple\", \"Banana\", \"Kiwi\"]]\ninstead of\nlist[\"Apple\", \"Banana\", \"Kiwi\"]\nPOJO\nCode:\npublic class Fruit {\n  private String name;\n  //getters/setters for name\n}\nPOJO\nCode:\npublic class FruitBowl{\n  private List<Fruit> fruits;\n  public List<Fruit> getFruits()\n{ return this.fruits; }\n  public void setFruits(List<Fruit> fruits)\n{ this.fruits = fruits; }\n}\nConverter\nCode:\npublic class FruitCsvConverter extends StringToObject{\n  public FruitCsvConverter()\n{\n    super(List.class);\n  }\n\n  protected String toString(Object object) throws Exception \n{\n    StringBuilder sb = new StringBuilder();\n    List fruits = (List)object;\n    //loop over fruits building the CSV string\n    return sb.toString();\n  }\n  protected Object toObject(String string, Class targetClass) throws Exception \n{\n    ArrayList<Fruit> fruits = new ArrayList<Fruit>();\n    //parse the CSV into the fruit\n    return fruits;\n  }\n}\nfruit-flow.xml\nCode:\n...\n<view-state id=\"fruitInformation\" model=\"fruitBowl\">\n  <binder>\n    <binding property=\"fruits\" converter=\"fruitCsv\" />\n  </binder>\n</view-state>\n...\nDebug Mapping\n2010-04-07 15:52:08,708 DEBUG [org.springframework.binding.mapping.impl.DefaultMa pping] - <Adding mapping result [Success@fe135d mapping = parameter:&apos;fruits&apos; -> fruits, code = &apos;success&apos;, error = false, originalValue = &apos;a,b,k&apos;, mappedValue = list[list[com.site.Fruit@1ec9d2, com.site.Fruit@1ec9d2, com.site.Fruit@feaf]]]>\n", "project": "Spring", "sub_project": "SWF", "version": "v2.0.8.RELEASE", "fixed_version": "v2.1.0.M1", "fixed_files": ["org.springframework.binding.convert.service.DefaultConversionServiceTests.java", "org.springframework.binding.convert.service.GenericConversionService.java"], "label": 1, "es_results": []}, {"bug_id": 1247, "bug_title": "MessageContextErrors ResolveMessageCodes", "bug_description": "In the MessageContextErrors.rejectValue(...) method the default message is passed into resolveMessageCodes(...) incorrectly.\nThe current method call is as follows:\nresolveMessageCodes(errorCode, defaultMessage, field, fieldType)\nThe correct method call is as follows:\nresolveMessageCodes(errorCode, objectName, field, fieldType)", "project": "Spring", "sub_project": "SWF", "version": "v2.0.8.RELEASE", "fixed_version": "v2.3.0.RELEASE", "fixed_files": ["org.springframework.binding.message.MessageContextErrors.java", "org.springframework.binding.message.MessageContextErrorsTests.java"], "label": 1, "es_results": []}, {"bug_id": 1261, "bug_title": "Incorrect distribution of methods between FlowApplication and Jsf2FlowApplication", "bug_description": "Some JSF 1.2 specific methods were erroneously added to Jsf2FlowApplication instead of FlowApplication. This causes backwards compatibility issues with Apache MyFaces 1.2 where some of these methods throw UnsupportedOperationException. ", "project": "Spring", "sub_project": "SWF", "version": "v2.1.0.RELEASE", "fixed_version": "v2.1.1.RELEASE", "fixed_files": ["org.springframework.faces.webflow.Jsf2FlowApplication.java", "org.springframework.faces.webflow.FlowApplication.java"], "label": 1, "es_results": []}, {"bug_id": 1263, "bug_title": "Split out JSF 2 specific methods from FlowFacesContext for backwards compatibility with JSF 1.2", "bug_description": "While it is generally possible to  use FlowFacesContext in JSF 1.2 because JSF 2 methods (and types) are never called, if the faces context is used in EL expressions in a JSF view, then the introspection causes all declared methods to load their input and output types causing ClassCastException.", "project": "Spring", "sub_project": "SWF", "version": "v2.1.0.RELEASE", "fixed_version": "v2.1.1.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowFacesContext.java", "org.springframework.faces.webflow.ExternalContextWrapper.java"], "label": 1, "es_results": []}, {"bug_id": 1381, "bug_title": "FlowExecutionImpl: handleException ignores result of another handleException", "bug_description": "method handleException of class org.springframework.webflow.engine.impl.FlowExecutionImpl calls recursively if another exception during processing of original exception happens, but\nno further check about result of exception handling (from recursive method) will be done. As result effort of another exception handling call will be ignored and oldest exception will rethrown \n<code>\nboolean handled = false;\n\t\ttry {\n\t\t\tif (tryStateHandlers(exception, context) || tryFlowHandlers(exception, context)) \n{\n\t\t\t\thandled = true;\n\t\t\t}\n\t\t} catch (FlowExecutionException newException) \n{\n\t\t\t// exception handling itself resulted in a new FlowExecutionException, try to handle it\n\t\t\thandleException(newException, context);\n\t\t}\n\t\tif (!handled) {\n\t\t\tif (logger.isDebugEnabled()) \n{\n\t\t\t\tlogger.debug(\"Rethrowing unhandled flow execution exception\");\n\t\t\t}\n\t\t\tthrow exception;\n\t\t}\n</code>\nOne of possible solution is to give method return value or to store variable handled in ThreadLocal, finally do not forget to re-throw latest not original exception if handling completely failed.", "project": "Spring", "sub_project": "SWF", "version": "v2.1.0.RELEASE", "fixed_version": "v2.2.0.RC1", "fixed_files": ["org.springframework.webflow.engine.impl.FlowExecutionImpl.java", "org.springframework.webflow.engine.impl.FlowExecutionImplTests.java"], "label": 1, "es_results": []}, {"bug_id": 1385, "bug_title": "servletRelative redirects do not work with default-servlet-handler", "bug_description": "When using the default-servlet-handler element from Spring 3.0.4 and later (and thus mapping the DispatcherServlet to the default servlet), servletRelative redirects on an end state do not work as expected.  \nFor example, if I have an end state in the \"rewards/newReward\" flow defined like so:\n\t<end-state id=\"rewardConfirmed\" view=\"externalRedirect:servletRelative:/rewards/1\" />\nThis will not redirect to /rewards/1 as expected.  Instead, it redirects to /rewards/newReward/rewards/1.\nIt&apos;s worth  noting that as a workaround, a contextRelative redirect works fine.", "project": "Spring", "sub_project": "SWF", "version": "v2.1.0.RELEASE", "fixed_version": "v2.2.0.RC1", "fixed_files": ["org.springframework.webflow.mvc.servlet.FlowHandlerAdapterTests.java", "org.springframework.webflow.mvc.servlet.FlowHandlerAdapter.java"], "label": 1, "es_results": []}, {"bug_id": 1238, "bug_title": "AjaxTilesView fails to render multiple fragments", "bug_description": "We decided to use Spring 3 and Spring Web Flow 2.1.0.M1 to get around Bug SWF-1053 on Tomcat 6.\nAjaxTilesView only renders the first fragment when multiple fragments are requested. In 2.0.9 rendering of multiple fragments worked properly.\nOur configuration:\n\n\n\n\n\n\n<bean id=\"tilesViewResolver\" class=\"org.springframework.js.ajax.AjaxUrlBasedViewResolver\">\n\n\n\n\n\t\t<property name=\"order\" value=\"2\" />\n\n\n\n\n\t\t<property name=\"viewClass\"\n\n\n\n\n\t\t\tvalue=\"org.springframework.js.ajax.tiles2.AjaxTilesView\" />\n\n\n\n\n</bean>\n\n\n\n\n\n\nI noticed in 2.0.9 version of AjaxTilesView the line\nresponse.flushBuffer(); was present in renderMergedOutputModel\nIn 2.1.0.M1 this line is commented out.\nWhen I remove the comment the view works again. We&apos;ve tested with IE6 and Firefox 3.6.3\nAfter some debugging with Firebug I think that I&apos;ve found the problem.\nWithout the response.flushBuffer(); the server send a Content-length header with the length of the first fragment only. Obviously the browser stops reading the request after the content length has been reached.\nWith response.flushBuffer();  the response doesn&apos;t contain a  Content-length at all and all fragments get rendered by the browser.", "project": "Spring", "sub_project": "SWF", "version": "v2.1.0.M1", "fixed_version": "v2.1.0.M2", "fixed_files": ["org.springframework.js.ajax.tiles2.AjaxTilesViewTests.java", "org.springframework.js.ajax.tiles2.AjaxTilesView.java"], "label": 1, "es_results": []}, {"bug_id": 1245, "bug_title": "Incorrect PhaseListener execution order", "bug_description": "JSF 1.1 and 1.2 spec say in the chapter &apos;11.3 PhaseListeners&apos; that \"When the lifecycle phase exits, due\nto an exception or normal termination, the afterPhase() listeners must be called in\nreverse order from the beforePhase() listeners in the following manner.\"\nIn Spring Faces, the PhaseListeners beforePhase() and afterPhase() methods are invoked in the same order, not complying the spec.\nSee org.springframework.faces.webflow.JsfUtils notifyBeforeListeners() and notifyAfterListeners() methods.", "project": "Spring", "sub_project": "SWF", "version": "v2.1.0.M2", "fixed_version": "v2.1.0.RC1", "fixed_files": ["org.springframework.faces.webflow.JsfUtils.java"], "label": 1, "es_results": []}, {"bug_id": 1250, "bug_title": "Using history=\"invalidate\" results in ConversionExecutorNotFoundException where target class is org.springframework.webflow.engine.History", "bug_description": "This would have been handled previously by the StringToLabeledEnum converter.", "project": "Spring", "sub_project": "SWF", "version": "v2.1.0.RC1", "fixed_version": "v2.1.0.RELEASE", "fixed_files": ["org.springframework.webflow.execution.ScopeType.java", "org.springframework.webflow.action.ResultObjectBasedEventFactoryTests.java", "org.springframework.webflow.mvc.builder.MvcEnvironment.java", "org.springframework.webflow.action.ResultObjectEventFactoryTests.java", "org.springframework.webflow.engine.builder.model.FlowModelFlowBuilder.java", "org.springframework.binding.message.Severity.java", "org.springframework.webflow.engine.History.java", "org.springframework.binding.convert.service.DefaultConversionService.java", "org.springframework.webflow.engine.impl.FlowExecutionStatus.java", "org.springframework.webflow.scope.ScopeRegistrar.java"], "label": 1, "es_results": []}, {"bug_id": 1389, "bug_title": "MessageContextErrors does not obey the Errors contract", "bug_description": "As explained in the above forum thread, MessageContextErrors throws a runtime exception when any class-level JSR-303 @Constraints are violated. The bug is in the rejectValue method:\n\n\n\n\n\n\nMessageContextErrors#rejectValue(String, String, Object[], String)\n\n\n\n\n\n\npublic void rejectValue(String field, String errorCode, Object[] errorArgs, String defaultMessage) {\n\n\n\n\n\tfield = fixedField(field);\n\n\n\n\n\tClass fieldType;\n\n\n\n\n\tif (expressionParser != null) {\n\n\n\n\n\t\tFluentParserContext parserContext = new FluentParserContext().evaluate(boundObject.getClass());\n\n\n\n\n                // Bug! Next line assumes field is not blank; Errors contract says it CAN be blank\n\n\n\n\n\t\tfieldType = expressionParser.parseExpression(field, parserContext).getValueType(boundObject);\n\n\n\n\n\t} else {\n\n\n\n\n\t\t...\n\n\n\n\n\t}\n\n\n\n\n\t...\n\n\n\n\n}\n\n\n\n\n\n\nAs indicated in the comment marked \"Bug!\", the problem is that the above method expects the \"field\" argument not to be blank, even though the Errors contract says that it can be (to indicate a global error).\nOne (the only?) effect of this bug is that class-level JSR-303 constraints do not work properly in Spring Web Flow applications that perform validation by delegating to the Spring JSR-303 validation logic.\nAnyone experiencing this bug can work around it by subclassing SpringValidatorAdapter (or LocalValidatorFactoryBean if that&apos;s what you&apos;re currently using) and overriding validate(Object target, Errors errors) it so that it calls Errors#reject(String errorCode, Object[] errorArgs, String defaultMessage) in the case of any class-level violations (i.e. where the field name is blank). I&apos;ll provide some sample code in the forum thread.", "project": "Spring", "sub_project": "SWF", "version": "v2.1.1.RELEASE", "fixed_version": "v2.2.0.RC1", "fixed_files": ["org.springframework.binding.message.MessageContextErrors.java", "org.springframework.binding.message.MessageContextErrorsTests.java"], "label": 1, "es_results": []}, {"bug_id": 1402, "bug_title": "FlowViewResponseStateManager should call delegate isPostback()", "bug_description": "The new FlowViewResponseStateManager classes uses a delegate for most method calls but let us .isPostback fall through to the super class.\nI think that this may cause some problems for non JSF requests as there is a difference between ResponseStateManager (the superclass):\n    public boolean isPostback(FacesContext context) \n{\n        return (!context.getExternalContext().getRequestParameterMap().isEmpty());\n    }\n\nand ResponseStateManagerImpl (the delegate)\n    public boolean isPostback(FacesContext context) \n{\n        return context.getExternalContext().getRequestParameterMap().\n              containsKey(ResponseStateManager.VIEW_STATE_PARAM);\n    }\n\nThat means any URL with a parameter is considered a postback.\nFlowViewResponseStateManager should probably use:\n\tpublic boolean isPostback(FacesContext context) \n{\n\t\treturn delegate.isPostback(context);\n\t}\n\n\nIt may also be worth considering changing FlowRenderKit.getResponseStateManager() to only return FlowViewResponseStateManager when JsfUtils.isFlowRequest() returns true.", "project": "Spring", "sub_project": "SWF", "version": "v2.2.0.RC1", "fixed_version": "v2.2.0.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowRenderKit.java", "org.springframework.faces.webflow.FlowViewResponseStateManager.java"], "label": 1, "es_results": []}, {"bug_id": 1406, "bug_title": "Regression in showing global messages only", "bug_description": "Global messages are identified as follows:\n(isGlobalOnly) ? facesContext.getMessages(null) : facesContext.getMessages();\nfacesContext.getMessages(null) incorrectly returns all messages.\n", "project": "Spring", "sub_project": "SWF", "version": "v2.2.0.RELEASE", "fixed_version": "v2.2.1.RELEASE", "fixed_files": ["org.springframework.faces.webflow.FlowFacesContextTests.java", "org.springframework.faces.webflow.FlowFacesContextMessageDelegate.java"], "label": 1, "es_results": []}, {"bug_id": 1432, "bug_title": "JsfAjaxHandler does not set content type when sending a partial response with a redirect instruction", "bug_description": "After clicking \"Find Hotels\" in the booking-faces sample, the resulting response (which contains XML) doesn&apos;t have a Content-Type header. As a result the redirect works in some situations but not all. In particular it doesn&apos;t work in MSIE and it doesn&apos;t work if the app is fronted by Apache httpd which adds a stock text/html content-type (apparently browsers won&apos;t recognize this as XML). ", "project": "Spring", "sub_project": "SWF", "version": "v2.2.0.RELEASE", "fixed_version": "v2.3.0.RELEASE", "fixed_files": ["org.springframework.faces.webflow.JsfAjaxHandlerTests.java", "org.springframework.faces.webflow.JsfAjaxHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1416, "bug_title": "Turn off snapshot creation when max-snapshots=\"0\"", "bug_description": "Creating snapshots involves serializing and compressing the flow execution object, which can lead to issues with some PersistenceContext providers. Having the ability to turn off snapshot creation will provide an option when such issues occur at the cost of losing back button support.", "project": "Spring", "sub_project": "SWF", "version": "v2.2.1.RELEASE", "fixed_version": "v2.0.2.RELEASE", "fixed_files": ["org.springframework.webflow.execution.repository.impl.DefaultFlowExecutionRepository.java"], "label": 1, "es_results": []}, {"bug_id": 1437, "bug_title": "Two concurrent threads in an expression of a flow override the rootobject of evaluation context", "bug_description": "When two concurrent threads are evaluating an expression contained in a flow, the evaluation context linked to the expression can be overriden by multiple threads.\nResult is in most of cases NullPointerException in a getValueInternal of classes from  org.springframework.expression.spel.ast package (like PropertyOrFieldReference for example).\nWrong code seems to be in org.springframework.binding.expression.spel.SpringELExpression :\n\tpublic Object getValue(Object rootObject) throws EvaluationException {\n\t\ttry {\n\t\t\tupdateEvaluationContext(rootObject);\n\t\t\treturn expression.getValue(evaluationContext, expectedType);\n...\nAs the SpringElExpression is unique for the expression to be evaluated, it&apos;s not thread safe when updating the evaluation context with root object.\nSynchronize this method resolves problem.\n", "project": "Spring", "sub_project": "SWF", "version": "v2.2.1.RELEASE", "fixed_version": "v2.3.0.RELEASE", "fixed_files": ["org.springframework.binding.expression.spel.SpringELExpressionParser.java", "org.springframework.binding.expression.spel.SpringELExpression.java"], "label": 1, "es_results": []}, {"bug_id": 56, "bug_title": "Digest passwords are never accepted in the SimplePasswordValidationCallbackHandler", "bug_description": "Digest passwords are never accepted by the SimplePasswordValidationCallbackHandler, because the setValidator is called twice.\nprotected void handleInternal(Callback callback) throws IOException, UnsupportedCallbackException {\n        if (callback instanceof PasswordValidationCallback) {\n            PasswordValidationCallback passwordCallback = (PasswordValidationCallback) callback;\n            if (passwordCallback.getRequest() instanceof PasswordValidationCallback.PlainTextPasswordRequest) \n{\n                passwordCallback.setValidator(new SimplePlainTextPasswordValidator());\n            }\n            else if (passwordCallback.getRequest() instanceof PasswordValidationCallback.DigestPasswordRequest) \n{\n                PasswordValidationCallback.DigestPasswordRequest digestPasswordRequest =\n                        (PasswordValidationCallback.DigestPasswordRequest) passwordCallback.getRequest();\n                String password = users.getProperty(digestPasswordRequest.getUsername());\n                digestPasswordRequest.setPassword(password);\n                passwordCallback.setValidator(new PasswordValidationCallback.DigestPasswordValidator());\n            }\n            passwordCallback.setValidator(new SimplePlainTextPasswordValidator());", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-m2", "fixed_version": "spring-ws-1.0-m3", "fixed_files": ["org.springframework.ws.soap.security.xwss.callback.SimplePasswordValidationCallbackHandlerTest.java", "org.springframework.ws.soap.security.xwss.callback.SimplePasswordValidationCallbackHandler.java"], "label": 1, "es_results": []}, {"bug_id": 55, "bug_title": "npe thrown when validating with nonce", "bug_description": "I am having a problem getting an npe as referenced in another thread (which was getting really long).\nit looks like it happens in DefaulttimestampValidator.java, at line 41\nDate expired = parseDate(utcRequest.getExpired());\nwhile trying to verifyInboundMessage.\nThis happens when my security policy inbound is:\n<xwss:SecurityConfiguration dumpMessages=\"true\" xmlns:xwss=\"http://java.sun.com/xml/ns/xwss/config\">\n<xwss:Timestamp timeout=\"120\"/>\n<xwss:RequireUsernameToken passwordDigestRequired=\"false\" nonceRequired=\"true\"/>\n</xwss:SecurityConfiguration>\nand outbound is \n<xwss:SecurityConfiguration dumpMessages=\"true\" xmlns:xwss=\"http://java.sun.com/xml/ns/xwss/config\">\n<xwss:Timestamp timeout=\"120\"/>\n<xwss:UsernameToken digestPassword=\"false\" useNonce=\"true\"/>\n</xwss:SecurityConfiguration>If I change useNonce to false, it works.\nI can see in the console that the timestamp for nonce only has created, not expired\n<wsse:UsernameToken xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" wsu:Id=\"XWSSGID-1159216970175594217203\">\n<wsse:Username>Bert</wsse:Username>\n<wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\">****</wsse:Password>\n<wsse:Nonce EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\">lNS7NMI3OJWQ8WtjNiB0AuFS</wsse:Nonce>\n<wsu:Created>2006-09-25T20:42:50Z</wsu:Created>\n</wsse:UsernameToken>\nJira opened as recommended by Arjen. \nThanks.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-m2", "fixed_version": "spring-ws-1.0-m3", "fixed_files": ["org.springframework.oxm.xmlbeans.XmlBeansUnmarshallerTest.java", "org.springframework.oxm.xmlbeans.XmlBeansMarshaller.java", "org.springframework.oxm.AbstractMarshaller.java", "org.springframework.ws.soap.security.xwss.callback.DefaultTimestampValidator.java"], "label": 1, "es_results": []}, {"bug_id": 59, "bug_title": "CastorMarshaller does not marshal to DOM trees correctly", "bug_description": "The CastorMarshaller does not create correct DOM trees. While marshalling to DOM nodes, castor uses a SAX2DOMHandler to publish SAX events into the DOM tree. This handler is a SAX 1 DocumentHandler, which has no native namespace support. There is a DocumentHandlerAdapter, which tries to correct this, but obviously that is failing. \nSee http://forum.springframework.org/showthread.php?t=27476 and http://forum.springframework.org/showthread.php?t=28419", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-m2", "fixed_version": "spring-ws-1.0-m3", "fixed_files": ["org.springframework.oxm.AbstractMarshallerTestCase.java", "org.springframework.oxm.castor.CastorMarshaller.java"], "label": 1, "es_results": []}, {"bug_id": 89, "bug_title": "DefaultTimestampValidator uses wrong date format", "bug_description": "org.springframework.ws.soap.security.xwss.callback.DefaultTimestampValidator uses the wrong date format.\nSee https://xwss.dev.java.net/issues/show_bug.cgi?id=14", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-m1", "fixed_version": "spring-ws-1.0-rc1", "fixed_files": ["org.springframework.ws.soap.security.xwss.callback.DefaultTimestampValidator.java"], "label": 1, "es_results": []}, {"bug_id": 101, "bug_title": "XsdBasedSoap11Wsdl4jDefinitionBuilder parsing error", "bug_description": "Parsing xml schema files with xs:element tags have do not a &apos;name&apos; attribute causes the builder to fail with the following exception when requesting the wsdl:\njava.lang.NullPointerException\nat org.springframework.ws.wsdl.wsdl11.builder.XsdBase dSoap11Wsdl4jDefinitionBuilder.isRequestMessage(Xs dBasedSoap11Wsdl4jDefinitionBuilder.java:244)\nat org.springframework.ws.wsdl.wsdl11.builder.XsdBase dSoap11Wsdl4jDefinitionBuilder.buildMessages(XsdBa sedSoap11Wsdl4jDefinitionBuilder.java:223)\nat org.springframework.ws.wsdl.wsdl11.builder.Abstrac tWsdl4jDefinitionBuilder.buildMessages(AbstractWsd l4jDefinitionBuilder.java:115)\nI have tested a fix locally, and adding a null check to the element name within the following method resolves this problem:\nprotected void buildMessages(Definition definition) throws WSDLException {\n\t\tNodeList elements = schemaElement.getElementsByTagNameNS(\n\t\t\t\tSCHEMA_NAMESPACE_URI, \"element\");\n\t\tfor (int i = 0; i < elements.getLength(); i++) {\n\t\t\tElement element = (Element) elements.item;\n\t\t\tQName elementName = getSchemaElementName(element);\n\t\t\tif ((elementName != null)\n\t\t\t\t\t&& (isRequestMessage(elementName) || isResponseMessage(elementName))) \n{\n\t\t\t\tMessage message = definition.createMessage();\n\t\t\t\tpopulateMessage(message, element);\n\t\t\t\tPart part = definition.createPart();\n\t\t\t\tpopulatePart(part, elementName);\n\t\t\t\tmessage.addPart(part);\n\t\t\t\tmessage.setUndefined(false);\n\t\t\t\tdefinition.addMessage(message);\n\t\t\t}\n\t\t}\n\t}", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-m3", "fixed_version": "spring-ws-1.0-rc1", "fixed_files": ["org.springframework.ws.wsdl.wsdl11.builder.XsdBasedSoap11Wsdl4jDefinitionBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 128, "bug_title": "A SOAP:Fault does not set the the response code to 500", "bug_description": "Whenever a SOAP Fault is returned on the server side, the server error code is not set to 500. This does not comply with WS-I.\nSee http://forum.springframework.org/showthread.php?t=39122", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-rc1", "fixed_version": "spring-ws-1.0-rc2", "fixed_files": ["org.springframework.ws.transport.http.CommonsHttpConnection.java", "org.springframework.ws.transport.AbstractReceiverConnection.java", "org.springframework.ws.transport.http.HttpServletConnection.java", "org.springframework.ws.transport.AbstractWebServiceConnection.java", "org.springframework.ws.transport.http.HttpUrlConnection.java"], "label": 1, "es_results": []}, {"bug_id": 133, "bug_title": "CastorMarshaller ignoreExtraAttributes & Elements", "bug_description": "Spring CastorMarshaller class does not expose the ignoreExtraAttributes and ignoreExtraElements settings from the Castor Unmarshaller class.  This means that when you use Castor Unmarshaller you are forced to map every XML element to an object.  ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-rc1", "fixed_version": "spring-ws-1.0-rc2", "fixed_files": ["org.springframework.oxm.castor.CastorMarshaller.java", "org.springframework.oxm.xmlbeans.XmlBeansMarshaller.java", "org.springframework.oxm.AbstractMarshaller.java"], "label": 1, "es_results": []}, {"bug_id": 141, "bug_title": "Minor Documentation Bug: org.springframework.xml.transform.ResourceSource", "bug_description": "In org.springframework.xml.transform.ResourceSource the javadoc says it is an \"convenient subclass of <code>StreamSource</code>\" but ResourceSource is really a subclass of SAXSource.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-rc2", "fixed_version": "spring-ws-1.0.0", "fixed_files": ["org.springframework.xml.transform.ResourceSource.java"], "label": 1, "es_results": []}, {"bug_id": 145, "bug_title": "When using JAXB2, all messages become MTOM", "bug_description": "When using the JAXB2 marshaller, all SaajSoapMessages become MTOM enabled by default. This can be changed by setting the &apos;mtomEnabled&apos; property of the Jaxb2Marshaller to &apos;false&apos;. We really should set the default to false, since it&apos;s currently true.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-rc2", "fixed_version": "spring-ws-1.0.0", "fixed_files": ["org.springframework.oxm.jaxb.Jaxb2Marshaller.java", "org.springframework.oxm.jaxb.Jaxb2UnmarshallerTest.java", "org.springframework.oxm.jaxb.Jaxb2MarshallerTest.java"], "label": 1, "es_results": []}, {"bug_id": 149, "bug_title": "marshallSendAndReceivce bug in WebServiceTemplate", "bug_description": "The method \"marshalSendAndReceive(String uri, final Object requestPayload)\" in class \"WebServiceTemplate\" calls the wrong overloaded method. The parameter \"uri\" is not used in this call and will be replaced by the \"defaultUri\" in the called method.\nWrong:\npublic Object marshalSendAndReceive(String uri, final Object requestPayload) {\n    return marshalSendAndReceive(requestPayload, null);\n}\nCorrect:\npublic Object marshalSendAndReceive(String uri, final Object requestPayload) {\n    return marshalSendAndReceive(uri, requestPayload, null);\n}", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-rc2", "fixed_version": "spring-ws-1.0.0", "fixed_files": ["org.springframework.ws.client.core.WebServiceTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 150, "bug_title": "Do not close the ServletInputStream in AbstractWebServiceConnection.receive", "bug_description": "Some SAAJ implementations (Axis1 for instance) don&apos;t read the entire message when using MessageFactory.createMessage(mimeHeaders,InputStream). Instead, they lazily instantiate the message. Therefore, closing the stream should be deferred to when the connection is closed. \nSee http://forum.springframework.org/showthread.php?t=40413", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-rc2", "fixed_version": "spring-ws-1.0.0", "fixed_files": ["org.springframework.ws.transport.http.HttpServletConnection.java"], "label": 1, "es_results": []}, {"bug_id": 171, "bug_title": "Jaxb2Marshaller.supports(Class clazz) is too eager", "bug_description": "When using multiple Jaxb2Marshallers for multiple endpoints, first encountered Jaxb2Marshaller is always used, because it&apos;s \"support\" method accepts every Jaxb class. My proposition for improvement is:\n\tpublic boolean supports(Class clazz) {\n\t\tboolean isJaxbClass = clazz.getAnnotation(XmlRootElement.class) != null\n\n\n JAXBElement.class.isAssignableFrom(clazz);\n\t\tif (isJaxbClass) {\n\t\t\tif (StringUtils.hasLength(getContextPath())) {\n\t\t\t\tString pckgName = clazz.getPackage().getName();\n\t\t\t\tStringTokenizer st = new StringTokenizer(getContextPath(), \":\");\n\t\t\t\twhile (st.hasMoreTokens()) \nUnknown macro: {\t\t\t\t\tif (st.nextToken().equals(pckgName)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (!ObjectUtils.isEmpty(classesToBeBound)) {\n\t\t\t\tfor (Class clazzToBeBo : classesToBeBound) {\n\t\t\t\t\tif (clazzToBeBo.equals(clazz)) {\t\t\t\t\t\treturn true;\t\t\t\t\t}\t\t\t\t} \n\t\t\t} else \n{\n\t\t\t\tthrow new IllegalArgumentException(\n\t\t\t\t\t\t\"setting either contextPath or classesToBeBound is required\");\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.0", "fixed_version": "spring-ws-1.0.1", "fixed_files": ["org.springframework.oxm.jaxb.Jaxb2Marshaller.java"], "label": 1, "es_results": []}, {"bug_id": 191, "bug_title": "Loading default key store overwrites truststore", "bug_description": "When no keyStore property is set on the KeyStoreCallbackHandler a default key store is loaded. However, in stead of loading the keyStore it loads the trustStore with the data. See line 600 of KeyStoreCallbackHandler. This messes up the situation where you don&apos;t need a keyStore, but do need a trustStore (like XML encryption).", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.0", "fixed_version": "spring-ws-1.0.1", "fixed_files": ["org.springframework.ws.soap.security.xwss.callback.KeyStoreCallbackHandler.java"], "label": 1, "es_results": []}, {"bug_id": 170, "bug_title": "AxiomSoapMessageFactory + PayloadRootAnnotationMethodEndpointMapping allways falls to DOM parsing", "bug_description": "DOM transformation is used every time in org.springframework.ws.server.endpoint.support.PayloadRootUtils#getPayloadRootQName because the root event type is XMLStreamConstants.START_DOCUMENT\nProposed improvement: (working with Woodstox 3.2.1.jar and sjsxp 1.0.1)\n    public static QName getPayloadRootQName(Source source, TransformerFactory transformerFactory)\n            throws TransformerException, XMLStreamException {\n        if (source instanceof DOMSource) {\n            DOMSource domSource = (DOMSource) source;\n            Node node = domSource.getNode();\n            if (node.getNodeType() == Node.ELEMENT_NODE) \n{\n                return QNameUtils.getQNameForNode(node);\n            }\n            else if (node.getNodeType() == Node.DOCUMENT_NODE) \n{\n                Document document = (Document) node;\n                return QNameUtils.getQNameForNode(document.getDocumentElement());\n            }\n        }\n        else if (source instanceof StaxSource) {\n            StaxSource staxSource = (StaxSource) source;\n            if (staxSource.getXMLStreamReader() != null) {\n                XMLStreamReader streamReader = staxSource.getXMLStreamReader();\n                if (streamReader.getEventType() == XMLStreamConstants.START_ELEMENT ||\n                        streamReader.getEventType() == XMLStreamConstants.END_ELEMENT) \n{\n                    return streamReader.getName();\n                }\n else if(streamReader.getEventType() == XMLStreamConstants.START_DOCUMENT) {\n\t\t\tstreamReader.next();\n                \tif(streamReader.getEventType() == XMLStreamConstants.START_ELEMENT ||\n                      streamReader.getEventType() == XMLStreamConstants.END_ELEMENT) \n{\n                \t\treturn streamReader.getName();\n                \t}\n                }\n            }\n        }\n        // we have no other option than to transform\n        Transformer transformer = transformerFactory.newTransformer();\n        DOMResult domResult = new DOMResult();\n        transformer.transform(source, domResult);\n        Document document = (Document) domResult.getNode();\n        return QNameUtils.getQNameForNode(document.getDocumentElement());\n    }", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.0", "fixed_version": "spring-ws-1.0.1", "fixed_files": ["org.springframework.ws.server.endpoint.mapping.SimpleMethodEndpointMapping.java", "org.springframework.ws.server.endpoint.support.PayloadRootUtils.java", "org.springframework.ws.server.endpoint.mapping.PayloadRootQNameEndpointMapping.java", "org.springframework.ws.server.endpoint.support.PayloadRootUtilsTest.java"], "label": 1, "es_results": []}, {"bug_id": 195, "bug_title": "Incorrect javadoc in org.springframework.ws.soap.SoapFault", "bug_description": "The javadoc for method getFaultDetail() refers to addFaultDetail() and vice versa.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.0", "fixed_version": "spring-ws-1.0.1", "fixed_files": ["org.springframework.ws.soap.SoapFault.java"], "label": 1, "es_results": []}, {"bug_id": 188, "bug_title": "WS-Security exception not being handled", "bug_description": "The Spring WS framework does not handle WSSE related exceptions such as WssSoapFaultException. Ideally, the framework should catch this exception and map it to an appropriate SOAP Fault rather than requiring the user code to do so. See the following forum entry for a full discussion of this issue.\nhttp://forum.springframework.org/showthread.php?t=42647", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-rc2", "fixed_version": "spring-ws-1.0.1", "fixed_files": ["org.springframework.ws.soap.security.xwss.XwsSecuritySecurementException.java", "org.springframework.ws.soap.security.AbstractWsSecurityInterceptor.java", "org.springframework.ws.soap.security.xwss.XwsSecurityValidationException.java", "org.springframework.ws.soap.security.xwss.XwsSecurityInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 146, "bug_title": "MessageDispatcherServlet does not search servlet context for a WsdlDefinitionHandlerAdapter instance", "bug_description": "The servlet should look in it&apos;s application context for an instance of WsdlDefinitionHandlerAdapter to use. I believe this is the standard set by the DispatcherServlet for all pluggable logic modules. I&apos;ll open another issue for the MessageReceiverHandlerAdapter.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0-rc2", "fixed_version": "spring-ws-1.0.2", "fixed_files": ["org.springframework.ws.transport.http.WsdlDefinitionHandlerAdapter.java", "org.springframework.ws.transport.http.WsdlDefinitionHandlerAdapterTest.java", "org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.java", "org.springframework.ws.transport.http.MessageDispatcherServlet.java"], "label": 1, "es_results": []}, {"bug_id": 220, "bug_title": "Jaxb2Marshaller::supports method does not consider multiple marshallers", "bug_description": "When evaluating multiple MarshallingMethodEndpointAdapters, each with their own Jaxb2MarshallingEndpoint, the first MarshallingMethodEndpointAdapter::supports method is always true.\nWe are building a modular application; where each endpoint is packaged as it&apos;s own module.\nEach of those endpoint modules has it&apos;s own MarshallingMethodEndpointAdapter and it&apos;s own Jaxb2Marshaller.\nThis means that when the webapp is packaged and running there will be multiple MarshallingMethodEndpointAdapters available to the MessageDispatcher.\nThe Jaxb2Marshaller::supports method is implemented to return true for any subclass of Jaxb2Element.\n\n\n\n\n\n\n    public boolean supports(Class clazz) {\n\n\n\n\n        if (JAXBElement.class.isAssignableFrom(clazz)) {\n\n\n\n\n            return true;\n\n\n\n\n        }\n\n\n\n\n        ...\n\n\n\n\n    }\n\n\n\n\n\n\nThe Jaxb2Marshaller should not even bother with this check, it should only return true if the JaxbContext is capable of supporting the given class.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.0", "fixed_version": "spring-ws-1.0.2", "fixed_files": ["org.springframework.oxm.jaxb.Jaxb2Marshaller.java", "org.springframework.oxm.jaxb.Jaxb2MarshallerTest.java", "org.springframework.ws.server.endpoint.MethodEndpoint.java", "org.springframework.ws.server.endpoint.adapter.MarshallingMethodEndpointAdapterTest.java", "org.springframework.ws.server.endpoint.adapter.MarshallingMethodEndpointAdapter.java", "org.springframework.ws.server.endpoint.adapter.PayloadMethodEndpointAdapterTest.java"], "label": 1, "es_results": []}, {"bug_id": 203, "bug_title": "Namespace declarations may be removed from the wsdl when transformWsdlLocations = true", "bug_description": "See http://forum.springframework.org/showthread.php?t=44599\nWhen a SimpleWsdl11Definition is used in combination with transformWsdlLocations=true, namespace declarations are removed which leads to an invalid wsdl. \nResetting transfromWsdlLocations to false resolves the issue (with the penalty that the wsdl locations are no longer transformed).", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.1", "fixed_version": "spring-ws-1.0.2", "fixed_files": ["org.springframework.xml.transform.ResourceSource.java", "org.springframework.xml.validation.SchemaLoaderUtils.java", "org.springframework.ws.transport.http.WsdlDefinitionHandlerAdapterTest.java", "org.springframework.ws.wsdl.wsdl11.SimpleWsdl11Definition.java", "org.springframework.ws.server.endpoint.interceptor.PayloadTransformingInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 216, "bug_title": "AbstractValidatingInterceptor.handleResponseValidationErrors's JavaDoc is wrong", "bug_description": "AbstractValidatingInterceptor.handleResponseValidationErrors&apos;s JavaDoc states the following:\n    /**\n\nTemplate method that is called when the response message contains validation errors. Default implementation logs\nall errors, and returns <code>false</code>, i.e. do not send the response.\n     *\n@param messageContext the message context\n@param errors         the validation errors @return <code>true</code> to continue sending the response,\n<code>false</code> (the default) otherwise\n     */\n\nHowever, returning false here doesn&apos;t mean that the response won&apos;t be send. It means that the rest of the Interceptor chain won&apos;t be processed and that the response will be send out immediately (see MessageDispatcher.triggerHandleResponse). The docs should be changed to represent the actual behaviour.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.1", "fixed_version": "spring-ws-1.0.2", "fixed_files": ["org.springframework.ws.server.endpoint.interceptor.AbstractValidatingInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 217, "bug_title": "Booking a flight for non-existent flight should result in NoSuchFlightException", "bug_description": "Submitting an invalid flight number (e.g. KL9999) bubbles up as an EmptyResultDataAccessException instead of NoSuchFlightException. This is because the JpaFlightDao uses query.getSingleResult(), which can throw a NoResultException instead of returning null. Submitting an invalid username has a similar issue. \nI&apos;ve created a fix in the JPA DAO&apos;s to ensure they catch a NoResultException and re-throw it as a business exception. In the case of an invalid username I added a NoSuchUsernameException business exception.\nSee attached patch for a root-level Eclipse project named &apos;airline&apos; created with &apos;mvn eclipse:eclipse&apos; from the samples directory and connected to the Spring-WS SVN repository.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.1", "fixed_version": "spring-ws-1.0.2", "fixed_files": ["org.springframework.ws.samples.airline.dao.jpa.JpaFrequentFlyerDao.java", "org.springframework.ws.samples.airline.ws.MarshallingAirlineEndpoint.java", "org.springframework.ws.samples.airline.service.impl.AirlineServiceImpl.java", "org.springframework.ws.samples.airline.dao.jpa.JpaFlightDaoTest.java", "org.springframework.ws.samples.airline.ws.XPathAirlineEndpoint.java", "org.springframework.ws.samples.airline.service.AirlineService.java", "org.springframework.ws.samples.airline.security.StubFrequentFlyerSecurityService.java", "org.springframework.ws.samples.airline.security.AcegiFrequentFlyerSecurityService.java", "org.springframework.ws.samples.airline.dao.jpa.JpaFrequentFlyerDaoTest.java", "org.springframework.ws.samples.airline.security.FrequentFlyerSecurityService.java", "org.springframework.ws.samples.airline.dao.jpa.JpaFlightDao.java"], "label": 1, "es_results": []}, {"bug_id": 218, "bug_title": "IllegalArgumentException \"faultString cannot be empty\"", "bug_description": "If there is a runtime exception on the server-side that doesn&apos;t have a message (e.g. NullPointerException) the client side\ngets an IllegalArgumentException \"faultString cannot be empty\". The exception seems to be coming from SaajSoap11Body.java, line 50. \nCould this be configured so the client always gets SOAP response even if the server had a runtime exception?\nAlso in the above scenario the server-side doesn&apos;t show the original runtime exception but instead hides it by showing the IllegalArgumentException only.\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.1", "fixed_version": "spring-ws-1.0.2", "fixed_files": ["org.springframework.ws.server.endpoint.AbstractMarshallingPayloadEndpoint.java", "org.springframework.ws.soap.server.endpoint.SoapFaultMappingExceptionResolverTest.java", "org.springframework.ws.soap.server.endpoint.AbstractSoapFaultDefinitionExceptionResolver.java"], "label": 1, "es_results": []}, {"bug_id": 226, "bug_title": "Exception mapping corrupts the 'defaultFault' instance", "bug_description": "In AbstractSoapFaultDefinitionExceptionResolver (v. 1.0.1), have the following code fragment:\n    protected final boolean resolveExceptionInternal(MessageContext messageContext, Object endpoint, Exception ex) {\n        Assert.isTrue(messageContext.getResponse() instanceof SoapMessage,\n                \"AbstractSoapFaultDefinitionExceptionResolver requires a SoapMessage\");\n        SoapFaultDefinition definition = getFaultDefinition(endpoint, ex);\n        if (definition == null) \n{\n 1.           definition = defaultFault;\n        }\n        if (definition == null) \n{\n            return false;\n        }\n        if (!StringUtils.hasLength(definition.getFaultStringOrReason())) \n{\n2.            definition.setFaultStringOrReason(ex.getMessage());\n        }\n....\nProblem is if (1.) and (2.) are hit on first exception handled by defaultFault, it is effectively calling &apos;defaultFault.setFaultOrReason(...)&apos;.  This in essence sets the defaultFault faultOrReason field (as defnition points to the defaultFault instance), making it non-null.  Problem is that subsequent exceptions that are assigned the defaultFault will now have an already populated faultOrReason code (from the first exception), and thus statement (2.) will never be invoked.  This results in all subsequent defaultFault exceptions having the exception message from the first defaultFault.\nCategorizing this as Major as all reported exceptions that map to &apos;defaultFault&apos; will be incorrect, with exception of first mapped defaultFault exception.  Solution is trivial: use &apos;default fault factory&apos; to create new instance of defaultFault for every use, or reset the faultOrReason code to null after the message has been constructed.\n====================================================================================\nBelow test fragments found the behavior (the second test fails, as the returned exception has the message from the first test.  Yet running the second test standalone works fine:\n  /**\n\nThis will happen on badly formed payload (validation error)\n   */\n  public void testInvalidXmlCharacter() throws NoSuchAlgorithmException, IOException, ServletException, DocumentException \n{\n    // &#1 is illegal xml character\n    String payload = buildEchoPayload(\"foo\"+ (char) 0x01);\n    MockHttpServletResponse mockResp = invokeWebService(payload, \"guitest\", \"bugBgone\",\n         HttpServletResponse.SC_INTERNAL_SERVER_ERROR);\n    Element resp = getSoapBodyPayload(mockResp);\n\n    assertEquals(\"Invalid char preventing xml parsing\",\n        \"\\n\" +\n            \"<SOAP-ENV:Fault xmlns:SOAP-ENV=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\">\\n\" +\n            \"  <faultcode>SOAP-ENV:Server</faultcode>\\n\" +\n            \"  <faultstring xml:lang=\\\"en\\\">Could not access envelope: Unable to create envelope from given source: ; nested exception is com.sun.xml.messaging.saaj.SOAPExceptionImpl: Unable to create envelope from given source:</faultstring>\\n\" +\n            \"</SOAP-ENV:Fault>\",\n        XmlUtils.toString(resp));\n  }\n\n  public void testThrownAppException() throws NoSuchAlgorithmException, IOException, ServletException, DocumentException \n{\n    String payload = buildEchoPayload(EchoController.THROW_NULL_POINTER_CMD);\n    MockHttpServletResponse mockResp = invokeWebService(payload, \"guitest\", \"bugBgone\",\n        HttpServletResponse.SC_INTERNAL_SERVER_ERROR);\n\n    Element resp = getSoapBodyPayload(mockResp);\n    assertEquals(\"\\n\" +\n        \"<SOAP-ENV:Fault xmlns:SOAP-ENV=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\">\\n\" +\n        \"  <faultcode>SOAP-ENV:Server</faultcode>\\n\" +\n        \"  <faultstring xml:lang=\\\"en\\\">Thrown on purpose for testing...</faultstring>\\n\" +\n        \"</SOAP-ENV:Fault>\",\n        XmlUtils.toString(resp));\n  }\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.1", "fixed_version": "spring-ws-1.5.0-m1", "fixed_files": ["org.springframework.ws.soap.server.endpoint.SoapFaultMappingExceptionResolverTest.java", "org.springframework.ws.soap.server.endpoint.AbstractSoapFaultDefinitionExceptionResolver.java"], "label": 1, "es_results": []}, {"bug_id": 227, "bug_title": "NPE when \"mustUnderstand\" attribute is in SOAP header and no Interceptors have been defined ", "bug_description": "When the \"mustUnderstand\" attribute is set (to either \"0\" or \"1\") and no interceptors are defined a \"PayloadRootQNameEndpointMapping\" the org.springframework.ws.soap.server.SoapMessageDispatcher throw a NullPointerException when iterating over the mapped endpoint s Interceptors. \nAdding a \"org.springframework.ws.server.endpoint.interceptor.PayloadLoggingInterceptor\" temporarily fixes the problem (as the code just gets \"any\" EndpointInterceptor before checking via \"instanceof\" on SoapEndpointInterceptor.class).\nOur Server might receive a SOAP Message with the mustUnderstand attribute set (to either \"0\" or \"1\") or not, but does not need to handle the attribute.\nA nullpointer check would be appropriate here.\nthanks in advance.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.1", "fixed_version": "spring-ws-1.5.0-m1", "fixed_files": ["org.springframework.ws.soap.server.SoapMessageDispatcherTest.java", "org.springframework.ws.soap.server.SoapMessageDispatcher.java"], "label": 1, "es_results": []}, {"bug_id": 238, "bug_title": "AbstractMethodEndpointMapping does not support JDK Proxies", "bug_description": "AbstractMethodEndpointMapping has a method, getEndpointClass, which attempts to determine the correct base class for an endpoint.  This method correctly deals with CGLIB-based proxies, but does not handle the more common JDK proxies.\nOne solution would be to use the AopUtils.getTargetClass method to perform this check.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.2", "fixed_version": "spring-ws-1.5.0-m1", "fixed_files": ["org.springframework.ws.server.endpoint.mapping.AbstractMethodEndpointMapping.java"], "label": 1, "es_results": []}, {"bug_id": 229, "bug_title": "JibxMarshaller should support marshalling/unmarshalling of all mapped classes", "bug_description": "The current version of JiBX (1.1.5) supports marshalling and unmarshalling of all classes defined in binding definition file, for single IBindingFactory instance. The class that is passed in to BindingDirectory to get the factory instance is just used to locate the generated class that contains binding information - it is not the only class that this factory can marshall/unmarshall.\nThe solution: The supports() method of org.springframework.oxm.jibx.JibxMarshaller should be modified to return true for all mapped classes of IBindingFactory.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.2", "fixed_version": "spring-ws-1.5.0-m1", "fixed_files": ["org.springframework.oxm.jibx.JibxMarshallerTest.java", "org.springframework.oxm.jibx.JibxMarshaller.java"], "label": 1, "es_results": []}, {"bug_id": 241, "bug_title": "NullPointerException during processing message with empty body", "bug_description": "When I&apos;m sending message with empty body, i receive this exception:\njava.lang.NullPointerException\n\torg.apache.xalan.transformer.TransformerIdentityImpl.transform(TransformerIdentityImpl.java:418)\n\torg.springframework.ws.server.endpoint.support.PayloadRootUtils.getPayloadRootQName(PayloadRootUtils.java:83)\n\torg.springframework.ws.server.endpoint.mapping.PayloadRootAnnotationMethodEndpointMapping.getLookupKeyForMessage(PayloadRootAnnotationMethodEndpointMapping.java:57)\n\torg.springframework.ws.server.endpoint.mapping.AbstractMethodEndpointMapping.getEndpointInternal(AbstractMethodEndpointMapping.java:54)\n\torg.springframework.ws.server.endpoint.mapping.AbstractEndpointMapping.getEndpoint(AbstractEndpointMapping.java:83)\n\torg.springframework.ws.server.MessageDispatcher.getEndpoint(MessageDispatcher.java:242)\n\torg.springframework.ws.server.MessageDispatcher.dispatch(MessageDispatcher.java:195)\n\torg.springframework.ws.server.MessageDispatcher.receive(MessageDispatcher.java:162)\n\torg.springframework.ws.transport.support.WebServiceMessageReceiverObjectSupport.handleConnection(WebServiceMessageReceiverObjectSupport.java:87)\n\torg.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.handle(WebServiceMessageReceiverHandlerAdapter.java:57)\n\torg.springframework.ws.transport.http.MessageDispatcherServlet.doService(MessageDispatcherServlet.java:197)\n\torg.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:476)\n\torg.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:441)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:710)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\torg.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:63)\n\torg.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:75)\n\torg.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)\nAnd message causing this:\n<soapenv:Envelope\n\txmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\n\txmlns:q0=\"http://nevermind\"\n\txmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n\t<soapenv:Header>\n\t\t<q0:sessionId>0PPAacL8UUACtCG7kdBp6MfNQ47FwUZd</q0:sessionId>\n\t</soapenv:Header>\n\t<soapenv:Body></soapenv:Body>\n</soapenv:Envelope>", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.2", "fixed_version": "spring-ws-1.5.0-m1", "fixed_files": ["org.springframework.ws.server.endpoint.support.PayloadRootUtilsTest.java", "org.springframework.ws.server.endpoint.support.PayloadRootUtils.java"], "label": 1, "es_results": []}, {"bug_id": 245, "bug_title": "SAXParseException when using HttpURLConnection", "bug_description": "When using the HttpUrlConnection in combination with the WebServiceTemplate, the following exception occurs:\norg.xml.sax.SAXParseException: The root element is required in a well-formed document\nThis seems to occur in Java 1.4, using SAAJ 1.2. A detailed description of the issue is available at http://forum.springframework.org/showthread.php?t=40413&page=2\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.2", "fixed_version": "spring-ws-1.5.0-m1", "fixed_files": ["org.springframework.ws.transport.http.CommonsHttpConnection.java", "org.springframework.ws.transport.AbstractReceiverConnection.java", "org.springframework.ws.transport.jms.JmsSenderConnection.java", "org.springframework.ws.transport.tcp.TcpReceiverConnection.java", "org.springframework.ws.transport.http.HttpServletConnection.java", "org.springframework.ws.client.core.WebServiceTemplate.java", "org.springframework.ws.transport.http.HttpUrlConnection.java", "org.springframework.ws.transport.mail.MailSenderConnection.java", "org.springframework.ws.transport.mail.MailReceiverConnection.java", "org.springframework.ws.transport.jms.JmsReceiverConnection.java", "org.springframework.ws.transport.AbstractSenderConnection.java", "org.springframework.ws.transport.tcp.TcpSenderConnection.java"], "label": 1, "es_results": []}, {"bug_id": 248, "bug_title": "DomPoxMessage not clearing DOM on setting the result", "bug_description": "I am using the POX method to implement a simple XML service. The problem I am having has to do with the XML transformations. The way the PayloadTransformingInterceptor is implemented, it sets the transformation result on the same Document object in DomPoxMessage as the source dom. This is ending up just appending the transformed XML to the original XML.\nI wrote my own interceptor and it ended up being the same result. I also tried to add a new method setDocument(Document) to the DomPoxMessage class. I then stored the result of transformation in a new DomResult and then set the resulting dom on the DomPoxMessage. It works fine upto this point, but then somewhere during the internals of Spring-WS it ends up causing a problem and starts throwing null pointer exceptions.\nThis has been really frustrating and considering that there is barely any documentation on the POX in general, this is really turning out to be a loosing because.\nReply With Quote\natifmk\n  #2  \nOld 12-03-2007, 04:56 PM\nArjen Poutsma Arjen Poutsma is offline\nSenior Member\nSpring Team\nJoin Date: Jul 2005\nLocation: Rotterdam, the Netherlands\nPosts: 1,166\nDefault\nI think this is something I can fix by simply emptying the document if setPayloadResult() is called (similar to SOAP). If you create a JIRA issue, I will look at it.\nI will also try and add some POX documentation in 1.5, or maybe a sample.\n__________________\nArjen Poutsma\nSpring Web Services Dev Lead\nPlease read the FAQ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.2", "fixed_version": "spring-ws-1.5.0-m1", "fixed_files": ["org.springframework.ws.pox.dom.DomPoxMessageTest.java", "org.springframework.ws.pox.dom.DomPoxMessage.java"], "label": 1, "es_results": []}, {"bug_id": 274, "bug_title": "Soap headers with whitespace because java.lang.ClassCastException: com.sun.xml.messaging.saaj.soap.impl.TextImpl - Part II", "bug_description": "This bug is related to: http://jira.springframework.org/browse/SWS-244.  If white space appears in the header then a class cast exception is thrown.   Sun&apos;s SAAJ impl returns these whitespace nodes as TextImpl.  The class cast happens when the TextImpl&apos;s are cast as SOAPHeaderElement.  I&apos;ve verified that this is a problem with Spring WS 1.0.3 as well even though I&apos;m currently using 1.0.2.\norg.springframework.ws.soap.saaj.SaajSoapHeader\n        public Object next() \n{\n            SOAPHeaderElement saajHeaderElement = (SOAPHeaderElement) iterator.next();   <-- class cast happens here.\n            return new SaajSoapHeaderElement(saajHeaderElement);\n        }", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.2", "fixed_version": "spring-ws-1.5.0-m2", "fixed_files": ["org.springframework.ws.soap.saaj.SaajSoapHeader.java"], "label": 1, "es_results": []}, {"bug_id": 242, "bug_title": "Allow for custom ErrorHandler in PayloadValidatingInterceptor", "bug_description": "Validating a SOAP request or response with PayloadValidatingInterceptor or Jaxb2Marshaller fails when using MTOM.\nThe spring-ws MTOM sample fails when PayloadValidatingInterceptor is added to the endpoint interceptor chain.\nSchema:\n    <element name=\"SendRequest\" type=\"tns:SendMessage\"/>\n    <complexType name=\"SendMessage\">\n       \t<sequence>\n   \t\t<element name=\"sender\" type=\"string\"/>\n   \t\t<element name=\"recipient\" type=\"string\"/>\n            \t<element name=\"content\" type=\"base64Binary\" xmime:expectedContentTypes=\"/\"/>\n       \t</sequence>\n   </complexType>\nSOAP request:\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:mail=\"http://www.enovation.nl/ems/mailwebservice\">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <mail:SendRequest>\n         <mail:sender>1</mail:sender>\n         <mail:recipient>2</mail:recipient>\n         <mail:content><inc:Include xmlns:inc=\"http://www.w3.org/2004/08/xop/include\" href=\"cid:768176637073\"/></mail:content>\n      </mail:SendRequest>\n   </soapenv:Body>\n</soapenv:Envelope>\nSOAP response:\n<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\">\n   <SOAP-ENV:Header/>\n   <SOAP-ENV:Body>\n      <SOAP-ENV:Fault>\n         <faultcode>SOAP-ENV:Client</faultcode>\n         <faultstring xml:lang=\"en\">Validation error</faultstring>\n         <detail>\n            <spring-ws:ValidationError xmlns:spring-ws=\"http://springframework.org/spring-ws\">cvc-type.3.1.2: Element &apos;mail:content&apos; is a simple type, so it must have no element information item [children].</spring-ws:ValidationError>\n         </detail>\n      </SOAP-ENV:Fault>\n   </SOAP-ENV:Body>\n</SOAP-ENV:Envelope>", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.2", "fixed_version": "spring-ws-2.0.1.RELEASE", "fixed_files": ["org.springframework.xml.validation.Jaxp10ValidatorFactoryTest.java", "org.springframework.xml.validation.Jaxp10ValidatorFactory.java", "org.springframework.xml.validation.AbstractValidatorFactoryTestCase.java", "org.springframework.ws.server.endpoint.interceptor.AbstractValidatingInterceptor.java", "org.springframework.xml.validation.Jaxp13ValidatorFactory.java", "org.springframework.xml.validation.XmlValidator.java", "org.springframework.ws.soap.server.endpoint.interceptor.PayloadValidatingInterceptorTest.java", "org.springframework.xml.validation.XmlValidatorFactory.java"], "label": 1, "es_results": []}, {"bug_id": 264, "bug_title": "XPathExpressionFactory should fallback to Jaxen if no JAXP 1.3 XPath implementation is available", "bug_description": "When running with Java 5 without any JAXP 1.3 XPath implementation available but Jaxen present, XPathExpressionFactory fails to fallback to Jaxen.\nThe following patch fixes the problem :\n ../spring-ws-1.0.3/modules/xml/src/main/java/org/springframework/xml/xpath/XPathExpressionFactory.java\t2007-12-21 16:26:18.000000000 +0100\n+++ XPathExpressionFactory.java\t2008-01-08 18:12:38.000000000 +0100\n@@ -42,10 +42,14 @@\n     private static final String JAXEN_CLASS_NAME = \"org.jaxen.XPath\";\n+    private static boolean jaxpAvailable;\n     private static boolean jaxenAvailable;\n     static {\n         // Check whether Jaxen is available\n+        jaxpAvailable = (JaxpVersion.getJaxpVersion() >= JaxpVersion.JAXP_13);\n+\n+        // Check whether Jaxen is available\n         try {\n             ClassUtils.forName(JAXEN_CLASS_NAME);\n             jaxenAvailable = true;\n@@ -81,11 +85,27 @@\n     public static XPathExpression createXPathExpression(String expression, Map namespaces)\n             throws IllegalStateException, XPathParseException {\n         Assert.hasLength(expression, \"expression is empty\");\n\nif (JaxpVersion.getJaxpVersion() >= JaxpVersion.JAXP_13) {\nlogger.trace(\"Creating [javax.xml.xpath.XPathExpression]\");\nreturn Jaxp13XPathExpressionFactory.createXPathExpression(expression, namespaces);\n+        if (jaxpAvailable) {\n+            try \n{\n+                logger.trace(\"Creating [javax.xml.xpath.XPathExpression]\");\n+                return Jaxp13XPathExpressionFactory.createXPathExpression(expression, namespaces);\n+            }\n+            catch (XPathException e) \n{\n+                throw e;\n+            }\n+            catch (Throwable e) \nUnknown macro: {+                // Because we may get an ExceptionInInitializerError from JAXP+                // XPathFactory+                jaxpAvailable = false;++                if (!jaxenAvailable) {\n+                    throw new XPathParseException(\n+                        \"Could not compile [\" + expression + \"] to a XPathExpression: \" + e.getMessage(), e);\n+                }+                // Else} \n         }\nelse if (jaxenAvailable) {\n+        if (jaxenAvailable) \n{\n             logger.trace(\"Creating [org.jaxen.XPath]\");\n             return JaxenXPathExpressionFactory.createXPathExpression(expression, namespaces);\n         }\n\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.3", "fixed_version": "spring-ws-1.5.0-m2", "fixed_files": ["org.springframework.xml.JaxpVersion.java", "org.springframework.xml.xpath.XPathExpressionFactory.java"], "label": 1, "es_results": []}, {"bug_id": 266, "bug_title": "AxiomContentHandler should empty the response body before adding the transformation result", "bug_description": "AxiomContentHandler append the result of the XSLT transformation without first emptying the response body. The resulting SOAP response ends up with 2 body child elements : the original (untransformed) endpoint response and the transformation result.\nThe following patch fixes the problem :\n ../spring-ws-1.0.3/modules/core/src/main/java/org/springframework/ws/soap/axiom/AxiomContentHandler.java\t2007-12-21 16:26:32.000000000 +0100\n+++ AxiomContentHandler.java\t2008-01-08 15:14:41.000000000 +0100\n@@ -16,6 +16,7 @@\n package org.springframework.ws.soap.axiom;\n+import org.apache.axiom.om.OMNode;\n import org.apache.axiom.om.OMElement;\n import org.apache.axiom.om.impl.builder.SAXOMBuilder;\n import org.springframework.util.Assert;\n@@ -39,6 +40,15 @@\n     public void endDocument() throws SAXException {\n         super.endDocument();\n+\n+        // Remove original (i.e. source) response body.\n+        OMNode child = null;\n+        while ((child = parentElement.getFirstOMChild()) != null)\n+        \n{\n+            child.detach();\n+        }\n+\n+        // Set result (i.e. transformed) response body.\n         parentElement.addChild(super.getRootElement());\n     }\n }", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.0.3", "fixed_version": "spring-ws-1.5.0-m2", "fixed_files": ["org.springframework.ws.soap.axiom.support.AxiomUtils.java", "org.springframework.ws.soap.AbstractSoapBodyTestCase.java", "org.springframework.ws.soap.axiom.AxiomSoapBody.java", "org.springframework.ws.WebServiceMessage.java", "org.springframework.ws.soap.SoapBody.java"], "label": 1, "es_results": []}, {"bug_id": 286, "bug_title": "WSS4J AcegiDigestPasswordValidationCallbackHandler does not set Acegi SecurityContext", "bug_description": "The AcegiDigestPasswordValidationCallbackHandler does not set any Authentication in the Acegi SecurityContext, which it should.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.0-m2", "fixed_version": "spring-ws-1.5.0-rc1", "fixed_files": ["org.springframework.ws.soap.security.wss4j.callback.acegi.AcegiDigestPasswordValidationCallbackHandler.java", "org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor.java", "org.springframework.ws.soap.security.wss4j.callback.AbstractWsPasswordCallbackHandler.java"], "label": 1, "es_results": []}, {"bug_id": 293, "bug_title": "Response should be cleared in case of exception in WS-Security securement", "bug_description": "If an exception occurs while securing an outgoing SOAP message with WS-Security the response is not cleared and an incomplete response is sent sent back to the initiator. The response should be cleared in this case.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.0-m2", "fixed_version": "spring-ws-1.5.0-rc1", "fixed_files": ["org.springframework.ws.soap.security.AbstractWsSecurityInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 294, "bug_title": "WSS4J interceptor should not verify that validationDecryptionCrypto != null", "bug_description": "WSS4J interceptor verifies now that validationDecryptionCrypto != null when validationActions includes \"Encrypt\". However, validationDecryptionCrypto is not needed if only embeddable key name encryption style is used.\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.0-m2", "fixed_version": "spring-ws-1.5.0-rc1", "fixed_files": ["org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 295, "bug_title": "WSS4J interceptor lacks a property to set WSHandlerConstants.ENC_KEY_NAME option", "bug_description": "In order to support embedded key name encryption, we need to add a securementEncryptionEmbeddedKeyName property that sets WSHandlerConstants.ENC_KEY_NAME option in the handler. This is necessary to support embedded key name encryption in a declarative fashion. ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.0-m2", "fixed_version": "spring-ws-1.5.0-rc1", "fixed_files": ["org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 307, "bug_title": "org.springframework.ws.soap.security.wss4j.callback.KeyStoreCallbackHandler uses tiger specific classes", "bug_description": "The code of KeyStoreCallbackHandler.handleKeyName is tiger specific because of the use of KeyStore.PasswordProtection, KeyStore.SecretKeyEntry and KeyStore.getEntry(String alias, KeyStore.ProtectionParameter protParam).  We should probably use KeyStore.getKey(String alias, char[] password) instead.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.0-rc1", "fixed_version": "spring-ws-1.5.0-rc2", "fixed_files": ["org.springframework.ws.soap.security.wss4j.callback.KeyStoreCallbackHandler.java"], "label": 1, "es_results": []}, {"bug_id": 308, "bug_title": "WebServiceTemplate skips handling fault in response with checkConnectionForFault=\"false\" when HTTP status code is not 200 or 500", "bug_description": "When checkConnectionForFault is set to \"false\" as stated in documentation  we should rely on the message only for determining if a response envelope is a Fault.\nThis actually works only if HTTP response code is 500 or 200, but as for a service I call the server send an HTTP 400 response code with a response containing a Fault (it&apos;s clearly not a WS-I Basic Profile compliant web service) the handleError is called instead of handleFault and I get a WebServiceTransportException instead of the Fault related exception.\nThis breaks WS-I Basic Profile conformance of Spring Web Services as it states:\n\"... the Profile requires that they examine the envelope. A Fault is an envelope that has a single child element of the soap:Body element, that element being a soap:Fault element.\nR1107 A RECEIVER MUST interpret a SOAP message as a Fault when the soap:Body of the message has a single soap:Fault child.\"", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.0-rc1", "fixed_version": "spring-ws-1.5.0-rc2", "fixed_files": ["org.springframework.ws.client.core.WebServiceTemplate.java", "org.springframework.ws.client.core.WebServiceTemplateIntegrationTest.java"], "label": 1, "es_results": []}, {"bug_id": 333, "bug_title": "Transport streams not closed in WebServiceConnection", "bug_description": " Currently, in the AbstractWebServiceConnection and subclasses, the TransportOutputStream and TransportInputStream are not closed, mainly because Axis1 SAAJ and Axiom lazy-load messages. \nThis is not a major issue for most transports, because the streams are closed in the end (during connection.close()), but closing the streams explicitly can&apos;t hurt. ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.0", "fixed_version": "spring-ws-1.5.1", "fixed_files": ["org.springframework.ws.transport.AbstractSenderConnection.java", "org.springframework.ws.transport.http.CommonsHttpConnection.java", "org.springframework.ws.transport.AbstractReceiverConnection.java", "org.springframework.ws.transport.AbstractWebServiceConnection.java"], "label": 1, "es_results": []}, {"bug_id": 334, "bug_title": "Calls to lifecycleMonitor.notifyAll() in AbstractStandaloneMessageReceiver are superfluous", "bug_description": "Calls to lifecycleMonitor.notifyAll() in AbstractStandaloneMessageReceiver are superfluous because no threads call wait on that object.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.0", "fixed_version": "spring-ws-1.5.1", "fixed_files": ["org.springframework.ws.transport.support.AbstractStandaloneMessageReceiver.java"], "label": 1, "es_results": []}, {"bug_id": 341, "bug_title": "Wss4jSecurityInterceptor and AcegiDigestPasswordValidationCallbackHandler do not correctly work together to update the Acegi security context.", "bug_description": "I am trying to hook up digest password handling and acegi authorization. I have managed to do this successfully with the plain text equivalent. I think I&apos;ve managed to get close to the problem. When you configure the plain text acegi handler you wire in a ProviderManager. \n<bean id=\"acegiHandler\"\n          class=\"org.springframework.ws.soap.security.wss4j.callback.acegi.AcegiPlainTextPasswordValidationCallbackHandler\">\n        <property name=\"authenticationManager\" ref=\"authenticationManager\"/>\n    </bean>\n    <bean id=\"authenticationManager\" class=\"org.acegisecurity.providers.ProviderManager\">\n        <property name=\"providers\">\n            <bean class=\"org.acegisecurity.providers.dao.DaoAuthenticationProvider\">\n                <property name=\"userDetailsService\" ref=\"inMemoryDaoImpl\"/>\n            </bean>\n        </property>\n    </bean>\n    <bean id=\"wsSecurityInterceptor\" class=\"org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor\">\n        <property name=\"validationActions\" value=\"UsernameToken\"/>\n        <property name=\"validationCallbackHandler\">\n            <!-<ref local=\"acegiDigestPasswordHandler\"/>->\n            <ref local=\"acegiHandler\"/>\n        </property>\n    </bean>\n    <bean id=\"inMemoryDaoImpl\" class=\"org.acegisecurity.userdetails.memory.InMemoryDaoImpl\">\n        <property name=\"userMap\">\n            <value>\n                Ernie=Bert,ROLE_SUPERVISOR\n            </value>\n        </property>\n    </bean>\nIt is the AbstractUserDetailsAuthenticationProvider (called by the AuthenticationManager) which, upon successful authentication, that actually sets the setAuthenticated(true) on the UsernamePasswordAuthenticationToken (see UsernamePasswordAuthenticationToken(principal,  authentication.getCredentials(), user.getAuthorities()); ).\nprotected Authentication createSuccessAuthentication(Object principal, Authentication authentication,\n        UserDetails user) \n{\n        // Ensure we return the original credentials the user supplied,\n        // so subsequent attempts are successful even with encoded passwords.\n        // Also ensure we return the original getDetails(), so that future\n        // authentication events after cache expiry contain the details\n\n// IB this constructor sets &apos;authenticated&apos; to true\n        UsernamePasswordAuthenticationToken result = new UsernamePasswordAuthenticationToken(principal,\n                authentication.getCredentials(), user.getAuthorities());\n        result.setDetails(authentication.getDetails());\n\n        return result;\n    }\n\n\nIn the case of AcegiDigestPasswordValidationCallbackHandler you don&apos;t wire in a AuthenticationManager so even thought the credentials are valid it is never set to authentication in acegi SecurityContext. So the authorization fails even though the Principal has the correct GrantedAuthorities.\n<bean id=\"wsSecurityInterceptor\" class=\"org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor\">\n        <property name=\"validationActions\" value=\"UsernameToken\"/>\n        <property name=\"validationCallbackHandler\">\n            <ref local=\"acegiDigestPasswordHandler\"/>\n            <!-<ref local=\"acegiHandler\"/>->\n        </property>\n    </bean>\n    <bean id=\"inMemoryDaoImpl\" class=\"org.acegisecurity.userdetails.memory.InMemoryDaoImpl\">\n        <property name=\"userMap\">\n            <value>\n                Ernie=Bert,ROLE_SUPERVISOR\n            </value>\n        </property>\n    </bean>\n    <bean id=\"acegiDigestPasswordHandler\"\n          class=\"org.springframework.ws.soap.security.wss4j.callback.acegi.AcegiDigestPasswordValidationCallbackHandler\">\n        <property name=\"userDetailsService\">\n            <ref local=\"inMemoryDaoImpl\"/>\n        </property>\n    </bean>", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.0", "fixed_version": "spring-ws-1.5.1", "fixed_files": ["org.springframework.ws.soap.security.wss4j.callback.acegi.AcegiDigestPasswordValidationCallbackHandler.java", "org.springframework.ws.soap.security.wss4j.callback.SpringDigestPasswordValidationCallbackHandler.java"], "label": 1, "es_results": []}, {"bug_id": 345, "bug_title": "WSS4J interceptor creates creates invalid digest for SAAJ messages", "bug_description": "When using SAAJ and WSS4J on for outgoing messages, the digest created is incorrect, which results in signature verification failures. This is due to the fact that  the Document exposed via SOAPMessage.getSOAPPart() is out of sync. Calling SOAPMessage.saveChanges() fixes this.\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.0", "fixed_version": "spring-ws-1.5.2", "fixed_files": ["org.springframework.ws.soap.security.wss4j.SaajWss4jMessageInterceptorSignTest.java", "org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor.java", "org.springframework.ws.context.DefaultMessageContext.java"], "label": 1, "es_results": []}, {"bug_id": 353, "bug_title": "Schema inlining results in duplicate inlining of files referenced from multiple files", "bug_description": "Suppose you have two files foo-response.xsd and bar-response.xsd referenceing a common domain.xsd the Dynamic WSDL creation will cause the domain.xsd to be inlined twice in the WSDL.\nThis causes trouble to JAX-WS wsimport utility as elements appera twice in the same namespace.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.1", "fixed_version": "spring-ws-1.5.2", "fixed_files": ["org.springframework.xml.xsd.commons.CommonsXsdSchemaCollection.java"], "label": 1, "es_results": []}, {"bug_id": 385, "bug_title": "Exceptions thrown using WS-Addressing result in Assert failure in Addressing10.addAddressingHeaders", "bug_description": "When using WS-Addressing if any interceptor or endpoint throws an Exception the implicit interceptor created by AbstractAddressingEndpointMapping will cause an Assertion failure because it has a null faultAction URI.  When this happens no response is sent to the client.\nExposing a faultActionURI to the user in AbstractAddressingEndpointMapping to be used to create the interceptor would fix the problem.  If the user is implementing something that uses WS-BaseFaults this would be required anyhow, and the default behavior could be to use the responseAction if the faultAction is not set.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.1", "fixed_version": "spring-ws-1.5.3", "fixed_files": ["org.springframework.ws.soap.addressing.server.AddressingEndpointInterceptor.java", "org.springframework.ws.soap.addressing.server.AbstractActionEndpointMapping.java", "org.springframework.ws.soap.addressing.server.AnnotationActionEndpointMapping.java", "org.springframework.ws.soap.addressing.server.AbstractAddressingEndpointMapping.java", "org.springframework.ws.soap.addressing.server.annotation.Action.java"], "label": 1, "es_results": []}, {"bug_id": 422, "bug_title": "Class AxiomUtils is not java 1.4 compatible", "bug_description": "In the class AxiomUtils, the methods toDocument and toEnvelope construct an IllegalArgumentException with a constructor introduced in java 1.5:\npublic IllegalArgumentException(String message, Throwable because)", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.1", "fixed_version": "spring-ws-1.5.5", "fixed_files": ["org.springframework.ws.soap.axiom.support.AxiomUtils.java"], "label": 1, "es_results": []}, {"bug_id": 459, "bug_title": "Spring 1.5.x should depend on Spring 2.0.x as a minimum requirement", "bug_description": "Spring 1.5.x should depend on Spring 2.0.x as a minimum requirement and not Spring 2.5.x. \nLog4J trace logging causes problems when using Spring 2.0.x because the toURI() method in org.springframework.util.ResourceUtils is not available in Spring core 2.0.x. \nAs a workaround, changing the log level to INFO should resolve the issue. \nWe should run the test suite against Spring 2.0.x to see if other problems arise.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.1", "fixed_version": "spring-ws-1.5.6", "fixed_files": ["org.springframework.xml.sax.SaxUtils.java", "org.springframework.ws.transport.http.HttpUrlConnection.java"], "label": 1, "es_results": []}, {"bug_id": 485, "bug_title": "xml:lang=\"en\" attribute in <faultstring> element is not compliant to SOAP/1.1 schema", "bug_description": "There is xml:lang=\"en\" attribute in <faultstring> element although SOAP/1.1 schema doesn&apos;t provide it.\nYes, it may be suppressed if set faultStringOrReasonLocale property for all affected endpoints to null,\nset empty language for each and every exception mapping in SoapFaultMappingExceptionResolver (BY THE WAY, it is not\nvery well documented how to do it), set to null faultStringOrReasonLocale for message dispatcher,\noh did I forget something? \nProbably, it may as well be avoided by subclassing of each of above mentioned classes (and likely some others),\nbut then each developer need to use them. \nSee as well http://www.eviware.com/component/option,com_smf/Itemid,53/topic,1044.0\nIMHO, or it should comply with schema by default, or, in the worst case, it should exist some global setting \n\"be compliant\".\nKind regards,\nOleksandr\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.1", "fixed_version": "spring-ws-1.5.7", "fixed_files": ["org.springframework.ws.soap.axiom.AxiomSoap11BodyTest.java", "org.springframework.ws.soap.axiom.AxiomSoapFaultDetailTest.java", "org.springframework.ws.soap.security.wss4j.Wss4jTestCase.java", "org.springframework.ws.soap.saaj.SaajSoap11EnvelopeTest.java", "org.springframework.ws.soap.saaj.SaajSoapEnvelope.java", "org.springframework.ws.soap.axiom.AxiomSoapMessageFactory.java", "org.springframework.ws.soap.axiom.AxiomSoapEnvelope.java", "org.springframework.ws.soap.saaj.SaajSoapMessageFactory.java", "org.springframework.ws.soap.saaj.SaajSoap11BodyTest.java", "org.springframework.ws.soap.saaj.SaajSoap11Body.java", "org.springframework.ws.soap.saaj.SaajSoap12EnvelopeTest.java", "org.springframework.ws.soap.axiom.AxiomSoap11Body.java", "org.springframework.ws.soap.axiom.AxiomSoapMessage.java", "org.springframework.ws.soap.saaj.SaajSoapMessage.java"], "label": 1, "es_results": []}, {"bug_id": 656, "bug_title": " ResponseMatcher.payload(Resource payload) should be static", "bug_description": "ResponseMatchers  public ResponseMatcher payload(Resource payload) should be declared static", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.0-RC1", "fixed_version": "spring-ws-2.0.0-RC2", "fixed_files": ["org.springframework.ws.test.server.ResponseMatchers.java"], "label": 1, "es_results": []}, {"bug_id": 698, "bug_title": "EndpointExceptionResolver is not registered automatically when used together with <sws:annotation-driven/> tag", "bug_description": "After removing <sws:annotation-driven/> EndpointExceptionResolver starts to work. What Is more - it looks like that <sws:annotation-driven/> tag is not needed as anotation based Endpoints works without it.\nAdditional details in the Spring forum post.\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.0-RELEASE", "fixed_version": "spring-ws-2.0.1.RELEASE", "fixed_files": ["org.springframework.ws.config.AnnotationDrivenBeanDefinitionParser.java", "org.springframework.ws.config.AnnotationDrivenBeanDefinitionParserTest.java"], "label": 1, "es_results": []}, {"bug_id": 691, "bug_title": "Annotation-driven tag does not support ws-addressing @Action", "bug_description": "Objects annotated with @Action should be picked up by the sws:annotation-driven tag (triggered with AnnotationActionEndpointMapping), but this fails because the AnnotationDrivenBeanDefinitionParser does not register all possible endpoint mappings in the registerEndpointMappings method.\nWs-addressing support is not working without explicit adding the AnnotationActionEndpointMapping in the Spring context.\nWorkaround:\nAdd the following line to the Spring context xml:\n<bean class=\"org.springframework.ws.soap.addressing.server.AnnotationActionEndpointMapping\" />\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.0-RELEASE", "fixed_version": "spring-ws-2.0.1.RELEASE", "fixed_files": ["org.springframework.ws.soap.addressing.server.AnnotationActionEndpointMapping.java", "org.springframework.ws.soap.addressing.server.AbstractAddressingEndpointMapping.java", "org.springframework.ws.config.AnnotationDrivenBeanDefinitionParser.java", "org.springframework.ws.config.AnnotationDrivenBeanDefinitionParserTest.java"], "label": 1, "es_results": []}, {"bug_id": 699, "bug_title": "XomPayloadMethodProcessor is not added methodReturnValueHandlers in DefaultMethodEndpointAdapter", "bug_description": "\n\n\n\n\n\n      private void initMethodReturnValueHandlers() {\n\n\n\n\n            ...\n\n\n\n\n            if (isPresent(XOM_CLASS_NAME)) {\n\n\n\n\n                methodArgumentResolvers.add(new XomPayloadMethodProcessor());\n\n\n\n\n            }\n\n\n\n\n            ...\n\n\n\n\n      }\n\n\n\n\n\n\nas you can see the XomPayloadMethodProcessor is added to the methodArgumentResolvers and not to the methodReturnValueHandlers. \nTo fix the problem just replace the methodArgumentResolvers.add(...) with methodReturnValueHandlers.add(...) ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.0-RELEASE", "fixed_version": "spring-ws-2.0.1.RELEASE", "fixed_files": ["org.springframework.ws.server.endpoint.adapter.DefaultMethodEndpointAdapter.java"], "label": 1, "es_results": []}, {"bug_id": 721, "bug_title": "EndpointExceptionResolver mentions SOAP but this interface is not necessarily SOAP releated", "bug_description": "Javadoc for EndpointExceptionResolver:\n\n\n\n\n\n\nDefines the interface for objects than can resolve exceptions thrown during endpoint execution, resulting in SOAP messages.\n\n\n\n\n\n.\nNot true. Resolvers don&apos;t have to produce SOAP messages, but the ones in the SOAP packages do. Just eliminate the clause at the end.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.0-RELEASE", "fixed_version": "spring-ws-2.0.3.RELEASE", "fixed_files": ["org.springframework.ws.server.EndpointExceptionResolver.java"], "label": 1, "es_results": []}, {"bug_id": 358, "bug_title": "NPE in JmsSenderConnection.onReceiveBeforeRead() when the received Message is null", "bug_description": "We should test whether the Message returned by messageConsumer.receive is null (case of time out for instance) or else a NPE is thrown:\nMessage message = receiveTimeout >= 0 ? messageConsumer.receive(receiveTimeout) : messageConsumer.receive();", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.2", "fixed_version": "spring-ws-1.5.3", "fixed_files": ["org.springframework.ws.transport.jms.JmsSenderConnection.java", "org.springframework.ws.transport.jms.JmsMessageSenderIntegrationTest.java"], "label": 1, "es_results": []}, {"bug_id": 363, "bug_title": "AcegiPlainTextPasswordValidationCallbackHandler does not implement InitializingBean", "bug_description": "The AcegiPlainTextPasswordValidationCallbackHandler (both in xwss and wss4j packages) does provide an afterPropertiesSet method, but it is never called suring context setup, since it doesn&apos;t implement the InitializingBean interface.\nA workaround is to set it as \"init-method\" in the context.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.2", "fixed_version": "spring-ws-1.5.3", "fixed_files": ["org.springframework.ws.soap.security.wss4j.callback.acegi.AcegiPlainTextPasswordValidationCallbackHandler.java", "org.springframework.ws.soap.security.xwss.callback.SpringDigestPasswordValidationCallbackHandler.java", "org.springframework.ws.soap.security.xwss.callback.SpringCertificateValidationCallbackHandler.java", "org.springframework.ws.soap.security.wss4j.callback.acegi.AcegiDigestPasswordValidationCallbackHandler.java", "org.springframework.ws.soap.security.xwss.callback.acegi.AcegiDigestPasswordValidationCallbackHandler.java", "org.springframework.ws.soap.security.wss4j.callback.SpringPlainTextPasswordValidationCallbackHandler.java", "org.springframework.ws.soap.security.wss4j.callback.SpringDigestPasswordValidationCallbackHandler.java", "org.springframework.ws.soap.security.xwss.callback.acegi.AcegiCertificateValidationCallbackHandler.java", "org.springframework.ws.soap.security.xwss.callback.SpringPlainTextPasswordValidationCallbackHandler.java", "org.springframework.ws.soap.security.xwss.callback.acegi.AcegiPlainTextPasswordValidationCallbackHandler.java"], "label": 1, "es_results": []}, {"bug_id": 367, "bug_title": "SOAP over JMS (BEA Weblogic 9.2) - empty body in SOAP responses with a jms TextMessage", "bug_description": "A SOAP request is sent over JMS, the JMSReplyTo is set manually to an internal jms Queue.\nBoth for normal responses and for soap faults, the produced response (TextMessage) has an empty soap body.\nThe problem is coming from the following method in org.springframework.ws.transport.jms.JmsReceiverConnection\n    protected OutputStream getResponseOutputStream() throws IOException {\n        if (responseMessage instanceof BytesMessage) \n{\n            return new BytesMessageOutputStream((BytesMessage) responseMessage);\n        }\n        else if (responseMessage instanceof TextMessage) {\n            return new ByteArrayOutputStream() {\n                public void close() throws IOException {\n                    String text = new String(toByteArray(), textMessageEncoding);\n                    try \n{\n                        ((TextMessage) responseMessage).setText(text);\n                    }\n                    catch (JMSException ex) \n{\n                        throw new JmsTransportException(ex);\n                    }\n                }\n            };\n        }\n        else \n{\n            throw new IllegalStateException(\"Unknown request message type [\" + responseMessage + \"]\");\n        }\n    }\nThe close() on the private class set the text property of the TextMessage, but  the close() is called AFTER the message has been sent by the JMS message producer :\nSee this method in the ancestor AbstractWebServiceConnection\n    public final void send(WebServiceMessage message) throws IOException {\n        onSendBeforeWrite(message);\n        tos = createTransportOutputStream();\n        if (tos == null) \n{\n            return;\n        }\n        message.writeTo(tos);\n        tos.flush();\n        onSendAfterWrite(message);\n    }\nFor a TextMessage the line : message.writeTo(tos) did not set yet the text property of the TextMessage, then the onSendAfterWrite(message) is called, which sends the JMS message to the destination ( see in JmsReceiverConnection).  \nFinally, a close() is performed in the caller bean ( a message listener) via a TransportUtils.closeConnection(connection) which closes also the private ByteArrayOutputStream, but a bit too late ...\nThe JMS Specification says : \n3.9 Access to Sent Messages\nAfter sending a message, a client may retain and modify it without affecting\nthe message that has been sent. The same message object may be sent multiple\ntimes.\nI have triggered the &apos;set&apos; of the text property with the flush() method instead of the close(). It solved the problem but it&apos;s not very proper because the flush() may be called multiple times when writing in a OutputStream\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.2", "fixed_version": "spring-ws-1.5.3", "fixed_files": ["org.springframework.ws.transport.jms.JmsSenderConnection.java", "org.springframework.ws.transport.jms.JmsReceiverConnection.java", "org.springframework.ws.transport.jms.JmsMessageSenderIntegrationTest.java"], "label": 1, "es_results": []}, {"bug_id": 365, "bug_title": "wss4j-1.5.4.jar not in repository", "bug_description": "The Spring-WS project:\nhttp://repo1.maven.org/maven2/org/springframework/ws/spring-ws-parent/1.5.2/spring-ws-parent-1.5.2.pom\nhas a reference to wss4j-1.5.4.jar\nThis jar doesn&apos;t exist in the maven repo&apos;s. The only way i&apos;ve found to get it is from the manual \"all dependencies\" download of spring-ws.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.2", "fixed_version": "spring-ws-1.5.3", "fixed_files": ["org.springframework.ws.soap.security.wss4j.Wss4jHandler.java"], "label": 1, "es_results": []}, {"bug_id": 359, "bug_title": "Using Axiom with payload caching off sometimes creates empty soap bodies", "bug_description": "It appears that if you&apos;re using Castor to marshal your responses, and you&apos;re using Axiom without payload caching, that the SOAP response comes back with an empty Soap Body.  I did not try this with other Marshalling technologies like JAXB, etc, so I&apos;m not sure if it is restricted to Castor only or not.\nIt looks like NonCachingPayload.DelegatingStreamWriter.writeEndDocument() never gets called at least when marshalling with Castor.  Castor by default does not fire an endDocument SAX event (or close or flush for that matter).  But if you call setMarshalAsDocument(true) on a castor marshaller it does call endDocument().\nI just now worked around this with Castor by creating a simple subclass of CastorMarshaller like this below:\n    public class MyCastorMarshaller extends CastorMarshaller {\n        protected void customizeMarshaller(Marshaller marshaller) \n{\n            super.customizeMarshaller(marshaller);\n            marshaller.setMarshalAsDocument(true);\n        }\n    }\nSee this forum thread for additional details: http://forum.springframework.org/showthread.php?p=181732&posted=1#post181732", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.2", "fixed_version": "spring-ws-1.5.3", "fixed_files": ["org.springframework.ws.soap.axiom.Payload.java", "org.springframework.ws.soap.axiom.NonCachingPayload.java", "org.springframework.ws.soap.axiom.CachingPayload.java"], "label": 1, "es_results": []}, {"bug_id": 376, "bug_title": "SaajSoapMessage.setSaajMessage() and AxiomSoapMessage.setAxiomMessage() should clear cached fields", "bug_description": "The cached envelope fields in SaajSoapMessage and AxiomSoapMessage should be set to null when setSaajMessage or setAxiomMessage is called.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.2", "fixed_version": "spring-ws-1.5.3", "fixed_files": ["org.springframework.ws.soap.axiom.AxiomSoapMessage.java", "org.springframework.ws.soap.saaj.SaajSoapMessage.java"], "label": 1, "es_results": []}, {"bug_id": 370, "bug_title": "'KeyStoreUtils.loadDefaultKeyStore()' issue", "bug_description": "In the loadDefaultKeyStore method of org.springframework.ws.soap.security.support.KeyStoreUtils class I found this code:\n....\nString passwordProperty = System.getProperty(\"javax.net.ssl.keyStorePassword\");\nif (StringUtils.hasLength(passwordProperty)) \n{\n        password = passwordProperty;\n    }\n    type = System.getProperty(\"javax.net.ssl.trustStore\");\n}\n....\nIn the line, System.getProperty(\"javax.net.ssl.trustStore\"), the String parameter should be \"javax.net.ssl.keyStoreType\", right?\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.2", "fixed_version": "spring-ws-1.5.3", "fixed_files": ["org.springframework.ws.soap.security.support.KeyStoreUtils.java"], "label": 1, "es_results": []}, {"bug_id": 392, "bug_title": "AbstractMarshallingPayloadEndpoint and XStreamMarshaller produces malformed response body", "bug_description": "Marshalling and unmarshalling of objects to XML payloads using AbstractMarshallingPayloadEndpoint and XStreamMarshaller seems to generated malformed SOAP Message when using XStream 1.2.1 or newer (XStream 1.2 works without problems).\nThe fundamental method of my endpoint looks like this:\nCode:\n  protected Object invokeInternal(Object object) throws Exception {\n    MovieReservation movieReservationRequest = (MovieReservation) object;\n    ReservationConfirmation confirmation = new ReservationConfirmation();\n    confirmation.setId(new Date().getDate());\n    confirmation.setSeatIds(new int[] \n{1, 2, 3, 4}\n);\n    return confirmation;\n  }\nThe SOAP response, which is malformed, looks as follows:\nCode:\n<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"..../\">\n  <SOAP-ENV:Header/>\n  <SOAP-ENV:Body/>\n  <ReservationConfirmation>\n    <id>23</id>\n    <seatIds>\n      <int>1</int>\n      <int>2</int>\n      <int>3</int>\n      <int>4</int>\n    </seatIds>\n  </ReservationConfirmation>\n</SOAP-ENV:Envelope>\nNotice the empty header and empty body and the ReservationConfirmation element following the body element (which is incorrect, since this element should be within the body).\nI suspect the Spring org.s.x.oxm.XStreamWriter and its method marshalDomDone which contains the following lines\nCode:\n        else if (node instanceof Element) \n{\n            streamWriter = new DomWriter((Element) node);\n        }\n\nHowever, sometimes between XStream 1.2 and XStream 1.3 the functionality of DomWriter has changed. This is described on the XStream mailing list in the \"DOMWriter uses root element for marshalling instead of specified element\" topic [1]\nThe suggested change is described in that post:\"To write into an arbitrary node you have to use the constructor DomWriter(Element, Document, XmlFriendlyReplacer).\"\nShouldn&apos;t the XStreamMarshall use the suggested three-param constructor instead of the default?\n[1] http://www.nabble.com/DOMWriter-uses-root-element-for-marshalling-instead-of-specified-element-td16088975.html#a16088975", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.2", "fixed_version": "spring-ws-1.5.4", "fixed_files": ["org.springframework.oxm.xstream.XStreamMarshaller.java", "org.springframework.oxm.xstream.XStreamMarshallerTest.java"], "label": 1, "es_results": []}, {"bug_id": 427, "bug_title": "AbstractEndpointExceptionResolver.resolveException() does not let subclasses have full access to the MethodEndpoint that raised an exception", "bug_description": "In resolveException(), the MethodEndpoint gets replaced with it&apos;s bean name. As a consequence, subclasses can no longer inspect the MethodEndpoint.\nDiscussion in this thread: http://forum.springframework.org/showthread.php?p=200392.\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.2", "fixed_version": "spring-ws-1.5.5", "fixed_files": ["org.springframework.ws.server.endpoint.AbstractEndpointExceptionResolver.java"], "label": 1, "es_results": []}, {"bug_id": 389, "bug_title": "problem with DomContentHandler", "bug_description": "Everytime the function appendChild on a Node is used , the return value should be set to the original node (the one passed as argument). This must be done as Jboss create it&apos;s own element and use it as a wrapper around the one has been passed in the function.\nSo , for example, the code in the function startElement(..) should be changed from:\n        Node parent = getParent();\n        Element element = document.createElementNS(uri, qName);\n        ...........(more code here)\n        parent.appendChild(element);\n        elements.add(element);\nto\n        Node parent = getParent();\n        Element element = document.createElementNS(uri, qName);\n        ...........(more code here)\n        element = parent.appendChild(element);\n        elements.add(element);\nAnd so on everywhere appendChild is used.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.3", "fixed_version": "spring-ws-1.5.4", "fixed_files": ["org.springframework.xml.dom.DomContentHandler.java"], "label": 1, "es_results": []}, {"bug_id": 386, "bug_title": "DefaultWsdl11Definition.setFaultSuffix : responseSuffix overwritten", "bug_description": "There is a bug in DefaultWsdl11Definition.setFaultSuffix\nIt should be\n    /** Sets the suffix used to detect fault elements in the schema. */\n    public void setFaultSuffix(String faultSuffix) \n{\n        portTypesProvider.setFaultSuffix(faultSuffix);\n        //messagesProvider.setResponseSuffix(faultSuffix);\n        messagesProvider.setFaultSuffix(faultSuffix);\n    }\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.3", "fixed_version": "spring-ws-1.5.4", "fixed_files": ["org.springframework.ws.wsdl.wsdl11.DefaultWsdl11Definition.java"], "label": 1, "es_results": []}, {"bug_id": 393, "bug_title": "Incoming message with with UTF-8 BOM is failing", "bug_description": "When submitting a SOAP request that contains a UTF BOM http://unicode.org/faq/utf_bom.html#22, the following fault string is returned: \"Could not access envelope: Unable to create envelope from given source:\"\nAfter removing the offending BOM, and not manipulating the XML in any other way, the message is is delivered to the defined Endpoint successfully.\nPer http://unicode.org/faq/utf_bom.html#29 , Spring-WS should be able to transparently ignore the BOM on UTF-8 files.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.3", "fixed_version": "spring-ws-1.5.4", "fixed_files": ["org.springframework.ws.soap.saaj.SaajSoapMessageFactory.java", "org.springframework.ws.soap.soap11.AbstractSoap11MessageFactoryTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 396, "bug_title": "@Endpoint with method having any other annotation then @PayloadRoot is not mapped", "bug_description": "I&apos;ve got @PayloadRoot annotated methods of @Endpoint and some methods also has @RolesAllowed from spring security. Today after upgrading from spring-ws 1.5.2 PayloadRootAnnotationMethodEndpointMapping stopped to processed this endpoint. I&apos;ve also tried another (my custom @Log AOP annotation) annotation with same (bad) result. \nSo now after last test, when any @Endpoint method has any other annotation then @PayloadRoot, it is not mapped.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.3", "fixed_version": "spring-ws-1.5.4", "fixed_files": ["org.springframework.ws.server.endpoint.mapping.AbstractAnnotationMethodEndpointMapping.java", "org.springframework.ws.server.endpoint.mapping.AbstractMethodEndpointMapping.java", "org.springframework.ws.server.endpoint.mapping.PayloadRootAnnotationMethodEndpointMappingTest.java", "org.springframework.ws.server.endpoint.mapping.PayloadRootEndpoint.java"], "label": 1, "es_results": []}, {"bug_id": 411, "bug_title": "When using permanent replyTo queues, their JNDI names cannot start with jms/ in the defaultUri property of the WebServiceGateway", "bug_description": "We are using permanent queues defined as JNDI resources in a WAS 6.1. Their JNDI names start with jms/, for instance jms/RESPONSE_QUEUE.\nWe have a client which is configured like this, along side with a jndiDestinationResolver and a jndiTemplate:\n[code]\n<bean id=\"serviceGateway\" class=\"net.croz.client.ServiceGatewayImpl\">\n        <property name=\"defaultUri\" value=\"jms:jms/REQUEST_QUEUE?replyToName=jms/REPLY_QUEUE\" />\n        <property name=\"messageSenders\">\n            <bean class=\"org.springframework.ws.transport.jms.JmsMessageSender\">\n                <property name=\"connectionFactory\" ref=\"mqConnectionFactory\" />\n                <property name=\"pubSubDomain\" value=\"false\" />\n                <property name=\"destinationResolver\" ref=\"jndiDestinationResolver\"></property>\n                <property name=\"receiveTimeout\" value=\"10000\"></property>\n            </bean>\n        </property>\n</bean>\n<bean id=\"jndiTemplate\"\n        class=\"org.springframework.jndi.JndiTemplate\">\n        <property name=\"environment\">\n          <props>\n            <prop key=\"java.naming.factory.initial\">com.ibm.websphere.naming.WsnInitialContextFactory</prop>\n            <prop key=\"java.naming.provider.url\">iiop://localhost:2810</prop>\n          </props>\n        </property>\n</bean>\n<bean id=\"jndiDestinationResolver\" class=\"org.springframework.jms.support.destination.JndiDestinationResolver\">\n        <property name=\"jndiTemplate\" ref=\"jndiTemplate\"></property>\n</bean>\n[code/]\nWhen invoking a fully functional web service (under our control), the request ends up in the REQUEST_QUEUE, but when the client tries to find the RESPONSE_QUEUE via its JNDI name (jms/REPLY_QUEUE) it fails with:\n[code]\nDestination [jms] not found in JNDI; nested exception is org.springframework.jndi.TypeMismatchNamingException: Object of type [class com.ibm.ws.naming.jndicos.CNContextImpl] available at JNDI location [jms] is not assignable to [javax.jms.Destination]\n[/code]\nObserve the \"..available at JNDI location [jms]...\" part in particular... This led me to investigate the code responsible for parsing the defaultUri property of the WebServiceGateway. What I&apos;ve found is that the regular expression responsible for the parsing of the replyToName part of the defaultUri:\n[code]\npublic abstract class JmsTransportUtils {\n.......    \n     private static final Pattern REPLY_TO_NAME_PATTERN = Pattern.compile(\"replyToName=(w+)\");\n.......\n}\n[/code]\nstrips everything behind the \"jms\" part of the JNDI name.\nTo do a quick fix, I&apos;ve externalized the JmsTransportUtils class and changed the REPLY_TO_NAME_PATTERN to be similar to the DESTINATION_NAME_PATTERN:\n[code]\npublic abstract class JmsTransportUtils {\n.......    \n     private static final Pattern REPLY_TO_NAME_PATTERN = Pattern.compile(\"replyToName=([^\\\\?]+)\");\n.......\n}\n[/code] ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.3", "fixed_version": "spring-ws-1.5.5", "fixed_files": ["org.springframework.ws.transport.jms.support.JmsTransportUtils.java", "org.springframework.ws.transport.jms.support.JmsTransportUtilsTest.java"], "label": 1, "es_results": []}, {"bug_id": 416, "bug_title": "Wss4jSecurityInterceptor loosing SOAPAction header", "bug_description": "When the Wss4jSecurityInterceptor replaces the AxiomMessage in the SoapMessage, if the original SoapMessage already had a SoapAction set, the value is lost.\nI believe, in the Wss4jSecurityInterceptor.replaceMessage() method, the following workaround should be done:\n// replace the Axiom message\nString tempSoapAction = soapMessage.getSoapAction();\naxiomMessage.setAxiomMessage(newMessage);\nsoapMessage.setSoapAction(tempSoapAction);", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.3", "fixed_version": "spring-ws-1.5.5", "fixed_files": ["org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 473, "bug_title": "JmsSenderConnection does not commit transaction after send, leading to messages never being sent if sessionTransacted is true", "bug_description": "When sending a JMS message using a org.springframework.ws.transport.jms.JmsMessageSender with sessionTransacted set to true, the org.springframework.ws.transport.jms.JmsSenderConnection.onSendAfterWrite method doesn&apos;t commit the transaction.  This leads to the transaction being rolled back when the connection is closed so the message is never sent.  JMSUtils.commitIfNecessary should be called before closing the message producer.\nAn example of how this is done in JmsTemplate:\n\n\n\n\n\n\nJmsTemplate.java\n\n\n\n\n\n\nprotected void doSend(Session session, Destination destination, MessageCreator messageCreator)\n\n\n\n\n\t\t\tthrows JMSException {\n\n\n\n\n\n\n\n\n\n\t\tAssert.notNull(messageCreator, \"MessageCreator must not be null\");\n\n\n\n\n\t\tMessageProducer producer = createProducer(session, destination);\n\n\n\n\n\t\ttry {\n\n\n\n\n\t\t\tMessage message = messageCreator.createMessage(session);\n\n\n\n\n\t\t\tif (logger.isDebugEnabled()) {\n\n\n\n\n\t\t\t\tlogger.debug(\"Sending created message: \" + message);\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t\tdoSend(producer, message);\n\n\n\n\n\t\t\t// Check commit - avoid commit call within a JTA transaction.\n\n\n\n\n\t\t\tif (session.getTransacted() && isSessionLocallyTransacted(session)) {\n\n\n\n\n\t\t\t\t// Transacted session created by this template -> commit.\n\n\n\n\n\t\t\t\tJmsUtils.commitIfNecessary(session);\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t}\n\n\n\n\n\t\tfinally {\n\n\n\n\n\t\t\tJmsUtils.closeMessageProducer(producer);\n\n\n\n\n\t\t}\n\n\n\n\n\t}\n\n\n\n\n\n\nSimilarly, the following should be done in JmsSenderConnection:\n\n\n\n\n\n\nJmsSenderConnection.java\n\n\n\n\n\n\nprotected void onSendAfterWrite(WebServiceMessage message) throws IOException {\n\n\n\n\n        MessageProducer messageProducer = null;\n\n\n\n\n        try {\n\n\n\n\n            messageProducer = session.createProducer(requestDestination);\n\n\n\n\n            messageProducer.setDeliveryMode(deliveryMode);\n\n\n\n\n            messageProducer.setTimeToLive(timeToLive);\n\n\n\n\n            messageProducer.setPriority(priority);\n\n\n\n\n            if (responseDestination == null) {\n\n\n\n\n                responseDestination = session.createTemporaryQueue();\n\n\n\n\n            }\n\n\n\n\n            requestMessage.setJMSReplyTo(responseDestination);\n\n\n\n\n            connection.start();\n\n\n\n\n            messageProducer.send(requestMessage);\n\n\n\n\n            if (session.getTransacted()) {\n\n\n\n\n               JmsUtils.commitIfNecessary(session);\n\n\n\n\n            }\n\n\n\n\n        }\n\n\n\n\n        catch (JMSException ex) {\n\n\n\n\n            throw new JmsTransportException(ex);\n\n\n\n\n        }\n\n\n\n\n        finally {\n\n\n\n\n            JmsUtils.closeMessageProducer(messageProducer);\n\n\n\n\n        }\n\n\n\n\n    }\n\n\n\n\n\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.3", "fixed_version": "spring-ws-1.5.6", "fixed_files": ["org.springframework.ws.transport.jms.JmsSenderConnection.java", "org.springframework.ws.transport.jms.JmsMessageSender.java"], "label": 1, "es_results": []}, {"bug_id": 576, "bug_title": "sentMessageTracingLogger  skips request message headerer content ", "bug_description": "In org.springframework.ws.server.MessageDispatcher class sentMessageTracingLogger with trace level does not log the same request message as the one being logged by receivedMessageTracingLogger.\nI&apos;ve noticed that request message having <SOAP-ENV:Header> with wss4j stuff is properly logged by receivedMessageTracingLogger on trace level:\n\n\n\n\n\n\nReceived request [<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\">\n\n\n\n\n<SOAP-ENV:Header>\n\n\n\n\n<wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" SOAP-ENV:mustUnderstand=\"1\">\n\n\n\n\n<wsse:UsernameToken xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" wsu:Id=\"UsernameToken-21398464\">\n\n\n\n\n<wsse:Username>876543</wsse:Username>\n\n\n\n\n<wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\">a701050a4e03ef54319c319c9a06a895</wsse:Password>\n\n\n\n\n</wsse:UsernameToken>\n\n\n\n\n</wsse:Security>\n\n\n\n\n</SOAP-ENV:Header>\n\n\n\n\n<SOAP-ENV:Body>....</SOAP-ENV:Body></SOAP-ENV:Envelope>] \n\n\n\n\n\n\nUnfortunately sentMessageTracingLogger strips out content of <SOAP-ENV:Header> when logging request message:\n\n\n\n\n\n\nSent response [------=_Part_18_463346590.1255441172093\n\n\n\n\nContent-Type: application/xop+xml; type=\"text/xml\"; charset=utf-8\n\n\n\n\n\n\n\n\n\n<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\">\n\n\n\n\n<SOAP-ENV:Header/>\n\n\n\n\n<SOAP-ENV:Body>...</SOAP-ENV:Body></SOAP-ENV:Envelope>\n\n\n\n\n------=_Part_18_463346590.1255441172093--] for request [<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"><SOAP-ENV:Header>\n\n\n\n\n</SOAP-ENV:Header><SOAP-ENV:Body>...</SOAP-ENV:Body></SOAP-ENV:Envelope>\n\n\n\n\n\n\nIt seems that wss4j headers are processed by WSS4j Interceptor and then somehow removed from requestMessage. Actually had no time to dig it further and check if custom headres are also stripped out.\nAnyway i think that sentMessageTracingLogger  should log original client request message.\nI am attaching patch version of MessageDispatcher", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.3", "fixed_version": "spring-ws-1.5.9", "fixed_files": ["org.springframework.ws.server.MessageDispatcher.java"], "label": 1, "es_results": []}, {"bug_id": 418, "bug_title": "Castor mappings are added multiple times", "bug_description": "When using multiple mapping files for castor the CastorMarshaller adds each mapping several times.\ni.e.\n<bean id=\"castorMarshaller\" class=\"org.springframework.oxm.castor.CastorMarshaller\" >\n\t\t<property name=\"mappingLocations\">\n\t\t\t<list>                               \n\t\t\t\t<value>classpath:file1.xml</value>\n\t\t\t\t<value>classpath:file2.xml</value>                \n\t\t\t\t<value>classpath:file3.xml</value>\n\t\t\t</list>\n\t\t</property>\n</bean>\nThe mappings from file1 are added 3 times because the addMapping() method is called within the loop with the entire mapping.\nI think method\n    protected XMLContext createXMLContext(Resource[] mappingLocations, Class targetClass)\n            throws MappingException, IOException, ResolverException {\n        XMLContext context = new XMLContext();\n        if (!ObjectUtils.isEmpty(mappingLocations)) {\n            Mapping mapping = new Mapping();\n            for (int i = 0; i < mappingLocations.length; i++) \n{\n                mapping.loadMapping(SaxUtils.createInputSource(mappingLocations[i]));\n                context.addMapping(mapping);\n            }\n        }\n        if (targetClass != null) \n{\n            context.addClass(targetClass);\n        }\n        return context;\n    }\n\nShould actually look like this\n\n    protected XMLContext createXMLContext(Resource[] mappingLocations, Class targetClass)\n            throws MappingException, IOException, ResolverException {\n        XMLContext context = new XMLContext();\n        if (!ObjectUtils.isEmpty(mappingLocations)) {\n            Mapping mapping = new Mapping();\n            for (int i = 0; i < mappingLocations.length; i++) {\n                mapping.loadMapping(SaxUtils.createInputSource(mappingLocations[i]));\n            }\n            context.addMapping(mapping);\n        }\n        if (targetClass != null) {            context.addClass(targetClass);        }\n        return context;\n    }\nBY THE WAY: Adding mappings multiple times will result in strange behavior because Castor tries identify objects by their namespace if it finds multiple entries with the same name and fails because of bad namespace support within castor.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.4", "fixed_version": "spring-ws-1.5.5", "fixed_files": ["org.springframework.oxm.castor.CastorMarshaller.java"], "label": 1, "es_results": []}, {"bug_id": 412, "bug_title": "PayloadTransformingInterceptor does not work with a DomPoxMessage - the transformation clears the document", "bug_description": "This bug is related to SWS-248\nEmptying the Document in the method getPayloadResult() of the DomPoxMessage makes the transformation in the PayloadTransformingInterceptor  impossible.\nPayloadTransformingInterceptor  source code 1.5.4\n80      public boolean handleRequest(MessageContext messageContext, Object endpoint) throws Exception {\n81          if (requestTemplates != null) \n{\n82              WebServiceMessage request = messageContext.getRequest();\n83              Transformer transformer = requestTemplates.newTransformer();\n84              transformer.transform(request.getPayloadSource(), request.getPayloadResult());\n85              logger.debug(\"Request message transformed\");\n86          }\n87          return true;\n88      }\nLine 84, before the transform() method is called, the 2nd argument evaluation clears the document inside the DomPoxMessage, so the DOMSource created by calling the 1st argument wraps now an empty document, the transformation returns always an empty XML.\nSee my small test :\n\tpublic static void main(String[] args) throws IOException, TransformerFactoryConfigurationError, TransformerException \n{\n\t\n\t\t\n\t\tString content = \"<element xmlns=\\\"http://www.springframework.org/spring-ws\\\" />\";\n\t\tbyte[] bytes = content.getBytes(\"UTF-8\");\n\t    InputStream input = new ByteArrayInputStream(bytes);\n\t\t\n\t\tDomPoxMessageFactory factory = new DomPoxMessageFactory();\n\t\tDomPoxMessage domPoxMsg = (DomPoxMessage) factory.createWebServiceMessage(input);\n\t\t\n\t\t\n\t\tResult result = new StreamResult(System.out);\n\t\tTransformer t = TransformerFactory.newInstance().newTransformer();\n\t\tSystem.out.println(\"1. Transformation to System.out :\");\n\t\tt.transform(domPoxMsg.getPayloadSource(), result);\n\t\t\n\t\tSystem.out.println(\"\\n\\n\");\n\t\tSystem.out.println(\"2. Transformation to message itself as Result (=interceptor)\");\n\t\tt.transform(domPoxMsg.getPayloadSource(), domPoxMsg.getPayloadResult());\n\t\t\n\t\tSystem.out.println(\"\\n\\n\");\n\t\tSystem.out.println(\"3. Transformation to System.out :\");\n\t\tt.transform(domPoxMsg.getPayloadSource(), result);\n\t\t\n\t\t\n\t}\n\nThe solution may be to add an intermediate transformation ( a simple StreamResult) but as it is working for other WebServiceMessage implementation ( SOAP ) it could be too heavy ...\nNote also that a testPayLoadInterceptor() could be added in DomPoxMessageTest ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.4", "fixed_version": "spring-ws-1.5.5", "fixed_files": ["org.springframework.ws.server.endpoint.interceptor.PayloadTransformingInterceptorTest.java", "org.springframework.ws.server.endpoint.interceptor.PayloadTransformingInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 432, "bug_title": "AxiomSoap12Body.getFault() returns object of type AxiomSoap11Fault", "bug_description": "AxiomSoap12Body.getFault() returns object of type AxiomSoap11Fault\nBecause: AxiomSoap12Body does not implement the method getFault. So the getFault() method of the super class AxiomSoapBody is called which returns an object of type AxiomSoap11Fault.\nProposal to solve the issue: Remove the getFault() method from the super class and implement specific methods in the sub classes AxiomSoap11Body respectively AxiomSoap12Body.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.4", "fixed_version": "spring-ws-1.5.5", "fixed_files": ["org.springframework.ws.soap.axiom.AxiomSoap11Body.java", "org.springframework.ws.soap.axiom.AxiomSoap12Body.java", "org.springframework.ws.soap.axiom.AxiomSoapBody.java"], "label": 1, "es_results": []}, {"bug_id": 420, "bug_title": "AxiomSoapMessage + SOAP1.2 SoapAction", "bug_description": "AxiomSoapMessage and SOAP1.2 SoapAction Problem.\nI&apos;m not sure, but as far as I read, in SOAP 1.2 the SoapAction parameter now part of Content-Type.\n( http://www.w3.org/TR/2003/REC-soap12-part2-20030624/#ietf-action ).\norg.springframework.ws.soap.axiom.AxiomSoapMessage.writeTo(OutputStream outputStream) don&apos;t extend the content-type header with the action paramater\nin case of an soap1.2 message.\nindependent from the soap version, an SOAPAction header element is created.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.4", "fixed_version": "spring-ws-1.5.5", "fixed_files": ["org.springframework.ws.soap.soap12.AbstractSoap12MessageTestCase.java", "org.springframework.ws.soap.soap11.AbstractSoap11MessageFactoryTestCase.java", "org.springframework.ws.transport.TransportConstants.java", "org.springframework.ws.soap.soap12.AbstractSoap12MessageFactoryTestCase.java", "org.springframework.ws.soap.AbstractSoapMessage.java", "org.springframework.ws.soap.axiom.AxiomSoapMessage.java", "org.springframework.ws.soap.axiom.AxiomSoapMessageFactory.java", "org.springframework.ws.soap.saaj.SaajSoapMessage.java"], "label": 1, "es_results": []}, {"bug_id": 434, "bug_title": "JibxMarshaller - marshalSaxHandlers", "bug_description": "JiBX does not support SAX natively, so there is written to a buffer first:\nByteArrayOutputStream os = new ByteArrayOutputStream();\nmarshalOutputStream(graph, os);\nByteArrayInputStream is = new ByteArrayInputStream(os.toByteArray());\nthe character < results in &<; and not in < as expected.\nhttp://forum.springframework.org/showthread.php?t=55407&highlight=SAXResult", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.4", "fixed_version": "spring-ws-1.5.6", "fixed_files": ["org.springframework.ws.soap.axiom.AxiomHandlerTest.java", "org.springframework.ws.soap.axiom.AxiomHandler.java"], "label": 1, "es_results": []}, {"bug_id": 442, "bug_title": "Generated WSDL file does not contain xmime attribute \"expectedContentTypes\" present in xsd files.", "bug_description": "The attachment contains the following files,\n       1)Normal0.xsd-- schema file containing \"xmime:expectedContentTypes\" attribute.\n       2)Normal1.xsd-- schema file.\n       3)MyService.wsdl-- WSDL file generated using \"org.springframework.ws.wsdl.wsdl11.DefaultWsdl11Definition\" class.\n       4)spring-ws-servlet.xml-- Servlet config file used for generation of wsdl.\nIn spring-ws-servlet.xml file, \n    \"org.springframework.ws.wsdl.wsdl11.DefaultWsdl11Definition\" bean generates the wsdl file from the schemaCollection bean which uses the \"org.springframework.xml.xsd.commons.CommonsXsdSchemaCollection\" class.\nThe Normal0.xsd file,\n     uses the xmime:expectedContentTypes=\"application/octet-stream\" attribute to specify binary data, but the wsdl generated by \"org.springframework.ws.wsdl.wsdl11.DefaultWsdl11Definition\" class does not contain the xmime attribute.The generated wsdl file \"MyService.wsdl\" is attached.\nWithout xmime attribute in generated wsdl file the client code generation will not have Datahandler class.\nIt is also observed that when i use \"org.springframework.xml.xsd.SimpleXsdSchema\" class for specifying xsd file, the xmime attribute is reflected in wsdl file.But this class cannot be used for multiple xsd files.\nKindly let me know if more info is required,\nThanks in advance ,\nNavin Bhat \n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.4", "fixed_version": "spring-ws-1.5.6", "fixed_files": ["org.springframework.xml.xsd.commons.CommonsXsdSchemaCollection.java", "org.springframework.xml.xsd.AbstractXsdSchemaTestCase.java", "org.springframework.xml.xsd.commons.CommonsXsdSchema.java"], "label": 1, "es_results": []}, {"bug_id": 448, "bug_title": "Wss4jSecurityInterceptor accept messages when <wsse:header> is empty", "bug_description": "http://forum.springframework.org/showthread.php?t=63553\nThe problem is when Wss4jSecurityInterceptor is used in the server side, to validate username token (or signature).\nEverything looks fine except when a <wsse:header> empty is sent. The Interceptor let us the messsage goes and don&apos;t\nthrow any exceptions.\nAs an attachment, I&apos;m sending a maven project with JUnit tests to prove the case. The project is a very simple web service\nbased on the tutorial sample. I just configure the wss4j interceptor for validate username token.\nThe only test that is doesn&apos;t pass is the last &apos;testSendMessageWithEmptyWsseHeader&apos;\nSorry for my english... it isn&apos;t my native language. ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.5", "fixed_version": "spring-ws-1.5.6", "fixed_files": ["org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor.java", "org.springframework.ws.soap.security.wss4j.Wss4jMessageInterceptorHeaderTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 455, "bug_title": "Mangled predefined xml 'special character' entities when using AxiomSoapMessageFactory and extending AbstractStaxStreamPayloadEndpoint", "bug_description": "Using AxiomSoapMessageFactory and with an endpoint extending AbstractStaxStreamPayloadEndpoint, special character predefined entities like & or < in HTTP response get &apos;mangled&apos;.  For example, when the endpoint writes  <echo:echoRequest> < </echo:echoRequest> to the XMLStreamWriter (which is correct) what actually gets sent in the resulting AxiomSoapMessage is this: <echo:echoRequest> &<; </echo:echoRequest> (which is incorrect).  I recreated this bug with the echo sample application in 1.5.5 by changing the endpoint to extend AbstractStaxStreamPayloadEndpoint and specifying the AxiomSoapMessageFactory  in the spring-ws-servlet.xml file (documented in this forum thread: http://forum.springframework.org/showthread.php?p=215668)\nI was able to correct this behavior by modifying org.springframework.ws.soap.axiom.AxiomHandler - I simply commented out the statements inside startEntity(..) and endEntity(..) functions making them \"unsupported\".  While this did not produce any side-effects during the testing I did for my project, I have not run the full spring-ws test suite.  The change is as follows:\nclass AxiomHandler implements ContentHandler, LexicalHandler {\n...\n public void startEntity(String name) throws SAXException \n{\n        //make unsupported to fix mangling of special character entities        \n        //charactersType = XMLStreamConstants.ENTITY_REFERENCE;\n    }\n\n    public void endEntity(String name) throws SAXException \n{\n        //make unsupported to fix mangling of special character entities\n        //charactersType = XMLStreamConstants.CHARACTERS;\n    }\n\n...\n}\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.5", "fixed_version": "spring-ws-1.5.6", "fixed_files": ["org.springframework.ws.soap.axiom.AxiomHandlerTest.java", "org.springframework.ws.soap.axiom.AxiomHandler.java"], "label": 1, "es_results": []}, {"bug_id": 464, "bug_title": "The use of WS Addressing results in malformed SOAP messages", "bug_description": "When WS Addressing is being used the Axiom message factory appears to produce malformed SOAP messages (details to follow)  ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.5", "fixed_version": "spring-ws-1.5.6", "fixed_files": ["org.springframework.ws.soap.saaj.Saaj13Implementation.java", "org.springframework.ws.soap.AbstractSoapElementTestCase.java", "org.springframework.ws.soap.saaj.Saaj11Implementation.java", "org.springframework.ws.soap.SoapElement.java", "org.springframework.ws.soap.saaj.SaajSoapElement.java", "org.springframework.ws.soap.saaj.SaajImplementation.java", "org.springframework.ws.soap.axiom.AxiomSoapElement.java", "org.springframework.ws.soap.addressing.version.AbstractAddressingVersion.java", "org.springframework.ws.soap.saaj.Saaj12Implementation.java"], "label": 1, "es_results": []}, {"bug_id": 457, "bug_title": "AxiomSoapMessageFactory payloadCaching=false causes org.springframework.ws.soap.axiom.AxiomSoapEnvelope.getBody()  to fail", "bug_description": "http://forum.springframework.org/showthread.php?t=64350\nHello,\nI have problem with AxiomSoapMessageFactory payloadCaching=false.\nSpring config is simple as this:\n\n\n\n\n\n\n<bean id=\"messageFactory\" class=\"org.springframework.ws.soap.axiom.AxiomSoapMessageFactory\">\n\n\n\n\n  <property name=\"payloadCaching\" value=\"false\"/>\n\n\n\n\n</bean>\n\n\n\n\n\n\n\n\n\n<bean class=\"org.springframework.ws.soap.server.endpoint.mapping.SoapActionEndpointMapping\">\n\n\n\n\n  <property name=\"mappings\">\n\n\n\n\n    <props>\n\n\n\n\n      <prop key=\"SoapAction1\">endpoint1</prop>\n\n\n\n\n    </props>\n\n\n\n\n  </property>\n\n\n\n\n</bean>\n\n\n\n\n\n\n\n\n\n<bean id=\"wsdl\" class=\"org.springframework.ws.wsdl.wsdl11.DefaultWsdl11Definition\">\n\n\n\n\n  <property name=\"schema\" ref=\"schema\" />\n\n\n\n\n  <property name=\"portTypeName\" value=\"resource1\" />\n\n\n\n\n  <property name=\"locationUri\" value=\"/service1/\" />\n\n\n\n\n  <property name=\"targetNamespace\" value=\"my.service\" />\n\n\n\n\n  <property name=\"soapActions\">\n\n\n\n\n    <props>\n\n\n\n\n      <prop key=\"UploadAddressMaterial\">SoapAction1</prop>\n\n\n\n\n    </props>\n\n\n\n\n  </property>\n\n\n\n\n</bean>\n\n\n\n\n\n\n\n\n\n<bean id=\"schema\" class=\"org.springframework.xml.xsd.SimpleXsdSchema \">\n\n\n\n\n  <property name=\"xsd\" value=\"/WEB-INF/schema.xsd\" />\n\n\n\n\n</bean>\n\n\n\n\n\n\nI&apos;m not using any kind of interceptors.\nActual ws end point extends AbstractStaxStreamPayloadEndpoint but the request doesn&apos;t get that far.\nI get exception \"com.sun.jdi.InvocationException occurred invoking method.\" when trying to invoke the web service in method org.springframework.ws.soap.axiom.AxiomSoapEnvelope.getBody().\nLine 59 SOAPBody axiomBody = getAxiomEnvelope().getBody(); fails some how and the OMException on line 71 is catched. This leads to:\n\"Nested in org.springframework.ws.soap.axiom.AxiomSoapMessage Exception: Could not write message to OutputStream: problem accessing the parser. Parser already accessed!; nested exception is javax.xml.stream.XMLStreamException: problem accessing the parser. Parser already accessed!:\njava.lang.IllegalStateException: Parser already accessed! \"\nI am running spring ws v.1.5.5 and spring core 2.5.6.\nEverything works fine if payloadCaching is true.\nIs this a bug? There is a resolved Jira that looks much the same: id SWS-359 ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.5", "fixed_version": "spring-ws-1.5.6", "fixed_files": ["org.springframework.ws.soap.axiom.NonCachingPayload.java", "org.springframework.ws.server.endpoint.StaxStreamPayloadEndpointTest.java"], "label": 1, "es_results": []}, {"bug_id": 469, "bug_title": "Content type not set accouring to Http specification, RFC 2616", "bug_description": "the AxiomSoapMessage and the SaajSoapMessage set the content-type  character-set incorrectly. \nThe character set is surrounded by double quotes i.e \"ISO-8859-1\". the specification however states, $14.17 and $3.7 clearly state that this is not allowed. Although most servers do not complain about it, the one i use does \nSince the implementation is not confirming to specifications, i would say it&apos;s a bug.\nPieter", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.5", "fixed_version": "spring-ws-1.5.6", "fixed_files": ["org.springframework.ws.soap.AbstractSoapMessageTestCase.java", "org.springframework.ws.soap.axiom.AxiomSoapMessage.java"], "label": 1, "es_results": []}, {"bug_id": 465, "bug_title": "Optional WS-Addressing request headers being treated as mandatory", "bug_description": "Using SimpleActionEndpointMapping results in wsa:MessageAddressingHeaderRequired errors being returned from a request unless that request specifies\na wsa:To and wsa:MessageID header. According to the WS-Addressing standard, only the wsa:Action header is mandatory.\nThe problem appears to lie in the  hasRequiredProperties() method of org.springframework.ws.soap.addressing.MessageAddressingProperties. This method insists on\n 1. wsa:To being present\n 2. wsa:MessageID being present if either ReplyTo or FaultTo have been specified. \nIn the case of (2) above I was able to trigger the fault by omitting all of the MessageID, ReplyTo and FaultTo headers in my request, so it may be that the server-side stack has inserted a default \"anonymous endpoint\" value into one or both of the latter and that is triggering the error.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.5", "fixed_version": "spring-ws-1.5.6", "fixed_files": ["org.springframework.ws.soap.addressing.server.AddressingInterceptor10Test.java", "org.springframework.ws.soap.addressing.version.AddressingVersion.java", "org.springframework.ws.soap.addressing.server.AbstractAddressingInterceptorTestCase.java", "org.springframework.ws.soap.addressing.version.Addressing200408.java", "org.springframework.ws.soap.addressing.version.Addressing10.java", "org.springframework.ws.soap.addressing.core.MessageAddressingProperties.java", "org.springframework.ws.soap.addressing.server.AddressingEndpointInterceptor.java", "org.springframework.ws.soap.addressing.version.AbstractAddressingVersion.java"], "label": 1, "es_results": []}, {"bug_id": 502, "bug_title": "Soap envelope rpc-encoded namespace issue ", "bug_description": "I have an rpc-encoded soap envelope containing the declarations of soapenv (xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\") and xsi (xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\") namespaces. \nThe first element of the soap body references soapenv in one of his attributes (soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"). Some xml elements in the soap body reference the xsi namespace (xsi:type=\"soapenc:string\") as well.\nWhen I try to parse the soap body (extracted from the soap envelope) using JDOM or DOM4J I get a SaxParseException because the soapenv and xsi namespaces are not bound:\norg.xml.sax.SAXParseException: The prefix \"soapenv\" for attribute \"soapenv:encodingStyle\" associated with an element type \"ns1:sendMessage\" is not bound.\nThe issue seems to be creating a org.springframework.xml.transform.StaxSource using XMLStreamReader from Axiom payload element and transforming it to a StreamResult.\nI have found a workaround transforming the StaxSource in a JDOMResult instead of a StreamResult.\nThe problem is the same as using javax.xml.transform.stax.StAXSource; some Axiom developers have suggested me to use OMSource from a snapshot version (https://issues.apache.org/jira/browse/WSCOMMONS-459) instead of StAXSource.\nThe problem is in org.springframework.ws.soap.axiom.Payload#getSource() that uses XMLStreamReader class: namespace declarations is ok if I use OMSource from the snapshot version of axiom (the abstract method getStreamReader() is never used in this solution).", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.6", "fixed_version": "spring-ws-1.5.7", "fixed_files": ["org.springframework.ws.soap.axiom.AxiomSoap11MessageFactoryTest.java", "org.springframework.xml.stream.StaxStreamXmlReader.java"], "label": 1, "es_results": []}, {"bug_id": 483, "bug_title": "Wss4j 1.5.5 stripping custom SOAP headers after 1.5.6 upgrade", "bug_description": "I upgraded an existing spring-ws app from 1.5.5 to 1.5.6, and also upgraded dependencies bundled in the with-dependencies release, specifically upgraded wss4j jar from 1.5.4 to 1.5.5 and xmlsec from 1.4.0 to 1.4.2. Now wss4j 1.5.5 somehow strips out my custom SOAP headers on the client side from the request message. Both client and server use spring-ws, I am using Axiom soap message factory (payloadCaching=true), Wss4j for ws-security, running the application in Tomcat 6 with Sun Java 5 jvm. \nRolling back wss4j libs to wss4j-1.5.4.jar and xmlsec-1.4.0.jar fixes the problem (keeping the other spring-ws 1.5.6 release jars), therefore I suspect this is a Wss4j-1.5.5 bug, but other causes are possible (see other observations below).  Proposed solution: roll back the bundled Wss4j jars to wss4j 1.5.4 and xmlsec 1.4.0.  \nOther observations: \n1. Sending the SOAP request using soapUI instead of the spring-ws client fixes the problem, proving that the headers are stripped by the spring-ws client.\n2. Removing Wss4j security interceptor fixes the problem. \n3. Switching to SaajSoapMessageFactory fixes the problem.\n4. Spring-ws client trace logger logs the sent SOAP message WITH the custom soap headers intact, so the headers are stripped after the logging code is executed. \nAttached is a sample that reproduces the problem.  The sample is a slightly modified echo spring-ws sample pre-configured as an Eclipse project folder.  The echo sample was modified to use Wss4j security interceptor, Axiom Soap message factory and I added the code to add custom Soap headers.  To reproduce, import the sample into an Eclipse 3.* workspace, deploy spring-ws-echo war to a servlet container, and run org.echo.client.sws.EchoClient as Java applicatio. The logged Soap request on the client contains the \"customSoapHeader\" header element, but on the server side the same request Soap message is missing this header. ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.6", "fixed_version": "spring-ws-1.5.7", "fixed_files": ["org.springframework.ws.soap.axiom.support.AxiomUtils.java", "org.springframework.ws.soap.security.wss4j.Wss4jTestCase.java", "org.springframework.ws.soap.security.wss4j.Wss4jMessageInterceptorHeaderTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 509, "bug_title": "Namespace prefix in attribute value not resolved correctly", "bug_description": "I have following SOAP request. \n\n\n\n\n\n\n \n\n\n\n\n<soapenv:Envelope  xmlns:ns=\"http://schemas.qqq.com/wsdl/spi/profile/1.0\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n\n\n\n\n   <soapenv:Header/>\n\n\n\n\n   <soapenv:Body>\n\n\n\n\n      <ns:getRights> \n\n\n\n\n            <ns:customerCredential xsi:type=\"ns:CustomerCredentialMsisdn\">\n\n\n\n\n               <ns:msisdn>420123456789</ns:msisdn>\n\n\n\n\n            </ns:customerCredential>\n\n\n\n\n      </ns:getRights>\n\n\n\n\n   </soapenv:Body>\n\n\n\n\n</soapenv:Envelope>\n\n\n\n\n\n\nWhen umarshalling is called only the payload is passed to the unmarshaller. So DOM equivalent of following is used\n\n\n\n\n\n\n \n\n\n\n\n<ns:getRights> \n\n\n\n\n            <ns:customerCredential xsi:type=\"ns:CustomerCredentialMsisdn\">\n\n\n\n\n               <ns:msisdn>420123456789</ns:msisdn>\n\n\n\n\n            </ns:customerCredential>\n\n\n\n\n</ns:getRights>\n\n\n\n\n\n\nPlease note that namespace prefix ns is not defined. Usually this is not a problem since in DOM namespaces are already resolved. There is one exception - attribute value. When XmlBeans try to unmarshall the element, they are not able to resolve the namespace and do not work correctly. I assume that Spring-WS should somehow take this situation into account. \nIf following request is used (the only difference is position of ns prefix declaration) everything works fine\n\n\n\n\n\n\n \n\n\n\n\n<soapenv:Envelope  xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n\n\n\n\n   <soapenv:Header/>\n\n\n\n\n   <soapenv:Body>\n\n\n\n\n      <ns:getRights xmlns:ns=\"http://schemas.qqq.com/wsdl/spi/profile/1.0\"> \n\n\n\n\n            <ns:customerCredential xsi:type=\"ns:CustomerCredentialMsisdn\">\n\n\n\n\n               <ns:msisdn>420123456789</ns:msisdn>\n\n\n\n\n            </ns:customerCredential>\n\n\n\n\n      </ns:getRights>\n\n\n\n\n   </soapenv:Body>\n\n\n\n\n</soapenv:Envelope>\n\n\n\n\n\n ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.6", "fixed_version": "spring-ws-1.5.7", "fixed_files": ["org.springframework.ws.soap.axiom.AxiomSoap11MessageFactoryTest.java", "org.springframework.xml.stream.StaxStreamXmlReader.java"], "label": 1, "es_results": []}, {"bug_id": 520, "bug_title": "HTTP Accept header field contains invalid type, and omits text/xml", "bug_description": "The Spring-WS client sends an HTTP Accept  request-header field that is invalid according to the HTTP 1.1 spec.\nThe header that the Spring-WS client sends is:\n   Accept: text/html, image/gif, image/jpeg, ; q=.2, */; q=.2\nThe fourth media-range in this field does not include the mandatory \"/\" and subtype.\nThe definition of the Accept header in the HTTP 1.1 spec (http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) is:\n    Accept         = \"Accept\" \":\"\n                        #( media-range [ accept-params ] )\n       media-range    = ( \"/\"\n\n\n ( type \"/\" \"*\" )\n\n\n ( type \"/\" subtype )\n                        ) *( \";\" parameter )\n\n\nI would have also expected the Accept header field to contain \"text/xml\" explicitly (for SOAP 1.1), and not to Accept \"text/html\", \"image/gif\" or \"image/jpeg\". \nMy spring-client-context.xml is:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"http://www.springframework.org/schema/beans \nhttp://www.springframework.org/schema/beans/spring-beans.xsd\">\n  <bean id=\"messageFactory\" class=\"org.springframework.ws.soap.axiom.AxiomSoapMessageFactory\">\n    <property name=\"payloadCaching\" value=\"false\" />\n  </bean>\n  <bean id=\"webServiceTemplate\" class=\"org.springframework.ws.client.core.WebServiceTemplate\">\n    <property name=\"marshaller\" ref=\"marshaller\" />\n    <property name=\"unmarshaller\" ref=\"marshaller\" />\n    <property name=\"defaultUri\" value=\"http://localhost:8079/jibx-ws-seismic/soap/quake-service\" />\n    <property name=\"messageFactory\" ref=\"messageFactory\"/>\n  </bean>\n  <!-- A JiBX-based payload marshaller/unmarshaller.  -->\n  <bean id=\"marshaller\" class=\"org.springframework.oxm.jibx.JibxMarshaller\">\n    <property name=\"targetClass\" value=\"com.sosnoski.seismic.common.Query\" />\n  </bean>\n</beans>", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.7", "fixed_version": "spring-ws-1.5.8", "fixed_files": ["org.springframework.ws.soap.soap12.AbstractSoap12MessageTestCase.java", "org.springframework.ws.soap.soap11.AbstractSoap11MessageTestCase.java", "org.springframework.ws.transport.TransportConstants.java", "org.springframework.ws.soap.axiom.AxiomSoapMessage.java", "org.springframework.ws.soap.saaj.SaajSoapMessage.java"], "label": 1, "es_results": []}, {"bug_id": 550, "bug_title": "Jaxb2Marshaller.createJaxbContext() does not respect provided classloader when checking JAXB version", "bug_description": "Jaxb2Marshaller.createJaxbContext() checks the JAXB version using JaxbUtils\n        if (JaxbUtils.getJaxbVersion() < JaxbUtils.JAXB_2) \n{\n            throw new IllegalStateException(\n                    \"Cannot use Jaxb2Marshaller in combination with JAXB 1.0. Use Jaxb1Marshaller instead.\");\n        }\n\nBut this is incorrect because JaxbUtils is checking the version by seeing if it can load javax.xml.bind.Binder using the ClassUtils&apos; getDefaultClassLoader. Instead it should use the supplied classloader set via setBeanClassLoader in Jaxb2Marshaller.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.7", "fixed_version": "spring-ws-1.5.8", "fixed_files": ["org.springframework.oxm.jaxb.Jaxb2Marshaller.java", "org.springframework.oxm.jaxb.JaxbUtils.java"], "label": 1, "es_results": []}, {"bug_id": 517, "bug_title": "Soap response validation errors after update to 1.5.7", "bug_description": "Upgrade from SpringWS 1.5.6 to 1.5.7 and update.  - No code changes. \nAfter upgrade error \"java.lang.ArrayIndexOutOfBoundsException: -1\" was thrown during validation. Turning validation off works as a workaround.\nmy Soap API has 130 calls. Most respones were working fine, not all were tested. I wonder if It might have something to do with the size of the response, all other tested responses were pretty small,  see forum post for bean configurations, errors and response sample.\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.7", "fixed_version": "spring-ws-1.5.8", "fixed_files": ["org.springframework.xml.namespace.SimpleNamespaceContextTest.java", "org.springframework.xml.namespace.SimpleNamespaceContext.java", "org.springframework.xml.stream.StaxStreamXmlReader.java", "org.springframework.ws.soap.server.endpoint.interceptor.PayloadValidatingInterceptorTest.java"], "label": 1, "es_results": []}, {"bug_id": 571, "bug_title": "Illegal SoapAction header: \"", "bug_description": "It seems that spring ws generates an illegal soapaction if no explicit soapaction is provided: an unmatched double quote. \nA quick look at the SoapUtils class shows the problem:\n\n\n\n\n\n\n public static String escapeAction(String soapAction) {\n\n\n\n\n        if (soapAction == null) {\n\n\n\n\n            soapAction = \"\";\n\n\n\n\n        }\n\n\n\n\n        if (!soapAction.startsWith(\"\\\"\")) {\n\n\n\n\n            soapAction = \"\\\"\" + soapAction;\n\n\n\n\n        }\n\n\n\n\n        if (!soapAction.endsWith(\"\\\"\")) {\n\n\n\n\n            soapAction = soapAction + \"\\\"\";\n\n\n\n\n        }\n\n\n\n\n        return soapAction;\n\n\n\n\n    }\n\n\n\n\n\n\nIf you pass null as argument, it will return \" instead of \"\"", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.8", "fixed_version": "spring-ws-1.5.9", "fixed_files": ["org.springframework.ws.soap.support.SoapUtilsTest.java", "org.springframework.ws.soap.support.SoapUtils.java"], "label": 1, "es_results": []}, {"bug_id": 566, "bug_title": "DelegatingSoapEndpointMapping produce NPE", "bug_description": "\n\n\n\n\n\n    public EndpointInvocationChain getEndpoint(MessageContext messageContext) throws Exception {\n\n\n\n\n        EndpointInvocationChain delegateChain = delegate.getEndpoint(messageContext);\n\n\n\n\n        return new SoapEndpointInvocationChain(delegateChain.getEndpoint(), delegateChain.getInterceptors(),\n\n\n\n\n                actorsOrRoles, isUltimateReceiver);\n\n\n\n\n    }\n\n\n\n\n\n\ndelegate.getEndpoint() can return null ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.8", "fixed_version": "spring-ws-1.5.9", "fixed_files": ["org.springframework.ws.soap.server.endpoint.mapping.DelegatingSoapEndpointMapping.java"], "label": 1, "es_results": []}, {"bug_id": 579, "bug_title": "AxiomSoapMessageFactory does not parse application/xop+xml Content-Type properly", "bug_description": "AxiomSoapMessageFactory#getCharSetEncoding(), when given the following HTTP Content-Type header (which I assume is valid),\napplication/xop+xml;type=\"text/xml; charset=utf-8\"\nreturns a CharSet of &apos;utf-8\"&apos; instead of &apos;utf-8&apos; (i.e. there is an erroneous double quote at the end of the string).", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.8", "fixed_version": "spring-ws-1.5.9", "fixed_files": ["org.springframework.ws.soap.axiom.AxiomSoap11MessageFactoryTest.java", "org.springframework.ws.soap.axiom.AxiomSoapMessageFactory.java"], "label": 1, "es_results": []}, {"bug_id": 572, "bug_title": "The default encoding is not set to UTF-8 for JibxMarshaller", "bug_description": "In the class \"org.springframework.oxm.jibx.JibxMarshaller\" the default encoding is not set to UTF-8 as specified in the Java-Doc of the method &apos;setEncoding()&apos;.\nTherefore, when we marshal an object with \"org.springframework.oxm.jibx.JibxMarshaller\", the output XML does not contain the encoding attribute:\n<?xml version=\"1.0\"?>\ninstead of\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.8", "fixed_version": "spring-ws-1.5.9", "fixed_files": ["org.springframework.oxm.jibx.JibxMarshaller.java"], "label": 1, "es_results": []}, {"bug_id": 575, "bug_title": "CommonsXsdSchemaCollection: Combination of xs:includes and xs:imports in a schema result in incorrect/overcomplete schema in wsdl generated by DefaultWsdl11Definition", "bug_description": "When using a DefaultWsdl11Definition for wsdl generation I used a CommonsXsdSchemaCollection to combine a set of xsd&apos;s. I found out that when a schema uses a mix of xs:imports and xs:includes, the inline schema in the generated wsdl (inside <wsdl:types>) contains an error. Both xs:imports and xs:includes are &apos;expanded&apos; inline in the generated wsdl, but the xs:include lines are not removed from the inline schema, causing test tools like SOAPUI to fail (included schema&apos;s cannot be retrieved).", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.8", "fixed_version": "spring-ws-1.5.9", "fixed_files": ["org.springframework.xml.xsd.commons.CommonsXsdSchemaCollection.java", "org.springframework.xml.xsd.commons.CommonsXsdSchemaCollectionTest.java"], "label": 1, "es_results": []}, {"bug_id": 594, "bug_title": "SchemaCollection issue when XSD files are in the classpath, in different JAR artifacts", "bug_description": "Problem described in issue SWS-413 has partially been fixed.\nGiven XSD-A importing XSD-B, both in the classpath, the fix works if XSD-A and XSD-B are in the same classpath location (both in WEB-INF/classes, or in the same JAR file), but it does not work if the XSD files are located in different JAR files, for example.\nThe provided patch fixes this : if the imported XSD could not be resolved with the same base URI, we must keep searching in the classpath, (last statements should not be in an else block).", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.8", "fixed_version": "spring-ws-1.5.9", "fixed_files": ["org.springframework.xml.xsd.commons.CommonsXsdSchemaCollection.java"], "label": 1, "es_results": []}, {"bug_id": 595, "bug_title": "SoapUtils.setActionInContentType incorrectly replaces existing actions", "bug_description": "If a SOAP action already exists, the new action is set without the leading \"action=\".", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.8", "fixed_version": "spring-ws-1.5.9", "fixed_files": ["org.springframework.ws.soap.support.SoapUtilsTest.java", "org.springframework.ws.soap.support.SoapUtils.java"], "label": 1, "es_results": []}, {"bug_id": 640, "bug_title": "evaluateAsBoolean returns true for node with text content \"false\"", "bug_description": "The method Jaxp13XPathTemplate.evaluateAsBoolean returns true if the element selected by the expression exists, regardless of its contents. The text contents can be empty, \"false\", or \"WTF\", and evaluateAsBoolean will return true. \nThis does not appear to match its Javadoc, which says: \"Evaluates the given expression as a boolean. Returns the boolean evaluation of the expression, or false if it is invalid.\" The very similar method evaluateAsDouble has nearly identical Javadoc: \"Evaluates the given expression as a double. Returns the evaluation of the expression, or Double.NaN if it is invalid.\" - but evaluateAsDouble returns the actual contents of the text node. If evaluateAsBoolean is really meant to mean, \"doesExpressionSelectAnything\", it should be renamed.\nBelow is a unit test that demonstrates the problem. The second assert fails.\nThe problem also occurs when using a WSDL which defines aFlag as type \"xs:boolean\". And, it also occurs with JaxenXPathTemplate. However, I have not seen it using sources other than DOMSource.\n\n\n\n\n\n\npackage com.yodle.misc;\n\n\n\n\n\n\n\n\n\nimport static org.junit.Assert.*;\n\n\n\n\n\n\n\n\n\nimport javax.xml.transform.dom.DOMSource;\n\n\n\n\n\n\n\n\n\nimport org.junit.Test;\n\n\n\n\nimport org.springframework.ws.server.endpoint.AbstractDomPayloadEndpoint;\n\n\n\n\nimport org.springframework.xml.transform.StringSource;\n\n\n\n\nimport org.springframework.xml.xpath.Jaxp13XPathTemplate;\n\n\n\n\nimport org.w3c.dom.Document;\n\n\n\n\nimport org.w3c.dom.Element;\n\n\n\n\n\n\n\n\n\npublic class BugDemo {\n\n\n\n\n\n\n\n\n\n\tfinal String request =\n\n\n\n\n\t\t\"<someRequest> \" +\t\t\n\n\n\n\n\t\t\"\t<aDouble>123</aDouble> \" +\n\n\n\n\n\t\t\"\t<aFlag>false</aFlag> \" +\n\n\n\n\n\t\t\"</someRequest> \";\n\n\n\n\n\t\n\n\n\n\n\tprivate class Endpoint extends AbstractDomPayloadEndpoint {\n\n\n\n\n\n\n\n\n\n\t\t@Override\n\n\n\n\n\t\tprotected Element invokeInternal(Element requestElement, Document responseDocument) throws Exception {\n\n\n\n\n\t\t\tJaxp13XPathTemplate xPathTemplate = new Jaxp13XPathTemplate();\n\n\n\n\n\t\t\tDOMSource src = new DOMSource(requestElement);\n\n\n\n\n\t\t\t\n\n\n\n\n\t\t\tdouble aDouble = xPathTemplate.evaluateAsDouble(\"aDouble\", src);\n\n\n\n\n\t\t\tassertEquals(123d, aDouble, 0.01);\n\n\n\n\n\t\t\t\n\n\n\n\n\t\t\tboolean aFlag = xPathTemplate.evaluateAsBoolean(\"aFlag\", src);\n\n\n\n\n\t\t\tassertFalse(aFlag);\n\n\n\n\n\t\t\t\n\n\n\n\n\t\t\treturn null;\n\n\n\n\n\t\t}\n\n\n\n\n\t\t\n\n\n\n\n\t};\n\n\n\n\n\t\n\n\n\n\n\t@Test\n\n\n\n\n\tpublic void demonstrateEvaluateAsBooleanStrangeBehavior() throws Exception {\n\n\n\n\n\t\tEndpoint endPoint = new Endpoint();\n\n\n\n\n\t\tendPoint.invoke(new StringSource(request));\n\n\n\n\n\t}\n\n\n\n\n\t\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.8", "fixed_version": "spring-ws-2.0.0-RC1", "fixed_files": ["org.springframework.xml.xpath.XPathOperations.java", "org.springframework.xml.xpath.XPathExpression.java"], "label": 1, "es_results": []}, {"bug_id": 750, "bug_title": "SaajSoapMessageFactory's checkForUtf8ByteOrderMark is corrupting input stream", "bug_description": "There appears to be a bug in the implementation of \"checkForUtf8ByteOrderMark\" in org.springframework.ws.soap.saaj.SaajSoapMessageFactory.\nUnder certain circumstances, the call to pushbackInputStream.read(bom) will read less than the required 3 bytes into bom. Then, since the byte order mark isn&apos;t found, unread(bom) is called which results in some invalid bytes being added to the stream.\nThe contract for PushbackInputStream.read(byte[] b, int off, int len) says \"Reads up to len bytes of data.\" In our case, using Tomcat (versions 6 and 7) with recent releases of Chrome and IE, the call to inputstream.available() in BufferedInputStream&apos;s implementation of read returns 0. This is because no more data can be read without blocking. It seems to be just an unfortunate coincidence caused by the size of the header sent by the newest version of chrome and IE. The end result is that our soap envelope is corrupted and our system is unusable.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.8", "fixed_version": "spring-ws-2.0.4.RELEASE", "fixed_files": ["org.springframework.ws.soap.saaj.SaajSoapMessageFactory.java"], "label": 1, "es_results": []}, {"bug_id": 613, "bug_title": "Jaxp13XPathTemplate uses thread-unsafe XPathFactory as field", "bug_description": "The XPathFactory provided by Sun in the JDK mentions it&apos;s not threadsafe, see: http://java.sun.com/javase/6/docs/api/javax/xml/xpath/XPathFactory.html. Though it is not clear from documentation nor code which of the methods is not threadsafe. It can either be:\na) The XPathFactory.newInstance(...) method: In which case Jaxp13XPathTemplate should clearly document that it should only be constructed once for an entire application to prvent concurrency bugs\nb) Any of the other instance methods: In which case Jaxp13XPathTemplate should not use XPathFactory as a field if it wants to be threadsafe.\nThis means that at the moment the Jaxp13XPathTemplate deviates from other Spring templates, such as JdbcTemplate etc, as these are all threadsafe.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.9", "fixed_version": "spring-ws-2.0.0-M2", "fixed_files": ["org.springframework.xml.xpath.Jaxp13XPathTemplate.java", "org.springframework.ws.server.endpoint.adapter.XPathParamAnnotationMethodEndpointAdapter.java", "org.springframework.xml.xpath.Jaxp13XPathExpressionFactory.java"], "label": 1, "es_results": []}, {"bug_id": 819, "bug_title": "SimpleNamespaceContext.removeBinding() does not clean up all references", "bug_description": "In SimpleNamespaceContext.removeBinding() the first line should be changed to \nString namespaceUri = prefixToNamespaceUri.remove(prefix);\nOtherwise the internal map prefixToNamespaceUri still contains the prefix, and hasBinding(String prefix) behaves incorrectly.\nThis is error is critical, as under certain circumstances XML schema validation fails. If necessary I can provide an example. ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-1.5.9", "fixed_version": "spring-ws-2.1.3.RELEASE", "fixed_files": ["org.springframework.xml.namespace.SimpleNamespaceContext.java"], "label": 1, "es_results": []}, {"bug_id": 733, "bug_title": "Typo in marshalSendAndReceive javadoc", "bug_description": "Javadoc for marshalSendAndReceive (one that uses default URI) was\nThis will only work with a default specified!\nshould be\nThis will only work with a default uri specified!", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.2.RELEASE", "fixed_version": "spring-ws-2.0.3.RELEASE", "fixed_files": ["org.springframework.ws.client.core.WebServiceOperations.java"], "label": 1, "es_results": []}, {"bug_id": 709, "bug_title": "JavaDoc for WebServiceTemplate#setFaultMessageResolver has wrong default class", "bug_description": "The JavaDoc for WebServiceTemplate#setFaultMessageResolver claims that SimpleFaultMessageResolver is the default, whereas it&apos;s actually SoapFaultMessageResolver as listed in WebServiceTemplate.properties. ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.2.RELEASE", "fixed_version": "spring-ws-2.0.3.RELEASE", "fixed_files": ["org.springframework.ws.client.core.WebServiceTemplate.java"], "label": 1, "es_results": []}, {"bug_id": 724, "bug_title": "DefaultConcretePartProvider is not allowing a blank suffix, due to improper assertion", "bug_description": "The allowance for a blank (\"\") suffix is esential to be able to maintain compatability w/ legacy or handwritten WSDLs.\nshould read as:\n    /** Sets the suffix to append to the port type name to obtain the binding name. */\n    public void setBindingSuffix(String bindingSuffix) \n{\n        Assert.notNull(bindingSuffix, \"&apos;bindingSuffix&apos; must not be null\");\n        this.bindingSuffix = bindingSuffix;\n    }\n\ncurrently as:\n  public void setBindingSuffix(String bindingSuffix)\n  {\n    Assert.hasText(bindingSuffix, \"&apos;bindingSuffix&apos; must not be null\");\n    this.bindingSuffix = bindingSuffix;\n  }\n\n\npatch forthcomming....", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.2.RELEASE", "fixed_version": "spring-ws-2.0.3.RELEASE", "fixed_files": ["org.springframework.ws.wsdl.wsdl11.provider.DefaultConcretePartProvider.java"], "label": 1, "es_results": []}, {"bug_id": 713, "bug_title": "Order of interceptor calls is dependent on the way the interceptors are included", "bug_description": "The InterceptorsBeanDefinitionParser scans for interceptors in the following order: first \"bean\", then \"ref\", and so on. I.e. the order in which the interceptors are called is dependent on the way the interceptors are included.\nOne would expect that the interceptors are called in the order in which they were specified, so that changing a \"bean\" to a \"ref\" does not modify the calling order.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.2.RELEASE", "fixed_version": "spring-ws-2.0.3.RELEASE", "fixed_files": ["org.springframework.ws.config.InterceptorsBeanDefinitionParserTest.java", "org.springframework.ws.server.endpoint.interceptor.DelegatingSmartEndpointInterceptor.java", "org.springframework.ws.config.InterceptorsBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 737, "bug_title": "EndpointInterceptorAdapter removes \"throws Exception\" from handleFault() method defined by EndpointInterceptor", "bug_description": "EndpointInterceptor defines handleFault as follows:\nboolean handleFault(MessageContext messageContext, Object endpoint) throws Exception;\nEndpointInterceptorAdapter provides a default implementation like this (notice the missing \"throws Exception\"):\npublic boolean handleFault(MessageContext messageContext, Object endpoint) {\n    return true;\n}\nAs a result subclasses of EndpointInterceptorAdapter can no longer throw exceptions from handleFault()", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.2.RELEASE", "fixed_version": "spring-ws-2.0.3.RELEASE", "fixed_files": ["org.springframework.ws.server.endpoint.interceptor.EndpointInterceptorAdapter.java"], "label": 1, "es_results": []}, {"bug_id": 718, "bug_title": "Reloading the spring context does not refresh the MessageDispatcherServlet", "bug_description": "Our application uses a special classloader from which it can load beans dynamically. The applicationcontext is reloaded to do this. The normal DispatcherServlet has a mechanism to allow the applicationcontext to be reloaded by overriding the onRefresh method. The MessageDispatcherServlet does not do this and crashes occur when webservices are invoked. \nThe class below can be used as a workaround.\n\n\n\n\n\n\npublic class FixedMessageDispatcherServlet\n\n\n\n\n\textends MessageDispatcherServlet\n\n\n\n\n{\n\n\n\n\n\n\n\n\n\n\tprivate boolean initializing = true;\n\n\n\n\n\n\n\n\n\n\t@Override\n\n\n\n\n\tprotected void onRefresh(ApplicationContext context)\n\n\n\n\n\t{\n\n\n\n\n\t\ttry {\n\n\n\n\n\t\t\tif (this.initializing) {\n\n\n\n\n\t\t\t\tthis.initializing = false;\n\n\n\n\n\t\t\t} else {\n\n\n\n\n\t\t\t\tthis.initFrameworkServlet();\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t} catch (Exception e) {\n\n\n\n\n\t\t\tthrow new RuntimeException(e);\n\n\n\n\n\t\t}\n\n\n\n\n\t}\n\n\n\n\n}\n\n\n\n\n\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.2.RELEASE", "fixed_version": "spring-ws-2.0.3.RELEASE", "fixed_files": ["org.springframework.ws.transport.http.MessageDispatcherServlet.java"], "label": 1, "es_results": []}, {"bug_id": 742, "bug_title": "JMSCorrelationID together with Oracle AQ", "bug_description": "In org.springframework.ws.transport.jms.JmsSenderConnection.onReceiveBeforeRead() the following code set the value of messageSelector:\n\n\n\n\n\n\nif (responseDestination instanceof TemporaryQueue || responseDestination instanceof TemporaryTopic) {\n\n\n\n\n       messageConsumer = session.createConsumer(responseDestination);\n\n\n\n\n} else {\n\n\n\n\n       String messageId = requestMessage.getJMSMessageID().replaceAll(\"&apos;\", \"&apos;&apos;\");\n\n\n\n\n       String messageSelector = \"JMSCorrelationID = &apos;\" + messageId + \"&apos;\";\n\n\n\n\n       messageConsumer = session.createConsumer(responseDestination, messageSelector);\n\n\n\n\n}\n\n\n\n\n\n\nIf  I&apos;m using Oracle AQ, expression (responseDestination instanceof TemporaryQueue) always returns true (See Oracle Streams Advanced Queuing Java API Reference http://docs.oracle.com/cd/B19306_01/server.102/b14291/oracle/jms/AQjmsDestination.html). Regarding this it is impossible to use JMSCorrelationID together with Oracle AQ. ", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.3.RELEASE", "fixed_version": "spring-ws-2.0.4.RELEASE", "fixed_files": ["org.springframework.ws.transport.jms.JmsSenderConnection.java", "org.springframework.ws.transport.jms.JmsMessageSenderIntegrationTest.java"], "label": 1, "es_results": []}, {"bug_id": 748, "bug_title": "Not well formed xml causes server 500 error", "bug_description": "In 2.0.3 and likely previous versions, parsing a not well formed xml causes http 500 instead of a client error, e.g bad request.\n\tcom.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(Unknown Source)\n\tcom.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(Unknown Source)\n\tcom.sun.xml.internal.messaging.saaj.util.transform.EfficientStreamingTransformer.transform(Unknown Source)\n\tcom.sun.xml.internal.messaging.saaj.soap.EnvelopeFactory.createEnvelope(Unknown Source)\n\tcom.sun.xml.internal.messaging.saaj.soap.ver1_1.SOAPPart1_1Impl.createEnvelopeFromSource(Unknown Source)\n\tcom.sun.xml.internal.messaging.saaj.soap.SOAPPartImpl.getEnvelope(Unknown Source)\n\torg.springframework.ws.soap.saaj.support.SaajUtils.getSaajVersion(SaajUtils.java:155)\n\torg.springframework.ws.soap.saaj.SaajSoapMessage.getSaajVersion(SaajSoapMessage.java:257)\n\torg.springframework.ws.soap.saaj.SaajSoapMessage.getImplementation(SaajSoapMessage.java:342)\n\torg.springframework.ws.soap.saaj.SaajSoapMessage.<init>(SaajSoapMessage.java:117)\n\torg.springframework.ws.soap.saaj.SaajSoapMessageFactory.createWebServiceMessage(SaajSoapMessageFactory.java:184)\n\torg.springframework.ws.soap.saaj.SaajSoapMessageFactory.createWebServiceMessage(SaajSoapMessageFactory.java:58)\n\torg.springframework.ws.transport.AbstractWebServiceConnection.receive(AbstractWebServiceConnection.java:90)\n\torg.springframework.ws.transport.support.WebServiceMessageReceiverObjectSupport.handleConnection(WebServiceMessageReceiverObjectSupport.java:86)\n\torg.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.handle(WebServiceMessageReceiverHandlerAdapter.java:57)\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.3.RELEASE", "fixed_version": "spring-ws-2.0.4.RELEASE", "fixed_files": ["org.springframework.ws.soap.axiom.AxiomSoap12MessageFactoryTest.java", "org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapterTest.java", "org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.java", "org.springframework.ws.soap.saaj.SaajSoapMessageFactory.java", "org.springframework.ws.soap.AbstractSoapMessageFactoryTestCase.java", "org.springframework.ws.WebServiceMessageFactory.java", "org.springframework.ws.soap.soap11.AbstractSoap11MessageFactoryTestCase.java", "org.springframework.ws.soap.soap12.AbstractSoap12MessageFactoryTestCase.java", "org.springframework.ws.soap.axiom.AxiomSoap11MessageFactoryTest.java"], "label": 1, "es_results": []}, {"bug_id": 754, "bug_title": "EndpointInterceptor.afterCompletion is not always invoked", "bug_description": "afterCompletion&apos;s javadoc states that it will be called on any outcome of endpoint invocation, allowing for proper resource cleanup. There is however a case where handleRequest() successfully completes, but afterCompletion() is never invoked. This happens whenever an exception occurs and no EndpointExceptionResolver is able to resolve the exception.\n\n\n\n\n\n\nMessageDispatcher.java\n\n\n\n\n\n\n// within dispatch()&apos;s last catch block\n\n\n\n\ncatch (Exception ex) {\n\n\n\n\n  Object endpoint = mappedEndpoint != null ? mappedEndpoint.getEndpoint() : null;\n\n\n\n\n  processEndpointException(messageContext, endpoint, ex); // exception is rethrown here..\n\n\n\n\n  triggerHandleResponse(mappedEndpoint, interceptorIndex, messageContext);\n\n\n\n\n  triggerAfterCompletion(mappedEndpoint, interceptorIndex, messageContext, ex); // .. and afterCompletion() is never invoked\n\n\n\n\n}\n\n\n\n\n\n\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.4.RELEASE", "fixed_version": "spring-ws-2.0.5.RELEASE", "fixed_files": ["org.springframework.ws.server.MessageDispatcherTest.java", "org.springframework.ws.server.MessageDispatcher.java"], "label": 1, "es_results": []}, {"bug_id": 787, "bug_title": "MethodEndpoint.getBean is inconsistent with its API", "bug_description": "The API description of MethodEndpoint.getBean says \"Returns the object bean for this method endpoint.\" But if the constructor with a BeanFactory argument is used, it actually returns the bean name (String) instead of the actual bean! \nYou might correct the documentation, but I&apos;d much prefer if you fix the implementation to do as the documentation says, since currently you need to get hold of the BeanFactory as well to get to the endpoint object, and the MethodEndpoint does not provide it.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.0.4.RELEASE", "fixed_version": "spring-ws-2.1.1.RELEASE", "fixed_files": ["org.springframework.ws.server.endpoint.MethodEndpoint.java", "org.springframework.ws.server.endpoint.MethodEndpointTest.java"], "label": 1, "es_results": []}, {"bug_id": 777, "bug_title": "SoapFaultMappingExceptionResolver not handling exception", "bug_description": "Given the following configuration:\n\n\n\n\n\n\n    <bean class=\"org.springframework.ws.soap.server.endpoint.SoapFaultMappingExceptionResolver\">\n\n\n\n\n        <property name=\"exceptionMappings\">\n\n\n\n\n            <value>\n\n\n\n\n                org.springframework.dao.EmptyResultDataAccessException=CLIENT,Entity not found\n\n\n\n\n            </value>\n\n\n\n\n        </property>\n\n\n\n\n        <property name=\"defaultFault\" value=\"SERVER\"/>\n\n\n\n\n    </bean>\n\n\n\n\n\n\nThe result in 2.0.5 is correct:\n\n\n\n\n\n\n<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\">\n\n\n\n\n        <SOAP-ENV:Header/>\n\n\n\n\n        <SOAP-ENV:Body>\n\n\n\n\n            <SOAP-ENV:Fault>\n\n\n\n\n                <faultcode>SOAP-ENV:Client</faultcode>\n\n\n\n\n                <faultstring xml:lang=\"en\">Entity not found</faultstring>\n\n\n\n\n            </SOAP-ENV:Fault>\n\n\n\n\n        </SOAP-ENV:Body>\n\n\n\n\n    </SOAP-ENV:Envelope>\n\n\n\n\n\n\nThe result in 2.1.0.RC1 is INCORRECT:\n\n\n\n\n\n\n<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\">\n\n\n\n\n    <SOAP-ENV:Header/>\n\n\n\n\n    <SOAP-ENV:Body>\n\n\n\n\n        <SOAP-ENV:Fault>\n\n\n\n\n            <faultcode>SOAP-ENV:Server</faultcode>\n\n\n\n\n            <faultstring xml:lang=\"en\">Incorrect result size: expected 1, actual 0</faultstring>\n\n\n\n\n        </SOAP-ENV:Fault>\n\n\n\n\n    </SOAP-ENV:Body>\n\n\n\n\n</SOAP-ENV:Envelope>\n\n\n\n\n\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.1.0.RC1", "fixed_version": "spring-ws-2.1.0.RELEASE", "fixed_files": ["org.springframework.ws.config.AnnotationDrivenBeanDefinitionParser.java"], "label": 1, "es_results": []}, {"bug_id": 797, "bug_title": "XsdSchemaHandlerAdapter does not transform schema locations", "bug_description": "This is on an existing issue that was marked resolved.\nThe issue number is SWS-791.\nI have modified the issue but didn&apos;t know how to reopen it so I am opening this new one referring to SWS-791.\nSorry for that.\nThanks,", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.1.0.RELEASE", "fixed_version": "spring-ws-2.1.2.RELEASE", "fixed_files": ["org.springframework.ws.transport.http.MessageDispatcherServlet.java", "org.springframework.ws.transport.http.WsdlDefinitionHandlerAdapter.java", "org.springframework.ws.transport.http.XsdSchemaHandlerAdapter.java", "org.springframework.ws.transport.http.XsdSchemaHandlerAdapterTest.java"], "label": 1, "es_results": []}, {"bug_id": 804, "bug_title": "WebServiceMessageReceiverHandlerAdapter not easily overridable to produce SOAP faults", "bug_description": "WebServiceMessageReceiverHandlerAdapter has been changed recently to catch InvalidXmlException and return a HTTP 400 status code. We would like to instead return a SOAP fault with a detailed message of the parse error (I&apos;m not certain but returning 400 is probably against the SOAP spec). This is impossible with the new implementation of WebServiceMessageReceiverHandlerAdapter without re-implementing the handle(...) method. \nCould the handling of this exception (and probably the non-POST transport method) be done by a separate protected method such that it can be overridden?", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.1.0.RELEASE", "fixed_version": "spring-ws-2.1.2.RELEASE", "fixed_files": ["org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.java"], "label": 1, "es_results": []}, {"bug_id": 815, "bug_title": "Error loading SAML properties file", "bug_description": "Wss4j is unable to load the properties file when it is given an absolute path. Wss4j is using the ClassLoader to load the properties file. See http://grepcode.com/file/repository.springsource.com/org.apache.ws/com.springsource.org.apache.ws.security/1.6.5/org/apache/ws/security/saml/SAMLIssuerFactory.java#SAMLIssuerFactory.getProperties%28java.lang.String%29 for how the saml properties file gets loaded by Wss4j.", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.1.2.RELEASE", "fixed_version": "spring-ws-2.1.3.RELEASE", "fixed_files": ["org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 888, "bug_title": "HttpComponentsMessageSender does not set correctly the maximum connections per host for https connection", "bug_description": "The following piece of code is used to set the maximum number of connection by route in the method \"setMaxConnectionsPerHost\":\nHttpHost host = new HttpHost(uri.getHost(), uri.getPort(), uri.getScheme());\nHttpRoute route = new HttpRoute(host);\nThis works well for http host but it does not work for https because the route will not be set as \"secure\".  The following patch seems to work to correct this issue:\nif (uri.getScheme().equals(\"https\")) {\n     httpRoute = new HttpRoute(httpHost, null, true); \n} else {\n    httpRoute = new HttpRoute(httpHost);\n}\n", "project": "Spring", "sub_project": "SWS", "version": "spring-ws-2.1.2.RELEASE", "fixed_version": "v2.2.1.RELEASE", "fixed_files": ["org.springframework.ws.transport.http.HttpComponentsMessageSender.java", "org.springframework.ws.transport.http.HttpComponentsMessageSenderIntegrationTest.java"], "label": 1, "es_results": []}, {"bug_id": 924, "bug_title": "Mime header : Multiple keys with same value", "bug_description": "Hi,\nI have an HTTP Response with in the header multiple values for the same key:\n\ncookie : value1\ncookie : value2\n\nWhen I called the function to have the MimeHeaders, I have this:\n\ncookie : value2\ncookie : value2\n\nAbout the code:\nSaajSoapMessageFactory use parseMimeHeaders to get header from HTTP Response. Behind this you called http://docs.oracle.com/javase/7/docs/api/java/net/URLConnection.html#getHeaderField(java.lang.String) , this function returned only the last value.\nThanks,\n", "project": "Spring", "sub_project": "SWS", "version": "v2.2.1.RELEASE", "fixed_version": "v2.2.3.RELEASE", "fixed_files": ["org.springframework.ws.transport.http.HttpUrlConnection.java"], "label": 1, "es_results": []}, {"bug_id": 929, "bug_title": "Fix namespace prefix handling with StreamingPayload", "bug_description": "The getName() method in JaxbStreamingPayload doesn&apos;t report the actual\nnamespace prefix that is later generated by the writeTo method. With\nAxiom 1.2.13 that didn&apos;t because problems, but 1.2.14 is less lenient,\ncausing an error as described in AXIOM-463.\nThis change:\n\nUpdates the StreamingPayload documentation to specify that the\nnamespace prefix in the QName returned by getName() has no significance\n(which is effectively how things are currently).\nUpdates AxiomSoapBody so that it Axiom is aware that the namespace\nprefix of the created OMSourcedElement is unknown.\nModifies the unit test for setStreamingPayload so that it uses a\nStreamingPayload with a prefix mismatch.\n\n", "project": "Spring", "sub_project": "SWS", "version": "v2.2.3.RELEASE", "fixed_version": "v2.2.4.RELEASE", "fixed_files": ["org.springframework.ws.soap.axiom.AxiomSoapBody.java", "org.springframework.ws.stream.StreamingPayload.java", "org.springframework.ws.soap.AbstractSoapMessageTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 950, "bug_title": "getResponseHeaders() is case sensitive", "bug_description": "In org.springframework.ws.transport.http.HttpUrlConnection we find the following code:\n\n\n\n\n\n\n@Override\n\n\n\n\n\tpublic Iterator<String> getResponseHeaders(String name) throws IOException {\n\n\n\n\n\t\tMap<String, List<String>> mapHeader = connection.getHeaderFields();\n\n\n\n\n\t\tList<String> listHeaderValues = mapHeader.get(name);\n\n\n\n\n\t\tif (listHeaderValues == null) {\n\n\n\n\n\t\t    return Collections.<String>emptyList().iterator();\n\n\n\n\n\t\t} else {\n\n\n\n\n\t\t    return listHeaderValues.iterator();\n\n\n\n\n\t\t}\n\n\n\n\n\t}\n\n\n\n\n\n\nThis code returns an Iterator containing the HTTP-Header(s) that matches the parameter \"name\" . The problem is that this is case sensitive. According to the RFC HTTP-Headers are case-insensitive", "project": "Spring", "sub_project": "SWS", "version": "v2.2.3.RELEASE", "fixed_version": "v2.3.0.RELEASE", "fixed_files": ["org.springframework.ws.transport.http.HttpUrlConnection.java", "org.springframework.ws.transport.http.AbstractHttpWebServiceMessageSenderIntegrationTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 932, "bug_title": "Not enough namespace context during XSD validation when using AxiomSoapMessageFactory", "bug_description": "XSD request validation using AxiomSoapMessageFactory and PayloadValidatingInterceptor fails with an UndeclaredPrefix validation error, because Axiom does not have full access to the namespace declarations made on the SOAP Envelope level.\nAs suggested in http://stackoverflow.com/questions/34633662/xsd-validation-fails-with-undeclaredprefix-when-using-axiomsoapmessagefactory-in, a possible fix is to use OMContainer#getXMLStreamReader(boolean, OMXMLStreamReaderConfiguration) and set the preserveNamespaceContext property to true in the OMXMLStreamReaderConfiguration object (in CachingPayload#getStreamReader(OMElement)).\nI tested this, and it fixes the problem. Patch is attached, as well as a small sample project exposing the erroneous behaviour.\nRequest that fails:\n\n\n\n\n\n\n<soapenv:Envelope xmlns:sch=\"http://example.com/springws/extension/schema\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" >\n\n\n\n\n   <soapenv:Header/>\n\n\n\n\n   <soapenv:Body>\n\n\n\n\n      <sch:formatRequest >\n\n\n\n\n         <sch:value xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"sch:dateType\">\n\n\n\n\n           <sch:day>1</sch:day>\n\n\n\n\n           <sch:month>1</sch:month>\n\n\n\n\n           <sch:year>2000</sch:year>\n\n\n\n\n         </sch:value>\n\n\n\n\n      </sch:formatRequest>\n\n\n\n\n   </soapenv:Body>\n\n\n\n\n</soapenv:Envelope>\n\n\n\n\n\n\nResponse is  a SOAP fault with detail\n\n\n\n\n\n\n<detail>\n\n\n\n\n    <spring-ws:ValidationError xmlns:spring-ws=\"http://springframework.org/spring-ws\">UndeclaredPrefix: Cannot resolve &apos;sch:dateType&apos; as a QName: the prefix &apos;sch&apos; is not declared.</spring-ws:ValidationError>\n\n\n\n\n    <spring-ws:ValidationError xmlns:spring-ws=\"http://springframework.org/spring-ws\">cvc-elt.4.1: The value &apos;sch:dateType&apos; of attribute &apos;http://www.w3.org/2001/XMLSchema-instance,type&apos; of element &apos;sch:value&apos; is not a valid QName.</spring-ws:ValidationError>\n\n\n\n\n    <spring-ws:ValidationError xmlns:spring-ws=\"http://springframework.org/spring-ws\">cvc-type.2: The type definition cannot be abstract for element sch:value.</spring-ws:ValidationError>\n\n\n\n\n    <spring-ws:ValidationError xmlns:spring-ws=\"http://springframework.org/spring-ws\">UndeclaredPrefix: Cannot resolve &apos;sch:dateType&apos; as a QName: the prefix &apos;sch&apos; is not declared.</spring-ws:ValidationError>\n\n\n\n\n    <spring-ws:ValidationError xmlns:spring-ws=\"http://springframework.org/spring-ws\">cvc-attribute.3: The value &apos;sch:dateType&apos; of attribute &apos;xsi:type&apos; on element &apos;sch:value&apos; is not valid with respect to its type, &apos;QName&apos;.</spring-ws:ValidationError>\n\n\n\n\n    <spring-ws:ValidationError xmlns:spring-ws=\"http://springframework.org/spring-ws\">cvc-complex-type.2.1: Element &apos;sch:value&apos; must have no character or element information item [children], because the type&apos;s content type is empty.</spring-ws:ValidationError>\n\n\n\n\n</detail>\n\n\n\n\n\n\nRequest that works, with namespace decl in payload:\nlocalhost:8084/format/format.wsdl\n\n\n\n\n\n\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" >\n\n\n\n\n   <soapenv:Header/>\n\n\n\n\n   <soapenv:Body>\n\n\n\n\n      <sch:formatRequest xmlns:sch=\"http://example.com/springws/extension/schema\" >\n\n\n\n\n         <sch:value xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"sch:dateType\">\n\n\n\n\n           <sch:day>1</sch:day>\n\n\n\n\n           <sch:month>1</sch:month>\n\n\n\n\n           <sch:year>2000</sch:year>\n\n\n\n\n         </sch:value>\n\n\n\n\n      </sch:formatRequest>\n\n\n\n\n   </soapenv:Body>\n\n\n\n\n</soapenv:Envelope>\n\n\n\n\n\n", "project": "Spring", "sub_project": "SWS", "version": "v2.2.4.RELEASE", "fixed_version": "v2.3.0.RELEASE", "fixed_files": ["org.springframework.ws.soap.axiom.CachingPayload.java"], "label": 1, "es_results": []}, {"bug_id": 930, "bug_title": "NoSuchMethodError when using Axiom 1.2.14", "bug_description": "The changes made for SWS-922 have resulted in Spring Web Services no longer working with Axiom 1.2.14. Specifically the move to using getSOAPMessage in place of the, deprecated in 1.2.15, getSoapMessage. I AM GOING TO, it would be preferable to continue to use getSoapMessage and suppress the deprecation warning. This approach will make things compatible with Axiom 1.2.14 and 1.2.15.", "project": "Spring", "sub_project": "SWS", "version": "v2.2.4.RELEASE", "fixed_version": "v2.3.0.RELEASE", "fixed_files": ["org.springframework.ws.soap.axiom.AxiomSoapMessageFactory.java"], "label": 1, "es_results": []}, {"bug_id": 256, "bug_title": "ChannelBindingSaslClient and -ServerFactory should not pass on ChannelBindingCallback", "bug_description": "Currently this causes a FastUnsupportedCallbackException since these factories are the only thing to handle this callback. It doesn&apos;t really because any problems, but I noticed this while debugging.\nTLSServerEndPointChannelBindingSaslClientFactory removes the SSLCallback from the array before delegating, and the ChannelBinding ones should take the same approach from what I can tell.", "project": "Wildfly", "sub_project": "ELY", "version": "1.0.0.Alpha3", "fixed_version": "1.1.0.Alpha1", "fixed_files": ["org.wildfly.security.sasl.util.ChannelBindingSaslServerFactory.java", "org.wildfly.security.sasl.util.ChannelBindingSaslClientFactory.java"], "label": 1, "es_results": []}, {"bug_id": 385, "bug_title": "ELY01077: Invalid alias \"TLS_RSA_WITH_DES_CBC_SHA\"", "bug_description": "05:48:13 [33m05:48:13,801 WARN  [org.wildfly.security] (MSC service thread 1-2) ELY01077: Invalid alias \"TLS_RSA_WITH_DES_CBC_SHA\" for missing mechanism database entry \"TLS_RSA_FIPS_WITH_DES_CBC_SHA\"", "project": "Wildfly", "sub_project": "ELY", "version": "1.0.2.Final", "fixed_version": "1.1.0.Beta5", "fixed_files": ["org.wildfly.security.ssl.MechanismDatabase.java"], "label": 1, "es_results": []}, {"bug_id": 401, "bug_title": "ELY01077: Invalid alias \"TLS_RSA_WITH_DES_CBC_SHA\" for missing mechanism database entry \"TLS_RSA_FIPS_WITH_DES_CBC_SHA\"", "bug_description": "Getting the following warning logged when filtering the ciphers available from Oracle Java 8 with unlimited strength policy files in place: -\n\n\n\n\n\n\nELY01077: Invalid alias \"TLS_RSA_WITH_DES_CBC_SHA\" for missing mechanism database entry \"TLS_RSA_FIPS_WITH_DES_CBC_SHA\"\n\n\n\n\n\n\nThe JCE policy is probably unrelated, mentioning it just in case.", "project": "Wildfly", "sub_project": "ELY", "version": "1.0.2.Final", "fixed_version": "1.1.0.Beta5", "fixed_files": ["org.wildfly.security.ssl.MechanismDatabase.java"], "label": 1, "es_results": []}, {"bug_id": 395, "bug_title": "Undertow HTTPS listener offers no cipher suite for DEFAULT enabled-cipher-suites", "bug_description": "No cipher suites are available for handshake with HTTPS Undertow listener.\nAccording to OpenSSL documentation [1], cipher suites corresponding with ALL:!COMPLEMENTOFDEFAULT:!eNULL cipher string should be available for handshake.\nAccording to Elytron documentation [2], cipher suites corresponding with ALL:!aNULL:!eNULL cipher string should be available for handshake.\n[1] https://www.openssl.org/docs/manmaster/apps/ciphers.html#CIPHER-STRINGS\n[2] http://wildfly-security.github.io/wildfly-elytron/org/wildfly/security/ssl/CipherSuiteSelector.html#fromString-java.lang.String-", "project": "Wildfly", "sub_project": "ELY", "version": "1.0.2.Final", "fixed_version": "1.1.0.Beta6", "fixed_files": ["org.wildfly.security.ssl.CipherSuiteSelector.java"], "label": 1, "es_results": []}, {"bug_id": 502, "bug_title": "Remove operation does not persist the result in KeystorePasswordStore", "bug_description": "Remove operation doesn&apos;t persist the result in KeystorePasswordStore", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta5", "fixed_version": "1.1.0.Beta6", "fixed_files": ["org.wildfly.security.credential.store.impl.KeystorePasswordStore.java"], "label": 1, "es_results": []}, {"bug_id": 538, "bug_title": "Infinite loop in ElytronPermissionCollection.readResolve() method", "bug_description": "There is infinite loop in ElytronPermissionCollection.readResolve() on line 61 [1]. Variable bits is never changed in while cycle.\n[1] https://github.com/wildfly-security/wildfly-elytron/blob/ef67225884aa79b8e949c768a867c303af09fac4/src/main/java/org/wildfly/security/permission/ElytronPermissionCollection.java#L61", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta5", "fixed_version": "1.1.0.Beta7", "fixed_files": ["org.wildfly.security.permission.ElytronPermissionCollection.java", "org.wildfly.security.ssl.ProtocolSelector.java", "org.wildfly.security.manager.WildFlySecurityManagerPermissionCollection.java"], "label": 1, "es_results": []}, {"bug_id": 537, "bug_title": "Resource leaks in KeystorePasswordStore", "bug_description": "There are two resource leaks in org.wildfly.security.credential.store.impl.KeystorePasswordStore on line 413 [1] and 460 [2]. Both FileOutputStream and FileInputStream should be closed.\n[1] https://github.com/wildfly-security/wildfly-elytron/blob/ef67225884aa79b8e949c768a867c303af09fac4/src/main/java/org/wildfly/security/credential/store/impl/KeystorePasswordStore.java#L413\n[2] https://github.com/wildfly-security/wildfly-elytron/blob/ef67225884aa79b8e949c768a867c303af09fac4/src/main/java/org/wildfly/security/credential/store/impl/KeystorePasswordStore.java#L460", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta5", "fixed_version": "1.1.0.Beta7", "fixed_files": ["org.wildfly.security.credential.store.impl.KeystorePasswordStore.java"], "label": 1, "es_results": []}, {"bug_id": 542, "bug_title": "Incorrectly implemented applyFilter method of ProtocolSelector.RemovingProtocolSelector", "bug_description": "Method applyFilter from org.wildfly.security.ssl.ProtocolSelector.RemovingProtocolSelector is incorrectly implemented. Set<Protocol> enabled cannot contain (and therefore cannot remove) EnumSet<Protocol> protocols.", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta5", "fixed_version": "1.1.0.Beta7", "fixed_files": ["org.wildfly.security.ssl.ProtocolSelector.java"], "label": 1, "es_results": []}, {"bug_id": 543, "bug_title": "Missing null check in constructor of AbstractDigestMechanism", "bug_description": "There is missing null check in constructor of org.wildfly.security.sasl.digest.AbstractDigestMechanism. Calling of messageDigestAlgorithm(mechanismName) on line 133 [1] can return null which results to NPE thrown from MessageDigest.getInstance(null).\n[1] https://github.com/wildfly-security/wildfly-elytron/blob/ef67225884aa79b8e949c768a867c303af09fac4/src/main/java/org/wildfly/security/sasl/digest/AbstractDigestMechanism.java#L133", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta5", "fixed_version": "1.1.0.Beta7", "fixed_files": ["org.wildfly.security.sasl.digest.AbstractDigestMechanism.java"], "label": 1, "es_results": []}, {"bug_id": 545, "bug_title": "Missing null checks in URIUtil.getHostForURI(SocketAddress socketAddress) method", "bug_description": "There is public static method org.wildfly.security.util.URIUtil.getHostForURI(SocketAddress socketAddress) with missing null checks for hostString and address. This method can be publicly accessed and result to NPE.", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta5", "fixed_version": "1.1.0.Beta7", "fixed_files": ["org.wildfly.security.util.URIUtil.java"], "label": 1, "es_results": []}, {"bug_id": 546, "bug_title": "Missing null check in SecurityDomain.mapName() method", "bug_description": "There is missing null check in org.wildfly.security.auth.server.SecurityDomain.mapName(String name) method. Parameter name can be changed to null on line 162 [1] which can result to NPE in following command on line 163. Null check should be added.\n[1] https://github.com/wildfly-security/wildfly-elytron/blob/ef67225884aa79b8e949c768a867c303af09fac4/src/main/java/org/wildfly/security/auth/server/SecurityDomain.java#L162", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta5", "fixed_version": "1.1.0.Beta7", "fixed_files": ["org.wildfly.security.auth.server.SecurityDomain.java"], "label": 1, "es_results": []}, {"bug_id": 589, "bug_title": "RawClearPassword should implement Destroyable interface", "bug_description": "Class RawClearPassword doesn&apos;t implement method destroy() from Destroyable interface thus causing warnings in runtime.\nIt should be implemented anyway.  ", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta5", "fixed_version": "1.1.0.Beta7", "fixed_files": ["org.wildfly.security.password.interfaces.RawClearPassword.java"], "label": 1, "es_results": []}, {"bug_id": 611, "bug_title": "Unintentional integer overflow in LongNameSetPermissionCollection", "bug_description": "There are potentially overflowing expressions in org.wildfly.security.permission.LongNameSetPermissionCollection in getBitsForName method. Expressions 1 << nameEnumeration.size() and 1 << nameEnumeration.indexOf(name) are evaluated as integer but assigned to bits variable which is long. It can be avoided by casting 1 to long.", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta7", "fixed_version": "1.1.0.Beta8", "fixed_files": ["org.wildfly.security.permission.LongNameSetPermissionCollection.java"], "label": 1, "es_results": []}, {"bug_id": 614, "bug_title": "Missing null check in equals() method of AbstractPermission", "bug_description": "There is missing null check in org.wildfly.security.permission.AbstractPermission.equals(Object obj) method. NPE is thrown for null obj parameter.", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta7", "fixed_version": "1.1.0.Beta8", "fixed_files": ["org.wildfly.security.permission.AbstractPermission.java"], "label": 1, "es_results": []}, {"bug_id": 610, "bug_title": "Missing null check in build() method of X509CertificateBuilder", "bug_description": "Calling ASN1.oidFromSignatureAlgorithm(String) in org.wildfly.security.x500.cert.X509CertificateBuilder.build() method on line 375 [1] for unknown algorithms returns null which is assigned to signatureAlgorithmOid and results to NPE thrown from derEncoder.encodeObjectIdentifier(signatureAlgorithmOid) on line 377.\n[1] https://github.com/wildfly-security/wildfly-elytron/blob/e01a09572b02f33db01695eb85638e88b0cd944f/src/main/java/org/wildfly/security/x500/cert/X509CertificateBuilder.java#L375", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta7", "fixed_version": "1.1.0.Beta8", "fixed_files": ["org.wildfly.security.x500.cert.X509CertificateBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 612, "bug_title": "Missing or unnecessary null check in AbstractDigestMechanism", "bug_description": "There is missing or unnecessary null check in getSaltedPasswordFromTwoWay method of org.wildfly.security.sasl.digest.AbstractDigestMechanism. char[] passwordChars is assigned on line 650 [1]. \n\nIn case when null can be assigned to passwordChars then there is missing null check before calling userRealmPasswordDigest(messageDigest, username, realm, passwordChars); on line 658 which can result to NPE.\nIn case when null cannot be assigned to passwordChars then there is unnecessary null check on line 659.\n\n[1] https://github.com/wildfly-security/wildfly-elytron/blob/e01a09572b02f33db01695eb85638e88b0cd944f/src/main/java/org/wildfly/security/sasl/digest/AbstractDigestMechanism.java#L650", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta7", "fixed_version": "1.1.0.Beta8", "fixed_files": ["org.wildfly.security.sasl.digest.AbstractDigestMechanism.java"], "label": 1, "es_results": []}, {"bug_id": 654, "bug_title": "Ensure that negative values are converted to zero when setting sessionCacheSize and sessionTimeout in SSLSessionContext.", "bug_description": "Ensure that negative values are converted to zero when setting sessionCacheSize and sessionTimeout on SSLSessionContext.", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta10", "fixed_version": "1.1.0.Beta11", "fixed_files": ["org.wildfly.security.ssl.SSLContextBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 634, "bug_title": "No log messages comming from Elytron - group assignment", "bug_description": "Elytron is missing any log messages related to group assignment. These log messages should be added. See JBEAP-6041 for more details.", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta9", "fixed_version": "1.1.0.Beta11", "fixed_files": ["org.wildfly.security.auth.server.ServerAuthenticationContext.java", "org.wildfly.security.x500.X500AttributePrincipalDecoder.java", "org.wildfly.security._private.ElytronMessages.java", "org.wildfly.security.auth.realm.KeyStoreBackedSecurityRealm.java", "org.wildfly.security.ssl.SecurityDomainTrustManager.java", "org.wildfly.security.keystore.AtomicLoadKeyStoreSpi.java", "org.wildfly.security.auth.server.SecurityDomain.java"], "label": 1, "es_results": []}, {"bug_id": 627, "bug_title": "Elytron introduces SSL/TLS protocol constraints", "bug_description": "\n\n\n\n\n\n\n                       \"protocols\" => {\n\n\n\n\n                            \"type\" => LIST,\n\n\n\n\n                            \"description\" => \"The enabled protocols.\",\n\n\n\n\n                            \"expressions-allowed\" => true,\n\n\n\n\n                            \"nillable\" => false,\n\n\n\n\n                            \"allowed\" => [\n\n\n\n\n                                \"SSLv2\",\n\n\n\n\n                                \"SSLv3\",\n\n\n\n\n                                \"TLSv1\",\n\n\n\n\n                                \"TLSv1_1\",\n\n\n\n\n                                \"TLSv1_2\",\n\n\n\n\n                                \"TLSv1_3\"\n\n\n\n\n                            ],\n\n\n\n\n                            \"value-type\" => STRING,\n\n\n\n\n                            \"access-type\" => \"read-write\",\n\n\n\n\n                            \"storage\" => \"configuration\",\n\n\n\n\n                            \"restart-required\" => \"resource-services\"\n\n\n\n\n                        },\n\n\n\n\n\n\nWhy elytron on this place is going to validate user input and map standard java values [1] into proprietary values?\nWhereas on other similar places (KeyManager algorithm, TrustManager algorithm, Keystore types) it leaves up to user to set proper value.\nI AM GOING TO, with such mapping another place, where bugs can raise was introduced. EAP will be here always one step back compared to java. \nNote, IBM java already today defines little bit different protocols set [2]\nI wonder, where is that mapping \"TLSv1_2 -> TLSv1.2\" acually performed? I couldn&apos;t find that place.\n[1] https://docs.oracle.com/javase/8/docs/technotes/guides/security/StandardNames.html#SSLContext\n[2] http://www.ibm.com/support/knowledgecenter/SSYKE2_8.0.0/com.ibm.java.security.component.80.doc/security-component/jsse2Docs/protocols.html", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta8", "fixed_version": "1.1.0.Beta12", "fixed_files": ["org.wildfly.security.ssl.Protocol.java"], "label": 1, "es_results": []}, {"bug_id": 757, "bug_title": "Do not use String toUpperCase/toLowerCase in the testsuite without Locale provided", "bug_description": "The String.toUpperCase() and String.toLowerCase() methods depend on the system locale. We should avoid using them in the Elytron testsuite and use the overloaded method with Locale parameter instead.", "project": "Wildfly", "sub_project": "ELY", "version": "1.1.0.Beta13", "fixed_version": "1.1.0.Beta15", "fixed_files": ["org.wildfly.security.ssl.SSLAuthenticationTest.java", "org.wildfly.security.sasl.digest._private.DigestUtilTest.java"], "label": 1, "es_results": []}, {"bug_id": 516, "bug_title": "Auto detection scans transitive dependencies of fractions", "bug_description": "If you specify `additionalFractions` in the plugin, it ends up scanning through transitive dependencies of those fractions for auto detection.\nThis results in a lot more fractions being detected than is actually required.", "project": "Wildfly", "sub_project": "SWARM", "version": "1.0.0.CR1", "fixed_version": "1.0.0.CR2", "fixed_files": ["org.wildfly.swarm.tools.BuildTool.java"], "label": 1, "es_results": []}, {"bug_id": 500, "bug_title": "Cannot Run javaee7-samples Stateless EJB Example", "bug_description": "", "project": "Wildfly", "sub_project": "SWARM", "version": "1.0.0.CR1", "fixed_version": "1.0.0.CR2", "fixed_files": ["org.wildfly.swarm.ejb.remote.EJBRemoteFraction.java"], "label": 1, "es_results": []}, {"bug_id": 528, "bug_title": "swarm.http.port and swarm.port.offset do not work with @ArquillianResource URL baseURL", "bug_description": "First Example\nIf you set the swarm port using either swarm.http.port or swarm.port.offset via arquillian.xml e.g.\n\n\n\n\n\n\n    <container qualifier=\"wildfly-swarm\" default=\"true\">\n\n\n\n\n        <configuration>\n\n\n\n\n            <property name=\"javaVmArguments\">\n\n\n\n\n                -Dswarm.port.offset=1\n\n\n\n\n            </property>\n\n\n\n\n        </configuration>\n\n\n\n\n    </container>\n\n\n\n\n\n\nthe arquillian swarm container is correctly started on the specified port/offset.\nThe problem is that if you use:\n\n\n\n\n\n\n@ArquillianResource\n\n\n\n\nprivate URL baseURL;\n\n\n\n\n\n\nto retrieve the url the swarm container is accessible via it always returns http://localhost:8080.\nSecond Example\nIf you set the port property in arquillian.xml\n\n\n\n\n\n\n    <container qualifier=\"wildfly-swarm\" default=\"true\">\n\n\n\n\n        <configuration>\n\n\n\n\n            <property name=\"port\">8081</property>\n\n\n\n\n        </configuration>\n\n\n\n\n    </container>\n\n\n\n\n\n\nit starts the swarm container on 8080 and \n\n\n\n\n\n\n@ArquillianResource\n\n\n\n\nprivate URL baseURL;\n\n\n\n\n\n\nreturns http://localhost:8081\nThird Example\nAttempting to combine the port property and the offset does not work either e.g. \n\n\n\n\n\n\n    <container qualifier=\"wildfly-swarm\" default=\"true\">\n\n\n\n\n        <configuration>\n\n\n\n\n            <property name=\"javaVmArguments\">\n\n\n\n\n                -Dswarm.port.offset=1\n\n\n\n\n            </property>\n\n\n\n\n            <property name=\"port\">8081</property>\n\n\n\n\n        </configuration>\n\n\n\n\n    </container>\n\n\n\n\n\n\nthe port/offset is ignored and the container is started on 8080, while\n\n\n\n\n\n\n@ArquillianResource\n\n\n\n\nprivate URL baseURL;\n\n\n\n\n\n\nreturns http:localhost:8081 \nnote: while the examples above use swarm.port.offset, the same issue occurs if you use swarm.http.port", "project": "Wildfly", "sub_project": "SWARM", "version": "1.0.0.CR2", "fixed_version": "2016.8", "fixed_files": ["org.wildfly.swarm.arquillian.resources.SwarmURLResourceProvider.java"], "label": 1, "es_results": []}, {"bug_id": 553, "bug_title": "Error with logging fraction when using PeriodicSizeRotatingFileHandler", "bug_description": "When using LoggingFraction and PeriodicSizeRotatingFileHandler it gives me the following error:\n\n\n\n\n\n\n16:03:13,755 ERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool -- 9) WFLYCTL0013: Operation (\"add\") failed - address: ([\n\n\n\n\n    (\"subsystem\" => \"logging\"),\n\n\n\n\n    (\"periodic-size-rotating-file-handler\" => \"cliente-handler\")\n\n\n\n\n]) - failure description: \"WFLYCTL0155: file may not be null\"\n\n\n\n\n\n\nHere is my whole code:\nhttps://gist.github.com/rafaelszp/8bdfc147c676f35106eb4213670b568b", "project": "Wildfly", "sub_project": "SWARM", "version": "1.0.0.Final", "fixed_version": "2016.8", "fixed_files": ["org.wildfly.swarm.container.runtime.RuntimeServer.java"], "label": 1, "es_results": []}, {"bug_id": 551, "bug_title": "Infinispan - access default cache - ClassCastException", "bug_description": "Hi,\nthere is a problem with the casting from org.jboss.as.clustering.infinispan.DefaultCacheContainer to org.infinispan.manager.EmbeddedCacheManager. I don&apos;t know why I can&apos;t cast this classes. After I watched DefaultCacheContainer this class, I think this could be a bug.", "project": "Wildfly", "sub_project": "SWARM", "version": "1.0.0.Final", "fixed_version": "2016.8", "fixed_files": ["org.wildfly.swarm.infinispan.InfinispanFraction.java"], "label": 1, "es_results": []}, {"bug_id": 587, "bug_title": "Unable to connect to Remote JMS", "bug_description": "If I create a WildFly Swarm project that has some JMS topics or queues, an external client is unable to retrieve a connection factory to access JMS resources", "project": "Wildfly", "sub_project": "SWARM", "version": "1.0.0.Final", "fixed_version": "2016.8", "fixed_files": ["org.wildfly.swarm.messaging.EnhancedServer.java"], "label": 1, "es_results": []}, {"bug_id": 586, "bug_title": "IllegalStateException when accessing monitoring endpoints", "bug_description": "When accessing any of the health endpoints from the monitor fraction, though the data is returned the logs show an IllegalStateException due to the response having already been started.\nFurther details here: https://groups.google.com/forum/#!topic/wildfly-swarm/6Ue-QpIJq4I", "project": "Wildfly", "sub_project": "SWARM", "version": "1.0.0.Final", "fixed_version": "2016.8", "fixed_files": ["org.wildfly.swarm.monitor.runtime.HttpContexts.java"], "label": 1, "es_results": []}, {"bug_id": 564, "bug_title": "Cannot get underlying PostgreSQL database connection from datasource", "bug_description": "I need to get the underlying PostgreSQL database connection from a datasource, see \"Steps to Reproduce\" for how exactly I&apos;m trying to achieve this. In Wildfly Swarm this results in a ClassNotFoundException. I have also tried this with Wildfly 10 and there it does work.", "project": "Wildfly", "sub_project": "SWARM", "version": "1.0.0.Final", "fixed_version": "2016.9", "fixed_files": ["org.wildfly.swarm.datasources.DatasourcesFraction.java"], "label": 1, "es_results": []}, {"bug_id": 571, "bug_title": "Arquillian does not include src/main/resource/modules", "bug_description": "I use the mssql JDBC driver which is configured in the src/main/module. When running a test with arquillian (\"@RunWith(Arquillian.class)\"). The jdbc driver is not found when I provide a datasource config via XML or via Java API. I ended up adding the src/main/module via the swarm.build.modules property.\nuberjar is working fine.", "project": "Wildfly", "sub_project": "SWARM", "version": "1.0.0.Final", "fixed_version": "2016.9", "fixed_files": ["org.wildfly.swarm.arquillian.adapter.UberjarSimpleContainer.java"], "label": 1, "es_results": []}, {"bug_id": 844, "bug_title": "Gradle project dependencies with 2 colons are resolved as jar dependencies", "bug_description": "", "project": "Wildfly", "sub_project": "SWARM", "version": "2016.11.0", "fixed_version": "2016.12.0", "fixed_files": ["org.wildfly.swarm.arquillian.adapter.GradleDependencyAdapter.java"], "label": 1, "es_results": []}, {"bug_id": 611, "bug_title": "Weld warnings being displayed when starting a swarmed app", "bug_description": "The app works \n\n\n\n\n\n\n17:02:43,791 WARN  [org.jboss.weld.Bean] (main) WELD-000018: Executing producer field or method [BackedAnnotatedMethod] @Produces @Dependent public org.wildfly.swarm.container.runtime.RuntimeServer.stageConfig() on incomplete declaring bean Managed Bean [class org.wildfly.swarm.container.runtime.RuntimeServer] with qualifiers [@Any @Default] due to circular injection\n\n\n\n\n2016-08-17 17:02:45,700 WARN  [org.jboss.weld.Bean] (main) WELD-000018: Executing producer field or method [BackedAnnotatedMethod] @Produces @Singleton org.wildfly.swarm.container.runtime.RuntimeServer.client() on incomplete declaring bean Managed Bean [class org.wildfly.swarm.container.runtime.RuntimeServer] with qualifiers [@Any @Default] due to circular injection\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "SWARM", "version": "2016.8", "fixed_version": "2016.9", "fixed_files": ["org.wildfly.swarm.container.runtime.RuntimeServer.java", "org.wildfly.swarm.container.runtime.xmlconfig.StandaloneXMLConfigProducer.java", "org.wildfly.swarm.container.runtime.ServerBootstrapImpl.java", "org.wildfly.swarm.container.runtime.xmlconfig.StandaloneXMLParserProducer.java", "org.wildfly.swarm.container.runtime.xmlconfig.XMLConfig.java", "org.wildfly.swarm.container.runtime.marshal.XMLMarshaller.java", "org.wildfly.swarm.internal.SwarmMessages.java", "org.wildfly.swarm.management.runtime.ManagementSocketBindingsCustomizer.java", "org.wildfly.swarm.container.runtime.marshal.SubsystemMarshaller.java", "org.wildfly.swarm.container.runtime.marshal.ExtensionMarshaller.java", "org.wildfly.swarm.ejb.runtime.EJBSecurityCustomizer.java", "org.wildfly.swarm.undertow.runtime.AJPCustomizer.java", "org.wildfly.swarm.jpa.runtime.DefaultDatasourceCustomizer.java", "org.wildfly.swarm.undertow.runtime.HTTPSCustomizer.java", "org.wildfly.swarm.container.runtime.marshal.InterfaceMarshaller.java", "org.wildfly.swarm.container.runtime.marshal.ProjectStagePropertyMarshaller.java", "org.wildfly.swarm.transactions.runtime.TransactionsSocketBindingCustomizer.java", "org.wildfly.swarm.monitor.runtime.UndertowFilterCustomizer.java", "org.wildfly.swarm.drools.server.runtime.DroolsSetup.java", "org.wildfly.swarm.topology.consul.runtime.ConsultURLCustomizer.java", "org.wildfly.swarm.ee.runtime.DefaultBindingCustomizer.java"], "label": 1, "es_results": []}, {"bug_id": 635, "bug_title": "ExplodedImporter not available in main()", "bug_description": "", "project": "Wildfly", "sub_project": "SWARM", "version": "2016.8", "fixed_version": "2016.9", "fixed_files": ["org.wildfly.swarm.Swarm.java"], "label": 1, "es_results": []}, {"bug_id": 662, "bug_title": "NPE when calling addAllDependencies()", "bug_description": "See https://groups.google.com/forum/?utm_medium=email&utm_source=footer#!message/wildfly-swarm/jwiBt6zIGh8/pTwmLsj_CAAJ", "project": "Wildfly", "sub_project": "SWARM", "version": "2016.9", "fixed_version": "2016.10.0", "fixed_files": ["org.wildfly.swarm.bootstrap.env.MavenDependencyResolution.java"], "label": 1, "es_results": []}, {"bug_id": 667, "bug_title": "Arquillian container fails to find dependencies in active Maven Profile", "bug_description": "If a project defines WIldFly Swarm dependencies in a Maven Profile, any tests in the project are unable to find the bootstrap.jar from WildFly Swarm.\nProblem appears to be in UberjarSimpleContainer when it loads the `pom.xml` file and resolves the dependencies. Without a profile on that resolution, it doesn&apos;t find the dependencies", "project": "Wildfly", "sub_project": "SWARM", "version": "2016.9", "fixed_version": "2016.10.0", "fixed_files": ["org.wildfly.swarm.arquillian.adapter.UberjarSimpleContainer.java", "org.wildfly.swarm.arquillian.adapter.WildFlySwarmObserver.java"], "label": 1, "es_results": []}, {"bug_id": 681, "bug_title": "health endpoints are available on their original paths, but only if they are not secured", "bug_description": "If a health endpoint is defined at path /app/health, it&apos;s primarily available under /health/app/health. If it&apos;s unsecured, it&apos;s also available at the original path /app/health, but if it&apos;s secured, the original path /app/health returns 403.\nThat&apos;s inconsistent and counter-intuitive. I believe that all original paths should just return 301 redirect to /health/..., regardless of the security constraints.", "project": "Wildfly", "sub_project": "SWARM", "version": "2016.9", "fixed_version": "2016.10.0", "fixed_files": ["org.wildfly.swarm.jaxrs.JAXRSArqMonitorTest.java", "org.wildfly.swarm.jaxrs.SimpleHttp.java", "org.wildfly.swarm.monitor.runtime.Queries.java", "org.wildfly.swarm.monitor.runtime.HttpContexts.java"], "label": 1, "es_results": []}, {"bug_id": 690, "bug_title": "FractionList brings wrong fraction information when a fraction is declared as a dependency of other fraction", "bug_description": "The internal, name and other properties have incorrect (default) values if the fraction is declared as a dependency of another fraction. \nEg. archaius ", "project": "Wildfly", "sub_project": "SWARM", "version": "2016.9", "fixed_version": "2016.10.0", "fixed_files": ["org.wildfly.swarm.fractionlist.FractionList.java", "org.wildfly.swarm.fractionlist.FractionListTest.java"], "label": 1, "es_results": []}, {"bug_id": 697, "bug_title": "StackOverflowError during gradle artifactresolving", "bug_description": "When building with gradle an a StackOverflowError occurs when there is a 3rd-party dependency with circular dependencies to other 3rd-party-libs. (Recursion in method \"fullTree\")\nIn gradle I have to possibility to force the build to take another version of the 3rd-party lib, which may have fixed the circular error. (https://docs.gradle.org/current/dsl/org.gradle.api.artifacts.ResolutionStrategy.html). But this option to quick-fix the error from outside the swarm-buildplugin doesn&apos;t work, because the GradleArtifactResolvingHelper from swarm is using  a detached configuration, where I can&apos;t define this forced-dependencies.\nThe GradleArtifactResolvingHelper should use gradle-features to resolve the artifacts from a specific configuration instead of implement this with the recursive method &apos;fullTree&apos;. gradle can handle this circular dependencies and is much faster! The ResolvingHelper should also apply the forced-versions from the resolutionstrategy of the configuration &apos;compile&apos; to the detached configuration.", "project": "Wildfly", "sub_project": "SWARM", "version": "2016.9", "fixed_version": "2016.10.0", "fixed_files": ["org.wildfly.swarm.plugin.gradle.GradleArtifactResolvingHelper.java"], "label": 1, "es_results": []}, {"bug_id": 700, "bug_title": "\"swarm.port.offset\" not working", "bug_description": "The system property \"swarm.port.offset\" doesn&apos;t work for now.\nI found port-offset value is hard-coded with zero in DefaultSocketBindingGroupProducer.\nhttps://github.com/wildfly-swarm/wildfly-swarm/blob/master/container/src/main/java/org/wildfly/swarm/container/runtime/config/DefaultSocketBindingGroupProducer.java#L35\nIt should be passed the system prop like this.\n\n\n\n\n\n\nnew SocketBindingGroup(\n\n\n\n\n                \"standard-sockets\",\n\n\n\n\n                \"public\",\n\n\n\n\n                SwarmProperties.propertyVar(SwarmProperties.PORT_OFFSET, \"0\"))\n\n\n\n\n\n\nI&apos;ll send a p-r later.", "project": "Wildfly", "sub_project": "SWARM", "version": "2016.9", "fixed_version": "2016.10.0", "fixed_files": ["org.wildfly.swarm.container.runtime.config.DefaultSocketBindingGroupProducer.java"], "label": 1, "es_results": []}, {"bug_id": 691, "bug_title": "Multiple Archive#as(Secured.class) executions occur ParseError of web.xml", "bug_description": "Multiple Archive#as(Secured.class) executions occur ParseError of web.xml.\nThe method sets up web.xml, and if you use it multiple times, multiple login-config elements in web.xml would be registered", "project": "Wildfly", "sub_project": "SWARM", "version": "2016.9", "fixed_version": "2016.11.0", "fixed_files": ["org.wildfly.swarm.undertow.descriptors.WebXmlAsset.java"], "label": 1, "es_results": []}, {"bug_id": 669, "bug_title": "Building simple example fails under Windows 7 x64 (file locked by another process)", "bug_description": "Even trying to build the most simple demo application:\n\neither the scaffold generated from http://wildfly-swarm.io/generator/\nor the demo application shown in the GitBook https://wildfly-swarm.gitbooks.io/wildfly-swarm-users-guide/content/first-steps/maven_pom.html using their exact pom.xml and two Java classes\n\nand using the mvn commands:\n`mvn clean wildfly-swarm:run`; or just\n`mvn wildfly-swarm:run`\nfails at the war building step with the error message:\n```\n[INFO]  maven-war-plugin:2.2:war (default-war) @ restful-endpoint \n[INFO] Packaging webapp\n[INFO] Assembling webapp [restful-endpoint] in [d:\\eclipse-workspace-nkg\\wildfly-swarm-test\\target\\restful-endpoint]\n[INFO] Processing war project\n[INFO] Webapp assembled in [9 msecs]\n[INFO] Building war: d:\\eclipse-workspace-nkg\\wildfly-swarm-test\\target\\restful-endpoint.war\n[INFO]\n[INFO]  wildfly-swarm-plugin:2016.9:package (default) @ restful-endpoint \n[INFO] Scanning for needed WildFly Swarm fractions with mode: when_missing\n[INFO] Detected fractions: container:2016.9\n[INFO] Adding fractions: container:2016.9\n[INFO] Repackaging .war: d:\\eclipse-workspace-nkg\\wildfly-swarm-test\\target\\restful-endpoint.war\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD FAILURE\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time: 3.393 s\n[INFO] Finished at: 2016-09-12T10:46:48+02:00\n[INFO] Final Memory: 18M/243M\n[INFO] ------------------------------------------------------------------------\n[ERROR] Failed to execute goal org.wildfly.swarm:wildfly-swarm-plugin:2016.9:package (default) on project restful-endpoint: Unable to create -swarm.jar: d:\\eclipse-workspace-nkg\\wildfly-swarm-test\\target\\restful-endpoint.war -> d:\\eclipse-workspace-nkg\\wildfly-swarm-test\\target\\restful-endpoint.war.original: Der Prozess kann nicht auf die Datei zugreifen, da sie von einem anderen Prozess verwendet wird. -> [Help 1]\n[ERROR]\n[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.\n[ERROR] Re-run Maven using the -X switch to enable full debug logging.\n[ERROR]\n[ERROR] For more information about the errors and possible solutions, please read the following articles:\n[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException\n```\nwhich means that the process cannot access the file because it is locked by another process. I&apos;ve never had this issue with any other Maven applications/builds.\nUnder Ubuntu 16.04, the same demo application builds just fine.\nEDIT:\nUsing `mvn clean package` works and successfully creates the jar file.", "project": "Wildfly", "sub_project": "SWARM", "version": "2016.9", "fixed_version": "2016.10.0", "fixed_files": ["org.wildfly.swarm.tools.DependencyManager.java", "org.wildfly.swarm.tools.BuildTool.java"], "label": 1, "es_results": []}, {"bug_id": 5, "bug_title": "controller client has a small memory leak as it is not cleaning up the ThreadGroup object", "bug_description": "org.jboss.as.controller.client.impl.ClientConfigurationImpl\n052     static ExecutorService createDefaultExecutor() {\n053         final ThreadGroup group = new ThreadGroup(\"management-client-thread\");\nThe ThreadGroup is never cleaned up and creates a memory leak", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha2", "fixed_version": "1.0.0.Alpha4", "fixed_files": ["org.jboss.as.controller.client.impl.ClientConfigurationImpl.java"], "label": 1, "es_results": []}, {"bug_id": 8, "bug_title": "Unhelpful error message when OSH throws an exception with no detail message", "bug_description": "This shows up a fair amount in issue reports, either in the CLI output or in the server log:\n\"failure-description\" => \"JBAS014749: Operation handler failed: null\"\nThe null happens because the message is getting passed the result of throwable.getLocalizedMessage() and that may be null. See DMR-11 for what&apos;s likely the most common reason it&apos;s null.\nIf it&apos;s null, the code should use the class name of the error message.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha3", "fixed_version": "1.0.0.Alpha4", "fixed_files": ["org.jboss.as.controller.AbstractOperationContext.java"], "label": 1, "es_results": []}, {"bug_id": 50, "bug_title": "CLI tests using non-standard output stream do not reset the terminal when done", "bug_description": "The problem appears only when running single tests. If the tests are run using a wildcard, there is no problem.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha4", "fixed_version": "1.0.0.Alpha5", "fixed_files": ["org.jboss.as.test.integration.management.util.CLITestUtil.java"], "label": 1, "es_results": []}, {"bug_id": 67, "bug_title": "CLI shutting down a slave disconnects from the master", "bug_description": "If I issue a shutdown command for a slave HC, the CLI gets disconnected:\n[domain@localhost:9999 /] shutdown --host=slave-a\n[disconnected /] shutdown --host=slave-b\nThe command is not available in the current context (e.g. required subsystems or connection to the controller might be unavailable).\n[disconnected /] cd /\nThe command is not available in the current context (e.g. required subsystems or connection to the controller might be unavailable).\n[disconnected /] connect\n[domain@localhost:9999 /] shutdown --host=slave-b\n[disconnected /]", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha4", "fixed_version": "1.0.0.Alpha6", "fixed_files": ["org.jboss.as.cli.Util.java", "org.jboss.as.cli.handlers.ShutdownHandler.java"], "label": 1, "es_results": []}, {"bug_id": 79, "bug_title": "ExplodedDeploymentMarker is not set for sub deployments", "bug_description": "", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha5", "fixed_version": "1.0.0.Alpha6", "fixed_files": ["org.jboss.as.server.deployment.module.DeploymentRootMountProcessor.java", "org.jboss.as.server.deployment.SubDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 71, "bug_title": "ProtocolLogger is used outside org.jboss.as.protocol module but is not available", "bug_description": "The ProtocolLogger class is used in a few places in host-controller and server, but the module.xml for the org.jboss.as.protocol module specifically excludes it from being exported.\nThe uses aren&apos;t complex enough to justify exporting the class, so I&apos;ll just change them.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha5", "fixed_version": "1.0.0.Alpha6", "fixed_files": ["org.jboss.as.server.mgmt.domain.HostControllerConnection.java", "org.jboss.as.host.controller.mgmt.HostControllerRegistrationHandler.java", "org.jboss.as.host.controller.mgmt.ServerToHostProtocolHandler.java", "org.jboss.as.protocol.mgmt.FutureManagementChannel.java"], "label": 1, "es_results": []}, {"bug_id": 64, "bug_title": "Filesystem deployment scanner deployment failure removes unrelated deployments", "bug_description": "If one&apos;s standalone-full.xml configuration contains something like:\n<deployments>\n  <deployment name=\"MyWebApp.war\" runtime-name=\"MyWebApp.war\" enabled=\"true\">\n    <fs-exploded path=\"../../SomeDir/MyWebApp.war\" relative-to=\"jboss.home.dir\"/>\n  </deployment>\n</deployments>\nwhether manually inserted (while the server is not running) or installed via the CLI via\n  /deployment=ServiceCenter.war/:add(runtime-name=ServiceCenter.war,content=[\n{archive=false,path=\"../../Windchill/ServiceCenter.war\",relative-to=\"jboss.home.dir\"}\n])\nand a deployment scanner like:\n  <subsystem xmlns=\"urn:jboss:domain:deployment-scanner:2.0\"> \n    <deployment-scanner name=\"1\" path=\"../../../Applications\" relative-to=\"jboss.server.base.dir\" scan-interval=\"5000\" auto-deploy-exploded=\"true\"/> \n  </subsystem> \na failure by a deployment-scanner to deploy an application (exploded in my case, though I&apos;m not sure this makes a difference) will cause the explicitly listed <deployments> to be removed from the configuration!\nThis occurs irrespective of the value used for auto-deploy-exploded and to <deployment> elements that had already successfully been deployed and started.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha5", "fixed_version": "1.0.0.Alpha6", "fixed_files": ["org.jboss.as.server.deployment.scanner.FileSystemDeploymentService.java", "org.jboss.as.server.deployment.scanner.FileSystemDeploymentServiceUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 72, "bug_title": "deploy --force fails in CLI GUI", "bug_description": "The --force flag is not working with the deploy command in CLI GUI.  The CLI CommandContextImpl is generating the wrong DMR request.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha5", "fixed_version": "1.0.0.Alpha6", "fixed_files": ["org.jboss.as.cli.impl.CliLauncher.java"], "label": 1, "es_results": []}, {"bug_id": 95, "bug_title": "PrimitiveListAttributeDefinition.Builder copy constructor does not copy the listValidator", "bug_description": "", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha5", "fixed_version": "1.0.0.Alpha9", "fixed_files": ["org.jboss.as.controller.PrimitiveListAttributeDefinitionUnitTestCase.java", "org.jboss.as.controller.SimpleListAttributeDefinition.java", "org.jboss.as.controller.PrimitiveListAttributeDefinition.java", "org.jboss.as.controller.SimpleListAttributeDefinitionUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 117, "bug_title": "Typo in add-user help text", "bug_description": "There is a typo in help message of add-user tool.\nVersion-Release number of selected component (if applicable):\n EAP 6.4.0.DR1.1\nHow reproducible:\n Always\nSteps to Reproduce:\n1. ./add-user.sh --help\nActual results:\n...\n    -sc <value>                         Define the location the server config \n                                        directory.\n...\nExpected results:\n...\n    -sc <value>                         Define the location of the server config \n                                        directory.\n...", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha8", "fixed_version": "1.0.0.Alpha9", "fixed_files": ["org.jboss.as.domain.management.logging.DomainManagementLogger.java"], "label": 1, "es_results": []}, {"bug_id": 125, "bug_title": "Security realm cache definitions not possible for LDAP prinicipal to group group loading.", "bug_description": "\nIt&apos;s not possible to configure LDAP cache in security realms under \"authorization=ldap/group-search=principal-to-group\"\nPossible reason:\nThe LdapCacheResourceDefinition is not registered under the org.jboss.as.domain.management.security.PrincipalToGroupResourceDefinition\nWhen I try to add the cache configuration manually to standalone.xml, server doesn&apos;t start and reports:\n15:23:44,619 ERROR [org.jboss.as.controller] (Controller Boot Thread) JBAS014629: No resource definition is registered for address [\n    (\"core-service\" => \"management\"),\n    (\"security-realm\" => \"JBossTest\"),\n    (\"authorization\" => \"ldap\"),\n    (\"group-search\" => \"principal-to-group\"),\n    (\"cache\" => \"by-search-time\")\n]\n15:23:44,621 FATAL [org.jboss.as.server] (Controller Boot Thread) JBAS015957: Server boot has failed in an unrecoverable manner; exiting. See previous messages for details.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha8", "fixed_version": "1.0.0.Alpha9", "fixed_files": ["org.jboss.as.domain.management.security.PrincipalToGroupResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 87, "bug_title": "Display deployment timestamp", "bug_description": "Display the deployment timestamp, that is the date of last modified deployment. It is useful for users to see the date and time of deployments.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha5", "fixed_version": "1.0.0.Alpha9", "fixed_files": ["org.jboss.as.server.deployment.DeploymentReplaceHandler.java", "org.jboss.as.server.deployment.DeploymentUtils.java", "org.jboss.as.server.controller.resources.DeploymentAttributes.java", "org.jboss.as.server.deployment.DeploymentUndeployHandler.java", "org.jboss.as.server.deployment.DeploymentFullReplaceHandler.java", "org.jboss.as.server.deployment.DeploymentDeployHandler.java", "org.jboss.as.controller.descriptions.ModelDescriptionConstants.java", "org.jboss.as.server.deployment.DeploymentAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 132, "bug_title": "BoundedQueueThreadPoolWriteAttributeHandler does not deal with undefined core-threads correctly", "bug_description": "BoundedQueueThreadPoolWriteAttributeHandler doesn&apos;t deal with undefined values for core-threads correctly. It assumes the attribute will be defined, and that&apos;s not required.\nThe attribute doesn&apos;t have a fixed default value. Instead, the behavior in add is to set the runtime value to match max-threads of core-threads is undefined. BoundedQueueThreadPoolWriteAttributeHandler should do the same.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha8", "fixed_version": "1.0.0.Alpha9", "fixed_files": ["org.jboss.as.threads.BoundedQueueThreadPoolWriteAttributeHandler.java"], "label": 1, "es_results": []}, {"bug_id": 140, "bug_title": "The Resource for a deployment whose 'persistent' attribute is 'false' does not return 'true' from isRuntime()", "bug_description": "Scanner managed deployments have the deployment resource&apos;s &apos;persistent&apos; attribute set to &apos;false&apos;. This results in the StandaloneXml not persisting the resource to XML, but that depends on custom logic in StandaloneXml that reads the attribute.\nThe Resource for these deployments should return &apos;true&apos; from isRuntime() so callers can decided about this without needing internal knowledge of the resource attributes.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha8", "fixed_version": "1.0.0.Alpha10", "fixed_files": ["org.jboss.as.server.deployment.DeploymentAddHandlerTestCase.java", "org.jboss.as.server.parsing.StandaloneXml.java", "org.jboss.as.server.deployment.DeploymentAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 154, "bug_title": "Patching does not process subdirectories", "bug_description": "If patched resource is in subdirectory of moduleRoot, it is not included as part of patch, even though it is present in patch zip.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha9", "fixed_version": "1.0.0.Alpha10", "fixed_files": ["org.jboss.as.patching.runner.IdentityPatchContext.java"], "label": 1, "es_results": []}, {"bug_id": 205, "bug_title": "ManagedDMRContentTypeResource does not use a map with consistent ordering for storing content", "bug_description": "ManagedDMRContentTypeResource.content is used for generating an overall hash for the stored content, but it does not use consistent ordering (i.e. it needs to be a LinkedHashMap or perhaps a TreeMap.) The result is when another node in the domain receives an update it may calculate a different overall hash.\nThis is surfacing as failures in https://bugzilla.redhat.com/show_bug.cgi?id=1078062 when the master and slave are running on different JVM releases. Different VM releases often have different ordering behavior when iterating over the unordered collections.\nI believe this is unlikely to result in real-world problems since any backup will persist its own version of the hash to its local copy of domain.xml, so there won&apos;t be any mismatch. The importance of the overall hash is that it allows the process to find the content in the repo when it is added.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha10", "fixed_version": "1.0.0.Alpha11", "fixed_files": ["org.jboss.as.management.client.content.ManagedDMRContentTypeResource.java"], "label": 1, "es_results": []}, {"bug_id": 191, "bug_title": "Syslog reconnect timeout does not take effect at runtime", "bug_description": "", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha10", "fixed_version": "1.0.0.Alpha11", "fixed_files": ["org.jboss.as.domain.management.audit.SyslogAuditLogHandlerResourceDefinition.java", "org.jboss.as.controller.audit.AuditLogger.java", "org.jboss.as.controller.audit.ManagedAuditLogger.java", "org.jboss.as.controller.audit.ManagedAuditLoggerImpl.java"], "label": 1, "es_results": []}, {"bug_id": 190, "bug_title": "TLS syslog uses plain connection if no truststore or client-cert-store is configured", "bug_description": "", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha10", "fixed_version": "1.0.0.Alpha11", "fixed_files": ["org.jboss.as.controller.audit.SyslogAuditLogHandler.java"], "label": 1, "es_results": []}, {"bug_id": 207, "bug_title": "write- and undefine-attribute operations are registered as runtime-only", "bug_description": "The write-attribute and undefine-attribute operation are registered as runtime-only, which is not correct and was probably done unintentionally.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha10", "fixed_version": "1.0.0.Alpha12", "fixed_files": ["org.jboss.as.controller.operations.global.UndefineAttributeHandler.java", "org.jboss.as.controller.operations.global.WriteAttributeHandler.java"], "label": 1, "es_results": []}, {"bug_id": 233, "bug_title": "Subsystem ordering is lost during marshalling", "bug_description": "When standalone.xml gets persisted following some post-boot change, the original ordering of subsystems is lost. We don&apos;t want to change config files in this way.\nI don&apos;t recall how we retained the original subsystem ordering with parallel boot, but something there has broken.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha11", "fixed_version": "1.0.0.Alpha12", "fixed_files": ["org.jboss.as.controller.OperationContextImpl.java"], "label": 1, "es_results": []}, {"bug_id": 226, "bug_title": "DeploymentStatusHandler reads the model incorrectly", "bug_description": "DeploymentStatusHandler is calling Resource.Tools.readModel() to get the mode instead of the simple Resource.getModel().\nThis fails because the resource is runtime-only and Resource.Tools.readModel() ignore runtime-only.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha11", "fixed_version": "1.0.0.Alpha12", "fixed_files": ["org.jboss.as.server.deployment.DeploymentStatusHandler.java"], "label": 1, "es_results": []}, {"bug_id": 221, "bug_title": "Scanner deployments are getting persisted to standalone.xml", "bug_description": "Shouldn&apos;t happen.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha11", "fixed_version": "1.0.0.Alpha12", "fixed_files": ["org.jboss.as.controller.registry.BasicResource.java"], "label": 1, "es_results": []}, {"bug_id": 243, "bug_title": "Not started servers need a placeholder resource when added", "bug_description": "In ServerAddHandler where the server resource is created, a placeholder should be added. I.e. instead of context.createResource(...) below\n        context.addStep(runningServerAdd, new OperationStepHandler() {\n            @Override\n            public void execute(final OperationContext context, final ModelNode operation) throws OperationFailedException \n{\n\n                context.createResource(PathAddress.EMPTY_ADDRESS);\n\n                context.stepCompleted();\n\n            }\n        }, OperationContext.Stage.MODEL, true);\ncontext.addResource(PathAddress.EMPTY_ADDRESS, PlaceholderResource.INSTANCE) should be used instead. Otherwise, servers that are not started at boot will be missing runtime proxies and will be considered as parts of the persistent model.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha12", "fixed_version": "1.0.0.Alpha13", "fixed_files": ["org.jboss.as.host.controller.operations.ServerAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 268, "bug_title": "CLI GUI fails if connecting to AS7 or EAP6", "bug_description": "If you try to use a WildFly version CLI GUI to connect to AS7 or EAP6, you will get a failure.  The reason is because CLI GUI tries to do a list-log-files operation, which does not exist in those older AS versions.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha13", "fixed_version": "1.0.0.Alpha14", "fixed_files": ["org.jboss.as.cli.gui.ServerLogsPanel.java", "org.jboss.as.cli.gui.GuiMain.java"], "label": 1, "es_results": []}, {"bug_id": 210, "bug_title": "IO error during deployment scanning triggers undeployment", "bug_description": "If an IO error such as reaching the file descriptor limit occurs during deployment scanning, the scanner continues with an empty deployment list causing it to undeploy applications.\nThis occurs because FileSystemDeploymentService.scanDirectory() treats File.listFiles() returning null as an empty list rather than an error. http://docs.oracle.com/javase/7/docs/api/java/io/File.html#listFiles%28%29 notes that it returns an empty array if the directory is empty, and null if it is not a directory or an IO error occurs.\nIt should instead respond to a null return value by aborting the scanner run, with a log message, and not proceed to undeploy applications.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha10", "fixed_version": "1.0.0.Alpha14", "fixed_files": ["org.jboss.as.server.deployment.scanner.FileSystemDeploymentService.java", "org.jboss.as.server.deployment.scanner.FileSystemDeploymentServiceUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 213, "bug_title": "Clean unreferenced items from the content repository", "bug_description": "The algorithm for removing unused deployments from the content repository is based on doing this as part of undeploy operation execution. This doesn&apos;t cover cases where the content is never explicitly undeployed. For example:\n1) Scanner content that is updated when the server is offline; the old content will not have been \"undeployed\" during shutdown, and on startup the new content will be installed.\n2) Similar issues with deployments generated from module resources (see \"A Mixed Approach on https://community.jboss.org/wiki/ExtendingAS7). When the server shuts down, there is no \"subsystem remove\" as part of shutdown, so the content added during start will not be removed.\nNote that the content repository can include things other than deployments. Currently it also includes management-client-content (specifically rollout plans) and can potentially include anything. This is why it&apos;s a \"content repository\" and not a \"deployment repository.\" The solution for this needs to deal with all cases.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha19", "fixed_version": "1.0.0.Alpha14", "fixed_files": ["org.jboss.as.domain.controller.operations.deployment.DeploymentAddHandler.java", "org.jboss.as.host.controller.mgmt.ServerToHostProtocolHandler.java", "org.jboss.as.domain.controller.operations.ApplyRemoteMasterDomainModelHandler.java", "org.jboss.as.host.controller.model.host.HostResourceDefinition.java", "org.jboss.as.repository.LocalDeploymentFileRepository.java", "org.jboss.as.domain.controller.operations.deployment.DeploymentFullReplaceHandler.java", "org.jboss.as.host.controller.DomainModelControllerService.java", "org.jboss.as.domain.controller.operations.deployment.DeploymentRemoveHandler.java", "org.jboss.as.server.deploymentoverlay.DeploymentOverlayContentAdd.java", "org.jboss.as.domain.controller.operations.deployment.ServerGroupDeploymentReplaceHandler.java", "org.jboss.as.host.controller.RemoteDomainConnectionService.java", "org.jboss.as.server.logging.ServerLogger.java", "org.jboss.as.core.model.test.TestModelControllerService.java", "org.jboss.as.server.deployment.DeploymentFullReplaceHandler.java", "org.jboss.as.server.deployment.DeploymentAddHandlerTestCase.java", "org.jboss.as.repository.logging.DeploymentRepositoryLogger.java", "org.jboss.as.management.client.content.ManagedDMRContentTypeResource.java", "org.jboss.as.core.model.test.LegacyKernelServicesImpl.java", "org.jboss.as.domain.controller.operations.deployment.ServerGroupDeploymentAddHandler.java", "org.jboss.as.subsystem.test.TestModelControllerService.java", "org.jboss.as.server.controller.resources.ServerRootResourceDefinition.java", "org.jboss.as.server.deploymentoverlay.DeploymentOverlayContentDefinition.java", "org.jboss.as.repository.DeploymentFileRepository.java", "org.jboss.as.server.test.InterfaceManagementUnitTestCase.java", "org.jboss.as.host.controller.mgmt.MasterDomainControllerOperationHandlerImpl.java", "org.jboss.as.host.controller.HostControllerService.java", "org.jboss.as.domain.controller.operations.deployment.ServerGroupDeploymentRemoveHandler.java", "org.jboss.as.management.client.content.ManagedDMRContentTypeAddHandler.java", "org.jboss.as.repository.LocalFileRepository.java", "org.jboss.as.server.ApplicationServerService.java", "org.jboss.as.test.shared.ModelParserUtils.java", "org.jboss.as.host.controller.ManagedServerOperationsFactory.java", "org.jboss.as.domain.controller.resources.DomainRootDefinition.java", "org.jboss.as.server.deployment.DeploymentRemoveHandler.java", "org.jboss.as.domain.controller.resources.ServerGroupResourceDefinition.java", "org.jboss.as.repository.ContentRepository.java", "org.jboss.as.domain.controller.resources.DomainDeploymentResourceDefinition.java", "org.jboss.as.server.mgmt.domain.RemoteFileRepositoryService.java", "org.jboss.as.server.deployment.DeploymentReplaceHandler.java", "org.jboss.as.server.deployment.DeploymentAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 283, "bug_title": "SASL_SERVER and SASL_PROTOCOL options not being passed all the way to Remoting", "bug_description": "", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha13", "fixed_version": "1.0.0.Alpha14", "fixed_files": ["org.jboss.as.host.controller.operations.HttpManagementAddHandler.java", "org.jboss.as.host.controller.operations.NativeManagementAddHandler.java", "org.jboss.as.server.operations.HttpManagementAddHandler.java", "org.jboss.as.host.controller.operations.HttpManagementRemoveHandler.java", "org.jboss.as.server.operations.NativeManagementAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 286, "bug_title": "The SecurityRealmService should only perform a generic mapping to RealmUser if really required.", "bug_description": "If there is a more accurate way to calculate the RealmUser then use it.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha13", "fixed_version": "1.0.0.Alpha14", "fixed_files": ["org.jboss.as.domain.management.security.SecurityRealmService.java"], "label": 1, "es_results": []}, {"bug_id": 285, "bug_title": "cli tab completion gets confused by double slash", "bug_description": "Using two slashes in a CLI path and hitting TAB confuses the auto-completion", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha13", "fixed_version": "1.0.0.Alpha14", "fixed_files": ["org.jboss.as.cli.parsing.test.AddressOnlyParsingTestCase.java", "org.jboss.as.cli.operation.impl.DefaultOperationRequestParser.java", "org.jboss.as.cli.operation.CommandLineParser.java", "org.jboss.as.cli.operation.impl.DefaultCallbackHandler.java"], "label": 1, "es_results": []}, {"bug_id": 439, "bug_title": "Wrong format of IPv6 addresses in log entries", "bug_description": "IPv6 addresses in log files are in a wrong format, the [ ] are missing:\n\n\n\n\n\n\n09:18:44,203 INFO  [org.jboss.as] (Controller Boot Thread) JBAS015951: Admin console listening on http://2620:52:0:105f::ffff:2:9990\n\n\n\n\n\n\nIt should be:\n\n\n\n\n\n\nhttp://[2620:52:0:105f::ffff:2]:9990 \n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha13", "fixed_version": "1.0.0.Alpha14", "fixed_files": ["org.jboss.as.network.NetworkUtilsTestCase.java", "org.jboss.as.network.NetworkUtils.java", "org.jboss.as.server.BootstrapListener.java"], "label": 1, "es_results": []}, {"bug_id": 267, "bug_title": "CLI prints output twice if using cli client jar", "bug_description": "If you are using the CLI client jar, all output is printed twice.  This is because JBoss logging is not set up and by default CommandContextImpl is printing log messages to standard out.  The output will look something like this:\n\n\n\n\n\n\n[standalone@localhost:9999 /] :read-children-types\n\n\n\n\nNov 19, 2014 8:57:19 AM org.jboss.as.cli.impl.CommandContextImpl printLine\n\n\n\n\nINFO: {\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [\n\n\n\n\n        \"core-service\",\n\n\n\n\n        \"deployment\",\n\n\n\n\n        \"deployment-overlay\",\n\n\n\n\n        \"extension\",\n\n\n\n\n        \"interface\",\n\n\n\n\n        \"path\",\n\n\n\n\n        \"socket-binding-group\",\n\n\n\n\n        \"subsystem\",\n\n\n\n\n        \"system-property\"\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [\n\n\n\n\n        \"core-service\",\n\n\n\n\n        \"deployment\",\n\n\n\n\n        \"deployment-overlay\",\n\n\n\n\n        \"extension\",\n\n\n\n\n        \"interface\",\n\n\n\n\n        \"path\",\n\n\n\n\n        \"socket-binding-group\",\n\n\n\n\n        \"subsystem\",\n\n\n\n\n        \"system-property\"\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha13", "fixed_version": "1.0.0.Alpha14", "fixed_files": ["org.jboss.as.cli.CommandLineMain.java"], "label": 1, "es_results": []}, {"bug_id": 438, "bug_title": "The CLI freezes in phase of requesting username/password", "bug_description": "CLI doesn&apos;t terminate ", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha13", "fixed_version": "1.0.0.Alpha15", "fixed_files": ["org.jboss.as.cli.impl.CLIModelControllerClient.java"], "label": 1, "es_results": []}, {"bug_id": 451, "bug_title": "ResolveExpressionHandler is overly simplistic in expression resolution", "bug_description": "ResolveExpressionHandler deliberately does not make use of the full range of expression resolutions sources, because by design the intent is not to support vault resolution.\nHowever, the way it implements that limitation is by simply calling ModelNode.resolve(). That is overly restrictive, as DMR alone does not support other valid resolution features, i.e. nested expressions and recursive resolution.\nFix is to switch the handler to use an ExpressionResolver impl, just one that doesn&apos;t plug in the vault resolver.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha14", "fixed_version": "1.0.0.Alpha15", "fixed_files": ["org.jboss.as.controller.ExpressionResolver.java", "org.jboss.as.controller.operations.common.ResolveExpressionHandler.java", "org.wildfly.core.test.standalone.mgmt.api.core.ResolveExpressionTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 492, "bug_title": "fix JMX ObjectNameAddressUtil#toPathAddress", "bug_description": "The code in ObjectNameAddressUtil#toPathAddress is wrong: it must look for the childAddress&apos;s submodel, not the address of the registry itself.\nThe current code fails with the exception:\norg.jboss.as.controller._private.OperationFailedRuntimeException: WFLYCTL0071: Duplicate path element &apos;subsystem&apos; found [ \"WFLYCTL0071: Duplicate path element &apos;subsystem&apos; found\" ]", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Alpha16", "fixed_files": ["org.jboss.as.jmx.model.ObjectNameAddressUtilTestCase.java", "org.jboss.as.jmx.model.ObjectNameAddressUtil.java"], "label": 1, "es_results": []}, {"bug_id": 497, "bug_title": "OperationStepHandlers for audit log handler add ops prematurely validate", "bug_description": "SyslogAuditLogHandlerAddHandler and FileAuditLogHandlerAddHandler are doing reference validation directly in populateModel. This should instead be done in a separate step, removing the requirement to have the add op for the formatter occur before the add op for the handler, so long as both ops occur within the set of ops handled by the same OperationContext.\nThis will simplify booting from a filesystem tree instead of xml, removing the need to persist ordering information about formatter/handler in the FS.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Alpha16", "fixed_files": ["org.jboss.as.domain.management.audit.FileAuditLogHandlerResourceDefinition.java", "org.jboss.as.domain.management.audit.SyslogAuditLogHandlerResourceDefinition.java", "org.jboss.as.domain.management.audit.HandlerUtil.java"], "label": 1, "es_results": []}, {"bug_id": 501, "bug_title": "ServerGroupAddHandler should add a separate step to validate profile and socket-binding-group refs", "bug_description": "Validating references directly will imply specific ordering, in this case profile and socket-binding-group will have to be added before this handler executes. Postponing the validation to the next step will remove such a requirement.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Alpha16", "fixed_files": ["org.jboss.as.domain.controller.operations.ServerGroupAddHandler.java", "org.jboss.as.domain.controller.operations.ServerGroupAffectedResourceServerGroupOperationsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 507, "bug_title": " Unit test FileSystemDeploymentServiceUnitTestCase fails on IBM JDK ", "bug_description": "Always on IBM JDK org.jboss.as.server.deployment.scanner.FileSystemDeploymentServiceUnitTestCase.testNoUndeployment fails with:\n\njava.net.ConnectException: Connection refused\njava.lang.UnsupportedOperationException: cannot get the capability, performing dispose of the retransforming environment\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Alpha16", "fixed_files": ["org.jboss.as.patching.tests.PatchModuleInvalidationWithRenamingFailureTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 500, "bug_title": "domain mode: remove a path entry from a server instance fails", "bug_description": "Adding a \"path\" to a \"server-config\" in domain mode (works fine) and then remove it again results in a NullPointerException", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Alpha16", "fixed_files": ["org.jboss.as.controller.services.path.PathRemoveHandler.java"], "label": 1, "es_results": []}, {"bug_id": 504, "bug_title": "RBAC does not let server-group scoped roles read all hosts", "bug_description": "The RBAC implementation is not allowing a server-group scoped role to read resources in the host=* tree unless one of these is true:\n1) the host only contains a server mapped to the server group\n2) the host doesn&apos;t contain any servers.\nThis is consistent with handling of other \"mappable\" things but is contrary to the docs, which declare\n\"In addition to these privileges, users in a server-group scoped role will have non-sensitive read privileges (equivalent to the Monitor role) for resources other than those listed above.\"\nbut don&apos;t list these host resources.\nIt&apos;s also unintuitive, as the s-g-s-r is actually allowed to add a server on the host, but can&apos;t read the other host resources before doing so.\nAlso, asking the DC for the list of host names will include the host, but trying to read its root resource will result in a NoSuchResourceException.\nThe issue dates back to 8.0, but recent changes to the console have resulted in this breaking console behavior.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Alpha16", "fixed_files": ["org.jboss.as.test.integration.domain.rbac.AbstractServerGroupScopedRolesTestCase.java", "org.jboss.as.controller.access.constraint.ServerGroupEffectConstraint.java", "org.jboss.as.controller.access.HostEffect.java", "org.jboss.as.controller.HostServerGroupTracker.java"], "label": 1, "es_results": []}, {"bug_id": 503, "bug_title": "Child resources under the deployment=XXX resource should be marked as runtime-only", "bug_description": "Underneath a deployment resource there can be a large tree of runtime-only resources. Those resources are not getting the correct value for their isRuntime() property.\nDeploymentModelUtils.getOrCreate() should call Resource.Factory.create(true) instead of just Resource.Factory.create().\nNote this may break the console if it is doing a recursive read of deployment resources and not including the include-runtime=true param.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Alpha16", "fixed_files": ["org.jboss.as.subsystem.test.SubsystemTestDelegate.java", "org.jboss.as.controller.registry.ManagementResourceRegistration.java", "org.jboss.as.controller.logging.ControllerLogger.java", "org.jboss.as.controller.registry.AbstractResourceRegistration.java", "org.jboss.as.controller.registry.DelegatingManagementResourceRegistration.java", "org.jboss.as.controller.extension.ExtensionRegistry.java", "org.jboss.as.server.deployment.DeploymentModelUtils.java"], "label": 1, "es_results": []}, {"bug_id": 513, "bug_title": "ConfigurationFile does invalid reload when special config file names are specified", "bug_description": "ConfigurationFile records the value passed by -c or --[server|host|domain]-config and uses it to determine the boot file to use whenever it needs to boot. This is ok during initial boot, but it reuses it during reloads.\nThis breaks down when specials values like \"initial\", \"boot\", \"v1\" or some snapshot are used. The reload ends up reading from the original file again, not from the latest persisted one, and any changes made are lost.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Alpha16", "fixed_files": ["org.jboss.as.controller.persistence.ConfigurationFile.java"], "label": 1, "es_results": []}, {"bug_id": 514, "bug_title": "ConfigurationFile.snapshot() stores the wrong file when config persistence is disabled", "bug_description": "ConfigurationFile.snapshot() always uses mainFile as the source of the snapshot, but when --read-only-server-config and the domain equivalents are used, that file isn&apos;t updated as config changes are made. In this case lastFile should be used.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Alpha16", "fixed_files": ["org.jboss.as.controller.persistence.ConfigurationFile.java"], "label": 1, "es_results": []}, {"bug_id": 505, "bug_title": "Fix double redeployment due to .failed file and a artifact with newer timestamp.", "bug_description": "Issue found and described in https://bugzilla.redhat.com/show_bug.cgi?id=1169239\nsteps to reproduce:\n1. deploy a \"Test.war\"\n2. Change something in \"Test.war\" to fail it.\n3. \"Test.war.failed\" file will be created.\n4. stop JBoss EAP.\n5. Revert the changes done in \"Test.war\" so that it will deploy successfully. \n6. Now there are two files (\"Test.war.failed\" and \"Test.war\", due to correction, Test.war must have a newer timestamp than Test.war.failed)in deployment directory. \n7. Restart JBoss EAP, it will fail with below Error :\nThe problem happens as a result of redundant redeployment in next reboot. During servert reboot, it will try to redeploy the application due to found .failed file, it also will try to redeploy same application because Test.war has a newer timestamp to see the problem. This will cause server startup failure as:\n\n\n\n\n\n\nERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool -- 18) JBAS014613: Operation (\"add\") failed - address: ([(\"deployment\" => \"Test.war\")]) - failure description: \"JBAS014803: Duplicate resource [(\\\"deployment\\\" => \\\"Test.war\\\")]\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Beta5", "fixed_files": ["org.jboss.as.server.deployment.scanner.FileSystemDeploymentService.java"], "label": 1, "es_results": []}, {"bug_id": 495, "bug_title": "WFLY will not startup due to \"WFLYCTL0212: Duplicate resource [(\\\"deployment\\\" => \\\"xxx.war\\\")]\"", "bug_description": "WFLY won&apos;t startup due to \"WFLYCTL0212: Duplicate resource [(\\\"deployment\\\" => \\\"xxx.war\\\")]\"\nIf you firstly deploy a .war application by CLI command, then deploy 2nd time same .war application by copying it to /depolyment directory. After server restart, it shows:\n\n\n\n\n\n\n15:26:26,913 INFO  [org.jboss.as] (MSC service thread 1-8) WFLYSRV0049: WildFly Full 9.0.0.Alpha2-SNAPSHOT (WildFly Core 1.0.0.Alpha15) starting\n\n\n\n\n15:26:27,133 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (\"add\") failed - address: ([(\"deployment\" => \"xxx.war\")]) - failure description: \"WFLYCTL0212: Duplicate resource [(\\\"deployment\\\" => \\\"xxx.war\\\")]\"\n\n\n\n\n15:26:27,136 FATAL [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0056: Server boot has failed in an unrecoverable manner; exiting. See previous messages for details.\n\n\n\n\n15:26:27,138 INFO  [org.jboss.as.server] (Thread-2) WFLYSRV0220: Server shutdown has been requested.\n\n\n\n\n15:26:27,153 INFO  [org.jboss.as] (MSC service thread 1-1) WFLYSRV0050: WildFly Full 9.0.0.Alpha2-SNAPSHOT (WildFly Core 1.0.0.Alpha15) stopped in 4ms\n\n\n\n\n\n\nsteps to reproduce:\n1. start wildfly and deploy a .war application by CLI.\n2. copy same .war application to /deployment directory\n3. restart wildfly to see the error message. \nThis happens because step 2 does a \"full-replace-deployment\" operation which does not remove content from standalone/data/content/aa/2d0425dd53572294d591b56efdee2680539eaf/content and deployment info from configuration file(standalone.xml). Therefore, you will have xxx.war in standalone/data/content and configuration file(standalone.xml), also a xxx.war and xxx.war.deployed file inside /standalone/deployments. A second time server restart will cause a duplicate resource error.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Alpha16", "fixed_files": ["org.jboss.as.server.deployment.DeploymentFullReplaceHandler.java"], "label": 1, "es_results": []}, {"bug_id": 499, "bug_title": "System properties are broken in domain mode", "bug_description": "There seems to be some weirdness in how system properties are being propagated to domain mode servers, and in many cases they are not being applied. \nThis appears to be an issue with the boot time handling of system properties.\nThe only way I could get the property to be applied was to start the server first, then add the property using boot-time=false, although even in this case the property will disappear if the domain is restarted or the server is reloaded. \n", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Alpha17", "fixed_files": ["org.jboss.as.test.integration.domain.suites.CoreResourceManagementTestCase.java", "org.jboss.as.server.operations.SystemPropertyAddHandler.java", "org.jboss.as.server.controller.resources.SystemPropertyResourceDefinition.java", "org.jboss.as.host.controller.ManagedServerBootCmdFactory.java"], "label": 1, "es_results": []}, {"bug_id": 534, "bug_title": "Deployment scanner runtime-failure-causes-rollback attribute is not stored to the model", "bug_description": "The runtime-failure-causes-rollback is never stored to the model in the add op.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha16", "fixed_version": "1.0.0.Alpha17", "fixed_files": ["org.jboss.as.server.deployment.scanner.DeploymentScannerDefinition.java", "org.jboss.as.server.deployment.scanner.DeploymentScannerParsingTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 541, "bug_title": "Bad equals test in WFLY-3306 fix", "bug_description": "GlobalOperationHandler L458 has this:\n\n\n\n\n\n\nif ((validChildType == null || validChildType.equals(validChildType))\n\n\n\n\n\n\nThe second test is silly; should be using var &apos;type&apos;.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha17", "fixed_version": "1.0.0.Alpha18", "fixed_files": ["org.jboss.as.controller.operations.global.GlobalOperationHandlers.java"], "label": 1, "es_results": []}, {"bug_id": 545, "bug_title": "Inconsistent stage for adding/updating/removing system properties", "bug_description": "SystemPropertyAddHandler and SystemPropertyValueWriteAttributeHandler both update the VM property map during Stage.MODEL, while SystemPropertyRemoveHandler waits until Stage.RUNTIME.\nThis can lead to unintuitive behavior in a composite op, e.g. if a user does a remove and then an add in a batch to change the value. The remove will actually update the runtime after the add, resulting in the prop being unset.\nThe SystemPropertyAddHandler and SystemPropertyValueWriteAttributeHandler behavior is non-standard as they change non-model information in Stage.MODEL, but that was done deliberately (I forget exactly why.) So the fix should be to adapt SystemPropertyRemoveHandler.\nThis is minor because the remove + add in a composite workflow is a harder-to-use alternative to using a single write-attribute op.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha18", "fixed_version": "1.0.0.Alpha19", "fixed_files": ["org.jboss.as.server.operations.SystemPropertyRemoveHandler.java", "org.wildfly.core.test.standalone.mgmt.BasicOperationsUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 536, "bug_title": "Sanitize origins  ports in CORS", "bug_description": "When checking the origins we should remove the port if the port is the default one so that we ensure we have a correct matching", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha17", "fixed_version": "1.0.0.Alpha19", "fixed_files": ["org.jboss.as.domain.http.server.cors.CorsHttpHandler.java", "org.jboss.as.domain.http.server.cors.CorsUtil.java", "org.jboss.as.domain.http.server.DomainApiCheckHandler.java"], "label": 1, "es_results": []}, {"bug_id": 566, "bug_title": "space- and comma-separated attribute marshaller are broken", "bug_description": "The AttributeMarshaller&apos;s STRING_LIST and COMMA_STRING_LIST are broken as they override marshallAsElement while it&apos;s their marshallAsAttribute method (inherited from DefaultAttributeMarshaller) that is called.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha19", "fixed_version": "1.0.0.Beta1", "fixed_files": ["org.jboss.as.domain.management.parsing.ManagementXml.java", "org.jboss.as.controller.SimpleListAttributeDefinitionUnitTestCase.java", "org.jboss.as.server.parsing.StandaloneXml.java", "org.jboss.as.controller.AttributeMarshaller.java", "org.jboss.as.host.controller.parsing.HostXml.java", "org.jboss.as.domain.management.security.KeytabResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 567, "bug_title": "Invoking shutdown command for slave HC results in CLI disconnecting", "bug_description": "Connect the CLI to the master in a domain with a slave HC and shut down the slave. CLI disconnects:\n\n\n\n\n\n\n[domain@localhost:9990 /] shutdown --host=slave\n\n\n\n\n[disconnected /]\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha19", "fixed_version": "1.0.0.Beta1", "fixed_files": ["org.jboss.as.cli.handlers.ShutdownHandler.java"], "label": 1, "es_results": []}, {"bug_id": 564, "bug_title": "setXmlWrapperElement() does not work properly with multiple resource children", "bug_description": "\n\n\n\n\n\nJeff Mesnil 12:13 @ctomc hi tomaz. The setXmlWrapperElement() method in persistent xml builder API is supposed to add a XML wrapper around all the resource&apos;s XML elements, right? and not around each resource element.\n\n\n\n\nie it looks like <wrapper><res /><res /></wrapper> and not <wrapper><res /></wrapper><wrapper><res /></wrapper>\n\n\n\n\nTomaz Cerar 12:17 hmm, you are right also around resources\n\n\n\n\nit would be <wrapper> <res /> <res/> </wrapper>\n\n\n\n\njust remembered i had that in 1.0 xsd of undertow subsystem\n\n\n\n\nJeff Mesnil 12:20 yes, I want to wrap some resources (eg queue) in a wrapper (<queues>). But the persistent XM parser is broken (it wants one wrapper around each resource)\n\n\n\n\nthe XML persister is working as expected though\n\n\n\n\nTomaz Cerar @jmesnil you are right it is broken, i can reproduce it also on undertow-1.0.xml test case\n\n\n\n\ni just had one resource under it so it passed\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha19", "fixed_version": "1.0.0.Beta1", "fixed_files": ["org.jboss.as.controller.persistence.PersistentResourceXMLParserTestCase.java", "org.jboss.as.controller.PersistentResourceXMLDescription.java"], "label": 1, "es_results": []}, {"bug_id": 553, "bug_title": "ModelControllerClientOperationHandler does not manage the clientRequestExecutor properly ", "bug_description": "ModelControllerClientOperationHandler&apos;s constructor creates a ThreadPoolExecutor for handling client requests and then the class doesn&apos;t clean it up.\nIn addition, an instance of ModelControllerClientOperationHandler is created per channel, not one per ModelControllerClientOperationHandlerFactoryService. I know I at least thought of the thread pool as being per remote management interface, not per channel.\nMaking it be per ModelControllerClientOperationHandlerFactoryService and cleaning it up in that service&apos;s stop would be the easiest fix, but the pool settings may not be appropriate if we do that, so tread carefully.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha1", "fixed_version": "1.0.0.Beta1", "fixed_files": ["org.jboss.as.controller.remote.ModelControllerClientOperationHandler.java", "org.jboss.as.controller.ModelControllerClientTestCase.java", "org.jboss.as.controller.remote.AbstractModelControllerOperationHandlerFactoryService.java", "org.jboss.as.host.controller.mgmt.MasterDomainControllerOperationHandlerService.java", "org.jboss.as.controller.remote.ModelControllerClientOperationHandlerFactoryService.java"], "label": 1, "es_results": []}, {"bug_id": 581, "bug_title": "CLI accepts operation requests with addresses ending on resource types", "bug_description": "It doesn&apos;t concern the tab-completion. But if the address is entered manually and ends on a resource type, the generated operation request will target the parent resource.\n[standalone@localhost:9999 /] echo-dmr /subsystem=logging/file-handler=:remove\n{\n\n    \"address\" => [(\"subsystem\" => \"logging\")],\n\n    \"operation\" => \"remove\"\n\n}", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha19", "fixed_version": "1.0.0.Beta1", "fixed_files": ["org.jboss.as.cli.parsing.test.OperationParsingTestCase.java", "org.jboss.as.cli.operation.CommandLineParser.java", "org.jboss.as.cli.operation.impl.DefaultCallbackHandler.java"], "label": 1, "es_results": []}, {"bug_id": 623, "bug_title": "ModelControllerClient.Factory lacks some variants", "bug_description": "In the ModelControllerClient.Factory class, each factory method in fact has two varians: with a protocol as a first parameter, and without it. There are two exceptions  two methods are lacking a protocol-less variant:\n\nModelControllerClient create(final String protocol, final String hostName, final int port, final CallbackHandler handler, final SSLContext sslContext, final int connectionTimeout, final Map<String, String> saslOptions)\nModelControllerClient create(final String protocol, final String hostName, final int port, final CallbackHandler handler, final SSLContext sslContext, final int connectionTimeout, final Map<String, String> saslOptions, final String clientBindAddress)\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Beta2", "fixed_version": "1.0.0.Beta4", "fixed_files": ["org.jboss.as.controller.client.ModelControllerClient.java"], "label": 1, "es_results": []}, {"bug_id": 489, "bug_title": "The \"access-mechanism\" field in the active-operation resources is always undefined", "bug_description": "The \"access-mechanism\" field in core-service=management/service=active-operations/active-operation=* is always undefined. The code that sets it is using the wrong var:\n\n\n\n\n\n\nModelNode accessMechanismNode = model.get(ACCESS_MECHANISM);\n\n\n\n\nif (accessMechanism != null) {\n\n\n\n\n    accessMechanismNode.set(accessMechanismNode.toString());\n\n\n\n\n}\n\n\n\n\n\n\nIt should be accessMechanism.toString()", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha15", "fixed_version": "1.0.0.Beta4", "fixed_files": ["org.jboss.as.controller.OperationContextImpl.java"], "label": 1, "es_results": []}, {"bug_id": 638, "bug_title": "deployment runtime-name mismatch between content repo and server-group and logs", "bug_description": "We are continuously deploying web applications (wars) into our wildfly domain as part of our continuous deployment driven by Bamboo.\nEach time an application build succeeds it will trigger a deployment to our wildfly domain.\nIf this is the first deployment we run this command.\n\n\n\n\n\n\njboss-cli.sh --connect --controller=somehost:9990 --user=admin --password=admin --command=\"deploy app-0.1-SNAPSHOT.war --name=app.war --runtime-name=app-0.1-SNAP\\\n\n\n\n\nSHOT-b1.war --server-groups=A\n\n\n\n\n\n\nFor subsequent deployments we force a redeploy over existing deployment.\n\n\n\n\n\n\njboss-cli.sh --connect --controller=somehost:9990 --user=admin --password=admin --command=\"deploy app-0.1-SNAPSHOT.war --name=app.war --runtime-name=app-0.1-SNAP\\\n\n\n\n\nSHOT-b2.war --force\n\n\n\n\njboss-cli.sh --connect --controller=somehost:9990 --user=admin --password=admin --command=\"deploy app-0.1-SNAPSHOT.war --name=app.war --runtime-name=app-0.1-SNAP\\\n\n\n\n\nSHOT-b3.war --force\n\n\n\n\njboss-cli.sh --connect --controller=somehost:9990 --user=admin --password=admin --command=\"deploy app-0.1-SNAPSHOT.war --name=app.war --runtime-name=app-0.1-SNAP\\\n\n\n\n\nSHOT-before.war --force\n\n\n\n\netc....\n\n\n\n\n\n\nSince upgrading to WildFly 8.2.0 we see a strange behaviour in the domain management web console (http://somehost:9990/console/App.html#domain-deployments).\nThe application runtime name in content repository is not the same as what is shown in the server group.\nI will attach screenshots for an app named apollo.war. You will see from the screenshots that the content repository shows runtime name=apollo-0.1.12-SNAPSHOT-11\\\n03.war, but the\nserver group shows runtime-name=apollo-0.1.12-SNAPSHOT-1045.war. (The last number in runtime-name is the build number from bamboo)\nThe server.logs from wildfly show \"Deployed \"apollo.war\" (runtime-name : \"apollo-0.1.12-SNAPSHOT-1045.war\")\"\nHowever, we can tell by app capabilities that what is really deployed is apollo-0.1.12-SNAPSHOT-1103.war.\nWe are totally confused by this discrepency.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Beta3", "fixed_version": "1.0.0.Beta4", "fixed_files": ["org.jboss.as.domain.controller.operations.deployment.DeploymentFullReplaceHandler.java"], "label": 1, "es_results": []}, {"bug_id": 619, "bug_title": "HostControllerExecutionSupport.MultiStepOpExecutionSupport does not format nested composites correctly", "bug_description": "The getFormattedDomainResult isn&apos;t processing nested composites correctly. It takes the response for the top level step and passes it into the HostControllerExecutionSupport for that step. That&apos;s fine for the simple response variants of HostControllerExecutionSupport, which just return the passed in node. But it fails if the support for that step is in turn MultiStepOpExecutionSupport, as it is expecting a response node&apos;s &apos;result&apos; child, not the outer response node itself.\nSolution is to detect this, clone the outer response node, and pass it&apos;s &apos;result&apos; child into the child MultiStepOpExecutionSupport, replacing the outer response node&apos;s &apos;result&apos; with the return value.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Beta2", "fixed_version": "1.0.0.Beta4", "fixed_files": ["org.jboss.as.domain.controller.operations.coordination.HostControllerExecutionSupport.java"], "label": 1, "es_results": []}, {"bug_id": 627, "bug_title": "Response headers do not propagate through the domain", "bug_description": "There&apos;s no access-control response header here:\n\n\n\n\n\n\n[domain@localhost:9999 /] /host=master/server=server-one/subsystem=datasources/data-source=ExampleDS:read-resource{roles=Monitor}\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => {\n\n\n\n\n        ....\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nProxyStepHandler needs to pass through response-header data.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Beta2", "fixed_version": "1.0.0.Beta4", "fixed_files": ["org.jboss.as.controller.ProxyStepHandler.java"], "label": 1, "es_results": []}, {"bug_id": 626, "bug_title": "Global list-get operation can inadvertently create list elements", "bug_description": "Consider the following sequence of operations:\n\n:list-clear(name=attribute)\n:list-get(name=attribute, index=0)\n:list-add(name=attribute, value=test)\n:list-get(name=attribute, index=0)\n\n#2 will return <undefined> as expected.  The expected result of #4 is \"test\".  However, it returns <undefined>.  This is because #2 will create the missing element at index 0 causing #3 to operate on index 1.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Beta2", "fixed_version": "1.0.0.Beta6", "fixed_files": ["org.jboss.as.controller.operations.global.MapOperations.java", "org.jboss.as.controller.operations.global.ListOperations.java"], "label": 1, "es_results": []}, {"bug_id": 580, "bug_title": "Recursive read-resource with include-runtime=true assumes all runtime singleton resources will be present.", "bug_description": "Take the following hierarchy: -\n\n\n\n\n\n\nkeystore=xxx\n\n\n\n\n    alias=yyy\n\n\n\n\n        certificate-chain=default\n\n\n\n\n        certificate-chain=x509\n\n\n\n\n\n\nkeystore is a regular resource with storage=configuration.\nalias is a regular resource with storage=runtime\ncertificate-chain=default and certificate-chain=x509 are regular resources with storage=runtime.\nSo alias represents a single alias from a Java KeyStore, this may or may not have a certificate chain and it may be a default chain or it may be an x509 chain.\nThe recursive read-resource is fine with regular resources such as alias as it has to rely on the underlying resource implementation to identify the instances that actually exist.\nFor the singleton resources however the following method is called: -\n\n\n\n\n\n\norg.jboss.as.controller.operations.global.GlobalOperationHandlers.getChildAddresses(OperationContext, PathAddress, ImmutableManagementResourceRegistration, Resource, String)\n\n\n\n\n\n\nWithin this method the following check takes place: -\n\n\n\n\n\n\n                if (resource != null && resource.hasChildren(childType)) {\n\n\n\n\n                    Set<String> childNames = resource.getChildrenNames(childType);\n\n\n\n\n                    if (element.isWildcard()) {\n\n\n\n\n                        set.addAll(childNames);\n\n\n\n\n                    } else if (childNames.contains(element.getValue())) {\n\n\n\n\n                        set.add(element.getValue());\n\n\n\n\n                    }\n\n\n\n\n\n\nUp to this point all is fine, the children the resource claims are available are the only ones added.\nBut further down this happens: -\n\n\n\n\n\n\n            if (!element.isWildcard()) {\n\n\n\n\n                ImmutableManagementResourceRegistration childReg = registry.getSubModel(PathAddress.pathAddress(element));\n\n\n\n\n                if (childReg != null && childReg.isRuntimeOnly()) {\n\n\n\n\n                    set.add(element.getValue());\n\n\n\n\n                }\n\n\n\n\n            }\n\n\n\n\n\n\nSo even though the resource was previously checked and missing children excluded they are now added back.\nThe end result in this example is that the recursive read resource attempts to read for certificate-chain=default when it should only be reading for certificate-chain=x509 as already reported by the resource implementation.\nFrom a discussion in HipChat yesterday there was general agreement this behaviour seems to be wrong, however support for Proxied resources may be (incorrectly) dependent on this.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha19", "fixed_version": "1.0.0.Beta5", "fixed_files": ["org.jboss.as.controller.test.ReadResourceWithRuntimeResourceTestCase.java", "org.jboss.as.controller.operations.global.GlobalOperationHandlers.java"], "label": 1, "es_results": []}, {"bug_id": 625, "bug_title": "Error message in CLI if extension existing on the server is not present in the CLI instalaltion", "bug_description": "When using the jboss-cli from a WildFly-Core installation to manage a WildFly Full server you get error messages about missing extensions :\nErrors caught while loading extensions:\n1) Failed to load module org.jboss.as.clustering.infinispan for extension org.jboss.as.clustering.infinispan: org.jboss.as.clustering.infinispan:main\n2) Failed to load module org.jboss.as.connector for extension org.jboss.as.connector: org.jboss.as.connector:main\n3) Failed to load module org.jboss.as.ee for extension org.jboss.as.ee: org.jboss.as.ee:main\n4) Failed to load module org.jboss.as.ejb3 for extension org.jboss.as.ejb3: org.jboss.as.ejb3:main\n5) Failed to load module org.jboss.as.jaxrs for extension org.jboss.as.jaxrs: org.jboss.as.jaxrs:main\n6) Failed to load module org.jboss.as.jdr for extension org.jboss.as.jdr: org.jboss.as.jdr:main\n7) Failed to load module org.jboss.as.jpa for extension org.jboss.as.jpa: org.jboss.as.jpa:main\n8) Failed to load module org.jboss.as.jsf for extension org.jboss.as.jsf: org.jboss.as.jsf:main\n9) Failed to load module org.jboss.as.mail for extension org.jboss.as.mail: org.jboss.as.mail:main\n10) Failed to load module org.jboss.as.naming for extension org.jboss.as.naming: org.jboss.as.naming:main\n11) Failed to load module org.jboss.as.pojo for extension org.jboss.as.pojo: org.jboss.as.pojo:main\n12) Failed to load module org.jboss.as.sar for extension org.jboss.as.sar: org.jboss.as.sar:main\n13) Failed to load module org.jboss.as.security for extension org.jboss.as.security: org.jboss.as.security:main\n14) Failed to load module org.jboss.as.transactions for extension org.jboss.as.transactions: org.jboss.as.transactions:main\n15) Failed to load module org.jboss.as.webservices for extension org.jboss.as.webservices: org.jboss.as.webservices:main\n16) Failed to load module org.jboss.as.weld for extension org.jboss.as.weld: org.jboss.as.weld:main\n17) Failed to load module org.wildfly.extension.batch for extension org.wildfly.extension.batch: org.wildfly.extension.batch:main\n18) Failed to load module org.wildfly.extension.bean-validation for extension org.wildfly.extension.bean-validation: org.wildfly.extension.bean-validation:main\n19) Failed to load module org.wildfly.extension.security.manager for extension org.wildfly.extension.security.manager: org.wildfly.extension.security.manager:main\n20) Failed to load module org.wildfly.extension.undertow for extension org.wildfly.extension.undertow: org.wildfly.extension.undertow:main", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Beta2", "fixed_version": "1.0.0.Beta5", "fixed_files": ["org.jboss.as.cli.embedded.EmbedServerHandler.java", "org.jboss.as.cli.impl.CommandContextImpl.java", "org.jboss.as.cli.impl.ExtensionsLoader.java"], "label": 1, "es_results": []}, {"bug_id": 114, "bug_title": "Get RuntimeVaultReader into WildFly Core", "bug_description": "The only real implementation of AbstractVaultReader isn&apos;t in wildfly-core; it&apos;s in the wildfly-full security subsystem module.\nThis means WildFly Core currently doesn&apos;t really support vault expressions.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha8", "fixed_version": "1.0.0.CR2", "fixed_files": ["org.jboss.as.host.controller.DomainModelControllerService.java", "org.jboss.as.server.ApplicationServerService.java", "org.jboss.as.server.logging.ServerLogger.java"], "label": 1, "es_results": []}, {"bug_id": 677, "bug_title": "Remove the \"bundle\" notion from WildFly Core embedded module", "bug_description": "The EmbeddedServerFactory create API includes the bundle path notion copied over from AS7. I don&apos;t want this in the WildFly Core API as we have no real support for the concept.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR1", "fixed_version": "1.0.0.CR2", "fixed_files": ["org.wildfly.core.embedded.EmbeddedStandAloneServerFactory.java", "org.wildfly.core.embedded.EmbeddedServerFactory.java", "org.jboss.as.cli.embedded.EmbedServerHandler.java"], "label": 1, "es_results": []}, {"bug_id": 681, "bug_title": "Incorrectly timeout values in ControllerLogger method timeoutCompletingOperation and ControllerMessages method serviceInstallTimedOut", "bug_description": "Incorrectly scaled timeout value passed to org.jboss.as.controller.ControllerLogger method timeoutCompletingOperation and org.jboss.as.controller.ControllerMessages method serviceInstallTimedOut\nparameter value is ms, second is expected. ", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR1", "fixed_version": "1.0.0.CR2", "fixed_files": ["org.jboss.as.controller.OperationContextImpl.java"], "label": 1, "es_results": []}, {"bug_id": 676, "bug_title": "data-source ..  --new-connection-sql  does not allow double qoutes in the SQL", "bug_description": "Setting an SQL statement with double quotes in it from the CLI is not possible:\ndata-source --name=ExampleDS --new-connection-sql=\"set role test identified by \\\"password\\\"\"", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR1", "fixed_version": "1.0.0.CR2", "fixed_files": ["org.jboss.as.cli.parsing.command.ArgumentValueState.java", "org.jboss.as.cli.parsing.test.CommandTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 684, "bug_title": "CompositeIndexProcessor uses wrong module loader to load external annotation indexes", "bug_description": "", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR2", "fixed_version": "1.0.0.CR3", "fixed_files": ["org.jboss.as.server.deployment.annotation.CompositeIndexProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 687, "bug_title": "patches with duplicate element patch-id values should be rejected", "bug_description": "Patches that contain duplicate patch-id attribute values in &apos;element&apos; elements in patch.xml can be applied but can&apos;t be rolled back.  An attempt to rollback such a patch will result in an error \"Content loader already registered for patch \" + patchID, thrown from IdentityPatchContext.recordContentLoader(patchID, contentLoader).\nCurrent implementation should reject patches with duplicate element patch-id values (unless the value is &apos;base&apos;).\nAdding support for duplicate element patch-id values is a more difficult task at this point. If we decide to support it after all, it&apos;ll be implemented under a different issue.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR2", "fixed_version": "1.0.0.CR4", "fixed_files": ["org.jboss.as.patching.installation.LayerTestCase.java", "org.jboss.as.patching.metadata.PatchXmlUnitTestCase.java", "org.jboss.as.patching.metadata.PatchXml.java", "org.jboss.as.patching.metadata.PatchBuilder.java", "org.jboss.as.patching.logging.PatchLogger.java", "org.jboss.as.patching.metadata.PatchXmlUtils.java"], "label": 1, "es_results": []}, {"bug_id": 694, "bug_title": "Redeploy operation fails on deployments from the deployment scanner", "bug_description": "An application is deployed via deployment scanner.\nOn an attempt to redeploy it via jboss-cli the following error is displayed:\n\n\n\n\n\n\n[standalone@localhost:9990 deployment=sample.war] :redeploy\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"WFLYCTL0155: runtime-name may not be null\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR4", "fixed_version": "1.0.0.CR5", "fixed_files": ["org.jboss.as.server.deployment.DeploymentRedeployHandler.java"], "label": 1, "es_results": []}, {"bug_id": 692, "bug_title": "read-children-names(include-aliases=true) can return phantom results", "bug_description": "If another resource exists with the same key as the target address of a resource alias, the read-children-names(include-aliases=true) operation can return phantom results.\nHere&apos;s an example:\nI have a alias registered that translates:\n\n\n\n\n\n\n/subsystem=infinispan/cache-container=*/local-cache=*/file-store=FILE_STORE\n\n\n\n\n\n\nto:\n\n\n\n\n\n\n/subsystem=infinispan/cache-container=*/local-cache=*/store=file\n\n\n\n\n\n\nAdditionally, I have a resource named:\n\n\n\n\n\n\n/subsystem=infinispan/cache-container=*/local-cache=*/store=none\n\n\n\n\n\n\nIf I create a cache that uses store=none, the results of a read-children-names(child-type=file-store, include-aliases=true) operation includes the FILE_STORE resource, even though the target resource (i.e. file=store) does not exist.\nThis additionally causes the /subsystem=infinispan:read-resource(include-aliases=true, recursive=true) operation to fail.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR3", "fixed_version": "1.0.0.CR5", "fixed_files": ["org.jboss.as.controller.test.AliasResourceTestCase.java", "org.jboss.as.controller.operations.global.GlobalOperationHandlers.java"], "label": 1, "es_results": []}, {"bug_id": 702, "bug_title": "periodic-size-rotating-file-handler is missing from logging profiles", "bug_description": "The periodic-size-rotating-file-handler was introduced in WildFly Core 1.x, but is missing from logging profiles.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR4", "fixed_version": "1.0.0.CR5", "fixed_files": ["org.jboss.as.logging.LoggingSubsystemTestCase.java", "org.jboss.as.logging.LoggingSubsystemParser.java"], "label": 1, "es_results": []}, {"bug_id": 706, "bug_title": "Non exploded deployments are incorrectly marked as exploded", "bug_description": "", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR4", "fixed_version": "1.0.0.CR5", "fixed_files": ["org.jboss.as.server.deployment.SubDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 752, "bug_title": "Only one deployment overlay can be created for each deployment", "bug_description": "", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR5", "fixed_version": "1.0.0.CR6", "fixed_files": ["org.jboss.as.server.deploymentoverlay.DeploymentOverlayIndex.java"], "label": 1, "es_results": []}, {"bug_id": 774, "bug_title": "Memory leak in JBoss CLI", "bug_description": "The JBoss CLI contains a memory leak related to CLI Kerberos authentication.\nThe org.jboss.as.cli.impl.CommandContextImpl class calls the initJaasConfig() in its constructor, \nwhich adds a new JaasConfigurationWrapper instance to javax.security.auth.login.Configuration.\nIt&apos;s done for every new CommandContext instance, so it consumes more and more memory. There is no cleanup for the registered \nconfigurations.\nMoreover, the searches for appropriate \nlogin config take more and more time because they have to go through all the wrapped objects.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR6", "fixed_version": "2.0.0.Alpha8", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java"], "label": 1, "es_results": []}, {"bug_id": 579, "bug_title": "ProxyMetadataSource does not return JDK8 'default' methods from interfaces", "bug_description": "", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Alpha19", "fixed_version": "2.0.0.CR1", "fixed_files": ["org.jboss.as.server.deployment.reflect.ProxyMetadataSource.java"], "label": 1, "es_results": []}, {"bug_id": 1067, "bug_title": " CVE-2015-5304 Missing authorization check for Monitor/Deployer/Auditor role when shutting down server or canceling op", "bug_description": "It was found that the server or host controller did not properly authorize a user performing a shut down. A user with the role Monitor, Deployer, or Auditor could use this flaw to shut down the EAP server, which is an action restricted to users in other roles.\nThe following commit introduced this issue:\nhttps://github.com/wildfly/wildfly-core/commit/6e5611b4c6\nThe context.getServiceRegistry(true) call, which throws an exception when write authorization fails, was replaced with a call to context.authorize, which only returns an authorization result. Nothing was then done with the authorization result.\nThe same flaw exists in the handling of the cancel-active-operation op, although there this only means the admin could cancel an in-progress operation, perhaps initiated by a different admin. It also let us the admin cancel his own operation, which is arguably a benefit. But losing that benefit is an acceptable price to having a consistent RBAC scheme. (Note: CLI users whose own operations are hanging can always cancel them by doing a soft kill of the CLI process. Users of custom clients that use ModelControllerClient can cancel their own ops by using the ModelControllerClient executeAsync API and cancelling the Future returned thereby.)", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.Final", "fixed_version": "2.0.4.Final", "fixed_files": ["org.jboss.as.test.integration.domain.rbac.AbstractStandardRolesTestCase.java", "org.jboss.as.test.integration.mgmt.access.StandardRolesBasicTestCase.java", "org.jboss.as.domain.management.controller.CancelActiveOperationHandler.java", "org.jboss.as.server.operations.ServerShutdownHandler.java", "org.jboss.as.host.controller.operations.HostShutdownHandler.java"], "label": 1, "es_results": []}, {"bug_id": 701, "bug_title": "Inconsistent domain server status reports between server-config resource and server resource", "bug_description": "When a managed server fails in some way, the server status reporting is inconsistent between the /host=<host>/server-config=<server> resources and the /host=<host>/server=<server> resource.\nTo reproduce, run domain.sh, find the pid of a server process, and kill -9 <thepid>. Then with the CLI:\n\n\n\n\n\n\n[domain@localhost:9990 /] /host=master/server-config=server-two:read-attribute(name=status)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => \"FAILED\"\n\n\n\n\n}\n\n\n\n\n[domain@localhost:9990 /] /host=master/server=server-two:read-attribute(name=server-state)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => \"STOPPED\"\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.0.CR4", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.host.controller.ManagedServer.java"], "label": 1, "es_results": []}, {"bug_id": 1288, "bug_title": "installing CP over one-off fails if the modules patched by the one-off are not patched in the CP", "bug_description": "If a CP is installed over active one-off patches, the patch application may fail if the CP does not contain updates for the modules that were patched by the one-offs.\nNormally, CP patches accumulate the one-off patches released since the previous CP which is, probably, why this bug has not been discovered for a long time.", "project": "Wildfly", "sub_project": "WFCORE", "version": "1.0.1.Final", "fixed_version": "2.0.8.Final", "fixed_files": ["org.jboss.as.patching.installation.MutableTargetImpl.java", "org.jboss.as.patching.runner.IdentityPatchContext.java", "org.jboss.as.patching.installation.InstallationManager.java", "org.jboss.as.patching.runner.IdentityPatchRunner.java", "org.jboss.as.patching.runner.PatchingTask.java"], "label": 1, "es_results": []}, {"bug_id": 697, "bug_title": "CLI does not handle paths with a value of '/'", "bug_description": "It does not appear to be possible to address nodes with a name of &apos;/&apos; in the CLI. This is used in the default undertow subsystem to serve the welcome content.\n\n\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=undertow/server=default-server/host=default-host/location=*:read-resource\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [{\n\n\n\n\n        \"address\" => [\n\n\n\n\n            (\"subsystem\" => \"undertow\"),\n\n\n\n\n            (\"server\" => \"default-server\"),\n\n\n\n\n            (\"host\" => \"default-host\"),\n\n\n\n\n            (\"location\" => \"/\")\n\n\n\n\n        ],\n\n\n\n\n        \"outcome\" => \"success\",\n\n\n\n\n        \"result\" => {\n\n\n\n\n            \"handler\" => \"welcome-content\",\n\n\n\n\n            \"filter-ref\" => undefined\n\n\n\n\n        }\n\n\n\n\n    }]\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=undertow/server=default-server/host=default-host/location=\\/:read-resource\n\n\n\n\nNode type is not complete at index 71\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha2", "fixed_version": "2.0.0.Alpha3", "fixed_files": ["org.jboss.as.cli.parsing.operation.OperationRequestState.java", "org.jboss.as.cli.parsing.test.AddressOnlyParsingTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 731, "bug_title": "TransformerAttachmentGrabber always returns null with map operations", "bug_description": "Kabir, this thing seems a bit fragile. IIUC this was deviced primarily to address the issue with map operations not being transformable, but org.jboss.as.subsystem.test.TransformerAttachmentGrabber doesn&apos;t work with map operations, the attachment is always null.\nI think the problem is with the step order, in org.jboss.as.subsystem.test.TransformerAttachmentGrabber#execute because the real op being a map operation which does attach(...) happens after the attachment is grabbed, that map ops are runtime only org.jboss.as.controller.operations.global.MapOperations#MAP_CLEAR_DEFINITION", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha3", "fixed_version": "2.0.0.Alpha4", "fixed_files": ["org.jboss.as.subsystem.test.TransformerAttachmentGrabber.java"], "label": 1, "es_results": []}, {"bug_id": 727, "bug_title": "Some commands throws NPE on tab completion once disconnected", "bug_description": "Some commands throws NullPointerException when CLI is disconnected from controller and user tries to use tab completion (so far I found these: ls, read-attribute, read-operation).\nNo exception is thrown with 6.4.0.GA", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha3", "fixed_version": "2.0.0.Alpha5", "fixed_files": ["org.jboss.as.cli.impl.CommandCandidatesProvider.java", "org.jboss.as.cli.handlers.ReadAttributeHandler.java", "org.jboss.as.cli.handlers.LsHandler.java"], "label": 1, "es_results": []}, {"bug_id": 769, "bug_title": "Boot errors should hide the failure description if the failing operation is not accessible", "bug_description": "The boot error collector reports whatever failure-description it was passed. Those can include pretty random info, and there&apos;s no good way to know what,so it could leak some sensitive information.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha4", "fixed_version": "2.0.0.Alpha5", "fixed_files": ["org.jboss.as.controller.AbstractOperationContext.java", "org.jboss.as.controller.BootErrorCollector.java"], "label": 1, "es_results": []}, {"bug_id": 787, "bug_title": "OSHs that remove capabilities cannot access the removed capability to restore runtime services during rollback", "bug_description": "If an OSH removes a capability in Stage.MODEL, then removes services associated with the capability, and then the operation rolls back, the OSH can&apos;t use the capability to figure out how to restore services.\nThis is a somewhat more difficult problem than what I addressed for actually removing the runtime services in [1]. That solution relied on making it easy for the remove step handler to use the capability it itself removed. But restoring services typically involves the remove handler calling out to utility code, often part of an add handler. Modifying that utility code to let the remove handler provide service names would be painful.\nInstead I propose simply discarding the modified management model at the beginning of rollback, with the result that rollback handlers will see the capabilities as they existed before the op began.\nSee http://lists.jboss.org/pipermail/wildfly-dev/2015-July/004170.html for details.\n[1]", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha5", "fixed_version": "2.0.0.Alpha6", "fixed_files": ["org.jboss.as.controller.ModelControllerImpl.java", "org.jboss.as.controller.ReadOnlyContext.java", "org.jboss.as.controller.ParallelBootOperationContext.java", "org.jboss.as.controller.OperationContextImpl.java", "org.jboss.as.controller.AbstractOperationContext.java"], "label": 1, "es_results": []}, {"bug_id": 779, "bug_title": "AbstractAddStepHandler does not let AttributeDefinitions record default capability requirements", "bug_description": "AbstractAddStepHandler.recordCapabilitiesAndRequirements(...) has this:\n\n\n\n\n\n\n        ModelNode model = resource.getModel();\n\n\n\n\n        for (AttributeDefinition ad : attributes) {\n\n\n\n\n            if (model.hasDefined(ad.getName())) {\n\n\n\n\n                ad.addCapabilityRequirements(context, model.get(ad.getName()));\n\n\n\n\n            }\n\n\n\n\n        }\n\n\n\n\n\n\nThat &apos;if&apos; check removes the opportunity for an AD to register a requirement based on the default value of the attribute.\nSimpleAttributeDefinition includes logic for doing that, so not giving it a chance to execute is inconsistent. AbstractWriteAttributeHandler also doesn&apos;t include any such limitation.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha4", "fixed_version": "2.0.0.Alpha8", "fixed_files": ["org.jboss.as.controller.SimpleListAttributeDefinition.java", "org.jboss.as.controller.AttributeDefinition.java", "org.jboss.as.controller.StringListAttributeDefinition.java", "org.jboss.as.controller.SimpleAttributeDefinition.java", "org.jboss.as.controller.AbstractAddStepHandler.java"], "label": 1, "es_results": []}, {"bug_id": 810, "bug_title": "Audit log handler sub-resources cannot be removed in same op as the handler", "bug_description": "The various child resources under the management audit log syslog handler resources implement the runtime part of  \"remove\" by trying to read the resource tree starting at the parent and then constructing and registering a new audit log handler.\nThis will fail if the child resource and the parent audit log handler resource are both removed in separate steps in the same composite op. The read of the parent will fail as it will be gone by Stage.RUNTIME.\nThe composite thing is kind of an edge case (since just the parent can be removed) but it also interferes with WFCORE-808.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha6", "fixed_version": "2.0.0.Alpha10", "fixed_files": ["org.jboss.as.domain.management.audit.SyslogAuditLogHandlerResourceDefinition.java", "org.jboss.as.domain.management.audit.SyslogAuditLogProtocolResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 813, "bug_title": "AbstractRemoveStepHandler does not let AttributeDefinitions record default capability requirements", "bug_description": "Similar to WFCORE-779, but for the remove handler.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha8", "fixed_version": "2.0.0.Alpha10", "fixed_files": ["org.jboss.as.controller.AbstractRemoveStepHandler.java"], "label": 1, "es_results": []}, {"bug_id": 815, "bug_title": "One profile can have more ancestors with same submodules", "bug_description": "Description of problem:\nOne profile can have more ancestors with same submodules. It leads to WFLYCTL0212: Duplicate resource [(\"subsystem\" => \"subsystem_name\")] . Hierarchical composition of profiles was added to AS with EAP7-281 and WFCORE-382\nHow reproducible:\nAlways\nSteps to Reproduce:\n\nget fresh EAP\n./domain.sh\n./jboss-cli.sh -c\n/profile=mail-01:add\n/profile=mail-02:add\n/profile=mail-01/subsystem=mail:add\n/profile=mail-02/subsystem=mail:add\n/profile=default-new:add\n/profile=default-new:list-add(name=includes, value=mail-01)\n/profile=default-new:list-add(name=includes, value=mail-02)\n\nActual results:\nNo errors.\nExpected results:\n\n\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => {\"domain-failure-description\" => \"WFLYCTL0401: Profile &apos;mail-01&apos; defines subsystem &apos;mail&apos; which is also defined in its ancestor profile &apos;mail-02&apos;. Overriding subsystems is not supported\"},\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\nWorkaround:\nAdd any subsystem to default-new profile:\n\n/profile=mail-01:add\n/profile=mail-02:add\n/profile=mail-01/subsystem=mail:add\n/profile=mail-02/subsystem=mail:add\n/profile=default-new:add\n/profile=default-new/subsystem=jdr:add\n/profile=default-new:list-add(name=includes, value=mail-01)\n/profile=default-new:list-add(name=includes, value=mail-02)\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha9", "fixed_version": "2.0.0.Alpha10", "fixed_files": ["org.jboss.as.host.controller.logging.HostControllerLogger.java", "org.jboss.as.domain.controller.operations.SocketBindingGroupIncludesHandlerTestCase.java", "org.jboss.as.domain.controller.operations.DomainModelReferenceValidator.java", "org.jboss.as.domain.controller.operations.ProfileIncludesHandlerTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 755, "bug_title": "bootTimeout for embedded server uses milis instead of nanos", "bug_description": "Value for --timeout argument needs to be set in microseconds instead of seconds.\n\n\n\n\n\n\n// boot time is transformed into milis\n\n\n\n\nLong bootTimeout = null;\n\n\n\n\nString timeoutString = timeout.getValue(parsedCmd);\n\n\n\n\nif (timeoutString != null) {\n\n\n\n\n   bootTimeout = TimeUnit.SECONDS.toMillis(Long.parseLong(timeoutString));\n\n\n\n\n}\n\n\n\n\n...\n\n\n\n\n// but expired is transformed into nanos\n\n\n\n\nlong expired = bootTimeout == null ? Long.MAX_VALUE : System.nanoTime() + bootTimeout;\n\n\n\n\n\n\nCould be fixed by converting parsed timeoutString into nanos.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha4", "fixed_version": "2.0.0.Alpha10", "fixed_files": ["org.jboss.as.cli.embedded.EmbedServerHandler.java"], "label": 1, "es_results": []}, {"bug_id": 816, "bug_title": "Error messages for profile and socket-binding-group includes should be in host-controller, not controller", "bug_description": "", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha9", "fixed_version": "2.0.0.Alpha10", "fixed_files": ["org.jboss.as.host.controller.logging.HostControllerLogger.java", "org.jboss.as.controller.logging.ControllerLogger.java", "org.jboss.as.controller.SocketCapabilityResolutionUnitTestCase.java", "org.jboss.as.domain.controller.operations.DomainModelReferenceValidator.java"], "label": 1, "es_results": []}, {"bug_id": 894, "bug_title": "Empty properties list parsing leads to an error", "bug_description": "PropertiesAttribute parser does not allow empty properties list which is redundant but valid.  What is more removing last property using map-remove operation leads to a configuration with empty properties tags.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta2", "fixed_version": "2.0.0.Beta3", "fixed_files": ["org.jboss.as.controller.AttributeParsers.java", "org.jboss.as.controller.operations.global.MapOperations.java"], "label": 1, "es_results": []}, {"bug_id": 881, "bug_title": "Embedded server gets broken after operation on embedded host controller", "bug_description": "I am unable to use standalone embedded server once I invoke some operation on embedded host controller.\nQuick steps to reproduce:\n\n\n\n\n\n\n$ ./jboss-cli.sh \n\n\n\n\n[disconnected /] embed-host-controller\n\n\n\n\n[domain@embedded /] /host=master:read-resource\n\n\n\n\n[domain@embedded /] stop-embedded-host-controller \n\n\n\n\n[disconnected /] embed-server\n\n\n\n\n[standalone@embedded /] stop-embedded-server \n\n\n\n\nFailed to handle &apos;stop-embedded-server&apos;: org.wildfly.core.embedded.EmbeddedStandAloneServerFactory$StandaloneServerImpl cannot be cast to org.wildfly.core.embedded.HostController\n\n\n\n\n\n\nReproducible with wf-core 2.0.0.Beta1 build", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta1", "fixed_version": "2.0.0.Beta3", "fixed_files": ["org.jboss.as.cli.embedded.StopEmbeddedHostControllerHandler.java"], "label": 1, "es_results": []}, {"bug_id": 861, "bug_title": "Wrong installation date in product info report", "bug_description": "Description of problem:\nProduct info report shows wrong installation date in wildfly. Reported installation date is date of wildfly building.\nHow reproducible:\nAlways on EAP from zip installation\nSteps to Reproduce:\n\nget fresh wildfly from git\nbuild wildfly\n./standalone.sh\n./jboss-cli.sh -c\n:product-info\n\nActual results:\ninstallation-date is a date of wildfly building\nExpected results:\nIf Product Install Date is not available, wildfly do not report it.\nAdditional info:\nInstallation date is reported correctly, when installer is used.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha11", "fixed_version": "2.0.0.Beta3", "fixed_files": ["org.jboss.as.server.operations.AbstractInstallationReporter.java"], "label": 1, "es_results": []}, {"bug_id": 839, "bug_title": "Do not store state in InMemoryAuditLogHandlerResourceDefinition", "bug_description": "https://github.com/wildfly/wildfly-core/pull/890#discussion_r35354989\n private static final Map<String, InMemoryAuditLogHander> histories = Collections.synchronizedMap(new HashMap<String, InMemoryAuditLogHander>());\nWe don&apos;t want to delay merging this PR for this, but once it&apos;s merged please send up a PR to make this a non-static field and have the InMemoryAuditLogHandlerResourceDefinition pass a ref to it to the handlers when it constructs them.\nHaving this be static is no big deal in this case, but I don&apos;t want anyone looking at kernel code and thinking that using static fields to store state is a good practice.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Alpha11", "fixed_version": "2.0.0.Beta3", "fixed_files": ["org.jboss.as.controller.audit.AuditLogHandler.java", "org.jboss.as.controller.audit.ManagedAuditLogger.java", "org.jboss.as.controller.audit.InMemoryAuditLogHander.java", "org.jboss.as.domain.management.audit.InMemoryAuditLogHandlerResourceDefinition.java", "org.jboss.as.controller.audit.AuditLogger.java", "org.jboss.as.controller.audit.ManagedAuditLoggerImpl.java"], "label": 1, "es_results": []}, {"bug_id": 921, "bug_title": "Remove n2 model node cloning in ServerOperationResolver", "bug_description": "ServerOperationResolver gets called for each operation in a composite.\nFor each call it clones the configuration model.\nIt then calls node.asPropertyList() in various spots, which in turn results in a clone of the value of each Property. In particular it does this over the profiles, which means each profile gets cloned.\nFor very large configurations, this is extremely inefficient. One user was experimenting with adding 1000s of data sources and found it would take over an hour to complete the work. I was able to do it in 30 seconds by correcting these problems.\nThere are other areas where we may be incurring unneeded expense via calls to node.asPropertyList().", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta4", "fixed_version": "2.0.0.Beta5", "fixed_files": ["org.jboss.as.domain.controller.operations.coordination.ServerOperationResolver.java", "org.jboss.as.domain.controller.operations.coordination.DomainServerUtils.java"], "label": 1, "es_results": []}, {"bug_id": 942, "bug_title": "Parameter completion for :read-resource and :read-children-resources is broken", "bug_description": "When I try to use tab completion to add parameters to \"read-resource\" and \"read-children-resources\" operations, it does not suggest any params but instead just closes the parameter list.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta5", "fixed_version": "2.0.0.Beta6", "fixed_files": ["org.jboss.as.cli.operation.impl.DefaultOperationCandidatesProvider.java"], "label": 1, "es_results": []}, {"bug_id": 896, "bug_title": "Cannot patch EAP once Docs are excluded from installation", "bug_description": "EAP installer allows user to exclude some packs from installation. Docs directory is one of them. If user choose to do so, $JBOSS_HOME/docs directory is not present in distribution.\nTrying to apply a patch (contains changes with docs files) on such a distribution gives me:\n\n\n\n\n\n\njava.io.FileNotFoundException: /home/pkremens/workspace/jboss-eap-7.0/docs/schema/saml-schema-authn-context-xmldsig-2.0.xsd (No such file or directory)\n\n\n\n\n\n\nThis could block customers, who are using installer to get EAP, from consuming the patches for CP releases in future.\nPatch was generated using:\nhttps://github.com/jbossas/patch-gen\ndr8_to_dr8x.zip patch.xml:\n\n\n\n\n\n\n<?xml version=\"1.0\" ?>\n\n\n\n\n\n\n\n\n\n<patch xmlns=\"urn:jboss:patch:1.0\" id=\"dr8_to_dr8x\">\n\n\n\n\n    <description>\n\n\n\n\n        No description available\n\n\n\n\n    </description>\n\n\n\n\n    <upgrade name=\"EAP\" version=\"7.0.0.Alpha1\" to-version=\"7.0.0.Alpha1\"/>\n\n\n\n\n    <element id=\"layer-base-dr8_to_dr8x\">\n\n\n\n\n        <description>\n\n\n\n\n            No description available\n\n\n\n\n        </description>\n\n\n\n\n        <upgrade name=\"base\"/>\n\n\n\n\n    </element>\n\n\n\n\n    <misc-files>\n\n\n\n\n        <added path=\"docs/schema/saml-schema-authn-context-xmldsig-2.1.xsd\" hash=\"25d2e47a02d248101af86cff07daf9d51d8da379\"/>\n\n\n\n\n        <updated path=\"docs/schema/saml-schema-ecp-2.0.xsd\" hash=\"97984434c30816939c0f64b9388dc75d977a3b17\" new-hash=\"fa7e234444b3c5d9ede81b4799dfaff8632d987a\"/>\n\n\n\n\n        <removed path=\"docs/schema/saml-schema-authn-context-xmldsig-2.0.xsd\" hash=\"25d2e47a02d248101af86cff07daf9d51d8da379\"/>\n\n\n\n\n    </misc-files>\n\n\n\n\n</patch>\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta1", "fixed_version": "2.0.0.Beta6", "fixed_files": ["org.jboss.as.patching.runner.BundlePatchingTask.java", "org.jboss.as.patching.runner.PatchingTaskDescription.java", "org.jboss.as.patching.runner.AbstractPatchingTask.java", "org.jboss.as.patching.metadata.ModificationBuilderTarget.java", "org.jboss.as.patching.runner.PatchingTask.java", "org.jboss.as.patching.runner.IdentityPatchRunner.java", "org.jboss.as.patching.runner.FileRemoveTask.java", "org.jboss.as.patching.tests.AbstractPatchTestBuilder.java", "org.jboss.as.patching.metadata.PatchXml_1_0.java", "org.jboss.as.patching.runner.FileUpdateTask.java", "org.jboss.as.patching.tests.PatchStepAssertions.java", "org.jboss.as.patching.metadata.PatchXml.java", "org.jboss.as.patching.metadata.ContentModification.java", "org.jboss.as.patching.runner.ModuleUpdateTask.java", "org.jboss.as.patching.logging.PatchLogger.java", "org.jboss.as.patching.metadata.PatchXmlUtils.java", "org.jboss.as.patching.runner.ModuleRemoveTask.java", "org.jboss.as.patching.runner.ContentModificationUtils.java", "org.jboss.as.patching.metadata.RollbackPatchXml_1_0.java"], "label": 1, "es_results": []}, {"bug_id": 885, "bug_title": "World readable audit.log file", "bug_description": "Server logs sensitive information into a world readable audit.log file. This information could be used by a local attacker to gain otherwise protected information about user sessions etc.\nThis issue was originally reported as CVE in https://bugzilla.redhat.com/show_bug.cgi?id=1063642. EAP 6.x branches are fixed but same issue occurs in EAP 7 again.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta2", "fixed_version": "2.0.0.Beta6", "fixed_files": ["org.jboss.as.controller.audit.SizeRotatingFileAuditLogHandler.java", "org.jboss.as.controller.audit.AbstractFileAuditLogHandler.java", "org.jboss.as.controller.audit.PeriodicRotatingFileAuditLogHandler.java"], "label": 1, "es_results": []}, {"bug_id": 961, "bug_title": "CapabilityRegistryResourceDefinition provides inconsistent ordering of output", "bug_description": "The output from CapabilityRegistryResourceDefinition is inconsistently ordered. We want consistent output between reads.\nThe RegistrationPoints are stored in CapabilityRegistration in a LinkedHashSet, but when they are provided to CapabilityRegistryResourceDefinition they get put in a plain HashSet.\nThe capabilities themselves are not stored in any order, but when provided to CapabilityRegistryResourceDefinition they could be ordered.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta6", "fixed_version": "2.0.0.Beta7", "fixed_files": ["org.jboss.as.controller.capability.registry.CapabilityId.java", "org.jboss.as.controller.capability.registry.CapabilityRegistration.java", "org.jboss.as.controller.CapabilityRegistry.java"], "label": 1, "es_results": []}, {"bug_id": 967, "bug_title": "list-xxx and map-xxx do not work in a composite", "bug_description": "When running e.g. a series of map-add operations in a composite, only the last step takes effect. e.g.:\n\n\n\n\n\n\nModel Before: {\n\n\n\n\n    \"deployment\" => undefined,\n\n\n\n\n    \"subsystem\" => {\"test-subsystem\" => {\n\n\n\n\n        \"properties\" => {\n\n\n\n\n            \"one\" => \"A\",\n\n\n\n\n            \"two\" => \"B\",\n\n\n\n\n            \"three\" => \"C\"\n\n\n\n\n        },\n\n\n\n\n        \"test\" => \"Hello\"\n\n\n\n\n    }}\n\n\n\n\n}\n\n\n\n\n{\n\n\n\n\n    \"operation\" => \"composite\",\n\n\n\n\n    \"address\" => [],\n\n\n\n\n    \"steps\" => [\n\n\n\n\n        {\n\n\n\n\n            \"operation\" => \"map-remove\",\n\n\n\n\n            \"address\" => [(\"subsystem\" => \"test-subsystem\")],\n\n\n\n\n            \"name\" => \"properties\",\n\n\n\n\n            \"key\" => \"one\"\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"operation\" => \"map-remove\",\n\n\n\n\n            \"address\" => [(\"subsystem\" => \"test-subsystem\")],\n\n\n\n\n            \"name\" => \"properties\",\n\n\n\n\n            \"key\" => \"two\"\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"operation\" => \"map-remove\",\n\n\n\n\n            \"address\" => [(\"subsystem\" => \"test-subsystem\")],\n\n\n\n\n            \"name\" => \"properties\",\n\n\n\n\n            \"key\" => \"three\"\n\n\n\n\n        }\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\nModel After: {\n\n\n\n\n    \"deployment\" => undefined,\n\n\n\n\n    \"subsystem\" => {\"test-subsystem\" => {\n\n\n\n\n        \"properties\" => {\n\n\n\n\n            \"one\" => \"A\",\n\n\n\n\n            \"two\" => \"B\"\n\n\n\n\n        },\n\n\n\n\n        \"test\" => \"Hello\"\n\n\n\n\n    }}\n\n\n\n\n}\n\n\n\n\n\n\nThe same happens with map-put, map-remove, list-add and list-remove when used in a composite. I have added some more tests to https://github.com/kabir/wildfly-core/blob/map-operation-composite/controller/src/test/java/org/jboss/as/controller/operation/global/CollectionOperationsTestCase.java to demonstrate the problem. These tests should be expanded to cover more of the map operations when used in a composite.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta6", "fixed_version": "2.0.0.Beta7", "fixed_files": ["org.jboss.as.controller.operations.global.AbstractCollectionHandler.java", "org.jboss.as.controller.operation.global.CollectionOperationsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 968, "bug_title": "WriteAttributeHandler needs to add steps to the top of the queue", "bug_description": "WriteAttributeHandler is adding a bunch of steps that make up elements of its Stage.MODEL execution, but it isn&apos;t adding them with the &apos;addFirst&apos; param set to true. This means the effective order of model changes within a composite op is not going to match the logical order of the steps in the op, and step 2 might not execute with the expected starting state.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta6", "fixed_version": "2.0.0.Beta7", "fixed_files": ["org.jboss.as.controller.operations.global.WriteAttributeHandler.java"], "label": 1, "es_results": []}, {"bug_id": 959, "bug_title": "Handling of ManagementResourceRegistration runtimeOnly is broken", "bug_description": "NodeSubregistry is always passing &apos;false&apos; as the runtimeOnly param for ConcreteResourceRegistrations it creates.\nThe param isn&apos;t actually needed, since the ResourceDefinition is also a param, and the value can be pulled from it.\nAlso, since we now have proper facilities for setting up a runtimeOnly ResourceDefinition, the MRR.setRuntimeOnly() method should be deprecated and all core uses of it converted.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta6", "fixed_version": "2.0.0.Beta7", "fixed_files": ["org.jboss.as.platform.mbean.OperatingSystemResourceDefinition.java", "org.jboss.as.logging.deployments.resources.LoggerResourceDefinition.java", "org.jboss.as.controller.registry.ManagementResourceRegistration.java", "org.jboss.as.controller.test.ReadResourceWithRuntimeResourceTestCase.java", "org.jboss.as.platform.mbean.BufferPoolRootResourceDefinition.java", "org.jboss.as.platform.mbean.MemoryResourceDefinition.java", "org.jboss.as.platform.mbean.MemoryPoolResourceDefinition.java", "org.jboss.as.logging.deployments.resources.HandlerResourceDefinition.java", "org.jboss.as.platform.mbean.ClassLoadingResourceDefinition.java", "org.jboss.as.platform.mbean.MemoryPoolRootResourceDefinition.java", "org.jboss.as.logging.LogFileResourceDefinition.java", "org.jboss.as.domain.management.controller.ActiveOperationResourceDefinition.java", "org.jboss.as.platform.mbean.RuntimeResourceDefinition.java", "org.jboss.as.platform.mbean.BufferPoolResourceDefinition.java", "org.jboss.as.controller.test.DisappearingResourceTestCase.java", "org.jboss.as.controller.registry.DelegatingManagementResourceRegistration.java", "org.jboss.as.platform.mbean.CompilationResourceDefinition.java", "org.jboss.as.controller.registry.ConcreteResourceRegistration.java", "org.jboss.as.logging.deployments.resources.LoggingDeploymentResources.java", "org.jboss.as.controller.extension.ExtensionRegistry.java", "org.jboss.as.controller.extension.ExtensionSubsystemResourceDefinition.java", "org.jboss.as.platform.mbean.GarbageCollectorResourceDefinition.java", "org.jboss.as.platform.mbean.PlatformMBeanResourceDefinition.java", "org.jboss.as.platform.mbean.MemoryManagerRootResourceDefinition.java", "org.jboss.as.domain.management.controller.ManagementControllerResourceDefinition.java", "org.jboss.as.domain.management.access.AccessConstraintAppliesToResourceDefinition.java", "org.jboss.as.logging.LoggingExtension.java", "org.jboss.as.controller.registry.NodeSubregistry.java", "org.jboss.as.platform.mbean.ThreadResourceDefinition.java", "org.jboss.as.platform.mbean.MemoryManagerResourceDefinition.java", "org.jboss.as.platform.mbean.GarbageCollectorRootResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 980, "bug_title": "The capability registry fails to rollback properly", "bug_description": "If we register an already registered capability at a new RegistrationPoint and the operation rollbacks the registry still has the new RegistrationPoint.\nThe publishedFullRegistry should be a deep copy of the registry:\nReproducer working with the WFCORE-949 pr:\n\n\n\n\n\n\n/socket-binding-group=standard-sockets/socket-binding=management-native:add(port=9999, interface=management)\n\n\n\n\n/core-service=management/management-interface=native-interface:add(socket-binding=native-management, security-realm=ManagementRealm) \n\n\n\n\n/core-service=management/management-interface=native-interface:add(socket-binding=management-native, security-realm=ManagementRealm)\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta7", "fixed_version": "2.0.0.CR2", "fixed_files": ["org.jboss.as.controller.CapabilityRegistryTestCase.java", "org.jboss.as.controller.CapabilityRegistry.java"], "label": 1, "es_results": []}, {"bug_id": 876, "bug_title": "Reload or Shutdown inside IF statement is performed before the if/else block batch is executed", "bug_description": "Executing a reload or shutdown inside an if/else block results in the reload or restart occurring before the other commands in the batch are executed.\n\n\n\n\n\n\nif (outcome == success) of /subsystem=logging/logger=org.jboss.as.cli:read-resource()\n\n\n\n\n   /subsystem=logging:write-attribute(name=use-deployment-logging-config\n\n\n\n\n   shutdown --restart=true\n\n\n\n\nend-if\n\n\n\n\n\n\nThis command will actually leave the server in a reload-required state. The shutdown, or reload, will occur before the write-attribute is executed.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta1", "fixed_version": "2.0.0.CR2", "fixed_files": ["org.jboss.as.cli.handlers.ifelse.IfElseControlFlow.java", "org.jboss.as.cli.handlers.trycatch.TryCatchFinallyControlFlow.java", "org.jboss.as.test.integration.management.cli.TryCatchFinallyTestCase.java", "org.jboss.as.test.integration.management.cli.ifelse.NonExistingPathComparisonTestCase.java", "org.jboss.as.test.integration.management.cli.ifelse.BasicIfElseTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 939, "bug_title": "Embedded host controller should set launch type attribute to EMBEDDED", "bug_description": "DomainRootDefinition.java always set launch type to \n\n\n\n\n\nnew LaunchTypeHandler(ServerEnvironment.LaunchType.DOMAIN)\n\n\n\n\n\n even if the host controller process is embedded. \nLooking into the LaunchType class, I believe that EMBEDDED value should be used.\n\n\n\n\n\n\n    /** The manner in which a server can be launched */\n\n\n\n\n    public static enum LaunchType {\n\n\n\n\n        /** Launched by a Host Controller in a managed domain */\n\n\n\n\n        DOMAIN(ProcessType.DOMAIN_SERVER),\n\n\n\n\n        /** Launched from the command line */\n\n\n\n\n        STANDALONE(ProcessType.STANDALONE_SERVER),\n\n\n\n\n        /** Launched by another process in which the server is embedded */\n\n\n\n\n        EMBEDDED(ProcessType.EMBEDDED_SERVER),\n\n\n\n\n...\n\n\n\n\n\n\n\nAdditional info:\n\n\n\n\n\n\n./standalone.sh\n\n\n\n\nlaunch-type              STANDALONE\n\n\n\n\n\n\n\n\n\n\n\n\n./domain.sh\n\n\n\n\nlaunch-type              DOMAIN\n\n\n\n\n\n\n\n\n\n\n\n\n[disconnected /] embed-server \n\n\n\n\nlaunch-type              EMBEDDED\n\n\n\n\n\n\n\n\n\n\n\n\n[disconnected /] embed-host-controller\n\n\n\n\nlaunch-type              DOMAIN\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta4", "fixed_version": "2.0.0.CR2", "fixed_files": ["org.jboss.as.host.controller.HostControllerBootstrap.java", "org.wildfly.core.embedded.EmbeddedHostControllerFactory.java", "org.jboss.as.host.controller.HostControllerEnvironment.java", "org.jboss.as.domain.controller.resources.DomainRootDefinition.java", "org.jboss.as.host.controller.DomainModelControllerService.java", "org.jboss.as.host.controller.HostControllerService.java", "org.jboss.as.host.controller.Main.java", "org.wildfly.core.embedded.EmbeddedHostControllerBootstrap.java"], "label": 1, "es_results": []}, {"bug_id": 981, "bug_title": "RemoteDomainConnectionService uses out of date HostInfo data when reconnecting", "bug_description": "When RemoteDomainConnectionService starts, it calculates a \"hostInfo\" ModelNode that among other things includes data about what addresses the host is ignoring, and what server groups and socket binding groups are relevant to it if it is ignoring resources unrelated to its servers.\nProblem is, this data is never updated if the host&apos;s config changes, so if the host needs to reconnect to the master, it sends out-of-date data to the master, and also uses out of date data to process the info that comes back from the master.\nWe need to figure out how to refresh that data for each connection to the master.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta7", "fixed_version": "2.0.0.CR2", "fixed_files": ["org.jboss.as.host.controller.RemoteDomainConnectionService.java", "org.jboss.as.core.model.test.LegacyKernelServicesImpl.java", "org.jboss.as.host.controller.RemoteDomainConnection.java", "org.jboss.as.test.integration.domain.suites.IgnoredResourcesTestCase.java", "org.jboss.as.host.controller.IgnoredNonAffectedServerGroupsUtil.java", "org.jboss.as.host.controller.operations.LocalHostControllerInfoImpl.java", "org.jboss.as.host.controller.operations.RemoteDomainControllerAddHandler.java", "org.jboss.as.domain.controller.operations.AbstractOperationTestCase.java", "org.jboss.as.domain.controller.LocalHostControllerInfo.java", "org.jboss.as.domain.controller.operations.ServerGroupAffectedResourceServerConfigOperationsTestCase.java", "org.jboss.as.test.integration.domain.suites.DomainTestSuite.java"], "label": 1, "es_results": []}, {"bug_id": 992, "bug_title": "Memory leak in host controller", "bug_description": "The ManagedServerProxy class in the host-controller module contains a memory leak, which can be easily reproduced using the RBAC soak test, like so:\n\n\n\n\n\n\ncd wildfly-core # checkout WildFly Core 2.0.0.CR1, which is in WildFly 10.0.0.CR1, or current master\n\n\n\n\nmvn clean install -DskipTests\n\n\n\n\ncd testsuite/domain\n\n\n\n\nmvn clean test -Dts.noSmoke -Dts.domain -Prbac-soak -Djboss.test.rbac.soak.clients=100 -Djboss.test.rbac.soak.iterations=50\n\n\n\n\n\n\nAfter acquiring a heap dump (-XX:+HeapDumpOnOutOfMemoryError), it&apos;s clear that out of the 512 MB of heap space a host controller has, more than 400 MB is taken by a single instance of the ManagedServerProxy class, specifically by its activeRequests field. This Map has a single entry whose value is a Set of \"pending\" futures. I added a couple of debug prints to the places where this Set is modified, only to see this:\n\n\n\n\n\n\n2015-09-21 12:32:00,704 INFO  [stdout] (management-handler-thread - 4) !!! added org.jboss.as.controller.remote.TransactionalProtocolClientImpl$1@142a1c24\n\n\n\n\n2015-09-21 12:32:00,707 INFO  [stdout] (Remoting \"master:MANAGEMENT\" task-3) !!! removed org.jboss.as.protocol.mgmt.ActiveOperationSupport$ActiveOperationImpl@5bfbf423\n\n\n\n\n2015-09-21 12:32:00,707 INFO  [stdout] (management-handler-thread - 4) !!! added org.jboss.as.controller.remote.TransactionalProtocolClientImpl$1@27e2e96c\n\n\n\n\n2015-09-21 12:32:00,708 INFO  [stdout] (Remoting \"master:MANAGEMENT\" task-2) !!! removed org.jboss.as.protocol.mgmt.ActiveOperationSupport$ActiveOperationImpl@72817a0d\n\n\n\n\n2015-09-21 12:32:00,713 INFO  [stdout] (management-handler-thread - 2) !!! added org.jboss.as.controller.remote.TransactionalProtocolClientImpl$1@73d373a7\n\n\n\n\n2015-09-21 12:32:00,718 INFO  [stdout] (Remoting \"master:MANAGEMENT\" task-9) !!! removed org.jboss.as.protocol.mgmt.ActiveOperationSupport$ActiveOperationImpl@20bd6db1\n\n\n\n\n\n\nSkipping a few intermediate steps, the root because is that AbstractDelegatingAsyncFuture delegates addListener directly to an underlying future, so the callbacks don&apos;t get the original instance, but the underlying one.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR1", "fixed_version": "2.0.0.CR2", "fixed_files": ["org.jboss.as.host.controller.ManagedServerProxy.java"], "label": 1, "es_results": []}, {"bug_id": 949, "bug_title": "Removing http-interface autocompletes but fails", "bug_description": "Executing /core-service=management/management-interface=http-interface:remove() autocompletes but does not succeed. \nThis is a link to a paste of the server stacktrace.\nhttp://pastebin.test.redhat.com/310136", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta5", "fixed_version": "2.0.0.CR2", "fixed_files": ["org.jboss.as.subsystem.test.AdditionalInitialization.java", "org.wildfly.core.test.standalone.mgmt.HTTPSManagementInterfaceTestCase.java", "org.jboss.as.jmx.RemotingConnectorResource.java", "org.jboss.as.server.operations.HttpManagementRemoveHandler.java", "org.jboss.as.host.controller.resources.NativeManagementResourceDefinition.java", "org.jboss.as.test.integration.domain.HTTPSManagementInterfaceTestCase.java", "org.jboss.as.server.operations.NativeRemotingManagementRemoveHandler.java", "org.jboss.as.server.operations.NativeManagementRemoveHandler.java", "org.jboss.as.host.controller.resources.HttpManagementResourceDefinition.java", "org.wildfly.core.test.standalone.mgmt.HTTPSConnectionWithCLITestCase.java", "org.jboss.as.remoting.management.ManagementRemotingServices.java", "org.jboss.as.remoting.logging.RemotingLogger.java", "org.jboss.as.server.mgmt.NativeManagementResourceDefinition.java", "org.jboss.as.host.controller.operations.HttpManagementRemoveHandler.java", "org.jboss.as.server.mgmt.HttpManagementResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 933, "bug_title": "Embedded server start commands are lacking argument validation", "bug_description": "Commands for starting embedded instances are lacking argument validation.\n\n\n\n\n\n\n[disconnected /] embed-server foo\n\n\n\n\n[standalone@embedded /]\n\n\n\n\n\n\n\n\n\n[disconnected /] embed-server foo -foo\n\n\n\n\n[standalone@embedded /]\n\n\n\n\n\n\n\n\n\n[disconnected /] embed-server foo --foo\n\n\n\n\n[standalone@embedded /]\n\n\n\n\n\n\n\n\n\n[standalone@embedded /] stop-embedded-server foo\n\n\n\n\nThe command accepts 0 unnamed argument(s) but received: [foo]\n\n\n\n\n\n\n\n\n\n[standalone@embedded /] stop-embedded-server -foo\n\n\n\n\nUnrecognized arguments: [-foo]\n\n\n\n\n\n\n\n\n\n[standalone@embedded /] stop-embedded-server --foo\n\n\n\n\nUnrecognized arguments: [--foo]\n\n\n\n\n\n\nSame case for embedded host controller.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta4", "fixed_version": "2.0.0.CR2", "fixed_files": ["org.jboss.as.cli.embedded.EmbedHostControllerHandler.java", "org.jboss.as.cli.embedded.EmbedServerHandler.java"], "label": 1, "es_results": []}, {"bug_id": 940, "bug_title": "CLI gets fooled by early connection", "bug_description": "CLI in confused by early connection to domain which is booting. CLI acts as I was connected to the standalone instance, some high level commands are not executable.\n\n\n\n\n\n\n[pkremens@dhcp-10-40-5-149 bin]$ ./domain.sh\n\n\n\n\n...\n\n\n\n\n# run while domain is booting\n\n\n\n\n[pkremens@dhcp-10-40-5-149 bin]$ ./jboss-cli.sh -c \n\n\n\n\n[standalone@localhost:9999 /]\n\n\n\n\n\n\n\n\n\n# domain has fully booted\n\n\n\n\n\n\n\n\n\n[standalone@localhost:9999 /] ls -l\n\n\n\n\nATTRIBUTE                VALUE                 TYPE   \n\n\n\n\nlaunch-type              DOMAIN                STRING\n\n\n\n\n...\n\n\n\n\n[standalone@localhost:9999 /] shutdown --host=master\n\n\n\n\n--host is not allowed in the standalone mode.\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta4", "fixed_version": "2.0.0.CR4", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java"], "label": 1, "es_results": []}, {"bug_id": 932, "bug_title": "stop-embedded-server stops the embedded host controller and vice versa", "bug_description": "We have four new commands for controlling the lifecycle of embedded instances:\n\nembed-server - launch embedded standalone\nstop-embedded-server - stop embedded standalone\nembed-host-controller - launch embedded host\nstop-embedded-host-controller - stop embedded host\n\n\nI am able stop embedded standalone by stop-embedded-host-controller and embedded host controller by stop-embedded-server.\n\n\n\n\n\n\n[disconnected /] embed-server \n\n\n\n\n[standalone@embedded /] stop-embedded-host-controller \n\n\n\n\n[disconnected /] embed-host-controller \n\n\n\n\n14:22:18,781 INFO  [org.jboss.modules] (AeshProcess: 15) JBoss Modules version 1.4.3.Final\n\n\n\n\n[domain@embedded /] stop-embedded-server \n\n\n\n\n[disconnected /]\n\n\n\n\n\n\n\nA question comes to my mind, do we need two commands for stopping the embedded instance?", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta4", "fixed_version": "2.0.0.CR5", "fixed_files": ["org.jboss.as.cli.embedded.EmbeddedServerLaunch.java", "org.jboss.as.cli.embedded.StopEmbeddedServerHandler.java", "org.jboss.as.cli.embedded.StopEmbeddedHostControllerHandler.java", "org.jboss.as.cli.handlers.ShutdownHandler.java", "org.wildfly.core.embedded.EmbeddedServerReference.java"], "label": 1, "es_results": []}, {"bug_id": 1034, "bug_title": "2 step domain operations do not resolve aliases properly", "bug_description": "For WFLY-5290, WFCORE-1022 was done to provide more context, however we still have some problems when doing:\n\n\n\n\n\n\n/profile=full-ha/subsystem=jgroups/stack=tcp/transport=TRANSPORT/thread-pool=default:write-attribute(name=keepalive-time,value=100)\n\n\n\n\n\n\nThis is an alias which should resolve to\n\n\n\n\n\n\n/profile=full-ha/subsystem=jgroups/stack=tcp/transport=TCP/thread-pool=default:write-attribute(name=keepalive-time,value=100)\n\n\n\n\n\n\nThe equivalent works fine in a standalone. Debugging using CLI commands, the initial read-operation-description ends up in PrepareStepHandler.executeDirectOperation()\nwhich does the right thing.\nHowever the write-attribute call ends up in \n\n\n\n\n\n\n\tOperationCoordinatorStepHandler.execute() ->\n\n\n\n\n\tOperationSlaveStepHandler.addSteps() ->\n\n\n\n\n\tHostControllerExecutionSupport returns a domainOp ->\n\n\n\n\n\tOperationSlaveStepHandler.addBasicStep()\n\n\n\n\n\n\nand \tOperationSlaveStepHandler.addBasicStep() resolves the OperationEntry differently from the standard/standalone prepare step handler, and from how PrepareStepHandler.executeDirectOperation() resolves it.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR6", "fixed_version": "2.0.0.CR7", "fixed_files": ["org.jboss.as.domain.controller.operations.coordination.OperationSlaveStepHandler.java"], "label": 1, "es_results": []}, {"bug_id": 916, "bug_title": " Kerberos authentication into Management Console does not fallback correctly", "bug_description": "Fallback management realm is not taken into account for Kerberos authentication into Management Console. In cases when Kerberos authentication to Management Console is configured also with fallback mechanism (properties, security-domain...) and one of:\n\nrealm in principal is not set correctly\npath to keytab is not set correctly\n\nis set in EAP configuration and when user with valid kerberos ticket tries to access Management Console then fallback is not taken into account and user cannot access management console.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Beta1", "fixed_version": "2.0.0.CR7", "fixed_files": ["org.jboss.as.domain.management.logging.DomainManagementLogger.java", "org.jboss.as.domain.management.security.KeytabService.java"], "label": 1, "es_results": []}, {"bug_id": 997, "bug_title": "Security realm using ldaps hangs forever during SSL handshake, when ldap server is killed", "bug_description": "During failover testing we hit the problem of stuck thread. When ldap server is killed in particular time of ssl handshake EAP hangs and waits forever on response, which will never come. Causing thread to block forever. Same problem can be seen in LdapLoginModule using ldaps without specifying com.sun.jndi.ldap.connect.timeout value.\nPossible solution is to add option to declare com.sun.jndi.ldap.connect.timeout for security realm and provide some default non-empty value, e.g. 15 seconds.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR3", "fixed_version": "2.0.0.CR7", "fixed_files": ["org.jboss.as.domain.management.connections.ldap.ThreadLocalSSLSocketFactory.java", "org.jboss.as.domain.management.security.WrapperSSLContext.java"], "label": 1, "es_results": []}, {"bug_id": 1046, "bug_title": "Show error message when accessing http management console of a slave host controller", "bug_description": "WFCORE-678 removed the selection of the ConsoleMode.SLAVE_HC console, to show the message: \"You may not access the admin console on this node, all access must come via the master host controller\" when you tried to access a slave host controller console.\nThat was the default behavior when you enabled the http management interface on a slave host controller (to access it using JON for monitoring, for example).", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR6", "fixed_version": "2.0.0.CR7", "fixed_files": ["org.jboss.as.host.controller.operations.HttpManagementAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1035, "bug_title": "stop-embedded-host-controller command is not available in non-modular environment", "bug_description": "stop-embedded-host-controller command for stopping the embed host controller instance is not available once the CLI is running in non-modular environment.\n\n\n\n\n\n\n[pkremens@dhcp-10-40-5-17 client] $ java -jar jboss-cli-client.jar \n\n\n\n\nWARN: can&apos;t find jboss-cli.xml. Using default configuration values.\n\n\n\n\nYou are disconnected at the moment. Type &apos;connect&apos; to connect to the server or &apos;help&apos; for the list of supported commands.\n\n\n\n\n\n\n\n\n\n[disconnected /] embed-host-controller --jboss-home=~/workspace/jboss-eap-7.0/           \n\n\n\n\nWarning! The CLI is running in a non-modular environment and cannot load commands from management extensions.\n\n\n\n\n\n\n\n\n\n[domain@embedded /] stop-embedded-host-controller\n\n\n\n\nThe command is not available in the current context (e.g. required subsystems or connection to the controller might be unavailable).\n\n\n\n\n\n\n\n\n\n# only stop-embedded-server is available\n\n\n\n\n[domain@embedded /] s\n\n\n\n\nset  stop-embedded-server  \n\n\n\n\n\n\n\n\n\n# stop-embedded-host-controller command should be used for this\n\n\n\n\n[domain@embedded /] stop-embedded-server \n\n\n\n\n[disconnected /]\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR5", "fixed_version": "2.0.0.CR7", "fixed_files": ["org.wildfly.core.embedded.EmbeddedServerReference.java"], "label": 1, "es_results": []}, {"bug_id": 1043, "bug_title": "Show error message when accessing http management console of a slave host controller", "bug_description": "WFCORE-678 removed the selection of the ConsoleMode.SLAVE_HC console, to show the message: \"You may not access the admin console on this node, all access must come via the master host controller\" when you tried to access a slave host controller console.\nThat was the default behavior when you enabled the http management interface on a slave host controller (to access it using JON for monitoring, for example).", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR6", "fixed_version": "2.0.0.CR7", "fixed_files": ["org.jboss.as.host.controller.operations.HttpManagementAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1063, "bug_title": "Creating named datagram socket throws ISE", "bug_description": "The DatagramSocket createDatagramSocket(String name, SocketAddress address) method of org.jboss.as.network.SocketBindingManagerImpl creates a ManagedDatagramSocketBinding with a null name, yet registers the socket using the NamedManagedBindingRegistry.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR7", "fixed_version": "2.0.0.CR8", "fixed_files": ["org.jboss.as.network.SocketBindingManager.java", "org.jboss.as.network.SocketBindingManagerImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1064, "bug_title": "Creating named multicast socket does not properly register socket using name", "bug_description": "I&apos;m not sure why this is, but the socket binding manager ignores the name of the multicast socket and registers the socket using the unnamed registry.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR7", "fixed_version": "2.0.0.CR8", "fixed_files": ["org.jboss.as.network.SocketBindingManager.java", "org.jboss.as.network.SocketBindingManagerImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1062, "bug_title": "Deployments from the domain/data/content folder goes missing after few minutes if the Host controller is started with --backup option.", "bug_description": "Host controller started with --backup option deletes the deployments from the domain/data/content folder after approximately 10 mins. \nThe deployment is restored or recreated if the HostController is started. \nVersion-Release number of selected component (if applicable): 6.4.x\nHow reproducible:\nSteps to Reproduce:\n1. Setup domaincontroller \n2. Setup hostcontroller \n3. Start domaincontroller \n4. Start hostcontroller with --backup option.\n5. deploy an application using cli or admin console\n./jboss-cli.sh --connect --controller=x.x.x.x:9999 --command=&apos;deploy /PathToApp/App.war --server-groups=main-server-group&apos;\n6. deployments are available under $JBOSS_HOME/domain/data/content\n7. Wait for approximately 10 minutes\n8. Cached deployments are deleted on hostcontroller (domain/data/content is empty). Following is the logging seen on the console :\n++++++++++++++\n[Host Controller] 14:20:40,439 INFO  [org.jboss.as.repository] (Host Controller Service Threads - 4) JBAS014903: Content /NotBackedUp/JAR-Folder/EAPs/EAP6/jboss-eap-6.4.3-Patched/domain/data/content/47/1108a27fa1b82e6a92fb56ee25bc76f2625249 is obsolete and will be removed\n[Host Controller] 14:20:40,440 INFO  [org.jboss.as.repository] (Host Controller Service Threads - 4) JBAS014901: Content removed from location /NotBackedUp/JAR-Folder/EAPs/EAP6/jboss-eap-6.4.3-Patched/domain/data/content/47/1108a27fa1b82e6a92fb56ee25bc76f2625249/content\n++++++++++++++\n9. After restarting the Host Controller, the deployment is restored and the cached deployment can now be seen under the Host Controller&apos;s domain/data/content folder.\nActual results: Deployment folder form domain/data/content folder gets deleted after approx 10 mins and are restored if the Host Controller is restarted\nExpected results: The cached deplpyments folder should never be removed from the HostController&apos;s domain/data/content folder.  \nAdditional info: This does not affect the availability of the application since the applications are also availbale with the assigned server&apos;s under their data/content folder.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR7", "fixed_version": "2.0.0.CR8", "fixed_files": ["org.jboss.as.domain.controller.resources.DomainDeploymentResourceDefinition.java", "org.jboss.as.domain.controller.operations.deployment.DeploymentAddHandler.java", "org.jboss.as.controller.persistence.FilePersistenceUtils.java", "org.jboss.as.server.deployment.ContentCleanerService.java", "org.jboss.as.repository.ContentRepository.java"], "label": 1, "es_results": []}, {"bug_id": 1075, "bug_title": "Deploying a file results in HC logging \"WFLYCTL0019: Graceful shutdown\" warn on shutdown or reload", "bug_description": "Host Controllers frequently take 15 seconds to shutdown and reload, logging the following after a 15s pause:\n\n\n\n\n\n\nWFLYCTL0019: Graceful shutdown of the handler used for native management requests did not complete within [15000] ms but shutdown of the underlying communication channel is proceeding\n\n\n\n\n\n\nThis is because MasterDomainControllerOperationHandlerImpl and ServerToHostProtocolHandler both handle a GET_FILE_REQUEST by registering an ActiveOperation with ActiveOperationSupport, but then the GetFileOperation handlers for the request never call \"done\" or \"failed\" on the ActiveOperation.ResultHandler. The activeRequests map in the ActiveOperationSupport therefore ends up with extraneous data resulting in the shutdown delay.\nThis is also a minor memory leak.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR8", "fixed_version": "2.0.0.Final", "fixed_files": ["org.jboss.as.host.controller.mgmt.MasterDomainControllerOperationHandlerImpl.java", "org.jboss.as.domain.http.server.ManagementHttpRequestProcessor.java", "org.jboss.as.protocol.mgmt.ActiveOperationSupport.java", "org.jboss.as.host.controller.mgmt.ServerToHostProtocolHandler.java", "org.jboss.as.repository.RemoteFileRequestAndHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1086, "bug_title": "ManagementResourceRegistration.getCapabilities() does not account for override models", "bug_description": "ManagementResourceRegistration.getCapabilities() is implemented by simply reading the local state of ConcreteResourceRegistration. It needs to work like getAttributeNames(), by delegating to the root node which in turn uses NodeSubregistry to combine data from any singleton override registration and the corresponding wildcard registration.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR9", "fixed_version": "2.0.0.Final", "fixed_files": ["org.jboss.as.controller.registry.NodeSubregistry.java", "org.jboss.as.controller.registry.ConcreteResourceRegistration.java", "org.jboss.as.controller.registry.AliasResourceRegistration.java", "org.jboss.as.controller.registry.AbstractResourceRegistration.java", "org.jboss.as.controller.registry.ProxyControllerRegistration.java"], "label": 1, "es_results": []}, {"bug_id": 1087, "bug_title": "ManagementResourceRegistration.getOrderedChildTypes() does not account for override models", "bug_description": "ManagementResourceRegistration.getOrderedChildTypes() is implemented by simply reading the local state of ConcreteResourceRegistration. It needs to work like getAttributeNames(), by delegating to the root node which in turn uses NodeSubregistry to combine data from any singleton override registration and the corresponding wildcard registration.\nSame kind of problem as WFCORE-1086.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR9", "fixed_version": "2.0.0.Final", "fixed_files": ["org.jboss.as.controller.registry.NodeSubregistry.java", "org.jboss.as.controller.registry.ConcreteResourceRegistration.java", "org.jboss.as.controller.registry.AliasResourceRegistration.java", "org.jboss.as.controller.registry.AbstractResourceRegistration.java", "org.jboss.as.controller.registry.ProxyControllerRegistration.java"], "label": 1, "es_results": []}, {"bug_id": 1091, "bug_title": "Kerberos authentication for remoting on hostname which contains uppercase letter", "bug_description": "When EAP runs on server, which contains upper case in hostname (e.g. localhost.Localdomain), it  is unpossible to make kerberos authentication in remoting to work properly.\nJDK constructs TGT-REQ with lower case hostname. But remoting client create connection to EAP with upper case letters,  what because problems.\nRFC4120 \"The Kerberos Network Authentication Service\"  [1] in chapter \"6.2.1.  Name of Server Principals\" requires Where the name of the host is not case sensitive (for example, with Internet domain names) the name of the host MUST be lowercase.\nBased on information from RFC, IMHO, EAP should handle such scenario. Either remoting client should send lowercase hostname or security realm should map principal case insensitively and look for lower-case keytab record, e.g. remote/localhost.localdomain.\n[1] https://www.ietf.org/rfc/rfc4120.txt", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR9", "fixed_version": "2.0.2.Final", "fixed_files": ["org.jboss.as.domain.management.security.KeytabIdentityFactoryService.java", "org.jboss.as.domain.management.security.KeytabIdentityFactoryServiceTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1092, "bug_title": "ConfigurationChangeResourceRemoveHandler makes its changes in the constructor not in execute", "bug_description": "ConfigurationChangeResourceRemoveHandler is calling ConfigurationChangesCollector.deactivate() in its constructor. So deactivate gets called at early boot when the ConfigurationChangeResourceDefinition class gets loaded and the maxHistory is still 0, but never thereafter.\nA reload won&apos;t because it to get called again either, as ConfigurationChangeResourceDefinition is only constructed when the static INSTANCE member is initialized.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Final", "fixed_version": "2.0.2.Final", "fixed_files": ["org.jboss.as.domain.management.ConfigurationChangeResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 1143, "bug_title": "Cancel button in JConsole do nothing", "bug_description": "Description of problem:\nCancel button in JConsole do nothing. It should be removed from JConsole\nHow reproducible:\nAlways\nSteps to Reproduce:\n\ncd EAP_HOME\n./bin/standalone.sh &\n./bin/jconsole.sh\nClick to CLI tab\nClick to \"Cancel\" button\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Final", "fixed_version": "2.0.3.Final", "fixed_files": ["org.jboss.as.cli.gui.ConnectDialog.java"], "label": 1, "es_results": []}, {"bug_id": 1095, "bug_title": "Remove dependency on bouncycastle", "bug_description": "Core has a dependency on bouncycastle that AFAICT is not used. It was brought into core when a class from full&apos;s testsuite/shared was ported, but the core usage of the class has no need for the bouncycastle-related logic.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Final", "fixed_version": "2.0.5.CR1", "fixed_files": ["org.jboss.as.test.syslogserver.TLSSyslogServer.java"], "label": 1, "es_results": []}, {"bug_id": 1029, "bug_title": "ManagedSocketFactory does not work for client sockets", "bug_description": "SocketBindingManagerImpl does not work with client sockets.\nIt adds sockets to a map based on local address.  Client sockets that have not been bound yet do not have a local address.\nThis breaks the JGroups subsystem&apos;s ManagedSocketFactory, which uses SocketBindingManagerImpl for both server and client sockets.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.CR5", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.network.ManagedMulticastSocketBinding.java", "org.jboss.as.network.ManagedSocketBinding.java", "org.jboss.as.network.SocketBindingManager.java", "org.jboss.as.network.ManagedServerSocketBinding.java", "org.jboss.as.network.SocketBindingManagerImpl.java", "org.jboss.as.network.ManagedDatagramSocketBinding.java"], "label": 1, "es_results": []}, {"bug_id": 1644, "bug_title": "PersistenceResourceXmlDescription marshals attributes in the reverse order they are added", "bug_description": "This in marshalAttributes results in iterating over a reversed list:\n\n\n\n\n\n\n//we sort attributes to make sure that attributes that marshall to elements are last\n\n\n\n\nfor (AttributeDefinition ad : attributes.stream().sorted((o1, o2) -> o1.getParser().isParseAsElement() ? 1 : -1).collect(Collectors.toList())) {\n\n\n\n\n        \n\n\n\n\n\n\nThe sorter returning -1 for all non-element attributes has that effect.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.0.Final", "fixed_version": "2.2.0.CR6", "fixed_files": ["org.jboss.as.controller.PersistentResourceXMLDescription.java"], "label": 1, "es_results": []}, {"bug_id": 1120, "bug_title": "Launcher sets \"-Djava.net.preferIPv4Stack=true\" also with IPv6 profile", "bug_description": "Description of problem:\nDomain tests \"-Djava.net.preferIPv4Stack=true\" also with IPv6 profile. This property is set in AbstractCommandBuilder of WildFly-Core:\nhttps://github.com/wildfly/wildfly-core/blob/master/launcher/src/main/java/org/wildfly/core/launcher/AbstractCommandBuilder.java#L50\nThere should be option for disable of this option in arquillian.xml file. And testsuite should use this option with IPv6 profile.\nHow reproducible:\nAlways\nSteps to Reproduce:\n\n./integration-tests.sh -fae -Dmaven.test.failure.ignore=true -Dnode0=$MYTESTIPV6_1 -Dnode1=$MYTESTIPV6_2 -Dipv6 -Dts.manualmode -Dtest=OutboundLdapConnectionTestCase -DtestLogToFile=false -Djboss.dist=$JBOSS_DIST -Dts.noSmoke\n\nActual results:\n\n\n\n\n\n\n07:04:26,054 INFO  [org.jboss.as.arquillian.container.managed.ManagedDeployableContainer] (main) Starting container with: [/qa/tools/opt/jdk1.8.0_last/bin/java,\n\n\n\n\n...\n\n\n\n\n-Djava.net.preferIPv4Stack=true, -Djava.net.preferIPv4Stack=false\n\n\n\n\n...\n\n\n\n\n\n\nExpected results:\nEAP is not started with \"-Djava.net.preferIPv4Stack=true\" property with IPv6 profile\nAdditional info:\nJenkins reproducer job: https://jenkins.mw.lab.eng.bos.redhat.com/hudson/view/EAP7/view/EAP7-AS-Testsuite/view/EAP7-AS-Testsuite-Reproducers/job/eap-7x-as-ts-ipv6-arqillian/jdk=java18_default,label_exp=eap-sustaining&&RHEL6&&x86_64&&ipv6/2/console", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.1.Final", "fixed_version": "2.0.2.Final", "fixed_files": ["org.wildfly.core.launcher.CommandBuilderTest.java", "org.wildfly.core.launcher.Arguments.java"], "label": 1, "es_results": []}, {"bug_id": 1134, "bug_title": "A java.lang.Error in Stage.DONE can lead to hangs", "bug_description": "As part of investigating https://bugzilla.redhat.com/show_bug.cgi?id=1259767 I&apos;ve looked into general handling of situations when java.lang.Error is thrown during management operation execution.\nHandling prior to Stage.DONE looks ok, with the error caught, logged and the failure-description on the response set. But if the error happens after commit or during rollback, it isn&apos;t always properly triggering a response. In the intra-domain case the remote node that has the problem tries to send a failure response to the calling HC, but uses the wrong request id, resulting in that response being dropped and the calling HC continuing to wait.\nA post-commit Error seems pretty unlikely. A rollback error seems more possible, as a rollback may involve installing significant numbers of services.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.1.Final", "fixed_version": "2.0.5.CR1", "fixed_files": ["org.jboss.as.controller.remote.ModelControllerClientOperationHandler.java", "org.jboss.as.protocol.mgmt.ActiveOperationSupport.java", "org.jboss.as.test.integration.domain.suites.DomainTestSuite.java", "org.jboss.as.domain.controller.operations.coordination.DomainFinalResultHandler.java", "org.jboss.as.protocol.mgmt.ManagementRequestContext.java", "org.jboss.as.controller.remote.OperationAttachmentsProxy.java", "org.jboss.as.controller.remote.TransactionalProtocolOperationHandler.java", "org.jboss.as.protocol.mgmt.ActiveOperation.java", "org.jboss.as.controller.logging.ControllerLogger.java", "org.jboss.as.protocol.mgmt.ManagementResponseHeader.java", "org.jboss.as.controller.remote.ResponseAttachmentInputStreamSupportTestCase.java", "org.jboss.as.test.integration.domain.extension.ExtensionSetup.java", "org.jboss.as.protocol.mgmt.AbstractMessageHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1353, "bug_title": "Cannot clone or ad-hoc describe legacy extensions", "bug_description": "Trying to clone a profile that includes legacy extensions results in this failure (which is buried and not properly reported, but that&apos;s a different problem):\nWFLYCTL0309: Legacy extension &apos;org.jboss.as.web&apos; is not supported on servers running this version. The extension is only supported for use by hosts running a previous release in a mixed-version managed domain\nIt&apos;s created by UnsupportedSubsystemDescribeHandler.\nThat failure made some sense when the only use of the &apos;describe&apos; op was by an HC launching a domain server, but now &apos;describe&apos; is also an impl detail of the &apos;clone&apos; op, and describe may also be executed independently by users.\nWe need to distinguish the server launch case from other uses and only fail in the former.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.10.Final", "fixed_version": "2.1.0.CR2", "fixed_files": ["org.jboss.as.domain.controller.operations.ProfileDescribeHandler.java", "org.jboss.as.controller.operations.common.GenericSubsystemDescribeHandler.java", "org.jboss.as.threads.ThreadsSubsystemTestCase.java", "org.jboss.as.controller.extension.UnsupportedSubsystemDescribeHandler.java", "org.jboss.as.host.controller.DomainModelControllerService.java", "org.jboss.as.threads.ThreadsSubsystem11TestCase.java", "org.jboss.as.controller.descriptions.ModelDescriptionConstants.java"], "label": 1, "es_results": []}, {"bug_id": 1354, "bug_title": "Cannot clone a profile with a remoting subsystem but no io subsystem", "bug_description": "The remoting subsystem added a requirement for the new io subsystem&apos;s worker capability, but it has special logic such that the requirement is only added if an endpoint resource is configured. So, legacy configs (pre-io) won&apos;t have that resource, so there is no requirement.\nThis breaks down in the case of the profile &apos;clone&apos; op, as a placeholder resource we add for the endpoint (to allow reads of the default endpoint config data) ends up getting &apos;described&apos; and added by the cloning process. So that added resource triggers an unmet requirement for the io worker:\n\n\n\n\n\n\n[domain@localhost:9990 /] /profile=default:clone(to-profile=test)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => {\"domain-failure-description\" => \"WFLYCTL0369: Required capabilities are not available:\n\n\n\n\n    org.wildfly.io.worker.default in context &apos;profile=test&apos;; There are no known registration points which can provide this capability.\"},\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\nI&apos;m not sure how to deal with this; some sort of marker is needed to disable &apos;describing&apos; that placeholder resource.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.10.Final", "fixed_version": "2.1.0.CR2", "fixed_files": ["org.jboss.as.subsystem.test.AbstractSubsystemBaseTest.java", "org.jboss.as.remoting.RemotingExtension.java"], "label": 1, "es_results": []}, {"bug_id": 1369, "bug_title": "Audit logging to TCP syslog is stopped after syslog restart", "bug_description": "In case when audit logging to TCP syslog is enabled and syslog server is restarted then audit logging to syslog is stopped. UDP works correctly. It can be related to issue [1].\n[1] https://issues.jboss.org/browse/LOGMGR-123", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.10.Final", "fixed_version": "2.1.0.Final", "fixed_files": ["org.jboss.as.controller.audit.SyslogAuditLogHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1418, "bug_title": "Reloading host-controller via http-api puts the HC into unresponsive state", "bug_description": "Reloading host-controller via http-api puts the HC into unresponsive state.\nreproduce\n - create an administrative user admin:asdasd@2\n - start a domain\n - reload a server via http api\n\n\n\n\n\n\ncurl --digest -L -D - http://localhost:9990/management --header \"Content-Type: application/json\" -d &apos;{\"operation\":\"reload\",\"name\":\"\", \"address\":{\"host\" : \"master\"},\"json.pretty\":1}&apos; -you admin:asdasd@2\n\n\n\n\n\n\nactual\nDefault server instances are stopped, HC is left in unresponsive state.\nKeeping the domain alive, following message will appear in 5 minutes, domain will become responsive again after that.\n\n\n\n\n\n\n[Host  Controller] 04:47:23,966 ERROR  [org.jboss.as.controller.management-operation] (management task-7)  WFLYCTL0349: Timeout after [300] seconds waiting for service container  stability while finalizing an operation. Process must be restarted. Step  that first updated the service container was &apos;reload&apos; at address  &apos;[(\"host\" => \"master\")]&apos;\n\n\n\n\n\n\nexpected\nDomain is reloaded\nadditional info\nThe issue was introduced by fix for JBEAP-2751 - https://github.com/jbossas/wildfly-core-eap/commit/4986773a51fbf43ad911aecc403f7eb90e72a8c2\nthread dump of unresponsive HC\nhttp://pastebin.test.redhat.com/348732\nI am unable to reproduce locally, but issue can be easily reproduced on slower servers in MWQE lab. SSLMasterSlave*WayTestCase using reload via http-api cousing failures in domain modules of wf-core testsuite (e.g. eap-7x-as-testsuite-test-core-rhel )\nRegression against 7.0.0.ER4. I was able to reproduce with the latest wildfly-core bits as well (1be598e)\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.10.Final", "fixed_version": "2.1.0.Final", "fixed_files": ["org.jboss.as.server.operations.HttpManagementAddHandler.java", "org.jboss.as.host.controller.operations.HttpManagementAddHandler.java", "org.jboss.as.domain.http.server.DomainApiHandler.java", "org.jboss.as.server.mgmt.UndertowHttpManagementService.java", "org.jboss.as.domain.http.server.ManagementHttpServer.java"], "label": 1, "es_results": []}, {"bug_id": 1347, "bug_title": "StringListAttributeDefinition.unwrap does not take default value into account", "bug_description": "unwrap method should first call resolveMethodAttribute to get value of attribute and than do unwrapping.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.10.Final", "fixed_version": "2.1.0.Final", "fixed_files": ["org.jboss.as.controller.StringListAttributeDefinition.java", "org.jboss.as.controller.PropertiesAttributeDefinition.java", "org.jboss.as.controller.PropertiesAttributeDefinitionUnitTestCase.java", "org.jboss.as.controller.StringListAttributeDefinitionUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1346, "bug_title": "extension remove reports sucess even if the extension does not exist", "bug_description": "e.g.:\n[standalone@localhost:9999 /] /extension=garbage:remove\n{\"outcome\" => \"success\"}", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.10.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.controller.extension.ExtensionRemoveHandler.java", "org.wildfly.core.test.standalone.extension.remove.ExtensionRemoveTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1607, "bug_title": "Removing children of security-realm always finishes with {\"outcome\" => \"success\"}", "bug_description": "Removing children of security-realm (e.g. authentication) always finishes with \n{\"outcome\" => \"success\"}\n. This happens even if type of children of security-realm does not exist in server configuration. It should rather finish with failure to indicate that nothing was removed.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.10.Final", "fixed_version": "2.2.0.CR6", "fixed_files": ["org.jboss.as.domain.management.security.SecurityRealmChildRemoveHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1229, "bug_title": "Reloading the embed host controller logs ERROR messages", "bug_description": "Embed host controller sometime logs ERROR message while booting up after the reload (&apos;reload --host=master --admin-only=true&apos;).\n\n\n\n\n\n\nERROR [org.jboss.as.controller.management-operation] (main) WFLYCTL0013: Operation (\"read-attribute\") failed - address: ([(\"host\" => \"master\")]) - failure description: \"WFLYCTL0030: No resource definition is registered for address [(\\\"host\\\" => \\\"master\\\")]\"\n\n\n\n\n\n\nMy initial thought on this was that issue is reproducible only on virtualized systems as I saw the error only a few times on my local machine, but I tried some bare-metal servers in MWQE lab and the error poped-up quite often there.\nReproducer job (#6 and #7 ran with 7.0.0.ER2 bits) :\n - https://jenkins.mw.lab.eng.bos.redhat.com/hudson/job/eap-7x-cli-embed-host-reload/\nIn extreme cases, error can appear after every other reload operation (46 out of 99)\n - https://jenkins.mw.lab.eng.bos.redhat.com/hudson/job/eap-7x-cli-embed-host-reload/7/jdk=java1.8,label_exp=eap-sustaining&&EAP-RHEL7/console", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.2.Final", "fixed_version": "2.0.8.Final", "fixed_files": ["org.jboss.as.domain.controller.operations.coordination.PrepareStepHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1159, "bug_title": "Add a runtime operation which shows filesystem usage and availability for known server locations", "bug_description": "For management purposes it would be very useful to report runtime metrics for filesystem usage and availability for known server locations (data, tmp, logs, etc).", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.2.Final", "fixed_version": "3.0.0.Alpha4", "fixed_files": ["org.jboss.as.logging.LoggingExtension.java", "org.jboss.as.logging.PeriodicSizeRotatingHandlerResourceDefinition.java", "org.wildfly.core.test.standalone.mgmt.BasicOperationsUnitTestCase.java", "org.jboss.as.logging.AbstractFileHandlerDefinition.java", "org.jboss.as.controller.services.path.PathResourceDefinition.java", "org.jboss.as.server.deployment.DeploymentAddHandlerTestCase.java", "org.jboss.as.server.deployment.scanner.DeploymentScannerDefinition.java", "org.jboss.as.logging.FileHandlerResourceDefinition.java", "org.jboss.as.logging.PeriodicHandlerResourceDefinition.java", "org.jboss.as.server.ServerEnvironmentResourceDescription.java", "org.jboss.as.host.controller.descriptions.HostEnvironmentResourceDefinition.java", "org.jboss.as.logging.SizeRotatingHandlerResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 1168, "bug_title": "Incorrect null check in SimpleResourceDefinition.Parameter.setDeprecatedSince", "bug_description": "The null check checks the field being assigned instead of the param passed in:\n\n\n\n\n\n\n        public Parameters setDeprecatedSince(ModelVersion deprecatedSince) {\n\n\n\n\n            if (deprecationData == null) { // <-- OOPS!\n\n\n\n\n                throw ControllerLogger.ROOT_LOGGER.nullVar(\"deprecatedSince\");\n\n\n\n\n            }\n\n\n\n\n\n\n\n\n\n            this.deprecationData = new DeprecationData(deprecatedSince);\n\n\n\n\n\n\nThe field will always be null, making this method useless.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.3.Final", "fixed_version": "2.0.4.Final", "fixed_files": ["org.jboss.as.controller.SimpleResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 1166, "bug_title": "CompositeTransformer does not transform addresses", "bug_description": "If /some=where has a child redirection for the child=* child resource to new-child=*, then\n\n\n\n\n\n\n{\n\n\n\n\n    \"operation\" => \"add\",\n\n\n\n\n    \"address\" => [\n\n\n\n\n        (\"some\" => \"where\"),\n\n\n\n\n        (\"child\" => \"*\")\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n\ngets correctly transformed to \n\n\n\n\n\n\n{\n\n\n\n\n    \"operation\" => \"add\",\n\n\n\n\n    \"address\" => [\n\n\n\n\n        (\"some\" => \"where\"),\n\n\n\n\n        (\"new-child\" => \"*\")\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n\nBut if wrapped in a composite, e.g.:\n\n\n\n\n\n\n{\n\n\n\n\n    \"operation\" => \"composite\",\n\n\n\n\n    \"address\" => [],\n\n\n\n\n    \"steps\" => [\n\n\n\n\n        {\n\n\n\n\n            \"operation\" => \"add\",\n\n\n\n\n            \"address\" => [\n\n\n\n\n                (\"some\" => \"where\"),\n\n\n\n\n                (\"child\" => \"*\")\n\n\n\n\n            ]\n\n\n\n\n        }\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n\nthe redirection does not happen in the transformed composite, so we have the original\n\n\n\n\n\n\n{\n\n\n\n\n    \"operation\" => \"composite\",\n\n\n\n\n    \"address\" => [],\n\n\n\n\n    \"steps\" => [\n\n\n\n\n        {\n\n\n\n\n            \"operation\" => \"add\",\n\n\n\n\n            \"address\" => [\n\n\n\n\n                (\"some\" => \"where\"),\n\n\n\n\n                (\"child\" => \"*\")\n\n\n\n\n            ]\n\n\n\n\n        }\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n\nrather than the expected\n\n\n\n\n\n\n{\n\n\n\n\n    \"operation\" => \"composite\",\n\n\n\n\n    \"address\" => [],\n\n\n\n\n    \"steps\" => [\n\n\n\n\n        {\n\n\n\n\n            \"operation\" => \"add\",\n\n\n\n\n            \"address\" => [\n\n\n\n\n                (\"some\" => \"where\"),\n\n\n\n\n                (\"new-child\" => \"*\")\n\n\n\n\n            ]\n\n\n\n\n        }\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.3.Final", "fixed_version": "2.0.4.Final", "fixed_files": ["org.jboss.as.controller.transform.description.ChildRedirectTestCase.java", "org.jboss.as.controller.transform.CompositeOperationTransformer.java"], "label": 1, "es_results": []}, {"bug_id": 1171, "bug_title": "Host Controller HttpManagementResourceDefinition does not register \"org.wildfly.management.http-interface\" capability", "bug_description": "The add/remove handlers register the capability, but it got missed with the MRR.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.3.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.host.controller.operations.HttpManagementAddHandler.java", "org.jboss.as.host.controller.resources.HttpManagementResourceDefinition.java", "org.jboss.as.host.controller.operations.HttpManagementRemoveHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1170, "bug_title": "GenericOutboundConnectionResourceDefinition does not register the \"org.wildfly.remoting.outbound-connection\" capability", "bug_description": "Title says it all. This variant of the outbound-connection resources was missed when I added capabilities.\nAbstractOutboundConnectionResourceDefinition can take care of this for all the variants and we can remove the registration from the various add/remove handlers.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.3.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.remoting.AbstractOutboundConnectionResourceDefinition.java", "org.jboss.as.remoting.LocalOutboundConnectionResourceDefinition.java", "org.jboss.as.remoting.RemoteOutboundConnectionAdd.java", "org.jboss.as.remoting.ConnectorRemove.java", "org.jboss.as.remoting.RemoteOutboundConnectionResourceDefinition.java", "org.jboss.as.remoting.ConnectorAdd.java", "org.jboss.as.remoting.ConnectorResource.java", "org.jboss.as.remoting.LocalOutboundConnectionAdd.java"], "label": 1, "es_results": []}, {"bug_id": 1188, "bug_title": "Exiting CLI requires stty sane command to be issued on Linux", "bug_description": "The PR https://github.com/wildfly/wildfly-core/pull/1268/ seemed to have introduced a regression where some times (seems to be most in my case) stty sane is required to get a she will back to normal. My guess is it&apos;s the aesh upgrade, but I&apos;m not certain on that so I&apos;ll start the JIRA here and it can be moved to AESH if necessary.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.4.Final", "fixed_version": "2.0.5.CR1", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java", "org.jboss.as.cli.impl.Console.java"], "label": 1, "es_results": []}, {"bug_id": 1212, "bug_title": "TestModule does not clean up after itself properly", "bug_description": "TestModule.create() calls mkdirs() to create its filesystem structure, but remove() only removes the dir above &apos;main&apos; and below, leaving behind intermediate dirs.\nThe result of this is if you run the full testsuite with -Dts.basic, the dist/target/wildflyxxx/modules dir ends up with child dir &apos;test&apos; in addition to the proper &apos;system&apos;.\nI&apos;m not sure why this spurious dir doesn&apos;t end up in the final dists we publish. Perhaps its just luck due to the release process not running the testsuite when the final build with the &apos;deploy&apos; target is invoked. I know my process for releasing WildFly Core doesn&apos;t re-run tests in that step.\nOnce remove() does its current work it should walk up the filesystem tree until it gets to the file returned by getModulesDir(). For each level in the tree it should check if that file is a dir with no children and if it is it should remove the dir. \nhttps://issues.jboss.org/browse/JBEAP-2374", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.4.Final", "fixed_version": "2.0.5.CR1", "fixed_files": ["org.jboss.as.test.module.util.TestModule.java"], "label": 1, "es_results": []}, {"bug_id": 1213, "bug_title": "Graceful shutdown is interfering with the 'kill' and 'destroy' operations", "bug_description": "The &apos;kill&apos; and &apos;destroy&apos; operations on the HC are meant to force shutdown of misbehaving servers. But the graceful shutdown work ([1]) has introduced a management op into the mix. I believe that should be removed, as its not the intent of these operations to try and be graceful; the regular &apos;stop&apos; ops are for that.\nWhen experimenting with how domains react to OOME servers as part of my WFCORE-378 work I&apos;m seeing &apos;kill&apos; and &apos;destroy&apos; no longer function because the OOME on the server means the graceful shutdown management op hangs.\n[1] https://github.com/wildfly/wildfly-core/commit/6e95b5#different-ecdfa997cd57af67393e4962b54ead64", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.4.Final", "fixed_version": "2.0.5.CR1", "fixed_files": ["org.jboss.as.host.controller.ServerInventoryImpl.java", "org.jboss.as.host.controller.ManagedServer.java"], "label": 1, "es_results": []}, {"bug_id": 1210, "bug_title": "Transformations are not triggered for aliases", "bug_description": "Currently only operations passed in to the controller by the client are passed over to the transformers. So if you have an alias /an=alias mapping to /some=resource, and a transformer mapped for /some=resource:\n    /some=resource:add gets transformed\n   /an=alias:add does not get transformed.\nBehind the scenes /an=alias:add ends up in AliasStepHandler, which adds the step to invoke the real /some=resource:add. Unfortunately the /some=resource:add does not get passed to the transformers.\nThe transformer framework should use the same logic as AliasStepHandler to map the alias to the real address and the transform that.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.4.Final", "fixed_version": "2.0.5.CR1", "fixed_files": ["org.jboss.as.controller.registry.AliasEntry.java", "org.jboss.as.controller.transform.TransformersImpl.java", "org.jboss.as.controller.transform.CompositeOperationTransformer.java"], "label": 1, "es_results": []}, {"bug_id": 1209, "bug_title": "jboss-cli.sh ignoring invalid attribute when used in batch mode", "bug_description": "CLI did not throw any error message and just ignored the invalid attribute while using in batch mode.If we use same CLI command in non-batch mode it throws exception.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.4.Final", "fixed_version": "2.0.5.Final", "fixed_files": ["org.jboss.as.cli.Util.java", "org.jboss.as.cli.handlers.OperationRequestHandler.java", "org.jboss.as.cli.handlers.batch.BatchRunHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1198, "bug_title": "CLI does not resolve multiple properties if one property is undefined", "bug_description": "https://bugzilla.redhat.com/show_bug.cgi?id=1289316 description:\n\n\n\n\n\n\nMultiple property substitution is working with EAP 6.4.3+, however, if a variable amongst the multiple variables is empty or has no value, then the subsequent property in the CLI command is not substituted. \n\n\n\n\n\n\n\n\n\nFor example : \n\n\n\n\ncat props.properties \n\n\n\n\n-----------------------------------------\n\n\n\n\nPROFILE-NAME=TestProfile\n\n\n\n\nSERVER-INSTANCE-NUMBER=TestInstance\n\n\n\n\nAPP-VERSION=\n\n\n\n\nVAR=test\n\n\n\n\n-----------------------------------------\n\n\n\n\n\n\n\n\n\ncat test.cli :\n\n\n\n\n---------------------------------------\n\n\n\n\n/host=master/server-config=${PROFILE-NAME}${APP-VERSION}${SERVER-INSTANCE-NUMBER}${VAR}:add(auto-start=true, group=\"${PROFILE-NAME}${APP-VERSION}-server-group\")\n\n\n\n\n---------------------------------------\n\n\n\n\n\n\n\n\n\nand if I execute \"./jboss-cli.sh --connect --file=test.cli --properties=props.properties\" then I have the following in the host.xml \": \n\n\n\n\n\n\n\n\n\n----------\n\n\n\n\n...\n\n\n\n\n<server name=\"TestProfile${SERVER-INSTANCE-NUMBER}test\" group=\"TestProfile-server-group\" auto-start=\"true\"/>\n\n\n\n\n...\n\n\n\n\n-----------\n\n\n\n\n\n\n\n\n\nNote APP-VERSION had no value, and so the subsequent SERVER-INSTANCE-NUMBER was not properly resolved\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.4.Final", "fixed_version": "2.0.5.Final", "fixed_files": ["org.jboss.as.cli.parsing.ExpressionBaseState.java", "org.jboss.as.cli.parsing.test.PropertyReplacementTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1226, "bug_title": "undeploying disabled deployment stops service for same runtime-name in DeploymentUndeployHandler ", "bug_description": "\n\n\n\n\n\n1. Start EAP 6.4.4 in domain mode and deploy application using following CLI command:\n\n\n\n\n~~\n\n\n\n\n[domain@localhost:9999 /] deploy /Applications/WebApp-1.war --server-groups=main-server-group --name=WebApp-1.war --runtime-name=WebApp-1.war\n\n\n\n\n~~~\n\n\n\n\n2. Deploy next version of application in \"disabled\" state with same \"runtime-name\"  \n\n\n\n\n~~~\n\n\n\n\n[domain@localhost:9999 /] deploy /Applications/WebApp-2.war --disabled --name=WebApp-2.war --runtime-name=WebApp-1.war \n\n\n\n\n~~~\n\n\n\n\n\n\n\n\n\n3. Now use replace-deployment command to access latest version of application:\n\n\n\n\n~~~\n\n\n\n\n[domain@localhost:9999 /] /server-group=main-server-group:replace-deployment(name=WebApp-2.war,to-replace=WebApp-1.war)\n\n\n\n\n~~~\n\n\n\n\nits working fine,laest version of application is accessable.\n\n\n\n\n\n\n\n\n\n4. Now try to undeploy old version of application\n\n\n\n\n~~~\n\n\n\n\n/server-group=main-server-group/deployment=WebApp-1.war:undeploy()\n\n\n\n\n~~~\n\n\n\n\nAfter undploying older version, we are not able to access(404) latest version of application(WebApp-2.war) as well.To access it we have to redeploy it. \n\n\n\n\nSame steps are working fine in Standalone mode.\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.4.Final", "fixed_version": "2.0.6.Final", "fixed_files": ["org.jboss.as.server.deployment.DeploymentUndeployHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1232, "bug_title": "Adjust patching tests to use merged patches", "bug_description": "WFCORE-838 introduced a new way of joining multiple patches together - merging them into one. This needs some test coverage in patching TS.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.4.Final", "fixed_version": "2.0.8.Final", "fixed_files": ["org.jboss.as.test.integration.management.util.CLIWrapper.java", "org.jboss.as.test.patching.CliUtilsForPatching.java", "org.jboss.as.test.patching.PatchingTestUtil.java"], "label": 1, "es_results": []}, {"bug_id": 1240, "bug_title": "RestartParentWriteAttributeHandler.revertUpdateToRuntime is calling deprecated recreateParentService variant", "bug_description": "Calling the deprecated variant forces the user to override the deprecated one.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.5.CR1", "fixed_version": "2.0.5.Final", "fixed_files": ["org.jboss.as.controller.RestartParentWriteAttributeHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1261, "bug_title": "Changing the max-history attribute value for configuration-changes fails", "bug_description": "[standalone@localhost:9990 /] /core-service=management/service=configuration-changes:write-attribute(name=max-history,value=20)\n{\n\n\"outcome\" => \"failed\",\n\n\"failure-description\" => \"WFLYCTL0158: Operation handler failed: java.lang.IllegalStateException: WFLYCTL0188: Stage MODEL is already complete\",\n\n\"rolled-back\" => true\n\n}", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.5.Final", "fixed_version": "2.0.6.Final", "fixed_files": ["org.jboss.as.domain.management.ConfigurationChangeResourceDefinition.java", "org.wildfly.core.test.standalone.mgmt.api.core.ConfigurationChangesHistoryTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1292, "bug_title": "SocketBindingManager.createMulticast/DatagramSocket(...) variants needed for unbound sockets", "bug_description": "In order to modify the SO_REUSEADDR option of a multicast or datagram socket, the socket must be unbound - otherwise the behavior is undefined.  See:\nhttp://docs.oracle.com/javase/8/docs/api/java/net/DatagramSocket.html#setReuseAddress-boolean-\nTo support this (as required for JGroups 3.6.7.Final), SocketBindingManager needs methods to create unbound datagram/multicast sockets.  The current methods that accept a SocketAddress throw an ISE when a null address is used.\nSetting priority to blocker to encourage inclusion into 2.0.x.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.5.Final", "fixed_version": "2.0.8.Final", "fixed_files": ["org.jboss.as.network.SocketBindingManager.java", "org.jboss.as.network.SocketBindingManagerImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1257, "bug_title": "support query filter implementation in MBeanServerConnection", "bug_description": "There is no implementation for query filter in MBeanServerConnection, marked as TODO\n\n\n\n\n\n\nModelControllerMBeanHelper.java\n\n\n\n\n\n\n    Set<ObjectName> queryNames(final ObjectName name, final QueryExp query) {\n\n\n\n\n        return new RootResourceIterator<Set<ObjectName>>(accessControlUtil, getRootResourceAndRegistration().getResource(),\n\n\n\n\n                new ObjectNameMatchResourceAction<Set<ObjectName>>(name) {\n\n\n\n\n\n\n\n\n\n            Set<ObjectName> set = new HashSet<ObjectName>();\n\n\n\n\n\n\n\n\n\n            @Override\n\n\n\n\n            public boolean onResource(ObjectName resourceName) {\n\n\n\n\n                if (name == null || name.apply(resourceName)) {\n\n\n\n\n                    //TODO check query\n\n\n\n\n                    set.add(resourceName);\n\n\n\n\n                }\n\n\n\n\n                return true;\n\n\n\n\n            }\n\n\n\n\n\n\n\n\n\n            @Override\n\n\n\n\n            public Set<ObjectName> getResult() {\n\n\n\n\n                if (set.size() == 1 && set.contains(ModelControllerMBeanHelper.createRootObjectName(domain))) {\n\n\n\n\n                  return Collections.emptySet();\n\n\n\n\n                }\n\n\n\n\n                return set;\n\n\n\n\n            }\n\n\n\n\n        }).iterate();\n\n\n\n\n    }\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.5.Final", "fixed_version": "2.0.8.Final", "fixed_files": ["org.jboss.as.jmx.model.ModelControllerMBeanHelper.java", "org.jboss.as.jmx.ModelControllerMBeanTestCase.java", "org.jboss.as.jmx.model.ModelControllerMBeanServerPlugin.java", "org.jboss.as.jmx.MBeanServerService.java"], "label": 1, "es_results": []}, {"bug_id": 1263, "bug_title": "MBeanServer.queryMBeans will include the ObjectInstance for the root mbean for the jboss.as[.expr] JMX domains", "bug_description": "ModelControllerMBeanHelper.queryMBeans is incorrectly checking for the presence of the root mbean by seeing if a Set<ObjectInstance> contains an ObjectName. Wrong type.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.5.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.jmx.model.ModelControllerMBeanHelper.java"], "label": 1, "es_results": []}, {"bug_id": 1260, "bug_title": "Capability resolution complaints on admin-only slave HCs not connected to the master", "bug_description": "If you start a slave HC in admin-only with no master to connect to, boot is fine but then any modifications made to the config result in capability resolution ERROR messages in the host-controller.log\nStarting a slave HC in admin-only with no master to connect to is meant to work, allowing you to use CLI to manipulate the slave&apos;s host config:\n\n\n\n\n\n\nbin/domain.sh --host-config=host-slave.xml --admin-only -Djboss.domain.master.address=127.0.0.1\n\n\n\n\n\n\nThe boot is fine:\n\n\n\n\n\n\n[Host Controller] 11:06:10,639 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0025: WildFly Full 10.0.0.Final-SNAPSHOT (WildFly Core 2.0.5.Final) (Host Controller) started in 1152ms - Started 41 of 42 services (12 services are lazy, passive or on-demand)\n\n\n\n\n\n\nHowever, subsequent changes made via management tools (e.g. CLI) succeed but result in ERROR logging by the HC:\n\n\n\n\n\n\n[domain@127.0.0.1:9999 /] /host=localhost/system-property=foo:add(value=bar)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => undefined,\n\n\n\n\n    \"server-groups\" => undefined\n\n\n\n\n}\n\n\n\n\n\n\nThe HC&apos;s log:\n\n\n\n\n\n\n[Host Controller] 11:07:37,744 ERROR [org.jboss.as.controller] (management-handler-thread - 4) WFLYCTL0369: Required capabilities are not available:\n\n\n\n\n[Host Controller]     org.wildfly.domain.server-group.other-server-group in context &apos;server-config&apos;; There are no known registration points which can provide this capability.\n\n\n\n\n[Host Controller]     org.wildfly.domain.server-group.main-server-group in context &apos;server-config&apos;; There are no known registration points which can provide this capability.\n\n\n\n\n\n\nThe boot works without logging because of the enhancement Stuart added such that capability reference failures won&apos;t fail an admin-only boot, thus letting the user use admin-only to fix the config. But then with subsequent changes, the user gets ERRORs notifying them of the unfixed references.\nBut in this case, the references will never be available, so long as there is no connection to a master to provide the domain-wide config.\nThis is a general case that needs to be accounted for in the capability resolution logic.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.5.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.controller.AbstractControllerService.java", "org.jboss.as.controller.ModelControllerImpl.java", "org.jboss.as.host.controller.DomainModelControllerService.java", "org.jboss.as.host.controller.RemoteDomainConnectionService.java", "org.jboss.as.controller.OperationContextImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1297, "bug_title": "deploy --url command creates invalid deployment", "bug_description": "Command deploy --url=http://localhost/test/simple-servlet.war\ncreates invalid deployment\nAccording to logs everything seems to be fine\n\n\n\n\n\n\n15:03:57,505 INFO  [org.jboss.as.repository] (management-handler-thread - 2) WFLYDR0001: Content added at location /tmp/jboss-eap-7.0/standalone/data/content/5e/5e5709be9a06a9ed7bcb2100a4143400fea887/content\n\n\n\n\n15:03:57,531 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-4) WFLYSRV0027: Starting deployment of \"/test/simple-servlet.war\" (runtime-name: \"/test/simple-servlet.war\")\n\n\n\n\n15:03:58,238 INFO  [org.wildfly.extension.undertow] (ServerService Thread Pool -- 62) WFLYUT0021: Registered web context: //test/simple-servlet\n\n\n\n\n15:03:58,320 INFO  [org.jboss.as.server] (management-handler-thread - 2) WFLYSRV0010: Deployed \"/test/simple-servlet.war\" (runtime-name : \"/test/simple-servlet.war\")\n\n\n\n\n\n\nbut web context http://localhost:8080//test/simple-servlet isn&apos;t accessible, it returns 404 - Not Found. \n(simple-servlet.war doesn&apos;t contain jboss-web.xml, so no context root is defined there)\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.6.Final", "fixed_version": "2.0.8.Final", "fixed_files": ["org.jboss.as.cli.handlers.DeployHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1331, "bug_title": "CLI input redirection regression", "bug_description": "The original issue WFCORE-877 was fixed but later re-introduced with the fix for WFCORE-1218.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.7.Final", "fixed_version": "2.0.8.Final", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java", "org.jboss.as.cli.impl.Console.java"], "label": 1, "es_results": []}, {"bug_id": 1311, "bug_title": "WFCORE-893 Fix breaks mixed-domain", "bug_description": "The WFCORE-893 fix breaks mixed-domain use cases by adding subsystem=io if its not present. That&apos;s ok for standalone, but in a domain it means a subsystem not understood by legacy slaves will get added into profiles used by those slaves. Which will fail.\nI&apos;ve considered doing some sort of transformer trick to discard this subsystem if its config is default, but I suspect it&apos;s better to just not do the WFCORE-893 thing on the DC.\nDiscarding might be ok if we just do a resource transformer discard but reject all ops thereafter. Idea being that if the io config is default, matching what legacy slaves did, then we let the slave boot. Then any subsequent op must be either pointless or moving away from default, and must be rejected.\nBut still, just not doing the WFCORE-893 thing on the DC is probably better. Or at least simpler right now.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.7.Final", "fixed_version": "2.0.8.Final", "fixed_files": ["org.jboss.as.remoting.RemotingExtension.java"], "label": 1, "es_results": []}, {"bug_id": 1333, "bug_title": "Editing of default deployment scanner's relative-to attribute can cause server crash", "bug_description": "Setting value of relative-to attribute of default deployment scanner on standalone server to a path which does not exists in file system causes server crash.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.7.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.server.deployment.scanner.DeploymentScannerDefinition.java", "org.jboss.as.server.deployment.scanner.logging.DeploymentScannerLogger.java"], "label": 1, "es_results": []}, {"bug_id": 1315, "bug_title": "Double prompt when connecting to a new HC", "bug_description": "I observed this with 0.66.3 in a kind of franken-build of EAP 7. The logical equivalent would be 2.0.8.Final once WFCORE-1277 is fixed.\n\n\n\n\n\n\n[domain@localhost:9990 core-service=discovery-options] connect 127.0.0.1:29990\n\n\n\n\n[disconnected core-service=discovery-options] [domain@127.0.0.1:29990 core-service=discovery-options] cd /\n\n\n\n\n[domain@127.0.0.1:29990 /]\n\n\n\n\n\n\nBefore the first line I had killed the HC at localhost:9990, so then I wanted to connect to another HC. Got a double prompt.\nNot a big deal, but I wanted to record it.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.0.8.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java", "org.jboss.as.cli.impl.Console.java"], "label": 1, "es_results": []}, {"bug_id": 1406, "bug_title": "CLI client freezes for undefined security realm", "bug_description": "During work, CLI freezes randomly. See attached thread dump which was taken on Fedora 23.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "2.1.0.Final", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1432, "bug_title": "PersistentResourceXMLDescription#marshallAttributes does not marshall defined values if they match default values", "bug_description": "", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "2.1.0.Final", "fixed_files": ["org.jboss.as.controller.PersistentResourceXMLDescription.java"], "label": 1, "es_results": []}, {"bug_id": 1394, "bug_title": "default maxPermgen is added when jvm is not configured ", "bug_description": "Default maxPermgen size is added when jvm element isn&apos;t specified in domain.xml/host.xml and warning is logged. \n\n\n\n\n\n\n<server-group name=\"main-server-group\" profile=\"default\">\n\n\n\n\n<!--            \n\n\n\n\n    <jvm name=\"default\">\n\n\n\n\n        <heap size=\"64m\" max-size=\"512m\"/>\n\n\n\n\n    </jvm>\n\n\n\n\n-->\n\n\n\n\n    <socket-binding-group ref=\"standard-sockets\"/>\n\n\n\n\n</server-group>\n\n\n\n\n\n\n\n\n\n\n\n\nWFLYHC0011: Ignoring <permgen> for jvm &apos;SUN&apos; type jvm: null\n\n\n\n\n\n\nIt happens because default is defined in JvmElement.java#L76\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "2.1.0.Final", "fixed_files": ["org.jboss.as.host.controller.model.jvm.JvmElement.java"], "label": 1, "es_results": []}, {"bug_id": 1370, "bug_title": "All configuration changes have the same operation date", "bug_description": " When I list the changes, the operation date for all of the changes are the same, and seem to be the date/time when the `list-changes` operation is performed.  I tried this just now with ER5:", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.controller.ConfigurationChangesCollector.java"], "label": 1, "es_results": []}, {"bug_id": 1397, "bug_title": "Boot errors and unmanageable server if http-interface resource's http-upgrade-enabled attribute != true", "bug_description": "The https://github.com/wildfly/wildfly-core/pull/1360 work added a new XnioWorker service that the HTTP interface depends on, but for a standalone server it isn&apos;t installed unless http-upgrade-enabled == true. Otherwise you see this during boot:\n\n\n\n\n\n\n 15:43:25,005 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (\"add\") failed - address: ([\n\n\n\n\n    (\"core-service\" => \"management\"),\n\n\n\n\n    (\"management-interface\" => \"http-interface\")\n\n\n\n\n]) - failure description: {\"WFLYCTL0180: Services with missing/unavailable dependencies\" => [\n\n\n\n\n    \"jboss.serverManagement.controller.management.http is missing [jboss.serverManagement.controller.management.worker]\",\n\n\n\n\n    \"jboss.serverManagement.controller.management.http.shutdown is missing [jboss.remoting.management.channel.registry]\"\n\n\n\n\n]}\n\n\n\n\n15:43:25,006 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (\"add\") failed - address: ([\n\n\n\n\n    (\"subsystem\" => \"jmx\"),\n\n\n\n\n    (\"remoting-connector\" => \"jmx\")\n\n\n\n\n]) - failure description: {\"WFLYCTL0180: Services with missing/unavailable dependencies\" => [\"jboss.jmx.remoting-connector-ref is missing [jboss.remoting.endpoint.management]\"]}\n\n\n\n\n15:43:25,031 INFO  [org.jboss.as.controller] (Controller Boot Thread) WFLYCTL0183: Service status report\n\n\n\n\nWFLYCTL0184:    New missing/unsatisfied dependencies:\n\n\n\n\n      service jboss.remoting.endpoint.management (missing) dependents: [service jboss.jmx.remoting-connector-ref] \n\n\n\n\n      service jboss.remoting.management.channel.registry (missing) dependents: [service jboss.serverManagement.controller.management.http.shutdown] \n\n\n\n\n      service jboss.serverManagement.controller.management.worker (missing) dependents: [service jboss.serverManagement.controller.management.http] \n\n\n\n\n\n\n\n\n\n15:43:25,127 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0063: Http management interface is not enabled\n\n\n\n\n15:43:25,128 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0054: Admin console is not enabled\n\n\n\n\n15:43:25,128 ERROR [org.jboss.as] (Controller Boot Thread) WFLYSRV0026: JBoss EAP 7.0.0.GA (WildFly Core 2.0.12.Final-redhat-1) started (with errors) in 3493ms - Started 254 of 544 services (3 services failed or missing dependencies, 369 services are lazy, passive or on-demand)\n\n\n\n\n\n\nThe problem is org.jboss.as.server.operations.HttpManagementAddHandler doesn&apos;t install the service. The HC variant of HttpManagementAddHandler does.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.server.operations.NativeManagementServices.java", "org.jboss.as.server.operations.HttpManagementAddHandler.java", "org.jboss.as.server.operations.NativeManagementAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1398, "bug_title": "RemotingHttpUpgradeService.SERVICE_NAME has a superfluous space", "bug_description": "public static final ServiceName UPGRADE_SERVICE_NAME = ServiceName.JBOSS.append(\"remoting \", \"remoting-http-upgrade-service\");\nNote the space in \"remoting \"", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.remoting.RemotingHttpUpgradeService.java"], "label": 1, "es_results": []}, {"bug_id": 1428, "bug_title": "log-file.stream attribute is of type LONG but contains a string", "bug_description": "The stream attribute of the log-file resource is of type LONG, but contains a UUID (string). This leads to an error in the console where I rely on proper attribute data types.  \n/subsystem=logging/log-file=*:read-resource-description\n/subsystem=logging/log-file=*:read-resource(include-runtime=true)", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.logging.LogFileResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 1439, "bug_title": "Allow for testsuite to pass on French OS", "bug_description": "Some tests are checking failure message or exception message as if the Locale is always English. Fixing those", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.test.manualmode.management.cli.ManagementOpTimeoutTestCase.java", "org.jboss.as.server.deployment.scanner.XmlCompletionScannerTest.java", "org.jboss.as.server.deployment.scanner.XmlCompletionScanner.java", "org.jboss.as.test.integration.mgmt.access.ConfigurationChangesHistoryTestCase.java", "org.jboss.as.server.deployment.scanner.logging.DeploymentScannerLogger.java", "org.jboss.as.test.integration.mgmt.access.ValidateAddressOrOperationTestCase.java", "org.jboss.as.test.integration.domain.suites.ResponseStreamTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1420, "bug_title": "CLI shutdown command does not support graceful shutdown", "bug_description": "The shutdown command needs to support a timeout param so users can have a graceful shutdown.\nI&apos;m calling this a bug because the low level :shutdown op is not reliable for CLI users due to the issues with handling of connection closing that the shutdown command takes care of.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "2.1.0.Final", "fixed_files": ["org.jboss.as.cli.Util.java", "org.jboss.as.cli.handlers.ShutdownHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1435, "bug_title": "Users with low privileges can see logged operations they should not be able to see", "bug_description": "If a SuperUser performs for example this:\n\n\n\n\n\n\n/core-service=management/access=audit/in-memory-handler=y:add   \n\n\n\n\n/core-service=management/access=audit/in-memory-handler=y:write-attribute(name=max-history,value=50)\n\n\n\n\n\n\nthen a Monitor user shouldn&apos;t be able to see this in the configuration change log (as decided in EAP7-89), because he doesn&apos;t even have the permission to \"read\" the manipulated resource.. But actually he can see it:\n\n\n\n\n\n\n/core-service=management/service=configuration-changes:list-changes\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [\n\n\n\n\n        {\n\n\n\n\n            \"operation-date\" => \"2016-03-15T08:40:25.807Z\",\n\n\n\n\n            \"access-mechanism\" => \"NATIVE\",\n\n\n\n\n            \"remote-address\" => \"127.0.0.1/127.0.0.1\",\n\n\n\n\n            \"outcome\" => \"success\",\n\n\n\n\n            \"operations\" => [{\n\n\n\n\n                \"operation\" => \"write-attribute\",\n\n\n\n\n                \"address\" => [\n\n\n\n\n                    (\"core-service\" => \"management\"),\n\n\n\n\n                    (\"access\" => \"audit\"),\n\n\n\n\n                    (\"in-memory-handler\" => \"y\")\n\n\n\n\n                ]\n\n\n\n\n            }]\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"operation-date\" => \"2016-03-15T08:40:25.809Z\",\n\n\n\n\n            \"access-mechanism\" => \"NATIVE\",\n\n\n\n\n            \"remote-address\" => \"127.0.0.1/127.0.0.1\",\n\n\n\n\n            \"outcome\" => \"success\",\n\n\n\n\n            \"operations\" => [{\n\n\n\n\n                \"operation\" => \"add\",\n\n\n\n\n                \"address\" => [\n\n\n\n\n                    (\"core-service\" => \"management\"),\n\n\n\n\n                    (\"access\" => \"audit\"),\n\n\n\n\n                    (\"in-memory-handler\" => \"y\")\n\n\n\n\n                ]\n\n\n\n\n            }]\n\n\n\n\n        }\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "2.1.0.Final", "fixed_files": ["org.jboss.as.domain.management.ConfigurationChangeResourceDefinition.java", "org.jboss.as.test.integration.mgmt.access.ConfigurationChangesHistoryTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1399, "bug_title": "Failure when resolving an expression with the default value containing a '$' at the end", "bug_description": "Can not add a JNDI / naming entry which contains a \"$\" sign at the end of its default value.\ne.g. \n\n\n\n\n\nvalue=\"${my.sample.property1:entry5-default-value-with-special-char-at-the-end-$}\"\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.controller.ExpressionResolverImpl.java", "org.jboss.as.controller.ExpressionResolverUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1452, "bug_title": "Socket binding resources do not register a requirement for their interface", "bug_description": "BindingAddHandler doesn&apos;t pass it&apos;s attributes into the superclass constructor, so the capability references don&apos;t get registered by the default AbstractAddStepHandler.recordCapabilitiesAndRequirements. And BindingAddHandler also doesn&apos;t override recordCapabilitiesAndRequirements to do the registration itself.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.server.services.net.SocketBindingAddHandler.java", "org.jboss.as.server.services.net.BindingAddHandler.java", "org.jboss.as.server.services.net.BindingInterfaceHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1448, "bug_title": "AttributeParser for ObjectListAttributeDefinitions does not differentiate between empty and absent object lists", "bug_description": "Attributes of type ObjectList are left undefined when their enclosing element is empty, which makes it impossible to differentiate an empty object list from an unspecified one.\nThe ability to distinguish the two scenarios is important in the security manager subsystem. Consider this configuration:\n\n\n\n\n\n\n<subsystem xmlns=\"urn:jboss:domain:security-manager:1.0\">\n\n\n\n\n    <deployment-permissions>\n\n\n\n\n        <mininum-set>\n\n\n\n\n             ....\n\n\n\n\n        </minimum-set>\n\n\n\n\n    </deployment-permissions>\n\n\n\n\n</subsystem>\n\n\n\n\n\n\nThe maximum-set is absent and this case we want to use a default set with AllPermission. Now consider another configuration:\n\n\n\n\n\n\n<subsystem xmlns=\"urn:jboss:domain:security-manager:1.0\">\n\n\n\n\n    <deployment-permissions>\n\n\n\n\n        <mininum-set/>\n\n\n\n\n        <maximum-set/>\n\n\n\n\n    </deployment-permissions>\n\n\n\n\n</subsystem>\n\n\n\n\n\n\nIn this case, maximum-set has been specified but it is empty, which means the admin/user deliberately wants to use an emtpy set, possibly to enforce that no deployments with special permissions requirements get deployed.\nThe problem is that both scenarios result in an undefined attribute for the maximum-set, which means that the default AllPermission set ends up being used in both cases. The parser doesn&apos;t initialize the attribute with an empty list when the enclosing element is present but is empty. So in the end, both approaches result in an undefined attribute.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.controller.AttributeParsers.java", "org.jboss.as.controller.AttributeMarshaller.java", "org.jboss.as.controller.PersistentResourceXMLDescription.java", "org.jboss.as.controller.AttributeMarshallers.java", "org.jboss.as.controller.AttributeParser.java", "org.jboss.as.controller.ExpressionResolverImpl.java", "org.jboss.as.controller.persistence.PersistentResourceXMLParserTestCase.java", "org.jboss.as.controller.ObjectListAttributeDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 1450, "bug_title": "ResourceBuilderRoot drops data when integrating an externally created child ResourceDefinition", "bug_description": "ResourceDefinitionRoot&apos;s impl of pushChild(ResourceDefinition child) is doing an incomplete integration of the data from &apos;child&apos;. It drops everything except attributes, operations and children, losing capabilities and other misc data.\nI found this will developing tests for WFCORE-1106.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.controller.ResourceBuilderRoot.java"], "label": 1, "es_results": []}, {"bug_id": 1453, "bug_title": "module patched in a one-off not included in the next cp is not port-forwarded from the prev cp", "bug_description": "If CP1 patches module M, a one-off patch later patches the same module M and the following CP2 does not include M at all, module M will not be port-forwarded from CP1. M will be loaded from the original base instead.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.patching.runner.PatchingTasks.java", "org.jboss.as.patching.runner.PatchMergeUnitTestCase.java", "org.jboss.as.patching.runner.PatchingTask.java", "org.jboss.as.patching.runner.PatchingTaskDescription.java", "org.jboss.as.patching.runner.IdentityPatchRunner.java", "org.jboss.as.test.patching.CPRollingbackOneOffTestCase.java", "org.jboss.as.patching.metadata.ModuleItem.java", "org.jboss.as.patching.runner.IdentityPatchContext.java"], "label": 1, "es_results": []}, {"bug_id": 1464, "bug_title": "LogContexts are not removed for ear subdeployments", "bug_description": "If an ear does not have its own LogContext created, but a subdeployment in it does, the subdeployment never has its LogContext cleaned up upon undeploy, leading to PermGen leaks.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.logging.deployments.AbstractLoggingDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 1373, "bug_title": "Unable to specify custom configuration directory via -Djboss.server.config.dir", "bug_description": "Broken support for server config files location customization via: jboss.server.config.dir.\nPrevious Wildfly 10 versions till CR4 it works as expected. Broken since WF10.0.0.CR5\nSee Steps to reproduce.\nError:\nCannot start embedded server: WFLYEMB0022: Cannot invoke &apos;start&apos; on embedded process: WFLYCTL0214: Could not get main file: config.xml. Specified files must be relative to the configuration dir: /opt/wildfly-10.0.0.Final/standalone/configuration", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.wildfly.core.embedded.EmbeddedProcessFactory.java"], "label": 1, "es_results": []}, {"bug_id": 1395, "bug_title": "Remove /host=master/core-service=management/access=authorization", "bug_description": "The /host=master/core-service=management/access=authorization is odd. It should be removed in WF 11.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.CR1", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.domain.management.access.AccessAuthorizationResourceDefinition.java", "org.jboss.as.domain.management.CoreManagementResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 1470, "bug_title": "There are unknown project codes in wildfly core", "bug_description": " we see unknown project codes in wildfly-core:\n\n\n\n\n\n\n        &apos;<<none>>&apos; - &apos;version/src/main/java/org/jboss/as/version/UsageMessages.java&apos;\n\n\n\n\n        &apos;N/A&apos; - &apos;core-security/implementation/src/main/java/org/jboss/as/core/security/CoreSecurityMessages.java&apos;\n\n\n\n\n\n\nThey should be changed to empty string.\nhttps://issues.jboss.org/browse/EAP7-44?focusedCommentId=13170957&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13170957", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.version.UsageMessages.java", "org.jboss.as.core.security.CoreSecurityMessages.java"], "label": 1, "es_results": []}, {"bug_id": 1525, "bug_title": " ageout-history does not report failures", "bug_description": "When ageout-history cannot delete the old CP files, it silently fails and returns \"success\".\nLocalAgeoutHistoryHandler#recursiveDelete does keep track of whether the\ndelete failed or succeeded, but the return value from this method is ignored\nin execute(...).\nIf recursiveDelete returns false, it should report a failure.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.patching.logging.PatchLogger.java", "org.jboss.as.patching.management.LocalAgeoutHistoryHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1490, "bug_title": "JDK9 removes support for sun.boot.class.path", "bug_description": "Cite from: http://openjdk.java.net/jeps/261\n_Removed: Bootstrap class-path options\nIn earlier releases the -Xbootclasspath option allows the default bootstrap class path to be overridden, and the -Xbootclasspath/p option allows a sequence of files and directories to be prepended to the default path. The computed value of this path is reported via the JDK-specific system property sun.boot.class.path.\nWith the module system in place there is no longer a bootstrap class path as such, so the javac compiler only supports the -Xbootclasspath option in legacy mode, the java launcher no longer supports either option, and the system property sun.boot.class.path will be removed._", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.test.integration.management.interfaces.JmxManagementInterface.java"], "label": 1, "es_results": []}, {"bug_id": 1491, "bug_title": "WildFly-Core and its build process cannot rely on default JDK JAXP providers", "bug_description": "In order to ensure consistent WildFly-Core build and runtime behavior on all JDKs it is necessary to explicitly specify which JAXP providers should be used instead of default ones\nprovided by JDK.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.test.patching.CumulativePatchingScenariosTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1493, "bug_title": "org.jboss.as.host.controller.Main.getHostSystemProperties() does not propagate -Djdk.launcher.addexports.%d=%s value properly", "bug_description": "JDK9 provides -XaddExports launch option to workaround potential migration problems to modularized JDK.\nWhen modularized JDK forks new process all -XaddExports values are translated into\n-Djdk.launcher.addexports.%d=%s JVM options.\nBut method org.jboss.as.host.controller.Main.getHostSystemProperties()\nhas problems with its values.\nThe format of -XaddExports (and thus for -Djdk.launcher.addexports.%d=%s too) is:\n\n\n\n\n\n\n-XaddExports:<source-module>/<package>=<target-module>(,<target-module>)*\n\n\n\n\n\n\nSee http://openjdk.java.net/jeps/261 for more information.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.host.controller.Main.java"], "label": 1, "es_results": []}, {"bug_id": 1474, "bug_title": "CLI version command should not use JBoss AS in its output field names", "bug_description": "An example output of the current version command\n[standalone@localhost:9990 /] version \nJBoss Admin Command-line Interface\nJBOSS_HOME: /xxx/wildfly-core-3.0.0.Alpha1-SNAPSHOT\nJBoss AS release: 3.0.0.Alpha1-SNAPSHOT \"Kenny\"\nJBoss AS product: <product name>\nJAVA_HOME: /yyy/java\njava.version: 1.8.0_60\njava.vm.vendor: Oracle Corporation\njava.vm.version: 25.60-b23\nos.name: Linux\nos.version: 4.4.6-300.fc23.x86_64\n&apos;JBoss AS&apos; should not appear in the field names.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha3", "fixed_files": ["org.jboss.as.cli.handlers.VersionHandler.java", "org.jboss.as.test.integration.management.cli.CliArgumentsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1523, "bug_title": "RestartParentResourceRemoveHandler should fail when removing non-existing resources", "bug_description": "In case when non-existent policy-module is removed through Management CLI, operation should finish with failure. However it finishes with outcome success and nothing is changed. It can be confusing since wrong command seems same as correct command.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha4", "fixed_files": ["org.jboss.as.domain.management.security.SecurityRealmChildRemoveHandler.java", "org.jboss.as.controller.RestartParentResourceRemoveHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1481, "bug_title": "list-add operation does not work on login-modules attribute", "bug_description": "Executing list-add operation on login-modules results in the modules being replaced instead of appending new module.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha4", "fixed_files": ["org.jboss.as.controller.operations.global.WriteAttributeHandler.java", "org.jboss.as.controller.AbstractWriteAttributeHandler.java", "org.jboss.as.controller.operations.global.AbstractCollectionHandler.java", "org.jboss.as.controller.operations.global.ReadAttributeHandler.java", "org.jboss.as.controller.operation.global.EnhancedSyntaxTestCase.java", "org.jboss.as.controller.operation.global.CollectionOperationsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1563, "bug_title": "Failed CLI batch command with \"deploy --force\" for replace deployment", "bug_description": "Using &apos;deploy --force&apos; command on CLI batch mode fails and returns an error message: \"Request is missing the address part.\"\n\n\n\n\n\n\nCommand\n\n\n\n\n\n\n jboss-cli.sh --connect --controller=127.0.0.1:9999 --user=admin --password=xxx --file=\"deploy.cli\"\n\n\n\n\n\n\n\n\n\n\n\n\ndeploy.cli\n\n\n\n\n\n\nbatch\n\n\n\n\ndeploy --force ./jboss-ejb-in-ear.ear\n\n\n\n\nrun-batch\n\n\n\n\n\n\nFull Error message\nFailed to handle &apos;run-batch&apos;: org.jboss.as.cli.CommandFormatException: Request is missing the address part.: Request is missing the address part.\nor\nThe batch failed with the following error (you are remaining in the batch editing mode to have a chance to correct the error): Request is missing the address part.\n\nExpected message\nThe batch executed successfully\n\nHowever, it&apos;s working in \"WildFly 10 CLI interactive mode\" and \"JBoss AS 7 CLI batch\" without error.\nThere is no adding \"address\" key in buildDeploymentReplace() of DeployHandler like below.\nEven though on CLI batch mode it validates existence of \"address\" key in request with Util.validateRequest(), when &apos;run-batch&apos; command execute in org.jboss.as.cli.handlers.batch.BatchRunHandler.doHandle()\n-------------------------------------------------------------------------------------------\n\nFirst deploy: add by org.jboss.as.cli.handlers.DeployHandler.buildDeploymentAdd()\n\n\n\n\n\n\n{\n\n\n\n\n    \"operation\" => \"add\",\n\n\n\n\n    \"address\" => {\"deployment\" => \"jboss-ejb-in-ear.ear\"},\n\n\n\n\n    \"content\" => [{\"bytes\" => bytes {\n\n\n\n\n    ...\n\n\n\n\n    }}]\n\n\n\n\n}\n\n\n\n\n\n\n-------------------------------------------------------------------------------------------\nAfter deploy: replace by org.jboss.as.cli.handlers.DeployHandler.buildDeploymentReplace()\n\n\n\n\n\n\n{\n\n\n\n\n    \"operation\" => \"full-replace-deployment\",\n\n\n\n\n    \"name\" => \"jboss-ejb-in-ear.ear\",\n\n\n\n\n    \"enabled\" => true,\n\n\n\n\n    \"content\" => [{\"bytes\" => bytes {\n\n\n\n\n    ...\n\n\n\n\n    }}]\n\n\n\n\n}\n\n\n\n\n\n\n-------------------------------------------------------------------------------------------\nExpected by org.jboss.as.cli.handlers.DeployHandler.buildDeploymentReplace()\n\n\n\n\n\n\n{\n\n\n\n\n    \"operation\" => \"full-replace-deployment\",\n\n\n\n\n    \"name\" => \"jboss-ejb-in-ear.ear\",\n\n\n\n\n    \"address\" => [],\n\n\n\n\n    \"enabled\" => true,\n\n\n\n\n    \"content\" => [{\"bytes\" => bytes {\n\n\n\n\n    ...\n\n\n\n\n    }}]\n\n\n\n\n}\n\n\n\n\n\n\n-------------------------------------------------------------------------------------------\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha2", "fixed_files": ["org.jboss.as.cli.handlers.DeployHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1592, "bug_title": "PropertiesFileLoader persists entries after deletion", "bug_description": "There is a bug in PropertiesFileLoader#persistProperties, specifically here. Because of the write call in the else block, properties are persisted to the file even after they have been deleted in memory.\nHere is a fixed implementation of persistProperties that we are using as a workaround.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.1.0.Final", "fixed_version": "3.0.0.Alpha4", "fixed_files": ["org.jboss.as.domain.management.security.PropertiesFileLoader.java", "org.jboss.as.domain.management.security.PropertiesPatternMatchingTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1546, "bug_title": "Whitespaces in the middle of the value are siletly ignored", "bug_description": "Whitespace in the middle of value (e.g. adding a system property with a value like \"my property\") is silently ignored.\nGoing to the history, this behaviour changed was introduced in EAP 6.0.1\n6.0.0\n\n\n\n\n\n\n/subsystem=logging/console-handler=CONSOLE:write-attribute(name=level, value=   I   N   F   O)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"JBAS011539: Log level I   N   F   O is invalid.\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n/system-property=test:add(value=ha ha ha)\n\n\n\n\n/system-property=test:read-attribute(name=value)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => \"ha ha ha\"\n\n\n\n\n}\n\n\n\n\n\n\n6.0.1 up to 7.0.0\n\n\n\n\n\n\n/subsystem=logging/console-handler=CONSOLE:write-attribute(name=level, value=   I   N   F   O)\n\n\n\n\n/subsystem=logging/console-handler=CONSOLE:read-attribute(name=level)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => \"INFO\"\n\n\n\n\n}\n\n\n\n\n/system-property=test:add(value=ha ha ha)\n\n\n\n\n/system-property=test:read-attribute(name=value)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => \"hahaha\"\n\n\n\n\n}\n\n\n\n\n\n\nMain concern here is whether it is a correct behaviour to silently ignore the whitespace in the middle.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.2.0.CR2", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.cli.parsing.test.OperationParsingTestCase.java", "org.jboss.as.cli.parsing.operation.PropertyValueState.java"], "label": 1, "es_results": []}, {"bug_id": 1557, "bug_title": "PropertiesAttributeDefinition unwrap does not properly handle undefined values", "bug_description": "The unwrap method resolves the value of the map entries but does not check if they are defined before calling asString(). So an undefined value will store as string \"undefined\" instead of null.\nThe class doesn&apos;t any way to configure or check whether null is ok; perhaps I&apos;ll improve that as well. <--- was incorrect", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.2.0.CR2", "fixed_version": "3.0.0.Alpha1", "fixed_files": ["org.jboss.as.controller.PropertiesAttributeDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 1554, "bug_title": "Building an attribute builder based on another attribute builder does not copy CapabilityReferenceRecorder", "bug_description": "AbstractAttributeDefinitionBuilder(final AttributeDefinition basis) seems to copy every field from the basis attribute, except the CapabilityReferenceRecorder.  Looks like an oversight.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.2.0.CR2", "fixed_version": "3.0.0.Alpha2", "fixed_files": ["org.jboss.as.controller.AbstractAttributeDefinitionBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 1640, "bug_title": "Intermittent failure in DeploymentScannerUnitTestCase", "bug_description": "DeploymentScannerUnitTestCase.testStartup() has been failing intermittently since May:\nhttps://ci.wildfly.org/project.html?projectId=WildFlyCore&buildTypeId=&tab=testDetails&testNameId=-2364482317512802563&order=TEST_STATUS_DESC&branch_WildFlyCore=__all_branches__&itemsCount=50\nThe May 4 failure is the first that was not associated with some large scale failure; i.e. is more likely to be relevant to the test itself.\nI&apos;ll send up a PR to @Ignore this test.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.2.0.CR5", "fixed_version": "3.0.0.Alpha4", "fixed_files": ["org.jboss.as.test.manualmode.deployment.AbstractDeploymentUnitTestCase.java", "org.jboss.as.test.manualmode.deployment.DeploymentScannerUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1715, "bug_title": "HostProcessReloadHandler does not reset the HostRunningModeControl's restartMode", "bug_description": "The ReloadContext created by HostProcessReloadHandler sets the HostRunningModeControl&apos;s restartMode but then it never gets restored to the default value. The doReload() method of the ReloadContext should restore it. This ensures the ServerInventoryService.stop() only uses the value set by HostProcessReloadHandler once, for that one reload.\nA concern here is that ServerInventoryService only goes into its \"shutdownServers\" logic if the restartMode == RestartMode.SERVERS. Which, due to this bug, it will be following any HC reload. But if we restore the default value of restartMode, that is null, and null != RestartMode.SERVERS. So the \"\"shutdownServers\" logic will no longer kick in. But should it? Should the default value of restartMode be \"null\"? Or should it be RestartMode.SERVERS? If we change the default from null, then the behavior when no reload has happened will change.\nBasically we need to decide whether the \"shutdownServers\" logic should happen by default.", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.2.0.Final", "fixed_version": "3.0.0.Alpha6", "fixed_files": ["org.jboss.as.host.controller.operations.StartServersHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1657, "bug_title": "Confusing tab completion for adding a module dependencies", "bug_description": "Using tab completion for adding a module dependencies with module add command could lead to invalid module.xml as CLI prompt user to use module name with \"system.layers.base\" prefix, which is not a part of module name.\nreproduce\nAdd a new module via module add command, use tab-completion for dependencies\n\n\n\n\n\n\nmodule add --name=<name> --resources=<path_to_jar> --dependencies=<TAB>\n\n\n\n\nmodule add --name=<name> --resources=<path_to_jar> --dependencies=system.<TAB>\n\n\n\n\nmodule add --name=<name> --resources=<path_to_jar> --dependencies=system.layers.<TAB>\n\n\n\n\nmodule add --name=<name> --resources=<path_to_jar> --dependencies=system.layers.base.<TAB>\n\n\n\n\nasm  ch  com  gnu  ibm  io  javaee  javax  net  nu  org  sun \n\n\n\n\n\n\nthis way something like following is generated in module.xml file\n\n\n\n\n\n\n<dependencies>\n\n\n\n\n    <module name=\"system.layers.base.org.jboss.as.controller\"/>\n\n\n\n\n</dependencies>\n\n\n\n\n\n\nhowever correct module name is org.jboss.as.controller\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.2.0.CR7", "fixed_version": "3.0.0.Alpha9", "fixed_files": ["org.jboss.as.cli.handlers.module.ASModuleHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1552, "bug_title": "Slaves should report the master's version in the domain model", "bug_description": "Setting up the mixed domain tests for an EAP7 slave, I get the following error :\n\n\n\n\n\n\n  SimpleMixedDomain700TestCase>SimpleMixedDomainTest.test00002_Versioning:139 expected:<{\n\n\n\n\n    \"management-major-version\" => 4,\n\n\n\n\n    \"management-micro-version\" => 0,\n\n\n\n\n    \"management-minor-version\" => 1,\n\n\n\n\n    \"name\" => \"Unnamed Domain\",\n\n\n\n\n    \"namespaces\" => [],\n\n\n\n\n    \"product-name\" => \"WildFly Full\",\n\n\n\n\n    \"product-version\" => \"10.1.0.Final-SNAPSHOT\",\n\n\n\n\n    \"release-codename\" => \"Kenny\",\n\n\n\n\n    \"release-version\" => \"2.2.0.CR2\",\n\n\n\n\n    \"schema-locations\" => []\n\n\n\n\n}> but was:<{\n\n\n\n\n    \"management-major-version\" => 4,\n\n\n\n\n    \"management-micro-version\" => 0,\n\n\n\n\n    \"management-minor-version\" => 1,\n\n\n\n\n    \"name\" => \"Unnamed Domain\",\n\n\n\n\n    \"namespaces\" => [],\n\n\n\n\n    \"product-name\" => \"JBoss EAP\",\n\n\n\n\n    \"product-version\" => \"7.0.0.GA\",\n\n\n\n\n    \"release-codename\" => \"Kenny\",\n\n\n\n\n    \"release-version\" => \"2.1.2.Final-redhat-1\",\n\n\n\n\n    \"schema-locations\" => []\n\n\n\n\n}>\n\n\n\n\n\n\nThe &apos;expected&apos; is the WildFly master values, while the &apos;actual&apos; are the slave values. product-name, product-version, release-codename and release-version on the slave should be the same as the master values. Once we upgrade to Wildfly Core 3.0.0 we should also check that the management-[major/minor/micro]-version attributes on the slave are the same as the DC&apos;s values as well (i.e 5.0.0 rather than 4.0.1) This is similar to WFLY-3228 back in the day.\nThis is probably caused by the SyncXXX handlers for pushing the domain config as operations (WFCORE-401)", "project": "Wildfly", "sub_project": "WFCORE", "version": "2.2.0.CR2", "fixed_version": "3.0.0.Alpha12", "fixed_files": ["org.jboss.as.domain.controller.operations.SyncModelServerStateTestCase.java", "org.jboss.as.domain.controller.operations.SyncModelOperationHandler.java"], "label": 1, "es_results": []}, {"bug_id": 172, "bug_title": "Wrong application name used for Syslog logging", "bug_description": "The auditlog code uses \"WildFly Full\" value as an application name (APP-NAME header field) for syslog logging. \nIt&apos;s not allowed to use space in the value, because the space is a header field separator in syslog messages. Look at syslog message format - http://tools.ietf.org/html/rfc5424#section-6", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha3", "fixed_version": "1.0.0.CR4", "fixed_files": ["org.jboss.as.controller.audit.SyslogAuditLogHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1115, "bug_title": "Intermittent failures of CompositeOperationTestCase & CoreResourceManagementTestCase", "bug_description": "org.jboss.as.test.integration.domain.suites.CompositeOperationTestCase and org.jboss.as.test.integration.domain.suites.CoreResourceManagementTestCase from wildfly-core testsuite domain module starts to intermittently fail since 7.0.0.DR13 (2.0.0.CR8).\nTests fails only once I run the whole Domain Mode Integration Tests module, running only these two tests in isolation never fails. \nReproducer job which starts the tests in testsuite/domain module:\n - 2.0.0.CR6 - intermittent failures of HcExtensionAndSubsystemManagementTestCase JBEAP-1598\n - 2.0.0.CR7 - intermittent failures of HcExtensionAndSubsystemManagementTestCase JBEAP-1598\n - 2.0.0.CR8 - no more HcExtensionAndSubsystemManagementTestCase failures, CompositeOperationTestCase and CoreResourceManagementTestCase starts failing\n- 3.0.0.Alpha1-SNAPSHOT - CompositeOperationTestCase and CoreResourceManagementTestCase intermittent fails\nAttaching surefire reports.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha1", "fixed_version": "2.0.2.Final", "fixed_files": ["org.jboss.as.test.integration.domain.suites.IgnoredResourcesProfileCloneTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1572, "bug_title": "Suggestion list for argument value is not generated if the value contains a whitespace", "bug_description": "When an argument value contains a space (eg. deploy /path/to/test-application.war --all-server-groups --headers={rollout id=foo}) and if user hits tab after the whitespace, suggestions are generated based on the command, rather than the current argument&apos;s name.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha1", "fixed_version": "3.0.0.Alpha2", "fixed_files": ["org.jboss.as.cli.parsing.ParserUtil.java", "org.jboss.as.cli.parsing.test.CommandTestCase.java", "org.jboss.as.cli.parsing.DefaultStateWithEndCharacter.java"], "label": 1, "es_results": []}, {"bug_id": 1570, "bug_title": "Saved rollout-plan 'name' or 'id' attribute discrepancy", "bug_description": "When using rollout plans for EAP deployment scenarios I can create my own named rollout-plan for ease of use. I can then apply rollout command later on, referring with name of my own rollout plan that should be used. There is minor discrepancy in the way I create and use such rollout plan though.\nWhen I create rollout-plan, I use command like:\n\n\n\n\n\n\nrollout-plan add --name=my-rollout-plan --content={rollout main-server-group(rolling-to-servers=false,max-failed-servers=1),other-server-group(rolling-to-servers=true,max-failure-percentage=20) rollback-across-groups=true}\n\n\n\n\n\n\n\nsee --name attribute given to name my rollout plan\n\nWhen I then refer to it I use following command:\n\n\n\n\n\n\ndeploy /path/to/test-application.war --all-server-groups --headers={rollout id=my-rollout-plan}\n\n\n\n\n\n\n\nsee id attribute given to rollout header operation\n\nYes, this is really minor issue, but I think that these two attributes used in aforementioned commands should be unified (preferably to name instead of id) as user might be confused when using it.\nNote: examples are used from our documentation.\nNote: I do not know whether I am missing something but I was not able to retrieve more info how to use rollout header operation in deploy command directly in CLI.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha1", "fixed_version": "3.0.0.Alpha2", "fixed_files": ["org.jboss.as.cli.parsing.operation.header.RolloutPlanState.java", "org.jboss.as.cli.parsing.operation.header.RolloutPlanHeaderCallbackHandler.java", "org.jboss.as.cli.operation.impl.RolloutPlanCompleter.java"], "label": 1, "es_results": []}, {"bug_id": 1595, "bug_title": "CLI does not autocomplete for unalias command", "bug_description": "Tab completion for CLI unalias commend doesn&apos;t seem to work. CLI will suggest available option, but doesn&apos;t autocomplete.\nactual\n\n\n\n\n\n\n[standalone@localhost:9990 /] unalias read_<TAB>\n\n\n\n\n  read_undertow  \n\n\n\n\n[standalone@localhost:9990 /] unalias read_<TAB>\n\n\n\n\n  read_undertow \n\n\n\n\n\n\nexpected\n\n\n\n\n\n\n[standalone@localhost:9990 /] unalias read_<TAB>\n\n\n\n\n[standalone@localhost:9990 /] unalias read_undertow\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha1", "fixed_version": "3.0.0.Alpha3", "fixed_files": ["org.jboss.as.cli.operation.OperationRequestCompleter.java"], "label": 1, "es_results": []}, {"bug_id": 1611, "bug_title": "CLI could stuck if SIGINT is send during authentication dialogue", "bug_description": "Interruption a CLI session with Ctrl+C during authentication dialogue could get CLI into unresponsive state.\nreproduce\nEither use a remote server, --no-local-auth cli script arg or remove a local element from ManagementRealm configuration\n\n\n\n\n\n\n         <security-realms>\n\n\n\n\n             <security-realm name=\"ManagementRealm\">\n\n\n\n\n                 <authentication>\n\n\n\n\n-                    <local default-user=\"$local\" skip-group-loading=\"true\"/>\n\n\n\n\n\n\nstart a standalone server and launch a CLI\n\n\n\n\n\n\n[pkremens@localhost] $ ./standalone.sh &\n\n\n\n\n[pkremens@localhost] $ ./jboss-cli.sh\n\n\n\n\n[disconnected /] connect\n\n\n\n\nAuthenticating against security realm: ManagementRealm\n\n\n\n\nUsername: <Press Ctrl+C here>\n\n\n\n\n\n\nCould not connect message is printed, but process is not terminated and stuck at this point.\n\n\n\n\n\n\nThe controller is not available at localhost:9990: java.net.ConnectException: WFLYPRT0023: Could not connect to http-remoting://localhost:9990. The connection timed out: WFLYPRT0023: Could not connect to http-remoting://localhost:9990. The connection timed out\n\n\n\n\n\n\nOnly way to recover the terminal is to SIGKILL the CLI process.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha2", "fixed_version": "3.0.0.Alpha3", "fixed_files": ["org.jboss.as.cli.impl.CliShutdownHook.java"], "label": 1, "es_results": []}, {"bug_id": 1625, "bug_title": "Operation description is not complete in :read-resource-description", "bug_description": "The ouput of :read-resource-description is missing some metadata for operations compared to :read-operation-description:\n\n\n\n\n\n\n[domain@localhost:9990 /] /profile=default:read-resource-description(operations=true)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => {\n\n\n\n\n        \"description\" => \"A named set of subsystem configurations.\",\n\n\n\n\n        ...\n\n\n\n\n        \"operations\" => {\n\n\n\n\n            ...\n\n\n\n\n            \"read-attribute-group-names\" => {\n\n\n\n\n                \"operation-name\" => \"read-attribute-group-names\",\n\n\n\n\n                \"description\" => \"Gets the names of all the attribute groups under the selected resource\",\n\n\n\n\n                \"request-properties\" => {},\n\n\n\n\n                \"reply-properties\" => {\n\n\n\n\n                    \"type\" => LIST,\n\n\n\n\n                    \"value-type\" => STRING\n\n\n\n\n                }\n\n\n\n\n            },\n\n\n\n\n            ...\n\n\n\n\n}\n\n\n\n\n[domain@localhost:9990 /] /profile=default:read-operation-description(name=read-attribute-group-names)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => {\n\n\n\n\n        \"operation-name\" => \"read-attribute-group-names\",\n\n\n\n\n        \"description\" => \"Gets the names of all the attribute groups under the selected resource\",\n\n\n\n\n        \"request-properties\" => {},\n\n\n\n\n        \"reply-properties\" => {\n\n\n\n\n            \"type\" => LIST,\n\n\n\n\n            \"value-type\" => STRING\n\n\n\n\n        },\n\n\n\n\n        \"read-only\" => true,\n\n\n\n\n        \"runtime-only\" => true\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nAt least read-only and runtime-only metadata are missing (when they are set on the operation).", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha2", "fixed_version": "3.0.0.Alpha3", "fixed_files": ["org.jboss.as.controller.operations.global.ReadOperationDescriptionHandler.java", "org.jboss.as.model.test.ModelTestModelDescriptionValidator.java", "org.jboss.as.controller.operations.global.ReadResourceDescriptionHandler.java", "org.jboss.as.controller.descriptions.ModelDescriptionConstants.java"], "label": 1, "es_results": []}, {"bug_id": 1617, "bug_title": "Tab completion is does not work for cli variables and properties", "bug_description": "CLI tab completion doesn&apos;t work for CLI variables.\nAdd a CLI variable:\n\n\n\n\n\n\nset myvar=/subsystem=datasources/data-source=ExampleDS\n\n\n\n\n[standalone@embedded /] $myvar:read-resource\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => {\n\n\n\n\n...\n\n\n\n\n\n\nNow try to use tab completion\nactual\n\n\n\n\n\n\n[standalone@embedded /] $myvar:read<TAB>\n\n\n\n\n[standalone@embedded /] $myvar:readread-<TAB>\n\n\n\n\n[standalone@embedded /] $myvar:readread-\n\n\n\n\n&apos;readread-&apos; is not a valid operation name.\n\n\n\n\n\n\nexpected\n\n\n\n\n\n\n[standalone@embedded /] $myvar:read<TAB>\n\n\n\n\n[standalone@embedded /] $myvar:read-resource\n\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha2", "fixed_version": "3.0.0.Alpha4", "fixed_files": ["org.jboss.as.cli.parsing.test.VariablesTestCase.java", "org.jboss.as.cli.operation.impl.DefaultCallbackHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1647, "bug_title": "Default app-name value of Syslog handler in Audit Logging violates specification", "bug_description": "According to syslog specification[1] app-name cannot contain space character (\" \"). However, the default value in WildFly Core 3.0.0.Alpha3 is WildFly Core. This results in the syslog server is not able to capture Process ID from which the message was sent.\nE.g. following piece of information is captured WildFly[Core] (...) instead of WildFlyCore[795]\nSuggestions for improvement:\nChange default value WildFly Core to one without space character.\nAlso please consider addition of check whether app-name contains space character.\n[1] https://tools.ietf.org/html/rfc5424#page-8", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha3", "fixed_version": "3.0.0.Alpha4", "fixed_files": ["org.jboss.as.controller.audit.SyslogAuditLogHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1699, "bug_title": "Inefficient usage of map iterators", "bug_description": "Inefficient usage of map iterators\n\n\n\n\n\n\nMap<String, CommandArgument> options = getDynamicOptions(ctx);\n\n\n\n\nfor (String k : options.keySet()) {\n\n\n\n\n   args.add(options.get(k));\n\n\n\n\n}\n\n\n\n\n\n\ncan be replaced with args.addAll(getDynamicOptions(ctx).values());", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha4", "fixed_version": "3.0.0.Alpha5", "fixed_files": ["org.jboss.as.cli.handlers.LsHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1590, "bug_title": "Default parameter length validating ignores setMinSize(0)", "bug_description": "With the following attribute definition: -\n\n\n\n\n\n\n    static final SimpleAttributeDefinition REPLACEMENT = new SimpleAttributeDefinitionBuilder(ElytronDescriptionConstants.REPLACEMENT, ModelType.STRING, false)\n\n\n\n\n        .setAllowExpression(true)\n\n\n\n\n        .setMinSize(0)\n\n\n\n\n        .setFlags(AttributeAccess.Flag.RESTART_RESOURCE_SERVICES)\n\n\n\n\n        .build();\n\n\n\n\n\n\nThe following error is reported if an empty string is used as a parameter: -\n\n\n\n\n\n\n\n\n\n\n\n[standalone@localhost:9990 /] ./subsystem=elytron/regex-name-rewriter=strip-realm:add(pattern=\"@ELYTRON.ORG\", replacement=\"\", replace-all=true)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"WFLYCTL0113: &apos;&apos; is an invalid value for parameter replacement. Values must have a minimum length of 1 characters\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha1", "fixed_version": "3.0.0.Alpha5", "fixed_files": ["org.jboss.as.controller.AbstractAttributeDefinitionBuilder.java", "org.jboss.as.controller.test.WriteAttributeOperationTestCase.java", "org.jboss.as.controller.AttributeDefinition.java", "org.jboss.as.controller.SimpleAttributeDefinitionUnitTestCase.java", "org.jboss.as.controller.operations.validation.BytesValidator.java"], "label": 1, "es_results": []}, {"bug_id": 1706, "bug_title": "Deploying with force an unmanaged deployment makes it managed", "bug_description": "For an unmanaged deployment if you replace it using the CLI deploy command it becomes managed.\nTo reproduce:\n\n\n\n\n\n\ndeploy /home/ehsavoie/dev/wildfly/quickstart/kitchensink-ear/ear/target/wildfly-kitchensink-ear.ear --unmanaged\n\n\n\n\ndeploy /home/ehsavoie/dev/wildfly/quickstart/kitchensink-ear/ear/target/wildfly-kitchensink-ear.ear --unmanaged --force\n\n\n\n\n\n\nAfter the second command the deployment is managed.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha4", "fixed_version": "3.0.0.Alpha5", "fixed_files": ["org.jboss.as.cli.handlers.DeployHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1710, "bug_title": "WFCORE-1106 work ignores fact that HostCapabilityScope exists", "bug_description": "The WFCORE-1106 work for checking the runtime status of a capability assumes that only CapabilityScope.GLOBAL should be relevant when the check is performed. But this omits HostCapabilityScope which comes into play when host controller subsystems are used.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha4", "fixed_version": "3.0.0.Alpha5", "fixed_files": ["org.jboss.as.controller.CapabilityRegistry.java"], "label": 1, "es_results": []}, {"bug_id": 1687, "bug_title": "WFLYCTL0357 warning upon undeploying any deployment", "bug_description": "EAP produces following warning upon undeployment:\n\n\n\n\n\n\nWARN  [org.jboss.as.controller] (management-handler-thread - 4) WFLYCTL0357: Notification of type deployment-undeployed is not described for the resource at the address []\n\n\n\n\n\n\nThe warning is produced for both managed and unmanaged deployments.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha4", "fixed_version": "3.0.0.Alpha6", "fixed_files": ["org.jboss.as.server.deployment.DeploymentHandlerUtil.java"], "label": 1, "es_results": []}, {"bug_id": 1718, "bug_title": "Handlers within Audit Logger are not removed properly when Audit Logger is removed", "bug_description": "If Audit Logger is removed, destination handlers (i.e. its child nodes) are not removed properly. They are not present in the config file. They seem to be not removed \"internally\" though. This leads to a couple of issues:\n1. It is not possible to remove referenced File/Syslog handlers. If user tries to remove them the NullPointerException is given as a result. Try following commands:\n/core-service=management/access=audit/file-handler=file:remove()\n/core-service=management/access=audit/syslog-handler=my-syslog-handler:remove()\nTheir output is:\n\n\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"WFLYCTL0158: Operation handler failed: java.lang.NullPointerException\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\n2. AuditLog continues to send auditable events to previously referenced File/Syslog handlers.\n\nCreate auditable event (e.g. /subsystem=logging/logger=com.arjuna:write-attribute(name=level,value=DEBUG))\nSee log in the file (WILDFLY_HOME/standalone/data/audit-log.log)\nSee log in the syslog (/var/log/messages)\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha5", "fixed_version": "3.0.0.Alpha6", "fixed_files": ["org.jboss.as.domain.management.audit.AccessAuditResourceDefinition.java", "org.jboss.as.domain.management.audit.AuditLogLoggerResourceDefinition.java", "org.jboss.as.domain.management.audit.AuditLogHandlerReferenceResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 1743, "bug_title": "Unable to force CLI to execute a low level command", "bug_description": "I cannot get this operation to execute, even if I set validate-operation-requests to false in jboss-cli.xml:\n\n\n\n\n\n\n[standalone@embedded /] /subsystem=datasources/bogus=*:read-resource-description\n\n\n\n\nFailed to get the list of the operation properties: \"WFLYCTL0030: No resource definition is registered for address [\n\n\n\n\n    (\"subsystem\" => \"datasources\"),\n\n\n\n\n    (\"bogus\" => \"*\")\n\n\n\n\n]\"\n\n\n\n\n\n\nIt is important that the CLI allows users to send whatever low level ops they wish to the server if they turn off verification. The server validates requests itself, and in some cases can be coded to be lenient about things (e.g. to let previous &apos;wrong&apos; things work.) We don&apos;t want the CLI to get in the way of that by doing client side validation that cannot be turned off.\nProblem seems to be this in the Util class:\n\n\n\n\n\n\n    public static ModelNode toOperationRequest(CommandContext ctx,\n\n\n\n\n            ParsedCommandLine parsedLine, Attachments attachments)\n\n\n\n\n            throws CommandFormatException {\n\n\n\n\n        return toOperationRequest(ctx, parsedLine, attachments, true);\n\n\n\n\n    }\n\n\n\n\n\n\nThat &apos;true&apos; param results in the CLI trying to do a background read-operation-description and failing the op if unsuccessful.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha5", "fixed_version": "3.0.0.Alpha6", "fixed_files": ["org.jboss.as.cli.Util.java"], "label": 1, "es_results": []}, {"bug_id": 1642, "bug_title": "Fix domain mode for configuration changes", "bug_description": "The configuration changes feature is broken in domain mode: the propagation to managed servers / slaves HC doesn&apos;t work properly.  Once set it will fail on restarting the DC. So we need a clean refactoring of the feature to have a usable domain mode.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha3", "fixed_version": "3.0.0.Alpha6", "fixed_files": ["org.jboss.as.domain.management.ConfigurationChangeResourceDefinition.java", "org.jboss.as.domain.management.logging.DomainManagementLogger.java", "org.jboss.as.domain.management.CoreManagementResourceDefinition.java", "org.jboss.as.host.controller.ManagedServerOperationsFactory.java", "org.jboss.as.domain.controller.operations.coordination.ServerOperationResolver.java"], "label": 1, "es_results": []}, {"bug_id": 1714, "bug_title": "Tab completion does not offer more options once prefix match some value", "bug_description": "Tab completion for CLI variables doesn&apos;t offer more values once the variable to be completed match some value.\nreproduce\n\n\n\n\n\n\nset foo=/subsystem=logging\n\n\n\n\nset foobar=/subsystem=logging/console-handler=CONSOLE\n\n\n\n\n\n\nactual\n\n\n\n\n\n\n$foo<TAB>\n\n\n\n\n/  :\n\n\n\n\n\n\nexpected\n\n\n\n\n\n\n$foo<TAB>\n\n\n\n\n/  :  foo  foobar\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha5", "fixed_version": "3.0.0.Alpha8", "fixed_files": ["org.jboss.as.cli.CommandCompleter.java"], "label": 1, "es_results": []}, {"bug_id": 1761, "bug_title": "Bogus \"alternative\" in server NativeManagementResourceDefinition.SOCKET_BINDING attribute definition", "bug_description": "SOCKET_BINDING declares that INTERFACE is an alternative. There is no INTERFACE attribute allowed on this resource. Perhaps this is leftover cruft.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha7", "fixed_version": "3.0.0.Alpha8", "fixed_files": ["org.jboss.as.server.mgmt.NativeManagementResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 1807, "bug_title": "CLI config (jboss-cli.xml) is trimming vault-options when it should pass them on as is", "bug_description": "Vault option is calling trim which is causing issues with custom vault implementation.  \nThe implementation of the vault config parser in the normal EAP config (i.e. in standalone.xml) does not do this.\nTo provide more details why this is an issue, the custom impl is prepending a string to an executable command.  By trimming the command is being mangled:\n        <vault code=\"com.example.CommandVault\" module=\"com.example\">\n            <vault-option name=\"prependToValue\" value=\"perform_encryption.sh -value \"/>\n            <vault-option name=\"allowEmptyPassword\" value=\"false\"/>\n        </vault>\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha8", "fixed_version": "3.0.0.Alpha9", "fixed_files": ["org.jboss.as.cli.impl.VaultConfig.java"], "label": 1, "es_results": []}, {"bug_id": 1793, "bug_title": "add-content operation fails to overwrite existing content with overwrite=true set when passing content by file path", "bug_description": "Upon overwriting content in managed exploded deployments on wildfly-core, the following errors are produced:\nCLI\n\n\n\n\n\n\n[standalone@localhost:9990 /] deploy /home/mjurc/testing/eap7-204/jboss-kitchensink-ear.ear\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:undeploy\n\n\n\n\n{\"outcome\" => \"success\"}\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:explode\n\n\n\n\n{\"outcome\" => \"success\"}\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:deploy\n\n\n\n\n{\"outcome\" => \"success\"}\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:add-content(content=[{path=/home/mjurc/testing/eap7-204/test.txt, target-path=test.txt}], overwrite=true)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"org.jboss.as.repository.ExplodedContentException: WFLYDR0021: Error updating content of exploded deployment\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:add-content(content=[{path=/home/mjurc/testing/eap7-204/test.txt, target-path=test.txt}], overwrite=false)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"org.jboss.as.repository.ExplodedContentException: WFLYDR0021: Error updating content of exploded deployment\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:add-content(content=[{path=/home/mjurc/testing/eap7-204/test.txt, target-path=test.txt}])\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"org.jboss.as.repository.ExplodedContentException: WFLYDR0021: Error updating content of exploded deployment\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\nServer\n\n\n\n\n\n\n09:41:36,029 WARN  [org.jboss.as.repository] (management-handler-thread - 5) java.nio.file.FileAlreadyExistsException: /home/mjurc/testing/wildfly-core/build/target/wildfly-core-3.0.0.Alpha8-SNAPSHOT/standalone/data/content/content7797527203290314566/content/test.txt\n\n\n\n\n09:45:27,505 WARN  [org.jboss.as.repository] (management-handler-thread - 12) java.nio.file.FileAlreadyExistsException: /home/mjurc/testing/wildfly-core/build/target/wildfly-core-3.0.0.Alpha8-SNAPSHOT/standalone/data/content/content721393778736298367/content/test.txt\n\n\n\n\n09:45:36,352 WARN  [org.jboss.as.repository] (management-handler-thread - 10) java.nio.file.FileAlreadyExistsException: /home/mjurc/testing/wildfly-core/build/target/wildfly-core-3.0.0.Alpha8-SNAPSHOT/standalone/data/content/content344811471223714239/content/test.txt\n\n\n\n\n\n\nThis issue does not seem to arise when the content is passed to the server by input stream index.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha8", "fixed_version": "3.0.0.Alpha9", "fixed_files": ["org.jboss.as.server.deployment.ExplodedDeploymentAddContentHandler.java", "org.jboss.as.server.controller.resources.DeploymentAttributes.java"], "label": 1, "es_results": []}, {"bug_id": 1799, "bug_title": "Property separator not appended after argument value if argument completer uses non-zero offset", "bug_description": "For example:\nmodule add --name=foo --dependencies=sun.scripting ==> space character is added at the end.\nmodule add --name=foo --dependencies=sun.scripting,sun.jdk ==> Nothing happens, no space character added.\ndeployment-overlay add --name=foo --contents=foo=/some/file<TAB> ==> Nothing happens, no space character added.\nThis seems to be caused by a condition in  OperationRequestCompleter - if a suggested value is the same as current user input, ORC replaces the suggestion with a separator.\nThis only works if the offset returned by argument completer is 0 - if the completer provides only part of the value, this condition will never be triggered.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha7", "fixed_version": "3.0.0.Alpha9", "fixed_files": ["org.jboss.as.cli.operation.OperationRequestCompleter.java"], "label": 1, "es_results": []}, {"bug_id": 1805, "bug_title": "Intermittent failure in BasicOperationsUnitTestCase.testPathInfo", "bug_description": "This test is failing intermittently. I&apos;m going to @Ignore it.\nThis one should be a bit higher priority than the typical intermittent test failure as the stuff being tested is pretty new, so there&apos;s a higher chance this is a bug in the code instead of just a test issue.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha7", "fixed_version": "3.0.0.Alpha10", "fixed_files": ["org.wildfly.core.test.standalone.mgmt.BasicOperationsUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1479, "bug_title": "Jar sub deployment has as first dependency parent ear", "bug_description": "Jar file included in ear main directory is resolved as sub deployment with parent ear as first dependency.\nTherefore jar files contained in ear/lib directory have priority before implicit modules when class is created inside jar file.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha1", "fixed_version": "3.0.0.Alpha10", "fixed_files": ["org.jboss.as.server.deployment.module.SubDeploymentDependencyProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 1847, "bug_title": "PatchMerger overrides submodule's content merging the outer module", "bug_description": "PatchMerger merges two CPs into one. In case the first CP includes updates for modules like org.outermodule and org.outermodule.innermodule. And the second CP including an update for org.outermodule.innermodule only, the merge may not happen correctly in case the modification for the innermodule will appear before the modification for the outermodule in the first CP.\nThe merger will copy the innermodule&apos;s content first and then override it copying the outermodule&apos;s content (including the previous version of the innermodule).", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha9", "fixed_version": "3.0.0.Alpha10", "fixed_files": ["org.jboss.as.test.patching.CPRollingbackOneOffTestCase.java", "org.jboss.as.patching.metadata.PatchMerger.java", "org.jboss.as.test.patching.CumulativePatchingScenariosTestCase.java", "org.jboss.as.test.patching.MergedPatchesTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1851, "bug_title": "Inconsistent behaviour with browse-content(depth=1) operation between archived and exploded deployments", "bug_description": "/deployment=jboss-kitchensink-ear.ear:browse-content(depth=1) operation returns inconsistent result depending on whether the deployment is exploded or not. Deployment attached.\nArchived:\n\n\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"jboss-kitchensink-ear-web.war\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 63190L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"jboss-kitchensink-ear-ejb.jar\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 12256L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/\",\n\n\n\n\n            \"directory\" => true\n\n\n\n\n        }\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n\nExploded:\n\n\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/\",\n\n\n\n\n            \"directory\" => true\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/MANIFEST.MF\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 130L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"jboss-kitchensink-ear-web.war\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 63190L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"jboss-kitchensink-ear-ejb.jar\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 12256L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/application.xml\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 802L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/kitchensink-ear-quickstart-ds.xml\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 1955L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/maven/org.jboss.quickstarts.eap/jboss-kitchensink-ear-ear/pom.xml\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 5582L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/maven/org.jboss.quickstarts.eap/jboss-kitchensink-ear-ear/pom.properties\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 143L\n\n\n\n\n        }\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha9", "fixed_version": "3.0.0.Alpha10", "fixed_files": ["org.jboss.as.repository.ContentRepositoryTest.java", "org.jboss.as.repository.PathUtil.java"], "label": 1, "es_results": []}, {"bug_id": 1864, "bug_title": "Whitespaces are not removed from dependencies in module add command", "bug_description": "Running \nmodule add --name=foo.bar --resources=foo.jar --dependencies=[org.a, org.b ]\nwill result in following dependencies in module.xml\n{{\n...\n    <dependencies>\n        <module name=\"org.a\"/>\n        <module name=\" org.b \"/>\n    </dependencies>\n...\n}}\nThe module name in dependencies should be stripped of leading and trailing whitespaces.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha9", "fixed_version": "3.0.0.Alpha11", "fixed_files": ["org.jboss.as.cli.handlers.module.ASModuleHandler.java", "org.jboss.as.test.integration.management.cli.ModuleTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1908, "bug_title": "Tab completion suggest writing attribute which has access type metric and is not writable", "bug_description": "CLI tab completion suggests attributes that are not writable and their access-type is metric\nExample \n\n\n\n\n\n/subsystem=messaging-activemq/server=default/jms-queue=DLQ:write-attribute(name=<TAB>\n\n\n\n\nconsumer-count  delivering-count  entries  legacy-entries  message-count  messages-added  scheduled-count  \n\n\n\n\n\n\nFrom executing :read-resource-description we can see, attributes consumer-count, delivering-count, message-count, messages-added, scheduled-count are of type metric.\nOn attempt to write metric attribute, for example message-count, non writable error is printed \n\n\n\n\n\n[standalone@localhost:9990 jms-queue=q] :write-attribute(name=message-count, value=5)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"WFLYCTL0048: Attribute message-count is not writable\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\nCLI should not suggest writing attributes that are not writable.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha11", "fixed_version": "3.0.0.Alpha12", "fixed_files": ["org.jboss.as.cli.Util.java", "org.jboss.as.cli.impl.AttributeNamePathCompleter.java", "org.jboss.as.cli.parsing.test.AttributeNamePathCompletionTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1915, "bug_title": "ParseUtils.parseAttributeValue should not fail due to DMR type conversions", "bug_description": "The task of ParseUtils.parseAttributeValue is to convert a string into a ModelNode. The type of the ModelNode is not particularly important, as later code will do type conversion. And, it is not the job of this method to do validation; there is other code that does that. So, the type conversion this method does should not be allowed to produce failures. Continuing to try the conversion is ok, although not required, but if a conversion can&apos;t succeed the pre-conversion ModelType.STRING node should be returned.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha11", "fixed_version": "3.0.0.Alpha12", "fixed_files": ["org.jboss.as.controller.parsing.ParseUtils.java"], "label": 1, "es_results": []}, {"bug_id": 1936, "bug_title": "Value of parameters \"restart-required\" for fixed-*port attributes does not match reality for socket-binding and *-destination-outbound-socket-binding in CLI", "bug_description": "fixed-port attribute of socket-binding and fixed-source-port attributes of *-destination-outbound-socket-binding define in its description that there is not necessary to do reload or restart for any of them. But reality is different. If you tries to change such attributes you are informed that reload is necessary.\nThe attributes are defined as \"restart-required\" => \"no-services\", see /socket-binding-group=standard-sockets:read-resource-description(recursive=true)", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha11", "fixed_version": "3.0.0.Alpha12", "fixed_files": ["org.jboss.as.server.services.net.OutboundSocketBindingResourceDefinition.java", "org.jboss.as.controller.resource.AbstractSocketBindingResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 1896, "bug_title": "Deployment operation browse-content(archive=true) does not return archives in archived deployments", "bug_description": "Deployment operation browse-content(archive=true) does not return archives in archived deployments:\n\n\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:browse-content()\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"jboss-kitchensink-ear-web.war\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 63190L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"jboss-kitchensink-ear-ejb.jar\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 12256L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/maven/org.jboss.quickstarts.eap/jboss-kitchensink-ear-ear/pom.xml\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 5582L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/maven/org.jboss.quickstarts.eap/jboss-kitchensink-ear-ear/pom.properties\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 143L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/maven/org.jboss.quickstarts.eap/jboss-kitchensink-ear-ear/\",\n\n\n\n\n            \"directory\" => true\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/maven/org.jboss.quickstarts.eap/\",\n\n\n\n\n            \"directory\" => true\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/maven/\",\n\n\n\n\n            \"directory\" => true\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/MANIFEST.MF\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 130L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/application.xml\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 802L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/kitchensink-ear-quickstart-ds.xml\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 1955L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"META-INF/\",\n\n\n\n\n            \"directory\" => true\n\n\n\n\n        }\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:browse-content(archive=true)\n\n\n\n\n{\"outcome\" => \"success\"}\n\n\n\n\n\n\nIt works correctly with exploded deployments:\n\n\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:undeploy\n\n\n\n\n{\"outcome\" => \"success\"}\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:explode\n\n\n\n\n{\"outcome\" => \"success\"}\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:deploy\n\n\n\n\n{\"outcome\" => \"success\"}\n\n\n\n\n[standalone@localhost:9990 /] /deployment=jboss-kitchensink-ear.ear:browse-content(archive=true)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"jboss-kitchensink-ear-web.war\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 63190L\n\n\n\n\n        },\n\n\n\n\n        {\n\n\n\n\n            \"path\" => \"jboss-kitchensink-ear-ejb.jar\",\n\n\n\n\n            \"directory\" => false,\n\n\n\n\n            \"file-size\" => 12256L\n\n\n\n\n        }\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha10", "fixed_version": "3.0.0.Alpha12", "fixed_files": ["org.jboss.as.repository.ContentFilter.java", "org.jboss.as.repository.PathUtilTest.java", "org.jboss.as.repository.PathUtil.java"], "label": 1, "es_results": []}, {"bug_id": 1951, "bug_title": "Expose content repository read-content as a GET operation", "bug_description": "Allows the use of the GET method to obtain the binary stream to a content in the content repository.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha11", "fixed_version": "3.0.0.Alpha12", "fixed_files": ["org.jboss.as.test.integration.management.http.HttpGetMgmtOpsTestCase.java", "org.jboss.as.test.integration.management.http.HttpDeploymentUploadUnitTestCase.java", "org.jboss.as.domain.http.server.DomainApiHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1959, "bug_title": "Deploying an empty managed exploded deployment to server group in domain fails", "bug_description": "Deploying an empty exploded deployment created on domain controller fails with the following:\n\n\n\n\n\n\n    [domain@localhost:9990 /] /deployment=empty-deployment.jar:add(content=[{empty=true}])\n\n\n\n\n    {\n\n\n\n\n        \"outcome\" => \"success\",\n\n\n\n\n        \"result\" => undefined,\n\n\n\n\n        \"server-groups\" => undefined\n\n\n\n\n    }\n\n\n\n\n    [domain@localhost:9990 /] /server-group=main-server-group/deployment=empty-deployment.jar:add()              \n\n\n\n\n    {\n\n\n\n\n        \"outcome\" => \"failed\",\n\n\n\n\n        \"result\" => undefined,\n\n\n\n\n        \"failure-description\" => {\"WFLYDC0074: Operation failed or was rolled back on all servers. Server failures:\" => {\"server-group\" => {\"main-server-group\" => {\"host\" => {\"master\" => {\n\n\n\n\n            \"server-one\" => \"WFLYSRV0201: Cannot have more than one of [bytes, input-stream-index, hash, url, empty]\",\n\n\n\n\n            \"server-two\" => \"WFLYSRV0201: Cannot have more than one of [bytes, input-stream-index, hash, url, empty]\"\n\n\n\n\n        }}}}}},\n\n\n\n\n        \"rolled-back\" => true,\n\n\n\n\n        \"server-groups\" => {\"main-server-group\" => {\"host\" => {\"master\" => {\n\n\n\n\n            \"server-one\" => {\"response\" => {\n\n\n\n\n                \"outcome\" => \"failed\",\n\n\n\n\n                \"failure-description\" => \"WFLYSRV0201: Cannot have more than one of [bytes, input-stream-index, hash, url, empty]\",\n\n\n\n\n                \"rolled-back\" => true\n\n\n\n\n            }},\n\n\n\n\n            \"server-two\" => {\"response\" => {\n\n\n\n\n                \"outcome\" => \"failed\",\n\n\n\n\n                \"failure-description\" => \"WFLYSRV0201: Cannot have more than one of [bytes, input-stream-index, hash, url, empty]\",\n\n\n\n\n                \"rolled-back\" => true\n\n\n\n\n            }}\n\n\n\n\n        }}}}\n\n\n\n\n    }\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha11", "fixed_version": "3.0.0.Alpha12", "fixed_files": ["org.jboss.as.domain.controller.operations.coordination.ServerOperationResolver.java"], "label": 1, "es_results": []}, {"bug_id": 1918, "bug_title": "re-enable quote parsing", "bug_description": "The fix for WFCORE-1804 was committed here.\nIt has a side-effect that it disables quote parsing. Now the another fix which does not have the side-effect was committed in aesh. The following line in the previous fix should be removed, when the new aesh version is released (0.66.11 or 12?).\ncli/src/main/java/org/jboss/as/cli/impl/CommandContextImpl.java:495\n\n\n\n\n\n\n        settings.parsingQuotes(false);\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha11", "fixed_version": "3.0.0.Alpha13", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java", "org.jboss.as.test.integration.management.cli.CliCommentsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1975, "bug_title": "EmbeddedProcessFactory does not accept module pathes with multiple directories", "bug_description": "The modulePath parameters passed to the org.wildfly.core.embedded.EmbeddedProcessFactory methods are are rejected if they they are actual paths with multiple directories. Only single directory names are accepted.\nThis is inconsistent with the normal operation of the server, with the naming of the parameter, as well as with the semantics of the module.path system property that it ultimately sets.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha12", "fixed_version": "3.0.0.Alpha13", "fixed_files": ["org.wildfly.core.embedded.EmbeddedProcessFactory.java"], "label": 1, "es_results": []}, {"bug_id": 1980, "bug_title": "Property file passed via CLI does not resolve expressions with relative path value in vault attributes", "bug_description": "Property file passed via CLI with --properties option does not resolve expressions in EAP 7, where in EAP 6 it works fine. ", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha12", "fixed_version": "3.0.0.Alpha13", "fixed_files": ["org.jboss.as.cli.parsing.test.PropertyReplacementTestCase.java", "org.jboss.as.cli.ArgumentValueConverter.java", "org.jboss.as.cli.util.CLIExpressionResolver.java"], "label": 1, "es_results": []}, {"bug_id": 1992, "bug_title": "CLI inconsistently parse {} in another object as UNDEFINED", "bug_description": "CLI interprets {} as blank object in resource attribute (correct), but as UNDEFINED in object attribute. (in model parameter of performRuntime of ADD operation)\n\n\n\n\n\n\n/subsystem=elytron/properties-realm=realm:add(users-properties={path=$SOME_PATH},groups-properties={})\n\n\n\n\n=> groups-properties = OBJECT {}\n\n\n\n\n\n\n\n\n\n\n\n\n/subsystem=elytron/ldap-realm=ldap-realm8:add(dir-context=local-ldap,identity-mapping={rdn-identifier=uid,otp-credential-mapper={}})\n\n\n\n\n=> otp-credential-mapper=UNDEFINED\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha12", "fixed_version": "3.0.0.Alpha13", "fixed_files": ["org.jboss.as.cli.parsing.test.ArgumentValueConverterTestCase.java", "org.jboss.as.cli.parsing.arguments.ArgumentValueCallbackHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2006, "bug_title": "PatchMerger should copy specific module slot when merging content instead of all the slots", "bug_description": "PatchMerger when merging content modification for a module copies all of the module slots instead of the one actually modified. This may lead to undesired content overwrite.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha12", "fixed_version": "3.0.0.Alpha13", "fixed_files": ["org.jboss.as.patching.metadata.PatchMerger.java", "org.jboss.as.test.patching.MergedCpWithSubmoduleTestCase.java", "org.jboss.as.test.patching.ContentModificationUtils.java"], "label": 1, "es_results": []}, {"bug_id": 2013, "bug_title": "Unable to access http management interface secured by legacy ldap realm", "bug_description": "When http management interface is secured with legacy security realm using ldap, user is not prompted to provide credentials as should be in case of BASIC http authentication mechanism. Instead 403 http status is returned directly.\nUsers won&apos;t be able to migrate their current (6.4, 7.0) configuration to 7.1 without change.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha12", "fixed_version": "3.0.0.Alpha13", "fixed_files": ["org.jboss.as.domain.management.security.SecurityRealmService.java"], "label": 1, "es_results": []}, {"bug_id": 2008, "bug_title": "Unable to use path in input-stream-index argument in /core-service=patching:patch", "bug_description": "File system paths should be allowed as arguments for\n/core-service=patching:patch(input-stream-index=)", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha12", "fixed_version": "3.0.0.Alpha13", "fixed_files": ["org.jboss.as.patching.management.PatchResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 2017, "bug_title": "embed-server does not start with standalone-elytron.xml", "bug_description": "I am unable to start embed-server with standalone-elytron.xml \n1)./jboss-cli.sh\n2) embed-server --std-out=echo -c=standalone-elytron.xml\n3) server is missing org.wildfly.security.security-domain.ManagementDomain, which is however registered in elytron subsystem.\nStarting ./standalone.sh -c=standalone-elytron.xml works fine.\nFull log:\n\n\n\n\n\n\n[mchoma@localhost bin]$ ./jboss-cli.sh \n\n\n\n\nYou are disconnected at the moment. Type &apos;connect&apos; to connect to the server or &apos;help&apos; for the list of supported commands.\n\n\n\n\n[disconnected /] embed-server --std-out=echo -c=standalone-elytron.xml\n\n\n\n\n08:15:40,801 INFO  [org.jboss.modules] (AeshProcess: 1) JBoss Modules version 1.6.0.Beta3\n\n\n\n\n08:15:40,845 INFO  [org.jboss.msc] (AeshProcess: 1) JBoss MSC version 1.2.7.Final-redhat-1\n\n\n\n\n08:15:40,916 INFO  [org.jboss.as] (MSC service thread 1-6) WFLYSRV0049: JBoss EAP 7.1.0.Alpha1 (WildFly Core 3.0.0.Alpha12-redhat-1) starting\n\n\n\n\n08:15:41,088 INFO  [org.jboss.as.domain.management] (MSC service thread 1-5) WFLYDM0136: Registered OpenSSL provider\n\n\n\n\n08:15:41,804 INFO  [org.wildfly.security] (Controller Boot Thread) ELY00001: WildFly Elytron version 1.1.0.Beta13\n\n\n\n\n08:15:41,805 INFO  [org.wildfly.extension.elytron] (Controller Boot Thread) WFLYELY00001: Activating Elytron Subsystem Elytron Version=1.1.0.Beta13, Subsystem Version=1.0.0.Alpha13\n\n\n\n\n08:15:41,811 INFO  [org.jboss.as.controller.management-deprecated] (Controller Boot Thread) WFLYCTL0028: Attribute &apos;security-realm&apos; in the resource at address &apos;/subsystem=undertow/server=default-server/https-listener=https&apos; is deprecated, and may be removed in future version. See the attribute description in the output of the read-resource-description operation to learn more about the deprecation.\n\n\n\n\n08:15:41,859 INFO  [org.jboss.as.patching] (MSC service thread 1-6) WFLYPAT0050: JBoss EAP cumulative patch ID is: base, one-off patches include: none\n\n\n\n\n08:15:42,024 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (\"add\") failed - address: ([\n\n\n\n\n    (\"core-service\" => \"management\"),\n\n\n\n\n    (\"access\" => \"identity\")\n\n\n\n\n]) - failure description: {\n\n\n\n\n    \"WFLYCTL0412: Required services that are not installed:\" => [\"org.wildfly.security.security-domain.ManagementDomain\"],\n\n\n\n\n    \"WFLYCTL0180: Services with missing/unavailable dependencies\" => [\"org.wildfly.management.identity is missing [org.wildfly.security.security-domain.ManagementDomain]\"]\n\n\n\n\n}\n\n\n\n\n08:16:19,546 INFO  [org.jboss.as] (MSC service thread 1-4) WFLYSRV0050: JBoss EAP 7.1.0.Alpha1 (WildFly Core 3.0.0.Alpha12-redhat-1) stopped in 3ms\n\n\n\n\nCannot start embedded server: WFLYEMB0021: Cannot start embedded process: java.lang.InterruptedException\n\n\n\n\n[disconnected /] \n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha12", "fixed_version": "3.0.0.Alpha13", "fixed_files": ["org.jboss.as.domain.management.access.AccessIdentityResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 2026, "bug_title": "source-port is wrongly offsetted when configured to 0, i.e. ephemeral port; results in \"Permission denied (Bind failed)\"", "bug_description": "There is a discrepancy between how 0 is handled.\nXSD\n\n\n\n\n\n\n        <xs:attribute name=\"source-port\" type=\"xs:positiveInteger\" use=\"optional\">\n\n\n\n\n\n\ndoesn&apos;t allow 0.\nMODEL\n\n\n\n\n\n\n            .setAllowExpression(true).setValidator(new IntRangeValidator(0, 65535, true, true))\n\n\n\n\n\n\nallows 0.\nIMPLEMENTATION\n\n\n\n\n\n\n    public Integer getAbsoluteSourcePort() {\n\n\n\n\n        if (this.sourcePort == null) {\n\n\n\n\n            return null;\n\n\n\n\n        }\n\n\n\n\n        if (this.fixedSourcePort) {\n\n\n\n\n            return this.sourcePort;\n\n\n\n\n        }\n\n\n\n\n        final int portOffset = this.socketBindingManager.getPortOffset();\n\n\n\n\n        return this.sourcePort + portOffset;\n\n\n\n\n    }\n\n\n\n\n\n\ndoesn&apos;t treat 0 at all, tests for null value only.\nExample to reproduce e.g. with modcluster integration in core:\n\n\n\n\n\n\n[standalone@localhost:9990 /] /socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=proxy1:add(port=9090,host=127.0.0.1,source-port=0\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"response-headers\" => {\"process-state\" => \"reload-required\"}\n\n\n\n\n}\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=modcluster/mod-cluster-config=configuration:write-attribute(name=proxies,value=[proxy1])\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"response-headers\" => {\n\n\n\n\n        \"operation-requires-reload\" => true,\n\n\n\n\n        \"process-state\" => \"reload-required\"\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n[standalone@localhost:9990 /] :reload\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => undefined\n\n\n\n\n}\n\n\n\n\n\n\nStarting server with \n\n\n\n\n\n\n-Djboss.socket.binding.port-offset=100\n\n\n\n\n\n\nyields\n\n\n\n\n\n\n20:15:40,471 ERROR [org.jboss.modcluster] (UndertowEventHandlerAdapter - 1) MODCLUSTER000043: Failed to send INFO command to localhost/127.0.0.1:9090: Permission denied (Bind failed)\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha12", "fixed_version": "3.0.0.Alpha13", "fixed_files": ["org.jboss.as.network.OutboundSocketBinding.java"], "label": 1, "es_results": []}, {"bug_id": 2021, "bug_title": "\"ls /socket-binding-group=*\" should print proper error message", "bug_description": "\"ls /socket-binding-group=\" should print proper error message. Similar operation \"ls /subsystem=\" print good error message.\n\n\n\n\n\n\n[standalone@localhost:9990 /] ls /subsystem=*\n\n\n\n\n{\"WFLYCTL0062: Composite operation failed and was rolled back. Steps that failed:\" => {\"Operation step-1\" => \"WFLYCTL0030: No resource definition is registered for address [(\\\"subsystem\\\" => \\\"*\\\")]\"}}\n\n\n\n\n[standalone@localhost:9990 /] ls /socket-binding-group=*\n\n\n\n\nException for ls /socket-binding-group=*: java.lang.IllegalArgumentException\n\n\n\n\n[standalone@localhost:9990 /]\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha12", "fixed_version": "3.0.0.Alpha15", "fixed_files": ["org.jboss.as.cli.handlers.LsHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2083, "bug_title": "Reduce number of object allocations and memory footprint", "bug_description": "Profiler shows that we lots of duplicate object allocations with empty arrays\nIt also shows that lots of our builder objects are kept in memory even after builder did its job and created the object.\nThere are also cases where inner classes should be static to prevent capturing object reference to be kept\nand many other cases.", "project": "Wildfly", "sub_project": "WFCORE", "version": "3.0.0.Alpha14", "fixed_version": "3.0.0.Alpha15", "fixed_files": ["org.jboss.as.controller.AttributeDefinition.java", "org.jboss.as.controller.ResourceBuilderRoot.java", "org.wildfly.extension.security.manager.SecurityManagerSubsystemParser_3_0.java", "org.wildfly.extension.security.manager.SecurityManagerExtension.java", "org.wildfly.extension.security.manager.SecurityManagerSubsystemParser_1_0.java", "org.jboss.as.controller.AttributeMarshallers.java", "org.jboss.as.controller.AbstractAttributeDefinitionBuilder.java", "org.jboss.as.controller.SimpleOperationDefinitionBuilder.java", "org.jboss.as.controller.registry.AbstractModelResource.java", "org.jboss.as.controller.AttributeMarshaller.java", "org.jboss.as.controller.SimpleResourceDefinition.java", "org.jboss.as.controller.SimpleListAttributeDefinition.java", "org.jboss.as.controller.SimpleOperationDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 4670, "bug_title": "Term 'jacorb' is part of xml configuration file despite of fact being replaced by IIOP orb", "bug_description": "Implementation of ORB - JacORB is replaced by JDK ORB in WildFly 10. Neverhteless server xml configuration files contain term &apos;jacorb&apos; at several places.\nShould not be word &apos;jacorb&apos; removed from xml configuration and replaced by term &apos;iiop orb&apos;?\nExamples of occurrence\n\n\n\n\n\n\n        <!-- TODO - only show this if the jacorb subsystem is added  -->\n\n\n\n\n        <interface name=\"unsecure\">\n\n\n\n\n            <!--\n\n\n\n\n              ~  Used for IIOP sockets in the standard configuration.\n\n\n\n\n              ~                  To secure JacORB you need to setup SSL \n\n\n\n\n              -->\n\n\n\n\n            <inet-address value=\"${jboss.bind.address.unsecure:127.0.0.1}\"/>\n\n\n\n\n        </interface>\n\n\n\n\n\n\n\n\n\n\n\n\n            <logger category=\"jacorb\">\n\n\n\n\n                <level name=\"WARN\"/>\n\n\n\n\n            </logger>\n\n\n\n\n            <logger category=\"jacorb.config\">\n\n\n\n\n                <level name=\"ERROR\"/>\n\n\n\n\n            </logger>\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha1", "fixed_version": "10.0.0.Alpha2", "fixed_files": ["org.jboss.as.ejb3.iiop.EjbIIOPService.java"], "label": 1, "es_results": []}, {"bug_id": 4657, "bug_title": "EJB timer blocked after trigger+suspend+activate operations and JDBC storage", "bug_description": "Scenario:\n\nThe AS is configured to use a JDBC storage for EJB timers (using the H2 ExampleDS is sufficient for reproduction)\nThere is a persistent calendar timer going off every few seconds\nThe &apos;trigger&apos; management operation is called on that timer\nThe timer goes off one time extra, as expected\nThe &apos;suspend&apos; management operation is called on that timer\nAfter a few seconds, the &apos;activate&apos; operation is called on that timer\nThe timer will never go off again (not even by invoking &apos;trigger&apos; operation)\n\nThe because:\n\nEach time the timer goes off, a new java.util.TimerTask is scheduled to handle the next alarm\nWhen the &apos;trigger&apos; operation is invoked, the TimerServiceImpl computes the timestamp of the next alarm and schedules a new TimerTask\nThe problem is that this new TimerTask overwrites the one currently registered in the TimerServiceImpl, because the TimerServiceImpl assigns TimerTasks to Timers using a map: https://github.com/wildfly/wildfly/blob/10.0.0.Alpha1/ejb3/src/main/java/org/jboss/as/ejb3/timerservice/TimerServiceImpl.java#L905 - the TimerServiceImpl loses the reference to the previously registered TimerTask and doesn&apos;t cancel it\nFrom now on, each new alarm registers the next TimerTask, but makes TimerServiceImpl forget the previous one\nAfter some time, when the &apos;suspend&apos; operation is called, the TimerServiceImpl cancels its stored TimerTask. However, it doesn&apos;t know that there is another scheduled elsewhere\nThe TimerTask goes off during the time when the timer is suspended.\nDatabaseTimerPersistence checks whether the TimerTask can run and sets the Timer&apos;s state to IN_TIMEOUT if yes (https://github.com/wildfly/wildfly/blob/10.0.0.Alpha1/ejb3/src/main/java/org/jboss/as/ejb3/timerservice/persistence/database/DatabaseTimerPersistence.java#L395). However, this is done BEFORE checking whether the timer is suspended. DatabaseTimerPersistence commits this change. Then comes the mentioned check (https://github.com/wildfly/wildfly/blob/10.0.0.Alpha1/ejb3/src/main/java/org/jboss/as/ejb3/timerservice/task/TimerTask.java#L141) and it fails, so the Timer will not go off, but the Timer state remains IN_TIMEOUT forever!\nWith every next invocation, as the timer&apos;s state remains IN_TIMEOUT, all invocations are skipped.\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha1", "fixed_version": "10.0.0.Alpha2", "fixed_files": ["org.jboss.as.ejb3.subsystem.deployment.TimerResourceDefinition.java", "org.jboss.as.test.integration.ejb.timerservice.mgmt.AbstractTimerManagementTestCase.java", "org.jboss.as.ejb3.timerservice.task.CalendarTimerTask.java", "org.jboss.as.ejb3.timerservice.TimerImpl.java", "org.jboss.as.test.integration.ejb.timerservice.database.DatabaseTimerServiceTestCase.java", "org.jboss.as.ejb3.timerservice.task.TimerTask.java", "org.jboss.as.ejb3.timerservice.TimerServiceImpl.java", "org.jboss.as.ejb3.timerservice.CalendarTimer.java", "org.jboss.as.ejb3.logging.EjbLogger.java", "org.jboss.as.test.integration.ejb.timerservice.mgmt.AbstractTimerBean.java"], "label": 1, "es_results": []}, {"bug_id": 4732, "bug_title": "Potential race in test suite where ops can execute before server has reloaded", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha2", "fixed_version": "9.0.0.CR2", "fixed_files": ["org.jboss.as.test.manualmode.ws.ReloadRequiringChangesTestCase.java", "org.jboss.as.test.integration.jca.moduledeployment.AbstractModuleDeploymentTestCaseSetup.java"], "label": 1, "es_results": []}, {"bug_id": 4654, "bug_title": "JGroups transport type cannot be set", "bug_description": "I&apos;m trying to set transport type for JGroups UDP transport. After successful setting via CLI (or model node) and reload, this value is reverted back to undefined.\n[standalone@localhost:9990 transport=UDP] :write-attribute(name=\"type\" ,value=\"TUNNEL\")\n{\n    \"outcome\" => \"success\",\n    \"response-headers\" => \n{\n\n        \"operation-requires-reload\" => true,\n\n        \"process-state\" => \"reload-required\"\n\n    }\n}\n[standalone@localhost:9990 transport=UDP] ls\nproperty                              diagnostics-socket-binding=undefined  oob-executor=undefined                shared=false                          thread-factory=undefined              \nthread-pool                           machine=undefined                     properties=[]                         site=undefined                        timer-executor=undefined              \ndefault-executor=undefined            module=org.jgroups                    rack=undefined                        socket-binding=jgroups-udp            type=undefined   ", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha1", "fixed_version": "10.0.0.Alpha3", "fixed_files": ["org.jboss.as.clustering.jgroups.subsystem.StackResourceDefinition.java", "org.jboss.as.clustering.jgroups.subsystem.TransportResourceDefinition.java", "org.jboss.as.clustering.controller.transform.SimpleAddOperationTransformer.java", "org.jboss.as.clustering.jgroups.subsystem.PropertyResourceDefinition.java", "org.jboss.as.clustering.jgroups.subsystem.OperationsTestCase.java", "org.jboss.as.clustering.jgroups.subsystem.ProtocolResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 4800, "bug_title": "No reload required when add mime-mapping to servlet-container", "bug_description": "When mime-mapping is added to servlet container then no reload of server is required, although change takes effect after server restart is performed.\nExpected behaivour is either that change takes effect immediatelly after configuration is changed or that server reload is required in response message and result of the operation.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha3", "fixed_version": "10.0.0.Alpha4", "fixed_files": ["org.wildfly.extension.undertow.MimeMappingDefinition.java", "org.wildfly.extension.undertow.WelcomeFileDefinition.java", "org.jboss.as.clustering.controller.ReloadRequiredAddStepHandler.java"], "label": 1, "es_results": []}, {"bug_id": 4801, "bug_title": " When expression is used in jndi name attribute of datasource then test-connection-in-pool operation is not working", "bug_description": "\n\n\n\n\n\nDescription of problem:\n\n\n\n\n========================\n\n\n\n\n\n\n\n\n\n- Expression is added in the datasource JNDI name attribute as below:\n\n\n\n\n-----\n\n\n\n\n  <datasource jndi-name=\"${ds}\" pool-name=\"ExampleDS\" enabled=\"true\" use-java-context=\"true\">\n\n\n\n\n-----\n\n\n\n\n\n\n\n\n\n- Value for the expression is passed to the JBoss server during the JBoss startup as below:\n\n\n\n\n-----\n\n\n\n\n  ./standalone.sh -Dds=java:jboss/datasources/ExampleDS\n\n\n\n\n-----\n\n\n\n\n\n\n\n\n\n- In the server.log file below is the information regarding the datasource.\n\n\n\n\n-----\n\n\n\n\n  INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-3) JBAS010400: Bound data source [${ds}]\n\n\n\n\n----- \n\n\n\n\n\n\n\n\n\n- Test the datasource using the below command and here is the result:\n\n\n\n\n----\n\n\n\n\n[standalone@localhost:9999 /] /subsystem=datasources/data-source=ExampleDS:test-connection-in-pool()\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"JBAS010440: failed to invoke operation: JBAS010442: failed to match pool. Check JndiName: java:/${ds}\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n----\n\n\n\n\n\n\n\n\n\n- Here is the information regarding the JNDI name attribute:\n\n\n\n\n----\n\n\n\n\n[standalone@localhost:9999 /] /subsystem=datasources/data-source=ExampleDS:read-resource-description(recursive=true)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => {\n\n\n\n\n        \t  :\n\n\n\n\n            \"jndi-name\" => {\n\n\n\n\n                \"type\" => STRING,\n\n\n\n\n                \"description\" => \"Specifies the JNDI name for the datasource\",\n\n\n\n\n                \"expressions-allowed\" => true,\n\n\n\n\n                \"nillable\" => false,\n\n\n\n\n                \"access-type\" => \"read-write\",\n\n\n\n\n                \"storage\" => \"configuration\",\n\n\n\n\n                \"restart-required\" => \"no-services\"\n\n\n\n\n            },\n\n\n\n\n\t\t  :\n\n\n\n\n}\n\n\n\n\n-----\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha3", "fixed_version": "10.0.0.Alpha4", "fixed_files": ["org.jboss.as.connector.subsystems.common.pool.PoolOperations.java", "org.jboss.as.connector.subsystems.datasources.DataSourceDisable.java", "org.jboss.as.connector.subsystems.datasources.DataSourceEnable.java", "org.jboss.as.connector.subsystems.datasources.Util.java", "org.jboss.as.connector.subsystems.datasources.AbstractDataSourceAdd.java", "org.jboss.as.connector.subsystems.datasources.AbstractDataSourceRemove.java"], "label": 1, "es_results": []}, {"bug_id": 4697, "bug_title": "EJBClient access to SFSBs does not play well with clean shutdown", "bug_description": "The clean shutdown mechanism allows EJB and web applications to make use of shutdown interceptors to allow the application server to refuse requests when a server is in the process of shutting down. These interceptors are tied to the processing of EJB invocations and web requests.\nIn the case of EJBCLient invocations, they arrive at the remoting connector, and undergo some preliminary processing before being sent to the EJB interface in question. When a server is shutting down, EJBCLient invocations can arrive at the RemoteConnector and start processing, even when the EJB interface has been locked down, so to speak.\nI am seeing various types of exceptions arising from this preliminary processing (e.g. NPE on DeploymentRepository lookups) and these get returned to the client as exceptions on the SFSB invocation, before even reaching the SFSB interceptors.\nIf the EJBCLient is running in a managed transaction context, these returned exceptions will case the SFSB to be discarded (as the SFSB invocation is considered failed with the exception returned) and the transaction will attempt to rollback. If the rollback processing fails (because the original node in the transaction is down the bean gets removed anyway. The SFSB session state is lost, even if there is another node in the cluster which can support the invocation.\nIn short, it looks as though the clean shutdown mechanism needs to be used to also lock down the processing of EJBCLient invocations in some way.\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha1", "fixed_version": "10.0.0.Alpha4", "fixed_files": ["org.jboss.as.test.clustering.cluster.ejb.remote.RemoteFailoverTestCase.java", "org.jboss.as.clustering.infinispan.subsystem.TransactionResourceDefinition.java", "org.jboss.as.ejb3.remote.protocol.versionone.VersionOneProtocolChannelReceiver.java", "org.jboss.as.ejb3.subsystem.EJB3RemoteServiceAdd.java", "org.jboss.as.ejb3.remote.protocol.versiontwo.VersionTwoProtocolChannelReceiver.java", "org.jboss.as.ejb3.remote.EJBRemoteConnectorService.java"], "label": 1, "es_results": []}, {"bug_id": 4645, "bug_title": "access log rotates even when rotation is disabled by \"rotate\" attribute", "bug_description": "When I disable access log rotation by setting \"rotate\" attribute to false:\n\n\n\n\n\n\n/subsystem=undertow/server=default-server/host=default-host/setting=access-log/:write-attribute(name=rotate,value=false)\n\n\n\n\n\n\nThe logfile keeps rotating - how tested in \"Steps to Reproduce\" section.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha1", "fixed_version": "10.0.0.Alpha5", "fixed_files": ["org.wildfly.extension.undertow.AccessLogService.java", "org.wildfly.extension.undertow.AccessLogAdd.java", "org.wildfly.extension.undertow.UndertowSubsystemTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 4735, "bug_title": " Example configuration standalone-hornetq-colocated.xml is not correct", "bug_description": "Example configuration standalone-hornetq-colocated.xml is not correct. This file is located in $JBOSS_HOME/docs/examples/configs\nDelete this file and replace it with correct configuration file for WildFly.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha1", "fixed_version": "10.0.0.Alpha5", "fixed_files": ["org.jboss.as.test.manualmode.parse.ParseAndMarshalModelsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 4815, "bug_title": " AdvancedLdapLoginModuleTestCase fails on RHEL5 and IBM JDK", "bug_description": "Upstream of https://bugzilla.redhat.com/show_bug.cgi?id=1206177", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha3", "fixed_version": "10.0.0.Alpha5", "fixed_files": ["org.jboss.as.test.integration.security.picketlink.SAML2KerberosAuthenticationTestCase.java", "org.jboss.as.test.integration.security.common.Utils.java", "org.jboss.as.test.integration.security.picketlink.PicketLinkTestBase.java", "org.jboss.as.test.integration.security.loginmodules.negotiation.GSSTestServer.java", "org.jboss.as.test.integration.security.common.Krb5LoginConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 4861, "bug_title": "Unable to establish HTTP/2 connection via plain http (non https)", "bug_description": "HTTP/2 doesn&apos;t work over plain http (non-https) even when http-listener&apos;s enable-http2 option is set to true, see [1].\nI am using Http2 client from netty for trying whether it is possible to establish HHTP/2 connection via upgrade.\n[1] \n\n\n\n\n\n\n <server name=\"default-server\">\n\n\n\n\n                <http-listener name=\"default\" socket-binding=\"http\" enable-http2=\"true\" redirect-socket=\"https\"/>\n\n\n\n\n                <https-listener name=\"https\" socket-binding=\"https\" security-realm=\"https\" enable-http2=\"true\"/>\n\n\n\n\n                <host name=\"default-host\" alias=\"localhost\">\n\n\n\n\n                    <location name=\"/\" handler=\"welcome-content\"/>\n\n\n\n\n                    <filter-ref name=\"server-header\"/>\n\n\n\n\n                    <filter-ref name=\"x-powered-by-header\"/>\n\n\n\n\n                </host>\n\n\n\n\n            </server>\n\n\n\n\n\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha4", "fixed_version": "10.0.0.Alpha5", "fixed_files": ["org.wildfly.extension.undertow.HttpListenerService.java"], "label": 1, "es_results": []}, {"bug_id": 4917, "bug_title": "Invalid context set up for batch threads", "bug_description": "Batch tasks incorrectly set-up the contexts needed for the executed tasks. The task needs to be set-up outside the new thread.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha5", "fixed_version": "10.0.0.Alpha6", "fixed_files": ["org.wildfly.jberet.services.BatchEnvironmentService.java"], "label": 1, "es_results": []}, {"bug_id": 4925, "bug_title": "Admin in Monitor role can execute test-connection-in-pool op", "bug_description": "This should not work, as the Monitor role is not allowed to do anything that modifies any state:\n\n\n\n\n\n\n[standalone@localhost:9990 data-source=ExampleDS] :test-connection-in-pool{roles=Monitor}\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [true]\n\n\n\n\n}\n\n\n\n\n\n\nI believe the problem is PoolOperations L75:\n\n\n\n\n\n\nfinal ServiceController<?> managementRepoService = context.getServiceRegistry(false).getService(\n\n\n\n\n        ConnectorServices.MANAGEMENT_REPOSITORY_SERVICE);\n\n\n\n\n\n\nThe parameter to context.getServiceRegistry(...) must be &apos;true&apos; if the operation is going to use the returned service registry to perform any form of state modification. So I believe all the PoolOperation subclasses should provide a param to PoolOperation&apos;s constructor that can be used to set this value. I believe in all subclasses except DumpQueuedThreadInPool this param should be &apos;true&apos;.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha5", "fixed_version": "10.0.0.Alpha6", "fixed_files": ["org.jboss.as.connector.subsystems.common.pool.PoolOperations.java"], "label": 1, "es_results": []}, {"bug_id": 4977, "bug_title": "excluded-connectors attribute in replicated colocated topology is mandatory", "bug_description": "excluded-connectors attribute is mandatory when replicated colocated topology is defined. Attribute should be optional.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha5", "fixed_version": "10.0.0.Alpha6", "fixed_files": ["org.wildfly.extension.messaging.activemq.ha.HAAttributes.java"], "label": 1, "es_results": []}, {"bug_id": 5032, "bug_title": "Authentication token in session triggers replication of session each request", "bug_description": "If an authentication token exists in the web session, and the user is using FORM or a custom authentication mechanism, then that token is read from the session each request.  The token is treated as a mutable object by the clustering code and triggers replication of the session on each request.\nAnnotating this with @Immutable will fix the problem.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.Beta1", "fixed_files": ["org.wildfly.clustering.web.undertow.session.DistributableSessionTestCase.java", "org.wildfly.clustering.web.undertow.session.DistributableSession.java"], "label": 1, "es_results": []}, {"bug_id": 4983, "bug_title": "Undertow mod_cluster CLI: Display node's protocol://hostname:port", "bug_description": "As a follow up to JBEAP-215, this bug report is a member of a series addressing crucial CLI management capabilities.\nDisplay node&apos;s protocol://hostname:port\nAt the moment, this is all there is to see:\n\n\n\n\n\n\n\"balancer\" => {\n\n\n\n\n    \"qa_balancer\" => {\"node\" => {\"worker-2\" => {\n\n\n\n\n        \"load\" => 89,\n\n\n\n\n        \"status\" => \"NODE_UP\",\n\n\n\n\n        \"context\" => {\"/clusterbench\" => {\n\n\n\n\n            \"requests\" => 0,\n\n\n\n\n            \"status\" => \"enabled\"\n\n\n\n\n        }}\n\n\n\n\n    }}},\n\n\n\n\n...\n\n\n\n\n\n\nCall to action\nWe need to display node&apos;s connection details, e.g. ajp://karm.brq.redhat.com:8019 or https://192.168.1.100:8009.\nI set Blocker priority, because without this information available, it is impossible to test anything more than rudimentary smoke-test scenarios. From the user&apos;s perspective, inability to identify JVMRoutes (node names) with their connection strings renders any larger enterprise setup very hard to manage and maintain.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha5", "fixed_version": "10.0.0.Beta1", "fixed_files": ["org.wildfly.extension.undertow.filters.ModClusterNodeDefinition.java", "org.wildfly.extension.undertow.Constants.java"], "label": 1, "es_results": []}, {"bug_id": 5051, "bug_title": "Requests for persistent sessions always trigger replication", "bug_description": "For persistent sessions, we trigger session session activation events after a successful SessionManager.findSession(...).  However, this is currently triggered using a Session instance, instead of an ImmutableSession instance, which causes iteration over session attributes to trigger replication of the session at the end of the request - even when the user does not access any mutable session attributes.\nThe same is true for Session.close() (via session passivation event).", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.Beta1", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.InfinispanSessionManager.java"], "label": 1, "es_results": []}, {"bug_id": 5035, "bug_title": "ClusteredMessagingTestCase.testClusteredQueue fails intermittently", "bug_description": "Originally opened as https://issues.jboss.org/browse/WFLY-4936 but these failures are also to be seen on Linux thus we can rule out ttl problems.\nThe problem indeed is in using udp stack in CI, we can get reliable results using the tcp stack.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.Beta1", "fixed_files": ["org.jboss.as.test.clustering.messaging.ClusteredMessagingTestCase.java", "org.jboss.as.test.clustering.ClusteringTestConstants.java"], "label": 1, "es_results": []}, {"bug_id": 4999, "bug_title": "XSiteBackupForTestCase tests fail on Windows with IPv6", "bug_description": "See http://brontes.lab.eng.brq.redhat.com/project.html?projectId=WF_PullRequest&testNameId=1140899232324454378&tab=testDetails", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.Beta1", "fixed_files": ["org.jboss.as.test.clustering.xsite.XSiteBackupForTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 5070, "bug_title": "@WebServlet.loadOnStartup=0 does not startup the servlet", "bug_description": "Servlet is autostarted only with loadOnStartup value > 0. Specification says value can be >= 0.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.Beta2", "fixed_files": ["org.wildfly.extension.undertow.deployment.WarAnnotationDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 5107, "bug_title": "WFLYCTL0028: Attribute 'default-stack' in the resource at address '/subsystem=jgroups' is deprecated, and may be removed in future version.", "bug_description": "I noticed this message below in the server.log.  Is this message intended or a bug?\nINFO  [org.jboss.as.controller.management-deprecated] (ServerService Thread Pool  27) WFLYCTL0028: Attribute &apos;default-stack&apos; in the resource at address &apos;/subsystem=jgroups&apos; is deprecated, and may be removed in future version.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta1", "fixed_version": "10.0.0.Beta2", "fixed_files": ["org.jboss.as.connector.subsystems.jca.DistributedWorkManagerAdd.java", "org.jboss.as.clustering.jgroups.subsystem.JGroupsSubsystemXMLReader.java", "org.jboss.as.clustering.jgroups.subsystem.JGroupsSubsystemInitialization.java", "org.jboss.as.clustering.jgroups.subsystem.JGroupsSchema.java", "org.jboss.as.clustering.jgroups.subsystem.JGroupsModel.java", "org.wildfly.clustering.jgroups.spi.service.ProtocolStackServiceNameFactory.java", "org.jboss.as.clustering.jgroups.subsystem.ChannelResourceDefinition.java", "org.jboss.as.clustering.jgroups.subsystem.OperationsTestCase.java", "org.jboss.as.clustering.jgroups.subsystem.JGroupsSubsystemServiceHandler.java", "org.jboss.as.clustering.jgroups.subsystem.ChannelServiceHandler.java", "org.wildfly.clustering.jgroups.spi.service.ProtocolStackServiceName.java", "org.jboss.as.clustering.jgroups.subsystem.SubsystemParsingTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 5022, "bug_title": "The server requires JASPI authentication even if no security-constraint is defined", "bug_description": "If JASPI authentication is configured in security domain, then the server requires authentication even if no security-constraint is defined for web application which uses the security domain.\nWith the classic authentication is the behavior correct.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.Beta2", "fixed_files": ["org.wildfly.extension.undertow.UndertowSubsystemParser_3_0.java", "org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java", "org.wildfly.extension.undertow.ServletContainerDefinition.java", "org.wildfly.extension.undertow.Constants.java", "org.wildfly.extension.undertow.ServletContainerService.java", "org.jboss.as.test.integration.security.jaspi.JASPIHttpSchemeServerAuthModelTestCase.java", "org.jboss.as.test.manualmode.web.ssl.DatabaseCertLoginModuleTestCase.java", "org.wildfly.extension.undertow.ServletContainerAdd.java", "org.jboss.as.test.manualmode.web.ssl.CertificateRolesLoginModuleTestCase.java", "org.jboss.as.test.manualmode.web.ssl.HTTPSWebConnectorTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 4954, "bug_title": "Undertow mod_cluster proxy enforces aliases checks a.k.a. UseAlias:true", "bug_description": "If one uses hostnames and a worker registers itself e.g. as Host=karm.brq.redhat.com the Undertow mod_cluster proxy enforces exact alias matching, which corresponds to Apache HTTP Server mod_cluster module implementation directive UseAlias being set to 1 (enforcing).\nSymptoms\nThus registered worker&apos;s context:\n\n\n\n\n\n\nINFO  [io.undertow] (default task-3) registering context /clusterbench, for node worker-1, \n\n\n\n\nwith aliases [default-host, localhost]\n\n\n\n\n\n causes HTTP 404 errors both while trying to access the context on IP address or hostname.\nThis worker: \n\n\n\n\n\nINFO  [io.undertow] (default task-20) registering context /clusterbench, for node worker-1, \n\n\n\n\nwith aliases [default-host, karm.brq.redhat.com]\n\n\n\n\n\n, with one of its aliases being karm.brq.redhat.com could be accessed via the Undertow mod_cluster proxy without problems.\nCall to action\nWe need to decide whether this difference in default behaviour is desirable or not and act accordingly.\nWDYT? \n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha4", "fixed_version": "10.0.0.Beta2", "fixed_files": ["org.wildfly.extension.undertow.filters.ModClusterDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 4839, "bug_title": "annotation must be scanned regardless of the version of web.xml unless metadata-complete is explicitly set to true", "bug_description": "\n\n\n\n\n\n### Description of problem:\n\n\n\n\n\n\n\n\n\nAnnotation must be scanned regardless of the version of web.xml unless metadata-complete is explicitly set to true.\n\n\n\n\n\n\n\n\n\nNote that Servlet 3.0 specification clearly states the following:\n\n\n\n\n\n\n\n\n\n~~~\n\n\n\n\n1.6.2 Processing annotations\n\n\n\n\nIn Servlet 2.5, metadata-complete only affected the scanning of annotations at\n\n\n\n\ndeployment time. The notion of web-fragments did not exist in servlet 2.5. However\n\n\n\n\nin servlet 3.0 metadata-complete affects scanning of all annotations and web-\n\n\n\n\nfragments at deployment time. The version of the descriptor MUST not affect which\n\n\n\n\nannotations you scan for in a web application. An implementation of a particular\n\n\n\n\nversion of the specification MUST scan for all annotations supported in that\n\n\n\n\nconfiguration, unless metadata-complete is specified.\n\n\n\n\n~~~\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### How reproducible:\n\n\n\n\n\n\n\n\n\nAnytime\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### Steps to Reproduce:\n\n\n\n\n\n\n\n\n\n1. Create a library jar which contains a servlet filter using @WebFilter \n\n\n\n\n2. Put the jar under WEB-INF/lib of the web application which web.xml version is 2.3 or 2.4\n\n\n\n\n3. Start JBoss EAP 6\n\n\n\n\n4. Access the web application and see if the servlet filter works\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### Actual results:\n\n\n\n\n\n\n\n\n\nThe servlet filter is not invoked\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### Expected results:\n\n\n\n\n\n\n\n\n\nThe servlet filter is invoked\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### Additional info:\n\n\n\n\n\n\n\n\n\nIt works when the version of web.xml is 2.5 or 3.0\n\n\n\n\n\n\n\n\n\n[reply] []\n\n\n\n\nPrivate\n\n\n\n\nComment 1 Masafumi Miura 2015-06-25 07:18:17 EDT\n\n\n\n\nRED HAT CONFIDENTIAL\n\n\n\n\n\n\n\n\n\nIt looks metadata-complete is always set to true when the version of web.xml is 2.3 or 2.4 at the line 96 of web/src/main/java/org/jboss/as/web/deployment/WarMetaDataProcessor.java.\n\n\n\n\n\n\n\n\n\nThough Servlet 2.3/2.3 specification does not have metadata-complete attribute, Servlet 3.0 specification states the following. I think it means that the metadata-complete attribute default to false if it is not specified.\n\n\n\n\n\n\n\n\n\n~~~\n\n\n\n\n8.1 Annotations and pluggability\n\n\n\n\nif the metadata-complete attribute is not specified or is set to \"false\", the\n\n\n\n\ndeployment tool must examine the class files of the application for annotations, and\n\n\n\n\nscan for web fragments.\n\n\n\n\n~~~\n\n\n\n\n\n\n\n\n\n * web/src/main/java/org/jboss/as/web/deployment/WarMetaDataProcessor.java\n\n\n\n\n\n\n\n\n\n 76 public class WarMetaDataProcessor implements DeploymentUnitProcessor {\n\n\n\n\n 77 \n\n\n\n\n 78     @Override\n\n\n\n\n 79     public void deploy(DeploymentPhaseContext phaseContext) throws DeploymentUnitProcessingException {\n\n\n\n\n...\n\n\n\n\n 87         boolean isComplete = false;\n\n\n\n\n 88         WebMetaData specMetaData = warMetaData.getWebMetaData();\n\n\n\n\n 89         if (specMetaData != null) {\n\n\n\n\n 90             if (specMetaData instanceof Web25MetaData) {\n\n\n\n\n 91                 isComplete |= ((Web25MetaData) specMetaData).isMetadataComplete();\n\n\n\n\n 92             } else if (specMetaData instanceof Web30MetaData) {\n\n\n\n\n 93                 isComplete |= ((Web30MetaData) specMetaData).isMetadataComplete();\n\n\n\n\n 94             } else {\n\n\n\n\n 95                 // Any web.xml 2.4 or earlier deployment is metadata complete\n\n\n\n\n 96                 isComplete = true;\n\n\n\n\n 97             }\n\n\n\n\n 98         }\n\n\n\n\n 99\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha4", "fixed_version": "10.0.0.Beta2", "fixed_files": ["org.wildfly.extension.undertow.deployment.WarMetaDataProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 5014, "bug_title": "jms-bridge source and target context properties can not be parsed", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.Beta2", "fixed_files": ["org.wildfly.extension.messaging.activemq.jms.bridge.JMSBridgeDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5085, "bug_title": "[Migration operation] If connector has set factory-class org.hornetq.core.remoting.impl.netty.NettyConnectorFactory then migration operation does not translate it to Artemis equivalent", "bug_description": "We should migrate configuration like:\n\n\n\n\n\n\n<connector name=\"myconnector\">\n\n\n\n\n...\n\n\n\n\n                <factory-class>org.hornetq.core.remoting.impl.netty.NettyConnectorFactory</factory-class>\n\n\n\n\n            </connector>\n\n\n\n\n\n\nto:\n\n\n\n\n\n\n                <connector name=\"myconnector\" factory-class=\"org.apache.activemq.artemis.core.remoting.impl.netty.NettyConnector\">\n\n\n\n\n...\n\n\n\n\n\n\nand not to:\n\n\n\n\n\n\n                          <connector name=\"myconnector\" factory-class=\"org.hornetq.core.remoting.impl.netty.NettyConnectorFactory\">\n\n\n\n\n...\n\n\n\n\n\n\nThe same holds for InVMConnector.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.Beta2", "fixed_files": ["org.jboss.as.messaging.MessagingXMLWriter.java", "org.jboss.as.messaging.MigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5088, "bug_title": "[Migration operation] If acceptor has set factory-class org.hornetq.core.remoting.impl.netty.NettyAcceptorFactory then migration operation does not translate it to Artemis equivalent", "bug_description": "This is the same problem as reported with connectors in JBEAP-638.\norg.hornetq.core.remoting.impl.netty.NettyAcceptorFactory should be migrated to equivalent org.apache.activemq.artemis.core.remoting.impl.netty.NettyAcceptorFactory.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.Beta2", "fixed_files": ["org.jboss.as.messaging.MessagingXMLWriter.java", "org.jboss.as.messaging.MigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5105, "bug_title": "[Migration operation] Attribute discovery-group in cluster-connection is not migrated", "bug_description": "Attribute discovery-group-ref in cluster-connection is not migrated. For example:\n\n\n\n\n\n\n            <cluster-connection name=\"cc3\">\n\n\n\n\n                <address>cc3-address</address>\n\n\n\n\n                <connector-ref>netty</connector-ref>\n\n\n\n\n                <discovery-group-ref discovery-group-name=\"groupC\"/>\n\n\n\n\n            </cluster-connection>\n\n\n\n\n\n\nmigrates as:\n\n\n\n\n\n\n<cluster-connection name=\"cc3\" connector-name=\"netty\" address=\"cc3-address\"/>\n\n\n\n\n\n\nI&apos;m setting higher priority as discovery group is by default in configuration in EAP 6.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta1", "fixed_version": "10.0.0.Beta2", "fixed_files": ["org.jboss.as.messaging.MigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5192, "bug_title": "XTSSubsystemDefinition says HOST attribute does not allow null, but it should", "bug_description": "The xsd for the xts subsystem says the \"host\" element is not required, and the parser behaves accordingly, but the HOST attribute in XTSSubsystemDefinition says the attribute doesn&apos;t allow null, while simultaneously configuring a default value for it.\nSetting a default value for an attribute is pointless if it doesn&apos;t allow null; the default value is what the runtime services will use if the persistent config value is null.\nThis situation prevents booting of legacy xml configs using schema versions that predate the \"host element. (Specifically, EAP 6 configs.) The boot validates the entire config to ensure that required attributes are configured, and that validation fails. Booting configs that conform to the current schema would fail too if \"host\" was not present.\nThis should be a simple one line change.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.xts.XTSSubsystemDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5200, "bug_title": "Reading transport protocol metrics fails with \"Protocol UDP not found in current stack\"", "bug_description": "\n\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=jgroups/channel=ee/protocol=UDP:read-attribute(name=timer-queue_max_size\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"WFLYCLJG0019: Protocol UDP not found in current stack\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.clustering.jgroups.subsystem.ForkProtocolResourceRegistrationHandler.java", "org.jboss.as.clustering.jgroups.subsystem.ProtocolResourceRegistrationHandler.java"], "label": 1, "es_results": []}, {"bug_id": 5203, "bug_title": "mod_cluster read-resource can result in NPE if service is not started yet", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.filters.ModClusterResource.java"], "label": 1, "es_results": []}, {"bug_id": 5215, "bug_title": "[Migration operation] [Web to Undertow] Scheme attribute of ajp connector is not migrated", "bug_description": "Scheme attribute of AJP connector is not migrated.\nWeb AJP configuration\n\n\n\n\n\n\n<connector name=\"ajp\" protocol=\"AJP/1.3\" scheme=\"http\" socket-binding=\"ajp\"/>\n\n\n\n\n\n\nshould be migrated to\n\n\n\n\n\n\n<ajp-listener name=\"ajp\" socket-binding=\"ajp\" scheme=\"http\"/>\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5086, "bug_title": "[Migration operation] HA configuration is not migrated", "bug_description": "HA configuration is not migrated.\nFor example:\n\n\n\n\n\n\n                <shared-store>true</shared-store>\n\n\n\n\n\n\ndoes not have equivalent config in in migrated configuration.\nCustomer with HA configuration for HornetQ will not have this configuration after migration.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.messaging.test.MigrateTestCase.java", "org.jboss.as.messaging.logging.MessagingLogger.java", "org.jboss.as.messaging.MigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5143, "bug_title": "JGroups subsystem parser should not allow thread pool to be defined per protocol", "bug_description": "In this case, the parser does not match the schemas.  There are 3 issues here:\n\nThread pool elements should only be parsed for schema version >= 3.0\nThread pool elements are only valid children of a <transport/> element, but are currently accepted as children of a <protocol/> element.\nWe should always create thread pool resources, even if xml is undefined - that way the thread pool parameters, as applied to the runtime, are expressed in the model.\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta1", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.clustering.jgroups.subsystem.JGroupsSubsystemXMLReader.java", "org.jboss.as.clustering.jgroups.subsystem.SubsystemParsingTestCase.java", "org.jboss.as.clustering.jgroups.subsystem.ThreadPoolResourceDefinition.java", "org.jboss.as.clustering.jgroups.subsystem.JGroupsSubsystemXMLWriter.java"], "label": 1, "es_results": []}, {"bug_id": 5204, "bug_title": "Setting mod_cluster advertise frequency to zero does not disable advertise", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.filters.ModClusterService.java"], "label": 1, "es_results": []}, {"bug_id": 5084, "bug_title": "[Migration operation] group-address/group-port/local-bind-address in discovery-group are not migrated", "bug_description": "During migration of discovery group with local-bind-address, group-address and group-port, those parameters are not migrated properly:\nFor example HornetQ configuration:\n\n\n\n\n\n\n<discovery-group name=\"groupC\">\n\n\n\n\n                <local-bind-address>localhost</local-bind-address>\n\n\n\n\n                <group-address>224.0.1.105</group-address>\n\n\n\n\n                <group-port>45678</group-port>\n\n\n\n\n                <refresh-timeout>${refresh.timeout:3500}</refresh-timeout>\n\n\n\n\n                <initial-wait-timeout>${initial.wait.timeout:7500}</initial-wait-timeout>\n\n\n\n\n            </discovery-group>\n\n\n\n\n\n\nis migrated to Artemis like:\n\n\n\n\n\n\n                <discovery-group name=\"groupC\" initial-wait-timeout=\"${initial.wait.timeout:7500}\" refresh-timeout=\"${refresh.timeout:3500}\"/>\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.messaging.test.MigrateTestCase.java", "org.jboss.as.messaging.logging.MessagingLogger.java", "org.jboss.as.messaging.MigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5188, "bug_title": "DistributedWorkManager needs to handle unknown fork responses.", "bug_description": "The JGroupsTransport employed by the DistributedWorkManager uses synchronous multicasting via the RpcDispatcher.  Since the JCA default configuration was modified to use fork channels, we need to ensure that it handles an exception case specific for fork channels, i.e. the case where a message is received by a node on which no such DWM exists.\nAs I see it, there are 2 ways we can fix this:\n\nConfigure the RpcDispatcher with a custom response marshaller capable of recognizing unknown fork responses\nImplement a transport that leverages CommandDispatcher, which already handles this exception case.\n\n#1 is the easiest.  The only hiccup is that the RpcDispatcher field in JGroupsTransport is private, which requires reflection to access from a subclass.\n#2 is probably the ideal long term solution.  The DistributedWorkManager already employs a command pattern, so using CommandDispatcher is a natural fit.  Using the CommandDispatcher will also simplifies marshalling/unmarshalling of the transport parameters.  Additionally, using the public clustering API allows us to remove the direct dependency on org.jgroups module from the connector subsystems.  The only hiccup here is that in order to optimize the marshalling of the command objects, requires the use of the marshalling API introduced as part of WFLY-5091, which, at the time of this writing, has not yet been merged into WF master.\nGiven the above, I suggest a 2 phase solution, where we implement #1 for now, and #2 when the missing pieces are in place.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.connector.subsystems.jca.DistributedWorkManagerAdd.java", "org.jboss.as.connector.services.workmanager.DistributedWorkManagerService.java"], "label": 1, "es_results": []}, {"bug_id": 5231, "bug_title": "[Migration operation] [Web to Undertow] Web - access-log and its directory attributes are not migrated", "bug_description": "When migrating access-log via :migrate and access-log contains directory definition, the properties relative-to and path are not migrated.\nWeb subsystem snippet:\n\n\n\n\n\n\n<subsystem xmlns=\"urn:jboss:domain:web:2.2\" default-virtual-server=\"default\" native=\"false\">\n\n\n\n\n    <virtual-server name=\"default\" enable-welcome-root=\"true\">\n\n\n\n\n        <alias name=\"localhost\"/>\n\n\n\n\n        <alias name=\"example.com\"/>\n\n\n\n\n        <access-log resolve-hosts=\"true\" prefix=\"test\" rotate=\"false\">\n\n\n\n\n            <directory relative-to=\"jboss.server.log.dir\" path=\"testvs/vs\"/>\n\n\n\n\n        </access-log>\n\n\n\n\n    </virtual-server>\n\n\n\n\n</subsystem>\n\n\n\n\n\n\naccess log part expected to be migrated as \n\n\n\n\n\n\n<access-log rotate=\"false\" prefix=\"test\" directory=\"testvs/vs\" relative-to=\"jboss.server.log.dir\" />\n\n\n\n\n\n\ninstead it is migrated without the directory and relative-to attributes:\n<access-log rotate=\"false\" prefix=\"test\"/>\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.web.test.WebMigrateTestCase.java", "org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5199, "bug_title": "On MariaDB 5.3+ and MySQL 5.6.4+, EJB timers in a JDBC storage do not work correctly due to timestamp rounding", "bug_description": "EJB timers don&apos;t execute, because the DatabaseTimerPersistence.shouldRun method returns false for them, because it is unable to SELECT them from the database using a java.sql.Timestamp.\nOn MariaDB 5.3+ and MySQL 5.6.4+, the behavior of the DATETIME type has changed compared to MySQL 5.5 and older.\nIn previous versions, it was possible to insert into DATETIME columns with JDBC using a java.sql.Timestamp which contained fractional seconds, the fraction was truncated/rounded and a subsequent SELECT statement with the same java.sql.Timestamp returned such rows, because the fraction was truncated/rounded from the queried Timestamp too.\nOn MySQL 5.6.4+ and MariaDB 5.3+, when a java.sql.Timestamp including a fractional second is inserted into a DATETIME, attempting to SELECT with the same Timestamp doesn&apos;t return the row, because the DATETIME type now defaults to DATETIME(0) which truncates/rounds to whole seconds, and the queried Timestamp no longer gets truncated/rounded during the query execution. It would only work if the column was declared as DATETIME(6), which ensures that inserted values don&apos;t get truncated/rounded. Documentation: https://dev.mysql.com/doc/refman/5.7/en/fractional-seconds.html\nMySQL rounds the timestamp, MariaDB truncates it (always rounds down).\nHowever, declaring DATETIME(6) is not possible in older versions of MySQL or MariaDB, so to support both new and old versions, we have probably these options:\n1. introduce a new DDL file(s) for MySQL 5.6.4+ and MariaDB 5.3+ and use it depending on the detected version - this DDL would use DATETIME(6) instead of DATETIME\n2. change the DatabaseTimerPersistence implementation so that it will not insert fractional seconds into the database at all (EJB timers don&apos;t support timing with higher precision than whole seconds anyway)\n3. same as option 2, but only for MariaDB/MySQL dialects \n4. any other idea?\nI personally like number 3 the best, it is the least risky and introduces only minimal changes.. but it&apos;s still somewhat ugly.\nThis seems to resolve it for me (implementation suggestion of option 3): https://github.com/jmartisk/wildfly/commits/mysql-mariadb-timer-suggestion", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.ejb3.timerservice.persistence.database.DatabaseTimerPersistence.java"], "label": 1, "es_results": []}, {"bug_id": 5283, "bug_title": "[Migration operation] [Web to Undertow] Connector's protocol names via FQCN are not recognized as migratable", "bug_description": "In Web subsystem there is possible to define protocol either via its API name (e.g. HTTP/1.1, where it is taken default implementation of given API) or via FQCN.\nIn case of HTTP/1.1 there are several implementations:\nJIO => org.apache.coyote.http11.Http11Protocol - default protocol\nNIO2 => org.apache.coyote.http11.Http11NioProtocol - required to be used to be able to use WebSockets\nAPR (default with natives) => org.apache.coyote.http11.Http11AprProtocol\nThe :migrate operation should also recognize these FQCN as valid HTTP/HTTPS protocols and migrate them correctly.\nNote: in case of AJP there are these FQCN:\norg.apache.coyote.ajp.AjpAprProtocol - AJP with natives enabled\norg.apache.coyote.ajp.AjpProtocol AJP without natives", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5280, "bug_title": "Connector attribute max-save-post-size is neither migrated nor migration writing is shown", "bug_description": "When migrating http connector, which has defined attribute max-save-post-size no warning that it is not possible to migrate the max-save-post-size is printed.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.ListenerResourceDefinition.java", "org.wildfly.extension.undertow.Constants.java", "org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5263, "bug_title": "MBeanServer returns MBean names that do not match filter", "bug_description": "This code\n\n\n\n\n\n\n            MBeanServer server = ManagementFactory.getPlatformMBeanServer();\n\n\n\n\n            for (ObjectName oname : server.queryNames(new ObjectName(\"*:type=context,*\"), null)) {\n\n\n\n\n                System.out.println(oname);\n\n\n\n\n            }\n\n\n\n\n\n\ngives \n\n\n\n\n\n\n16:51:25,842 INFO  [stdout] (pool-3-thread-1) org.apache.camel:context=swagger-test,type=context,name=\"swagger-test\"\n\n\n\n\n16:51:25,842 INFO  [stdout] (pool-3-thread-1) jboss.jsr77:j2eeType=J2EEServer,name=default\n\n\n\n\n16:51:25,843 INFO  [stdout] (pool-3-thread-1) jboss.jsr77:j2eeType=JVM,name=default,J2EEServer=default\n\n\n\n\n16:51:25,843 INFO  [stdout] (pool-3-thread-1) jboss.jsr77:j2eeType=J2EEDomain,name=jboss.jsr77\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.jsr77.managedobject.ManagedObjectHandlerRegistry.java"], "label": 1, "es_results": []}, {"bug_id": 5078, "bug_title": "Transaction subsystem attribute 'hornetq-store-enable-async-io' should be renamed for journal", "bug_description": "If hornetq/artemismq journal should be used for saving txn log then transaction subsystem defines if async io libraries (if available) should be used. By default the native libraries are not used and user needs to switch for it by setting it in xml or via cli.\n\n\n\n\n\n\n/subsystem=transactions:write-attribute(name=hornetq-store-enable-async-io, value=true)\n\n\n\n\n\n\nFor EAP7 the hornetq is going to be replaced with ActiveMQ Artemis and so artemis object store will be used instead. The attribute name should be renamed appropriately.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta1", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.txn.subsystem.TransactionSubsystemRootResourceDefinition.java", "org.jboss.as.txn.subsystem.TransactionSubsystemAdd.java", "org.jboss.as.txn.subsystem.TransactionSubsystem30Parser.java", "org.jboss.as.txn.TransactionSubsystemTestCase.java", "org.jboss.as.txn.subsystem.TransactionSubsystemXMLPersister.java", "org.jboss.as.txn.logging.TransactionLogger.java", "org.jboss.as.txn.subsystem.TransactionExtension.java", "org.jboss.as.txn.subsystem.Element.java", "org.jboss.as.txn.subsystem.TransactionSubsystem13Parser.java", "org.jboss.as.txn.subsystem.TransactionSubsystem15Parser.java", "org.jboss.as.txn.subsystem.CommonAttributes.java", "org.jboss.as.test.integration.domain.ExpressionSupportSmokeTestCase.java", "org.jboss.as.txn.subsystem.TransactionSubsystem12Parser.java", "org.jboss.as.txn.service.ArjunaObjectStoreEnvironmentService.java", "org.jboss.as.txn.subsystem.TransactionSubsystem14Parser.java"], "label": 1, "es_results": []}, {"bug_id": 5253, "bug_title": "[Migration operation] [Web to Undertow] Protocol attribute in ssl configuration of https connector is not properly migrated", "bug_description": "In Web protocol attribute of https ssl configuration is used for defining ssl protocols such as TLSv1.2. This attribute isn&apos;t properly migrated. Migrate operation defines enabled-protocols in https-listener based on Web&apos;s ssl-protocol which is incorrect as ssl-protocol in Web stands for name of custom ssl protocol provider.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5242, "bug_title": "Inconsistent format for IPv6 addresses in server log", "bug_description": "Description of problem:\nWhen IPv6 is used, square brackets for IPv6 addresses are missed in some of log entries. Specifically, the address format from Undertow logs is different from those \"WFLYSRV\" logs.\nHow reproducible:\nAlways\nSteps to Reproduce:\n1. Config IPv6 (example: https://docs.jboss.org/author/display/WFLY10/Interfaces+and+ports)\n2. Start WildFly and check the log\nActual results:\n----------------------------------------\n2015-08-31 12:51:47,812 INFO  [org.wildfly.extension.undertow] (MSC service thread 1-4) WFLYUT0006: Undertow HTTP listener default listening on /0:0:0:0:0:0:0:1:8080\n......\n2015-08-31 12:51:48,431 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0060: Http management interface listening on http://[::1]:9993/management\n2015-08-31 12:51:48,432 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0051: Admin console listening on http://[::1]:9993\n----------------------------------------\nIn Undertow logs it&apos;s like \"/0:0:0:0:0:0:0:1:8080\" but in WildFly server logs \"http://[::1]:9993/management\"\nExpected results:\nConsistent format should be used for IPv6 address across different components and the address is enclosed in square brackets [ ].", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.HttpsListenerService.java", "org.wildfly.extension.undertow.AjpListenerService.java", "org.wildfly.extension.undertow.logging.UndertowLogger.java", "org.wildfly.extension.undertow.HttpListenerService.java"], "label": 1, "es_results": []}, {"bug_id": 5298, "bug_title": "JASPIC verifyResponse is not called if proactive authentication is not in use", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java", "org.wildfly.extension.undertow.security.jaspi.JASPIAuthenticationMechanism.java", "org.wildfly.extension.undertow.security.jaspi.modules.HTTPSchemeServerAuthModule.java"], "label": 1, "es_results": []}, {"bug_id": 5153, "bug_title": "IIOP migrate operation does not translate ior-settings", "bug_description": "Ior-settings is not migrated in current time despite the fact that their values seem to be valid for migration.\nIf I have JacORB configuration like\n\n\n\n\n\n\n<subsystem xmlns=\"urn:jboss:domain:jacorb:1.4\">\n\n\n\n\n    <orb socket-binding=\"jacorb\" ssl-socket-binding=\"jacorb-ssl\">\n\n\n\n\n        <initializers security=\"identity\" transactions=\"on\"/>\n\n\n\n\n    </orb>\n\n\n\n\n    <security client-requires=\"ServerAuth\" server-supports=\"ServerAuth\" server-requires=\"ServerAuth\"/>\n\n\n\n\n    <ior-settings>\n\n\n\n\n        <transport-config integrity=\"required\" confidentiality=\"supported\" trust-in-client=\"required\" trust-in-target=\"supported\" \"\n\n\n\n\n            detect-replay=\"required\" detect-misordering=\"required\"/>\n\n\n\n\n        <as-context auth-method=\"none\"/>\n\n\n\n\n        <sas-context caller-propagation=\"supported\"/>\n\n\n\n\n    </ior-settings>\n\n\n\n\n</subsystem>\n\n\n\n\n\n\nThe migration output will be \n\n\n\n\n\n\n        <subsystem xmlns=\"urn:jboss:domain:iiop-openjdk:1.0\">\n\n\n\n\n            <orb ssl-socket-binding=\"jacorb-ssl\" socket-binding=\"jacorb\"/>\n\n\n\n\n            <initializers transactions=\"full\" security=\"identity\"/>\n\n\n\n\n            <security server-requires=\"ServerAuth\" server-supports=\"ServerAuth\" client-requires=\"ServerAuth\"/>\n\n\n\n\n        </subsystem>\n\n\n\n\n\n\nbut I would rather expect output like\n\n\n\n\n\n\n<subsystem xmlns=\"urn:jboss:domain:iiop-openjdk:1.0\">\n\n\n\n\n    <orb ssl-socket-binding=\"jacorb-ssl\" socket-binding=\"jacorb\"/>\n\n\n\n\n    <initializers transactions=\"full\" security=\"identity\"/>\n\n\n\n\n    <security server-requires=\"ServerAuth\" server-supports=\"ServerAuth\" client-requires=\"ServerAuth\" client-supports=\"ServerAuth\"/>\n\n\n\n\n    <transport-config detect-misordering=\"required\" detect-replay=\"required\" trust-in-client=\"required\" trust-in-target=\"supported\" confidentiality=\"supported\" integrity=\"required\"/>\n\n\n\n\n    <as-context auth-method=\"none\"/>\n\n\n\n\n</subsystem>\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta1", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.jacorb.TransformUtils.java", "org.jboss.as.jacorb.JacORBMigrateTestCase.java", "org.jboss.as.jacorb.JacORBSubsystemAdd.java"], "label": 1, "es_results": []}, {"bug_id": 5340, "bug_title": "Unable to specify module when specifying custom JACC policy class.", "bug_description": "It is currently possible to specify the &apos;javax.security.jacc.policy.provider&apos; system property, however it is not possible to specify a module.\nFrom the JACC specification: -\n_For each JRE of a J2EE 1.4 or later version Java EE application server, if the \nsystem property \njavax.security.jacc.policy.provider\n is defined, \nthe application server must construct an \ninstance of the class identified by the \nsystem property, confirm that the \nresulting object is an instance of \njava.security.Policy, \nand set, by calling the \njava.security.Policy.setPolicy\n method, the resulting object as the \ncorresponding Policy object you\nsed by the JRE. _\nThe specification only specifies that the system property identifies the class, it does not specify how.  \nIn it&apos;s simplest form we should assume this is just a class name, in a more complex form we should allow the module to be specified.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.security.service.SecurityActions.java", "org.jboss.as.security.service.SecurityBootstrapService.java", "org.jboss.as.security.service.JaccService.java"], "label": 1, "es_results": []}, {"bug_id": 5145, "bug_title": "Jacorb subsystem does not contain operation \"describe-migration\"", "bug_description": "As part of the migrate functionality for moving from JacORB to IIOP OpenJDK the old subsystem should contain operation describe-migration\n\n\n\n\n\n\n/subsystem=jacorb:describe-migration()\n\n\n\n\n\n\nfor user gets information about following steps.\nBut JacORB subsystem does not contain any such operation\n\n\n\n\n\n\n/subsystem=jacorb:read-operation-names()\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [\n\n\n\n\n        \"add\",\n\n\n\n\n        \"list-add\",\n\n\n\n\n        \"list-clear\",\n\n\n\n\n        \"list-get\",\n\n\n\n\n        \"list-remove\",\n\n\n\n\n        \"map-clear\",\n\n\n\n\n        \"map-get\",\n\n\n\n\n        \"map-put\",\n\n\n\n\n        \"map-remove\",\n\n\n\n\n        \"migrate\",\n\n\n\n\n        \"query\",\n\n\n\n\n        \"read-attribute\",\n\n\n\n\n        \"read-attribute-group\",\n\n\n\n\n        \"read-attribute-group-names\",\n\n\n\n\n        \"read-children-names\",\n\n\n\n\n        \"read-children-resources\",\n\n\n\n\n        \"read-children-types\",\n\n\n\n\n        \"read-operation-description\",\n\n\n\n\n        \"read-operation-names\",\n\n\n\n\n        \"read-resource\",\n\n\n\n\n        \"read-resource-description\",\n\n\n\n\n        \"remove\",\n\n\n\n\n        \"undefine-attribute\",\n\n\n\n\n        \"whoami\",\n\n\n\n\n        \"write-attribute\"\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta1", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.jacorb.MigrateOperation.java", "org.jboss.as.jacorb.TransformUtils.java", "org.jboss.as.jacorb.JacORBSubsystemAdd.java", "org.jboss.as.jacorb.TransformUtilsTestCase.java", "org.jboss.as.jacorb.logging.JacORBLogger.java", "org.jboss.as.jacorb.JacORBMigrateTestCase.java", "org.jboss.as.jacorb.JacORBSubsystemConstants.java"], "label": 1, "es_results": []}, {"bug_id": 5323, "bug_title": "Undertow's session-id-length setting is ignored in clustered configurations ", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.wildfly.clustering.web.undertow.sso.DistributableSingleSignOnManagerFactory.java", "org.wildfly.clustering.web.undertow.IdentifierFactoryAdapterTestCase.java", "org.wildfly.clustering.web.undertow.session.DistributableSessionManagerFactory.java", "org.wildfly.clustering.web.undertow.IdentifierFactoryAdapter.java"], "label": 1, "es_results": []}, {"bug_id": 5363, "bug_title": "[Migration operation] [Web to Undertow] Default value for access-log extended attribute differs", "bug_description": "When migrating access-log without defined extended attribute results in undertow without defined extended attribute, but the default values differ causing that even though in Web subsystem extended format wasn&apos;t used, in Undertow it is expected logging to use extended format.\nIdeally the defaults should be the same or the migrate operation needs to define the extended attribute to false if it wasn&apos;t defined in Web.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR1", "fixed_version": "10.0.0.CR2", "fixed_files": ["org.wildfly.extension.undertow.AccessLogDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5236, "bug_title": "[Migration operation] [Web to Undertow] SSL configuration - verify client attribute value is not properly migrated", "bug_description": "In web there exists different options for verify-client attribute of ssl configuration [1] than values which are allowed to be defined as part of https-listener (REQUIRED, REQUESTED, NOT_REQUESTED).\nCurrently the migration operation fails as the value isn&apos;t converted to equivalent value accepted by Undertow.\n[1]\n\n\n\n\n\n\n <xs:attribute name=\"verify-client\" default=\"none\">\n\n\n\n\n            <xs:annotation>\n\n\n\n\n                <xs:documentation>\n\n\n\n\n                    that is OpenSSL SSLVerifyClient (optional,require,optionalNoCA,none) and clientAuth (true=require/false=none)\n\n\n\n\n                </xs:documentation>\n\n\n\n\n            </xs:annotation>\n\n\n\n\n        </xs:attribute>\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR2", "fixed_files": ["org.jboss.as.web.WebMigrateOperation.java", "org.jboss.as.web.WebLogger.java", "org.jboss.as.web.test.WebMigrateTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 5359, "bug_title": "[Migration operation] [Web to Undertow] Incorectly printed warning for unable to migrate resource in case of migrating ssl configuration", "bug_description": "When migrating https connector with SSL configuration, the SSL configuration is migrated as part of the https connector migration. Still there is migration warning that :migrate operation isn&apos;t able to migrate the ssl configuration even though it was successfully migrated.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR1", "fixed_version": "10.0.0.CR2", "fixed_files": ["org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5355, "bug_title": "CacheServiceProviderRegistry close() not entirely thread-safe", "bug_description": "CacheServiceProviderRegistry.close() first does a cache lookup of the nodes providing a service, then attempts to modify the resulting set.  However, if another node either creates or removes a new service provider registration for the same service, the resulting set of nodes can be inconsistent.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR2", "fixed_files": ["org.wildfly.clustering.server.provider.CacheServiceProviderRegistry.java"], "label": 1, "es_results": []}, {"bug_id": 5354, "bug_title": "CacheServiceProviderRegistry creates unnecessary tx on new member join", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.CR2", "fixed_files": ["org.wildfly.clustering.server.provider.CacheServiceProviderRegistry.java"], "label": 1, "es_results": []}, {"bug_id": 5372, "bug_title": "Infinispan's jdbc store creates incorrect service name for datasource dependency", "bug_description": "fails with\n23:36:38,116 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (\"deploy\") failed - address: ([(\"deployment\" => \"clusterbench-ee7.ear\")]) - failure description: {\"WFLYCTL0288: One or more services were unable to start due to one or more indirect dependencies not being available.\" => {\n    \"Services that were unable to start:\" => [\n        \"jboss.clustering.web.\\\"clusterbench-ee7.ear.clusterbench-ee7-web-default.war\\\"\",\n        \"jboss.clustering.web.\\\"clusterbench-ee7.ear.clusterbench-ee7-web-passivating.war\\\"\",\n        \"jboss.clustering.web.locator.\\\"clusterbench-ee7.ear.clusterbench-ee7-web-default.war\\\"\",\n        \"jboss.clustering.web.locator.\\\"clusterbench-ee7.ear.clusterbench-ee7-web-passivating.war\\\"\",\n        \"jboss.deployment.subunit.\\\"clusterbench-ee7.ear\\\".\\\"clusterbench-ee7-web-default.war\\\".deploymentCompleteService\",\n        \"jboss.deployment.subunit.\\\"clusterbench-ee7.ear\\\".\\\"clusterbench-ee7-web-passivating.war\\\".deploymentCompleteService\",\n        \"jboss.deployment.unit.\\\"clusterbench-ee7.ear\\\".deploymentCompleteService\",\n        \"jboss.infinispan.web.\\\"clusterbench-ee7.ear.clusterbench-ee7-web-default.war\\\"\",\n        \"jboss.infinispan.web.\\\"clusterbench-ee7.ear.clusterbench-ee7-web-default.war\\\".config\",\n        \"jboss.infinispan.web.\\\"clusterbench-ee7.ear.clusterbench-ee7-web-passivating.war\\\"\",\n        \"jboss.infinispan.web.\\\"clusterbench-ee7.ear.clusterbench-ee7-web-passivating.war\\\".config\",\n        \"jboss.undertow.deployment.default-server.default-host./clusterbench\",\n        \"jboss.undertow.deployment.default-server.default-host./clusterbench.UndertowDeploymentInfoService\",\n        \"jboss.undertow.deployment.default-server.default-host./clusterbench.codec\",\n        \"jboss.undertow.deployment.default-server.default-host./clusterbench.session\",\n        \"jboss.undertow.deployment.default-server.default-host./clusterbench-passivating\",\n        \"jboss.undertow.deployment.default-server.default-host./clusterbench-passivating.UndertowDeploymentInfoService\",\n        \"jboss.undertow.deployment.default-server.default-host./clusterbench-passivating.codec\",\n        \"jboss.undertow.deployment.default-server.default-host./clusterbench-passivating.session\"\n    ],\n    \"Services that may be the because:\" => [\"jboss.data-source.java:jboss/datasources/ExampleDS\"]\n}}\n23:36:38,119 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (\"add\") failed - address: ([\n    (\"subsystem\" => \"infinispan\"),\n    (\"cache-container\" => \"web\")\n]) - failure description: {\"WFLYCTL0288: One or more services were unable to start due to one or more indirect dependencies not being available.\" => \n{\n\n    \"Services that were unable to start:\" => [\n\n        \"jboss.clustering.registry.web.default\",\n\n        \"jboss.infinispan.web.default.config\"\n\n    ],\n\n    \"Services that may be the because:\" => [\"jboss.data-source.java:jboss/datasources/ExampleDS\"]\n\n}\n}", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR1", "fixed_version": "10.0.0.CR2", "fixed_files": ["org.jboss.as.clustering.jgroups.subsystem.JGroupsSubsystemInitialization.java", "org.jboss.as.clustering.controller.RequiredCapability.java", "org.jboss.as.clustering.infinispan.subsystem.MixedKeyedJDBCStoreResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.XMLAttribute.java", "org.jboss.as.clustering.infinispan.subsystem.InfinispanSubsystemXMLReader.java", "org.jboss.as.clustering.infinispan.InfinispanLogger.java", "org.jboss.as.clustering.infinispan.subsystem.BinaryKeyedJDBCStoreResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.SubsystemParsingTestCase.java", "org.jboss.as.clustering.infinispan.subsystem.OperationsTestCase.java", "org.jboss.as.clustering.infinispan.subsystem.JDBCStoreBuilder.java", "org.jboss.as.clustering.infinispan.subsystem.StringKeyedJDBCStoreResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.JDBCStoreResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.OperationTestCaseBase.java"], "label": 1, "es_results": []}, {"bug_id": 5384, "bug_title": "Validate Artemis parameters ", "bug_description": "Artemis changed the naming convention to use CamelCase for its acceptor and connector parameters keys.\nValidation of the parameters was discarded when the messaging-activemq subsystem was created.\nThis means that the current template for the messaging-activemq subsystem is not correct (the parameters will not be taken into account by Artemis).\nThe server-id parameter for in-vm connector has also be renamed to serverId. ", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR1", "fixed_version": "10.0.0.CR2", "fixed_files": ["org.wildfly.extension.messaging.activemq.HTTPUpgradeService.java", "org.wildfly.extension.messaging.activemq.MessagingSubsystemParser_1_0.java", "org.wildfly.extension.messaging.activemq.HTTPConnectorDefinition.java", "org.jboss.as.messaging.MigrateOperation.java", "org.wildfly.extension.messaging.activemq.TransportConfigOperationHandlers.java"], "label": 1, "es_results": []}, {"bug_id": 5391, "bug_title": "Access logging does not recognize common pattern", "bug_description": "When having defined default access logging (just changing extended attribute to false), instead of logging according to common pattern (the default pattern), only the word \"common\" is logged per each request.\nMarking as critical as this is behaviour with default access-log configuration.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR1", "fixed_version": "10.0.0.CR2", "fixed_files": ["org.wildfly.extension.undertow.AccessLogService.java"], "label": 1, "es_results": []}, {"bug_id": 5404, "bug_title": "WF 10.0.0.CR2 with standalone.xml from WF 9 crashes on war deploy", "bug_description": "As I understand it Wildfly 10 wants to maintain configuration compatibility with Wildfly 9.\nIt looks lake some of the compatibility was broken with CR1 (worked with Betas). ", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR1", "fixed_version": "10.0.0.CR2", "fixed_files": ["org.wildfly.extension.batch.BatchSubsystemDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5394, "bug_title": "Generic acceptor/connector is ignoring its socket-binding", "bug_description": "If netty acceptor is configured then port is not opened:\n\n\n\n\n\n\n<acceptor name=\"netty\" factory-class=\"org.apache.activemq.artemis.core.remoting.impl.netty.NettyAcceptorFactory\" socket-binding=\"messaging\"/>\n\n\n\n\n\n\nafter server is started. Setting higher priority because it&apos;s core functionality.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR1", "fixed_version": "10.0.0.CR2", "fixed_files": ["org.wildfly.extension.messaging.activemq.TransportConfigOperationHandlers.java", "org.wildfly.extension.messaging.activemq.GenericTransportDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5360, "bug_title": "[Migration operation] [Web to Undertow] Migrating https connector in domain fails", "bug_description": "When trying to migrate https connector in domain, it fails during creation of security realm, as the operation assumes that security realms are set in domain also under /core-service=management/ but they are set specifically for host => in case of host master it is /host=master/core-service=management/", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR1", "fixed_version": "10.0.0.CR2", "fixed_files": ["org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5433, "bug_title": "CommandDispatcher can throw InvalidClassException if command class is not available", "bug_description": "When CommandDispatcher is used by a deployment, the command class might not be available if the deployment is not deployed.  Normally, this is prevented by returning a NoSuchService response if the service is unknown, however, this happens after the command is unmarshalled.  This check should happen before we attempt to unmarshall the command, avoiding unnecessary InvalidClassException.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR4", "fixed_files": ["org.wildfly.clustering.server.dispatcher.ChannelCommandDispatcherFactory.java"], "label": 1, "es_results": []}, {"bug_id": 5461, "bug_title": "Getting \"Attribute 'enabled' in the resource at address ... is deprecated\" when creating a datasource", "bug_description": "Following message&apos;s are seen while adding datasource via Management console:\n~~~\nINFO  [org.jboss.as.controller.management-deprecated] (ServerService Thread Pool  25) JBAS014627: Attribute &apos;enabled&apos; in the resource at address &apos;/subsystem=datasources/xa-data-source=xyz&apos; is deprecated\n, and may be removed in future version. See the attribute description in the output of the read-resource-description operation to learn more about the deprecation.\n~~~", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR3", "fixed_files": ["org.jboss.as.connector.subsystems.datasources.Constants.java"], "label": 1, "es_results": []}, {"bug_id": 5502, "bug_title": "Do not require marshallable session attributes if the cache does not require it", "bug_description": "The distributed session manager implementation requires its session attributes to be marshallable.  However, if the cache is not clustered or persistent, this enforcement is unnecessary and puts unreasonable constraints on an application.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR3", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.fine.FineSessionAttributes.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSessionManagerFactory.java", "org.wildfly.clustering.web.infinispan.session.coarse.CoarseSessionAttributes.java", "org.wildfly.clustering.web.infinispan.session.coarse.CoarseSessionFactory.java", "org.wildfly.clustering.web.infinispan.session.fine.FineSessionFactory.java"], "label": 1, "es_results": []}, {"bug_id": 5503, "bug_title": "Invalidation cache should not trigger passivation/activation events per request", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR3", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.InfinispanSessionManager.java"], "label": 1, "es_results": []}, {"bug_id": 5526, "bug_title": "[Migration operation] Attribute forward-when-no-consumers is not migrated properly", "bug_description": "Attribute forward-when-no-consumers should be migrated to message-load-balancing-type in the following way:\nSTRICT is like setting the legacy forward-when-no-consumers parameter to true\nON_DEMAND is like setting the legacy forward-when-no-consumers parameter to false\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR3", "fixed_files": ["org.jboss.as.messaging.test.MigrateTestCase.java", "org.jboss.as.messaging.logging.MessagingLogger.java", "org.jboss.as.messaging.MigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5015, "bug_title": "RunAs in servlet does not work", "bug_description": "RunAs for servlets doesn&apos;t work in Undertow. \nI have unprotected @RunAs-annotated servlet which calls protected EJB method. The call should succeed, but it throws javax.ejb.EJBAccessException.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha6", "fixed_version": "10.0.0.CR3", "fixed_files": ["org.jboss.as.ejb3.component.EJBComponentDescription.java", "org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java", "org.wildfly.extension.undertow.deployment.UndertowDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 5513, "bug_title": "EAP7 missing jboss logging internationalization", "bug_description": "It is required for EAP7 to contain all features from EAP6.\nPer https://issues.jboss.org/browse/ANDIAMO-7, in EAP6 every serious log message (warn, error, fatal) should have a unique code that can be used to identify it.\nHowever, we found 160 serious log messages in EAP7.0.0.DR11 without id.\nList of serious log messages without id from a smoke test (link to Jenkins run will be provided when the automated test case is finished):\n\n\n\n\n\n\n        /jboss-eap-7.0-src/ejb3/src/main/java/org/jboss/as/ejb3/remote/protocol/versionone/VersionOneProtocolChannelReceiver.java:318 EjbLogger.REMOTE_LOGGER.warn(\"Could not send a cluster removal message for cluster: \" + registry.getGroup() + \" to the client on channel \" + channelAssociation.getChannel(), ioe);\n\n\n\n\n        /jboss-eap-7.0-src/jpa/eclipselink/src/main/java/org/jipijapa/eclipselink/JBossLogger.java:86 getLoggerForCategory(\"logging\").warnv(\"Received message for log level {0}, but no such level is defined in SessionLog! Logging at INFO level...\", level);\n\n\n\n\n        /jboss-eap-7.0-src/connector/src/main/java/org/jboss/as/connector/services/resourceadapters/deployment/AbstractResourceAdapterDeploymentService.java:178 DEPLOYMENT_CONNECTOR_LOGGER.error(\"Error during recovery shutdown\", e);\n\n\n\n\n        /jboss-eap-7.0-src/connector/src/main/java/org/jboss/as/connector/services/resourceadapters/deployment/AbstractResourceAdapterDeploymentService.java:199 DEPLOYMENT_CONNECTOR_LOGGER.warn(\"Exception during stopping resource adapter\", nfe);\n\n\n\n\n        /jboss-eap-7.0-src/connector/src/main/java/org/jboss/as/connector/subsystems/datasources/XaDataSourceService.java:64 ConnectorLogger.SUBSYSTEM_DATASOURCES_LOGGER.error(\"Error during recovery shutdown\", e);\n\n\n\n\n\n\nGiving blocker priority as this issue blocks RFE verification.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR4", "fixed_files": ["org.jboss.as.connector.services.resourceadapters.deployment.AbstractResourceAdapterDeploymentService.java", "org.jboss.as.ejb3.logging.EjbLogger.java", "org.jboss.as.ejb3.remote.protocol.versionone.VersionOneProtocolChannelReceiver.java", "org.jboss.as.connector.logging.ConnectorLogger.java", "org.jboss.as.connector.subsystems.datasources.XaDataSourceService.java"], "label": 1, "es_results": []}, {"bug_id": 5548, "bug_title": "[Migration operation] Attribute backup-group-name is not migrated", "bug_description": "If server is configured with HA policy for replicated journal and messaging subsystem contains attribute:\n\n\n\n\n\n\n        <backup-group-name>firstPair</backup-group-name>\n\n\n\n\n\n\nthen new messaging-activemq subsytem should contain something like:\n\n\n\n\n\n\n        <replication-master ... group-name=\"firstPair\" />\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR3", "fixed_version": "10.0.0.CR4", "fixed_files": ["org.jboss.as.connector.subsystems.datasources.JdbcDriverRemove.java", "org.jboss.as.connector.services.driver.registry.DriverRegistryImpl.java", "org.jboss.as.connector.subsystems.datasources.DataSourceModelNodeUtil.java", "org.jboss.as.connector.subsystems.datasources.ModifiableXaDataSource.java", "org.jboss.as.connector.subsystems.datasources.GetInstalledDriverOperationHandler.java", "org.jboss.as.connector.subsystems.datasources.AbstractDataSourceService.java", "org.jboss.as.connector.services.driver.InstalledDriver.java", "org.jboss.as.connector.deployers.ds.processors.DriverProcessor.java", "org.jboss.as.connector.services.driver.registry.DriverRegistry.java", "org.jboss.as.connector.subsystems.datasources.Constants.java", "org.jboss.as.connector.subsystems.datasources.XaDataSourceService.java", "org.jboss.as.connector.subsystems.datasources.ModifiableDataSource.java", "org.jboss.as.connector.deployers.datasource.DataSourceDefinitionInjectionSource.java", "org.jboss.as.connector.deployers.ds.processors.DsXmlDeploymentInstallProcessor.java", "org.jboss.as.connector.subsystems.datasources.LocalDataSourceService.java", "org.jboss.as.connector.subsystems.datasources.JdbcDriverAdd.java", "org.jboss.as.connector.subsystems.datasources.InstalledDriversListOperationHandler.java", "org.jboss.as.messaging.test.MigrateTestCase.java", "org.jboss.as.messaging.MigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5458, "bug_title": "jgroups-stack & jgroups-channel attributes should not allow expressions", "bug_description": "This attribute is a model reference, and therefore should not allow expressions.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR4", "fixed_files": ["org.wildfly.extension.messaging.activemq.CommonAttributes.java"], "label": 1, "es_results": []}, {"bug_id": 5079, "bug_title": "Removing non existent mail server with standard name (via CLI) does not fail even though it should", "bug_description": "Removing non-existent mail server (which is named smtp or pop3 or imap) via CLI operation doesn&apos;t fail even though it should.\n\n\n\n\n\n\n/subsystem=mail/mail-session=java\\:jboss\\/mail\\/test1439373303651:add(jndi-name=java\\:jboss\\/mail\\/test1439373303651)\n\n\n\n\n{\"outcome\" => \"success\"}\n\n\n\n\n\n\n\n\n\n /subsystem=mail/mail-session=java\\:jboss\\/mail\\/test1439373303651:read-children-names(child-type=server)\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => []\n\n\n\n\n}\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=mail/mail-session=java\\:jboss\\/mail\\/test1439373303651/server=smtp:remove\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"response-headers\" => {\n\n\n\n\n        \"operation-requires-reload\" => true,\n\n\n\n\n        \"process-state\" => \"reload-required\"\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nNote: trying to remove non-existent server named e.g. xxx correctly fails see\n\n\n\n\n\n\n/subsystem=mail/mail-session=java\\:jboss\\/mail\\/test1439373303651/server=xxx:remove\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"WFLYCTL0030: No resource definition is registered for address [\n\n\n\n\n    (\\\"subsystem\\\" => \\\"mail\\\"),\n\n\n\n\n    (\\\"mail-session\\\" => \\\"java:jboss/mail/test1439373303651\\\"),\n\n\n\n\n    (\\\"server\\\" => \\\"xxx\\\")\n\n\n\n\n]\",\n\n\n\n\n    \"rolled-back\" => true,\n\n\n\n\n    \"response-headers\" => {\"process-state\" => \"reload-required\"}\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta1", "fixed_version": "10.0.0.CR4", "fixed_files": ["org.jboss.as.mail.extension.MailServerDefinition.java", "org.jboss.as.mail.extension.MailSubsystem20TestCase.java"], "label": 1, "es_results": []}, {"bug_id": 5518, "bug_title": "Tests from XTS module fails with security manager", "bug_description": "Description of problem:\nTests from XTS module fails with security manager. BAParticipantCompletionTestCase fails on maven timeout [ERROR] There was a timeout or other error in the fork\nHow reproducible:\nAlways\nSteps to Reproduce:\n\n./integration-tests.sh -Dmaven.repo.local=$MAVEN_REPO_LOCAL -fae -Dmaven.test.failure.ignore=true -Dnode0=$MYTESTIP_1 -Dnode1=$MYTESTIP_2 -Dmcast=$MCAST_ADDR -Djboss.dist=$JBOSS_DIST -Dsecurity.manager -Dts.xts\n\nActual results:\nSee attached file\nExpected results:\nNo errors", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR4", "fixed_files": ["org.jboss.as.test.xts.wsat.client.ATTestCase.java", "org.jboss.as.test.xts.annotation.client.TransactionalTestCase.java", "org.jboss.as.test.xts.annotation.client.CompensatableTestCase.java", "org.jboss.as.test.xts.wsba.coordinatorcompletion.client.BACoordinatorCompletionTestCase.java", "org.jboss.as.test.xts.annotation.compensationScoped.CompensationScopedTestCase.java", "org.jboss.as.test.xts.wsba.participantcompletion.client.BAParticipantCompletionTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 5495, "bug_title": "Cannot configure ID/data/timestamp columns of JDBC-based cache stores", "bug_description": "When I&apos;m trying to configure a JDBC-based cache store for an \"offload\" Infinispan cache, configuration for the ID/data/timestamp columns is not applied. I found that this is the case by writing:\n\n\n\n\n\n\n<replicated-cache name=\"offload\" mode=\"SYNC\">\n\n\n\n\n    <transaction mode=\"BATCH\"/>\n\n\n\n\n    <binary-keyed-jdbc-store data-source=\"testDS\" passivation=\"false\" preload=\"true\" purge=\"false\" shared=\"true\">\n\n\n\n\n        <binary-keyed-table prefix=\"b\">\n\n\n\n\n            <id-column name=\"id\" type=\"VARCHAR(255)\"/>\n\n\n\n\n            <data-column name=\"datum\" type=\"VARBINARY(10000)\"/>\n\n\n\n\n            <timestamp-column name=\"ver\" type=\"BIGINT\"/>\n\n\n\n\n        </binary-keyed-table>\n\n\n\n\n    </binary-keyed-jdbc-store>\n\n\n\n\n</replicated-cache>\n\n\n\n\n\n\nand getting the following error:\n\n\n\n\n\n\n15:12:44,254 ERROR [org.infinispan.persistence.jdbc.TableManipulation] (ServerService Thread Pool -- 65) ISPN008011: Error while creating table; used DDL statement: &apos;CREATE TABLE `b_clusterbench_ee7_ear_clusterbench_ee7_web_offload_war`(id VARCHAR NOT NULL, datum BINARY, version BIGINT, PRIMARY KEY (id))&apos;: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;NOT NULL, datum BINARY, version BIGINT, PRIMARY KEY (id))&apos; at line 1\n\n\n\n\n\n\nClearly, the configuration isn&apos;t applied, because the SQL statement cited in the error message uses default column names and types, which are different from what was configured.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR4", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.TableBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 5455, "bug_title": "[Migration operation] [Web to Undertow] migration of access-log prefix attribute does not take into account default value resulting in incosistent result.", "bug_description": "Access log prefix in web subsystem is by default access-log., in Undertow subsystem it is access-log. Note the difference, there is \".\" at the end in case of Web.\nThere is inconsistency of migrate operation when migrating prefix attribute. When prefix is not explicitly defined in Web (=> default is used => access-log., note the dot at the end. It is migrated to default Undertow prefix, which is access-log (missing \".\" at the end). \nIn case of having explicitely set prefix=\"access-log.\", it is the same value as the default value in Web and in this case this is migrated to access-log. (the \".\" is there).\n=> two equivalent Web subsystem configuration of access-log result in two different configurations in Undertow, which is not expected behaviour.\nAs this impacts only access-log naming, I am considering this only as minor issue.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR4", "fixed_files": ["org.wildfly.extension.undertow.AccessLogDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5452, "bug_title": "Sometimes the calling javax.security.auth.login.Configuration.getConfiguration() fails with SecurityException in our tests", "bug_description": "Sometimes the calling javax.security.auth.login.Configuration.getConfiguration() fails with SecurityException in our tests.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR4", "fixed_files": ["org.jboss.as.test.integration.security.common.Utils.java"], "label": 1, "es_results": []}, {"bug_id": 5555, "bug_title": "JMS Bridge ambiguous error reporting on module load failure ", "bug_description": "If JMS bridge depends on module that for some reason cannot be loaded, log will show cryptic message:\n10:21:26,173 ERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool  51) WFLYCTL0013: Operation (\"add\") failed - address: ([\n    (\"subsystem\" => \"messaging-activemq\"),\n    (\"jms-bridge\" => \"a-to-c-bridge\")\n]) - failure description: \"org.hornetq:main\"\n1. Failure description does not describe a thing\n2. it points to HQ module, rather than custom module used in bridge conf.\nException is thrown at JMSBridgeAdd:155", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.extension.messaging.activemq.jms.bridge.JMSBridgeAdd.java", "org.wildfly.extension.messaging.activemq.logging.MessagingLogger.java"], "label": 1, "es_results": []}, {"bug_id": 5604, "bug_title": "Weld deployment services not cleaned up properly if a deployment fails", "bug_description": "The cleanup is currently only performed as a part of org.jboss.as.weld.WeldStartService.stop(StopContext) invocation. However, if WeldStartService.start() fails (e.g. because of a validation error) the stop method is never invoked. Some Weld bootstrap services need to clean up resources even if the deployment fails, e.g. org.jboss.weld.bootstrap.events.ContainerLifecycleEvents (deactivable optimization) maintains a separate thread pool and so the referenced ExecutorService is never shut down explicitly and the only hope to free resources is the GC and finalizers whose execution is deferred and may never even occur.\nWe&apos;ve run into this problem when executing Weld and CDI TCK test suites on a specific HP-UX machine. Both test suites contain a lot of scenarios where the deployment fails. HP-UX jvm cannot handle this load and the test suite fails with \"java.lang.OutOfMemoryError: unable to create new native thread\".", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.weld.deployment.processors.WeldDeploymentProcessor.java", "org.jboss.as.weld.WeldBootstrapService.java"], "label": 1, "es_results": []}, {"bug_id": 5605, "bug_title": "DataSourceDefinition is registering capabilities for deployment tree resources", "bug_description": "The same DataSourceDefinition class is used for registering the MRR for the subsystem=data-sources/(xa-)data-source=* resources and for their equivalents in the /deployment=* tree. In both cases the registerCapabilities() method is recording the datasource capability.\nThe deployment resources are not actually able to provide the capability[1], so it shouldn&apos;t be registered in that case. I believe the DataSourceDefinition.deployed field can be used to turn this off.\n[1] Capabilities are management model concepts and can&apos;t be provided by services and runtime-only resources. The /deployment=/subsystem= resources are runtime-only.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.connector.subsystems.datasources.DataSourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5594, "bug_title": "ISE when configuring web/ejb clustering with invalidation cache", "bug_description": "Both the web and ejb clustering modules use a key affinity service to generate session IDs for replication and distribution mode - however, they currently attempt to use a key affinity service with invalidation mode as well, which throws an ISE.  Neither LOCAL nor INVALIDATION caches should attempt to use a key affinity service.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.KeyAffinityServiceFactoryBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 5581, "bug_title": "Routing cache should always use REPL", "bug_description": "Currently, the cache used for routing information uses the same cache mode as the cache used for web sessions.  On a 4 node cluster, this results in an extra RPC for half of the requests.  The routing cache should always use REPL, if the web session cache is clustered, and should never use a persistent store.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.RouteRegistryEntryProviderBuilder.java", "org.wildfly.clustering.web.infinispan.ServiceLoaderTestCase.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSessionManagerFactoryBuilder.java", "org.wildfly.clustering.web.infinispan.session.InfinispanRouteLocatorBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 5591, "bug_title": "Client mappings cache should always use REPL", "bug_description": "Currently, the cache used for ejb client mappings uses the same cache mode as the cache used for SFSBs.  On a 4 node cluster, this results in an extra RPC for half of the requests.  The client mappings cache should always use REPL, if the SFSB cache is clustered, and should never use a persistent store.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.ejb3.remote.RegistryInstallerService.java", "org.wildfly.clustering.ejb.BeanManagerFactoryBuilderConfiguration.java", "org.jboss.as.ejb3.cache.distributable.DistributableCacheFactoryBuilderService.java", "org.wildfly.clustering.ejb.infinispan.InfinispanBeanManagerFactoryBuilder.java", "org.jboss.as.ejb3.remote.EJBRemotingConnectorClientMappingsEntryProviderService.java"], "label": 1, "es_results": []}, {"bug_id": 5595, "bug_title": "NPE during serialization of HttpSession metadata when using <transaction mode=\"NONE\"/>", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.SimpleSessionCreationMetaData.java"], "label": 1, "es_results": []}, {"bug_id": 5607, "bug_title": "EJB Server side is needlessly closing remoting channel", "bug_description": "When an EJB Bean throws a Runtime exception, it is causing the server side to close the remoting channel.  This causes several issues such as performance issue of having to recreate the channel, channel leak on the client side and some occasional EJBCLIENT...25 - no ejb receiver exceptions on the client side.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.ejb3.remote.protocol.versionone.MethodInvocationMessageHandler.java"], "label": 1, "es_results": []}, {"bug_id": 5449, "bug_title": "Custom socket factory for JGroups subsystem not set correctly", "bug_description": "Wildfly&apos;s JChannelFactory tries to set a custom socket factory on the JGroups transport.\nThis is not the correct API to use, and it gets overwritten when the JGroups channel starts.\nA custom socket factory should be set on the JChannel.\nThe only time the custom socket factory is currently used is if there&apos;s a race condition where two channels are started at the same time, and the custom factory is set just before the other channel uses it.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR4", "fixed_files": ["org.jboss.as.clustering.jgroups.JChannelFactory.java", "org.jboss.as.clustering.jgroups.ManagedSocketFactoryTest.java", "org.jboss.as.clustering.jgroups.ManagedSocketFactory.java"], "label": 1, "es_results": []}, {"bug_id": 5617, "bug_title": "JGroups thread pool properties are never applied", "bug_description": "Introduced by\nfc4c9b37391ac3eec51420b38b5f2a479d3a6a1e", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.clustering.jgroups.subsystem.TransportResourceDefinition.java", "org.jboss.as.clustering.jgroups.JChannelFactory.java", "org.jboss.as.clustering.jgroups.subsystem.AbstractProtocolConfigurationBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 5646, "bug_title": "SingletonServiceTestCase fails intermittently", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.test.clustering.cluster.singleton.SingletonServiceTestCase.java", "org.jboss.as.test.clustering.cluster.singleton.service.MyServiceServlet.java"], "label": 1, "es_results": []}, {"bug_id": 5628, "bug_title": "Deploying distributable web application starts an unnecessary cache.", "bug_description": "Deploying a web application should only start 2 caches:\n\nCache for storing sessions (deployment specific)\nCache for storing routing information (shared)\n\nHowever, currently, the default cache is also started, even though it is never used.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.InfinispanSessionManagerFactoryBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 5665, "bug_title": "Infinispan enables statistics instrumentation even though statistics-enabled is false", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.CacheConfigurationBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 5683, "bug_title": "Default jgroups thread pool keep-alive times are much too small", "bug_description": "This looks like a unit problem.  e.g. 60 sec instead of 60 msec.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.ThreadPoolResourceDefinition.java", "org.jboss.as.clustering.jgroups.subsystem.ThreadPoolResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5667, "bug_title": "[Migration operation] Provide warning that HornetQ connector/acceptor parameters can not be migrated to the new messaging-subsystem", "bug_description": "The parameters used by remote/http connector/acceptors in HornetQ might not be supported by Artemis.\nDuring migration, the operation should check if the parameters to migrate are allowed by the Artemis resources.\nIf that&apos;s not the case, they will be removed from the migrated resources and warnings will be added to the :migrate operation outcome.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.messaging.test.MigrateTestCase.java", "org.jboss.as.messaging.logging.MessagingLogger.java", "org.jboss.as.messaging.MigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5690, "bug_title": "JDBCStoreResourceDefinition.DeprecatedAttribute.DATASOURCE is not transformed", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.JDBCStoreResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.TransformersTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 5680, "bug_title": "InfinispanBatchContext trying to resume committed tx", "bug_description": "When running the test case RemoteFailoverTestCase.testStatefulFailover, the test hangs due to an exception occurring. The exception is the following:\n\n\n\n\n\n\n[31m11:24:05,814 ERROR [org.infinispan.interceptors.InvocationContextInterceptor] (EJB default - 3) ISPN000136: Execution error: java.lang.IllegalStateException: Transaction DummyTransaction{xid=DummyXid{id=47}, status=3} is not in a valid state to be invoking cache operations on.\n\n\n\n\n\n\nThis exception arose some time ago and was linked to incorrect suspend/resume of threads by the InfinispanBatching mechanism. This is just a suggestion as to what might be the root because.\nAttached is a log of the test case run with TRACE logging on DummyTransactionManager which coordinates the suspends and resumes. I have also performed a stack trace dump on every call to suspend and resume to highlight the origin of the call. \n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.ejb3.component.stateful.StatefulSessionComponentInstance.java", "org.wildfly.clustering.web.undertow.session.DistributableSessionManager.java", "org.wildfly.clustering.web.undertow.session.DistributableSessionManagerTestCase.java", "org.jboss.as.ejb3.cache.distributable.DistributableCache.java"], "label": 1, "es_results": []}, {"bug_id": 5706, "bug_title": "Failure to commit state should not trigger response failure", "bug_description": "We should log a warning instead, ideally commit data to the local node (e.g. AS5/AS7 behavior).\nIn sync case its too late to propagate to undertow because the response was already commited.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.clustering.ee.infinispan.CacheEntryMutator.java", "org.wildfly.clustering.ee.infinispan.CacheEntryMutatorTestCase.java", "org.wildfly.clustering.web.undertow.session.DistributableSession.java"], "label": 1, "es_results": []}, {"bug_id": 5711, "bug_title": "FormAuthenticationWebFailoverTestCase fails against Undertow 1.3.6.Final", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.test.clustering.cluster.web.authentication.SecureServlet.java", "org.jboss.as.test.clustering.cluster.web.authentication.FormAuthenticationWebFailoverTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 5657, "bug_title": "HttpServletRequest.changeSessionId() does not reassociate session ID with distributed SSO", "bug_description": "The distributed SSO implementation stores a map of sessions using the session ID.  If the user changes the session ID, this reference is never changed.  Consequently, subsequent calls to SingleSignOn.getSession(SessionManager) will return null.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.clustering.web.undertow.sso.DistributableSingleSignOn.java"], "label": 1, "es_results": []}, {"bug_id": 5756, "bug_title": "Unable to exclude root context (/) via excluded-contexts in mod_cluster subsystem", "bug_description": "\n\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=modcluster/mod-cluster-config=configuration/:write-attribute(name=excluded-contexts,value=\"ROOT,/\"\n\n\n\n\n\n\nbut no luck\n\n\n\n\n\n\nmod_cluster/1.3.2.Alpha1-SNAPSHOT\n\n\n\n\n\n\n\n\n\nAuto Refresh show DUMP output show INFO output\n\n\n\n\nNode localhost (ajp://127.0.0.1:8009):\n\n\n\n\n\n\n\n\n\nEnable Contexts Disable Contexts Stop Contexts\n\n\n\n\nBalancer: syrah-cluster,LBGroup: ,Flushpackets: Off,Flushwait: 10000,Ping: 10000000,Smax: 26,Ttl: 60000000,Status: OK,Elected: 0,Read: 0,Transferred: 0,Connected: 0,Load: 77\n\n\n\n\nVirtual Host 1:\n\n\n\n\n\n\n\n\n\nContexts:\n\n\n\n\n\n\n\n\n\n/clusterbench-passivating, Status: ENABLED Request: 0 Disable Stop\n\n\n\n\n/, Status: ENABLED Request: 0 Disable Stop\n\n\n\n\nAliases:\n\n\n\n\n\n\n\n\n\nlocalhost\n\n\n\n\ndefault-host\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.mod_cluster.undertow.UndertowHostTestCase.java", "org.wildfly.mod_cluster.undertow.UndertowContext.java", "org.wildfly.mod_cluster.undertow.UndertowContextTestCase.java", "org.wildfly.mod_cluster.undertow.UndertowHost.java"], "label": 1, "es_results": []}, {"bug_id": 5732, "bug_title": "CLI operation export-journal does not work with custom journal paths", "bug_description": "To reproduce the issue run server in stadalone mode with following properties (or you can use attached standalone-full-ha.xml)\n\n\n\n\n\n\n<bindings-directory path=\"/var/tmp/journal/bindings\"/>\n\n\n\n\n<journal-directory path=\"/var/tmp/journal/journal\"/>\n\n\n\n\n<large-messages-directory path=\"/var/tmp/journal/largemessages\"/>\n\n\n\n\n<paging-directory path=\"/var/tmp/journal/paging\"/>\n\n\n\n\n<jms-queue name=\"testQueue\" entries=\"jms/queue/testQueue java:jboss/exported/jms/queue/testQueue\"/>\n\n\n\n\n\n\nSend some messages into the testQueue with JMSDeliveryMode set to Persistent.\n\n\n\n\n\n\nTextMessage textMessage = context.createTextMessage(content);\n\n\n\n\ntextMessage.setJMSDeliveryMode(DeliveryMode.PERSISTENT);\n\n\n\n\ncontext.createProducer().send(destination, textMessage);\n\n\n\n\n\n\nRun\n\n\n\n\n\n\n./bin/jboss-cli.sh -c \":reload(admin-only=true)\"\n\n\n\n\n./bin/jboss-cli.sh -c \"/subsystem=messaging-activemq/server=default/:export-journal()\"\n\n\n\n\n\n\nExpectation: Exported file contains sent messages.\nReality: Exported file contains no message.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.extension.messaging.activemq.ExportJournalOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5709, "bug_title": "Fix messaging HA colocated  configuration", "bug_description": "The HA configuration for the messaging-activemq&apos;s server resource has issues to fix:\n\nthe shared-store-colocated configuration creates replication live/backup configuration instead of shared-store ones.\nthe tailback-delay attribute is deprecated and should be replaced by an attribute backed by initialReplicationSyncTimeout property\nlive and backup configuration must always be created for colocated configurations.\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.extension.messaging.activemq.ha.SharedStoreColocatedDefinition.java", "org.jboss.as.messaging.test.MigrateTestCase.java", "org.wildfly.extension.messaging.activemq.ha.ReplicationSlaveDefinition.java", "org.jboss.as.messaging.MigrateOperation.java", "org.wildfly.extension.messaging.activemq.ha.ReplicationMasterDefinition.java", "org.wildfly.extension.messaging.activemq.ha.SharedStoreMasterDefinition.java", "org.wildfly.extension.messaging.activemq.ha.ReplicationColocatedDefinition.java", "org.wildfly.extension.messaging.activemq.MessagingSubsystemParser_1_0.java", "org.wildfly.extension.messaging.activemq.ha.HAAttributes.java", "org.jboss.as.messaging.logging.MessagingLogger.java", "org.wildfly.extension.messaging.activemq.ha.SharedStoreSlaveDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5824, "bug_title": "Messaging outgoing interceptors are not set", "bug_description": "In org.wildfly.extension.messaging.activemq.ServerAdd#processOutgoingInterceptors, the interceptors are wrongly added to the incoming interceptors instead of the outgoing interceptors.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.extension.messaging.activemq.ServerAdd.java"], "label": 1, "es_results": []}, {"bug_id": 5678, "bug_title": "[Migration operation] :migrate operation should return outcome success when migrating expressions jgroup stack in discovery group", "bug_description": "If configuration for jgroups stack in discovery group contains expression:\n\n\n\n\n\n\n            <discovery-group name=\"groupU\">\n\n\n\n\n                <jgroups-stack>${jgroups.stack:udp}</jgroups-stack>\n\n\n\n\n                <jgroups-channel>${jgroups.channel:udp}</jgroups-channel>\n\n\n\n\n            </discovery-group>\n\n\n\n\n\n\n then :migrate operation has outcome => failed:\n\n\n\n\n\n\n[standalone@127.0.0.1:9999 /] /subsystem=messaging:migrate\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"result\" => {\n\n\n\n\n        \"migration-warnings\" => [],\n\n\n\n\n        \"migration-error\" => {\n\n\n\n\n            \"operation\" => {\n\n\n\n\n                \"jgroups-stack\" => expression \"${jgroups.stack:udp}\",\n\n\n\n\n                \"jgroups-channel\" => expression \"${jgroups.channel:udp}\",\n\n\n\n\n                \"operation\" => \"add\",\n\n\n\n\n                \"address\" => [\n\n\n\n\n                    (\"subsystem\" => \"messaging-activemq\"),\n\n\n\n\n                    (\"server\" => \"default\"),\n\n\n\n\n                    (\"discovery-group\" => \"groupU\")\n\n\n\n\n                ],\n\n\n\n\n                \"operation-headers\" => {\n\n\n\n\n                    \"caller-type\" => \"user\",\n\n\n\n\n                    \"access-mechanism\" => \"NATIVE\"\n\n\n\n\n                }\n\n\n\n\n            },\n\n\n\n\n            \"result\" => {\n\n\n\n\n                \"outcome\" => \"failed\",\n\n\n\n\n                \"failure-description\" => \"WFLYCTL0264: jgroups-stack may not be ModelType.EXPRESSION\",\n\n\n\n\n                \"rolled-back\" => true\n\n\n\n\n            }\n\n\n\n\n        }\n\n\n\n\n    },\n\n\n\n\n    \"failure-description\" => \"WFLYMSG0081: Migration failed, see results for more details.\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\nBased on my understanding there should be outcome success with warning.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.messaging.logging.MessagingLogger.java", "org.jboss.as.messaging.test.MigrateTestCase.java", "org.jboss.as.messaging.MigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5721, "bug_title": "Some of attributes in datasource subsystem do not allow usage of expressions", "bug_description": "Some of the properties in datasource subsystem are disabled to be set by expression. It would be good if all attributes could be set by expression if possible.\nNamely these are those which sets \"expressions-allowed\" as false\n\ndriver\n\t\ndriver-class-name\ndriver-module-name\ndriver-xa-datasource-class-name\nmodule-slot\njdbc-compliant\nprofile\n\n\ndata-source\n\t\nallow-multiple-users\n\n\n\nThis issue came alongside with testing EAP7-467 which asks for allowing expressions in datasource subsystem, especially for attribute &apos;enabled&apos;.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.connector.subsystems.datasources.DataSourcesSubsystemRootDefinition.java", "org.jboss.as.connector.subsystems.datasources.XaDataSourceDefinition.java", "org.jboss.as.connector.subsystems.datasources.JdbcDriverDefinition.java", "org.jboss.as.connector.subsystems.datasources.Constants.java", "org.jboss.as.connector.subsystems.datasources.DataSourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5813, "bug_title": "Quick redeploy vulnerable to CacheRegistry entry loss", "bug_description": "On deploy, CacheRegistry adds its local entry to the cache, and on undeploy removes it entry.  However, we use a topology change listener to remove entries for crashed members (since these nodes will not have removed their local entry).  However, since the listener is triggered asynchronously, it is possible that the topology change fired in response to an undeploy execute after the redeployed CacheRegistry starts - which would cause erroneous removal of the local entry that was added.\nThis manifests itself as an intermittent failure of the RegistryTestCase as seen in this PR:\nhttps://github.com/wildfly/wildfly/pull/8465\nNot surprisingly, this issue only surfaces in the windoze runs, which, according to Tomaz Cerar, execute faster than the linux runs.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.ejb3.cache.distributable.DistributableCache.java", "org.wildfly.clustering.server.provider.CacheServiceProviderRegistry.java", "org.wildfly.clustering.server.registry.CacheRegistry.java", "org.wildfly.clustering.server.registry.CacheRegistryFactoryBuilder.java", "org.wildfly.clustering.server.logging.ClusteringServerLogger.java", "org.wildfly.clustering.server.registry.LocalRegistry.java", "org.wildfly.clustering.server.registry.CacheRegistryFactoryConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 5771, "bug_title": "IIOP operations need SerializablePermission(\"enableSubclassImplementation\")", "bug_description": "Since JDK 7u25 version org.omg.CORBA_2_3.portable.Output/InputStream classes need extra permissions if Security Manager is enabled. Because of a previous vulnerability, it now checks SerializablePermission(\"enableSubclassImplementation\"). There is a property flag to allow subclass instantiations without the security check (jdk.corba.allowOutputStreamSubclass=true), but this system property is subject to removal in the future Java releases, according to my findings. \nAt the moment, our IIOP code fails (can be seen in iiop tests of WildFly testsuite) when running with SM enabled.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.iiop.openjdk.csiv2.CSIV2IORToSocketInfo.java"], "label": 1, "es_results": []}, {"bug_id": 5521, "bug_title": "Tests from IIOP module fails with security manager", "bug_description": "Description of problem:\nTests from IIOP module fails with security manager.\nHow reproducible:\nAlways\nSteps to Reproduce:\n\n./integration-tests.sh -Dmaven.repo.local=$MAVEN_REPO_LOCAL -fae -Dmaven.test.failure.ignore=true -Dnode0=$MYTESTIP_1 -Dnode1=$MYTESTIP_2 -Dmcast=$MCAST_ADDR -Djboss.dist=$JBOSS_DIST -Dsecurity.manager -Dts.IIOP -Dts.noSmoke\n\nActual results:\nSee attached file\nExpected results:\nNo errors", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.test.iiop.security.IIOPSecurityInvocationTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 5764, "bug_title": "Remove mod_cluster excluded-context's default value with outdated contexts", "bug_description": "The list of current values is useless in the defualt configuration.\n\n\n\n\n\n\n\"excluded-contexts\" => \"ROOT,invoker,jbossws,juddi,console\"\n\n\n\n\n\n\nI am actually marking this as bug, because if you just want to use the root context, if you undefine the value, the default will be used which exludes root context.\nTrying a \"\" value, results in a failure.\n\n\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=modcluster/mod-cluster-config=configuration/:write-attribute(name=excluded-contexts,value=\"\"\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"WFLYCTL0113: &apos;&apos; is an invalid value for parameter excluded-contexts. Values must have a minimum length of 1 characters\",\n\n\n\n\n    \"rolled-back\" => true,\n\n\n\n\n    \"response-headers\" => {\"process-state\" => \"reload-required\"}\n\n\n\n\n}\n\n\n\n\n\n\nThis all comes from legacy stuff.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.extension.mod_cluster.ModClusterConfigResourceDefinition.java", "org.wildfly.extension.mod_cluster.ModClusterSubsystemAdd.java", "org.wildfly.extension.mod_cluster.ModClusterModel.java"], "label": 1, "es_results": []}, {"bug_id": 5748, "bug_title": "IIOP: SSL configuration inconsistence", "bug_description": "If user configures IOR settings so that SSL connections are required, but there security is not configured properly, then normal socket is opened on iiop-ssl port. In described scenario error should be printed and iiop subsystem should fail to start.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.iiop.openjdk.IIOPSubsystemAdd.java", "org.wildfly.iiop.openjdk.logging.IIOPLogger.java"], "label": 1, "es_results": []}, {"bug_id": 5735, "bug_title": "Load balancing does not work when deploy app with root-context '/'", "bug_description": "Everything work fine follow Stuart&apos;s instruction here https://github.com/stuartwdouglas/modcluster-example\nbut when I changed the root context of the app to \"/\"  the load balancing did not work any more, but still you can access to individual server.\nI experimented with different root context like \"/test\", \"/root\" and I found that, setting any root context for app is OK except \"/\" (blank)\nBest Regards,\nChanras", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.wildfly.extension.undertow.filters.ModClusterService.java"], "label": 1, "es_results": []}, {"bug_id": 5580, "bug_title": "[Migration operation] [Web to Undertow] attribute proxy-binding on connector is neither migrated and neither is migration warning shown.", "bug_description": "when migrating connector with defined proxy-binding, the proxy-binding is not migrated and neither is warning printed.\nMarking as critical as information that one particular attribute wasn&apos;t migrated without notifying user (e.g. via migration-warning) could lead to unpredicted configuration from user&apos;s PoV.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.CR5", "fixed_files": ["org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5918, "bug_title": "ServletContext.getResourceAsStream fails on windows", "bug_description": "Struts 1 ActionServlet fails to initialize with latest Wildfly 10.0.0 CR5 though it was working fine on the previous CR4 release. The failure occurs when Servlet tries to read the /WEB-INF/web.xml inside my web application.\nLooking at the struts source code, getServletContext().getResourceAsStream(\"/WEB-INF/web.xml\") returns null during the Servlet initialization. \nproblem only occurs when server is started from path that is not case equal to real path on file system.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.wildfly.extension.undertow.deployment.ServletResourceManager.java"], "label": 1, "es_results": []}, {"bug_id": 5939, "bug_title": "Binding to <any-address/> will make mod_cluster advertise host as 0.0.0.0", "bug_description": "Needs to be handled in org.wildfly.mod_cluster.undertow.UndertowConnector#setAddress.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.wildfly.mod_cluster.undertow.UndertowConnector.java"], "label": 1, "es_results": []}, {"bug_id": 5998, "bug_title": "ISPN-6007 workaround fails for caches using optimistic locking", "bug_description": "Ultimately, this workaround should be removed following the upgrade to Infinispan 8.1.1.Final - which incorporates a fix for ISPN-6007.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.InfinispanSessionManagerFactory.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSessionMetaDataFactory.java"], "label": 1, "es_results": []}, {"bug_id": 5959, "bug_title": "Infinispan caches non transactional despite transactional cache mode", "bug_description": "Local Infinispan caches declared in standalone.xml are no longer set as transactional even if a transactional mode is selected.\nThis prevents creation of atomic maps using AtomicMapLookup as that specifically checks if the cache is transactional (throws java.lang.IllegalStateException: AtomicMap needs a transactional cache.)\nPossibly caused by issue WFLY-5327.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.CacheServiceHandler.java"], "label": 1, "es_results": []}, {"bug_id": 6027, "bug_title": "Fix messaging migration warnings", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.jboss.as.messaging.logging.MessagingLogger.java"], "label": 1, "es_results": []}, {"bug_id": 5971, "bug_title": "Weld's ProxyServicesImpl#getClassLoader has reversed security manager check", "bug_description": "Introduced by \n9362aab078aa0b61144b27f9a0ae9b233bcde9ca\nMethod\norg.jboss.as.weld.services.bootstrap.ProxyServicesImpl#getClassLoader\nStack trace \nhttps://gist.github.com/rhusar/2db92caf6e3bd182331f", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.jboss.as.weld.services.bootstrap.ProxyServicesImpl.java"], "label": 1, "es_results": []}, {"bug_id": 5927, "bug_title": "Transformation tests that were failing due to WFCORE-1210 are still disabled", "bug_description": "Alias addresses tests in org.jboss.as.clustering.infinispan.subsystem.TransformersTestCase#propertiesMapOperationsTest were affected by WFCORE-1210.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.TransformersTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 6031, "bug_title": "WeldProvider.containerShutDown() not invoked if the deployment fails", "bug_description": "We&apos;ve run into this problem when executing Weld and CDI TCK test suites on a specific HP-UX machine. Both test suites contain a lot of scenarios where the deployment fails. HP-UX jvm cannot handle this load and the test suite fails with OutOfMemoryError.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.jboss.as.weld.WeldBootstrapService.java"], "label": 1, "es_results": []}, {"bug_id": 6009, "bug_title": "[Migration operation] [Web to Undertow] Migrating non migratable valve does not result in error shown in migration-warnings", "bug_description": "When migration web with custom valve or any valve, which can&apos;t be automatically migrated, there is no error shown in migration-warnings.\nIt is necessary to inform that something wasn&apos;t migrated to let user know he needs to migrate it manually.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5828, "bug_title": "Format differences between default configuration and read/persisted oneFormat differences between default configuration and read/persisted one in infinispan/undertow/ejb3 subsystems and management section", "bug_description": "Neverending classic, just like every release:\n\n\n\n\n\n\n[rhusar@syrah wildfly-10.0.0.Final-SNAPSHOT]$ different standalone/configuration/standalone-ha.xml standalone/configuration/standalone_xml_history/standalone-ha.initial.xml\n\n\n\n\n1c1\n\n\n\n\n< <?xml version=&apos;1.0&apos; encoding=&apos;UTF-8&apos;?>\n\n\n\n\n---\n\n\n\n\n> <?xml version=\"1.0\" ?>\n\n\n\n\n4d3\n\n\n\n\n<\n\n\n\n\n36,37d34\n\n\n\n\n<\n\n\n\n\n<\n\n\n\n\n64c61\n\n\n\n\n<                 <file-handler name=\"file\" formatter=\"json-formatter\" path=\"audit-log.log\" relative-to=\"jboss.server.data.dir\"/>\n\n\n\n\n---\n\n\n\n\n>                 <file-handler name=\"file\" formatter=\"json-formatter\" relative-to=\"jboss.server.data.dir\" path=\"audit-log.log\"/>\n\n\n\n\n87d83\n\n\n\n\n<\n\n\n\n\n178a175\n\n\n\n\n>                 <stateful default-access-timeout=\"5000\" cache-ref=\"distributable\" passivation-disabled-cache-ref=\"simple\"/>\n\n\n\n\n182d178\n\n\n\n\n<                 <stateful default-access-timeout=\"5000\" cache-ref=\"distributable\" passivation-disabled-cache-ref=\"simple\"/>\n\n\n\n\n186a183\n\n\n\n\n>                     <!-- Automatically configure pools. Alternatively, max-pool-size can be set to a specific value -->\n\n\n\n\n193c190\n\n\n\n\n<                 <cache name=\"distributable\" passivation-store-ref=\"infinispan\" aliases=\"passivating clustered\"/>\n\n\n\n\n---\n\n\n\n\n>                 <cache name=\"distributable\" aliases=\"passivating clustered\" passivation-store-ref=\"infinispan\"/>\n\n\n\n\n220c217\n\n\n\n\n<             <cache-container name=\"server\" aliases=\"singleton cluster\" module=\"org.wildfly.clustering.server\" default-cache=\"default\">\n\n\n\n\n---\n\n\n\n\n>             <cache-container name=\"server\" aliases=\"singleton cluster\" default-cache=\"default\" module=\"org.wildfly.clustering.server\">\n\n\n\n\n226c223\n\n\n\n\n<             <cache-container name=\"web\" module=\"org.wildfly.clustering.web.infinispan\" default-cache=\"dist\">\n\n\n\n\n---\n\n\n\n\n>             <cache-container name=\"web\" default-cache=\"dist\" module=\"org.wildfly.clustering.web.infinispan\">\n\n\n\n\n234c231\n\n\n\n\n<             <cache-container name=\"ejb\" aliases=\"sfsb\" module=\"org.wildfly.clustering.ejb.infinispan\" default-cache=\"dist\">\n\n\n\n\n---\n\n\n\n\n>             <cache-container name=\"ejb\" aliases=\"sfsb\" default-cache=\"dist\" module=\"org.wildfly.clustering.ejb.infinispan\">\n\n\n\n\n242c239\n\n\n\n\n<             <cache-container name=\"hibernate\" module=\"org.hibernate.infinispan\" default-cache=\"local-query\">\n\n\n\n\n---\n\n\n\n\n>             <cache-container name=\"hibernate\" default-cache=\"local-query\" module=\"org.hibernate.infinispan\">\n\n\n\n\n244,247d240\n\n\n\n\n<                 <local-cache name=\"local-query\">\n\n\n\n\n<                     <eviction max-entries=\"10000\" strategy=\"LRU\"/>\n\n\n\n\n<                     <expiration max-idle=\"100000\"/>\n\n\n\n\n<                 </local-cache>\n\n\n\n\n250c243\n\n\n\n\n<                     <eviction max-entries=\"10000\" strategy=\"LRU\"/>\n\n\n\n\n---\n\n\n\n\n>                     <eviction strategy=\"LRU\" max-entries=\"10000\"/>\n\n\n\n\n252a246,249\n\n\n\n\n>                 <local-cache name=\"local-query\">\n\n\n\n\n>                     <eviction strategy=\"LRU\" max-entries=\"10000\"/>\n\n\n\n\n>                     <expiration max-idle=\"100000\"/>\n\n\n\n\n>                 </local-cache>\n\n\n\n\n403c400\n\n\n\n\n<                 <http-listener name=\"default\" redirect-socket=\"https\" socket-binding=\"http\"/>\n\n\n\n\n---\n\n\n\n\n>                 <http-listener name=\"default\" socket-binding=\"http\" redirect-socket=\"https\"/>\n\n\n\n\n418,419c415,416\n\n\n\n\n<                 <response-header name=\"server-header\" header-value=\"WildFly/10\" header-name=\"Server\"/>\n\n\n\n\n<                 <response-header name=\"x-powered-by-header\" header-value=\"Undertow/1\" header-name=\"X-Powered-By\"/>\n\n\n\n\n---\n\n\n\n\n>                 <response-header name=\"server-header\" header-name=\"Server\" header-value=\"WildFly/10\"/>\n\n\n\n\n>                 <response-header name=\"x-powered-by-header\" header-name=\"X-Powered-By\" header-value=\"Undertow/1\"/>\n\n\n\n\n434d430\n\n\n\n\n<\n\n\n\n\n446d441\n\n\n\n\n<\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.Final", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.EvictionResourceDefinition.java", "org.wildfly.extension.undertow.UndertowSubsystemParser_3_0.java", "org.jboss.as.clustering.infinispan.subsystem.CacheContainerResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 6081, "bug_title": "Undertow migration operation does not migrate Access log valves", "bug_description": "Access log valves are not automatically migrated, it should be either printed warning for them to be migrated automatically or migrated automatically.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.jboss.as.web.test.WebMigrateTestCase.java", "org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 5962, "bug_title": "ServletContainerInitializers from jboss-deployment-structure.xml module dependencies are not invoked", "bug_description": "If a module includes a ServletContainerInitializer, that ServletContainerInitializer is not invoked for any applications that include the module in its jboss-deployment-structure.xml module dependencies.  It looks like the ServletContainerInitializerDeploymentProcessor only checks server provided dependencies.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.wildfly.extension.undertow.deployment.ServletContainerInitializerDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 5944, "bug_title": "ParseAndMarshalModelsTestCase is not testing EAP 6.4 files or legacy standalone-picketlink.xml files", "bug_description": "Our test coverage of parsing and marshaling compatibility has holes.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.0.0.Final", "fixed_files": ["org.wildfly.extension.picketlink.federation.model.parser.AbstractFederationSubsystemReader.java", "org.wildfly.extension.picketlink.idm.IDMExtension.java", "org.wildfly.extension.picketlink.federation.FederationExtension.java", "org.wildfly.extension.picketlink.federation.model.idp.TrustDomainResourceDefinition.java", "org.jboss.as.test.manualmode.parse.ParseAndMarshalModelsTestCase.java", "org.wildfly.extension.picketlink.idm.Namespace.java", "org.wildfly.extension.picketlink.idm.model.parser.AbstractIDMSubsystemReader.java", "org.wildfly.extension.picketlink.federation.Namespace.java"], "label": 1, "es_results": []}, {"bug_id": 5883, "bug_title": "Imposible to fix wrong PicketLink Federation identity provider's security domain after reload", "bug_description": "If you do typo when editing security domain of identity provider it&apos;s impossible to fix it by writing correct value to attribute but you have to remove the whole identity provider and create it again.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.Final", "fixed_files": ["org.wildfly.extension.picketlink.federation.model.idp.IdentityProviderAddHandler.java", "org.wildfly.extension.picketlink.federation.model.idp.IdentityProviderRemoveHandler.java", "org.wildfly.extension.picketlink.federation.model.sp.ServiceProviderResourceDefinition.java", "org.wildfly.extension.picketlink.federation.model.idp.IdentityProviderResourceDefinition.java", "org.wildfly.extension.picketlink.federation.service.TrustDomainService.java", "org.wildfly.extension.picketlink.federation.model.idp.IdentityProviderConfigAddStepHandler.java", "org.wildfly.extension.picketlink.federation.model.idp.IdentityProviderConfigRemoveStepHandler.java", "org.wildfly.extension.picketlink.federation.model.idp.TrustDomainAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 5873, "bug_title": "Cannot set static-connectors on AMQ bridge, if discovery-group were set before", "bug_description": "When AMQ bridge is created with static-connectors field set, and then static-connectors are undefined and discovery-group is set (in a single batch), following error is thrown:\n\"WFLYMSGAMQ0069: Attribute (static-connectors) can not been undefined as the resource does not define any alternative to this attribute.\"\nProblem seems to be missing STATIC_CONNECTORS.setAlternatives(CommonAttributes.DISCOVERY_GROUP) in resource definition, which is causing !attr.hasAlternative(resource.getModel()) check to fail in following code:\n\n\n\n\n\n\nAlternativeAttributeCheckHandler.java\n\n\n\n\n\n\n    private void checkAlternativeAttribute(OperationContext context, String attributeName, boolean alternativeMustBeSet) throws OperationFailedException {\n\n\n\n\n        if (attributeDefinitions.containsKey(attributeName)) {\n\n\n\n\n            AttributeDefinition attr = attributeDefinitions.get(attributeName);\n\n\n\n\n            final Resource resource = context.readResource(EMPTY_ADDRESS);\n\n\n\n\n            if (alternativeMustBeSet) {\n\n\n\n\n                if (!attr.hasAlternative(resource.getModel())) {\n\n\n\n\n                    throw new OperationFailedException(MessagingLogger.ROOT_LOGGER.undefineAttributeWithoutAlternative(attributeName));\n\n\n\n\n                }\n\n\n\n\n            } else {\n\n\n\n\n                if (attr.hasAlternative(resource.getModel())) {\n\n\n\n\n                    throw new OperationFailedException(MessagingLogger.ROOT_LOGGER.altAttributeAlreadyDefined(attributeName));\n\n\n\n\n                }\n\n\n\n\n            }\n\n\n\n\n        }\n\n\n\n\n    }\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.Final", "fixed_files": ["org.wildfly.extension.messaging.activemq.CommonAttributes.java", "org.wildfly.extension.messaging.activemq.ClusterConnectionDefinition.java", "org.wildfly.extension.messaging.activemq.BridgeDefinition.java", "org.wildfly.extension.messaging.activemq.AlternativeAttributeCheckHandler.java"], "label": 1, "es_results": []}, {"bug_id": 5871, "bug_title": "post-binding attribute of PicketLink Federation service provider should be of type Boolean not String", "bug_description": "Currently type of this attribute is String despite it&apos;s description \"Indicate if this service provider uses a HTTP POST(true) or REDIRECT(false) binding.\"\nIf user tries to write other value than \"true\" or \"false\" to this attribute IllegalArgumentException is thrown.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.Final", "fixed_files": ["org.wildfly.extension.picketlink.federation.model.sp.ServiceProviderResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5841, "bug_title": "SchemaLocationsRewriteTestCase is checking implementation details", "bug_description": "Test case is currently checking implementation details, so it&apos;s easy to brake it when implementation changes while still being correct.\nSpecifically, the test case shouldn&apos;t make any assumptions about the format of rewritten schema locations. Instead, it should only check that rewritten location is a retrievable URL.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.Final", "fixed_files": ["org.jboss.as.test.integration.ws.schemalocations.SchemaLocationsRewriteTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 5656, "bug_title": "No warning is shown when deploying web application with defined valves", "bug_description": "There is currently not shown any warning when trying to deploy web application having defined valves which are not available. There should be shown warning in the logs during deployment for customer to know that not all features defined in deployment are working.\nMarking as critical as this behaviour hides that some features are not enabled and the features might be important for customer (e.g. some address filtering). resulting in thinking that everything is defined correctly instead of showing warning to let customer know that this part of logic requires migration to handlers.\nSteps to reproduce:\ndeploy attached application and see whether there occurs warning in logs during deployment.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.0.0.Final", "fixed_files": ["org.wildfly.extension.undertow.logging.UndertowLogger.java", "org.wildfly.extension.undertow.deployment.JBossWebParsingDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 5238, "bug_title": "[Migration operation] [Web to Undertow] Unable to migrate any valve to handler", "bug_description": "In Undertow there are Handlers which can be used similarly as Valves. Some valves have corresponding handler in Undertow. Such valves could be migrated.\nE.g. as part of [EAP7-428] there is added io.undertow.server.handlers.RequestDumpingHandler.\nThis could be thereby migrated from \n\n\n\n\n\n\n<subsystem xmlns=\"urn:jboss:domain:web:2.2\" default-virtual-server=\"default-host\" native=\"false\">\n\n\n\n\n     <valve name=\"request-dumper\" module=\"org.jboss.as.web\" class-name=\"org.apache.catalina.valves.RequestDumperValve\"/>\n\n\n\n\n     <virtual-server name=\"default-host\" enable-welcome-root=\"false\">\n\n\n\n\n         <alias name=\"localhost\"/>\n\n\n\n\n         <alias name=\"example.com\"/>\n\n\n\n\n     </virtual-server>\n\n\n\n\n      ...\n\n\n\n\n</subsystem>\n\n\n\n\n\n\nto something like:\n\n\n\n\n\n\n<subsystem xmlns=\"urn:jboss:domain:undertow:3.0\">\n\n\n\n\n    <buffer-cache name=\"default\"/>\n\n\n\n\n    <server name=\"default-server\" default-host=\"default-host\">\n\n\n\n\n        <host name=\"default-host\" alias=\"localhost, example.com\">\n\n\n\n\n            <filter-ref name=\"request-dumper\"/>\n\n\n\n\n        </host>\n\n\n\n\n    </server>\n\n\n\n\n    <servlet-container name=\"default\">\n\n\n\n\n        <jsp-config/>\n\n\n\n\n    </servlet-container>\n\n\n\n\n    <filter name=\"request-dumper\" module=\"io.undertow.core\" class-name=\"io.undertow.server.handlers.RequestDumpingHandler\"/>\n\n\n\n\n    ...\n\n\n\n\n</subsystem>\n\n\n\n\n\n\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "10.0.0.Final", "fixed_files": ["org.jboss.as.web.test.WebMigrateTestCase.java", "org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 6026, "bug_title": "Add ability to specify max packet size of ajp-listener", "bug_description": "Currently there is not possible to specify maximum packet size for AJP listener in Undertow. In EAP6 there was possible to use org.apache.coyote.ajp.MAX_PACKET_SIZE system property for this purpose, see also this jira.\nThis is missing feature compared to EAP6 therefore we should add this otherwise some customers might miss it.\nProposed solution: add a new attribute into AJP listener that would specify max packet size.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.UndertowSubsystemTestCase.java", "org.wildfly.extension.undertow.Constants.java", "org.wildfly.extension.undertow.AjpListenerResourceDefinition.java", "org.wildfly.extension.undertow.AjpListenerAdd.java", "org.wildfly.extension.undertow.filters.ModClusterDefinition.java", "org.wildfly.extension.undertow.UndertowExtension.java", "org.wildfly.extension.undertow.Namespace.java", "org.wildfly.extension.undertow.filters.ModClusterService.java"], "label": 1, "es_results": []}, {"bug_id": 6038, "bug_title": "Can not deploy a @ConnectionFactoryDefinition if the RA has more <connection-definitions>", "bug_description": "Steps to reproduce:\n\nadd a 2nd connection-defintion to testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/jca/deployment/ra.xml:\n\n\n\n\n\n\n         <connection-definition>\n\n\n\n\n            <managedconnectionfactory-class>org.jboss.as.test.integration.jca.rar.MultipleManagedConnectionFactory2</managedconnectionfactory-class>\n\n\n\n\n            <connectionfactory-interface>org.jboss.as.test.integration.jca.rar.MultipleConnectionFactory2</connectionfactory-interface>\n\n\n\n\n            <connectionfactory-impl-class>org.jboss.as.test.integration.jca.rar.MultipleConnectionFactory2Impl</connectionfactory-impl-class>\n\n\n\n\n            <connection-interface>org.jboss.as.test.integration.jca.rar.MultipleConnection2</connection-interface>\n\n\n\n\n            <connection-impl-class>org.jboss.as.test.integration.jca.rar.MultipleConnection2Impl</connection-impl-class>\n\n\n\n\n         </connection-definition>\n\n\n\n\n\n\nRun the WarServletDeploymentTestCase test\n=> it fails because the ConnectionFactoryDefinition objects are no longer deployed.\n\nAfter debugging, the test fails because the deployed connection definitions are not activated.\nThe code at org/jboss/as/connector/services/resourceadapters/ResourceAdapterActivatorService.java:232 is preventing the activation and looks suspicious.\nIt expects that all the MCF in the RA (raMcfClasses) must all be in the activation (ijMcfClasses). \nWith a 2nd <connection-definition> in the RA, it is no longer the case (as the activation only contains a single MCF (MultipleManagedConnectionFactory1).\nIf I change the code so that it checks that all the MCF in the activations are in the RA, the test passes again.\nThis issue is preventing me to reuse the code handling the @ConnectionFactoryDefinition to support the @JMSConnectionFactoryDefinition (my JMS RA defines 3 MCF for generic/queue/topic CFs but my activation only defines a single MCF per @JMSConnectionFactoryDefinition).\nI&apos;ve not run it but the same issue is likely for admin objects too (the code in checkActivation is similar)", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.connector.services.resourceadapters.ResourceAdapterActivatorService.java"], "label": 1, "es_results": []}, {"bug_id": 6125, "bug_title": "[Migration operation] No migration warning for remoting-interceptors", "bug_description": "There is missing warning if following configuration is migrated to messaging-activemq subsystem:\n\n\n\n\n\n\n<remoting-interceptors>\n\n\n\n\n                <class-name>\n\n\n\n\n                    org.jboss.qa.hornetq.apps.interceptors.LargeMessagePacketInterceptorImpl\n\n\n\n\n                </class-name>\n\n\n\n\n                <class-name>\n\n\n\n\n                    org.jboss.qa.hornetq.apps.interceptors.LargeMessagePacketInterceptorImpl\n\n\n\n\n                </class-name>\n\n\n\n\n</remoting-interceptors>\n\n\n\n\n\n\nThere should be warning like:\nWFLYMSG0082: Classes providing the remoting-incoming-interceptors are discarded during the migration. To use them in the new messaging-activemq subsystem, you will have to extend the Artemis-based Interceptor.\nas for migration of remoting-incoming-interceptors and remoting-outgoing-interceptors.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.messaging.test.MigrateTestCase.java", "org.jboss.as.messaging.MigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 6068, "bug_title": "Warn that attribute failback-delay is handled automatically", "bug_description": "Attribute failback-delay=\"6000\" is not migrated. \nThe migrated configuration should like:\n\n\n\n\n\n\n<shared-store-master failover-on-server-shutdown=\"true\" failback-delay=\"6000\" />\n\n\n\n\n\n\nbut there is just:\n\n\n\n\n\n\n<shared-store-master failover-on-server-shutdown=\"true\" />\n\n\n\n\n\n\nSee failed test in Jenkins:\n[1] https://jenkins.mw.lab.eng.bos.redhat.com/hudson/job/eap7-migration-standalone/8/testReport/org.jboss.qa.eap6to7migration.hornetq2artemis/ColocatedReplicatedTopologyTest/migrate/", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.messaging.test.MigrateTestCase.java", "org.jboss.as.messaging.MigrateOperation.java", "org.jboss.as.messaging.logging.MessagingLogger.java"], "label": 1, "es_results": []}, {"bug_id": 6136, "bug_title": "Wildfly 10.0.0.Final duplitates contents of <jsp-config><include-prelude> or <include-coda> directives in web.xml", "bug_description": "I have been successfully deploying an application on WildFly 8.2.1 and WildFly 9.0.2 versions with the following <jsp-config> directives in web.xml deployment descriptor:\n<jsp-config>\n<jsp-property-group>\n<description>header and footer settings</description>\n<url-pattern>/WEB-INF/view/*</url-pattern>\n<url-pattern>/WEB-INF/error/*</url-pattern>\n<include-prelude>/WEB-INF/jspf/header.jspf</include-prelude>\n<include-coda>/WEB-INF/jspf/footer.jspf</include-coda>\n</jsp-property-group>\n</jsp-config>\nThis code fragment includes the contents of /WEB-INF/jspf/header.jspf at the beginning of each .jsp file and <include-coda>/WEB-INF/jspf/footer.jspf</include-coda> at the end of each .jsp file that matches the <url-pattern>.\nBut when I try to deploy this application with the same deployment descriptor in WildFly 10.0.0.Final, the contents of /WEB-INF/jspf/header.jspf and /WEB-INF/jspf/footer.jspf are included twice in each .jsp file that matches the <url-pattern>.\nIf I add another <url-pattern> line, then the contents of /WEB-INF/jspf/header.jspf and /WEB-INF/jspf/footer.jspf are included three times, and so on.\nAny suggestion about this issue?\nIs this a deployment descriptor issue or a configuration issue in the standalone.xml of WildFly 10.0.0.Final version?", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.test.integration.jsp.JspTagTestCase.java", "org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java"], "label": 1, "es_results": []}, {"bug_id": 6139, "bug_title": "Starting server with EAP 6.4 standalone-full-ha.xml in --admin-only does not list \"web\" as legacy", "bug_description": "\n\n\n\n\n\nunzip jboss-eap-6.4.0.zip\n\n\n\n\nunzip wildfly-10.0.0.Final.zip\n\n\n\n\n\n\n\n\n\ncp jboss-eap-6.4/standalone/configuration/standalone-full-ha.xml jboss-eap-7.0/standalone/configuration/\n\n\n\n\n./wildfly-10.0.0.Final/bin/standalone.sh -c standalone-full-ha.xml --admin-only\n\n\n\n\n\n\nDuring boot, the server lists threads, cmp, jaxr, messaging and jacorb as legacy:\n\n\n\n\n\n\n11:26:55,792 ERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool -- 5) WFLYCTL0402: Subsystems [jacorb] provided by legacy extension &apos;org.jboss.as.jacorb&apos; are not supported on servers running this version. Both the subsystem and the extension must be removed or migrated before the server will function.\n\n\n\n\n11:26:55,795 ERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool -- 8) WFLYCTL0402: Subsystems [cmp] provided by legacy extension &apos;org.jboss.as.cmp&apos; are not supported on servers running this version. Both the subsystem and the extension must be removed or migrated before the server will function.\n\n\n\n\n11:26:55,793 ERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool -- 12) WFLYCTL0402: Subsystems [threads] provided by legacy extension &apos;org.jboss.as.threads&apos; are not supported on servers running this version. Both the subsystem and the extension must be removed or migrated before the server will function.\n\n\n\n\n11:26:55,800 ERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool -- 18) WFLYCTL0402: Subsystems [messaging] provided by legacy extension &apos;org.jboss.as.messaging&apos; are not supported on servers running this version. Both the subsystem and the extension must be removed or migrated before the server will function.\n\n\n\n\n11:26:55,800 ERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool -- 9) WFLYCTL0402: Subsystems [jaxr] provided by legacy extension &apos;org.jboss.as.jaxr&apos; are not supported on servers running this version. Both the subsystem and the extension must be removed or migrated before the server will function.\n\n\n\n\n\n\nHowever, web is missing. IMHO it should be there.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.web.WebExtension.java", "org.jboss.as.web.test.WebMigrateTestCase.java", "org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 6160, "bug_title": "Failing RemoteFailoverTestCase#testStatefulFailover when transaction run under JTS", "bug_description": "I can see failing test RemoteFailoverTestCase#testStatefulFailover when transactions are set to run under JTS. I&apos;m not sure if this is a trouble of clustering component or only a testsuite issue.\nThis could be connected with JBEAP-1954.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.ejb3.tx.LifecycleCMTTxInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 6234, "bug_title": "Undertow mod_cluster should use multicast port from socket binding", "bug_description": "Currently uses org.jboss.as.network.SocketBinding#getPort", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.filters.ModClusterService.java"], "label": 1, "es_results": []}, {"bug_id": 6278, "bug_title": "Requesting a session with an unexpected character causes request to fail", "bug_description": "The root because of the problem is that the distributed web session code optimizes the marshalling of the session identifier, by using a URL safe Base64 codec.  Because this marshalling happens transparently, when Cache.get(...) goes remote (since the session ID containing an invalid character will never be found locally), the resulting IllegalArgumentException goes undetected - and propagates back to the client.\nTo prevent this, we need to validate that the requested session ID can be serialized - and if not, respond as if the session was not found.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.clustering.web.undertow.sso.DistributableSingleSignOnManagerTestCase.java", "org.wildfly.clustering.web.undertow.session.DistributableSessionManager.java", "org.wildfly.clustering.web.undertow.session.DistributableSessionManagerTestCase.java", "org.wildfly.clustering.web.undertow.sso.DistributableSingleSignOnManager.java"], "label": 1, "es_results": []}, {"bug_id": 5932, "bug_title": "Invalidating a session of an SSO on a different node than where the session was created does not logout the user", "bug_description": "See steps to reproduce for description. Additional scenario with a failover where we don&apos;t need to authenticate with the last request (but where we should be required to authenticate):\n\nAccess A1, authenticate, fail A1 (e.g. shutdown the server), access A2, invalidate session on A2, access A2\n\nScenarios where the SSO context is destroyed (where we need to authenticate with the last request as expected):\n\nAccess A1, authenticate, invalidate session on A1, access A1\nAccess A1, authenticate, access A2, invalidate session on A1, access A1\n\nPossibly related to JBEAP-1228, JBEAP-1282. Note that we always only have a single session bound to an SSO. I&apos;m not flagging this as a blocker, since the issue usually doesn&apos;t manifest thanks to sticky sessions on a load balancer.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java", "org.wildfly.extension.undertow.SingleSignOnService.java"], "label": 1, "es_results": []}, {"bug_id": 6340, "bug_title": "Adding deployment permissions does not put server in requires reload state", "bug_description": "When adding permissions in the security-manager subsystem, the changes are not used until server reload. But the CLI operation doesn&apos;t require reload.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha4", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.security.manager.DeploymentPermissionsResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 6517, "bug_title": "Module org.wildfly.naming does not export JndiPermission", "bug_description": "The new module org.wildfly.naming which contains JndiPermission does not export it. Hence, the module is efficiently useless. Deployments still have to depend on the private org.jboss.as.naming module to get the JndiPermission to work.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.test.integration.naming.remote.multiple.NestedRemoteContextTestCase.java", "org.jboss.as.test.integration.naming.remote.simple.RemoteNamingTestCase.java", "org.jboss.as.test.integration.web.servlet.lifecycle.ServletLifecycleMethodDescriptorTestCase.java", "org.jboss.as.test.integration.naming.remote.multiple.MultipleClientRemoteJndiTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 6220, "bug_title": "Duplicate WFLYUT0003 message in boot log", "bug_description": "Boot log noise:\n18:06:49,739 INFO  [org.wildfly.extension.undertow] (ServerService Thread Pool  55) WFLYUT0003: Undertow 1.3.16.Final starting\n18:06:49,739 INFO  [org.wildfly.extension.undertow] (MSC service thread 1-2) WFLYUT0003: Undertow 1.3.16.Final starting", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.UndertowSubsystemAdd.java"], "label": 1, "es_results": []}, {"bug_id": 6505, "bug_title": "CalendarBasedTimeout needs to trim whitespaces in ScheduleExpression.timezone", "bug_description": "When creating a calendar-based timer with a timezone id having leading/trailiing whitespaces, the specified timezone is ignored and the system default timezone is used instead.\nAlthough there is a warning, users may not notice it and would still expect the requested timezone to be used.\nThe logged warning:\n\n\n\n\n\n\n13:18:14,259 WARN  [org.jboss.as.ejb3] (default task-42) WFLYEJB0015: Unknown timezone id:\n\n\n\n\n                                            US/Eastern\n\n\n\n\n                                         found in schedule expression. Ignoring it and using server&apos;s timezone: America/New_York\n\n\n\n\n\n\nThe user-provided timezone &apos;US/Eastern&apos; is a valid timezone (after trimming).", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.ejb3.timerservice.schedule.CalendarBasedTimeout.java"], "label": 1, "es_results": []}, {"bug_id": 5823, "bug_title": "Register callbacks for messaging paths", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.messaging.activemq.ActiveMQServerService.java"], "label": 1, "es_results": []}, {"bug_id": 5096, "bug_title": "Example configuration standalone-activemq-colocated.xml is not in server distribution", "bug_description": "In EAP 6.4.x, example configuration \"standalone-hornetq-colocated.xml\" is in ${JBOSS_HOME}/docs/examples/configs/\nSimilar activemq alternative is missing in EAP7", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Alpha1", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.test.manualmode.parse.ParseAndMarshalModelsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 6141, "bug_title": "[Migration][WebToUndertow] Migrating access log valve results always in migration warning", "bug_description": "When migrating AccessLogValve it results in printing migration warning for attributes which are not even defined with the valve.\nThe attributes are: \"resolveHosts\", \"fileDateFormat\", \"renameOnRotate\", \"encoding\", \"locale\", \"requestAttributesEnabled\", \"buffered\".\nSuch warning should only be printed for attributes which were actually used with the valve and not when they are actually not used.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.web.test.WebMigrateTestCase.java", "org.jboss.as.web.WebMigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 6453, "bug_title": "InfinispanSessionManager#getLocalSessions should only return sessions with current node locality", "bug_description": "Stumbled upon while fixing WFLY-6294; mod_cluster is the only consumer of this at the moment.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.clustering.infinispan.spi.distribution.ConsistentHashLocality.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSessionManager.java"], "label": 1, "es_results": []}, {"bug_id": 6504, "bug_title": "[Migration operation] wrong resource address in migration warning", "bug_description": "Say I take EAP 6.4 default standalone-full.xml and add a discovery group like this:\n\n\n\n\n\n\n<subsystem xmlns=\"urn:jboss:domain:messaging:1.4\">\n\n\n\n\n    <hornetq-server>\n\n\n\n\n        ...\n\n\n\n\n        <discovery-groups>\n\n\n\n\n             <discovery-group name=\"my-discovery-group\">\n\n\n\n\n                <group-address>224.0.1.105</group-address>\n\n\n\n\n                <group-port>56789</group-port>\n\n\n\n\n             </discovery-group>\n\n\n\n\n        </discovery-groups>\n\n\n\n\n        ...\n\n\n\n\n    </hornetq-server>\n\n\n\n\n</subsystem>\n\n\n\n\n\n\nThis is the only change I make to the configuration file. Then I try to migrate the messaging subsystem, expecting a migration warning that I should use the socket-binding attribute.\nThe warning appears indeed:\n\n\n\n\n\n\n[standalone@localhost:9999 /] /subsystem=messaging:migrate\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => {\"migration-warnings\" => [\n\n\n\n\n        \"WFLYMSG0084: Can not migrate attribute group-address from resource [\n\n\n\n\n    (\\\"subsystem\\\" => \\\"messaging-activemq\\\"),\n\n\n\n\n    (\\\"server\\\" => \\\"default\\\"),\n\n\n\n\n    (\\\"discovery-group\\\" => \\\"my-discovery-group\\\")\n\n\n\n\n]. Use instead the socket-binding attribute to configure this discovery-group.\",\n\n\n\n\n        \"WFLYMSG0084: Can not migrate attribute group-port from resource [\n\n\n\n\n    (\\\"subsystem\\\" => \\\"messaging-activemq\\\"),\n\n\n\n\n    (\\\"server\\\" => \\\"default\\\"),\n\n\n\n\n    (\\\"discovery-group\\\" => \\\"my-discovery-group\\\")\n\n\n\n\n]. Use instead the socket-binding attribute to configure this discovery-group.\"\n\n\n\n\n    ]}\n\n\n\n\n}\n\n\n\n\n\n\nBut the resource addresses in the warning are wrong. They refer to the messaging-activemq subsystem, which clearly isn&apos;t what I&apos;m migrating from, it&apos;s what I&apos;m migrating to.\nI understand from the code that the DMR structure of the old subsystem model is very close to the structure of the new subsystem model, which is why these warning are produced on an already translated structure, but it generates wrong warnings.\nCC Miroslav Novak.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.messaging.logging.MessagingLogger.java", "org.jboss.as.messaging.MigrateOperation.java"], "label": 1, "es_results": []}, {"bug_id": 6576, "bug_title": "mod_cluster advertise=\"false\" does not disable advertise if there are no proxies configured", "bug_description": "\n\n\n\n\n\n17:05:56,822 INFO  [org.jboss.modcluster] (ServerService Thread Pool -- 64) MODCLUSTER000001: Initializing mod_cluster version 1.3.2.Final\n\n\n\n\n17:05:56,833 INFO  [org.jboss.modcluster] (ServerService Thread Pool -- 64) MODCLUSTER000032: Listening to proxy advertisements on /224.0.1.105:23364\n\n\n\n\n\n\n\n\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=modcluster/mod-cluster-config=configuration:read-resource\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => {\n\n\n\n\n        \"advertise\" => false,\n\n\n\n\n        \"advertise-security-key\" => undefined,\n\n\n\n\n        \"advertise-socket\" => undefined,\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.mod_cluster.ContainerEventHandlerService.java"], "label": 1, "es_results": []}, {"bug_id": 6674, "bug_title": "Infinispan subsystem cache configuration is lost when cache is created", "bug_description": "Infinispan subsystem configuration is lost when cache is created.\nIf it is helpful, I made a simple test project to validate the problem. It is prepared to run with Wildfly 8 and 10.\nhttps://github.com/arielcarrera/test-infinispan-wildfly10\nAfter startup and created the cache, it is not configured with the specified settings in Wildfly&apos;s Infinispan Subsystem. \nThis can be verified by monitoring the jboss.infinispan nodes with JConsole retrieving the cache settings or running my simple test project.\nEntities never expire/invalidate. The lifespan/max-entries are set to -1.\nI found an old issue (https://issues.jboss.org/browse/WFLY-3858) about wildfly 8 but this problem talks about a security config problem and is a little different. It is a problem about wildfly 10 configuration and it is working OK on wildfly 8.2.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.ComponentBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 6502, "bug_title": "NPE during Session.requestDone(...) when using <transaction mode=\"NONE\"/>", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.clustering.ee.infinispan.InfinispanBatcher.java"], "label": 1, "es_results": []}, {"bug_id": 6591, "bug_title": "Expired/invalidated session meta-data entries not removed when using optimistic locking or READ_COMMITTED isolation", "bug_description": "When using optimistic locking on the web cache, data from expired sessions is not removed from the web cache by the org.wildfly.clustering.web.infinispan.session.SessionExpirationScheduler and leaks forever.\nSession seems to be invalidated correctly and isn&apos;t accessible anymore.\nAfter tracing the code, org.wildfly.clustering.web.infinispan.session.InfinispanSessionMetaDataFactory.remove() doesn&apos;t remove the metadata entries when \"this.properties.isLockOnWrite()\" returns false (which is always the case for optimistic locking). Then in org.wildfly.clustering.web.infinispan.session.InfinispanSessionFactory.remove(), the call to attributesFactory.remove(id) also gets skipped.\nWe&apos;ve tried to adjust the code of org.wildfly.clustering.web.infinispan.session.InfinispanSessionMetaDataFactory.remove() to the following:\n\n\n\n\n\n\n    private boolean remove(String id, Cache<SessionCreationMetaDataKey, SessionCreationMetaDataEntry<L>> creationMetaDataCache) {\n\n\n\n\n        SessionCreationMetaDataKey key = new SessionCreationMetaDataKey(id);\n\n\n\n\n        if (this.properties.isLockOnWrite()) {\n\n\n\n\n            if (creationMetaDataCache.getAdvancedCache().withFlags(Flag.ZERO_LOCK_ACQUISITION_TIMEOUT, Flag.FAIL_SILENTLY).lock(key)) {\n\n\n\n\n                creationMetaDataCache.getAdvancedCache().withFlags(Flag.IGNORE_RETURN_VALUES).remove(key);\n\n\n\n\n                this.accessMetaDataCache.getAdvancedCache().withFlags(Flag.IGNORE_RETURN_VALUES).remove(new SessionAccessMetaDataKey(id));\n\n\n\n\n                return true;\n\n\n\n\n            }\n\n\n\n\n            return false;\n\n\n\n\n        } else {\n\n\n\n\n            creationMetaDataCache.getAdvancedCache().withFlags(Flag.IGNORE_RETURN_VALUES).remove(key);\n\n\n\n\n            this.accessMetaDataCache.getAdvancedCache().withFlags(Flag.IGNORE_RETURN_VALUES).remove(new SessionAccessMetaDataKey(id));\n\n\n\n\n            return true;\n\n\n\n\n        }\n\n\n\n\n    }\n\n\n\n\n\n\nWith that change, the memory leaks disappears.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.InfinispanSessionMetaDataFactory.java"], "label": 1, "es_results": []}, {"bug_id": 6316, "bug_title": "Deploying @Stateless EJB causes default ejb cache to start unnecessarily.", "bug_description": "This cache isn&apos;t used for anything.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.ejb3.component.stateless.StatelessComponentCreateServiceFactory.java"], "label": 1, "es_results": []}, {"bug_id": 6223, "bug_title": "Enabling statistics in web console requires reload while it does not in CLI", "bug_description": "If I want to enable statistics for Web Services subsystem, I do it in CLI:\n\n\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=webservices:write-attribute(name=statistics-enabled, value=true)\n\n\n\n\n{\"outcome\" => \"success\"}\n\n\n\n\n\n\nVia web console, I navigate to Configuration->Subsystems->Web Services->View\nI click edit and click checkbox for statistics enabled attribute. Now when I submit the value by clicking Save, dialog appears with reload require information.\nThere is no need to require reload just for enabling statistics, by the way statistics are accessible even before reload (Runtime->Subsystems->Webservices and try to get wsdl for the web service for several times).\nNote: if there is no active deployment, reload is not required in web console (correct). To reproduce the issue you must have some active WS deployment", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.webservices.dmr.WSServerConfigAttributeHandler.java"], "label": 1, "es_results": []}, {"bug_id": 6685, "bug_title": "Cache container enable statistics can lead to classloader leak", "bug_description": "In standalone.xml, if we enable statistics such as:\n\n\n\n\n\n\n            <cache-container name=\"web\" default-cache=\"repl\" module=\"org.wildfly.clustering.web.infinispan\" statistics-enabled=\"true\">\n\n\n\n\n                <transport lock-timeout=\"60000\"/>\n\n\n\n\n                <replicated-cache name=\"repl\" statistics-enabled=\"true\" mode=\"ASYNC\">\n\n\n\n\n                    <locking isolation=\"READ_COMMITTED\"/>\n\n\n\n\n                    <transaction locking=\"OPTIMISTIC\" mode=\"BATCH\"/>\n\n\n\n\n                    <state-transfer chunk-size=\"512\" timeout=\"240000\"/>\n\n\n\n\n                </replicated-cache>\n\n\n\n\n            </cache-container>\n\n\n\n\n\n\nThe following MBean:\n\n\n\n\n\n\njboss.infinispan:cluster=web,type=channel\n\n\n\n\n\n\nis getting eventually registered when deploying any application.\nWhen undeploying that application, the MBean is not getting unregistered and thus can leak pretty much anything.\nAlso, if you try to deploy the very same application right after another MBean will get registered:\n\n\n\n\n\n\njboss.infinispan2:cluster=web,type=channel\n\n\n\n\n\n\nNote: cache enable-statistics=true doesn&apos;t seems to leak anything.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.clustering.infinispan.ChannelTransport.java"], "label": 1, "es_results": []}, {"bug_id": 6680, "bug_title": ":read-proxies-configuration and :read-proxies-info fail when at least one of the proxies is unreachable", "bug_description": "When the modcluster subsystem is unable to connect to a proxy, the jboss-cli commands :read-proxies-configuration and :read-proxies-info fail with an unhelpful error.\nOn both the domain controller and application host, :read-proxies-info and :read-proxies-configuration fail with the same error.  This is the output from the application host:\n\n\n\n\n\n\n[domain@localhost:9999 subsystem=modcluster] pwd\n\n\n\n\n/host=localhost/server=cluster2/subsystem=modcluster\n\n\n\n\n\n\n\n\n\n[domain@localhost:9999 subsystem=modcluster] :list-proxies\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [\n\n\n\n\n        \"web02:8009\",\n\n\n\n\n        \"web01:8009\"\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n[domain@localhost:9999 subsystem=modcluster] :read-proxies-configuration\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"result\" => undefined,\n\n\n\n\n    \"failure-description\" => \"JBAS014749: Operation handler failed: newValue is null\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n[domain@localhost:9999 subsystem=modcluster] :read-proxies-info\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"result\" => undefined,\n\n\n\n\n    \"failure-description\" => \"JBAS014749: Operation handler failed: newValue is null\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\nIn the above example, modcluster was not able to connect to the proxies due to an ssl misconfiguration in the modcluster subsystem in domain.xml.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.mod_cluster.ModClusterGetProxyInfo.java", "org.wildfly.extension.mod_cluster.ModClusterGetProxyConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 6376, "bug_title": "Class loader leak due to Infinispan ExpirationManagerImpl", "bug_description": "Scenario\nGiven a WAR containing a persistence unit with second level cache and query cache enabled, I&apos;m consistently hitting a Metaspace OutOfMemoryError after redeploying the unchanged application a couple of times.\nAnalyzing the situation with Eclipse Memory Analyzer, I found one because to be WFLY-6348, but even after applying that fix locally, I&apos;m still having a Classloader leak which I can trace to a thread used by Infinispan referencing an obsolete web app classloader as context classloader.\nJust to rule out that this might be related to WFLY-6283, WFLY-6285, I repeated my experiments with a local build of WildFly master (2f11a59aee0dbdd52b65c5c684eafa83c3f418da), with Hibernate locally upgraded to 5.0.9.\nI&apos;m still getting a classloader leak with that build.\nAnalysis\norg.infinispan.expiration.impl.ExpirationManagerImpl uses a LazyInitializingScheduledExecutorService. Due to lazy initialization, the ExecutorService and the underlying thread pool is not created until my web app is deployed. Thus, when the ExecutorService is created, the context class loader is set to the web app class loader, and this appears to propagate to the threads of the executor thread pool.\nWhen the application is undeployed, ExpirationManagerImpl.stop() gets invoked to cancel any running expiration task. However, the ExecutorService is not shut down, the threads remain alive and still keep a reference to the now obsolete context classloader.\nRemarks\nI&apos;m not sure if this analysis is correct, at least I hope there&apos;s a clue for WildFly and Infinispan experts to identify the real because.\nBy the way, it would be helpful if all threads created by Infinispan had meaningful names, rather than default names like pool-5-thread-1.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.ScheduledThreadPoolBuilder.java", "org.jboss.as.clustering.jgroups.JChannelFactory.java", "org.jboss.as.clustering.infinispan.subsystem.ThreadPoolBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 6667, "bug_title": "Servlet attributes are not availble in undertow-handlers.conf as it runs too early", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java", "org.jboss.as.test.integration.web.handlers.UndertowHandlersConfigTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 6405, "bug_title": "Performance: WeldDeployment.getBeanDeploymentArchive method is synchronized", "bug_description": "(Wildfly 10.0.0.FINAL)\nDuring the performance test of my app (50 concurrent users with jmeter) I am running into the following issue:\nThere are locked threads in the method WeldDeployment.getBeanDeploymentArchive(). Looking the code, this method is synchronized, so it makes sense. The question is, is this the expected behavior or this is a bug. In both cases is there any workaround to overcome this limitation?\nSTACK TRACE:\n....\norg.jboss.as.weld.WeldProvider$CdiImpl.getBeanManager():73\norg.jboss.as.weld.WeldProvider$CdiImpl.getBeanManager():93\norg.jboss.as.weld.deployment.WeldDeployment.getBeanDeploymentArchive():226 ", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.weld.deployment.WeldDeployment.java"], "label": 1, "es_results": []}, {"bug_id": 6025, "bug_title": "org.wildfly.clustering.server.dispatcher needs to account for security manager", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.clustering.server.dispatcher.LocalCommandDispatcher.java"], "label": 1, "es_results": []}, {"bug_id": 6434, "bug_title": "System property 'org.jboss.as.security.jacc-module' not always used", "bug_description": "JaccService of security subsystem does not use the system property &apos;org.jboss.as.security.jacc-module&apos; for class loader.\nDue to this \"not using\", the custom JACC module is not used.\nThis property was introduced by WFLY-5340", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.security.service.JaccService.java"], "label": 1, "es_results": []}, {"bug_id": 6740, "bug_title": "resources for messaging paths are not created in domain's profile", "bug_description": "Reading or modyfing of journal paths via CLI is not possible in domain. If you list the journal paths via CLI, you get an empty result. Configuring of journal paths is necessary if you want to have more Artemis servers in one EAP.\n\n\n\n\n\n\nls /profile=full/subsystem=messaging-activemq/server=default/path=\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.messaging.activemq.ServerAdd.java"], "label": 1, "es_results": []}, {"bug_id": 5464, "bug_title": "JDR report contains reference to AS7", "bug_description": "Description of problem:\n JDR report contains some legacy reference to AS7\nHow reproducible:\n Always\nSteps to Reproduce:\n\nCreate a JDR report using one of provided scripts (depends on OS)\nCheck the created report\n\t\ncd $JDR_LOCATION\nfind | grep as7\n\n\n\nActual results:\n\n\n\n\n\n\n./jdr_15-10-02_04-28-03_dhcp-10-40-5-38/sos_strings/as7\n\n\n\n\n./jdr_15-10-02_04-28-03_dhcp-10-40-5-38/sos_strings/as7/configuration.json\n\n\n\n\n./jdr_15-10-02_04-28-03_dhcp-10-40-5-38/sos_strings/as7/tree.txt\n\n\n\n\n./jdr_15-10-02_04-28-03_dhcp-10-40-5-38/sos_strings/as7/dump-services.json\n\n\n\n\n./jdr_15-10-02_04-28-03_dhcp-10-40-5-38/sos_strings/as7/deployment-dependencies.txt\n\n\n\n\n./jdr_15-10-02_04-28-03_dhcp-10-40-5-38/sos_strings/as7/jarcheck.txt\n\n\n\n\n./jdr_15-10-02_04-28-03_dhcp-10-40-5-38/sos_strings/as7/cluster-proxies-configuration.json\n\n\n\n\n./jdr_15-10-02_04-28-03_dhcp-10-40-5-38/sos_strings/as7/local-module-dependencies.txt\n\n\n\n\n./jdr_15-10-02_04-28-03_dhcp-10-40-5-38/sos_strings/as7/system-properties.txt\n\n\n\n\n./jdr_15-10-02_04-28-03_dhcp-10-40-5-38/sos_strings/as7/jndi-view.json\n\n\n\n\n\n\nExpected results:\nNo references to AS7", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR2", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.jdr.commands.JdrEnvironment.java", "org.jboss.as.jdr.util.JdrZipFile.java", "org.jboss.as.jdr.JdrRunner.java"], "label": 1, "es_results": []}, {"bug_id": 6754, "bug_title": "Bindings of most binding-types can not be created in naming subsystem configuration in Web Console", "bug_description": "When adding bindings in naming subsystem configuration of Web Console, the Add form has wrong mandatory fields. Mandatory fields for bindings are dependent on binding type. \nOn the other hand, some binding types do not have attributes that the Add form will try to send to the interface, resulting in user being unable to add any binding type besides external context (for example, adding a simple or lookup binding will result in Unknown error due to simple binding type not being able to have &apos;cache&apos; attribute).\nFor example, /subsystem=naming/binding=java\\:global\\/a:add(binding-type=simple, type=int, value=100) would be a legal simple binding inserted through the JBoss CLI:\n\n\n\n\n\n\n{\"outcome\" => \"success\"}\n\n\n\n\n\n\nAdding this same following binding will produce the following error output in Web Console:\nUnknown error\nUnexpected HTTP response: 500\nRequest\n\n\n\n\n\n\n{\n\n\n\n\n    \"name\" => \"java:global/a\",\n\n\n\n\n    \"binding-type\" => \"simple\",\n\n\n\n\n    \"cache\" => false,\n\n\n\n\n    \"class\" => undefined,\n\n\n\n\n    \"environment\" => undefined,\n\n\n\n\n    \"lookup\" => undefined,\n\n\n\n\n    \"module\" => undefined,\n\n\n\n\n    \"type\" => \"int\",\n\n\n\n\n    \"value\" => \"100\",\n\n\n\n\n    \"operation\" => \"add\",\n\n\n\n\n    \"address\" => [\n\n\n\n\n        (\"subsystem\" => \"naming\"),\n\n\n\n\n        (\"binding\" => \"java:global/a\")\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n\nResponse\nInternal Server Error\n\n\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"WFLYNAM0061: Binding type simple can not take a &apos;cache&apos; attribute\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.naming.subsystem.NamingBindingResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 6579, "bug_title": "When JASPIC's register session is used, Subject not propagated to EJB", "bug_description": "When the JASPIC 1.1 register session (javax.servlet.http.registerSession) is used, the authenticated identity (via the Subject) is not propagated to the EJB container.\nThe problems seems to be with JASPICAuthenticationMechanism.createAccount. When a cached account is re-used, a null is passed for the Subject parameter in the call to jbossSct.getUtil().createSubjectInfo. This will set indeed set a SubjectInfo with subject being null.\nEJBContext#getCallerPrincipal checks exactly this subject, and when seeing a null will consider the user to be unauthenticated, even when the caller is authenticated in the web layer.\nSee the code below:\n\n\n\n\n\n\n   // SAM handled the same principal found in the cached account: indicates we must use the cached account.\n\n\n\n\n        if (cachedAccount != null && cachedAccount.getPrincipal() == userPrincipal) {\n\n\n\n\n            // populate the security context using the cached account data.\n\n\n\n\n            jbossSct.getUtil().createSubjectInfo(\n\n\n\n\n                userPrincipal, ((AccountImpl) cachedAccount).getCredential(), \n\n\n\n\n                null); // PROBLEMATIC NULL\n\n\n\n\n            RoleGroup roleGroup = new SimpleRoleGroup(SecurityConstants.ROLES_IDENTIFIER);\n\n\n\n\n            for (String role : cachedAccount.getRoles())\n\n\n\n\n                roleGroup.addRole(new SimpleRole(role));\n\n\n\n\n            jbossSct.getUtil().setRoles(roleGroup);\n\n\n\n\n            return cachedAccount;\n\n\n\n\n        }\n\n\n\n\n\n\nInstead of passing a null, passing the existing subject as set by the JASPIC callback handler seems to work:\n\n\n\n\n\n\njbossSct.getUtil().createSubjectInfo(\n\n\n\n\n    userPrincipal, ((AccountImpl) cachedAccount).getCredential(), \n\n\n\n\n    jbossSct.getUtil().getSubject());\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.security.jaspi.JASPICAuthenticationMechanism.java"], "label": 1, "es_results": []}, {"bug_id": 6787, "bug_title": "WebSockets compression should be allowed by default", "bug_description": "In EAP 6.4 there was allowed WebSockets compression by default if requested by client. In EAP 7 it is not. I believe it should be also allowed by default in EAP 7.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java"], "label": 1, "es_results": []}, {"bug_id": 6838, "bug_title": "RPCs to non-existant FORK channel are dropped", "bug_description": "RPCs sent to a FORK channel that is not currently running are not responded to correctly, causing the caller to eventually time out.\nAn error response is being sent by org.jboss.as.clustering.jgroups.JChannelFactory, but the request ID is hard-coded to 0 so the reply can not be routed back to the sender and gets dropped.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.clustering.jgroups.JChannelFactory.java"], "label": 1, "es_results": []}, {"bug_id": 6561, "bug_title": "EJB Timers Intermittently Execute Repeatedly on Server Restart with Error Code WFLYEJB0043", "bug_description": "On Wildfly10, we are experiencing intermittent problems where on server startup, an @Timeout annotated method can be executed hundreds of times in a second (log below).  Going through the references to the @Timeout methods and the @Scheduled methods, all scheduled methods are set to be non-persistent (ex: timerConfig.setPersistent(false), persistent=false) so we don&apos;t know how this could occur.  It is not consistent and our only solution has been to kill the Wildfly10 server process and restart.\n13:47:27,824 WARN  [org.jboss.as.ejb3] (EJB default - 6) [  ] WFLYEJB0043: A previous execution of timer [id=d31eb95a-3f8b-4b7d-882e-f1ff53bc7de8 timedObjectId=synergy.synergy-app-head.QuartzWatcherService auto-timer?:false persistent?:false timerService=org.jboss.as.ejb3.timerservice.TimerServiceImpl@dec94c6 initialExpiration=null intervalDuration(in milli sec)=0 nextExpiration=Wed Apr 06 12:10:00 PDT 2016 timerState=IN_TIMEOUT info=null] is still in progress, skipping this overlapping scheduled execution at: Wed Apr 06 13:47:27 PDT 2016.\n13:47:27,825 WARN  [org.jboss.as.ejb3] (EJB default - 96) [  ] WFLYEJB0043: A previous execution of timer [id=d31eb95a-3f8b-4b7d-882e-f1ff53bc7de8 timedObjectId=synergy.synergy-app-head.QuartzWatcherService auto-timer?:false persistent?:false timerService=org.jboss.as.ejb3.timerservice.TimerServiceImpl@dec94c6 initialExpiration=null intervalDuration(in milli sec)=0 nextExpiration=Wed Apr 06 12:10:00 PDT 2016 timerState=IN_TIMEOUT info=null] is still in progress, skipping this overlapping scheduled execution at: Wed Apr 06 13:47:27 PDT 2016.\n13:47:27,825 WARN  [org.jboss.as.ejb3] (EJB default - 97) [  ] WFLYEJB0043: A previous execution of timer [id=d31eb95a-3f8b-4b7d-882e-f1ff53bc7de8 timedObjectId=synergy.synergy-app-head.QuartzWatcherService auto-timer?:false persistent?:false timerService=org.jboss.as.ejb3.timerservice.TimerServiceImpl@dec94c6 initialExpiration=null intervalDuration(in milli sec)=0 nextExpiration=Wed Apr 06 12:10:00 PDT 2016 timerState=IN_TIMEOUT info=null] is still in progress, skipping this overlapping scheduled execution at: Wed Apr 06 13:47:27 PDT 2016.\n13:47:27,825 WARN  [org.jboss.as.ejb3] (EJB default - 37) [  ] WFLYEJB0043: A previous execution of timer [id=d31eb95a-3f8b-4b7d-882e-f1ff53bc7de8 timedObjectId=synergy.synergy-app-head.QuartzWatcherService auto-timer?:false persistent?:false timerService=org.jboss.as.ejb3.timerservice.TimerServiceImpl@dec94c6 initialExpiration=null intervalDuration(in milli sec)=0 nextExpiration=Wed Apr 06 12:10:00 PDT 2016 timerState=IN_TIMEOUT info=null] is still in progress, skipping this overlapping scheduled execution at: Wed Apr 06 13:47:27 PDT 2016.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.ejb3.timerservice.schedule.CalendarBasedTimeout.java"], "label": 1, "es_results": []}, {"bug_id": 6215, "bug_title": "SessionSynchronization callbacks allow concurrent access to SFSB", "bug_description": "Issue first encountered by customer in EAP5 (JBPAPP-11239).\nAssume a local SFSB, B1, with container managed transactions and a calling SFSB, B2, which has bean managed transactions.  B1 implements the SessionSynchronization interface.  \nWhen B2&apos;s bean managed transaction timesout whilst executing B1.exampleMethod(), B2&apos;s transaction aborts and the transaction reaper thread calls B1.afterCompletion().  However, the original worker thread that was executing B1.exampleMethod() continues to execute B1.exampleMethod() until it has completed.  Hence it is possible for the B1 SFSB to be accessed concurrently.  It is also possible for B1.afterCompletion() to finish executing before B1.exampleMethod().", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.ejb3.component.stateful.StatefulSessionSynchronizationInterceptor.java", "org.jboss.as.ejb3.component.stateful.StatefulComponentInstanceInterceptor.java", "org.jboss.as.ejb3.component.stateful.StatefulSessionComponentInstance.java", "org.jboss.as.ejb3.component.stateful.StatefulSessionComponent.java", "org.jboss.as.ejb3.logging.EjbLogger.java"], "label": 1, "es_results": []}, {"bug_id": 6550, "bug_title": "Invalid use of ModuleIdentifier.create(String) for dynamic names prevents use of slots", "bug_description": "The ModuleIdentifier.create(String) method is a convenience method for creating an id with a slot of \"main\". Using this method for user-provided module names prevents the user from encoding a slot into their string. Better is to use ModuleIdentifier.fromString(String) which will parse out a slot if present.\nWFCORE-1499 is due to this problem; reviewing the PR for it led me to investigate core and full for other occurrences. Found a few.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.connector.subsystems.datasources.JdbcDriverRemove.java", "org.wildfly.extension.messaging.activemq.jms.bridge.JMSBridgeService.java", "org.wildfly.extension.messaging.activemq.jms.bridge.JMSBridgeAdd.java", "org.wildfly.extension.undertow.deployment.UndertowHandlersDeploymentProcessor.java", "org.wildfly.extension.security.manager.SecurityManagerSubsystemAdd.java", "org.wildfly.extension.picketlink.idm.model.PartitionManagerAddHandler.java", "org.wildfly.extension.messaging.activemq.ServerAdd.java", "org.wildfly.extension.picketlink.idm.config.JPAStoreSubsystemConfiguration.java"], "label": 1, "es_results": []}, {"bug_id": 5696, "bug_title": "Mixed domain test launches a broken server from the DC", "bug_description": "The host.xml used by the DC in the testsuite/mixed-domain tests is launching a server. This server fails to launch because the profiles being used include stuff that won&apos;t work on current version servers (i.e. legacy subsystems like web).\nThe failure to launch the server isn&apos;t affecting the test results, proving the existence of the server is not relevant to the test assertions.\nHowever, WildcardReadsTestCase is asserting that the wildcard reads are able to read this server, so we need to decide how to proceed. Simply dropping the \"server\" element from host.xml doesn&apos;t work.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.test.integration.domain.mixed.WildcardReadsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 6879, "bug_title": "Parsing logic in EJB3Subsystem30Parser#parseRemotingReceiver ignores unparseable attributes instead of exception", "bug_description": "We do throw exception when unparseable data is found.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.ejb3.subsystem.EJB3Subsystem30Parser.java"], "label": 1, "es_results": []}, {"bug_id": 6099, "bug_title": "JPA's persistence.xml is deployed before datasources are created through application.xml", "bug_description": "Please refer to discussion\nhttps://developer.jboss.org/thread/267371", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.jpa.config.Configuration.java"], "label": 1, "es_results": []}, {"bug_id": 6857, "bug_title": "Infinispan subsystem writes incorrect xml namespace when system locale is not English", "bug_description": "Running the server under a non-English Locale and using the CLI to create resources, leads to Infinispan writing out a subsystem configuration which doesn&apos;t load on server reload.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.InfinispanSchema.java"], "label": 1, "es_results": []}, {"bug_id": 6228, "bug_title": "Component upgrade Hibernate Validator to 5.2.4.Final", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.test.integration.beanvalidation.hibernate.validator.CarGroupSequenceProvider.java"], "label": 1, "es_results": []}, {"bug_id": 6033, "bug_title": "enable JPA entity class transformation if any of the new Hibernate enhancer properties are enabled", "bug_description": "See new Hibernate properties at https://github.com/hibernate/hibernate-orm/commit/809e3cf4b9eda5c8922bb8a04292dbd29aa3c793.\nNew properties that influence entity class transformation are:\n\nhibernate.enhancer.enableDirtyTracking\nhibernate.enhancer.enableLazyInitialization\nhibernate.enhancer.enableAssociationManagement\nIf any of the above properties are true, it is the same as the application setting jboss.as.jpa.classtransformer=true.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR5", "fixed_version": "10.1.0.CR1", "fixed_files": ["org.jboss.as.jpa.config.Configuration.java"], "label": 1, "es_results": []}, {"bug_id": 6304, "bug_title": "Remoting login module's certificate propagation uses the old certificate API but should be using the new API instead", "bug_description": "RemotingLoginModule propagates javax.security.cert.X509Certificate but should use the newer API java.security.cert.X509Certificate. \nDavid proposed the following:\nThe problem is at org.jboss.as.security.remoting.RemotingLoginModule line 126: session.getPeerCertificateChain() is called where session.getPeerCertificates() should be.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.security.remoting.RemotingLoginModule.java"], "label": 1, "es_results": []}, {"bug_id": 7000, "bug_title": "Batch jobs from installed modules should be detected for non-batch app", "bug_description": "Hibernate Search is creating a batch job which embedded in a WildFly module. Any user of Hibernate Search should be able to the launch this batch job, no matter if they&apos;re using a batch-app. However, it seems that jobs are only resolvable for batch-app. More explicitly, WildFly requires deployed web-app to have the below structure to enable the job resolver:\n    META-INF/batch-jobs\nFor those who don&apos;t have this batch folder in their webapp, they cannot use the jobs from installed module. And an error \"JBERET000601: Failed to get job xml file for job\" will be raised.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.batch.jberet.deployment.WildFlyJobXmlResolver.java"], "label": 1, "es_results": []}, {"bug_id": 5661, "bug_title": "Enable CCM for jta=false", "bug_description": "Currently AbstractDataSourceAdd doesn&apos;t add the CCM service for jta=false deployments, which could work if applications rely on the CCM boundaries.\nFor both jta=true and jta=false deployments the dependency should be guarded with a \"if (useCCM)\"", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.CR4", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.connector.subsystems.jca.ListOfConnectionsHandler.java", "org.jboss.as.connector.deployers.ra.processors.ParsedRaDeploymentProcessor.java", "org.jboss.as.connector.subsystems.jca.CachedConnectionManagerAdd.java", "org.jboss.as.connector.deployers.ra.processors.CachedConnectionManagerSetupProcessor.java", "org.jboss.as.connector.logging.ConnectorLogger.java", "org.jboss.as.connector.subsystems.jca.Constants.java", "org.jboss.as.connector.subsystems.datasources.AbstractDataSourceAdd.java", "org.jboss.as.connector.util.ConnectorServices.java", "org.jboss.as.connector.subsystems.jca.GetNumberOfConnectionsHandler.java"], "label": 1, "es_results": []}, {"bug_id": 6564, "bug_title": "show-resources operation of jaxrs subsystem shows wrong path in resource-methods attribute", "bug_description": "Description of problem:\nShow-resources operation of jaxrs subsystem shows wrong path in resource-methods attribute. There are double slash in path. Eg.: \"/jaxrs-eap//sample\", but correct path is \"/jaxrs-eap/sample\" (http://localhost:8080/jaxrs-eap/sample) \nThis operation was added by WFLY-3045.\nHow reproducible:\nAlways\nSteps to Reproduce:\n\n./standalone.sh\ndeploy /home/mkopecky/playground/resteasy/single-application/target/jaxrs-eap.war\n/deployment=jaxrs-eap.war/subsystem=jaxrs:show-resources\n\nActual results:\n\n\n\n\n\n\n...\n\n\n\n\n\"resource-methods\" => [\"GET /jaxrs-eap//sample - org.resteasy.simple.deployment.AdvancedService.get()\"]\n\n\n\n\n...\n\n\n\n\n\n\nExpected results:\n\n\n\n\n\n\n...\n\n\n\n\n\"resource-methods\" => [\"GET /jaxrs-eap/sample - org.resteasy.simple.deployment.AdvancedService.get()\"]\n\n\n\n\n...\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.jaxrs.JaxrsDeploymentDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 5239, "bug_title": "XSiteSimpleTestCase.testPutRelayedToBackups intermittently fails in ~5% cases with \"no physical address for\"", "bug_description": "I have done some work to stabilize this test a little more by switching both stacks (default stack and the bridge stack) to tcp. This does not help the test completely, it still fails with the well known:\n\n\n\n\n\n\nrhusar\t\t&amp#27;[0m&amp#27;[0m15:14:52,808 INFO  [org.jboss.as.server] (management-handler-thread - 4) WFLYSRV0010: Deployed \"xsite.war\" (runtime-name : \"xsite.war\")\n\n\n\n\n&amp#27;[0mExecuting HTTP request: http://[::1]:8080/xsite/cache?operation=put&key=a&value=100\n\n\n\n\n&amp#27;[33m15:14:53,513 WARNING [org.jgroups.protocols.TCP] (TransferQueueBundler,ee,LON-1) JGRP000032: LON-1: no physical address for a9d43ee2-698a-fbab-2ed8-fb54009f7af4, dropping message\n\n\n\n\n&amp#27;[0m&amp#27;[33m15:14:55,581 WARNING [org.jgroups.protocols.TCP] (TransferQueueBundler,ee,LON-1) JGRP000032: LON-1: no physical address for a9d43ee2-698a-fbab-2ed8-fb54009f7af4, dropping message\n\n\n\n\n&amp#27;[0m&amp#27;[33m15:14:57,583 WARNING [org.jgroups.protocols.TCP] (TransferQueueBundler,ee,LON-1) JGRP000032: LON-1: no physical address for a9d43ee2-698a-fbab-2ed8-fb54009f7af4, dropping message\n\n\n\n\n&amp#27;[0m&amp#27;[33m15:14:59,584 WARNING [org.jgroups.protocols.TCP] (TransferQueueBundler,ee,LON-1) JGRP000032: LON-1: no physical address for a9d43ee2-698a-fbab-2ed8-fb54009f7af4, dropping message\n\n\n\n\n&amp#27;[0m&amp#27;[33m15:15:01,585 WARNING [org.jgroups.protocols.TCP] (TransferQueueBundler,ee,LON-1) JGRP000032: LON-1: no physical address for a9d43ee2-698a-fbab-2ed8-fb54009f7af4, dropping message\n\n\n\n\n&amp#27;[0m&amp#27;[33m15:15:03,277 WARN  [org.infinispan.xsite.BackupSenderImpl] (default task-1) ISPN000202: Problems backing up data for cache dist to site NYC: org.infinispan.util.concurrent.TimeoutException: Timed out after 10 seconds waiting for a response from NYC (sync, timeout=10000)\n\n\n\n\n&amp#27;[0mExecuted HTTP request\n\n\n\n\n&amp#27;[33m15:15:03,586 WARNING [org.jgroups.protocols.TCP] (TransferQueueBundler,ee,LON-1) JGRP000032: LON-1: no physical address for a9d43ee2-698a-fbab-2ed8-fb54009f7af4, dropping message\n\n\n\n\n&amp#27;[0m&amp#27;[33m15:15:05,591 WARNING [org.jgroups.protocols.TCP] (TransferQueueBundler,ee,LON-1) JGRP000032: LON-1: no physical address for a9d43ee2-698a-fbab-2ed8-fb54009f7af4, dropping message\t\t\t17:02\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Beta2", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.test.clustering.xsite.XSiteSimpleTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 7240, "bug_title": "CacheRegistry is missing entries (e.g. client mappings) following a merge after a cluster split", "bug_description": "One of the manifestation of the issue:\n\nstart 2 nodes with SLSB with TUNNEL transport\nstart both nodes creating 2 clusters (or partitions)\nstart ejb client\nstart GossipRouter and wait for merge\nejb client keeps talking only to known node; never receives a topology update\n\nThis is because org.wildfly.clustering.server.registry.CacheRegistry#topologyChanged does not handle cluster merges and thus all entries from a given partition will be lost forever.\nThe effects are especially missing client mappings and broken session stickiness. ", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.clustering.server.provider.CacheServiceProviderRegistryBuilderProvider.java", "org.wildfly.clustering.server.registry.CacheRegistry.java"], "label": 1, "es_results": []}, {"bug_id": 6491, "bug_title": "Undertow subsystem is misleading about listener capabilities", "bug_description": "ListenerResourceDefinition registers the LISTENER_CAPABILITY regardless of the value of the &apos;enabled&apos; attribute. But the contract provided by that capability is only fulfilled if the attribute is &apos;true&apos;.\nEven worse, the attribute supports expressions, which can only be reliably resolved in Stage.RUNTIME, which is too late for recording a capability.\nFortunately, it&apos;s vault resolution that makes it necessary to resolve in RUNTIME and reality is people are highly unlikely to use the vault for this expression, so we can try and resolve and hope for the best.\nThis enabled stuff is just the worst. DON&apos;T USE THIS CONCEPT IN YOUR MODEL!", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.undertow.ListenerResourceDefinition.java", "org.wildfly.extension.undertow.ListenerService.java", "org.wildfly.extension.undertow.ListenerAdd.java"], "label": 1, "es_results": []}, {"bug_id": 6268, "bug_title": "There is no validation of some of messaging server attributes", "bug_description": "There is no validation of some attributes of messaging provider. Setting of these attributes to non valid value causes an error during next reload. Some of these attributes are: journal-file-size or journal-compact-percentage.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.messaging.activemq.ServerDefinition.java", "org.wildfly.extension.messaging.activemq.logging.MessagingLogger.java"], "label": 1, "es_results": []}, {"bug_id": 6653, "bug_title": "The default min and max pool size of -1 is confusing. ", "bug_description": "The default values for min and max pool size are confusing\n\"max-pool-size\" => -1,\n\"min-pool-size\" => -1,\nThey should either say default\n\"max-pool-size\" => default,\n\"min-pool-size\" => default,\nor display the default JCA values which I believe are 2 and 20\n\"max-pool-size\" => 20,\n\"min-pool-size\" => 2,", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.messaging.activemq.jms.ConnectionFactoryAttributes.java", "org.wildfly.extension.messaging.activemq.MessagingSubsystemRootResourceDefinition.java", "org.jboss.as.test.integration.messaging.jms.definitions.JMSResourceManagementTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 6200, "bug_title": "connection-url is required even when not used", "bug_description": "Per the comments on WFLY-6157 and WFLY-6198, connection-url is ignored in a datasource if datasource-class is defined. However, connection-url is currently mandatory. If it is not present, WildFly fails to start:\n\n\n\n\n\n\n09:51:18,216 ERROR [org.jboss.as.controller.management-operation] (ServerService Thread Pool -- 8) WFLYCTL0013: Operation (\"add\") failed - address: ([\n\n\n\n\n    (\"subsystem\" => \"datasources\"),\n\n\n\n\n    (\"data-source\" => \"GamingPortalDS\")\n\n\n\n\n]) - failure description: \"WFLYCTL0155: connection-url may not be null\"\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.connector.subsystems.datasources.DataSourcesSubsystemRootDefinition.java", "org.jboss.as.test.integration.jca.datasource.DatasourceEnableAttributeTestCase.java", "org.jboss.as.connector.subsystems.datasources.Constants.java", "org.jboss.as.connector.subsystems.datasources.DataSourceDefinition.java", "org.jboss.as.test.integration.jca.datasource.Datasource.java", "org.jboss.as.connector.subsystems.datasources.DataSourcesExtension.java", "org.jboss.as.connector.subsystems.datasources.DatasourcesSubsystemTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 6906, "bug_title": "Silence \"ISPN000152: Passivation configured without an eviction policy being selected. Only manually evicted entities will be passivated.\"", "bug_description": "Integrate MANUAL eviction strategy introduced in ISPN-6911.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.EvictionResourceDefinition.java", "org.jboss.as.clustering.controller.validation.EnumValidatorBuilder.java", "org.jboss.as.clustering.infinispan.subsystem.EvictionBuilder.java"], "label": 1, "es_results": []}, {"bug_id": 6776, "bug_title": "Unclear error message when creating multiple thread pools of the same type for a workmanager", "bug_description": "When there is already a long-running thread pool for a work manager and you try to create another one:\n/subsystem=jca/workmanager=default/long-running-threads=custom:add(max-threads=30, queue-length=30)\nyou only get an opaque error message:\n\"failure-description\" => \"WFLYCTL0086: Failed to persist configuration change: WFLYCTL0084: Failed to marshal configuration\", with a, also useless, java.lang.IllegalArgumentException in the server log.\nIt should be more obvious that the error is that you cannot create two long-running thread pools", "project": "Wildfly", "sub_project": "WFLY", "version": "10.0.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.connector.subsystems.jca.JcaWorkManagerDefinition.java", "org.jboss.as.connector.logging.ConnectorLogger.java", "org.jboss.as.connector.subsystems.jca.JcaDistributedWorkManagerDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 6902, "bug_title": "Undertow mod_cluster: Multiinterface box: Manager-Address always contains hostname", "bug_description": "On a multi-interface Windows box\nEven though the EAP balancer instance is bound to an IP address, 10.40.128.61 in this case:\n\n\n\n\n\n\n    <interfaces>\n\n\n\n\n        <interface name=\"management\">\n\n\n\n\n            <inet-address value=\"10.40.128.61\"/>\n\n\n\n\n        </interface>\n\n\n\n\n        <interface name=\"public\">\n\n\n\n\n            <inet-address value=\"10.40.128.61\"/>\n\n\n\n\n        </interface>\n\n\n\n\n    </interfaces>\n\n\n\n\n\n, it advertises a hostname as its Manager-Address. The receiving worker node then might have troubles calling the balancer if it translates the hostname to a different IP address (interface on the same box...):\nBalancer:\n\n\n\n\n\n\n2016-04-28 18:00:00,232 DEBUG [io.undertow] (default I/O-2) UT005040: Going To send payload:\n\n\n\n\nHTTP/1.0 200 OK\n\n\n\n\nDate: Thu, 28 Apr 2016 18:00:00 -0700\n\n\n\n\nSequence: 11\n\n\n\n\nDigest: d356f44c4372f38eeb064e214b61b3e0\n\n\n\n\nServer: 73a81e63-9938-42ce-bd17-92e2aeef3991\n\n\n\n\nX-Manager-Address: atomic-0.yada.bla.bla.redhat.com:8847\n\n\n\n\nX-Manager-Url: /\n\n\n\n\nX-Manager-Protocol: https\n\n\n\n\nX-Manager-Host: atomic-0.yada.bla.bla.redhat.com\n\n\n\n\n\n\nWorker:\n\n\n\n\n\n\nMODCLUSTER000043: Failed to send INFO command to atomic-0.yada.bla.bla.redhat.com/169.254.47.37:8847: Connection refused: connect\n\n\n\n\n\n\ni.e. instead of using  10.40.128.61 the balancer is bound to, worker tries to call anotehr interface and fails.\nSuggestion: If user explicitly uses IP address instead of a hostname, it should be either honoured or at least explicitly configurable for the Manager-Address attribute. IMHO.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.CR1", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.undertow.filters.ModClusterService.java"], "label": 1, "es_results": []}, {"bug_id": 6950, "bug_title": "JacORBSubsystemParser should create an OBJECT param for an OBJECT attribute", "bug_description": "The parser when parsing \"properties\" elements is producing a DMR param of ModelType.LIST of ModelType.PROPERTY instead of a param of ModelType.OBJECT, which is how the attribute is specified. This works ok although it results in storing the attribute value in non-canonical format. But this behavior blocks completion of WFCORE-1581 because it results in test failures once WFCORE-1581 is implemented. Tests that compare the model structure generated by a current version controller when it executes the parser&apos;s ops fail as that structure doesn&apos;t match what a legacy version controller produces. The mismatch is largely harmless, but it&apos;s much simpler to correct the parser than to code a workaround into the tests. Plus the parser is just wrong.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.CR1", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.jacorb.JacORBSubsystemParser.java"], "label": 1, "es_results": []}, {"bug_id": 6969, "bug_title": "Intermittent failures in Concurrent*WebFailoverTestCase following change to default consistent hash", "bug_description": "See: https://ci.wildfly.org/project.html?tab=testDetails&projectId=WF_PullRequest&testNameId=2516785978928573613", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.CR1", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.test.clustering.cluster.web.ReplicationForNegotiationAuthenticatorTestCase.java", "org.jboss.as.test.clustering.cluster.web.FineWebFailoverTestCase.java", "org.wildfly.clustering.infinispan.spi.distribution.Key.java", "org.jboss.as.test.clustering.single.web.SimpleServlet.java", "org.jboss.as.test.clustering.cluster.web.AbstractWebFailoverTestCase.java", "org.jboss.as.test.clustering.cluster.web.CoarseWebFailoverTestCase.java", "org.jboss.as.test.clustering.cluster.web.ConcurrentCoarseWebFailoverTestCase.java", "org.jboss.as.test.clustering.cluster.session.persistence.SessionClusterDbPersistenceTestCase.java", "org.jboss.as.test.clustering.TopologyChangeListenerBean.java", "org.jboss.as.test.clustering.cluster.web.ConcurrentFineWebFailoverTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 6982, "bug_title": "session-max-alive-time statistics for deployment are counted incorrectly", "bug_description": "The value of session-max-alive-time is incorrectly counted. It looks as it is counted in miliseconds instead of seconds + the value is double of expected one.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.undertow.DeploymentDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 6996, "bug_title": "High CPU Usage By Infinispan when using ATTRIBUTE granularity", "bug_description": "Customer is deploying clustered application to EAP 7.0.1 and notices high CPU utilization by Infinispan (default configuration). Customer took thread dumps (attachment high-cpu1.zip and high-cpu1.zip) during the occurrence of the issue in question. Reports [1] show high CPU utilization with Infinispan. \nCustomer then gave us an app to reproduce the issue in question (attachment webapp3.zip). The attachment includes the app, which consist of JSP pages and code that can be used to test the app. During the test, we notice CPU utilization increases upwards to 80% -90% and remains there until the test is finished. If I deploy the same app to clustered EAP 6.4/Java 8 (with dist mode like default EAP 7), CPU utilization remains low (~2%) during the running of the test.\nCustomer is under the assumption that the high CPU is due to the number of entries in the cache (web cache). As the number of entries increases, so does the likelihood of the high CPU utilization by Infinispan. Inside the test code (SessionReplicationTest.java) provided by the customer, they included (commented out) a call to a JSP file (index3.jsp) that invalidates the session (thus removing it from cache). High CPU is not experienced when they invalidate the session.    \n[1]\nhttps://access.redhat.com/labs/jvmpeg/results/8712a840-5da6-11e6-8f83-277d70f61057\nhttps://access.redhat.com/labs/jvmpeg/results/56bc07a0-6322-11e6-b64b-2ddd7b4e30bc", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.fine.FineImmutableSessionAttributes.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSessionManagerFactory.java", "org.wildfly.clustering.web.infinispan.session.fine.FineSessionAttributesFactory.java", "org.wildfly.clustering.web.infinispan.session.fine.SessionAttributeKeyExternalizer.java", "org.wildfly.clustering.web.infinispan.session.fine.SessionAttributeKey.java", "org.wildfly.clustering.web.infinispan.session.fine.FineSessionAttributes.java", "org.wildfly.clustering.web.infinispan.session.coarse.CoarseSessionAttributesFactory.java"], "label": 1, "es_results": []}, {"bug_id": 7034, "bug_title": "JDR is not collecting the file .overlays, layer.conf, version.txt config files", "bug_description": "The JDR report when collecting files should be collecting\n$JBOSS_HOME/modules/system/layers/base/.overlays/.overlays\n$JBOSS_HOME/.installation/identity.conf\n$JBOSS_HOME/.installation/layers/base/layer.conf\n$JBOSS_HOME/.installation/patches/*/misc/version.txt\nThis file is needed to confirm overlay priority and other layer configurations to make sure the installation is not corrupted.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.jdr.plugins.AS7Plugin.java"], "label": 1, "es_results": []}, {"bug_id": 7106, "bug_title": "Reject distributed web sessions with missing attribute cache entries", "bug_description": "If we detect cache entry integrity constraint violations, then the session is invalid, and we should report it as not found and purge the orphaned entries.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.fine.FineSessionAttributesFactory.java", "org.wildfly.clustering.web.infinispan.logging.InfinispanWebLogger.java"], "label": 1, "es_results": []}, {"bug_id": 7069, "bug_title": "EJBs accessible too early (spec violation) - deployment marked started before ready", "bug_description": "Follow up of WFLY-6402, the deployment is being marked started in the deployment repository before it is ready, resulting in requests being accepted.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.ejb3.deployment.processors.DeploymentRepositoryProcessor.java", "org.jboss.as.ee.component.deployers.StartupCountdown.java", "org.jboss.as.ejb3.deployment.ModuleDeployment.java"], "label": 1, "es_results": []}, {"bug_id": 7021, "bug_title": "jdr.sh script should have better help message", "bug_description": "jdr.sh script should have better help message. There is no general description about this script. There is only list of attributes.\n\n\n\n\n\n\n./jdr.sh -h\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.jdr.CommandLineMain.java", "org.jboss.as.jdr.logger.JdrLogger.java"], "label": 1, "es_results": []}, {"bug_id": 7120, "bug_title": "NPE in SessionManagerStatsHandler", "bug_description": "Mathieu Lachance reports an NPE when SessionManagerStatsHandler tries to use the ServiceController for a no-longer present deployment. See https://github.com/wildfly/wildfly/pull/9189", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.undertow.DeploymentDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 7413, "bug_title": "Singleton policy quorum attribute is missing a validator", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.clustering.singleton.SingletonPolicyResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 7426, "bug_title": "Attempt to remove cache container with default-cache defined throws NPE", "bug_description": "When I create a local cache as a child of some cache container and then set it to that cache container as its default cache, it is impossible to remove that cache container.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.InfinispanSubsystemServiceHandler.java", "org.jboss.as.clustering.infinispan.subsystem.CacheContainerServiceHandler.java"], "label": 1, "es_results": []}, {"bug_id": 6935, "bug_title": "CMTTxInterceptor transaction comparison", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.CR1", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.ejb3.tx.CMTTxInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 7410, "bug_title": "CommandDispatcher.submitOnCluster() futures throw NPEs", "bug_description": "Calling Future.get() on a response from CommandDispatcher.submitOnCluster(...) will always throw an NPE.\nWe also need to handle the case where the response from a node was filtered.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.clustering.server.dispatcher.ChannelCommandDispatcher.java"], "label": 1, "es_results": []}, {"bug_id": 7309, "bug_title": "Make the authentication configurable in the testsuite ", "bug_description": "Actually some tests cases fails when running against a remote eap instance. \nIn this specific case instances running on Openshift v3.\nIn order to get those tests working we have to modify some classes to configure the authentication.\nExample: \norg.jboss.as.test.integration.ee.jmx.property.JMXPropertyEditorsTestCase, had to change this:\n\n\n\n\n\n\n    private MBeanServerConnection getMBeanServerConnection() throws IOException {\n\n\n\n\n        final String address = managementClient.getMgmtAddress()+\":\"+managementClient.getMgmtPort();\n\n\n\n\n        connector = JMXConnectorFactory.connect(new JMXServiceURL(\"service:jmx:http-remoting-jmx://\"+address));\n\n\n\n\n        return connector.getMBeanServerConnection();\n\n\n\n\n\n\n\n\n\n    }\n\n\n\n\n\n\nTo:\n\n\n\n\n\n\n\n\n\n\n\n    private MBeanServerConnection getMBeanServerConnection() throws IOException {\n\n\n\n\n        HashMap<String, String[]> propEnv = new HashMap<String, String[]>();\n\n\n\n\n        String[] credentials = {  System.getProperty(\"jboss.management.user\",\"\"), System.getProperty(\"jboss.management.password\",\"\") };\n\n\n\n\n        propEnv.put(JMXConnector.CREDENTIALS, credentials);\n\n\n\n\n        final String address = managementClient.getMgmtAddress()+\":\"+managementClient.getMgmtPort();\n\n\n\n\n        connector = JMXConnectorFactory.connect(new JMXServiceURL(\"service:jmx:http-remoting-jmx://\"+address),propEnv);\n\n\n\n\n        return connector.getMBeanServerConnection();\n\n\n\n\n    }\n\n\n\n\n\n\nCould these kind of authentication being configurable?\nIt is important to us because this allows the tests to be executed against the docker images running in openshift.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.test.integration.ee.jmx.property.JMXPropertyEditorsTestCase.java", "org.jboss.as.test.integration.sar.injection.resource.SarResourceInjectionTestCase.java", "org.jboss.as.test.integration.sar.servicembean.ServiceMBeanSupportTestCase.java", "org.jboss.as.test.integration.sar.context.classloader.MBeanTCCLTestCase.java", "org.jboss.as.test.integration.sar.JNDIBindingMBeanTestCase.java", "org.jboss.as.test.integration.naming.remote.simple.RemoteNamingTestCase.java", "org.jboss.as.test.integration.jmx.ModelControllerMBeanTestCase.java", "org.jboss.as.test.integration.naming.remote.ejb.RemoteNamingEjbTestCase.java", "org.jboss.as.test.integration.sar.SarWithinEarTestCase.java", "org.jboss.as.test.integration.sar.injection.depends.DependsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 7486, "bug_title": "Bad error message when adding singleton policy with new cache container in Singleton Subsystem", "bug_description": "Adding a new singleton policy as described in https://access.redhat.com/documentation/en/red-hat-jboss-enterprise-application-platform/version-7.0/development-guide/#clustered_ha_singleton_service with a newly created cache-container leads to a non-explanatory fail message \"WFLYCTL0180: Services with missing/unavailable dependencies\" => undefined.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.clustering.singleton.SingletonPolicyBuilder.java", "org.wildfly.extension.clustering.singleton.SingletonPolicyResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 7488, "bug_title": "JGroups subsystem resource registers default-channel capabilities even when undefined", "bug_description": "Analog of WFLY-7487, but for the optional default channel attribute of the JGroups subsystem.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.clustering.jgroups.subsystem.JGroupsSubsystemResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 7487, "bug_title": "Infinispan cache container resource registers default-cache capabilities even when undefined", "bug_description": "The management operations specified in the description for: https://issues.jboss.org/browse/WFLY-7486\n... should fail during model validation due to a missing capability, since the default-cache was not defined.  However, the commands will succeed, even though the singleton policy will fail at runtime due to a missing service dependency.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.CacheContainerResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 7503, "bug_title": "Typo in NamingLogger log message with id WFLYNAM0060", "bug_description": "There is a typo \"attributed\" in the log message:\n\n\n\n\n\n\n@Message(id = 60, value = \"Binding type %s requires attributed named %s defined\")\n\n\n\n\nOperationFailedException bindingTypeRequiresAttributeDefined(BindingType bindingType, String attributeName);\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.naming.logging.NamingLogger.java"], "label": 1, "es_results": []}, {"bug_id": 7037, "bug_title": "Memory leak when doing deploy/undeploy app using REST and JPA", "bug_description": "It seems that exposing some type (ApplicationUser in attached app) which has enum type as attribute via REST api could cause memory leak (See steps to reproduce). You can observe that person.joey.test.UserType instances are kept in memory when GC happens (metaspace exceeds) and the path to GC root looks:\n\nNote that this map https://github.com/FasterXML/jackson-databind/blob/jackson-databind-2.7.4/src/main/java/com/fasterxml/jackson/databind/util/ClassUtil.java#L366 was not available in 2.5.4 version used in WF 10.0.0.Final", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.jaxrs.deployment.JaxrsIntegrationProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 7603, "bug_title": "Singleton extension uses deprecated transformer API", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.clustering.singleton.SingletonExtension.java"], "label": 1, "es_results": []}, {"bug_id": 7602, "bug_title": "Infinispan extension uses deprecated transformer API", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.InfinispanExtension.java"], "label": 1, "es_results": []}, {"bug_id": 7601, "bug_title": "JGroups extension uses deprecated transformer API", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.clustering.jgroups.subsystem.JGroupsExtension.java"], "label": 1, "es_results": []}, {"bug_id": 7405, "bug_title": "Message counters does not work correctly without server reload after enabling statistics", "bug_description": "Server is started with queue deployed. Attribute statistics-enabled is then set to true in messaging server. This operation doesn&apos;t require reload. Start sending messages and look at outputs of operation list-message-counter-as-json or list-message-counter-as-html at queue you are using to send messages. (message-counter-sample-period is set to 10s by default, so give it some time).\n\n\n\n\n\n\nlist-message-counter-as-json output\n\n\n\n\n\n\n[standalone@localhost:9990 jms-queue=q] :list-message-counter-as-json\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => \"{\\\"destinationName\\\":\\\"q\\\",\\\"destinationSubscription\\\":null,\\\"destinationDurable\\\":true,\\\"count\\\":0,\\\"countDelta\\\":0,\\\"messageCount\\\":47064,\\\"messageCountDelta\\\":809,\\\"lastAddTimestamp\\\":\\\"1/1/70 1:00:00 AM\\\",\\\"updateTimestamp\\\":\\\"1/1/70 1:00:00 AM\\\"}\"\n\n\n\n\n}\n\n\n\n\n\n\nOnly attributes messageCount, messageCountDelta contain updated values . Other attributes are either null, 0 or default timestamp.\nOutput of list-message-counter-history-as-json is also not correctly updated\n\n\n\n\n\n\nlist-message-counter-history-as-json output\n\n\n\n\n\n\n[standalone@localhost:9990 jms-queue=q] :list-message-counter-history-as-json\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => \"{\\\"dayCounters\\\":[{\\\"date\\\":\\\"10/27/16\\\",\\\"counters\\\":[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]}]}\"\n\n\n\n\n}\n\n\n\n\n\n\nAfter server reload, output of operations updates and starts working as expected.\n\n\n\n\n\n\nOutput after reload\n\n\n\n\n\n\n[standalone@localhost:9990 jms-queue=q] :list-message-counter-history-as-json\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => \"{\\\"dayCounters\\\":[{\\\"date\\\":\\\"10/27/16\\\",\\\"counters\\\":[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,60015,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]}]}\"\n\n\n\n\n}\n\n\n\n\n[standalone@localhost:9990 jms-queue=q] :list-message-counter-as-json\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => \"{\\\"destinationName\\\":\\\"q\\\",\\\"destinationSubscription\\\":null,\\\"destinationDurable\\\":true,\\\"count\\\":60015,\\\"countDelta\\\":60015,\\\"messageCount\\\":60015,\\\"messageCountDelta\\\":60015,\\\"lastAddTimestamp\\\":\\\"10/27/16 11:34:39 AM\\\",\\\"updateTimestamp\\\":\\\"10/27/16 11:35:29 AM\\\"}\"\n\n\n\n\n}\n\n\n\n\n\n\nValues are also correctly updated when new messages are sent now.\nAs administrator, I would like to be able to turn on/off statistics also without server reload. Although it is possible with messaging subsystem, it is not working correctly until reload.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.test.integration.messaging.mgmt.JMSQueueManagementTestCase.java", "org.wildfly.extension.messaging.activemq.ActiveMQServerControlWriteHandler.java"], "label": 1, "es_results": []}, {"bug_id": 7330, "bug_title": "Colocated HA topology with HTTP connectors/acceptors", "bug_description": "I try to configure colocated HA topology with HTTP connectors/acceptors but something goes wrong and I see repeated WARN message [1] on the first node and on the second I see the [2]. Maybe it is misconfiguration, but I have no idea what I do wrong. I attached XML configurations of both nodes, please review it.\n[1]\n\n\n\n\n\n\n12:55:47,789 WARN  [org.apache.activemq.artemis.core.client] (Thread-10 (ActiveMQ-client-global-threads-487873773)) AMQ212006: Waiting 2000 milliseconds before next retry. RetryInterval=2000 and multiplier=1\n\n\n\n\n\n\n[2]\n\n\n\n\n\n\n12:56:39,054 WARN  [org.apache.activemq.artemis.core.client] (Thread-10 (ActiveMQ-server-org.apache.activemq.artemis.core.server.impl.ActiveMQServerImpl$2@4766f9b3-516179796)) AMQ212006: Waiting 500 milliseconds before next retry. RetryInterval=500 and multiplier=1\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.messaging.activemq.jms.legacy.LegacyConnectionFactoryService.java", "org.wildfly.extension.messaging.activemq.HTTPUpgradeService.java", "org.wildfly.extension.messaging.activemq.TransportConfigOperationHandlers.java"], "label": 1, "es_results": []}, {"bug_id": 7713, "bug_title": "Distributed web session expiration loads session twice", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.ExpiredSessionRemover.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSessionFactory.java", "org.wildfly.clustering.web.infinispan.session.SessionFactory.java", "org.wildfly.clustering.web.infinispan.session.ExpiredSessionRemoverTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 7733, "bug_title": "JDBC-based cache stores require a DataSource attribute for runtime", "bug_description": "Currently, there are 2 attributes for defining the DataSource of a JDBC-based cache store:\n1. \"data-store\", which references a named DataSource capability\n2. \"datasource\", the legacy attribute which specifies the jndi name of a DataSource\nBoth attributes are currently nullable.  Consequently, the model does not require either to be specified, which would cause the runtime to fail.\nThe data-source attribute should be required, with \"datasource\" set as an alternative.\nNo transformer is necessary since \"datasource\" was a required attribute in older versions of the model.", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.JDBCStoreResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 7745, "bug_title": "mod_cluster extension uses deprecated transformer API", "bug_description": " The deprecated APIs used are org.jboss.as.controller.ExtensionContext#isRegisterTransformers and org.jboss.as.controller.transform.description.TransformationDescription.Tools#register(...).", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.mod_cluster.ModClusterModel.java", "org.wildfly.extension.mod_cluster.ModClusterExtension.java"], "label": 1, "es_results": []}, {"bug_id": 7752, "bug_title": "Clustering XML readers are loaded eagerly", "bug_description": "[5:02 PM] Radoslav Husar: org.jboss.as.controller.parsing.ExtensionParsingContext#setSubsystemXmlMapping(java.lang.String, java.lang.String, java.util.function.Supplier<org.jboss.staxmapper.XMLElementReader<java.util.List<org.jboss.dmr.ModelNode>>>)\n[5:02 PM] Radoslav Husar: I mean we want to be using^\n[5:02 PM] Radoslav Husar: but we are using org.jboss.as.controller.parsing.ExtensionParsingContext#setSubsystemXmlMapping(java.lang.String, java.lang.String, org.jboss.staxmapper.XMLElementReader<java.util.List<org.jboss.dmr.ModelNode>>)", "project": "Wildfly", "sub_project": "WFLY", "version": "10.1.0.Final", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.InfinispanExtension.java", "org.wildfly.extension.clustering.singleton.SingletonExtension.java", "org.jboss.as.clustering.jgroups.subsystem.JGroupsExtension.java"], "label": 1, "es_results": []}, {"bug_id": 1375, "bug_title": "ClassLoader memory leak with EJB Asynchronous", "bug_description": "Using asynchronous EJB call via @Asynchronous annotation leads to class loader leak.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha2", "fixed_files": ["org.jboss.as.ejb3.component.interceptors.AsyncFutureInterceptorFactory.java"], "label": 1, "es_results": []}, {"bug_id": 1401, "bug_title": "JBAS015893: Encountered invalid class name message when class name is perfectly valid", "bug_description": "The JVM is much more lenient than java as far as class names are concerned, we should probably just get rid of this message altogether. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha2", "fixed_files": ["org.jboss.as.server.deployment.ServiceLoaderProcessor.java", "org.jboss.as.server.ServerLogger.java"], "label": 1, "es_results": []}, {"bug_id": 1403, "bug_title": "RolloutPlanTestCase#testMaxFailServersPercentageRolloutPlan incorrectly refers to a rollout plan from different test method", "bug_description": "The RolloutPlanTestCase#testMaxFailServersPercentageRolloutPlan in the domain mode testsuite contains a bug as it refers to &apos;maxFailOnePlan&apos; plan instead of &apos;maxFailPercPlan&apos;. Hence, if the test methods are not run in alphabetical order they will fail due to this bug.\nThis has been somewhat fixed by adding an explicit ordering of test methods in that class, but this is a workaround rather than a fix.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha2", "fixed_files": ["org.jboss.as.test.integration.domain.management.cli.RolloutPlanTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1407, "bug_title": "Correct test methods dependency in EjbMethodInterceptorTestCase", "bug_description": "org.jboss.as.test.integration.ejb.interceptor.method.EjbMethodInterceptorTestCase failed intermittently due to dependency of test ordering on https://jenkins.mw.lab.eng.bos.redhat.com/hudson/view/EAP6/view/EAP6-AS-Testsuite/job/eap-60-as-testsuite-RHEL-matrix-openJDK7/lastCompletedBuild/jdk=openjdk-1.7.0-local,label_exp=RHEL6%26%26x86_64/testReport/org.jboss.as.test.integration.ejb.interceptor.method/EjbMethodInterceptorTestCase/testMethodLevelInterceptors/ \nIn upstream code, its bean fixed by forcing test running in order, however, the real issue behind is that it assumes testMethodLevelInterceptors() run at first which does not contain variable TopSecretInterceptor.called reset to false at beginning like second test method does.\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha2", "fixed_files": ["org.jboss.as.test.integration.ejb.interceptor.method.EjbMethodInterceptorTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1448, "bug_title": "MultipleClientRemoteJndiTestCase and NestedRemoteContextTestCase failed due to NamingException", "bug_description": "MultipleClientRemoteJndiTestCase and NestedRemoteContextTestCase from EAP 6.1.0 TS fail due to NamingException.\nBoth tests use hardcoded address like: env.put(Context.PROVIDER_URL, \"remote://localhost:4447\"); \nWhen Jenkins configures to use other address, they will failed with NamingException.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha2", "fixed_files": ["org.jboss.as.test.integration.naming.remote.multiple.MyEjbBean.java", "org.jboss.as.test.integration.naming.remote.multiple.RunRmiServlet.java", "org.jboss.as.test.integration.naming.remote.multiple.CallEjbServlet.java"], "label": 1, "es_results": []}, {"bug_id": 1449, "bug_title": "NullPointerException while adding CacheFactory through EJB3 subsystem", "bug_description": "A user has reported a NPE while adding the cache through the management operation in EJB3 subsystem. Please see the referenced forum thread for details", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha2", "fixed_files": ["org.jboss.as.appclient.subsystem.AppClientSubsystemAdd.java", "org.jboss.as.ejb3.subsystem.CacheFactoryAdd.java"], "label": 1, "es_results": []}, {"bug_id": 1508, "bug_title": "Transformer builders should not check for rejected operation attributes for the 'remove' operation", "bug_description": "I came across this while working on WFLY-456 (audit logging) that PR will test for this\nThe problem is the audit log transformers for jmx are set up to reject if the &apos;enabled&apos; attribute is undefined.\nWhen issuing a &apos;remove&apos; it then looks in the operation for the &apos;enabled&apos; attribute which fails since the operation does not contain that attribute, it is simply:\n\n\n\n\n\n\n{\n\n\n\n\n    \"operation\" => \"remove\",\n\n\n\n\n    \"address\" => [\n\n\n\n\n        (\"subsystem\" => \"jmx\"),\n\n\n\n\n        (\"configuration\" => \"audit-log\")\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n\nThe same is true for &apos;read-attribute&apos;", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha2", "fixed_files": ["org.jboss.as.controller.transform.description.AttributeTransformationRule.java"], "label": 1, "es_results": []}, {"bug_id": 1517, "bug_title": "regression: using a ResourceAdaptor (rar) which has properties that use primitives as arguments will fail to deploy", "bug_description": "org.jboss.as.connector.util.Injection.java:159\n    protected Method findMethod(Class<?> clz, String methodName, String propertyType) {\n        while (!clz.equals(Object.class)) {\n            List<Method> hits = null;\n            Method[] methods = clz.getDeclaredMethods();\n            for (int i = 0; i < methods.length; i++) {\n                Method method = methods[i];\n                if (methodName.equals(method.getName()) && method.getParameterTypes().length == 1) {\n                    if (propertyType == null || propertyType.equals(method.getParameterTypes()[0].getName())) {\nthe above is not taking primitives into account.\nExample, the IBM IMS connector ims1132.rar has:\n<config-property>\n  <config-property-name>enableHASupport</config-property-name>\n  <config-property-type>java.lang.Boolean</config-property-type>\n  <config-property-value>true</config-property-value>\n</config-property>\nand the method:\npublic void setEnableHASupport(boolean isHAEnabled)\nOur \"FindMethod\" will find this method but will fail to select it as it compares \"java.lang.Boolean\" with \"boolean\"", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha2", "fixed_files": ["org.jboss.as.connector.util.Injection.java"], "label": 1, "es_results": []}, {"bug_id": 1553, "bug_title": "Infinispan subsystem ignores cluster name", "bug_description": "The Infinispan subsystem uses the name of the cache container as the cluster name, instead of the name configured in <transport cluster=\"foo\"/>.\nThis is a critical issue when using a gossip router, as only the cluster name determines what nodes form a cluster.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha3", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.CacheContainerAdd.java", "org.jboss.as.clustering.infinispan.subsystem.EmbeddedCacheManagerConfigurationService.java"], "label": 1, "es_results": []}, {"bug_id": 1574, "bug_title": "jboss-cli.sh throws IllegalArgumentException when using tab complete", "bug_description": "When using tab complete to try and auto-fill values or get hints as to the allowed values for certain attributes, an IllegalArgumentException is thrown.\nNote: This issue also affects 7.2.0.Final ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha3", "fixed_files": ["org.jboss.as.cli.operation.impl.DefaultOperationCandidatesProvider.java", "org.jboss.as.cli.operation.OperationRequestCompleter.java", "org.jboss.as.cli.impl.ValueTypeCompleter.java"], "label": 1, "es_results": []}, {"bug_id": 1580, "bug_title": "PersistentResourceXMLDescription does not persist empty subsystems", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha2", "fixed_version": "8.0.0.Alpha3", "fixed_files": ["org.jboss.as.controller.PersistentResourceXMLDescription.java"], "label": 1, "es_results": []}, {"bug_id": 1546, "bug_title": "Undertow is not wired up to use the correct temp location", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha3", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java", "org.wildfly.extension.undertow.UndertowMessages.java", "org.wildfly.extension.undertow.deployment.UndertowDeploymentService.java", "org.wildfly.extension.undertow.deployment.UndertowDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 1601, "bug_title": "web.xml parsing deployment unit processor does not show the original parsing error in the deployment exception", "bug_description": "If a deployment fails due to web.xml running into parsing problems, then the original because of the exception is lost and isn&apos;t contained in the DeploymentUnitProcessingException which gets thrown. See referenced forum thread for more details.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha2", "fixed_version": "8.0.0.Alpha3", "fixed_files": ["org.wildfly.extension.undertow.deployment.WebParsingDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 1590, "bug_title": "Add missing cache statistics in EJB3 deployment metrics", "bug_description": "EJB3 deployment metrics is missing from EJB3 subsystem, part of them have been added in https://issues.jboss.org/browse/WFLY-38, we also need to provide the missing cache statistics:\nCache Size - Cache Size\nPassivated Count - Passivated Count\nTotal Size - Total Size", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha2", "fixed_version": "8.0.0.Alpha3", "fixed_files": ["org.jboss.as.ejb3.cache.impl.backing.SerializationGroupMemberContainer.java", "org.jboss.as.ejb3.cache.spi.BackingCacheEntryStore.java", "org.jboss.as.test.integration.ejb.management.deployments.EjbInvocationStatisticsTestCase.java", "org.jboss.as.ejb3.cache.spi.BackingCache.java", "org.jboss.as.ejb3.cache.spi.PersistentObjectStore.java", "org.jboss.as.test.integration.ejb.management.deployments.AbstractManagedBean.java", "org.jboss.as.ejb3.subsystem.deployment.AbstractEJBComponentResourceDefinition.java", "org.jboss.as.ejb3.cache.impl.backing.SimpleBackingCacheEntryStore.java", "org.jboss.as.test.integration.ejb.management.deployments.NoTimerStatelessBean.java", "org.jboss.as.ejb3.cache.spi.impl.FilePersistentObjectStore.java", "org.jboss.as.ejb3.cache.Cache.java", "org.jboss.as.clustering.ejb3.cache.backing.infinispan.InfinispanEjbMessages.java", "org.jboss.as.test.integration.ejb.management.deployments.ManagedStatefulBean.java", "org.jboss.as.ejb3.cache.impl.backing.NonPassivatingBackingCacheImpl.java", "org.jboss.as.ejb3.cache.spi.impl.AbstractCache.java", "org.jboss.as.ejb3.cache.impl.backing.PassivatingBackingCacheImpl.java", "org.jboss.as.test.integration.ejb.management.deployments.BusinessInterface.java", "org.jboss.as.clustering.ejb3.cache.backing.infinispan.InfinispanBackingCacheEntryStore.java", "org.jboss.as.test.integration.ejb.management.deployments.NoTimerSingletonBean.java"], "label": 1, "es_results": []}, {"bug_id": 1620, "bug_title": "EJB in CDI enabled module gets registered twice leading to WELD-001409 Ambiguous dependencies...", "bug_description": "If you have this no-interface @Stateless EJB in the module and have a\nbeans.xml inside the module jar as well and then have a deployment\ndepends on & imports the annotations, and then uses @Inject TestEjb,\nWeld will complain that there are two options an EJB and a ManagedBean\nand it doesn&apos;t know which to inject. According to [1] it should only be\nconsidered a managed bean if \"It is not annotated with an EJB\ncomponent-defining annotation or declared as an EJB bean class in\n\n\n\nejb-jar.xml\n.\"\n\n\n\nThe error:\nWELD-001409 Ambiguous dependencies for type [TestEjb] with qualifiers [@Default] at injection point [[field] @Inject test.webapp.TestService.testEjb].\nPossible dependencies [[Session bean [class test.TestEjb with qualifiers [@Any @Default]; local interfaces are [TestEjb], Managed Bean [class test.TestEjb] with qualifiers [@Any @Default]]] \n@Stateless\npublic class TestEjb\n{\npublic String hello() \n{\n\nreturn \"Hello\";\n\n}\n}\nIf I move all of the classes into the test war, then Weld doesn&apos;t have\nan issue, so it seems there is some difference when the code is put into\nthe modules directory.\n[1] http://docs.jboss.org/weld/reference/1.0.1-Final/en-US/html_single/#d0e792 ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha2", "fixed_version": "8.0.0.Alpha3", "fixed_files": ["org.jboss.as.weld.deployment.processors.ExternalBeanArchiveProcessor.java", "org.jboss.as.test.integration.weld.multideployment.WeldModuleDeploymentTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1672, "bug_title": "Test added module directories remain in JBOSS_HOME/modules", "bug_description": "integration/basic/src/test/java/org/jboss/as/test/integration/jca/moduledeployment/AbstractModuleDeploymentTestCaseSetup.java\nintegration/basic/src/test/java/org/jboss/as/test/integration/weld/multideployment/WeldModuleDeploymentTestCase\nintegration/basic/src/test/java/org/jboss/as/test/integration/ee/globalmodules/GlobalModulesTestCase.java\nFor the tests above, method deleteRecursively() does not delete test module directories properly, part of module directory remain in JBOSS_HOME/modules after test completion.\nExample: JBOSS_HOME/modules/org/jboss/test is left behind for WeldModuleDeploymentTestCase, in that case the testModuleRoot is org/jboss/test/weldModule", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha2", "fixed_version": "8.0.0.Alpha3", "fixed_files": ["org.jboss.as.test.integration.jca.moduledeployment.AbstractModuleDeploymentTestCaseSetup.java", "org.jboss.as.test.integration.ee.globalmodules.GlobalModulesTestCase.java", "org.jboss.as.test.integration.weld.multideployment.WeldModuleDeploymentTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1658, "bug_title": "EJBAccessException for methods with @PermitAll but using arrays in parameters", "bug_description": "Calling an EJB method containing an array in parameters throws EJBAccessException, even if the method has @PermitAll annotation.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha2", "fixed_version": "8.0.0.Alpha3", "fixed_files": ["org.jboss.as.test.integration.ejb.security.AnnotationAuthorizationTestCase.java", "org.jboss.as.test.integration.ejb.security.authorization.DenyAllOverrideBean.java", "org.jboss.as.ejb3.deployment.processors.merging.MethodPermissionsMergingProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 1626, "bug_title": "Duplicated message ids in jdr and security subsystems", "bug_description": "There are 3 different language messages in jdr and security subsystems with the same ids which is not correct as each message must have an unique id with the server.\n\n\n\n\n\n\njdr/jboss-as-jdr/src/main/java/org/jboss/as/jdr/JdrLogger.java\n\n\n\n\n\n\n@Message(id=13306, value=\"Could not create zipfile.\")\n\n\n\n\n@Message(id=13307, value=\"Could not configure JDR.\")\n\n\n\n\n@Message(id = 13308, value = \"No JDR commands were loaded. Be sure that a valid Plugin class is specified in plugins.properties.\")\n\n\n\n\n\n\n\n\n\n\n\n\nsecurity/src/main/java/org/jboss/as/security/SecurityMessages.java\n\n\n\n\n\n\n@Message(id = 13306, value = \"Remoting connection found but no UserPrincipal.\")\n\n\n\n\n@Message(id = 13307, value = \"Argument %s is null\")\n\n\n\n\n@Message(id = 13308, value = \"Unable to start the %s service\")\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha2", "fixed_version": "8.0.0.Alpha3", "fixed_files": ["org.jboss.as.jdr.JdrLogger.java"], "label": 1, "es_results": []}, {"bug_id": 1711, "bug_title": "Messaging's CoreAddressResource is inconsistent re: child types", "bug_description": "CoreAddressResource is a dynamic resource with special logic related to child types. That logic is inconsistent with respect to naming of the child type, in some places calling it \"role\" in others \"security-role\". The management metadata says \"role\" so that&apos;s what it shall be.\nThis surfaced in the RBAC work because changes in :read-resource handling caused different code paths to execute that revealed the bug.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha2", "fixed_version": "8.0.0.Alpha4", "fixed_files": ["org.jboss.as.test.integration.messaging.mgmt.AddressControlManagementTestCase.java", "org.jboss.as.messaging.SecurityRoleResource.java", "org.jboss.as.messaging.CoreAddressResource.java"], "label": 1, "es_results": []}, {"bug_id": 1772, "bug_title": "Timers are scheduled before being added to the timers map", "bug_description": "This can result in the timeout being executed before the timer is properly installed.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha3", "fixed_version": "8.0.0.Alpha4", "fixed_files": ["org.jboss.as.ejb3.timerservice.TimerServiceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 1785, "bug_title": "WAR_BUNDLES_JSF_IMPL does not work for EAR files", "bug_description": "Hello Learned and Astonishly Charming JBoss Associates,\nI&apos;ve been trying for quite some time now to get my successfully deployed WAR to become a successfully deployed EAR.  Much to my chagrin, this has been my white whale, and it just might kill me.\nIn a nutshell, the attached EAR file contains a WAR.  If you deploy that WAR file everything works smooth as butter.  As soon as you put it in an EAR format however, you get the following well placed riposte:\n19:33:57,513 WARN  [org.jboss.as.jsf] (MSC service thread 1-2) JBAS012603: Unknown JSF version &apos;WAR_BUNDLES_JSF_IMPL&apos;.  Default version &apos;main&apos; will be used instead.\nNot cool, JBoss.  Not cool.\nI&apos;ve tried moving the jars to different places in the WAR/EAR.  I&apos;ve tried using Manifest files.  I&apos;ve tried colorfully adorned four letter expletives.  JBoss is unmoved.  Does anyone know why JBoss is rejecting my JSF advances?  Can the relationship be fixed?\nUsing EAP 6.1 which I believe is equivalent to AS 7.2.\nThanks in advance,\nWill\nPS:  The forum didn&apos;t like me attaching a 1.8 meg file so here&apos;s a download link instead\nhttp://www.williverstravels.com/JDev/Forums/Threads/230850/TestEar.ear", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha3", "fixed_version": "8.0.0.Alpha4", "fixed_files": ["org.jboss.as.jsf.deployment.JSFDependencyProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 1810, "bug_title": "SFSB tx lock not released in exception was thrown in Synchronization callback", "bug_description": "Because the owning tx was never pushed into the OwnableReentrantLock ownership stack in org.jboss.as.ejb3.component.stateful.StatefulSessionSynchronizationInterceptor.handleThrowableInTxSync(...).\nThis will cause subsequent Lock.tryAcquire(..) to fail for a different tx.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha4", "fixed_files": ["org.jboss.as.ejb3.component.stateful.StatefulSessionSynchronizationInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 1497, "bug_title": "Log4jCustomHandlerTestCase.disabledLoggerTest does not re-enable the handler", "bug_description": "Log4jCustomHandlerTestCase.disabledLoggerTest does not bring the setup back in the original state. This means that whenever defaultLoggingTest is run after disabledLoggerTest, the test fails.\ndisabledLoggerTest must reset the enabled flag.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Alpha4", "fixed_files": ["org.jboss.as.test.integration.logging.operations.Log4jCustomHandlerTestCase.java", "org.jboss.as.test.integration.logging.operations.CustomHandlerTestCase.java", "org.jboss.as.test.integration.logging.operations.AbstractLoggingOperationsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1861, "bug_title": "Zombie web sessions from old cluster members can cause OOM", "bug_description": "In the new web session clustering implementation, expiration and passivation are handled locally by the owning node.  If that node leaves, the sessions previously handled by the left node will be rescheduled for passivation/expiration by whichever node next handles that session.  However, any sessions previously handled by the left node that are never accessed again (i.e. zombie sessions) will stay in memory on the remote nodes, since no node ever schedules them for passivation/expiration.  The number of session zombies will continue to grow like a malignant cancer as the cluster membership changes, filling the available memory until there is nothing left to consume...", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha3", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.InfinispanSessionTestCase.java", "org.wildfly.clustering.web.infinispan.session.SessionEvictionSchedulerTestCase.java", "org.wildfly.clustering.web.infinispan.sso.CoarseSSOFactoryTestCase.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSessionManager.java", "org.wildfly.clustering.web.infinispan.session.SessionEvictionScheduler.java", "org.wildfly.clustering.web.infinispan.session.SessionExpirationSchedulerTestCase.java", "org.wildfly.clustering.web.infinispan.sso.CoarseSessionsTestCase.java", "org.wildfly.clustering.web.infinispan.sso.InfinispanSSOTestCase.java", "org.wildfly.clustering.web.infinispan.session.SimpleSessionMetaDataTestCase.java", "org.wildfly.clustering.web.infinispan.session.ExpiredSessionRemoverTestCase.java", "org.wildfly.clustering.web.infinispan.session.SessionExpirationScheduler.java"], "label": 1, "es_results": []}, {"bug_id": 1735, "bug_title": "cli EndIfHandler class exception created but not thrown", "bug_description": "cli EndIfHandler class creates an CommandLineException without throwing it:\n\n\n\n\n\n\n            try {\n\n\n\n\n                final ModelNode response = client.execute(ifRequest);\n\n\n\n\n                if(!Util.isSuccess(response)) {\n\n\n\n\n                    new CommandLineException(\"if request failed: \" + Util.getFailureDescription(response));\n\n\n\n\n                }\n\n\n\n\n            } catch (IOException e) {\n\n\n\n\n                throw new CommandLineException(\"if request failed\", e);\n\n\n\n\n            }\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha3", "fixed_version": "8.0.0.Alpha4", "fixed_files": ["org.jboss.as.cli.handlers.ifelse.EndIfHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1879, "bug_title": "Poor error handling in FilesystemDeploymentScanner when a directory cannot be read", "bug_description": "http://paste2.org/1VEUkjbz\nWhen the scanner reads a directory and File.listFiles() returns null, that means there was a problem doing the list, which should result in an exception. It does, but the exception is an NPE (see stack trace linked above); it should be something more meaningful.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.server.deployment.scanner.FileSystemDeploymentService.java", "org.jboss.as.server.deployment.scanner.DeploymentScannerMessages.java"], "label": 1, "es_results": []}, {"bug_id": 1511, "bug_title": "RemoteDomainConnection.close() will block forever if the master HC is not running ", "bug_description": "RemoteDomainConnection.close() overrides FutureManagementChannel.close() to first send a \"unregister\" message to the master HC before calling the superclass functionality.\nProblem is this call tries to open a connection to the master and will block forever waiting for it to connect if the master isn&apos;t available, as seen at http://fpaste.org/18232/37105700/\nThat example was from AutoIgnoredResourcesDomainTestCase which is concurrently shutting down the hosts in the domain, meaning the master can be shutting down in the middle of or prior to slave shutdown.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.host.controller.RemoteDomainConnectionService.java", "org.jboss.as.server.mgmt.domain.HostControllerConnection.java", "org.jboss.as.host.controller.RemoteDomainConnection.java", "org.jboss.as.test.integration.respawn.TestControllerClient.java", "org.jboss.as.protocol.mgmt.FutureManagementChannel.java", "org.jboss.as.protocol.ProtocolConnectionManager.java"], "label": 1, "es_results": []}, {"bug_id": 1374, "bug_title": "Unable to start JBoss server after issuing kill -9", "bug_description": "After manually killing a server it fails on subsequent start attempt using the management console or CLI.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.test.integration.respawn.RespawnTestCase.java", "org.jboss.as.host.controller.ServerInventoryImpl.java", "org.jboss.as.host.controller.ManagedServer.java"], "label": 1, "es_results": []}, {"bug_id": 1886, "bug_title": "Naming store can be shut down before components", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.naming.deployment.JndiNamingDependencyProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 1896, "bug_title": " The CLI command \"module remove\" fails to delete non-empty folders", "bug_description": "The \"module remove\" command fails when it deletes non-empty folder.\nFor instance a resource adapter module contains META-INF/ra.xml file in the module. When I choose to delete the module, it fails:\n[standalone@localhost:9999 /] module remove --name=org.jboss.ironjacamar.ra16out \nFailed to delete /home/jcacek/Testing/jboss-eap-6.1.1.ER4/modules/org/jboss/ironjacamar/ra16out/main/META-INF", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.cli.handlers.module.ASModuleHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1927, "bug_title": "Some unneccesary File.mkdir() calls in core-model-test TestModelControllerService", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.core.model.test.TestModelControllerService.java"], "label": 1, "es_results": []}, {"bug_id": 1947, "bug_title": "Issue with naming subsystem legacy schema", "bug_description": "Even though the &apos;fix&apos; for WFLY-1914 is to bump the naming subsystem version, this should not be necessary. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.naming.subsystem.NamingExtension.java", "org.jboss.as.naming.subsystem.NamingSubsystem10Parser.java"], "label": 1, "es_results": []}, {"bug_id": 789, "bug_title": "HornetQ native library(AIO) are loaded by default - for transaction manager using hornetq object store", "bug_description": "The issue cloned for upstream from an EAP6 bugzilla.\noriginal description:\n\nIt seems that in case that of using hornetq for implementation of object store (configuration of transaction subsystem via <use-hornetq-store/> tag) the native library (AIO) is used automatically without necessity of user confirmation.\nFor EAP 6.0.1 was decided that native library can&apos;t be used without explicit customer configuration request. Please check discussion on bug #900591.\nThe NIO should be used until customer defined otherwise.\nThe configuration option is missing in TM and after the adding it the EAP configuration should reflect fact that the default behaviour should be NIO.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.txn.subsystem.TransactionSubsystemRootResourceDefinition.java", "org.jboss.as.txn.subsystem.TransactionSubsystemAdd.java", "org.jboss.as.txn.subsystem.Namespace.java", "org.jboss.as.txn.subsystem.TransactionExtension.java", "org.jboss.as.txn.TransactionSubsystemTestCase.java", "org.jboss.as.txn.subsystem.CommonAttributes.java", "org.jboss.as.test.integration.domain.ExpressionSupportSmokeTestCase.java", "org.jboss.as.txn.subsystem.LogStoreTransactionParticipantDefinition.java", "org.jboss.as.txn.service.ArjunaObjectStoreEnvironmentService.java", "org.jboss.as.txn.subsystem.Attribute.java"], "label": 1, "es_results": []}, {"bug_id": 1575, "bug_title": "jboss-cli.sh allows creation of an invalid jsse element within a security-domain", "bug_description": "The jboss-cli.sh allows me to add a security-domain definition which is not valid. Apparently you must have a keystore-password or truststore-password, but this restriction is not enforced in the cli. \nI do not have too deep an understanding of how the cli decides that a given attribute is required, but I have seen cases where the cli will warn me if I try to do something without all required attributes. Something similar should probably be done here.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha2", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.security.SecuritySubsystemParser.java", "org.jboss.as.security.ComplexAttributes.java", "org.jboss.as.security.JSSEResourceDefinition.java", "org.jboss.as.security.SecurityDomainModelv12UnitTestCase.java", "org.jboss.as.security.SecurityMessages.java", "org.jboss.as.security.JSSEExpressionsUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1865, "bug_title": "NPE might occur when a null object is returned from the aesh Console", "bug_description": "In cli/src/main/java/org/jboss/as/cli/impl/Console.java\n177\t \t -                        return console.read(prompt).getBuffer();\n178\t +                        ConsoleOutput output = console.read(prompt);\n179\t +                        return output != null ? output.getBuffer() : null;", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha3", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.cli.impl.Console.java"], "label": 1, "es_results": []}, {"bug_id": 1656, "bug_title": "JCA resources model names and service names should be deterministic", "bug_description": "This is an offspring of: https://issues.jboss.org/browse/WFLY-1492 .\nExample RA definition:\n\n\n\n\n\n\n<resource-adapters>\n\n\n\n\n    <resource-adapter id=\"XXX\">\n\n\n\n\n       <archive>test</archive>\n\n\n\n\n       <transaction-support>NoTransaction</transaction-support>\n\n\n\n\n    </resource-adapter>\n\n\n\n\n</resource-adapters>\n\n\n\n\n\n\nThe id attribute is optional. This leads to a bit undeterministic model expansion. There are two bits that do not add up or make this a bad apple.\n1. RA service names are not unique, despite their model paths, the service name boils down to archive name ( and possibly id if its present). This seems odd, since in model we can point exact, unique path(profile, subsystem,.. and so on).\n2. Second thing is the id piece. Its optional. If its not present, AS injects counter suffix( either due to #1 or because there is doubled definition of RA in the same profile). In the end RA paths look like:\n\n\n\n\n\n\n/xxx/xxx/xxx/${archive-name}/${archive-name}\n\n\n\n\n/xxx/xxx/xxx/${archive-name}/${archive-name}->1\n\n\n\n\n/xxx/xxx/xxx/${archive-name}/${archive-name}->2\n\n\n\n\n/xxx/xxx/xxx/${archive-name}/${archive-name}->3\n\n\n\n\n\n\nWith id present:\n/xxx/xxx/xxx/$\n{archive-name}/${id}\n\nI Am not sure ATM, but its even possible to double with id\n\n\n\n\n\n\n\n\n\n\n\n\n\n /xxx/xxx/xxx/${archive-name}\n/$\n{id}\n->1  \n\n\n\n\n\n\n\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha2", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.connector.subsystems.resourceadapters.RaOperationUtil.java", "org.jboss.as.connector.logging.ConnectorMessages.java", "org.jboss.as.connector.subsystems.resourceadapters.ModifiableResourceAdapter.java", "org.jboss.as.connector.services.resourceadapters.ResourceAdapterActivatorService.java", "org.jboss.as.ejb3.component.messagedriven.MessageDrivenComponentDescription.java", "org.jboss.as.connector.services.resourceadapters.deployment.ResourceAdapterXmlDeploymentService.java", "org.jboss.as.connector.util.ConnectorServices.java", "org.jboss.as.test.manualmode.ejb.ssl.SSLEJBRemoteClientTestCase.java", "org.jboss.as.connector.subsystems.complextestcases.AbstractComplexSubsystemTestCase.java", "org.jboss.as.test.smoke.deployment.rar.tests.pure.PureTestCase.java", "org.jboss.as.connector.subsystems.resourceadapters.ResourceAdapterParser.java", "org.jboss.as.connector.subsystems.resourceadapters.ResourceAdaptersService.java", "org.jboss.as.connector.subsystems.resourceadapters.RaAdd.java", "org.jboss.as.connector.util.RaServicesFactory.java", "org.jboss.as.connector.services.resourceadapters.deployment.AbstractResourceAdapterDeploymentService.java", "org.jboss.as.connector.deployers.ra.processors.RaXmlDeploymentProcessor.java", "org.jboss.as.connector.subsystems.resourceadapters.RaRemove.java", "org.jboss.as.connector.subsystems.resourceadapters.Constants.java", "org.jboss.as.connector.subsystems.resourceadapters.RaActivate.java", "org.jboss.as.connector.services.resourceadapters.deployment.ResourceAdapterDeploymentService.java", "org.jboss.as.test.integration.jca.moduledeployment.TwoRaJarTestCase.java", "org.jboss.as.test.integration.jca.moduledeployment.InflowJarTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1650, "bug_title": "Legacy subsystem testing needs some classloading exclusion mecanism", "bug_description": "When translation messages are used (which is the case of EAP) we have conflicts between generated $logger classes when testing submodules.\nSome $logger classes exis thus they are loaded by the parent classloader before the childfirstclassloader tries to load them, thus we have a potential ClassCastException brewing. \nFor exemple this breaks the EAP build on a French OS.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha3", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.model.test.ChildFirstClassLoader.java", "org.jboss.as.model.test.ChildFirstClassLoaderBuilder.java", "org.jboss.as.subsystem.test.LegacyKernelServicesInitializer.java", "org.jboss.as.jpa.subsystem.JPA11SubsystemTestCase.java", "org.jboss.as.threads.ThreadsSubsystemTestCase.java", "org.jboss.as.subsystem.test.SubsystemTestDelegate.java", "org.jboss.as.connector.subsystems.jca.JcaSubsystemTestCase.java", "org.jboss.as.txn.TransactionSubsystemTestCase.java", "org.jboss.as.connector.subsystems.resourceadapters.ResourceAdaptersSubsystemTestCase.java", "org.jboss.as.security.SecurityDomainModelv12UnitTestCase.java", "org.jboss.as.connector.subsystems.datasources.DatasourcesSubsystemTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2009, "bug_title": "IOException in aesh console initialization results in NPE", "bug_description": "In source file org.jboss.as.cli.impl.Console, method Factory.getConsole:\nif the constructor call \"new org.jboss.aesh.console.Console()\" leads to an IOException, it is only logged and then ignored, always yielding a NullPointerException just a few lines later (console.addCompletion(new Completion() ...)\nI think the IOException should rather be rethrown wrapped in a CliInitializationException, so the resulting exception will not lose track of why this happened. Allowing a NPE go out of the internals is a wrong approach.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.cli.impl.Console.java"], "label": 1, "es_results": []}, {"bug_id": 1996, "bug_title": "Application client will not start if run against a standalone client jar", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.appclient.deployment.ActiveApplicationClientProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 2013, "bug_title": "SecurityContextInterceptor always uses doPrivilidged even when a security manager is not present", "bug_description": "This is slow. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.ejb3.security.SecurityContextInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 2033, "bug_title": "NotSupported tx attribute is not taken into account without a MethodIntf for CMT MDB", "bug_description": "A MDB is configured using a deployment descriptor as a CMT with:\n\n\n\n\n\n\n    <assembly-descriptor>\n\n\n\n\n        <container-transaction>\n\n\n\n\n            <method>\n\n\n\n\n                <ejb-name>ContainerManagedTransactionNotSupportedMDBWithDD</ejb-name>\n\n\n\n\n                <method-name>onMessage</method-name>\n\n\n\n\n                <method-params>\n\n\n\n\n                    <method-param>javax.jms.Message</method-param>\n\n\n\n\n                </method-params>\n\n\n\n\n            </method>\n\n\n\n\n            <trans-attribute>NotSupported</trans-attribute>\n\n\n\n\n        </container-transaction>\n\n\n\n\n    </assembly-descriptor>\n\n\n\n\n\n\nAccording to the sec, a call to MessageDrivenContext.setRollbackOnly() in the MDB&apos;s onMessage() method must throw an illegal state exception (as there is no active transaction).\nThat Is&apos;s not the case.\nI debugged the code and WildFly identifies the invocation as the component MESSAGE_ENDPOINT methodIntf and its tx attribute as REQUIRED. The call to MessageDrivenContext.setRollbackOnly() succeeds when it must not.\nThe component txattrs do contain a BEAN methodIntf for the same method onMessage(javax.jms.Message) with NOT_SUPPORTED that corresponds to the deployment descriptor but it is not used.\nIf I explicitly set\n\n\n\n\n\n\n   <method-intf>MessageEndpoint</method-intf>\n\n\n\n\n\n\nthe test passes (MessageDrivenContext.setRollbackOnly() throws the expected exception)\nI think it is a bug to have to specify the <method-intf> in the DD. The test should pass without it as this \"style 3\" method declaration is legal for MDB.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.ejb3.deployment.processors.merging.MethodPermissionsMergingProcessor.java", "org.jboss.as.ejb3.deployment.processors.merging.TransactionAttributeMergingProcessor.java", "org.jboss.as.ejb3.context.EJBContextImpl.java", "org.jboss.as.ejb3.deployment.processors.merging.AbstractMergingProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 2048, "bug_title": "Subsystem testing framework uses incorrect subsystem dependencies for old versions", "bug_description": "When upgrading to Infinispan 6.0, I had to @Ignore the following test:\norg.jboss.as.clustering.infinispan.subsystem.InfinispanSubsystemTransformerTestCase\nThe subsystem test framework attempt to run old versions of the infinispan subsystem against the dependencies of the current subsystem version.\nOn another note - I find this framework very cumbersome to debug when things go wrong since there is no output from starting the server.  So, all I know is it failed, without any indication why.  In my case, I add debug logging to the add operation handler and find that the add operation handlers throw NoClassDefFoundErrors and NoSuchMethodErrors, due to the framework attempting to use the 7.2 and 7.1.x versions of the subsystem with the dependencies from 8.0.  In the case of Infinispan 6.0, there are API changes that render it incompatible with the 7.2 and 7.1.x versions of the subsystem.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.InfinispanSubsystemTransformerTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1547, "bug_title": "deploy directories not cleaned up", "bug_description": "JBoss EAP 6.0.0 (and 6.0.1.ER3) doesn&apos;t clean up it&apos;s tmp/vfs directories.\nThe following reproduces this -\ni) ensure run.conf has the -Xrs set\nii) ensure deployments has a deployable .ear in it\niii) ./run standalone.sh and allow the deployments to deploy\niv) stop the EAP process ie kill <process_id>\nv) observe content tmp/vfs\n(The -Xrs parameter is used to \"-Xrs\" to prevent possible interference when JVM is running as a service and receives CTRL_LOGOFF_EVENT or SIGHUP)\nThis will eventually because problems with lack of disk space.\nNote if the -Xrs parameter content is removed but the tmp/vfs dirs stills exist. This could potentially because inode problems.\nIt would be better if there were any additional code so the temp dirs are cleaned up on start up. That would resolve both the -Xrs problem and the excessive dir creation.\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.cli.handlers.UndeployHandler.java", "org.jboss.as.cli.handlers.DeployHandler.java", "org.jboss.as.server.deployment.module.TempFileProviderService.java", "org.jboss.as.server.deployment.DeploymentMountProvider.java"], "label": 1, "es_results": []}, {"bug_id": 2075, "bug_title": "ModelController JMX integration does not filter out bogus attributes from resource descriptions", "bug_description": "If the resource description provided by a resource includes a bogus attribute that is actually a child type, the JMX integration produces an MBeanAttributeInfo for it. MBeanInfoFactory can detect this situation and should do so.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.controller.registry.ImmutableManagementResourceRegistration.java", "org.jboss.as.jmx.model.MBeanInfoFactory.java"], "label": 1, "es_results": []}, {"bug_id": 1974, "bug_title": "@Resource ManagedExecutorService produces a null field", "bug_description": "I compiled the latest WildFly master and tried:\n\n\n\n\n\n\n@Resource\n\n\n\n\nprivate ManagedExecutorService managedExecutorService\n\n\n\n\n\n\nHowever, the injected field managedExecutorService is null. This issue is gone when I use:\n\n\n\n\n\n\n@Resource(mappedName = \"java:comp/DefaultManagedExecutorService\")\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.weld.services.bootstrap.WeldResourceInjectionServices.java"], "label": 1, "es_results": []}, {"bug_id": 2065, "bug_title": "Update jboss-transaction-spi", "bug_description": "The JPA integration test suite tests that the afterCompletion synchonization callback for timed out transactions is called from the TM transaction reaper thread by hard coding the reaper thread name. The latest SPI jar includes an interface method that does the same job. I&apos;d like to update the test suite to use the new SPI method.\nI have marked the jira as a bug since testing against the reaper thread name is brittle.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.test.integration.jpa.mockprovider.txtimeout.TxTimeoutTestCase.java", "org.jboss.as.test.integration.jpa.mockprovider.txtimeout.SFSB1.java", "org.jboss.as.test.integration.jpa.mockprovider.txtimeout.TestEntityManager.java", "org.jboss.as.jpa.transaction.TransactionUtil.java"], "label": 1, "es_results": []}, {"bug_id": 2114, "bug_title": "CLI GUI does not show dialog for add operation if there are no params in the op description", "bug_description": "Example is /subsystem=webservices/client-config=*/:add\nIf you right-click on client-config=* and choose the &apos;add&apos; operation you will not get a dialog.  This is because there are no params in the operation description.  However, for &apos;add&apos; operations there is an implicit &apos;name&apos; param that becomes part of the address.  So CLI GUI should still prompt for the name.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.cli.gui.OperationMenu.java"], "label": 1, "es_results": []}, {"bug_id": 2146, "bug_title": "Domain testsuite classes are leaking remoting Endpoints", "bug_description": "DomainControllerClientConfig creates a remoting endpoint. Not all uses of this class are closing it, thus leaking endpoints.\nThis is a factor in some of the recent testsuite instability where runs are failing due to reaching user process limits. At the max, the leak results in 68 extra threads.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.test.integration.domain.suites.CLITestSuite.java", "org.jboss.as.test.integration.domain.management.util.DomainControllerClientConfig.java", "org.jboss.as.test.integration.domain.management.cli.DataSourceTestCase.java", "org.jboss.as.test.integration.domain.management.util.DomainLifecycleUtil.java", "org.jboss.as.test.integration.domain.ExpressionSupportSmokeTestCase.java", "org.jboss.as.test.integration.respawn.TestControllerUtils.java", "org.jboss.as.test.integration.domain.DomainControllerMigrationTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2181, "bug_title": "TempFileProviderService creates a static, non-daemon thread pool", "bug_description": "This can prevent the server from shutting down", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.server.deployment.module.TempFileProviderService.java"], "label": 1, "es_results": []}, {"bug_id": 2096, "bug_title": "WeldApplicationFactory does not implement setApplication() correctly", "bug_description": "The problem is described in WELD-913. The fix was only applied to Weld servlet support [1] and not AS7/WildFly8 integration code (most probably because the target environment of the issue was Tomcat).\n[1]\nhttps://github.com/weld/core/blob/master/environments/servlet/core/src/main/java/org/jboss/weld/environment/servlet/jsf/WeldApplicationFactory.java", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.jsf.injection.weld.WeldApplicationFactory.java"], "label": 1, "es_results": []}, {"bug_id": 2136, "bug_title": "persistence.xml with org.hibernate.ejb.HibernatePersistence should deploy with Hibernate ORM 4.3.x", "bug_description": "currently users migrating from earlier app server versions will get http://pastebin.com/4tRk75vh", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.jpa.config.Configuration.java"], "label": 1, "es_results": []}, {"bug_id": 2057, "bug_title": "org.jboss.as.server.deployment.RegisteredDeploymentUnitProcessor has unstable compareTo()", "bug_description": "As the description says, org.jboss.as.server.deployment.RegisteredDeploymentUnitProcessor&apos;s compareTo is wrong.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.server.deployment.RegisteredDeploymentUnitProcessor.java", "org.jboss.as.messaging.MessagingSubsystemAdd.java", "org.jboss.as.ee.subsystem.EeSubsystemAdd.java", "org.jboss.as.weld.WeldSubsystemAdd.java", "org.jboss.as.server.DeployerChainAddHandler.java", "org.jboss.as.ejb3.subsystem.EJB3SubsystemAdd.java", "org.jboss.as.server.deployment.module.descriptor.DeploymentStructureDescriptorParser.java", "org.jboss.as.appclient.subsystem.AppClientSubsystemAdd.java", "org.jboss.as.jpa.subsystem.JPASubSystemAdd.java", "org.jboss.as.server.deployment.dependencies.DeploymentDependenciesProcessor.java", "org.wildfly.extension.undertow.UndertowSubsystemAdd.java", "org.jboss.as.server.deployment.Phase.java", "org.jboss.as.jsf.subsystem.JSFSubsystemAdd.java", "org.jboss.as.server.ServerMessages.java"], "label": 1, "es_results": []}, {"bug_id": 2197, "bug_title": "ClientCompatibilityUnitTestCase is broken in an IPv6 environment", "bug_description": "ClientCompatibilityUnitTestCase has \"localhost\" hard coded as the address it tries to connect to. This fails when IPv6 is configured for testsuite runs, as the server is not listening on 127.0.0.1 but rather ::1.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.test.integration.management.api.ClientCompatibilityUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2206, "bug_title": "Manualmode test suite copies the modules directory multiple times", "bug_description": "This uses lots of disk space for no good reason", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.test.manualmode.layered.LayeredDistributionTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2014, "bug_title": "Intermittent failures in WSTestCase.testManagementDescription", "bug_description": "This pops up quite frequently for a long time now (weeks or months):\nhttps://github.com/wildfly/wildfly/pull/5009#issuecomment-23898664\nI&apos;m going to send a PR to @Ignore the test.\nAlso, IMHO this test method doesn&apos;t belong in smoke.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.test.smoke.webservices.WSTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2069, "bug_title": "can not switch from connector to discovery-group-name for JMS (pooled-) connection factories ", "bug_description": "connectors and discovery-group-name are alternative attributes of JMS (pooled) connection factories.\nIf a resource defines one of this attribute, it must be able to \"switch\" to the other by running a batch command to:\n1. undefine the attribute\n2. write the value of the other attribute\nThis currently does not work:\n\n\n\n\n\n\n[standalone@localhost:9999 /] batch\n\n\n\n\n[standalone@localhost:9999 / #] /subsystem=messaging/hornetq-server=default/connection-factory=RemoteConnectionFactory:undefine-attribute(name=connector)\n\n\n\n\n#1 /subsystem=messaging/hornetq-server=default/connection-factory=RemoteConnectionFactory:undefine-attribute(name=connector)\n\n\n\n\n[standalone@localhost:9999 / #] /subsystem=messaging/hornetq-server=default/connection-factory=RemoteConnectionFactory:write-attribute(name=discovery-group-name,value=dg-group1)\n\n\n\n\n#2 /subsystem=messaging/hornetq-server=default/connection-factory=RemoteConnectionFactory:write-attribute(name=discovery-group-name,value=dg-group1)\n\n\n\n\n[standalone@localhost:9999 / #] run-batch\n\n\n\n\n{\"JBAS014653: Composite operation failed and was rolled back. Steps that failed:\" => {\"Operation step-1\" => \"JBAS011630: Alternative attribute of (connector) is already defined.\"}}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Beta1", "fixed_files": ["org.jboss.as.messaging.jms.ConnectionFactoryWriteAttributeHandler.java", "org.jboss.as.messaging.jms.ConnectionFactoryAttributes.java", "org.jboss.as.messaging.AlternativeAttributeCheckHandler.java", "org.jboss.as.messaging.MessagingMessages.java"], "label": 1, "es_results": []}, {"bug_id": 2210, "bug_title": "fix message endpoint isDeliveryTransacted", "bug_description": "The org.jboss.as.ejb3.inflow.MessageEndpointService#isDeliveryTransacted method is checking the transaction attribute of the method using the MethodIntf.BEAN while it should use the MethodIntf.MESSAGE_ENDPOINT type.\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.ejb3.component.messagedriven.MessageDrivenComponent.java"], "label": 1, "es_results": []}, {"bug_id": 1913, "bug_title": "CLI 'module add' command fail if a drive letter is specified in its resource path", "bug_description": "If a drive letter is specified in the resource path the module add command fails on MS Windows. It cannot locate such a resource because of doubled drive letter in the translated path.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.cli.handlers.module.ASModuleHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1740, "bug_title": "ManagedSocketBinding class Impossible cast from java.net.InetAddress to java.net.InetSocketAddress", "bug_description": "Reported by FindBugs:\nImpossible cast from java.net.InetAddress to java.net.InetSocketAddress\nClass:\nManagedSocketBinding (org.jboss.as.network) line 55\nMethod:\ngetBindAddress (org.jboss.as.network.ManagedSocketBinding.getBindAddress())\nPriority:\n  High Confidence Correctness\n\nProblem classification:\nCorrectness (Bad casts of object references)\nBC_IMPOSSIBLE_CAST (Impossible cast)\nNotes:\nActual type java.net.InetAddress\nExpected java.net.InetSocketAddress\nReturn value of Class.cast(Object)\nFindBadCast2 (BECAUSE|NP)", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.network.ManagedSocketBinding.java"], "label": 1, "es_results": []}, {"bug_id": 2209, "bug_title": "short versions of command arguments (e.g. -h) are not recognized", "bug_description": "The validation of command arguments doesn&apos;t take into account their short versions leading rejecting the command in case the short versions are used (e.g. -h for --help).", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.cli.handlers.CommandHandlerWithArguments.java"], "label": 1, "es_results": []}, {"bug_id": 2023, "bug_title": "review output of jboss-cli for batches", "bug_description": "jboss-cli displays lines of input file, although they are not executed.\nIf not executed hey should not be printed.\nIt might be useful to introduce a command line option \"--verbose\" an to print everything to stdout, if / command / end-if. Maybe even the output of the commands executed (read-resource, add).", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2204, "bug_title": "runtime exceptions thrown during parsing crash cli sessions", "bug_description": "Runtime exceptions thrown during command line parsing crash CLI sessions.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java", "org.jboss.as.cli.parsing.StateParser.java"], "label": 1, "es_results": []}, {"bug_id": 2051, "bug_title": "CLI write attribute dialog for string value should enclose value in generated command to double quotes", "bug_description": "\n\n\n\n\n\nWildfly issue for https://bugzilla.redhat.com/show_bug.cgi?id=988283\n\n\n\n\n\n\n\n\n\nString value entered in write attribute dialog is written to command without double quotes, which is wrong in many cases\n\n\n\n\n\n\n\n\n\nEg. when user enteres in dialog value ${jboss.bind.address:127.0.0.1}\n\n\n\n\nfollowing command is generated:\n\n\n\n\n\n\n\n\n\n/subsystem=webservices/:write-attribute(name=wsdl-host,value=${jboss.bind.address:127.0.0.1})\n\n\n\n\n\n\n\n\n\nCorrectly should be generated command \n\n\n\n\n/subsystem=webservices/:write-attribute(name=wsdl-host,value=\"${jboss.bind.address:127.0.0.1}\")\n\n\n\n\n\n\n\n\n\n1. start AS\n\n\n\n\n  ./bin/standalone.sh\n\n\n\n\n2. start CLI GUI \n\n\n\n\n  ./bin/jboss-cli.sh --gui &\n\n\n\n\n3. click on node subsystem=webservices of /\n\n\n\n\n4. right click on wsdl-host and select write-attribute\n\n\n\n\n5. enter value ${jboss.bind.address:127.0.0.1} and click OK\n\n\n\n\n6. submit generated command\n\n\n\n\n7. reload node\n\n\n\n\n  click on node subsystem=webservices of / (close node)\n\n\n\n\n  click on node subsystem=webservices of / (open node)\n\n\n\n\n\n\n\n\n\nResult is wsdl-host=$ instead of wsdl-host=${jboss.bind.address:127.0.0.1}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWorkaround: in dialog box enclose the value in double quotes\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.cli.parsing.arguments.ArgumentValueState.java", "org.jboss.as.cli.parsing.test.ArgumentValueParsingTestCase.java", "org.jboss.as.test.integration.management.cli.FileWithPropertiesTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 1592, "bug_title": "Attempting to use eap6.1 jboss-cli.sh to connect to remote wildfly (alpha1 or 2) fails; credentials not accepted", "bug_description": "Using eap6.1 client jars, or the jboss-cli.sh script in a local eap6.1 installation, to connect to a remote wildfly alpha1 or alpha2, seems to work but fails when provided with credentials.  This is most easily replicated as follows:\n1) On remote machine start wildfly alpha1 or alpha2\n2) on local machine, cd eap-6.1/bin\n3) on local machine:\n[rob@rawbdor bin]$ ./jboss-cli.sh \nYou are disconnected at the moment. Type &apos;connect&apos; to connect to the server or &apos;help&apos; for the list of supported commands.\n[disconnected /] connect myhost.net \nAuthenticating against security realm: ManagementRealm\nUsername: admin\n Password: \nUnable to authenticate against controller at myhost.net:9999: Authentication failed: all available authentication mechanisms failed\nThis is an issue for tools as we need a set of jars that communicates correctly with all as7 servers. We currently have a set of jars that communicates with all 7.x / eap 6.x, which is good. If this is merely a bug on the server, then we can hopefully delay having to bundle an additional set of client jars until larger breakages occur. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha2", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.remoting.RealmSecurityProvider.java", "org.jboss.as.server.operations.NativeManagementAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 1736, "bug_title": "CommandLineArgumentUsage class substring value discarded", "bug_description": "CommandLineArgumentUsage class has a substring call but return value discarded:\n\n\n\n\n\n\nif( input.get(0).length() > width ){\n\n\n\n\n                    String tooLong = input.remove(0);\n\n\n\n\n                    tooLong.substring(0, width-5);\n\n\n\n\n                    input.add(\"Command removed. Too long.\");\n\n\n\n\n                }\n\n\n\n\n\n\nFindBugs also finds a static field should be final:\n\n\n\n\n\n\nprotected static List<String> instructions = new ArrayList<String>();\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.process.CommandLineArgumentUsage.java"], "label": 1, "es_results": []}, {"bug_id": 2304, "bug_title": "SESSION_DRAINING_STRATEGY is missing a validator and incorrectly uses setAlternatives()", "bug_description": "\nthis is wrong .setAlternatives(\"DEFAULT\", \"ALWAYS\" , \"NEVER\")\nadd a proper validator\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.wildfly.extension.mod_cluster.ModClusterSubsystemTestCase.java", "org.wildfly.extension.mod_cluster.ModClusterConfigResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 2321, "bug_title": "Add user configuration loading broken if executed from any folder other than bin", "bug_description": "Also should remove the system property reading and just rely on the location being bin.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.domain.management.security.password.PasswordCheckUtilTestCase.java", "org.jboss.as.domain.management.security.adduser.PromptPasswordState.java", "org.jboss.as.domain.management.security.password.simple.SimplePasswordStrengthCheckerTestCase.java", "org.jboss.as.domain.management.security.adduser.ValidatePasswordState.java", "org.jboss.as.domain.management.security.password.PasswordCheckUtil.java", "org.jboss.as.domain.management.security.adduser.RuntimeOptions.java", "org.jboss.as.domain.management.security.adduser.AddUser.java"], "label": 1, "es_results": []}, {"bug_id": 2237, "bug_title": "JMX subsystem transformers for 7.2.0", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.jmx.JMXSubsystemTestCase.java", "org.jboss.as.jmx.JMXExtension.java"], "label": 1, "es_results": []}, {"bug_id": 2273, "bug_title": "Error message in the log on every click within the console in domain mode.", "bug_description": "While running Wildfly in domain mode (i.e domain.sh) every click within the admin console produces and error message in the server log. \n[Host Controller] 13:53:38,148 ERROR [org.jboss.as.controller.client] (XNIO-1 task-12) JBAS014781: Step handler org.jboss.as.domain.controller.operations.coordination.DomainFinalResultHandler@576bca9e for operation composite at address [] failed handling operation rollback  null", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.domain.controller.operations.coordination.DomainOperationContext.java", "org.jboss.as.controller.ControllerMessages.java", "org.jboss.as.controller.AbstractOperationContext.java"], "label": 1, "es_results": []}, {"bug_id": 2344, "bug_title": "undertow claims already registered", "bug_description": "I&apos;ve downloaded wildfly beta, attempted to add a vhost using the undertow configuration (can&apos;t find documentation by the way) but when it starts, it says:\norg.jboss.msc.service.DuplicateServiceException: Service jboss.web.common.host./ is already registered \nI originally posted the question here:\nhttps://community.jboss.org/message/842352\nThe relevant config section (standalone.xml) is the following:\n<subsystem xmlns=\"urn:jboss:domain:undertow:1.0\">\n\t<buffer-caches>\n\t\t<buffer-cache name=\"default\" buffer-size=\"1024\" buffers-per-region=\"1024\" max-regions=\"10\"/>\n\t</buffer-caches>\n\t<server name=\"default-server\">\n\t\t<http-listener name=\"default\" socket-binding=\"http\" max-post-size=\"10485760\"/>\n\t\t<host name=\"default-host\" alias=\"localhost\">\n\t\t\t<location name=\"/\" handler=\"welcome-content\"/>\n\t\t</host>\n\t\t<host name=\"other-host\" alias=\"www.mysite.com\" default-web-module=\"something.war\">\n\t\t\t<location name=\"/\" handler=\"welcome-content\">\n\t\t\t\t<filter-ref name=\"connection-limit\"/>\n\t\t\t</location>\n\t\t</host>\n\t</server>\n\t<servlet-container name=\"default\" default-buffer-cache=\"default\" stack-trace-on-error=\"local-only\">\n\t\t<jsp-config/>\n\t\t<persistent-sessions path=\"persistent-web-sessions\" relative-to=\"jboss.server.data.dir\"/>\n\t</servlet-container>\n\t<handlers>\n\t\t<file name=\"welcome-content\" path=\"$\n{jboss.home.dir}\n/welcome-content\" directory-listing=\"true\"/>\n\t</handlers>\n</subsystem>", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.LocationAdd.java"], "label": 1, "es_results": []}, {"bug_id": 2335, "bug_title": "BroadcastGroupAdd model population fails on JDK8", "bug_description": "http://brontes.lab.eng.brq.redhat.com/viewLog.html?buildId=4515\nAll messaging subsystem tests passes on JDK7 but fails with JDK8 because BroadcastGroupAdd#populateModel falsely assumes that the connector resources have been populated before the current broadcast-group.\nThere is no such guarantee, the connector-refs validations must be done in a separate OperationStepHandler after all the MODEL&apos;s OSHs instead.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.messaging.BroadcastGroupAdd.java"], "label": 1, "es_results": []}, {"bug_id": 2291, "bug_title": "Bump messaging XML namespace to 2.0", "bug_description": "The XML namespace for the messaging subsystem was erroneously bumped from 1.3 to 1.4 for WildFly 8.\nThis is an error as the 1.x version must be reserved for AS7 7.x releases.\nWildFly 8 will use a 2.0 namespace. \nThis means that configurations written against WildFly 8.0.0 Alpha and Beta will break once the XML namespace is corrected to 2.0.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.messaging.Namespace.java", "org.jboss.as.messaging.MessagingExtension.java", "org.jboss.as.messaging.MessagingSubsystemParser.java", "org.jboss.as.messaging.Messaging14SubsystemParser.java", "org.jboss.as.messaging.test.MessagingSubsystem14TestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2359, "bug_title": "Clustering AsynchronousService should stop asynchronously by default", "bug_description": "By default, org.jboss.as.clustering.msc.AsynchronousService stops its service synchronously.  This was done to workaround MSC ordering issues with stopping of dependent services.  This no longer appears to be an issue.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.clustering.msc.AsynchronousService.java"], "label": 1, "es_results": []}, {"bug_id": 1949, "bug_title": "SimpleScheduleSecondTestCase fails", "bug_description": "org.jboss.as.test.integration.ejb.timerservice.schedule.SimpleScheduleSecondTestCase fails.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.test.integration.ejb.timerservice.cdi.requestscope.AnnotationTimerServiceBean.java", "org.jboss.as.test.integration.ejb.timerservice.view.TimedObjectTimerServiceBean.java", "org.jboss.as.test.integration.ejb.timerservice.security.TimerGetCallerPrincipleBean.java", "org.jboss.as.test.integration.ejb.timerservice.view.AnnotationTimerServiceBean.java", "org.jboss.as.test.integration.ejb.timerservice.simple.AnnotationTimerServiceBean.java", "org.jboss.as.test.integration.ejb.timerservice.simple.TimedObjectTimerServiceBean.java", "org.jboss.as.test.integration.ejb.timerservice.serialization.TimerServiceSerializationBean.java", "org.jboss.as.test.integration.ejb.timerservice.aroundtimeout.BeanParent.java", "org.jboss.as.test.integration.ejb.timerservice.schedule.SimpleScheduleBean.java", "org.jboss.as.test.integration.ejb.timerservice.database.TimedObjectTimerServiceBean.java"], "label": 1, "es_results": []}, {"bug_id": 2333, "bug_title": "Web deployment code assumes only a single ServletContainerInitializer is present in each jar", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.deployment.ServletContainerInitializerDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 2296, "bug_title": "Patched state is missing the updated resulting version", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.patching.runner.IdentityPatchContext.java", "org.jboss.as.patching.installation.InstallationManager.java", "org.jboss.as.patching.installation.InstallationModificationImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2373, "bug_title": "patching resource does not get registered on slave hosts", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.host.controller.DomainModelControllerService.java", "org.jboss.as.test.integration.domain.management.util.DomainLifecycleUtil.java", "org.jboss.as.test.integration.domain.management.util.ProcessWrapper.java"], "label": 1, "es_results": []}, {"bug_id": 2320, "bug_title": "EJB should not be remotely accessible until all of its dependencies have been started", "bug_description": "If an EJB injects or depends on a resource such as an @Singleton which has not been started, the EJB&apos;s remote interface java:jboss/exported/* is already bound and this allows remote EJB clients to try to invoke it.  This causes the EJB clients to hang because the EJB will not be started until its dependencies have been started.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.jsr77.subsystem.RegisterManagementEJBService.java", "org.jboss.as.ejb3.deployment.processors.DeploymentRepositoryProcessor.java", "org.jboss.as.ejb3.deployment.DeploymentRepository.java", "org.jboss.as.ejb3.deployment.DeploymentRepositoryListener.java", "org.jboss.as.ejb3.remote.protocol.versionone.EJBIdentifierBasedMessageHandler.java", "org.jboss.as.ejb3.remote.LocalEjbReceiver.java", "org.jboss.as.ejb3.remote.protocol.versionone.VersionOneProtocolChannelReceiver.java", "org.jboss.as.ejb3.deployment.ModuleDeployment.java"], "label": 1, "es_results": []}, {"bug_id": 1746, "bug_title": "CDI beans in static modules cannot see each other", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha3", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.weld.deployment.WeldAttachments.java", "org.jboss.as.weld.deployment.processors.WeldDeploymentProcessor.java", "org.jboss.as.weld.deployment.processors.ExternalBeanArchiveProcessor.java", "org.jboss.as.weld.deployment.BeanDeploymentArchiveImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2390, "bug_title": "SimpleOperationDefinitionBuilder.withFlags discards existing flags", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.test.integration.domain.rbac.AbstractStandardRolesTestCase.java", "org.jboss.as.controller.SimpleOperationDefinitionBuilder.java", "org.jboss.as.test.integration.management.rbac.RbacUtil.java", "org.jboss.as.test.integration.domain.rbac.AbstractRbacTestCase.java", "org.jboss.as.test.integration.domain.rbac.AbstractHostScopedRolesTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2016, "bug_title": "Security context associated with EJB asynchronous invocations can potentially be corrupted over time by the caller thread", "bug_description": "Consider a servlet \"S\" which invokes on a asynchronous EJB \"A\". Let&apos;s assume \"S\" runs with a \"foo\" run-as role. Now when S invokes on \"A\", the run-as \"foo\" role is correctly propagated to the asynchronous EJB invocation. However, when the \"S\" invocation completes and potentially clears the security context (of any run-as role), the invocation(s) within the asynchronous EJB \"A\" too lose the corresponding security context role association. This is because the 2 threads (the servlet invocation one and the async EJB invocation one) literally share the same object instance of the SecurityContext.\nThe expected behaviour is that the original security context (attributes) are copied over to the async invocation and updates to that security context later on in a separate thread shouldn&apos;t affect the ongoing async EJB invocation.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.ejb3.component.interceptors.AsyncFutureInterceptorFactory.java"], "label": 1, "es_results": []}, {"bug_id": 2161, "bug_title": "JBAS014356 exception not thrown for @Asyncronous EJB methods", "bug_description": "If you call an ejb method with default visibility (e.g. from a servlet in the same package), an EJBException with code JBAS014356 is thrown because the method is not public.\nIf the method is annotated with @Asynchronous and returns void, the exception is not seen because the interceptor from AsyncFutureInterceptorFactory is used before NotBusinessMethodInterceptor, the exception is thrown in the worker thread instead.\nWith a void return, the exception is silently dropped. With a Future<?> return, it will be set as the failure exception on the future rather than being thrown from the call.\nAs per the forum reference we need to check the spec, but the validity of the business method should probably be checked before the handoff to the worker thread.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.ejb3.component.session.SessionBeanComponentDescription.java", "org.jboss.as.ee.component.interceptors.InterceptorOrder.java"], "label": 1, "es_results": []}, {"bug_id": 2345, "bug_title": "Port offset 0 does not work", "bug_description": "When a port offset is specified in the socket binding group and the socket binding has a port of 0, then the port offset is not used to calculate the port instead port 0 is bound.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.network.SocketBinding.java", "org.jboss.as.subsystem.test.otherservices.OtherServicesSubsystemTestCase.java", "org.jboss.as.subsystem.test.ControllerInitializer.java"], "label": 1, "es_results": []}, {"bug_id": 2411, "bug_title": "SecurityRealm authentication does not get marshalled when empty", "bug_description": "The /core-service=management/security-realm=ManagementRealm/authentication=users resource does not get persisted in case it does not contain any users. This causes problems since the resource is not restored after a reload or restart of the server.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.domain.management.parsing.ManagementXml.java"], "label": 1, "es_results": []}, {"bug_id": 2312, "bug_title": "WebVirtualHostDefinition is not validating enable-welcome-root vs default-web-module", "bug_description": "The validation of the relationship between enable-welcome-root and default-web-module was dropped during the conversion of the legacy web module to model-only mode.\nThis is no big deal as any legacy slave (without which the subsystem is pointless) will reject a problem. But I want to fix it anyway as the fix will help illustrate how to do a patch for EAP.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.web.WriteDefaultWebModule.java", "org.jboss.as.web.WebVirtualHostDefinition.java", "org.jboss.as.web.WriteEnableWelcomeRoot.java"], "label": 1, "es_results": []}, {"bug_id": 2420, "bug_title": "Domain controller fails to restart due to an inconsistent rollback of a redeploy", "bug_description": "Osamu Nagano reports:\nWhen you try to redeploy (or deploy with --force option) the same application which has the same contents hash, and a necessary dependency like a datasource beeing injected in the application is lost by some reason, the redeploy operation will delete the contents under $JBOSS_HOME/domain/data/content directory but won&apos;t delete entries in domain.xml. Then the domain controller fails to start up because no contents found in the directory. This likely happens when you frequently changes settings during other servers shutting down.\nThe domain controller fails to restart with the following log messages.\n\n12:04:10,623 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) JBAS014613: Operation (\"add\") failed - address: ([(\"deployment\" => \"exampleapp.war\")]) - failure description: \"JBAS010876: No deployment content with hash c1306bc4855f4ed9914c9616f2b999c5c62a79d3 is available in the deployment content repository for deployment &apos;exampleapp.war&apos;. This is a fatal boot error. To correct the problem, either restart with the --admin-only switch set and use the CLI to install the missing content or remove it from the configuration, or remove the deployment from the xml configuraiton file and restart.\"\n12:04:10,628 FATAL [org.jboss.as.host.controller] (Controller Boot Thread) JBAS010933: Host Controller boot has failed in an unrecoverable manner; exiting. See previous messages for details.\n\nThe domain controller should be independent from such a server specific issue and there should be a way to fix this via CLI or Console, not by a manual editing of domain.xml.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.server.deployment.DeploymentFullReplaceHandler.java", "org.jboss.as.domain.controller.operations.deployment.DeploymentFullReplaceHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2214, "bug_title": "Allow additional environment properties to be set for outbound LDAP connections used by security realms.", "bug_description": "LDAP security realm needs to have configurable timeouts.\nThe default LDAP connection timeout appears to be 2 minutes.  If the ldap server is down, it could take 2 minutes for the connection to timeout.  This can cause unneeded delay if you have configured multiple ldap servers for  failover / redundancy.\nThe following hack appears to work:\n+++ domain-management/src/main/java/org/jboss/as/domain/management/connections/ldap/LdapConnectionManagerService.java\n@@ -132,6 +132,7 @@ public class LdapConnectionManagerService implements Service<LdapConnectionManag\n         result.put(Context.INITIAL_CONTEXT_FACTORY,initialContextFactory);\n         String url = config.require(URL).asString();\n         result.put(Context.PROVIDER_URL,url);\n+        result.put(\"com.sun.jndi.ldap.connect.timeout\", \"500\");\n         return result;\n     }", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.domain.management.connections.ldap.LdapConnectionManagerService.java", "org.jboss.as.domain.management.parsing.ManagementXml.java", "org.jboss.as.domain.management.connections.ldap.LdapConnectionResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 1509, "bug_title": "Test transformation of jmx audit log resources against AS 7.2.0 (ModelVersion 1.2.0)", "bug_description": "Do this once the artifacts are uploaded to maven, or the subsystem test stuff is changed to be able to use the internal maven repository for certain tests", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.jmx.JMXSubsystemTestCase.java", "org.jboss.as.jmx.JMXExtension.java"], "label": 1, "es_results": []}, {"bug_id": 1999, "bug_title": "Wrong parsing of modify-trust-store element in jboss-cli.xml", "bug_description": "The Boolean parsing should be used when configuring modifyTrustStore flag and not reading system property:\n\n\n\n\n\n\nconfig.setModifyTrustStore(Boolean.getBoolean(reader.getElementText()));\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.cli.impl.CliConfigImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2281, "bug_title": "Exception from lifecycle callback interceptor method intercepting a session bean gets suppressed without log message", "bug_description": "From EJB spec., \"9.3.3 Exceptions from AroundConstruct, PostConstruct and PreDestroy Lifecycle Callbacks\", \"Table 11\" it follows that the container should log the exception or error thrown by a lifecycle callback interceptor method of a session bean or a message-driven bean.\nThe thrown throwable gets suppressed. However, I cannot find any sign of it in the server log (using default settings - debug level).\nI&apos;m not a spec. expert, but I think if the exception is not logged, it should at least not get suppressed. I made some tests that might be of help (available at https://github.com/bafco/wildfly/commits/WFLY-2281) - according to the spec., they probably don&apos;t have to pass.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.weld.ejb.Jsr299BindingsInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 2255, "bug_title": "ManagedAuditLoggerImpl does not replace handlers correctly", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.controller.audit.ManagedAuditLoggerImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2191, "bug_title": "Intermittent fail of AdvancedLdapLoginModuleTestCase and SPNEGOLoginModuleTestCase due to java.nio.BufferOverflowException", "bug_description": "org.jboss.as.test.integration.security.loginmodules.negotiation.AdvancedLdapLoginModuleTestCase and\norg.jboss.as.test.integration.security.loginmodules.negotiation.SPNEGOLoginModuleTestCase \nfail intermittently after java.nio.BufferOverflowException in Apache directory server. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.domain.management.access.AccessAuthorizationResourceDefinition.java", "org.jboss.as.host.controller.parsing.HostXml.java"], "label": 1, "es_results": []}, {"bug_id": 2467, "bug_title": "Deadlock on startup if configured w/8 transactional Infinispan caches", "bug_description": "CacheConfigurationService should be installed using AsynchronousService wrapper.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.CacheAdd.java"], "label": 1, "es_results": []}, {"bug_id": 2477, "bug_title": "Lifecycle callback methods not invoked on interceptors intercepting servlet component classes", "bug_description": "Even after fix for https://issues.jboss.org/browse/WFLY-2375, the @PostConstruct and @PreDestroy methods on interceptors (bound using interceptor bindings) intercepting servlet component classes are not invoked.\nTests available here: https://github.com/bafco/wildfly/commits/WFLY-2375-tests (only for servlets at the moment).", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.weld.util.Utils.java", "org.jboss.as.weld.injection.WeldComponentService.java", "org.jboss.as.weld.deployment.processors.WeldComponentIntegrationProcessor.java", "org.jboss.as.weld.deployment.WeldClassIntrospector.java"], "label": 1, "es_results": []}, {"bug_id": 2481, "bug_title": "CDI.current().getBeanManager() returns a beanmanager from a different deployment", "bug_description": "CDI.current().getBeanManager() uses the classname of the calling class to cache BeanManagers returned. This fails if multiple deployments contain classes with the same name. For example, wicket-cdi-1.1 looks up the BeanManager from org.apache.wicket.cdi.CdiConfiguration. If multiple Wicket-CDI applications are deployed in the same container, every BeanManager lookup will return the instance cached on the first call.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.weld.deployment.WeldDeployment.java", "org.jboss.as.weld.deployment.BeanDeploymentArchiveImpl.java", "org.jboss.as.weld.WeldBootstrapService.java", "org.jboss.as.weld.WeldProvider.java"], "label": 1, "es_results": []}, {"bug_id": 1309, "bug_title": "CLI: creating a server on a domain slave followed by setting a system property fails when done in batch mode", "bug_description": "Setup two boxes:\n\non one, run domain mode (full-ha) -> domain controller\non the other, configure host.xml to point to the DC, and run the host controller\n\nNow in CLI:\n\nadd the group:\n/server-group=slaves:add(profile=full-ha,socket-binding-group=full-ha-sockets)\n\n\ncreate server and set a prop\nbatch\n/host=slave1/server-config=i1:add(group=slaves,auto-start=false)\n/host=slave1/server-config=i1/system-property=env:add(value=dev)\nrun-batch \n\nresults in:\nJBAS010839: Operation failed or was rolled back on all servers.\nDebugging (on EAP 6.0.1) showed the real reason:\nactiveStep.response = (org.jboss.dmr.ModelNode) \n{\n\n     \"outcome\" => \"failed\",\n\n     \"failure-description\" => \"JBAS010850: No handler for operation\n\ncomposite at address [\n\n     (\\\"host\\\" => \\\"slave1\\\"),\n\n     (\\\"server\\\" => \\\"i1\\\")\n\n]\",\n\n     \"rolled-back\" => true\n\n}\n \nMore debugging led to :\norg.jboss.as.controller.AbstractOperationContext\nseems to be where the rollback is set. When debugging, I found that the constructor always sets\n     ModelController.OperationTransactionControl transactionControl\nbut at line 332 (eap 6.0.1) / line 372 (wildfly), the end of doCompleteStep() :\n        // Allow any containing TransactionControl to vote\n        final AtomicReference<ResultAction> ref = new AtomicReference<ResultAction>(transactionControl == null ? ResultAction.KEEP : ResultAction.ROLLBACK);\nand ref becomes a rollback.\nI \"walked\" pretty much of all the code going on in between. The bit where the config is getting persisted is successful.\nBut I&apos;m afraid I&apos;m out of my depth as there is a lot going on to execute such a composite command ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.test.integration.domain.suites.CoreResourceManagementTestCase.java", "org.jboss.as.domain.controller.operations.coordination.ServerOperationResolver.java"], "label": 1, "es_results": []}, {"bug_id": 2513, "bug_title": "BDA ID contains absolute the path of the deployment location", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.weld.deployment.processors.BeanArchiveProcessor.java", "org.jboss.as.weld.util.Utils.java"], "label": 1, "es_results": []}, {"bug_id": 2494, "bug_title": "@EJB not injected in JAX-RS Resource (unless CDI is enabled)", "bug_description": "\n\n\n\n\n\n@Path(\"persons\")\n\n\n\n\npublic class MyResource {\n\n\n\n\n    // Ideally this state should be stored in a database\n\n\n\n\n    @EJB PersonSessionBean bean; // Not injected unless beans.xml in War\n\n\n\n\n ..\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n@Singleton\n\n\n\n\npublic class PersonSessionBean {\n\n\n\n\n    private final List<Person> list;\n\n\n\n\n\n\n\n\n\n    public PersonSessionBean() {\n\n\n\n\n        list = new ArrayList<>();\n\n\n\n\n    }\n\n\n\n\n ..\n\n\n\n\n}\n\n\n\n\n\n\nSample: https://github.com/arun-gupta/javaee7-samples/tree/master/jaxrs/jaxrs-client/src/main/java/org/javaee7/jaxrs/client", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.jaxrs.deployment.JaxrsAnnotationProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 1745, "bug_title": "WeldServices may get into inconsistent state", "bug_description": "WeldBootstrapService performs an initial bootstrap of the Weld container and also performs Weld shutdown when the service is stopping.\nWeldStartService finishes initialization of Weld container and performs nothing on stop() (WeldBootstrapService is expected to shut down Weld).\nWeldStartService has a dependency on WeldBootstrapService.\nThis works fine 99% of the time. However, if a dependency of WeldStartService is restarted (e.g. due to management operation), WeldStartService as its parent is also restarted but WeldBootstrapService is not. \nAs a result, WeldStartService expects to find Weld container in an early initialization phase and wants to finish initialization. However, since WeldBootstrapService was not restarted, the Weld container is still in the initialized state and deployment fails when WSS tries to finish initialization again.\nTo reproduce modify EjbRemoveUnitTestCase for test-session-remove.jar to contain empty beans.xml file.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha3", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.weld.deployment.processors.WeldDeploymentProcessor.java", "org.jboss.as.weld.WeldStartService.java", "org.jboss.as.test.integration.ejb.stateless.pooling.ejb2.EjbRemoveUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2526, "bug_title": "mod_cluster does not pick up port offset", "bug_description": "So clearly the problem is that the listener is correctly listening on the shifted port:\n[Server:server-two] 20:11:35,674 INFO  [org.wildfly.extension.undertow] (MSC service thread 1-13) JBAS017519: Undertow AJP listener ajp listening on /10.19.222.52:8159\nbut the offet is not picked up by the LB:\n[Wed Oct 09 16:03:40 2013] [debug] proxy_util.c(2193): proxy: connected ajp://10.19.222.52:8009/ to 10.19.222.52:8009\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.network.SocketBinding.java", "org.wildfly.mod_cluster.undertow.UndertowConnector.java"], "label": 1, "es_results": []}, {"bug_id": 2397, "bug_title": "When using weld resource injection happens twice", "bug_description": "When using CDI to inject non-EJB components such as Servlets it appears both Weld and WF are performing resource injections.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.weld.injection.WeldComponentService.java"], "label": 1, "es_results": []}, {"bug_id": 2538, "bug_title": "Certificate acceptance causing command entered on starting the CLI to be skipped.", "bug_description": "e.g.\n\n\n\n\n\n\n./jboss-cli.sh -c shutdown\n\n\n\n\nAccept certificate? [N]o, [T]emporarily, [P]ermenantly : T\n\n\n\n\n\n\nThe shutdown command is not executed.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java"], "label": 1, "es_results": []}, {"bug_id": 786, "bug_title": "NicInterfaceCriteriaUnitTestCase testBasic fails on a host configured with a dual IP stack", "bug_description": "This test fails when we run the test suite with the following IPv6 options:\n\n\n\n\n\n\n    -Djava.net.preferIPv4Stack=false -Djava.net.preferIPv6Addresses=true -Djboss.bind.address=[::1] -Djboss.bind.address.management=[::1] -Djboss.bind.address.unsecure=[::1]\n\n\n\n\n\n\nIt appears that the test is expecting an array containing one nic address but instead gets two (IPv4 and IPv6) addresses. The linked JBTM jira is where we initially reported the issue. Test output is:\n\n\n\n\n\n\nFailed tests:\n\n\n\n\n   testBasic(org.jboss.as.controller.interfaces.NicInterfaceCriteriaUnitTestCase): expected:<[/0:0:0:0:0:0:0:1%1]> but was:<[/0:0:0:0:0:0:0:1%1, /127.0.0.1]>\n\n\n\n\n  testMultipleCriteria(org.jboss.as.controller.interfaces.NotInterfaceCriteriaUnitTestCase): expected:<{name:eth0 (eth0)=[/fe80:0:0:0:216:3eff:fe0e:a61c%2]}> but was:<{name:eth0 (eth0)=[/fe80:0:0:0:216:3eff:fe0e:a61c%2, /172.17.131.3]}>\n\n\n\n\n  testMultipleCriteria(org.jboss.as.controller.interfaces.AnyInterfaceCriteriaUnitTestCase): expected:<{name:lo (lo)=[/0:0:0:0:0:0:0:1%1], name:eth0 (eth0)=[/fe80:0:0:0:216:3eff:fe0e:a61c%2]}> but was:<{name:lo (lo)=[/127.0.0.1, /0:0:0:0:0:0:0:1%1], name:eth0 (eth0)=[/fe80:0:0:0:216:3eff:fe0e:a61c%2, /172.17.131.3]}>\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.controller.interfaces.NotInterfaceCriteriaUnitTestCase.java", "org.jboss.as.controller.interfaces.NicInterfaceCriteriaUnitTestCase.java", "org.jboss.as.controller.interfaces.AnyInterfaceCriteriaUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2519, "bug_title": "Useless mod_cluster drained context logging (...UndertowContext@3abb2fbc)", "bug_description": "\n\n\n\n\n\n18:21:17,409 INFO  [org.jboss.modcluster] (MSC service thread 1-8) MODCLUSTER000021: All pending requests drained from default-host:org.wildfly.mod_cluster.undertow.UndertowContext@3abb2fbc in 0.0 seconds\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.wildfly.mod_cluster.undertow.UndertowContext.java"], "label": 1, "es_results": []}, {"bug_id": 2566, "bug_title": "javax.inject.Singleton not recognized as a bean defining annotation", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.weld.CdiAnnotations.java"], "label": 1, "es_results": []}, {"bug_id": 2570, "bug_title": "hornetq-server runtime operations are not listed in domain mode", "bug_description": "The runtime operations on the messaging&apos;s hornetq-server resources are not listed in domain mode:\n\n\n\n\n\n\n[domain@localhost:9990 /] /host=master/server=server-one/subsystem=messaging/hornetq-server=default:read-operation-names\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => [\n\n\n\n\n        \"read-attribute\",\n\n\n\n\n        \"read-children-names\",\n\n\n\n\n        \"read-children-resources\",\n\n\n\n\n        \"read-children-types\",\n\n\n\n\n        \"read-operation-description\",\n\n\n\n\n        \"read-operation-names\",\n\n\n\n\n        \"read-resource\",\n\n\n\n\n        \"read-resource-description\",\n\n\n\n\n        \"undefine-attribute\",\n\n\n\n\n        \"write-attribute\"\n\n\n\n\n    ]\n\n\n\n\n}\n\n\n\n\n\n\nbut the operations can actually be executed. For example:\n\n\n\n\n\n\n\n\n\n\n\n[domain@localhost:9990 /] /host=master/server=server-one/subsystem=messaging/hornetq-server=default:list-prepared-transactions()\n\n\n\n\n}\n\n\n\n\n{domain@localhost:9990 /]\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => []\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.messaging.HornetQServerControlHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2559, "bug_title": "IronJacamarResourceCreator.java Throws NullPointerException", "bug_description": "A few rar xml configs are parsed with success, but then result in NPEs at the IronJacamarResourceCreator. I&apos;m not sure if the parser should be fixed too...", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.connector.subsystems.resourceadapters.IronJacamarResourceCreator.java"], "label": 1, "es_results": []}, {"bug_id": 2468, "bug_title": "MappingModuleDefinition is incorrectly constructing the write-attribute handler", "bug_description": "MappingModuleDefinition.registerAttribute is creating a write-attribute handler but is not passing in the correct list of AttributeDefinitions to its constructor.\nSee https://github.com/wildfly/wildfly/blob/master/security/src/main/java/org/jboss/as/security/MappingModuleDefinition.java#L85  it should be using the ADs returned by getAttributes(), same as L86.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.security.MappingModuleDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 2536, "bug_title": "NPE in cli is thrown when using preserve, override without parameter", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java", "org.jboss.as.patching.cli.PatchHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2398, "bug_title": "org.jboss.as.test.smoke.deployment.rar.tests.inflow.InflowTestCase fails", "bug_description": "Running a build of current sources with complete testsuite this test is failing with\ntestRegistryConfiguration(org.jboss.as.test.smoke.deployment.rar.tests.inflow.InflowTestCase): expected:<1> but was:<2>", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.test.smoke.deployment.rar.tests.inflow.InflowTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2399, "bug_title": "org.jboss.as.test.smoke.deployment.rar.tests.pure.PureTestCase fails", "bug_description": "Running a build of current sources with complete testsuite this test is failing with\ntestRegistryConfiguration(org.jboss.as.test.smoke.deployment.rar.tests.pure.PureTestCase): expected:<1> but was:<2>\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.test.smoke.deployment.rar.tests.pure.PureTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2476, "bug_title": "Improve security subsystem test coverage", "bug_description": "We should at least be testing expressions allowed", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.test.integration.domain.mixed.SimpleMixedDomainTest.java", "org.jboss.as.security.SecurityExtension.java", "org.jboss.as.controller.transform.description.TransformationRule.java", "org.jboss.as.security.LegacySupport.java", "org.jboss.as.test.integration.domain.mixed.SimpleMixedDomain_7_1_3_Final_TestCase.java", "org.jboss.as.test.integration.domain.mixed.SimpleMixedDomain_7_1_2_Final_TestCase.java", "org.jboss.as.security.SecurityDomainModelv12UnitTestCase.java", "org.jboss.as.controller.test.OperationTransformationTestCase.java", "org.jboss.as.test.integration.domain.mixed.SimpleMixedDomain_7_2_0_Final_TestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2475, "bug_title": "Bad marshalling of and missing transformer for identity-trust's module in security subsystem", "bug_description": "\n\n\n\n\n\n         <identity-trust>\n\n\n\n\n             <trust-module name=\"acl\" code=\"AclThingy\" flag=\"required\" module=\"test\">\n\n\n\n\n                 <module-option name=\"d\" value=\"r\"/>\n\n\n\n\n             </trust-module>\n\n\n\n\n         </identity-trust>\n\n\n\n\n\n\nbecomes\n\n\n\n\n\n\n         <identity-trust>\n\n\n\n\n             <login-module name=\"acl\" code=\"AclThingy\" flag=\"required\" module=\"test\">\n\n\n\n\n                 <module-option name=\"d\" value=\"r\"/>\n\n\n\n\n             </login-module>\n\n\n\n\n         </identity-trust>\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.security.SecuritySubsystemParser.java", "org.jboss.as.security.SecurityExtension.java"], "label": 1, "es_results": []}, {"bug_id": 2474, "bug_title": "Security subsystem does not handle acl's module properly, and is missing transformer", "bug_description": "The parsed add is done for /subsystem=security/security-domain=other/acl=classic/acl-module=acl\nHowever in the acl resource this is called login-module=acl.\nWHen marshalling\n\n\n\n\n\n\n\t<acl>\n\n\n\n\n\t   <acl-module name=\"acl\" code=\"AclThingy\" flag=\"required\" module=\"test\">\n\n\n\n\n                <module-option name=\"d\" value=\"r\"/>\n\n\n\n\n\t   </acl-module>\n\n\n\n\n\t</acl>\n\n\n\n\n\n\nbecomes\n\n\n\n\n\n\n\t<acl>\n\n\n\n\n\t   <login-module name=\"acl\" code=\"AclThingy\" flag=\"required\" module=\"test\">\n\n\n\n\n                <module-option name=\"d\" value=\"r\"/>\n\n\n\n\n\t   </login-module>\n\n\n\n\n\t</acl>\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.security.SecuritySubsystemParser.java", "org.jboss.as.security.ACLResourceDefinition.java", "org.jboss.as.security.SecurityExtension.java", "org.jboss.as.security.SecurityDomainModelv12UnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2530, "bug_title": "If a transformer removes the headers from an operation it fails on the target host", "bug_description": "This gives errors like:\n\n\n\n\n\n\n[domain@localhost:9999 /] /profile=full-ha-7.1.x/subsystem=security/security-domain=jboss-web-policy/authorization=classic/policy-module=Delegating:write-attribute(name=module-options,value={a=>b})\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => {\"host-failure-descriptions\" => {\"slave\" => \"JBAS010849: Operation write-attribute for address [\n\n\n\n\n    (\\\"profile\\\" => \\\"full-ha-7.1.x\\\"),\n\n\n\n\n    (\\\"subsystem\\\" => \\\"security\\\"),\n\n\n\n\n    (\\\"security-domain\\\" => \\\"jboss-web-policy\\\"),\n\n\n\n\n    (\\\"authorization\\\" => \\\"classic\\\")\n\n\n\n\n] can only be handled by the master Domain Controller; this host is not the master Domain Controller\"}},\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\nThis should probably be handled somewhere in the communication layer ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.controller.TransformingProxyController.java"], "label": 1, "es_results": []}, {"bug_id": 2650, "bug_title": "EE7-defined scopes not recognized as bean defining annotations", "bug_description": "The following EE7-defines scope annotations:\nViewScoped\nFlowScoped\nTransactionScoped\nare packaged within WildFly and therefore not found in the Jandex index.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.weld.deployment.processors.BeanDefiningAnnotationProcessor.java", "org.jboss.as.weld.discovery.AnnotationType.java"], "label": 1, "es_results": []}, {"bug_id": 2329, "bug_title": "File upload does not work", "bug_description": "In the previous version it worked, but in Beta 1 stopped worked file uploading with PF4 and Mojarra 2.2.3 (neither simple upload didn&apos;t work - tested on blank project, only with PF4 and Apache libs and configured web.xml file)\nI get no error in IDE or JS console.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.server.deployment.Phase.java", "org.jboss.as.jsf.subsystem.JSFSubsystemAdd.java"], "label": 1, "es_results": []}, {"bug_id": 2674, "bug_title": "Criteria for triggering @TopologyChanged logic in RegistryFactoryService is wrong", "bug_description": "There are 2 issues:\n1. In the fast-fail criteria:\nif (event.isPre() && event.getCache().getCacheManager().isCoordinator()) return;\nThis should be an OR not an AND.\n2. The channel coordinator may not have this registry service running!  Determine the \"coordinator\" based on the value of event.getConsistentHashAtEnd().\nThis is bug is probably the root because for a number of a large number of transient failures in the clustering testsuite.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.wildfly.clustering.server.registry.RegistryFactoryService.java"], "label": 1, "es_results": []}, {"bug_id": 2690, "bug_title": "JSP/JSPX tags do not work with Wildfly CR1", "bug_description": "My app works fine on JBoss AS 7.1. When I migrate to Wildfly 8.0.0 CR1, my JSP tags don&apos;t work as expected. My project is a EAR with WAR module.\nWhen app starts, in the 1st access to page A, tag file is compiled and the page are rendered fine. But when I access another page (B in example), I got this error: org.apache.jasper.JasperException: java.lang.ClassCastException: org.apache.jsp.tag.web.default_tagx cannot be cast to org.apache.jsp.tag.web.default_tagx\nIf I restart Wildfly and try to access page B, works fine. But when I access page A, I got the same error.\nMy default.tagx is bellow:\n<jsp:root xmlns:jsp=\"http://java.sun.com/JSP/Page\" xmlns:html=\"http://www.w3.org/1999/xhtml\" version=\"2.2\">\n    <jsp:output doctype-root-element=\"HTML\" doctype-system=\"about:legacy-compat\" omit-xml-declaration=\"yes\" />\n    some code\n    <jsp:doBody />\n    more code\n</jsp:root>\nAnd the pages are somethink like this:\n<tags:default xmlns:tags=\"urn:jsptagdir:/WEB-INF/tags\" xmlns:jsp=\"http://java.sun.com/JSP/Page\" xmlns:html=\"http://www.w3.org/1999/xhtml\">\n    <jsp:output omit-xml-declaration=\"yes\" />\n    my code here\n</tags:default>\nI was created a new empty project with two pages and one tagfile. The error don&apos;t occurs. But when I add CDI capabilities, the error occurs. There are something in CDI that confuses Jastow?\nAs discussed here: https://community.jboss.org/message/850730", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.weld.injection.InjectionTargets.java"], "label": 1, "es_results": []}, {"bug_id": 2687, "bug_title": "wildfly 8cr1 does not respect welcome-file-list for resources inside jar files", "bug_description": "The welcome-file-list is not respected for web resources inside jar.\nIf you call directly the welcome-file it works correctly, but if you call the folder where the welcome-file is located, you receive an Error.\nMy simple maven project to see the problem:\nhttps://github.com/fiorenzino/wildfly8-welcome-file-list\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.wildfly.extension.undertow.deployment.ServletResourceManager.java"], "label": 1, "es_results": []}, {"bug_id": 2681, "bug_title": "HTTP Management Interface Content-Type header is broken", "bug_description": "Problem:\nHTTP Domain Management Interfaces returns invalid Content-Type header:\n\n\n\n\n\n\nContent-Type: application/json;utf-8\n\n\n\n\n\n\nThis breaks management for lots of REST clients.\nProposed solution:\nAccording to W3C and rfc2616 the Content-Type header should be:\n\n\n\n\n\n\nContent-Type: application/json; charset=utf-8\n\n\n\n\n\n\nBY THE WAY: JBoss 7.1.1 behaviour is ok. It does not send any charset parameter at all.\nExample:\nRequest contains the following headers:\n\n\n\n\n\n\n3 > Accept: application/json\n\n\n\n\n3 > Content-Type: application/json\n\n\n\n\n...\n\n\n\n\n\n\nWildfly 8.0.0.CR1 response after digest authentication is:\n\n\n\n\n\n\n4 < 200\n\n\n\n\n4 < Authentication-Info: nextnonce=\"EB9WbpMrUuwNMTM4NzY3MDc2NzAxMgXaHXwaKEWPxbxUj1ihuOg=\"\n\n\n\n\n4 < Connection: keep-alive\n\n\n\n\n4 < Content-Type: application/json;utf-8\n\n\n\n\n4 < Transfer-Encoding: chunked\n\n\n\n\n\n\nJBoss 7.1.1 response after digest authentication is:\n\n\n\n\n\n\n4 < 200\n\n\n\n\n4 < Content-type: application/json\n\n\n\n\n4 < Date: Sat, 21 Dec 2013 23:48:36 GMT\n\n\n\n\n4 < Transfer-encoding: chunked\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.domain.http.server.DomainApiUploadHandler.java", "org.jboss.as.domain.http.server.Common.java", "org.jboss.as.test.smoke.mgmt.servermodule.HttpDeploymentUploadUnitTestCase.java", "org.jboss.as.domain.http.server.DomainUtil.java"], "label": 1, "es_results": []}, {"bug_id": 2644, "bug_title": "Java heap space exceeded looping connect/disconnect cycle", "bug_description": "CLIModelControllerClient implementation is not cleaning up something related to connection handling which leads to OOME repeating a cycle of ensureConnected(...) and close(). On my laptop it happens after around 1400 iterations.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.cli.impl.CliShutdownHook.java", "org.jboss.as.cli.impl.CommandContextImpl.java", "org.jboss.as.cli.impl.CommandContextFactoryImpl.java", "org.jboss.as.cli.scriptsupport.CLI.java"], "label": 1, "es_results": []}, {"bug_id": 2061, "bug_title": "CLI fails to show app status when runtime-name is different from the deployment name", "bug_description": "If an application is deployed with a different \"runtime-name\" other than the actual EAR \"name\" then CLI fails to show the Status of the application.\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.test.integration.management.deploy.runtime.ServletRuntimeNameTestCase.java", "org.jboss.as.server.deployment.DeploymentStatusHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2725, "bug_title": "Class-Path: . can cause JBAS011046: A component named 'TestBean' is already defined in this module", "bug_description": "&apos;JBAS011046: A component named\n&apos;TestBean&apos; is already defined in this module&apos;, I have narrowed it\ndown to it occurs if they have a jar manifest with Class-Path: .\nIt looks like when deploying it looks at the jar with the manifest\nentry which then must be having it scan the jar containing the EJB\nagain and failing.\nHaving the Class-Path: . doesn&apos;t really make sense to me, however it\nalso seems like we should not be trying to deploy it twice.\nIt appears ManifestClassPathProcessor ignores the . when the Class-Path is in a jar at the root of an ear but not when the jar is in a war&apos;s WEB-INF/lib\nserver/src/main/java/org/jboss/as/server/deployment/module/ManifestClassPathProcessor.java", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.server.deployment.module.ManifestClassPathProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 2663, "bug_title": "mod_cluster metric properties are never applied", "bug_description": "Are parsed for but never applied.\n\n\n\n\n\n\n <load-metric type=\"busyness\">\n\n\n\n\n                <property name=\"foo\" value=\"bar\"/>\n\n\n\n\n            </load-metric>\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.wildfly.extension.mod_cluster.ModClusterSubsystemAdd.java", "org.wildfly.extension.mod_cluster.ModClusterLogger.java"], "label": 1, "es_results": []}, {"bug_id": 2746, "bug_title": "Workaround for auditlog syslog Facility not being configurable", "bug_description": "Use -Dorg.jboss.TEMP.audit.log.facility=5 where the number is the FACILITY as mentioned in section 6.2.1 of RFC-5424", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.controller.audit.SyslogAuditLogHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2753, "bug_title": "Workaround for auditlog syslog appName not being configurable", "bug_description": "Use -Dorg.jboss.TEMP.audit.log.appName=customApp where the value is the app-name as mentioned in section 6.2.5 of RFC-5424", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.controller.audit.SyslogAuditLogHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2782, "bug_title": "Testsuite leaks remoting endpoints by not closing JMXConnector", "bug_description": "Whereever JMXConnectorFactory.connect() is called, the resulting JMXConnector should be closed", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.arquillian.container.managed.ManagedAsClientTestCase.java", "org.jboss.as.test.integration.ee.jmx.property.JMXPropertyEditorsTestCase.java", "org.jboss.as.test.integration.sar.servicembean.ServiceMBeanSupportTestCase.java", "org.jboss.as.arquillian.container.ManagementClient.java", "org.jboss.as.test.integration.sar.context.classloader.MBeanTCCLTestCase.java", "org.jboss.as.arquillian.container.MBeanServerConnectionProvider.java", "org.jboss.as.test.integration.mgmt.access.DeploymentScannerTestCase.java", "org.jboss.as.arquillian.container.domain.ManagementClient.java", "org.jboss.as.test.smoke.mgmt.servermodule.ServerInModuleDeploymentTestCase.java", "org.jboss.as.test.smoke.sar.SarTestCase.java", "org.jboss.as.test.integration.sar.injection.SarInjectionTestCase.java", "org.jboss.as.test.integration.sar.injection.resource.SarResourceInjectionTestCase.java", "org.jboss.as.test.integration.sar.SarWithinEarTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2739, "bug_title": "BeanDeploymentArchive for external (WFLY) modules added twice", "bug_description": "The Weld-WFLY integration adds a dependency on WFLY module twice if the application deployment unit is an EAR containg libs, ejbs, war, etc. It prevents an application having dependencies on a new Picketlink (PL) extension to be deployed since PL contains a portable extension which has to be injected within PL module. The Weld-validation of the second time injection  fails.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.test.integration.weld.modules.ModuleUtils.java", "org.jboss.as.weld.deployment.processors.ExternalBeanArchiveProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 2732, "bug_title": "Injected EJB not available to MDB @PreDestroy methods", "bug_description": "MDB with method annotated with @PreDestroy and injected EJB. In this method we are calling an EJB. When the application is undeployed the PreDestroy method is called but it fails on the call to the injected EJB as it&apos;s already been undeployed.\nThis was fixed in an RFE for Session Beans but does not seem to work for MDB.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.ejb3.deployment.processors.merging.EjbDependsOnMergingProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 2695, "bug_title": "Creating named formater patterns for offline servers fail", "bug_description": "After adding and attaching a named formatter to an offline server starting the server fails due to an invalid logging configuration.\nserver-one fails with:\n{{\n[Server:server-one] 00:08:00,214 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) JBAS014612: Operation (\"add\") failed - address: ([\n[Server:server-one]     (\"subsystem\" => \"logging\"),\n[Server:server-one]     (\"console-handler\" => \"CONSOLE\")\n[Server:server-one] ]): java.lang.IllegalArgumentException: Formatter \"TESTPATTERN\" is not found\n}}\nI assume logging.properties is written too late in LoggingOperations.java", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.logging.LoggingExtension.java"], "label": 1, "es_results": []}, {"bug_id": 2224, "bug_title": "CLI does not exit batch mode when failures occur in run-batch", "bug_description": "If you execute a batch that fails, the CLI remains in batch mode.\n[domain@localhost:9990 /] batch\n[domain@localhost:9990 / #] /profile=test:add\n#1 /profile=test:add\n[domain@localhost:9990 / #] :bogus\n#2 /:bogus\n[domain@localhost:9990 / #] run-batch\nJBAS014884: No operation named &apos;bogus&apos; exists at address []\n[domain@localhost:9990 / #]\nThis might be intentional (e.g. to let me fix a typo in my \":bogus\" op), but if so, perhaps some output explaining that would be good? And for non-interactive mode staying in the batch seems wrong.\nThe same problem occurs in the EAP branch, which is where I first noticed it when investigating another issue. In that case the :bogus command wasn&apos;t bogus but was a proper op that failed for legitimate reasons. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.cli.handlers.batch.BatchRunHandler.java", "org.jboss.as.cli.handlers.BaseOperationCommand.java"], "label": 1, "es_results": []}, {"bug_id": 2794, "bug_title": "FileSystemPathArgument does not translate paths in getValue(args, required)", "bug_description": "FileSystemPathArgument uses its OS-specific tab-completer to resolve absolute paths in its getValue(args) method but not in getValue(args, required).", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.cli.impl.FileSystemPathArgument.java"], "label": 1, "es_results": []}, {"bug_id": 2808, "bug_title": "Method typo in BasicIIOPInvocationTestCase", "bug_description": "Correct method typo in BasicIIOPInvocationTestCase, and HandleWrapper should be serializable.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.test.iiop.basic.HandleWrapper.java", "org.jboss.as.test.iiop.basic.BasicIIOPInvocationTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2756, "bug_title": "Default connector is hardcoded in JMS connection factory definition", "bug_description": "When JMS connection factory definitions are used to setup connection factory, the messaging subsystem adds the \"netty\" connector if no connectors are specified in the definition.\nThis introduces a problem if users do not define a connector named \"netty\" in their configuration (as it will be the case when we switch to using the http-connector instead of the remote-connector by default).\nWorkaround this is to ask HornetQ for the connectors that can be used and pick one (and logs a warning message telling the user that it should not depend on that behaviour and explicitly specify which connector to use).", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.messaging.jms.PooledConnectionFactoryService.java", "org.jboss.as.messaging.MessagingLogger.java", "org.jboss.as.messaging.deployment.DirectJMSConnectionFactoryInjectionSource.java"], "label": 1, "es_results": []}, {"bug_id": 2584, "bug_title": "RBAC: Silent failure of run-as role mapping", "bug_description": "RunAsRoleMapper.mapRoles(Caller caller, Set<String> currentRoles, Set<String> runAsRoles, boolean sanitized) ignores false results from realRoleMapper.canRunAs(currentRoles, requestedRole) and just leaves the user running in their regular roles. Some sort of failure condition seems more appropriate.\nI noticed this when I was investigating WFLY-2318 caused by WFLY-2583. The improperly parsed role list was resulting in realRoleMapper.canRunAs(currentRoles, requestedRole) returning false so the call would just execute as SuperUser.\nSame thing would happen with a simple typo like \n{roles=Mnitor}\n.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.controller.access.rbac.BasicRbacTestCase.java", "org.jboss.as.controller.access.rbac.RunAsRoleMapper.java", "org.jboss.as.controller.access.rbac.SuperUserRoleMapper.java", "org.jboss.as.controller.access.rbac.StandardRoleMapper.java"], "label": 1, "es_results": []}, {"bug_id": 2762, "bug_title": "Injection of application-provided CDI bean into extension-provided bean fails", "bug_description": "When an application provides a CDI bean, injection of this bean into another bean provided by a portable extension (which is attached to this application) fails.\nThe specific use case is the PE for Hibernate Validator which contains a class ValidationInterceptor with an injection point of type j.v.Validator. If the application happens to provide a producer for that type, deployment of the application fails with the following error message:\n\nWELD-001408: Unsatisfied dependencies for type Validator with qualifiers @Default\n    at injection point [UnbackedAnnotatedField] @Inject private org.hibernate.validator.internal.cdi.interceptor.ValidationInterceptor.validator\nA test case can be found here. To execute it, pull that branch and run:\n\n\n\n\n\n\nmvn clean install -pl integration -Dit.test=InjectionIssueIT\n\n\n\n\n\n\nThe deployment of that Arquillian test fails with the error above.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.weld.deployment.WeldDeployment.java"], "label": 1, "es_results": []}, {"bug_id": 2785, "bug_title": "master reload on windows using bind IP without a reverse DNS entry (or a wrong one)", "bug_description": "When running on windows and the server management port bind IP address does not have a proper reverse DNS entry or an entry in the hosts file, then there is trouble reloading the server. It is possible that same issue may affect other domain server management operations but I didn&apos;t identify any others (and didn&apos;t try).\nBasically the problem is that windows reverse resolves such IPs to the computer name. On reload without restarting the managed servers, they receive as a host to reconnect to the computer name instead of the IP address and connection cannot be established.\nHere is how to reproduce:\n\non a windows machine add some local IP address without a reverse entry (e.g. 192.0.2.15)\nlaunch domain server from wildfly, e.g.: bin/domain.sh -bpublic=192.0.2.15 -bmanagement=192.0.2.15\nissue this cli command: reload --restart-servers=false --host=master\nsee logs for messages from server-one and server-two (I&apos;ll attach an archive with such logs)\n\nThe fix I found for the issue is:\n\n\n\n\n\ndifferent --git a/host-controller/src/main/java/org/jboss/as/host/controller/ManagedServer.java b/host-controller/src/main/java/org/jboss/as/host/controller/ManagedServer.java\n\n\n\n\nindex 308df0e..c6a88e8 100644\n\n\n\n\n--- a/host-controller/src/main/java/org/jboss/as/host/controller/ManagedServer.java\n\n\n\n\n+++ b/host-controller/src/main/java/org/jboss/as/host/controller/ManagedServer.java\n\n\n\n\n@@ -30,7 +30,6 @@ import static org.jboss.as.host.controller.HostControllerLogger.ROOT_LOGGER;\n\n\n\n\n \n\n\n\n\n import java.io.IOException;\n\n\n\n\n import java.io.OutputStream;\n\n\n\n\n-import java.net.InetAddress;\n\n\n\n\n import java.net.InetSocketAddress;\n\n\n\n\n import java.util.Collections;\n\n\n\n\n import java.util.LinkedHashMap;\n\n\n\n\n@@ -769,7 +768,7 @@ class ManagedServer {\n\n\n\n\n         public boolean execute(ManagedServer server) throws Exception {\n\n\n\n\n             assert Thread.holdsLock(ManagedServer.this); // Call under lock\n\n\n\n\n             // Reconnect\n\n\n\n\n-            final String hostName = InetAddress.getByName(managementSocket.getHostName()).getHostName();\n\n\n\n\n+            final String hostName = managementSocket.getHostString();\n\n\n\n\n             final int port = managementSocket.getPort();\n\n\n\n\n             processControllerClient.reconnectProcess(serverProcessName, NetworkUtils.formatPossibleIpv6Address(hostName), port, bootConfiguration.isManagementSubsystemEndpoint(), authKey);\n\n\n\n\n             return true;\n\n\n\n\n\n\nI see that the line causing the troubles was committed as part of AS7-3613. I looked at the issue and I don&apos;t see how this altering of hostname can help with getting a good URI. Yes, it can help if it guaranteed that a hostname will always be returned but fact is that on linux, if reverse record is missing or improper, this still returns an IP so this line of code I AM GOING TO can only because harm. Am I missing something?\nMoreover it doesn&apos;t seems right to me to change server identification overriding user choice to select an IP instead of a hostname just to fix some URIs.\nI AM GOING TO if user/administrator used an IP, then server should to use it as an IP, not reverse resolve it to a host and then use it. It simply leads to confusion.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.test.integration.respawn.RespawnTestCase.java", "org.jboss.as.host.controller.ManagedServer.java"], "label": 1, "es_results": []}, {"bug_id": 2809, "bug_title": "JACC PolicyContext.getContext(\"javax.servlet.http.HttpServletRequest\")", "bug_description": "Calling\n\n\n\n\n\n\nPolicyContext.getContext(\"javax.servlet.http.HttpServletRequest\");\n\n\n\n\n\n\nwithin a @Stateless session bean gives an exception.\nI&apos;ve created an integration test to reproduce this issue.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.wildfly.extension.undertow.UndertowLogger.java", "org.wildfly.extension.undertow.security.SecurityContextAssociationHandler.java", "org.wildfly.extension.undertow.UndertowService.java"], "label": 1, "es_results": []}, {"bug_id": 2829, "bug_title": "Optimistic locking w/write skew check requires versioning to be enabled", "bug_description": "Without this, the user cannot configure OPTIMISTIC locking.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.CacheAdd.java"], "label": 1, "es_results": []}, {"bug_id": 2507, "bug_title": "InflowFlatTestCase and InflowJarTestCase are failing on Windows", "bug_description": "Tests are consisently failing on Windows but not on Linux:\nhttp://brontes.lab.eng.brq.redhat.com/project.html?projectId=WF&testNameId=-4393166542338832492&tab=testDetails\nTypically that would indicate a problem that manifests when tests are run in a different order; i.e. one test leaving behind something that impacts another.\nI suspect what&apos;s happening here is an RA is getting left behind and these tests are finding the wrong one and making assertions against it.\nNote this in the test is used to find the RA id:\nSet<String> ids = repository.getResourceAdapters();\n\n\n\n\n\n\n\t\tassertNotNull(ids);\n\n\n\n\n\t\tSystem.out.println(\"////RA\" + ids.toString());\n\n\n\n\n\t\tString piId = getElementContaining(ids,        \"MultipleResourceAdapter\");\n\n\n\n\n\n\nThe test logging shows there are two RAs that would match:\n03:45:54,709 INFO  [stdout] (pool-1-thread-4) ////RAorg.jboss.as.test.integration.jca.rar.MultipleResourceAdapter#27, org.jboss.as.test.integration.jca.rar.MultipleResourceAdapter#28", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.connector.services.resourceadapters.ResourceAdapterActivatorService.java", "org.jboss.as.connector.services.resourceadapters.deployment.AbstractResourceAdapterDeploymentService.java", "org.jboss.as.connector.services.resourceadapters.deployment.ResourceAdapterXmlDeploymentService.java", "org.jboss.as.connector.services.resourceadapters.deployment.ResourceAdapterDeploymentService.java"], "label": 1, "es_results": []}, {"bug_id": 1809, "bug_title": "The security subsystem plugins use deprecated Infinispan API", "bug_description": "org.jboss.as.security.plugins.JNDIBasedSecurityManagement uses a deprecated way of configuring an Infinispan cache which must be removed.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha3", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.security.plugins.JNDIBasedSecurityManagement.java"], "label": 1, "es_results": []}, {"bug_id": 1901, "bug_title": "Could not grant javax.xml.ws.WebServicePermission to a deployment", "bug_description": "It&apos;s currently not possible by default to grant the javax.xml.ws.WebServicePermission \"publish\" permission to a user deployment by adding the proper entry in standalone.xml:\n\n\n\n\n\n\n        <subsystem xmlns=\"urn:jboss:domain:security-manager:1.0\">\n\n\n\n\n            <deployment-permissions>\n\n\n\n\n                <minimum-set>\n\n\n\n\n                    ...\n\n\n\n\n                    <permission class=\"javax.xml.ws.WebServicePermission\" name=\"publishEndpoint\"/>\n\n\n\n\n                </minimum-set>\n\n\n\n\n            </deployment-permissions>\n\n\n\n\n        </subsystem>\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "8.0.0.Final", "fixed_files": ["org.wildfly.extension.security.manager.SecurityManagerSubsystemAdd.java", "org.wildfly.extension.security.manager.Constants.java", "org.wildfly.extension.security.manager.SecurityManagerSubsystemParser.java", "org.wildfly.extension.security.manager.PermissionResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 2862, "bug_title": "Liferay too many open files during deployment", "bug_description": "Liferay 6.2 deploys as an exploded war. Normally after deployment it builds a theme (css/js boundles). Even if only Liferay is deployed a Too many open files exception is thrown. When /proc/sys/fs/file-max is 6815744. While trying to configure it or deploy other portlets (exploded wars too) the too many open files exception is encountered even at the deployment time (server start up). \n13:57:48,110 ERROR [MSC service thread 1-12][MainServlet:262] java.io.FileNotFoundException: /home/munih/development/tools/wildfly-8.0.0.Final-SNAPSHOT/standalone/deployments/ROOT.war/WEB-INF/liferay-layout-templates.xml (Too many open files)", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.server.ServerLogger.java", "org.jboss.as.server.BootstrapImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2873, "bug_title": "TestParser cannot marshal empty subsystems", "bug_description": "TestParser (used in subsystem test framework) will only marshal if the subsystem&apos;s ModelNode isDefined(). But for simple subsystems with no attributes it doesn&apos;t have to be defined.\nIt should just check for node existence  parentNode.has(subsystemName)  not whether the node is defined.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.subsystem.test.TestParser.java"], "label": 1, "es_results": []}, {"bug_id": 2866, "bug_title": "PersistentResourceXMLDescription does not marshal default attribute values", "bug_description": "When PersistentResourceXMLDescription marshals a resource&apos;s attributes, it will not marshal a value stored in the model if it matches the attribute&apos;s default value.\nWe should marshal the value provided by the user. Otherwise we will change the config file from what the user provided for reasons unrelated to management actions initiated by the user.\nDefaultAttributeMarshaller marshals default values.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.controller.PersistentResourceXMLDescription.java"], "label": 1, "es_results": []}, {"bug_id": 2589, "bug_title": "ReadTransformedResourceOperation should set include-defaults=false when calling read-resource", "bug_description": "This needs further investigation, but it seems to mean that we have a lot of ModelFixers used in the wrong situation. i.e. the when transforming resources, attributes that should be undefined reach the transformers as defined with the default value set instead.\nThis needs a bit of thinking about Jeff Mesnil mentioned this a few weeks ago as well. I&apos;d like to see if he remembers before fixing", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.subsystem.test.KernelServices.java", "org.jboss.as.model.test.ModelTestLegacyControllerKernelServicesProxy.java", "org.jboss.as.subsystem.test.ReadTransformedResourceOperation.java", "org.jboss.as.subsystem.test.MainKernelServicesImpl.java", "org.jboss.as.subsystem.test.SubsystemTestDelegate.java", "org.jboss.as.subsystem.test.LegacyKernelServicesImpl.java", "org.jboss.as.subsystem.test.AbstractKernelServicesImpl.java", "org.jboss.as.subsystem.test.AbstractSubsystemTest.java"], "label": 1, "es_results": []}, {"bug_id": 2877, "bug_title": "mod_cluster does not honor overridden session cookie name ", "bug_description": "This logic was not in place when the initial implementation was done, so needs to be adjusted to take that overridden value into consideration.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.wildfly.extension.undertow.ServerAdd.java", "org.wildfly.mod_cluster.undertow.UndertowEngine.java", "org.wildfly.extension.undertow.Server.java"], "label": 1, "es_results": []}, {"bug_id": 2840, "bug_title": "@Schedule EJB Timer not using timezone when calculating next timeout", "bug_description": "With a system running in Central Timezone, if it uses the annotation below specifying the timezone as Eastern timezone, with the hour set to the current hour.\nThe timer will fire once, and it will calculate the next timeout to be in the next hour CST, where as it should take in consideration the timezone specified on @Schedule which is Eastern.  If it did, then the timer should continue to fire every minute.\n\n\n\n\n\n\n  @Schedule(persistent = false, timezone = \"America/New_York\", dayOfMonth = \"*\", dayOfWeek = \"*\", month = \"*\", hour = \"22\", minute = \"*\", second = \"0\", year = \"*\")\n\n\n\n\n\n\n21:53:00,006 INFO  [stdout] (EJB default - 1) ScheduleTest: nextTimeout:Wed Jan 29 22:00:00 CST 2014\n\n\n\n\n\n\nimport javax.ejb.Schedule;\n\n\n\n\nimport javax.ejb.Singleton;\n\n\n\n\nimport javax.ejb.Startup;\n\n\n\n\n\n\n\n\n\n@Startup\n\n\n\n\n@Singleton\n\n\n\n\npublic class ScheduleTest {\n\n\n\n\n  @Schedule(persistent = false, timezone = \"America/New_York\", dayOfMonth = \"*\", dayOfWeek = \"*\", month = \"*\", hour = \"22\", minute = \"*\", second = \"0\", year = \"*\")\n\n\n\n\n  public void helloWorld(Timer time) {\n\n\n\n\n    System.out.println(\"ScheduleTest: timer:\" + time.getClass().getName() + \" \" + time.getNextTimeout() + \" \" + time.getInfo());\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.ejb3.timerservice.schedule.CalendarBasedTimeout.java"], "label": 1, "es_results": []}, {"bug_id": 2886, "bug_title": "RolloutPlanTestCase makes invalid assumptions about test execution", "bug_description": "RolloutPlanTestCase.testMaxFailServersRolloutPlan() assumes that the final op it sends (to remove the http-listener) will be executed on servers main-two and main-three. This is invalid, because if main-one executes before either main-two or main-three, there will be two failed servers in the rollout and the 3rd server will never get called.\nThis is why the test fails on JDK 8. There is some impl difference (probably in some collection class) that causes the server ops to be executed in different order.\nThis is just a matter of correcting some test assertions.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.jboss.as.domain.controller.plan.RollingServerGroupUpdateTask.java", "org.jboss.as.domain.controller.plan.ConcurrentGroupServerUpdatePolicy.java", "org.jboss.as.domain.controller.plan.ServerUpdatePolicy.java", "org.jboss.as.controller.remote.BlockingQueueOperationListener.java", "org.jboss.as.test.integration.domain.management.cli.RolloutPlanTestCase.java", "org.jboss.as.domain.controller.plan.ConcurrentServerGroupUpdateTask.java"], "label": 1, "es_results": []}, {"bug_id": 2901, "bug_title": "mod_cluster hot standby worker cannot be configured", "bug_description": "<simple-load-provider factor=\"0\"/> isn&apos;t accepted by the parser.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.wildfly.extension.mod_cluster.ModClusterConfigResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 2728, "bug_title": "JASPIAuthenticationMechanism does not handle wrapped/unwrapped request and response objects", "bug_description": "JASPIAuthenticationMechanims must check if a SAM has wrapped (during validateRequest) or unwrapped (during secureResponse) the HTTP request and response objects and replace the original references by the wrapped/unwrapped ones before continuing with the request processing.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.wildfly.extension.undertow.security.jaspi.JASPIAuthenticationMechanism.java"], "label": 1, "es_results": []}, {"bug_id": 2932, "bug_title": "ProtocolConnectionUtils forces protocol to \"remoting\" when -Djboss.management.client_socket_bind_address is used", "bug_description": "It needs to take the protocol from the configuration URI.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.protocol.ProtocolConnectionUtils.java"], "label": 1, "es_results": []}, {"bug_id": 2918, "bug_title": "Boot failure when domain-controller/remote element does not specify port attribute", "bug_description": "The 2.0 xsd says that the \"host\" and \"port\" attributes for host.xml domain-controller/remote element are optional. But if port is not specified boot fails:\n\n\n\n\n\n\n[Host Controller] 14:55:37,300 INFO  [org.jboss.as] (MSC service thread 1-6) JBAS015899: WildFly 8.0.0.Final \"WildFly\" starting\n\n\n\n\n[Host Controller] 14:55:38,060 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) JBAS014613: Operation (\"write-remote-domain-controller\") failed - address: ([(\"host\" => \"slave\")]) - failure description: \"JBAS014746: port may not be null\"\n\n\n\n\n[Host Controller] 14:55:38,062 FATAL [org.jboss.as.host.controller] (Controller Boot Thread) JBAS010933: Host Controller boot has failed in an unrecoverable manner; exiting. See previous messages for details.\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.host.controller.discovery.StaticDiscovery.java", "org.jboss.as.version.Version.java", "org.jboss.as.host.controller.parsing.HostXml.java", "org.jboss.as.host.controller.discovery.S3Discovery.java", "org.jboss.as.host.controller.operations.RemoteDomainControllerAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2917, "bug_title": "Unhelpful logging related to slave HC failover", "bug_description": "In 8.0.0 we introduced the \"discovery-options\" notion to the HC&apos;s domain-controller config. One expected usage pattern is there will be a master HC and then one or more slaves started with --backup-dc that act as passive failover DC&apos;s. Other slaves will use discovery-options elements to configure all possible masters. If the regular master fails, a backup can be quickly converted to a master with a couple CLI ops.\nThis works, except the slave shows some unhelpful logging while waiting for the backup to be promoted:\n\n\n\n\n\n\n[Host Controller] 14:58:13,105 WARN  [org.jboss.as.host.controller] (Remoting \"besdev:MANAGEMENT\" task-3) JBAS010914: Connection to remote host-controller closed. Trying to reconnect.\n\n\n\n\n[Host Controller] 14:58:13,134 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 14:58:14,160 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 14:58:18,180 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 14:58:27,200 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 14:58:42,216 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 14:58:57,232 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 14:59:12,248 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 14:59:27,264 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 14:59:42,280 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 14:59:57,296 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 15:00:12,312 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 15:00:27,328 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n[Host Controller] 15:00:42,351 INFO  [org.jboss.as.host.controller] (domain-connection-threads - 1) JBAS010916: Reconnected to master\n\n\n\n\n\n\nWhat&apos;s happening there is the slave is connecting to the backup but is not being allowed to register as a slave because the backup is not yet a master. The logging should reflect what&apos;s actually happening.\nAlso, after the backup is promoted and the slave properly registers, there&apos;s nothing in the slaves logs.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.host.controller.discovery.StaticDiscovery.java", "org.jboss.as.host.controller.RemoteDomainConnectionService.java", "org.jboss.as.host.controller.HostControllerLogger.java", "org.jboss.as.host.controller.RemoteDomainConnection.java", "org.jboss.as.host.controller.DomainModelControllerService.java", "org.jboss.as.host.controller.discovery.S3Discovery.java"], "label": 1, "es_results": []}, {"bug_id": 2992, "bug_title": "HttpServerLogger.errorContextModuleNotFound() is skipped", "bug_description": "HttpServerLogger.errorContextModuleNotFound(String slot) was added but the code that should call it doesn&apos;t, it just calls logger.error(slot).", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.domain.http.server.ManagementHttpServer.java"], "label": 1, "es_results": []}, {"bug_id": 2987, "bug_title": "RemoteDestinationOutboundSocketBindingService is not stopped when the resource is removed", "bug_description": "Steps to Reproduce:\n1. add remote-destination-outbound-socket-binding\n./jboss-cli.sh -c \"/socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=remote-connection-war-ejb-1:add(host=localhost, port=4447)\"\nresult is \n{\"outcome\" => \"success\"}\n\n3. remove remote-destination-outbound-socket-binding\n./bin/jboss-cli.sh -c \"/socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=remote-connection-war-ejb-1:remove\"\n\nresult is {\"outcome\" => \"success\"}\n\n4. add remote-destination-outbound-socket-binding\n./jboss-cli.sh -c \"/socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=remote-connection-war-ejb-1:add(host=localhost, port=4447)\"\nresult is\n{\n\n    \"outcome\" => \"failed\",\n\n    \"failure-description\" => \"JBAS014749: Operation handler failed: Service jboss.outbound-socket-binding.remote-connection-war-ejb-1 is already registered\",\n\n    \"rolled-back\" => true\n\n}\n\nExpected results:\n{\"outcome\" => \"success\"}\n\nStep 3 should either report reload required or should be fixed", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.server.services.net.OutboundSocketBindingRemoveHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2950, "bug_title": "jboss-cli using https-remoting: command not executed if certificate is unrecognised", "bug_description": "When using the https management interface from jboss-cli, commands passed with a command line option (such as --command=:shutdown) are not executed if the server certificate is unrecognised - even if accepting the certificate [T]emporarily or [P]ermenantly.\nIt appears to be due to the CommandContextImpl.handleSSLFailure() method, which calls error(\"Unable to connect...\"). The error() method sets the exitCode to 1. So, when CliLauncher.processCommands() subsequently runs, it sees that the cmdCtx.exitCode is 1 and ignores any commands.\nI guess the handleSSLFailure needs to reset the exitCode to 0 if the user chooses [T] or [P].", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.cli.impl.CommandContextImpl.java"], "label": 1, "es_results": []}, {"bug_id": 3012, "bug_title": "better handle ptaching conflicts for missing files", "bug_description": "In case a updated misc file missing when applying a patch reports a conflict when rolling back. This should not require any user interaction.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.patching.runner.FileUpdateTask.java", "org.jboss.as.patching.runner.AbstractFileTask.java", "org.jboss.as.patching.runner.AbstractTaskTestCase.java", "org.jboss.as.patching.runner.FileTaskTestCase.java", "org.jboss.as.patching.tests.BasicHistoryUnitTestCase.java", "org.jboss.as.patching.runner.FileRemoveTask.java", "org.jboss.as.patching.runner.AbstractPatchingTask.java"], "label": 1, "es_results": []}, {"bug_id": 2942, "bug_title": "Unclear error message when resolving a conflict using the CLI", "bug_description": "The error message when using --override or --preserve without any argument should be more clear.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.patching.cli.PatchHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2205, "bug_title": "Undeployment prints null", "bug_description": "The following is printed during a shutdown of an .ear\n\n\n\n\n\n\n11:21:52,260 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-8) JBAS015877: Stopped deployment null (runtime-name: msginflow1_mdb_msginflow_ejb.jar) in 16ms\n\n\n\n\n11:21:52,260 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-11) JBAS015877: Stopped deployment null (runtime-name: msginflow_mdb_msginflow_ejb.jar) in 16ms\n\n\n\n\n11:21:52,262 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-11) JBAS015877: Stopped deployment msginflow_mdb.ear (runtime-name: msginflow_mdb.ear) in 18ms\n\n\n\n\n11:21:52,387 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS018558: Undeployed \"msginflow_mdb.ear\" (runtime-name: \"msginflow_mdb.ear\")\n\n\n\n\n\n\nThe &apos;null&apos; part of the .jar undeployment doesn&apos;t look nice.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.server.ServerLogger.java", "org.jboss.as.server.deployment.AbstractDeploymentUnitService.java"], "label": 1, "es_results": []}, {"bug_id": 2949, "bug_title": "Cannot get exception as pass-by-reference", "bug_description": "Despite of <in-vm-remote-interface-invocation pass-by-value=\"false\"/>, an exception is not thrown by reference, which results in java.io.NotSerializableException if the exception doesn&apos;t implement Serializable.  This is a blocker of a large migration project from WebLogic because it throws by reference even if that doesn&apos;t implement Serializable.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.ejb3.remote.LocalEjbReceiver.java"], "label": 1, "es_results": []}, {"bug_id": 2954, "bug_title": "Transaction Synchronization registration issue with injected JMSContext", "bug_description": "The JMSContextProducer registers a tx Synchronization object directly on the Transaction. That leads to issue when other parts register other Synchronization objects later on (see http://stackoverflow.com/questions/21523534/jboss-wildfly-arjuna016082-synchronizations-are-not-allowed-when-sending-mess).\nThe JSMContextProducer must switch to using TransactionSynchronizationRegistry instead to register syncs.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.test.integration.messaging.jms.context.InjectedJMSContextTestCase.java", "org.jboss.as.messaging.deployment.JMSContextProducer.java", "org.jboss.as.messaging.deployment.CDIDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 3069, "bug_title": "slaves cannot reconnect to a restarted master if RBAC is enabled", "bug_description": "Enable RBAC in an Wilfly domain setup. \"reload --host=master\" and the slaves will no longer be connected to the master\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.domain.controller.operations.ApplyRemoteMasterDomainModelHandler.java", "org.jboss.as.domain.controller.operations.AbstractOperationTestCase.java", "org.jboss.as.domain.controller.operations.ApplyRemoteMasterDomainModelHandlerTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3078, "bug_title": "directory-grouping configuration is not getting persisted via CLI when no servers defined", "bug_description": "\nIf none of the servers are defined in \"host.xml\" (means <servers></servers> empty tag is present) and if the user tries to run the following CLI command to change the \"directory-grouping\" to  \"by-type\"  then the value is not persisted in the configuration file (host.xml) and the <servers></servers>  tag is also removed from the host.xml\n\n\n\n\n\n\n/host=master/:write-attribute(name=directory-grouping,value=by-type)\n\n\n\n\n\n\n\n\nThe value of \"directory-grouping\" is stored \"in memory\" so this change does not survive the host restart.\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.host.controller.parsing.HostXml.java"], "label": 1, "es_results": []}, {"bug_id": 3000, "bug_title": "Incorrect 'Content-Type' response set after executing an erroneous command", "bug_description": "The http management interface, upon error, returns an incorrect &apos;Content-Type&apos; of \n\n\n\n\n\n\n&apos;Content-Type: text/plain; charset=utf-8&apos; \n\n\n\n\n\n\nalthough JSON response is returned.\nTo reproduce, issue from the command line a simple &apos;read&apos; operation\n\n\n\n\n\n\ncurl --digest -D - http://localhost:9990/management --header \"Content-Type: application/json\" -d &apos;{\"operation\":\"read-attribute\", \"name\":\"foo\"}&apos; -you <username>:<password>\n\n\n\n\n\n\n\n\n\n..\n\n\n\n\nContent-Type: text/plain; charset=utf-8\n\n\n\n\nContent-Length: 119\n\n\n\n\nDate: Sun, 23 Feb 2014 17:27:10 GMT\n\n\n\n\n\n\n\n\n\n{\n\n\n\n\n    \"outcome\" : \"failed\",\n\n\n\n\n    \"failure-description\" : \"JBAS014792: Unknown attribute foo\",\n\n\n\n\n    \"rolled-back\" : true\n\n\n\n\n}\n\n\n\n\n\n\nThe &apos;Content-Type&apos; should have been set to &apos;application/json&apos; instead of &apos;text/plain&apos;\nNote: On JBoss AS 7.1.1.Final, the correct type of &apos;application/json&apos; is returned for the same operation.\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.domain.http.server.Common.java"], "label": 1, "es_results": []}, {"bug_id": 3106, "bug_title": "Infinispan cache statistics cannot be enabled/disabled independently of the cache manager statistics    ", "bug_description": "The Infinispan subsystem allows enabling and disabling the collection of statistics for cache managers and caches via the \"statistics-enabled\" management API attribute.\nIt is possible to set statistics-enabled attributes independently for cache managers and caches in the management API, but when checking the Infinispan MBeans, we see that statistics are either enabled for cache managers and their caches, or disabled for cache managers and caches.  \n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.CacheConfigurationService.java"], "label": 1, "es_results": []}, {"bug_id": 3133, "bug_title": "Misleading error message for add-user username requirements.", "bug_description": "The current error message is: -\n\n\n\n\n\n\nJBAS015239: Only alpha/numeric usernames accepted.\n\n\n\n\n\n\nHowever a small set of symbols are allowed.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.domain.management.security.adduser.ValidateUserState.java", "org.jboss.as.domain.management.DomainManagementMessages.java"], "label": 1, "es_results": []}, {"bug_id": 3067, "bug_title": "Webservices DUP is not scanning all visible classes for @WebService annotation", "bug_description": "Sample use case:  You have a .war in an .ear, and the .war has a web.xml with a <servlet-class> that refers to a JAX-WS endpoint, so the class is annotated with @WebService.  If that class is packaged in a jar found in the ear&apos;s lib directory, the JBossWS DUP won&apos;t pick it up, and then Undertow will throw an error like this:\n\n\n\n\n\n\nUT010009: Servlet ClientEndpoint of type class com.redhat.gss.jaxws.ClientEndpoint does not implement javax.servlet.Servlet\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.webservices.deployers.WSIntegrationProcessorJAXWS_HANDLER.java", "org.jboss.as.webservices.util.ASHelper.java", "org.jboss.as.webservices.deployers.AbstractIntegrationProcessorJAXWS.java", "org.jboss.as.webservices.deployers.WSIntegrationProcessorJAXWS_EJB.java", "org.jboss.as.webservices.deployers.WSIntegrationProcessorJAXWS_POJO.java", "org.jboss.as.webservices.dmr.WSDeploymentActivator.java", "org.jboss.as.server.deployment.Phase.java"], "label": 1, "es_results": []}, {"bug_id": 3103, "bug_title": "PrimitiveListAttributeDefinition.Builder does not preserve the validator", "bug_description": "Using PrimitiveListAttributeDefinition.Builder#Builder(PrimitiveListAttributeDefinition)\nto build an new attribute definition from a basis does not preserve the basis&apos; elementValidator and the valid operation can not be validated against the copied definition.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.controller.PrimitiveListAttributeDefinitionUnitTestCase.java", "org.jboss.as.controller.PrimitiveListAttributeDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 3004, "bug_title": "properties are not resolved for arguments of commands handled on the client-side", "bug_description": "When using cli for batch files using --file and --properties arguments, any property is resolved but for those defined in the connect command line.\nThe properties file contains (among the others):\nserver.bind.addr = xxxxx\nserver.management.port = 9990\nHaving:\nconnect $\n{server.bind.addr}\nin the batch file gets\nERROR [org.jboss.as.cli.CommandContext] Failed to resolve host &apos;${server.bind.addr}\n&apos;: Failed to create URI: Illegal character in authority at index 16: http-remoting://$\n{server.bind.addr}:9990\n\nHaving:\nconnect ${server.bind.addr}\n:$\n{server.management.port}\ngets:\nERROR [org.jboss.as.cli.CommandContext] The port must be a valid non-negative integer: &apos;$\n{server.bind.addr}\n:${server.management.\nIf i use literal values for the connect command, any other property in the batch is correctly resolved (but that&apos;s exactly what i was trying to avoid)", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.cli.handlers.BaseOperationCommand.java", "org.jboss.as.cli.handlers.GenericTypeOperationHandler.java", "org.jboss.as.cli.impl.ArgumentWithValue.java", "org.jboss.as.cli.parsing.StateParser.java", "org.jboss.as.cli.handlers.ConnectHandler.java", "org.jboss.as.cli.parsing.test.VariablesTestCase.java", "org.jboss.as.cli.impl.FileSystemPathArgument.java", "org.jboss.as.cli.handlers.ResourceCompositeOperationHandler.java", "org.jboss.as.cli.parsing.test.PropertyReplacementTestCase.java", "org.jboss.as.cli.handlers.jca.XADataSourceAddCompositeHandler.java", "org.jboss.as.cli.handlers.SetVariableHandler.java", "org.jboss.as.cli.parsing.LineBreakHandler.java", "org.jboss.as.cli.parsing.ExpressionBaseState.java", "org.jboss.as.test.integration.management.cli.FileWithPropertiesTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3046, "bug_title": "Not possible change the object store type from hornetq to jdbc via cli commands", "bug_description": "When you have set the object store to be type of hornetq and then you change your mind to set it for jdbc object store the jboss-cli permits this operation but no change is propagated to model and XML file.\nHow to reproduce:\n\n./bin/standalone.xml (start eap 6.2.0.GA)\n./bin/jboss-cli.sh -c (connect to running eap)\n/subsystem=transactions:write-attribute(name=use-hornetq-store, value=true)\n:reload\n/subsystem=transactions/log-store=log-store:read-attribute(name=type)\n/subsystem=transactions:write-attribute(name=use-jdbc-store, value=true)\n:reload\n/subsystem=transactions/log-store=log-store:read-attribute(name=type)\n\nThe object store stays to be set to hornetq and no change happens in the standalone.xml file.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.txn.subsystem.TransactionSubsystemRootResourceDefinition.java", "org.jboss.as.txn.subsystem.TransactionSubsystemXMLPersister.java"], "label": 1, "es_results": []}, {"bug_id": 3163, "bug_title": "EAP audit log should display the EAP version instead of the AS version", "bug_description": "EAP audit log should display the EAP version instead of the AS version\nCurrently the audit log shows the AS version number instead of the EAP version. Example:\nFeb 13 07:55:43 efjkffglk000000719 syslogappname[553]: 2014-02-13 07:55:43 - {\"type\" : \"core\", \"r/o\" : false, \"booting\" : false, \"version\" : \"7.3.0.Final-redhat-14\", \"user\" : \"$local\", \"domainUUID\" : null, \"access\" : \"NATIVE\", \"remote-address\" : \"10.10.10.250/10.10.10.250\", \"success\" : true, \"ops\" : [{\"address\" : [\n{ \"host\" : \"master\" }\n,\n{ \"core-service\" : \"management\" }\n,\n{ \"access\" : \"audit\" }\n,\n{ \"logger\" : \"audit-log\" }\n], \"operation\" : \"write-attribute\", \"name\" : \"enabled\", \"value\" : false, \"operation-headers\" : {\"caller-type\" : \"user\", \"access-mechanism\" : \"NATIVE\", \"domain-uuid\" : \"fead80e4-690d-4bcf-af71-ecaf30f98381\", \"push-to-servers\" : null}}]}\n\"version\" : \"7.3.0.Final-redhat-14\"\nThis should show:\n\"version\" : \"6.2.1.GA\" \nThere&apos;s a request that it show something like \"6.2 CP01\" but that is a patch file name, not a software version, and is unknown to the software.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.host.controller.DomainModelControllerService.java", "org.jboss.as.server.ServerEnvironment.java"], "label": 1, "es_results": []}, {"bug_id": 3136, "bug_title": "SRV 7.7.2 non-compliance", "bug_description": "From SRV 7.7.2: Distributed Environments\nWithin an application marked as distributable, all requests that are part of a session must be handled by one JVM at a time.\nOur default configuration for the Infinispan cache used for web sessions uses PESSIMISTIC locking.  However, Infinispan only acquires locks on cache write operations.  This only prevents concurrent writes to a session.  Even with REPEATABLE_READ, 2 threads can read a session at the same time.  We need to make sure both reads and writes to a session use cluster exclusive access, by default at least.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.clustering.infinispan.invoker.Locator.java", "org.wildfly.clustering.ejb.infinispan.bean.InfinispanBeanFactory.java", "org.wildfly.clustering.web.infinispan.session.coarse.CoarseSessionFactory.java", "org.wildfly.clustering.web.infinispan.session.fine.FineSessionFactory.java"], "label": 1, "es_results": []}, {"bug_id": 3048, "bug_title": "\"Local\" authentication fails when LDAP is used for ManagementRealm", "bug_description": "When LDAP is used for authentication in ManagementRealm, \"local\" authentication, which is enabled in configuration for the realm, appears to stop working.\nI have configured my ManagementRealm to use LDAP for authentication of remote clients.  However, I also need to allow local authentication without a username and password, for when jboss-cli is invoked from the command line on the server.  This is needed in order for the wildfly-init-debian.sh script to shut down the server.  I have configured the ManagementRealm as follows:\n<security-realm name=\"ManagementRealm\">\n        <authentication>\n            <local default-user=\"$local\" />\n            <ldap connection=\"...\" base-dn=\"ou=accounts,dc=...\" recursive=\"false\">\n                ...\n            </ldap>\n        </authentication>\n        <authorization map-groups-to-roles=\"false\">\n            <ldap connection=\"...\">\n                ...\n            </ldap>\n        </authorization>\n    </security-realm>\nI left out most of the LDAP configuration because I don&apos;t think it is important for this issue.  LDAP authentication works fine for remote clients.  In fact, it works fine for local clients as well--when I invoke jboss-cli with LDAP authentication enabled, it prompts for a username and password; if I enter a valid combination from the LDAP directory, jboss-cli connects successfully and executes its command.\nThe problem is that I need it to NOT prompt for a username and password when jboss-cli is invoked locally.  Which, I believe, is how things are supposed to work when \"local\" authentication is also enabled; it just doesn&apos;t work that way when LDAP is enabled for the same realm.\nIf I comment out the <ldap .../> element in <authentication> for the realm, local authentication starts working again.  I can invoke jboss-cli locally and the command is carried out without a username and password prompt.  Re-enable LDAP, with no other configuration changes, and again it flips back to requiring a username and password.\nI have tried replacing \"$local\" in the @default-user element of the <local> element with a valid name from the LDAP directory, both as a simple username and as a full DN, and jboss-cli still prompts for a username and password.\nThe modification date on the [tmp/auth] directory changes when I run jboss-cli with LDAP in place and get the username/password prompt, so it appears that the client is putting a token in there to try to use local authentication.  The server just never picks it up.\nThe documentation specifically mentions that <local/> should work along with <ldap/> here:\nhttps://docs.jboss.org/author/display/WFLY8/Security+Realms", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.domain.management.security.LocalAuthenticationResourceDefinition.java", "org.jboss.as.domain.management.security.LocalCallbackHandlerService.java", "org.jboss.as.domain.management.parsing.ManagementXml.java", "org.jboss.as.domain.management.security.SecurityRealmService.java", "org.jboss.as.domain.management.ModelDescriptionConstants.java", "org.jboss.as.domain.management.security.SecurityRealmAddHandler.java", "org.jboss.as.controller.parsing.Attribute.java"], "label": 1, "es_results": []}, {"bug_id": 3112, "bug_title": "One cannot change history and decay with DynamicLoadBalanceFactorProvider", "bug_description": "\nI&apos;m under an ugly impression that one can&apos;t actually change history and decay attributes of DynamicLoadBalanceFactorProvider.\nI was trying to figure out why the new test suite of CustomLoadMetric tests does not pass. In order to get load figures without history and decay manipulation, I set the following:\n\n\n\n\n\n\n<subsystem xmlns=\"urn:jboss:domain:modcluster:1.2\">\n\n\n\n\n    <mod-cluster-config advertise-socket=\"modcluster\" connector=\"ajp\">\n\n\n\n\n    <dynamic-load-provider history=\"0\">\n\n\n\n\n        <custom-load-metric class=\"biz.karms.modcluster.CustomLoadMetric\" weight=\"1\">\n\n\n\n\n            <property name=\"capacity\" value=\"1000\"/>\n\n\n\n\n            <property name=\"loadfile\" value=\"/tmp/mod_cluster-eapx/loadfileA\"/>\n\n\n\n\n            <property name=\"parseexpression\" value=\"^LOAD: ([0-9]*)$\"/>\n\n\n\n\n        </custom-load-metric>\n\n\n\n\n    </dynamic-load-provider>\n\n\n\n\n    </mod-cluster-config>\n\n\n\n\n</subsystem>\n\n\n\n\n\n\nThe aforementioned history=0 effectively means that there is just 1 \"slot\" for a one historical value on which decay function should work.\nIf you take a look at the code in DynamicLoadBalanceFactorProvider constructor, it is apparent\nthat the size of the List that later serves for storing the historical values is set sooner than the actual setHistory(int history) method is called.\nThe actual size of that List collection wouldn&apos;t do any harm by itself but it is being used in the aforementioned class with .size() to control cycles.\nThe same IMHO holds for the decay attribute.\nAnyhow, I put some additional logging to the DynamicLoadBalanceFactorProvider.java:\n\n\n\n\n\n\n// Historical value contribute an exponentially decayed factor\n\n\n\n\nfor (int i = 0; i < queue.size(); ++i) {\n\n\n\n\n    double decay = 1 / Math.pow(decayFactor, i);\n\n\n\n\n    totalDecay += decay;\n\n\n\n\n    this.log.info(\"KTAG: totalLoad:\"+totalLoad+\", with decay:\"+(totalLoad+queue.get(i).doubleValue() * decay));\n\n\n\n\n    totalLoad += queue.get(i).doubleValue() * decay;\n\n\n\n\n}\n\n\n\n\n\n\nand\n\n\n\n\n\n\ntry {\n\n\n\n\n    // Normalize load with respect to capacity\n\n\n\n\n    this.recordLoad(metricLoadHistory, metric.getLoad(engine) / metric.getCapacity());\n\n\n\n\n    this.log.info(\"KTAG metricLoadHistory:\"+metricLoadHistory.toString());\n\n\n\n\n    totalWeight += weight;\n\n\n\n\n    totalWeightedLoad += this.average(metricLoadHistory) * weight;\n\n\n\n\n} catch (Exception e) {\n\n\n\n\n    this.log.error(e.getLocalizedMessage(), e);\n\n\n\n\n}\n\n\n\n\n\n\nwith the following being the output: redacted_log.\nSo, despite having history=0, which should force the system to keep just 1, the current value, metricLoadHistory grew from\n\n\n\n\n\n\nKTAG metricLoadHistory:[0.8]\n\n\n\n\n\n\nto\n\n\n\n\n\n\nKTAG metricLoadHistory:[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.8]\n\n\n\n\n\n\nwhich is exactly 9 + 1 in size \nWDYT?", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.wildfly.extension.mod_cluster.ModClusterSubsystemAdd.java"], "label": 1, "es_results": []}, {"bug_id": 2654, "bug_title": "The run-as identity does NOT apply to the timeout callback method of an enterprise bean", "bug_description": "EJB 3.2 spec., 12.3.4.1 Run-as:\nThe run-as identity applies ... to the timeout callback methods of an enterprise bean;\nAssume the following classes:\n\n\n\n\n\n\n@Stateless\n\n\n\n\n@RunAs(\"alarm\")\n\n\n\n\npublic class Alarm {\n\n\n\n\n    @EJB\n\n\n\n\n    private Bell bell;\n\n\n\n\n// some more logic\n\n\n\n\n    @Timeout\n\n\n\n\n    public void ejbTimeout(Timer timer) {\n\n\n\n\n        bell.ring();\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n@Stateless\n\n\n\n\n@RolesAllowed(\"alarm\")\n\n\n\n\npublic class Bell {\n\n\n\n\n    public void ring() {}\n\n\n\n\n}\n\n\n\n\n\n\nWhen the Alarm&apos;s timeout callback method is invoked due to timer expiration, bell.ring(); results in\n\n\n\n\n\n\nERROR [org.jboss.as.ejb3.invocation] (EJB default - 1) JBAS014134: EJB Invocation failed on component Bell for method public void org.jboss.as.test.integration.ejb.security.timeout.Bell.ring(): javax.ejb.EJBAccessException: JBAS014502: Invocation on method: public void org.jboss.as.test.integration.ejb.security.timeout.Bell.ring() of bean: Bell is not allowed \n\n\n\n\n\n\nCalling bell.ring(); from Alarm&apos;s business methods works as expected (no error).\nSimple test case available at: https://github.com/bafco/wildfly/tree/timeoutSecurity", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.ejb3.component.EJBComponentDescription.java", "org.jboss.as.ejb3.security.EJBSecurityViewConfigurator.java", "org.jboss.as.ejb3.component.singleton.SingletonComponentDescription.java"], "label": 1, "es_results": []}, {"bug_id": 3007, "bug_title": "Ipv6 addresses may not be canonized properly", "bug_description": "On an ipv6 environment we may obtain IP addresses that are not properly canonized which may lead to strange issue with http proxies since the JDK ProxySelector relies on char per char matching.\nAll call to InetAddress.getHostName() may produce such an uncanonized address.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.test.integration.ejb.remote.common.EJBManagementUtil.java", "org.jboss.as.mail.extension.SessionProviderFactory.java", "org.jboss.as.server.services.net.SpecifiedInterfaceResolveHandler.java", "org.jboss.as.host.controller.HostControllerEnvironment.java", "org.jboss.as.controller.interfaces.InetAddressUtil.java", "org.jboss.as.test.manualmode.ws.ReloadWSDLPublisherTestCase.java", "org.jboss.as.messaging.HornetQService.java", "org.jboss.as.controller.audit.SyslogAuditLogHandler.java", "org.jboss.as.test.integration.management.api.SocketsAndInterfacesTestCase.java", "org.jboss.as.server.services.net.NetworkInterfaceRuntimeHandler.java", "org.jboss.as.server.DomainServerCommunicationServices.java", "org.jboss.as.network.NetworkUtils.java", "org.jboss.as.server.ServerEnvironment.java", "org.jboss.as.core.model.test.standalone.root.StandaloneRootResourceTestCase.java", "org.jboss.as.domain.management.security.auditlog.AbstractAuditLogHandlerTestCase.java", "org.jboss.as.server.services.net.BindingMetricHandlers.java"], "label": 1, "es_results": []}, {"bug_id": 3016, "bug_title": "Prevent NullPointerException in JDR CommandLineMain", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.jdr.CommandLineMain.java"], "label": 1, "es_results": []}, {"bug_id": 3192, "bug_title": "AroundInvokeAnnotationParsingProcessor should fail when more methods with @AroundInvoke annotation are found in the class", "bug_description": "\nAroundInvokeAnnotationParsingProcessor should fail when more methods with @AroundInvoke annotation is found in the class.\nThe specification says:\nA class must not declare more than one AroundInvoke method.\nThe JBoss AS allows more such methods and then it chooses one of them which is used as the interceptor.\nIt becomes even more important to check the interceptor validity now with the new feature introduced by AS7-5897 (server side non-EE interceptors for EE invocations).\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.ee.component.deployers.AroundInvokeAnnotationParsingProcessor.java", "org.jboss.as.ee.EeMessages.java", "org.jboss.as.test.integration.ejb.container.interceptor.ContainerInterceptorsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3198, "bug_title": "Reenabling an application prevents it from deployement after a restart", "bug_description": "After disabling and then re-enabling the application, I don&apos;t see Application.war.deployed; I still see Application.war.undeployed.\nThat explains why it doesn&apos;t get deployed after restart.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.server.deployment.scanner.FileSystemDeploymentService.java", "org.jboss.as.server.deployment.scanner.FileSystemDeploymentServiceUnitTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3194, "bug_title": "ApplicationClient container can not use a declarative method to activate EJBClientInterceptors", "bug_description": "With the java services approach it is possible to add a client side interceptor by adding the services file META-INF/services/org.jboss.ejb.client.EJBClientInterceptor to activate the interceptor if the class is accessable.\nThe file must be added to the client.jar in case of a simple standalone client.\nAnd to the ejb.jar if the interceptor is used inside a server application.\nFor the appclient I expect that add this file to \n  EAR/client.jar/META-INF/services\nwill do the same.\nNevertheless adding the file to ear/META_INF ear/ejb.jar/META-INF do not woth either.\nAlso adding the class to the client.jar, as ear module or as server module with dependency did not work.\nAll theses Interceptors can be used if the client Main method add this with the JBoss API.\nA working example can be found here \nhttps://github.com/wfink/jboss-eap-quickstarts/tree/application-client/app-client\nFor the example with the services approach try\nhttps://github.com/wfink/jboss-eap-quickstarts/tree/application-client-withServices/app-client", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.appclient.service.LazyConnectionContextSelector.java", "org.jboss.as.appclient.service.ApplicationClientStartService.java"], "label": 1, "es_results": []}, {"bug_id": 3099, "bug_title": "management authorization throws an exception when an LDAP group contains a slash/backslash character", "bug_description": "management authorization throws an exception when an LDAP group contains a slash/backslash character", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.domain.management.security.LdapGroupSearcherFactory.java"], "label": 1, "es_results": []}, {"bug_id": 3020, "bug_title": "LogStoreProbeHandler overwrites the LogStoreResource root model", "bug_description": "LogStoreProbeHandler replaces the &apos;delegate&apos; held by LogStoreResource. Doing this removes any data from the existing delegate&apos;s &apos;model&apos; field, i.e. the \"type\" attribute.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.txn.subsystem.LogStoreProbeHandler.java"], "label": 1, "es_results": []}, {"bug_id": 3047, "bug_title": "DomainSlaveHandler and OperationSlaveStepHandler place DOMAIN_CONTROLLER_LOCK_ID in wrong spot", "bug_description": "This field should be part of an op&apos;s operation-headers map, but these classes place it or look for it in the root of the op.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.domain.controller.operations.coordination.DomainSlaveHandler.java", "org.jboss.as.domain.controller.operations.coordination.OperationSlaveStepHandler.java"], "label": 1, "es_results": []}, {"bug_id": 2891, "bug_title": "Not authorised write operation does not get audit logged if log-read-only=\"false\"", "bug_description": "This is because audit logging uses the controller lock to find out if the model was a write operation. If rbac is enabled and an operation is not authorised, the error happens before the controller lock is taken. So if audit log log-read-only=\"false\" the failed operation does not get logged.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.controller.ReadOnlyContext.java", "org.jboss.as.controller.ParallelBootOperationContext.java", "org.jboss.as.controller.OperationContextImpl.java", "org.jboss.as.controller.AbstractOperationContext.java"], "label": 1, "es_results": []}, {"bug_id": 3017, "bug_title": "OperationContextImpl.readResourceForUpdate assumes all resources represent persistent config", "bug_description": "The readResourceForUpdate impl makes a few assumptions regarding the fact that a given Resource represents persistent config (i.e. Resource.isRuntime() == true):\n1) It calls rejectUserDomainServerUpdates() which means an OSH running on a server could not call this.\n2) It calls authorize(false, READ_WRITE_CONFIG) which means an OSH for an op available to the RBAC Operator role could not call this.\nPlaces this impacts include LogStoreProbeHandler and LogStoreTransactionDeleteHandler which should be calling readResourceForUpdate but aren&apos;t  and can&apos;t because of this bug.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.txn.subsystem.LogStoreTransactionDeleteHandler.java", "org.jboss.as.controller.OperationContextImpl.java"], "label": 1, "es_results": []}, {"bug_id": 2997, "bug_title": "AccessAuditContext domainUUID is not set when the domain-uuid header is set", "bug_description": "org.jboss.as.domain.controller.operations.coordination.PrepareStepHandler creates a UUID and sets \"operations-headers\" => \"domain-uuid\" on the op, but it does not pass the same UUID to AccessAuditContext. The result is the  log record has null in the domainUUID field but the operation headers part of the \"ops\" field shows the uuid. Confusing.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.domain.controller.operations.coordination.OperationCoordinatorStepHandler.java", "org.jboss.as.domain.controller.operations.coordination.PrepareStepHandler.java", "org.jboss.as.test.integration.domain.suites.AuditLogTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3011, "bug_title": "Management audit logging logs mutated operations", "bug_description": "OperationContextImpl caches operation ModelNodes for later logging, but it does not clone them first. As a result, the ModelNodes get mutated during op execution (e.g. headers can be added) and the log record shows that mutated state instead of the original user input. That can be misleading.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.domain.management.security.auditlog.AbstractAuditLogHandlerTestCase.java", "org.jboss.as.controller.AbstractOperationContext.java"], "label": 1, "es_results": []}, {"bug_id": 3076, "bug_title": "ModelControllerMBeanHelper constructor invokes unnecessary management op", "bug_description": "ModelControllerMBeanHelper is invoking a read-attribute management op in its constructor to find out of the process is a standalone server. This is not necessary  JmxSubsystemAdd can find this out from the OperationContext and pass this information through to the ModelControllerMBeanHelper it indirectly creates.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.jmx.model.ModelControllerMBeanHelper.java", "org.jboss.as.jmx.JMXSubsystemAdd.java", "org.jboss.as.jmx.auditlog.JmxAuditLogHandlerTestCase.java", "org.jboss.as.jmx.MBeanServerService.java", "org.jboss.as.jmx.model.ModelControllerMBeanServerPlugin.java", "org.jboss.as.jmx.ModelControllerMBeanTestCase.java", "org.jboss.as.jmx.rbac.JmxFacadeRbacEnabledTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3218, "bug_title": "Module for MySQL JDBC driver with version 5.1.30+ needs <driver-class> in standalone.xml", "bug_description": "See forum thread https://community.jboss.org/message/866635", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.connector.subsystems.datasources.JdbcDriverAdd.java"], "label": 1, "es_results": []}, {"bug_id": 3240, "bug_title": "Implement workaround for WFLY-3044 without requiring a spec maintenance release", "bug_description": "We  can do this ourselves by:\n\nfixing implementation part in Mojarra fork\nusing weld portable extensions to modify the annontation metadata\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.test.integration.weld.deployment.scopes.ViewScopedBean.java", "org.jboss.as.server.deployment.Phase.java", "org.jboss.as.jsf.subsystem.JSFSubsystemAdd.java"], "label": 1, "es_results": []}, {"bug_id": 2912, "bug_title": "Generic JMS adapter does not deploy correctly in domain mode.", "bug_description": "When trying to use generic resource adapter with third part JMS providers like TIBCO it is necessary to use generic RA provided in JBoss EAP 6.2. Unfortunately it would appear that when trying to use in domain mode the RA does not get deployed full, though it works perfectly in standalone mode.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.test.integration.jca.moduledeployment.AbstractModuleDeploymentTestCaseSetup.java", "org.jboss.as.connector.subsystems.resourceadapters.ResourceAdapterParser.java", "org.jboss.as.connector.subsystems.resourceadapters.RaAdd.java"], "label": 1, "es_results": []}, {"bug_id": 3092, "bug_title": "ServerUpdateResultHandler does nothing", "bug_description": "The domain op rollout logic&apos;s AbstractServerUpdateTask.ServerUpdateResultHandler interface is serving no purpose and should be removed. It&apos;s cruft left from earlier implementations.\nThe only impl stores data in a map that never gets read. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR1", "fixed_files": ["org.jboss.as.domain.controller.plan.RollingServerGroupUpdateTask.java", "org.jboss.as.domain.controller.plan.ServerUpdateTask.java", "org.jboss.as.domain.controller.plan.RolloutPlanController.java", "org.jboss.as.domain.controller.plan.AbstractServerGroupRolloutTask.java", "org.jboss.as.domain.controller.plan.ServerRestartTask.java", "org.jboss.as.domain.controller.plan.RunningServerUpdateTask.java", "org.jboss.as.domain.controller.plan.ConcurrentServerGroupUpdateTask.java"], "label": 1, "es_results": []}, {"bug_id": 3306, "bug_title": "Inconsistent responses between read-children-types and read-children-names or read-children-resources", "bug_description": "The read-children-types op is implemented by reading the names of the NodeSubregistry objects in the target resource&apos;s ManagementResourceRegistration. The read-children-names and read-children-resources ops are implemented by reading the full PathElement of registered child MRRs.\nIt&apos;s possible these two can get out of sync, as a NodeSubregistry can be added in order to support a submodel, but such subregistries aren&apos;t removed if all children are removed. This manifests itself in EAP 6 with the &apos;server&apos; child type. See https://bugzilla.redhat.com/show_bug.cgi?id=1093030. (Note WF should not have this specific problem, as WF registers a generic MRR for &apos;server&apos;.)\nFix is for GlobalOperationHandlers.getChildAddresses() to include an entry with an empty value for any valid child type. This will ensure the responses are consistent.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.1.0.CR2", "fixed_files": ["org.jboss.as.controller.operations.global.GlobalOperationHandlers.java"], "label": 1, "es_results": []}, {"bug_id": 3237, "bug_title": "doing a read-only operation with the CLI sets a server in \"restart-required\" mode", "bug_description": "In domain mode, doing a read-only operation with the CLI on a remote HC, sets the remote server in \"restart-required\" mode", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR2", "fixed_files": ["org.jboss.as.domain.controller.operations.ApplyRemoteMasterDomainModelHandler.java", "org.jboss.as.test.integration.domain.suites.ServerRestartRequiredTestCase.java", "org.jboss.as.domain.controller.operations.coordination.HostControllerUpdateTask.java"], "label": 1, "es_results": []}, {"bug_id": 2921, "bug_title": "Wrong condition statement in NetworkUtils#formatAddress(InetSocketAddress)", "bug_description": "It seems there is a wrong condition statement of formatAddress(InetSocketAddress inet) in the class org.jboss.as.network.NetworkUtils.\nhttps://github.com/wildfly/wildfly/blob/master/network/src/main/java/org/jboss/as/network/NetworkUtils.java\nThis method returns \"ipAddress:port\", but expected to \"hostname:port\".\npublic static String formatAddress(InetSocketAddress inet)\n...\n// As-is\nif(inet.isUnresolved()){\n            result.append(inet.getHostName());\n// Expected to reversely: \nif(!inet.isUnresolved()){\n            result.append(inet.getHostName());\n...", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR2", "fixed_files": ["org.jboss.as.network.NetworkUtilsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3302, "bug_title": "TLSSyslog server remove BECAUSE provider, does not add it back if it was present", "bug_description": "Syslog test kills BECAUSE provider, this may cause( and did ) random failures.\nOffending code: https://github.com/wildfly/wildfly/blob/master/testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/logging/syslogserver/TLSSyslogServer.java#L64", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.CR2", "fixed_files": ["org.jboss.as.test.integration.logging.syslogserver.TLSSyslogServer.java"], "label": 1, "es_results": []}, {"bug_id": 2596, "bug_title": "JASPI Web layer problems", "bug_description": "I have found several problems in the current (master, trunk) Wildfly JASPI Web layer implementation\nUndertow related:\n----------------------\n\nIt does not support pre-emptive authentication:\nWhen the ServerAuthenticationModule returns AUTH_SUCCESS and null userPrincipal, it should let the request fall through unathenticated, instead it is rejected.\n\n\nIt does not call secureResponse when the authentication was unsuccessful\n\n\nIt does not populate the org.jboss.security.SecurityContext, only the undertow Account structure.\n\n\nIt does not support the wrapper feature (Spec 3.8.3.5 and B.9)\n\nThe attached pull request aims to fix the first three issues.\nCredits: This patch is based on Arjan Tijms&apos; analysis, and suggested patches for the Jboss 7.X valve based authentitactor.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.0.0.Final", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java", "org.wildfly.extension.undertow.security.jaspi.JASPIAuthenticationMechanism.java"], "label": 1, "es_results": []}, {"bug_id": 3375, "bug_title": "The HornetQ address settings are not properly inherited ", "bug_description": "When using multiple address settings in HornetQ configuration the address setting should be inherited from more generic setting by more specific setting. If two address setting are used like\n\n\n\n\n\n\n<address-settings>\n\n\n\n\n                    <address-setting match=\"#\">\n\n\n\n\n                        <dead-letter-address>jms.queue.DLQ</dead-letter-address>\n\n\n\n\n                        <expiry-address>jms.queue.ExpiryQueue</expiry-address>\n\n\n\n\n                        <redelivery-delay>0</redelivery-delay>\n\n\n\n\n                        <max-delivery-attempts>5</max-delivery-attempts>\n\n\n\n\n                        <max-size-bytes>10485760</max-size-bytes>\n\n\n\n\n                        <page-size-bytes>2097152</page-size-bytes>\n\n\n\n\n                        <address-full-policy>PAGE</address-full-policy>\n\n\n\n\n                        <message-counter-history-day-limit>10</message-counter-history-day-limit>\n\n\n\n\n                    </address-setting>\n\n\n\n\n                    <address-setting match=\"jms.queue.testQueue\">\n\n\n\n\n                        <dead-letter-address>jms.queue.DLQ</dead-letter-address>\n\n\n\n\n                        <expiry-address>jms.queue.ExpiryQueue</expiry-address>\n\n\n\n\n                        <redelivery-delay>0</redelivery-delay>\n\n\n\n\n                        <max-size-bytes>10485760</max-size-bytes>\n\n\n\n\n                        <page-size-bytes>2097152</page-size-bytes>\n\n\n\n\n                        <address-full-policy>PAGE</address-full-policy>\n\n\n\n\n                        <message-counter-history-day-limit>10</message-counter-history-day-limit>\n\n\n\n\n                    </address-setting>\n\n\n\n\n                </address-settings>\n\n\n\n\n\n\nIt is expected that the setting for  jms.queue.testQueue would inherit max-delivery-attempts from default address setting \"#\" but it does not. Instead if uses the default value for max-delivery-attempts which is 9.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.messaging.CommonAttributes.java", "org.jboss.as.messaging.HornetQServerResourceDefinition.java", "org.jboss.as.messaging.AddressSettingAdd.java", "org.jboss.as.test.integration.messaging.mgmt.AddressSettingsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3105, "bug_title": "Container-managed EXTENDED persistence context is always joined with transaction even if UNSYNCHRONIZED", "bug_description": "https://github.com/weld/wildfly/blob/master/testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/jpa/transaction/UnsynchronizedSFSB.jav\nChange this test to \n\n\n\n\n\n@PersistenceContext(type = EXTENDED, synchronization = UNSYNCHRONIZED)\n\n\n\n\n\n and it will break. \nLooks like an extended PC is always joined to the transaction and flushed on commit, the unsynchronized mode is ignored. From what I can see this is not specified and indeed would make the whole new UNSYNCHRONIZED feature kind of pointless. It&apos;s primary use case is propagation of unflushed/unsynchronized extended PC from a SFSB to other beans while keeping transactions intact.\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.Final", "fixed_files": ["org.jboss.as.jpa.injectors.PersistenceContextInjectionSource.java", "org.jboss.as.jpa.transaction.TransactionUtil.java", "org.jboss.as.jpa.container.ExtendedEntityManager.java", "org.jboss.as.test.integration.jpa.transaction.TransactionTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3228, "bug_title": "ApplyRemoteMasterDomainHandler should use values sent from DC for root resource", "bug_description": "This is needed to keep the slave copy of the resource model actually the same, and popped up during mixed domain testing of EAP with a 6.2.0 slave.\nConnect directly to to 6.1.1 slave - gets domain version from master\n\n\n\n\n\n\n[domain@localhost:19999 /] :read-resource\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => {\n\n\n\n\n        \"deployment\" => undefined,\n\n\n\n\n        \"deployment-overlay\" => undefined,\n\n\n\n\n        \"management-major-version\" => 1,\n\n\n\n\n        \"management-micro-version\" => 0,\n\n\n\n\n        \"management-minor-version\" => 6,\n\n\n\n\n        \"name\" => \"Unnamed Domain\",\n\n\n\n\n        \"namespaces\" => [],\n\n\n\n\n        \"path\" => undefined,\n\n\n\n\n        \"product-name\" => \"EAP\",\n\n\n\n\n        \"product-version\" => \"6.3.0.Alpha3\",\n\n\n\n\n        \"profile\" => undefined,\n\n\n\n\n        \"release-codename\" => \"Janus\",\n\n\n\n\n        \"release-version\" => \"7.4.0.Final-redhat-SNAPSHOT\",\n\n\n\n\n \n\n\n\n\n\n\nConnect directly to 6.2.0 slave - does not get domain version from master\n\n\n\n\n\n\n[domain@localhost:19999 /] :read-resource\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"success\",\n\n\n\n\n    \"result\" => {\n\n\n\n\n        \"management-major-version\" => 1,\n\n\n\n\n        \"management-micro-version\" => 0,\n\n\n\n\n        \"management-minor-version\" => 5,\n\n\n\n\n        \"name\" => \"Unnamed Domain\",\n\n\n\n\n        \"namespaces\" => [],\n\n\n\n\n        \"product-name\" => \"EAP\",\n\n\n\n\n        \"product-version\" => \"6.2.0.GA\",\n\n\n\n\n        \"release-codename\" => \"Janus\",\n\n\n\n\n        \"release-version\" => \"7.3.0.Final-redhat-14\",\n\n\n\n\n\n\nThe 6.2.0 slave should look the same as the 6.1.1 slave for these attributes. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.Final", "fixed_files": ["org.jboss.as.domain.controller.operations.ApplyRemoteMasterDomainModelHandler.java", "org.jboss.as.domain.controller.operations.ApplyRemoteMasterDomainModelHandlerTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 2902, "bug_title": "LockModeType.PESSIMISTIC_WRITE reported as NONE in the logs", "bug_description": "The method getLockModeAsString reports lock mode  \nLockModeType.PESSIMISTIC_WRITE as \"none\".\nThis of course is a cosmetic issue, but highly misleading, considering PESSIMISTIC_WRITE is pretty much on the opposite end of the spectrum from NONE. Ie. looking at the logs it&apos;s not possible to know if there was the strictest possible lock or no lock at all.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "8.1.0.Final", "fixed_files": ["org.jboss.as.jpa.container.AbstractEntityManager.java"], "label": 1, "es_results": []}, {"bug_id": 3002, "bug_title": "ServletContext.getResourcePaths() does'nt meet Spec", "bug_description": "Undertow ServletContext.getResourcePaths() does&apos;nt meet the Spec Servlet 2.3. Please see attched Test Web Project resource-test.zip, Undertow does&apos;nt resolve the resources in Child Dependencies located under WEB-INF/lib Folder", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.Final", "fixed_files": ["org.wildfly.extension.undertow.deployment.ServletResourceManager.java"], "label": 1, "es_results": []}, {"bug_id": 2923, "bug_title": "org.jboss.as.jacorb.rmi.WorkCacheManager is a class loader leak waiting to happen", "bug_description": "This class should be re-done to not use weak and soft references. As the values in the weak map hold a reference to the key the values will never be released until the soft references expire. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.Final", "fixed_files": ["org.jboss.as.jacorb.rmi.InterfaceAnalysis.java", "org.jboss.as.jacorb.rmi.WorkCacheManager.java", "org.jboss.as.jacorb.deployment.JacORBMarkerProcessor.java", "org.jboss.as.jacorb.rmi.ExceptionAnalysis.java", "org.jboss.as.jacorb.rmi.ValueAnalysis.java"], "label": 1, "es_results": []}, {"bug_id": 2938, "bug_title": "JASPIAuthenticationMechanism does not perform the is auth required check correctly", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "8.1.0.Final", "fixed_files": ["org.wildfly.extension.undertow.security.jaspi.JASPIAuthenticationMechanism.java"], "label": 1, "es_results": []}, {"bug_id": 1513, "bug_title": "remove operation on JMS queue/topic does not remove the destination but just unbinds from JNDI", "bug_description": "The remove (management) operation on a JMS queue merely unbinds the queue from JNDI instead of destroying the queue. It appears that the change was done as part of https://issues.jboss.org/browse/AS7-1899 (the PR is here https://github.com/wildfly/wildfly/pull/398). The change done in that PR to address the original issue reported in that other JIRA doesn&apos;t look right.\nSo the original issue reported in that thread is that a server has a queue with messages and the server is stopped. Upon restart the messages have disappeared because upon stop, the JMSQueueService&apos;s stop() method used to destroy the queue. The real fix would have been to differentiate the \"remove()\" operation from a mere service stop. The explicit remove (handler) would then be responsible for destroying the queue (which even means a JNDI unbind) and not that service&apos;s stop method.\nAll of this even applies to the JMS topic which has a similar problem.\nOn a related note, the add() operation too seems suspicious because it ends up calling a createXXX on the JMSServer API which says:\n\n\n\n\n\n\n/**\n\n\n\n\n    * Creates a JMS Queue.\n\n\n\n\n    *\n\n\n\n\n    * @param queueName\n\n\n\n\n    *           The name of the queue to create\n\n\n\n\n    * @param selectorString\n\n\n\n\n    * @param durable\n\n\n\n\n    * @return true if the queue is created or if it existed and was added to\n\n\n\n\n    *         JNDI\n\n\n\n\n    * @throws Exception\n\n\n\n\n    *            if problems were encountered creating the queue.\n\n\n\n\n    */\n\n\n\n\n   boolean createQueue(boolean storeConfig, String queueName, String selectorString, boolean durable, String ...bindings) throws Exception;\n\n\n\n\n\n\nNotice the \"if the queue is created or if it existed and was added to JNDI\" part. So it appears that the management \"add\" operation can end up behaving like an update (write-attribute) kind of operation in some cases. I&apos;m not sure if that&apos;s good thing.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha1", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.messaging.jms.JMSQueueRemove.java", "org.jboss.as.messaging.jms.JMSTopicRemove.java", "org.jboss.as.messaging.jms.ConnectionFactoryRemove.java", "org.jboss.as.test.integration.messaging.mgmt.JMSTopicManagementTestCase.java", "org.jboss.as.test.integration.messaging.mgmt.JMSQueueManagementTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3438, "bug_title": "Eliminate use of optional dependencies for LocalEJBReceiver", "bug_description": "This issue was initially raised on stackoverflow (see below).\nWhen the EJB subsystem starts, it starts instances of LocalEJBReceiver which have optional dependencies on the Remoting Endpoint as well as the EJBRemoteConnectorService. I assume that these were marked as optional as remote invocations on EJBs is not required by the spec for the web profile. \nAs stated in the forum post, the issue is that the LocalEJBReceiver gets started before its dependency EJBRemoteConnectorService and so the optional dependency does not get resolved correctly - effectively turning off the LocalEJBReceiver&apos;s ability to add cluster nodes to cluster contexts for the clusters it belongs to.\nThis results in the exception\n.java.lang.IllegalStateException: EJBCLIENT000029: No cluster context available for cluster named ejb\nThe solution described in the forum post works to ensure that the dependencies are established correctly, but we need to factor into this what the spec says about the web profile and the possibility that some components (e.g. the EJBRemoteConnector) may be optionally removed.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.ejb3.subsystem.EJB3RemoteResourceDefinition.java", "org.jboss.as.ejb3.subsystem.EJB3RemoteServiceAdd.java", "org.jboss.as.ejb3.subsystem.EJB3SubsystemAdd.java"], "label": 1, "es_results": []}, {"bug_id": 1948, "bug_title": "JMXPropertyEditorsTestCase fails on Solaris SPARC", "bug_description": "Test org.jboss.as.test.integration.ee.jmx.property.JMXPropertyEditorsTestCase fails on Solaris, because environment variable USER is not set.\nFrom the source:\nUSER_SYS_PROP = System.getProperty(\"os.name\",\"linux\").contains(\"indows\")?\"USERNAME\":\"USER\";\nSo there is already a differentiation between Windows and others.\nFor Solaris LOGNAME is the variable to use. And os.name is SunOS.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.test.integration.ee.jmx.property.JMXPropertyEditorsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3338, "bug_title": "@Inject'ed JMSContext is not thread-safe", "bug_description": "Section 12.4.4 of the JMS 2.0 spec says:\n\nIf a method is called on an injected JMSContext when there is a JTA \ntransaction (either bean-managed or container-managed), the scope of \nthe JMSContext will be @TransactionScoped.\nThis is not currently true in WildFly. As a test case, suppose you have the following two beans:\n\n\n\n\n\n\nimport javax.annotation.Resource;\n\n\n\n\nimport javax.enterprise.context.ApplicationScoped;\n\n\n\n\nimport javax.enterprise.inject.Instance;\n\n\n\n\nimport javax.inject.Inject;\n\n\n\n\nimport javax.jms.JMSContext;\n\n\n\n\nimport javax.jms.Topic;\n\n\n\n\nimport javax.transaction.Transactional;\n\n\n\n\n\n\n\n\n\n@ApplicationScoped\n\n\n\n\n@Transactional\n\n\n\n\npublic class AppScopedBean {\n\n\n\n\n\t\n\n\n\n\n\t@Inject\n\n\n\n\n\tprivate JMSContext jmsCtx;\n\n\n\n\n\t//private Instance<JMSContext> jmsCtx;\n\n\n\n\n\t@Resource(lookup = \"jms/topic/test\")\n\n\n\n\n\tprivate Topic topic;\n\n\n\n\n\t\n\n\n\n\n\tpublic void sendMessage() {\n\n\n\n\n\t\tjmsCtx.createProducer().setDisableMessageID(true).setDisableMessageTimestamp(true).send(topic, \"a message\");\n\n\n\n\n\t\t//jmsCtx.get().createProducer().setDisableMessageID(true).setDisableMessageTimestamp(true).send(topic, \"a message\");\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\nimport javax.annotation.Resource;\n\n\n\n\nimport javax.enterprise.concurrent.ManagedThreadFactory;\n\n\n\n\nimport javax.enterprise.context.ApplicationScoped;\n\n\n\n\nimport javax.enterprise.context.Dependent;\n\n\n\n\nimport javax.enterprise.context.Initialized;\n\n\n\n\nimport javax.enterprise.event.Observes;\n\n\n\n\nimport javax.inject.Inject;\n\n\n\n\n\n\n\n\n\n@Dependent\n\n\n\n\npublic class ThreadLauncher {\n\n\n\n\n\n\n\n\n\n\t@Resource\n\n\n\n\n\tprivate ManagedThreadFactory threadFactory;\n\n\n\n\n\t@Inject\n\n\n\n\n\tprivate AppScopedBean bean;\n\n\n\n\n\t\n\n\n\n\n\tvoid start(@Observes @Initialized(ApplicationScoped.class) Object event) {\n\n\n\n\n\t\tSystem.out.println(\"starting threads\");\n\n\n\n\n\t\tfor (int i = 0; i < 5; i++) {\n\n\n\n\n\t\t\tthreadFactory.newThread(new SendRunnable()).start();\n\n\n\n\n\t\t}\n\n\n\n\n\t\tSystem.out.println(\"start finished\");\n\n\n\n\n\t}\n\n\n\n\n\t\n\n\n\n\n\tprivate class SendRunnable implements Runnable {\n\n\n\n\n\n\n\n\n\n\t\tpublic void run() {\n\n\n\n\n\t\t\tSystem.out.println(\"starting to send\");\n\n\n\n\n\t\t\tfor (int i = 0; i < 100; i++) {\n\n\n\n\n\t\t\t\tbean.sendMessage();\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t\tSystem.out.println(\"done sending\");\n\n\n\n\n\t\t}\n\n\n\n\n\t\t\n\n\n\n\n\t}\n\n\n\n\n\t\n\n\n\n\n}\n\n\n\n\n\n\nIf you deploy and run the above code, you will see a lot of this:\n\n2014-05-12 16:46:02,936 WARN  [org.hornetq.core.client] (EE-ManagedThreadFactory-default-Thread-4) HQ212051: Invalid concurrent session usage. Sessions are not supposed to be used by more than one thread concurrently.: java.lang.Exception: trace\nThat should not be happening if the JMSContext is really @TransactionScoped. The problem appears to be in org.jboss.as.messaging.deployment.JMSContextProducer, specifically the JMSContextWrapper.getDelegate() method. If two threads call it at the same time, the first will create a delegate but the second will receive the same delegate as the first, because the delegate doesn&apos;t get nulled until the transaction in the first thread completes.\nThis means that both threads are using the same session at the same time, which is not allowed. I don&apos;t know how HornetQ detects concurrent use, but depending on how that works, it&apos;s also possible that messages will end up being part of the wrong transaction.\nA workaround is to inject Instance<JMSContext> instead of JMSContext directly (the two commented out lines of code). Since the JMSContext producer is @Dependent, each Instance.get() call will return a new instance, and only one thread will ever use any given instance.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.messaging.deployment.JMSContextProducer.java"], "label": 1, "es_results": []}, {"bug_id": 4007, "bug_title": "HornetQService does not account for source port offset/fixation", "bug_description": "org/jboss/as/messaging/HornetQService.java:202", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.messaging.HornetQService.java"], "label": 1, "es_results": []}, {"bug_id": 2376, "bug_title": "DataSource properties are not persisting via CLI", "bug_description": "\nThe CLI command show that there are some valid configuration properties available like following while configuring DataSources, However those properties never get persisted in the DataSource configuration:\n\n\n ./jboss-cli.sh  --user=admin --password=admin@123 -c --controller=remote://localhost:9999  command=\"/subsystem=datasources/data-source=testpool:read-resource-description(recursive=true)\" \n            \"stale-connection-checker-properties\" => \nUnknown macro: {\n                \"type\" => OBJECT,\n                \"description\" => \"The stale connection checker properties\",\n                \"expressions-allowed\" => true,\n                \"nillable\" => true,\n                \"value-type\" => STRING,\n                \"access-type\" => \"read-write\",\n                \"storage\" => \"configuration\",\n                \"restart-required\" => \"no-services\"\n            } \n,\n            \"reauth-plugin-properties\" => \nUnknown macro: {\n                \"type\" => OBJECT,\n                \"description\" => \"The properties for the reauthentication plugin\",\n                \"expressions-allowed\" => true,\n                \"nillable\" => true,\n                \"value-type\" => STRING,\n                \"access-type\" => \"read-write\",\n                \"storage\" => \"configuration\",\n                \"restart-required\" => \"no-services\"\n            } \n,\n            \"exception-sorter-properties\" => \nUnknown macro: {\n                \"type\" => OBJECT,\n                \"description\" => \"The exception sorter properties\",\n                \"expressions-allowed\" => true,\n                \"nillable\" => true,\n                \"value-type\" => STRING,\n                \"access-type\" => \"read-write\",\n                \"storage\" => \"configuration\",\n                \"restart-required\" => \"no-services\"\n            } \n,\n\nFollowing command never complains about any issue and the following command executed without any issue but the above properties are not persisted in the DataSource.\n\n ./jboss-cli.sh --user=admin --password=admin@123 -c --controller=remote://localhost:9999 command=\"/subsystem=datasources/data-source=testpool:add(jndi-name=\\\"java:jboss/TestDS\\\",driver-name=\\\"ojdbc6.jar\\\",connection-url=\\\"jdbc:oracle:thin:@DBHostName:1521:DBName\\\",user-name=\\\"user\\\",password=\\\"pass\\\",new-connection-sql=\\\"select 1 from dual\\\", check-valid-connection-sql=\\\"select 2 from dual\\\",valid-connection-checker-class-name=\\\"org.jboss.resource.adapter.jdbc.vendor.OracleValidConnectionChecker\\\",exception-sorter-properties=\n{\\\"prop1\\\"=>\\\"value1\\\"}\n,reauth-plugin-properties=\n{\\\"reauthProp1\\\"=>\\\"reauthValue1\\\"}\n,exception-sorter-properties=\n{\\\"exceptionSorterProp1\\\"=>\\\"exceptionSorterValue1\\\"}\n)\"\n\nThe Generated DataSource looks like following:\n\n$\n                <datasource jndi-name=\"java:jboss/TestDS\" pool-name=\"testpool\" enabled=\"true\">\n                    <connection-url>jdbc:oracle:thin:@DBHostName:1521:DBName</connection-url>\n                    <driver>ojdbc6.jar</driver>\n                    <new-connection-sql>select 1 from dual</new-connection-sql>\n                    <security>\n                        <user-name>user</user-name>\n                        <password>pass</password>\n                    </security>\n                    <validation>\n                        <valid-connection-checker class-name=\"org.jboss.resource.adapter.jdbc.vendor.OracleValidConnectionChecker\"/>\n                        <check-valid-connection-sql>select 2 from dual</check-valid-connection-sql>\n                    </validation>\n                </datasource>\n$", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.connector.subsystems.datasources.Constants.java"], "label": 1, "es_results": []}, {"bug_id": 3419, "bug_title": "beans in module jars are not discovered except the first jar in module", "bug_description": "CDI does not scan module with multiple jars. Only first jar is scanned.\nWorkaround is to package everything in single jar file.\nTo reproduce:\n\n\n\n\n\n\n#download attached files\n\n\n\n\n#download and unzip wildfly\n\n\n\n\ncd wildfly-9.0.0.Alpha1-SNAPSHOT #or other version > 8.0.0\n\n\n\n\nunzip ../module.multiplejars.zip\n\n\n\n\ncp ../servlet-cdi-test3.war standalone/deployments/\n\n\n\n\n./bin/standalone.sh\n\n\n\n\n# observe deployment fails\n\n\n\n\n# stop server\n\n\n\n\nunzip ../module.ok.zip\n\n\n\n\n./bin/standalone.sh\n\n\n\n\n# observe deployment succeeds\n\n\n\n\n\n\nThe same scenario succeeds in both cases on EAP 6.2.x.\nmodule.ok.zip was created from module.multiplejars.zip by merging jar files into single one", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.weld.deployment.processors.ExternalBeanArchiveProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 4050, "bug_title": "data-source:enable is broken", "bug_description": "Enabling a disabled datasource using the operation :enable() is broken. It remains disabled. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.connector.subsystems.datasources.DataSourceEnable.java"], "label": 1, "es_results": []}, {"bug_id": 4273, "bug_title": "EJBClient message \"Unsupported message received with header 0xffffffff\" generated when reconnecting to a non-clustered server", "bug_description": "The EJBClient protocol handler on the server side, org.jboss.as.ejb3.remote.protocol.versionone.VersionOneProtocolChannelReceiver, will send out a full cluster topology report to a connecting EJBClient. This will happen in particular when the client reconnects after a server which was initially up went down and came up again.\nIf the server is not clustered, the report gets sent out anyway, and erroneously with an empty message body. This message gets processed on the client side by org.jboss.ejb.client.remoting.ChannelAssociation.processResponse() which cannot recognize the message header. The exception results.\nOne way to fix this is to only send out the cluster topology message if the node is actually clustered.\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.ejb3.remote.protocol.versionone.VersionOneProtocolChannelReceiver.java"], "label": 1, "es_results": []}, {"bug_id": 2480, "bug_title": "Investigate Infinispan test XML files do not validate against XSD yet are parsed ok", "bug_description": "So one or the other should to change.\ncvc-complex-type.2.4.a: Invalid content was found starting with element &apos;store&apos;. One of &apos;\n{\"urn:jboss:domain:infinispan:2.0\":backups, \"urn:jboss:domain:infinispan:2.0\":backup-for}\n&apos; is expected.\ncvc-complex-type.2.4.a: Invalid content was found starting with element &apos;mixed-keyed-jdbc-store&apos;. One of &apos;\n{\"urn:jboss:domain:infinispan:2.0\":backups, \"urn:jboss:domain:infinispan:2.0\":backup-for}\n&apos; is expected.\ncvc-complex-type.2.4.d: Invalid content was found starting with element &apos;binary-keyed-table&apos;. No child element is expected at this point.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.InfinispanSubsystemXMLWriter.java"], "label": 1, "es_results": []}, {"bug_id": 2542, "bug_title": "Groovy class implementing javax.jms.MessageListener error", "bug_description": "A Groovy class implementing the MessageListener interface (Message Drive Beans) returns an error at the deployment.\norg.jboss.as.server.deployment.DeploymentUnitProcessingException: JBAS014194: EJB 3.1 FR 5.4.2 MessageDrivenBean com.filipeferraz.service.MDBGroovyService does not implement 1 interface nor specifies message listener interface\nI have tested with a Java version of the class and works fine, the problem appers only when using a groovy class to implements the MessageListener interface.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Beta1", "fixed_version": "8.0.0.CR1", "fixed_files": ["org.jboss.as.ejb3.deployment.processors.ViewInterfaces.java"], "label": 1, "es_results": []}, {"bug_id": 2807, "bug_title": "Messaging subsystem runtime-queue resource is not registered as \"runtime-only\"", "bug_description": "The runtime-queue resource only exists at runtime but isn&apos;t registered as such. I noticed this as ManagementClient does a recursive read-resource of the entire tree, but with include-runtime=false, but a CI run showed a failure reading one of these resources anyway:\n```\n21:01:01,754 ERROR [org.jboss.as.controller.management-operation] (management-handler-thread - 4) JBAS014613: Operation (\"read-attribute\") failed - address: ([\n    (\"subsystem\" => \"messaging\"),\n    (\"hornetq-server\" => \"default\"),\n    (\"runtime-queue\" => \"jms.tempqueue.661a6b15-7863-4d6c-b4b1-f8d62d294ea5\")\n]) - failure description: \"JBAS011676: No resource exists at address [\n    (\\\"subsystem\\\" => \\\"messaging\\\"),\n    (\\\"hornetq-server\\\" => \\\"default\\\"),\n    (\\\"runtime-queue\\\" => \\\"jms.tempqueue.661a6b15-7863-4d6c-b4b1-f8d62d294ea5\\\")\n]\"\n```\nDoing read-resource with these is a bit problematic in any case, since a bunch of read-attribute calls get executed as steps (that&apos;s what the above was) but the resource can disappear in the middle. But that&apos;s a separate problem. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.CR1", "fixed_version": "9.0.0.CR1", "fixed_files": ["org.jboss.as.messaging.MessagingExtension.java", "org.jboss.as.test.integration.messaging.jms.definitions.JMSResourceManagementTestCase.java", "org.jboss.as.messaging.HornetQServerResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 3095, "bug_title": "Weld subsystem exposes way too much dependancies to user deployment", "bug_description": "module org.jboss.as.weld should not be added as dependency to user deployment.\nIt has way too much dependencies and some of them export their dependencies which than end up in user deployment.\nWe should probably have extra module for stuff that is exposed to deployment.\nAlso lots of dependencies that weld subsystem has should be optional as we shouldn&apos;t be required to have dependency to almost every single subsystem we have as required.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "10.0.0.Alpha2", "fixed_files": ["org.jboss.as.weld.deployment.processors.WeldDependencyProcessor.java", "org.jboss.as.weld.injection.WeldInjectionContext.java"], "label": 1, "es_results": []}, {"bug_id": 2160, "bug_title": "Allow Expression for datasource subsystem enabled property", "bug_description": "Currently the datasource sub system does not allow expressions. I would like to be able to do this: <datasource jta=\"true\" jndi-name=\"java:/ds1DS\" pool-name=\"ds1DS\" enabled=\"$\n{ds1.enabled}\n\" use-java-context=\"true\" use-ccm=\"true\"> and set the ds1.enabled property via a properties file.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Alpha4", "fixed_version": "10.0.0.Beta1", "fixed_files": ["org.jboss.as.connector.subsystems.datasources.Constants.java", "org.jboss.as.connector.subsystems.datasources.AbstractDataSourceAdd.java"], "label": 1, "es_results": []}, {"bug_id": 3248, "bug_title": "Clustering Extended testsuite is broken", "bug_description": "What we did a while back, we made the sync-tcp the default configuration for running the clustering tests. However, we kept a extended testsuite with other combinations and other unimportant clustering tests.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.0.0.Final", "fixed_version": "10.1.0.Final", "fixed_files": ["org.jboss.as.test.clustering.extended.ejb2.stateful.passivation.dd.ClusterPassivationDDTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3324, "bug_title": "POJO objects are not removed from logging.properties when manually removing them from JBoss Config XML", "bug_description": "If I remove a custom Log4J appender from my standalone.xml and restart JBoss, I can still see the POJO definition for the removed appender in my logging.properties file.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.CR1", "fixed_version": "8.1.0.CR2", "fixed_files": ["org.jboss.as.logging.LoggingSubsystemAdd.java"], "label": 1, "es_results": []}, {"bug_id": 3315, "bug_title": "CalendarBasedTimeoutTestCase failure when using French locale", "bug_description": "CalendarBasedTimeoutTestCase fails when running on my laptop using the French locale.\nFrench and English locales differs in the value of the 1st day of week:\ncal = new GregorianCalendar(Locale.ENGLISH);\nSystem.out.println(\"cal = \" + cal.getFirstDayOfWeek()); => 1 // SUNDAY\ncal = new GregorianCalendar(Locale.FRANCE);\nSystem.out.println(\"cal = \" + cal.getFirstDayOfWeek()); => 2 // MONDAY\nThe code in CalendarBasedTimeout set the 1st day of week to SUNDAY for the 1st timeout but does not set it in the truncate() method which makes comparing the date and its truncated copy bogus.\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.CR1", "fixed_version": "8.1.0.CR2", "fixed_files": ["org.jboss.as.ejb3.timerservice.schedule.CalendarBasedTimeout.java", "org.jboss.as.ejb3.timer.schedule.CalendarBasedTimeoutTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3322, "bug_title": "Calling operations on non-existing messaging resources returns cryptic error", "bug_description": "Calling operations on messaging resources that do not exist fails with a cryptic error:\n\n\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=messaging/hornetq-server=default/runtime-queue=non-exisiting-queue:count-messages\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"result\" => undefined,\n\n\n\n\n    \"failure-description\" => \"JBAS014749: Operation handler failed: null\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n\n\nInstead, the normal error for that case should be return:\n\n\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=messaging/hornetq-server=default/runtime-queue=non-exisiting-queue:count-messages\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"JBAS014807: Management resource &apos;[\n\n\n\n\n    (\\\"subsystem\\\" => \\\"messaging\\\"),\n\n\n\n\n    (\\\"hornetq-server\\\" => \\\"default\\\"),\n\n\n\n\n    (\\\"runtime-queue\\\" => \\\"non-exisiting-queue\\\")\n\n\n\n\n]&apos; not found\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.CR1", "fixed_version": "8.1.0.CR2", "fixed_files": ["org.jboss.as.messaging.jms.JMSQueueReadAttributeHandler.java", "org.jboss.as.messaging.jms.JMSServerControlHandler.java", "org.jboss.as.messaging.jms.AbstractUpdateJndiHandler.java", "org.jboss.as.messaging.jms.JMSTopicControlHandler.java", "org.jboss.as.messaging.SecurityRoleReadAttributeHandler.java", "org.jboss.as.messaging.AbstractHornetQComponentControlHandler.java", "org.jboss.as.messaging.QueueReadAttributeHandler.java", "org.jboss.as.messaging.jms.JMSQueueControlHandler.java", "org.jboss.as.messaging.AbstractQueueControlHandler.java", "org.jboss.as.messaging.HornetQServerControlWriteHandler.java", "org.jboss.as.messaging.ManagementUtil.java", "org.jboss.as.messaging.jms.bridge.JMSBridgeHandler.java", "org.jboss.as.messaging.jms.JMSTopicReadAttributeHandler.java", "org.jboss.as.messaging.QueueControlHandler.java", "org.jboss.as.messaging.MessagingMessages.java", "org.jboss.as.messaging.AddressControlHandler.java", "org.jboss.as.messaging.jms.ConnectionFactoryReadAttributeHandler.java"], "label": 1, "es_results": []}, {"bug_id": 3280, "bug_title": " Thread locking problem when app server is going to shutdown", "bug_description": "I face problem that remoting thread and MSC service thread is deadlocked when server is going to shutdown.\nThis happens in half of the cases when I run my integration arquillian tests again EAP 6.3.0 engineering releases.\nI deploy one testing application packaged as jar file and then jdbc driver is deployed by copying to deployments folder.\nI&apos;m attaching server log file and thread dump at the time when threads are stuck.\nI was trying to find out where the lock occurs and from the stack trace it happens on two places. One is lock on remoting queue and other is lock on DeploymentRepository object.\nI did a quick fix which seems to work for me that I removed &apos;synchronized&apos; keyword from the methods which remove listeners in DeploymentRepository.\nIt means from:\nhttps://github.com/jbossas/jboss-eap/blob/6.x/ejb3/src/main/java/org/jboss/as/ejb3/deployment/DeploymentRepository.java#L103\nand\nhttps://github.com/jbossas/jboss-eap/blob/6.x/ejb3/src/main/java/org/jboss/as/ejb3/deployment/DeploymentRepository.java#L107\nI&apos;m really not sure whether this is &apos;a correct&apos; fix but I just put my observation here to have some starting point.\nThis could not be trouble in remoting directly, maybe it&apos;s rather problem of MSC component. If so, please, change the jira type. Thank you.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.CR1", "fixed_version": "8.1.0.Final", "fixed_files": ["org.jboss.as.ejb3.deployment.DeploymentRepository.java"], "label": 1, "es_results": []}, {"bug_id": 3365, "bug_title": "ClassLoader leak in org.jboss.el.cache.FactoryFinderCache", "bug_description": "After deploy/undeploy of a webapp that uses org.jboss.el, a reference to the webapp classloader remains in FactoryFinderCache.\nI currently work around this by calling FactoryFinderCache.clearClassLoader in a ServletContextListener. Uncommenting line 26 in LeakListener makes the reference go away on undeploy.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.CR2", "fixed_version": "8.1.0.Final", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentService.java"], "label": 1, "es_results": []}, {"bug_id": 3345, "bug_title": "Compilation error in clustering/web/infinispan w/ JDK 8u20 and Windows", "bug_description": "In clustering/web/infinispan/src/main/java/org/wildfly/clustering/web/infinispan/session/SimpleImmutableSessionAttributes.java I&apos;m getting the following compilation error which IMHO is also a logical error:\n\n\n\n\n\n\n[ERROR] /C:/temp/wildfly-8.1.0.CR2/clustering/web/infinispan/src/main/java/org/wildfly/clustering/web/infinispan/session/SimpleImmutableSessionAttributes.java:[42,17] variable attributes might not have been initialized\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.CR2", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.SimpleImmutableSessionAttributes.java"], "label": 1, "es_results": []}, {"bug_id": 3475, "bug_title": "Support vaulted properties for JMSContext annotation", "bug_description": "It is possible to annotate an injected JMSContext with a @JMSPasswordCredential. The userName & password attributes of this annotation should support to be vaulted so no user credentials would appear in clear text in the source file:\n\n\n\n\n\n\n    @Inject\n\n\n\n\n    @JMSConnectionFactory(\"java:jboss/exported/jms/RemoteConnectionFactory\")\n\n\n\n\n    @JMSPasswordCredential(userName = \"${VAULT::messaging::userName::1}\", password = \"${VAULT::messaging::password::1}\")\n\n\n\n\n    private JMSContext context;\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.test.integration.messaging.jms.context.InjectedJMSContextTestCase.java", "org.jboss.as.messaging.deployment.JMSContextProducer.java", "org.jboss.as.messaging.deployment.CDIDeploymentProcessor.java", "org.jboss.as.messaging.deployment.JMSCDIExtension.java"], "label": 1, "es_results": []}, {"bug_id": 3448, "bug_title": "Session ID change with sub-directories using \"/\" context (virtual host)", "bug_description": "I used a virtual host in Wildfly like this :\n<host name=\"toto\" alias=\"www.toto.com\">\n  <location name=\"/\" handler=\"welcome-content\"/>\n</host>\nWhen I try to access www.toto.com/sub/, a new cookie is created. It would be great with a \"/sub\" context but it is not for a \"/\" context.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java", "org.wildfly.extension.undertow.deployment.UndertowDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 3465, "bug_title": "Using Infinispan eviction manager can cause ConcurrentModificationException during web session access", "bug_description": "Because wildfly stores web session using multiple cache entries, it makes liberal use of Flag.SKIP_LOCKING when locks are already held on the primary cache entry for a given session.\nInfinispan&apos;s eviction manager, however, treats all cache entries the same.  Thus it may try to evict a cache entry that belongs to a session that is currently locked for use by the application - since it will have no trouble locking it - because our code assumes that all session access will first lock the primary cache entry of a session.  This manifests as a mysterious ConcurrentModificationException.\nThus, we can improve the compatibility of our code with Infinispan&apos;s eviction manager by simply removing the use of the SKIP_LOCKING flag.  Given that the only possible source of contention is the eviction manager - the cost of doing so is fairly minimal.\nI should note that our default configuration does not use Infinispan eviction.  Web session passivation is instead handled by the web session clustering code.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.InfinispanSessionManager.java", "org.wildfly.clustering.web.infinispan.session.fine.FineSessionFactory.java", "org.wildfly.clustering.web.infinispan.session.coarse.CoarseSessionFactory.java", "org.wildfly.clustering.web.infinispan.session.fine.FineSessionAttributes.java", "org.wildfly.clustering.web.infinispan.sso.coarse.CoarseSSOFactory.java", "org.wildfly.clustering.ejb.infinispan.InfinispanBeanManager.java"], "label": 1, "es_results": []}, {"bug_id": 3499, "bug_title": "POA_QUEUE_MAX is limited to 200 in EAP 5 a value of 500 was possible", "bug_description": "Description from Bugzilla https://bugzilla.redhat.com/show_bug.cgi?id=1070709 :\nPOA_QUEUE_MAX is limited to 200 in EAP 5 a value of 500 was possible", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.jacorb.JacORBSubsystemDefinitions.java"], "label": 1, "es_results": []}, {"bug_id": 3533, "bug_title": "Some web/ejb externalizers are not loading properly", "bug_description": "While investigating alternate file cache store options, I noticed that the serialized forms for certain cache keys were unexpectedly large.  Both the org.wildfly.clustering.web.infinispan and org.wildfly.clustering.ejb.infinispan are not importing services from org.jboss.as.clustering.infinispan.  Consequently, the externalizers from these modules are not being loaded properly.  Additionally, ejb cache keys are not properly using the SessionIDExternalizer to serialize SessionID, causing these keys to be larger than they ought to be.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.wildfly.clustering.ejb.infinispan.bean.InfinispanBeanKeyExternalizer.java"], "label": 1, "es_results": []}, {"bug_id": 3568, "bug_title": "Not possible to use wrapped injectionTarget for some EE components", "bug_description": "Using custom wrapped InjectionTarget should be available also for:\nWS endpoint\nEJB interceptor\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.weld.injection.WeldComponentService.java"], "label": 1, "es_results": []}, {"bug_id": 3479, "bug_title": "Inconsistencies in int/long in XSD and default values in Infinispan subsystem", "bug_description": "e.g.\n\n\n\n\n\n\n    static final SimpleAttributeDefinition SHUTDOWN_TIMEOUT = new SimpleAttributeDefinitionBuilder(ModelKeys.SHUTDOWN_TIMEOUT, ModelType.LONG, true)\n\n\n\n\n            .setXmlName(Attribute.SHUTDOWN_TIMEOUT.getLocalName())\n\n\n\n\n            .setAllowExpression(true)\n\n\n\n\n            .setFlags(AttributeAccess.Flag.RESTART_ALL_SERVICES)\n\n\n\n\n            .setDefaultValue(new ModelNode().set(25000))\n\n\n\n\n            .build()\n\n\n\n\n    ;\n\n\n\n\n\n\nspecifies long as the type, but the default value is int, moreover xsd also says int\n\n\n\n\n\n\n<xs:attribute name=\"shutdown-timeout\" type=\"xs:int\" default=\"25000\">\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.TransportResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.ExpirationResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.ClusteredCacheResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.LockingResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.DistributedCacheResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.StoreWriteBehindResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.RemoteStoreResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.StateTransferResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 3493, "bug_title": "Messaging subsystem allows you to remove a destination even though it has an attached client", "bug_description": "Currently jboss-cli allows a queue to be removed even though there is a MDB attached to it. The command \n\n\n\n\n\n\n/subsystem=messaging/hornetq-server=default/jms-queue=testQueue:remove()\n\n\n\n\n\n\nwill remove the queue without a warning. This is not desirable since a warning should be given or a reload should be force.  It may also break the dependency injection. ", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.messaging.jms.JMSQueueRemove.java", "org.jboss.as.messaging.jms.JMSTopicAdd.java", "org.jboss.as.messaging.jms.JMSTopicRemove.java", "org.jboss.as.messaging.jms.JMSQueueAdd.java", "org.jboss.as.messaging.BinderServiceUtil.java"], "label": 1, "es_results": []}, {"bug_id": 3507, "bug_title": "REGRESSION: JSP servlet cannot be mapped to different extensions", "bug_description": "When migrating an app from JBoss 7.1.1.Final to WildFly 8.1.0.Final, one can no longer remap the default JSP servlet to different extensions.\nThis is useful when you want some lightweight server-side processing of, say, JavaScript or CSS files.\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java"], "label": 1, "es_results": []}, {"bug_id": 3691, "bug_title": "AuditProvider mentions \"[Success]\" even if username/password is invalid", "bug_description": "Description of problem:\nAuditProvider in security-domain mentions \"[Success]\" as follow:-\n11:37:26,835 TRACE [org.jboss.security.audit] (HttpManagementService-threads - 3) [Success]Source=org.jboss.as.security.service.SimpleSecurityManager;Action=authentication;principal=admin;\neven if a username/password is wrong.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.security.service.SimpleSecurityManager.java"], "label": 1, "es_results": []}, {"bug_id": 3738, "bug_title": "Secured JavaEE appclient hangs on invalid login", "bug_description": "See attached sample EAR file: it contains a secured EJB and a JavaEE application client. When running the JavaEE application client, you are prompted to enter a user/password, which causes an authentication against a security domain (the prompt to enter login/password does not work correctly, so enter username when nothing more happens, press enter, enter password when nothing more happens and press enter ). \nIf you enter valid credentials (e.g. \"admin/admin\" or \"kunde/kunde\"), everything is fine. But if you enter e.g. an invalid password, the app client container does not exit. It hangs at the step \n\"20:39:28,649 INFO  [org.jboss.as] (MSC service thread 1-2) JBAS015950: WildFly 8.1.0.Final \"Kenny\" stopped in 339ms\"\nTo reproduce:\na) modify \"standalone.xml\":\na.1) I need a custom realm:\n            <security-realm name=\"KnaufRealm\">\n                <authentication>\n                    <jaas name=\"knaufsecurity\"/>\n                </authentication>\n            </security-realm>\na.2) add this security domain:\n                <security-domain name=\"knaufsecurity\" cache-type=\"default\">\n                    <authentication>\n                        <login-module code=\"Database\" flag=\"required\">\n                            <module-option name=\"dsJndiName\" value=\"java:jboss/datasources/ExampleDS\"/>\n                            <module-option name=\"principalsQuery\" value=\"SELECT PASSWORT FROM BENUTZER WHERE LOGIN=?\"/>\n                            <module-option name=\"rolesQuery\" value=\"SELECT R.ROLLE, &apos;Roles&apos; FROM ROLLE AS R, BENUTZER_ROLLE AS BR, BENUTZER AS B WHERE B.LOGIN=? AND BR.ROLLEN_ID = R.ID AND BR.BENUTZER_ID = B.ID\"/>\n                            <module-option name=\"unauthenticatedIdentity\" value=\"gast\"/>\n                        </login-module>\n                    </authentication>\n                </security-domain>\na.3) point the remoting connector to my own security realm:\n        <subsystem xmlns=\"urn:jboss:domain:remoting:2.0\">\n            <endpoint worker=\"default\"/>\n            <http-connector name=\"http-remoting-connector\" connector-ref=\"default\" security-realm=\"KnaufRealm\"/>\n        </subsystem>\nb) deploy attached EAR file to the server\nc) run JavaEE application client: %WILDFLY_HOME%\\bin\\appclient.bat c:\\path_to\\Security.ear#SecurityClient.jar", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.appclient.service.LazyConnectionContextSelector.java"], "label": 1, "es_results": []}, {"bug_id": 3823, "bug_title": "Memory leak with EJB Timer service", "bug_description": "There is a memory leak during undeploy (redeploy) when there is a timer used in EJB bean.\nWhen the timer is created (using @Schedule or programmatically), it is put in queue on Timer thread. According to JDK sources (http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7u40-b43/java/util/Timer.java#Timer line 552) The queue is processed if new timer is created or the next timer task is due to be run and the reference to last timer is retained on stack (line 521). Therefore after the module undeploy there is still a reference to TimerTask from the module.\nIt is not a true memory leak, because the reference will be removed when the task is due, but in environment with many redeploys (development and continuous integration) will soon hit the java.lang.OutOfMemoryError: PermGen space.\nOne workaround is to have another Scheduler, which will schedule job for every second. This way, the timer thread will process the queue and throw away the reference to last timerTask.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.ejb3.timerservice.TimerServiceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 3847, "bug_title": "AS7BindingRegistry does not respect the SPI contract", "bug_description": "The implementation of AS7BindingRegistry#lookup always return null.\nThis method is called by HornetQ when JNDI entries for its resources\nare updated using its own management API.\nWe advise against using it in WildFly (and use WildFly own management API) but we must still respect the SPI contract for this method.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Alpha1", "fixed_files": ["org.jboss.as.messaging.jms.AS7BindingRegistry.java"], "label": 1, "es_results": []}, {"bug_id": 3348, "bug_title": "DeploySingleServerGroupTestCase regularly fails on Windows", "bug_description": "See http://brontes.lab.eng.brq.redhat.com/viewLog.html?buildId=15206&tab=buildResultsDiv&buildTypeId=WF_MasterIgnoreWindows for an example  this fails repeatedly in the windows runs.\nThe @After method in the test asserts that the deployment file the test creates is successfully deleted. That may just be a bogus/unnecessary assertion, but rather than just removing it I thought it was better to check a bit first whether the CLI process is holding the file open. It shouldn&apos;t need to once upload of the deployment to the server is complete.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.CR2", "fixed_version": "8.2.0.Final", "fixed_files": ["org.jboss.as.test.integration.domain.management.cli.DeploySingleServerGroupTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3844, "bug_title": "Authentication cache is not flushed on logout", "bug_description": "This means that if a users details are changed even if they log in and out then these details will not be reflected when the user logs in again.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java"], "label": 1, "es_results": []}, {"bug_id": 3913, "bug_title": "HTTPS socket-binding definition always needed", "bug_description": "When removing HTTPS socket-binding from the standalone.xml file, the server start&apos;s in errors.\nThe errors are the following:\n\n\n\n\n\n\n\n\n\n\n\n    13:55:32,002 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) JBAS014613: Operation (\"add\") failed - address: ([\n\n\n\n\n        (\"subsystem\" => \"undertow\"),\n\n\n\n\n        (\"server\" => \"default-server\"),\n\n\n\n\n        (\"http-listener\" => \"default\")\n\n\n\n\n    ]) - failure description: {\"JBAS014771: Services with missing/unavailable dependencies\" => [\"jboss.undertow.listener.default is missing [jboss.binding.https]\"]}\n\n\n\n\n    13:55:32,005 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) JBAS014613: Operation (\"add\") failed - address: ([(\"subsystem\" => \"webservices\")]) - failure description: {\"JBAS014879: One or more services were unable to start due to one or more indirect dependencies not being available.\" => {\n\n\n\n\n        \"Services that were unable to start:\" => [\"jboss.ws.config\"],\n\n\n\n\n        \"Services that may be the because:\" => [\n\n\n\n\n            \"jboss.binding.https\",\n\n\n\n\n            \"jboss.remoting.remotingConnectorInfoService.http-remoting-connector\"\n\n\n\n\n        ]\n\n\n\n\n    }}\n\n\n\n\n    13:55:32,007 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) JBAS014613: Operation (\"add\") failed - address: ([\n\n\n\n\n        (\"subsystem\" => \"ejb3\"),\n\n\n\n\n        (\"service\" => \"remote\")\n\n\n\n\n    ]) - failure description: {\"JBAS014771: Services with missing/unavailable dependencies\" => [\"jboss.ejb3.connector is missing [jboss.remoting.remotingConnectorInfoService.http-remoting-connector]\"]}\n\n\n\n\n    13:55:32,074 INFO  [org.jboss.as.controller] (Controller Boot Thread) JBAS014774: Service status report\n\n\n\n\n    JBAS014775:    New missing/unsatisfied dependencies:\n\n\n\n\n          service jboss.binding.https (missing) dependents: [service jboss.undertow.listener.default]\n\n\n\n\n          service jboss.remoting.remotingConnectorInfoService.http-remoting-connector (missing) dependents: [service jboss.ejb3.connector]\n\n\n\n\n     \n\n\n\n\n    13:55:32,085 ERROR [org.jboss.as] (Controller Boot Thread) JBAS015875: WildFly 8.1.0.Final \"Kenny\" started (with errors) in 3475ms - Started 197 of 252 services (3 services failed or missing dependencies, 78 services are lazy, passive or on-demand\n\n\n\n\n\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.AjpListenerAdd.java", "org.wildfly.extension.undertow.ListenerResourceDefinition.java", "org.wildfly.extension.undertow.HttpListenerAdd.java", "org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java", "org.wildfly.extension.undertow.Server.java"], "label": 1, "es_results": []}, {"bug_id": 3968, "bug_title": "access log does not support %{r,xxx}", "bug_description": "AccessLogHandler&apos;s javadoc mentions:\n\n%{r,xxx} xxx is an attribute in the ServletRequest\nBut adding the following to access log pattern\n\n\n\n\n\n\n%{r,javax.servlet.error.status_code}\n\n\n\n\n\n\nresults in a server log message:\n\n\n\n\n\n\n19:55:55,432 ERROR [undertow] (MSC service thread 1-6) UT005017: Unknown variable %{r,javax.servlet.error.status_code}\n\n\n\n\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "8.2.0.Final", "fixed_files": ["org.wildfly.extension.undertow.AccessLogService.java"], "label": 1, "es_results": []}, {"bug_id": 3989, "bug_title": "TCCL in constructor of MDB is ModuleClassLoader for Module \"org.hornetq.ra:main\"", "bug_description": "The spec mandates that the TCCL be the application&apos;s classloader when the component is invoked (even during construction), but I&apos;m getting it as \nTCCL in constructor of MDB is ModuleClassLoader for Module \"org.hornetq.ra:main\" from local module loader\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.ejb3.inflow.JBossMessageEndpointFactory.java", "org.jboss.as.ee.component.ViewService.java", "org.jboss.as.test.integration.ejb.mdb.DDBasedMDB.java"], "label": 1, "es_results": []}, {"bug_id": 3939, "bug_title": "jndiView operation from JConsole returns void", "bug_description": "When I press \"jndiView\" operation button (navigate jboss.as / naming / Operations in MBeans tab of JConsole), an info dialog box returns with message \"Method successfully invoked\".  The contents of JNDI view is not printed anywhere.  It should return that as String or dump the contents into stdout.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "8.2.0.Final", "fixed_files": ["org.jboss.as.naming.subsystem.NamingSubsystemRootResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 3972, "bug_title": "Missing security domain dependency", "bug_description": "Only DataSourceEnable appears to have a dependency defined against the security domain used (SecurityDomainService).\nAlso any security domain used in recovery needs a dependency.\nLikewise for resource adapter deployments.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "8.2.0.Final", "fixed_files": ["org.jboss.as.connector.subsystems.datasources.DataSourceEnable.java", "org.jboss.as.connector.subsystems.resourceadapters.RaOperationUtil.java"], "label": 1, "es_results": []}, {"bug_id": 3830, "bug_title": "Use external-context for remote TIBCO ems lookup", "bug_description": "If an users uses the generic JMS RA with the TIBCO EMS messaging server, he has to duplicate all the JNDI parameters in the MDB annotations.\nInstead, he should be able to use a naming&apos;s external-context to connect to the Remote TIBCO server with the following configuration:\n\n\n\n\n\n\n            <bindings>\n\n\n\n\n                <external-context name=\"java:global/tibco\" module=\"com.tibco\" class=\"javax.naming.InitialContext\">\n\n\n\n\n                    <environment>\n\n\n\n\n                        <property name=\"java.naming.factory.initial\" value=\"com.tibco.tibjms.naming.TibjmsInitialContextFactory\"/>\n\n\n\n\n                        <property name=\"java.naming.provider.url\" value=\"tcp://<tibco_server>:<tibco_port>\"/>\n\n\n\n\n                        <property name=\"java.naming.factory.url.pkgs\" value=\"com.tibco.tibjms.naming\"/>\n\n\n\n\n                    </environment>\n\n\n\n\n                </external-context>\n\n\n\n\n            </bindings>\n\n\n\n\n\n\nWith these settings, the user only needs to pass the expected connection factory and destination lookup in the MDB:\n\n\n\n\n\n\n        @ActivationConfigProperty(propertyName = \"connectionFactory\", propertyValue = \"java:global/tibco/XACF\"),\n\n\n\n\n        @ActivationConfigProperty(propertyName = \"destination\", propertyValue = \"java:global/tibco/Q1\"),\n\n\n\n\n\n\nThe local JNDI lookup \"java:global/tibco/Q1\" will then use the external context (bound to \"java:global/tibco\") to lookup the \"Q1\" name on the TIBCO EMS.\nThere are a few bugs in the ExternalObjectFactory that prevents to use this configuration with a regular javax.naming.InitialContext to build the external context.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.naming.ExternalContextObjectFactory.java"], "label": 1, "es_results": []}, {"bug_id": 3429, "bug_title": "Classloader leak in JBossCachedAuthenticationManager", "bug_description": "When using a security domain with cache-type=\"default\", then the ModuleClassLoader instances related to deployments leak through JBossCachedAuthenticationManager.\nThe problematic piece of code is the domainCache member variable which in the DomainInfo value holds a LoginContext instance. This LoginContext has member contextClassLoader which causes the leak. (It points to the ModuleClassLoader of the deployment).\nOne option to solve this issue could be to remove the cache entries which are related to the undeployed application.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.CR1", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java"], "label": 1, "es_results": []}, {"bug_id": 3548, "bug_title": "JTA synchronization for a distributed transaction called with incorrect TCCL", "bug_description": "It seems the RequestProcessor which is processing JTA synchronizations\ndoes not have the right TCCL set.\nAs a result, during synchronization invocation:\n\nNameNotFoundException is thrown for a JNDI lookup of \"java:comp/UserTransaction\"\nif we try to acccess org.jboss.weld.Container by means of org.jboss.as.weld.services.ModuleGroupSingletonProvider.TCCLSingleton, we get ISE: \"Singleton not set....This means that you are trying to access a weld deployment with a Thread Context ClassLoader that is not associated with the deployment.\"\n\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.weld.WeldSubsystemAdd.java", "org.jboss.as.weld.services.bootstrap.WeldTransactionServices.java", "org.jboss.as.weld.deployment.processors.WeldDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 3657, "bug_title": "Injection not working on JAXWS handlers specified with @HandlerChain on service endpoint interfaces", "bug_description": "According to the JavaEE spec JAXWS-handlers should support injection (@Inject, @EJB), @PostConstruct and @PreDestroy.\nIn my test case (top-down approach, handler class is defined within *_handler.xml) @PostCunstruct works, but managed beans (CDI, EJB) are not injected via @Inject or @EJB. \nPossible workaround for EJBs: manual JNDI-lookup within @PostConstruct method. For CDI-managed beans you have to lookup the BeanManager and load the desired bean yourself.\nIt seems, that this issue should have been addressed by WFLY-2362. But it is still does not work.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.webservices.injection.WSHandlerChainAnnotationProcessor.java", "org.jboss.as.webservices.util.ASHelper.java"], "label": 1, "es_results": []}, {"bug_id": 3988, "bug_title": "Authorization denied for authenticated users when @PermitAll is used on EJB JAX-WS endpoint", "bug_description": "Given this endpoint:\n\n\n\n\n\n\n@Stateless\n\n\n\n\n@WebService(endpointInterface=\"com.redhat.gss.SecureEndpoint\")\n\n\n\n\n@DeclareRoles({\"a\",\"b\"})\n\n\n\n\n@WebContext(contextRoot=\"/endpoint\",urlPattern=\"/e\",authMethod=\"BASIC\")\n\n\n\n\npublic class SecureEndpointE implements SecureEndpoint {\n\n\n\n\n  @RolesAllowed({\"a\"})\n\n\n\n\n  public String a() {\n\n\n\n\n    return \"Success\";\n\n\n\n\n  }\n\n\n\n\n\n\n\n\n\n  @RolesAllowed({\"b\"})\n\n\n\n\n  public String b() {\n\n\n\n\n    return \"Success\";\n\n\n\n\n  }\n\n\n\n\n\n\n\n\n\n  @PermitAll\n\n\n\n\n  public String c() {\n\n\n\n\n    return \"Success\";\n\n\n\n\n  }\n\n\n\n\n}\n\n\n\n\n\n\nOne would expect any authenticated user to be able to invoke c(), but only users with a role found in @DelareRoles can invoke it.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.webservices.deployers.WSIntegrationProcessorJAXWS_EJB.java"], "label": 1, "es_results": []}, {"bug_id": 3518, "bug_title": "JASPIAuthenticationMechanism#authenticate does not check if AuthenticatedSession is null", "bug_description": "In org.wildfly.extension.undertow.security.jaspi.JASPIAuthenticationMechanism#authenticate the variable authSession in the fragment below is frequently null, leading to null pointer exceptions:\n\n\n\n\n\n\n  if (sessionManager != null) {\n\n\n\n\n            AuthenticatedSessionManager.AuthenticatedSession authSession = sessionManager.lookupSession(exchange);\n\n\n\n\n            cachedAccount = authSession.getAccount(); // NPE HAPPENS HERE\n\n\n\n\n            // if there is a cached account we set it in the security context so that the principal is available to\n\n\n\n\n            // SAM modules via request.getUserPrincipal().\n\n\n\n\n            if (cachedAccount !=  null) {\n\n\n\n\n                jaspicSecurityContext.setCachedAuthenticatedAccount(cachedAccount);\n\n\n\n\n            }\n\n\n\n\n        }\n\n\n\n\n\n\nAt another place in Undertow where AuthenticatedSession is used, there&apos;s an extra null check (See io.undertow.security.impl.CachedAuthenticatedSessionMechanism#runCached).\nI patched the code locally to add an extra null check:\n\n\n\n\n\n\n        if (sessionManager != null) {\n\n\n\n\n            AuthenticatedSessionManager.AuthenticatedSession authSession = sessionManager.lookupSession(exchange);\n\n\n\n\n            cachedAccount = authSession == null? null : authSession.getAccount();\n\n\n\n\n            // if there is a cached account we set it in the security context so that the principal is available to\n\n\n\n\n            // SAM modules via request.getUserPrincipal().\n\n\n\n\n            if (cachedAccount !=  null) {\n\n\n\n\n                jaspicSecurityContext.setCachedAuthenticatedAccount(cachedAccount);\n\n\n\n\n            }\n\n\n\n\n        }\n\n\n\n\n\n\nAfter a short amount of testing everything seems to be okay with that extra check.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "9.0.0.CR2", "fixed_files": ["org.wildfly.extension.undertow.security.jaspi.JASPIAuthenticationMechanism.java"], "label": 1, "es_results": []}, {"bug_id": 3334, "bug_title": "Event with qualifier @Initialized not raised if no webapp is deployed", "bug_description": "As stated in the CDI-specification (section 6.7.3. Application context lifecycle)\n\nAn event with qualifier @Initialized(ApplicationScoped.class) is fired when the application context is initialized and an event with qualifier @Destroyed(ApplicationScoped.class) is fired when the application is destroyed. \nBut in my environment this is only true, if the deployed application (packaged in an EAR) contains a webapplication (as WAR inside the EAR). If there is no webapplication, the event is not raised and observer-methods are not called at all.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.CR1", "fixed_version": "10.0.0.Alpha5", "fixed_files": ["org.jboss.as.weld.deployment.processors.BeanArchiveProcessor.java", "org.jboss.as.weld.deployment.WeldDeployment.java", "org.jboss.as.weld.deployment.BeanDeploymentModule.java", "org.jboss.as.weld.util.Utils.java", "org.jboss.as.weld.deployment.processors.WeldDeploymentProcessor.java", "org.jboss.as.weld.deployment.processors.ExternalBeanArchiveProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 5006, "bug_title": "support for extended persistence context with SynchronizationType.UNSYNCHRONIZED", "bug_description": "org.jboss.as.jpa.injectors.PersistenceContextInjectionSource handles injection of a persistence context into EE components.  PersistenceContextInjectionSource is not properly handling SynchronizationType.UNSYNCHRONIZED when injecting an extended persistence context.  I&apos;m not sure why this failure only appeared with Hibernate ORM 5.\nIf SynchronizationType is UNSYNCHRONIZED, we should call \nEntityManagerFactory.createEntityManager(SynchronizationType synchronizationType, Map map), instead of EntityManagerFactory.createEntityManager(Map map).", "project": "Wildfly", "sub_project": "WFLY", "version": "8.1.0.Final", "fixed_version": "10.0.0.Beta1", "fixed_files": ["org.jboss.as.jpa.container.TransactionScopedEntityManager.java", "org.jboss.as.jpa.injectors.PersistenceContextInjectionSource.java"], "label": 1, "es_results": []}, {"bug_id": 4106, "bug_title": "jsp-file directive prevents RequestDispatcher#forward to work correctly", "bug_description": "When there is a servlet specified like:\n\n\n\n\n\n\n<servlet>\n\n\n\n\n        <servlet-name>index</servlet-name>\n\n\n\n\n        <jsp-file>/index.jsp</jsp-file>\n\n\n\n\n    </servlet>\n\n\n\n\n    <servlet-mapping>\n\n\n\n\n        <servlet-name>index</servlet-name>\n\n\n\n\n        <url-pattern>/index</url-pattern>\n\n\n\n\n    </servlet-mapping>\n\n\n\n\n\n\nand the backing JSP uses RequestDispatcher#forward pointing to a different JSP file, the JspServlet will unfortunately try to render the first JSP again, resulting in StackOverflowError in most of the time.\nWhen investigating this issue with the debugger by making a sample request to /index, it appeared that JspFileHandler sets the request attribute Constants.JSP_FILE, and that will have the value of the JSP file from the <jsp-file> directive. This is great, until the JSP itself tries to call RequestDispatcher#forward using a path on the servletcontext, such as /hello.jsp. In this scenario, JspFileHandler no longer gets invoked, because simply that JSP isn&apos;t bound to a servlet, so the request attribute remain the old value and JspServlet just simply grabs the value from the request attribute again and displays the /index.jsp again, and again, and again.\nThis looks to be a bug in Jastow, but I&apos;m not really sure how to fix it. I would assume that using dispatcher#forward from a JSP to call an another JSP (even indirectly, i.e. through dispatching the request to a servlet, which then would dispatch the request to a JSP) should be within the bounds of the servlet spec, but let me know if I&apos;m violating the spec with my application in any ways.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.java"], "label": 1, "es_results": []}, {"bug_id": 4149, "bug_title": "NamingExceptions not properly handled in InitialContext", "bug_description": "The change in https://github.com/jbossas/jboss-eap/commit/db525bf1d90a40eb909c8f915fca787d55f4e7e5#different-833175ffb151a3398216d6422dadeeeeR112 catches all Exception and rewraps them with NamingException.  This behavior is undesirable if the original exception was already a NamingException.  Catch and re-throw that exception type as-is before wrapping other exceptions.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.naming.InitialContext.java"], "label": 1, "es_results": []}, {"bug_id": 4210, "bug_title": "Very Slow performance for larger JSF 2 pages.", "bug_description": "Very slow page performance using JSF 2 and Wildfly 8.2.0 for larger pages.  I am migrating a large application from JBoss AS 7.1.1 to Wildfly 8.2.0 and page performance on loads and posts is very slow.  I created a large JSF 2 test page and took timings for JBoss 7.1.1, Wildfly 8.2.0 and Tomcat 7.x using the same Mojarra 2.2.8 implementation as Wildfly.  \nThe attached war file contains mojarra 2.2.8 jars for tomcat.  The attached ear file is for JBoss deployments and does not contain mojarra jars.  \nExample test URL for attached ear and war.\nhttp://localhost:8080/testAppWeb/jsp/AjaxTest.jsf\nJBoss 7.1.1 Timings\nPage Load: 4.0 Seconds  \nPost:  4.5 Seconds\nAjax:  4.0 Seconds \nWildfly 8.2.0 Timings\nPage Load: 55.0 Seconds\nPost:  50 Seconds\nAjax:  7 Seconds \nTomcat 7.x with 2.2.8 Mojarra\nPage Load 1.0 Seconds\nPost:  0.75 Seconds\nAjax:  0.3  Seconds\n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.jsf.injection.weld.WeldApplication.java"], "label": 1, "es_results": []}, {"bug_id": 4205, "bug_title": "Undertow not detecting @HandlesTypes If the implentation class is inside EAR/lib", "bug_description": "Hi,\n    I have spring mvc enabled web apps (20+ web apps) packaged as an EAR deployment. All my spring mvc related jar&apos;s are in  my EAR/lib, i&apos;m using SpringServletContainerInitializer (implementation of ServletContainerInitializer ) code as follows\n\n\n\n\n\n\n@HandlesTypes(WebApplicationInitializer.class)\n\n\n\n\npublic class SpringServletContainerInitializer implements ServletContainerInitializer {\n\n\n\n\n\n\n\n\n\n\t@Override\n\n\n\n\n\tpublic void onStartup(Set<Class<?>> webAppInitializerClasses, ServletContext servletContext)\n\n\n\n\n\t\t\tthrows ServletException {\n\n\n\n\n\n\n\n\n\n\t\tList<WebApplicationInitializer> initializers = new LinkedList<WebApplicationInitializer>();\n\n\n\n\n\n\n\n\n\n\t\tif (webAppInitializerClasses != null) {\n\n\n\n\n\t\t\tfor (Class<?> waiClass : webAppInitializerClasses) {\n\n\n\n\n\t\t\t\t// Be defensive: Some servlet containers provide us with invalid classes,\n\n\n\n\n\t\t\t\t// no matter what @HandlesTypes says...\n\n\n\n\n\t\t\t\tif (!waiClass.isInterface() && !Modifier.isAbstract(waiClass.getModifiers()) &&\n\n\n\n\n\t\t\t\t\t\tWebApplicationInitializer.class.isAssignableFrom(waiClass)) {\n\n\n\n\n\t\t\t\t\ttry {\n\n\n\n\n\t\t\t\t\t\tinitializers.add((WebApplicationInitializer) waiClass.newInstance());\n\n\n\n\n\t\t\t\t\t}\n\n\n\n\n\t\t\t\t\tcatch (Throwable ex) {\n\n\n\n\n\t\t\t\t\t\tthrow new ServletException(\"Failed to instantiate WebApplicationInitializer class\", ex);\n\n\n\n\n\t\t\t\t\t}\n\n\n\n\n\t\t\t\t}\n\n\n\n\n\t\t\t}\n\n\n\n\n\t\t}\n\n\n\n\n\n\n\n\n\n\t\tif (initializers.isEmpty()) {\n\n\n\n\n\t\t\tservletContext.log(\"No Spring WebApplicationInitializer types detected on classpath\");\n\n\n\n\n\t\t\treturn;\n\n\n\n\n\t\t}\n\n\n\n\n\n\n\n\n\n\t\tAnnotationAwareOrderComparator.sort(initializers);\n\n\n\n\n\t\tservletContext.log(\"Spring WebApplicationInitializers detected on classpath: \" + initializers);\n\n\n\n\n\n\n\n\n\n\t\tfor (WebApplicationInitializer initializer : initializers) {\n\n\n\n\n\t\t\tinitializer.onStartup(servletContext);\n\n\n\n\n\t\t}\n\n\n\n\n\t}\n\n\n\n\n\n\n\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\nBut the @HandlesTypes(WebApplicationInitializer.class) are not getting detected from the EAR/lib\nEven i have tried adding the extracted the SPI from spring-web jar and added inside my war&apos;s WEB-INF/lib as a jar\n WEB-INF/lib/web-init-spi.jar which contains\nMETA-INF/services/javax.servlet.ServletContainerIntializer file with org.springframework.web.SpringServletContainerInitializer as an entry. This time its detecting SpringServletContainerInitializer but not detecting what defined in @HandlesTypes\nIts only working If i package all those spring mvc jars inside WEB-INF/lib then everything started working. \nI have no idea this is how the servlet specification works or its a wildfly issue but i see it as a problem for those who depends on Wildfly or similar EE Servers with an EAR deployment structure. \n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.wildfly.extension.undertow.deployment.ServletContainerInitializerDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 4250, "bug_title": "Manually created CDI producer methods in the Extension are not injected", "bug_description": "Issue description:\nDuring migration from Wildfly 8.1 to 8.2 (Weld 2.1.2.Final -> 2.2.6.Final) in Infinispan we discovered a problem with injecting beans created programmatically in Infinispan-cdi integration module. The problem appeared in GreetingServiceIT and GreetingCacheManagerIT test. Both those tests use the following modules integrated into Wildfly:\n\norg.infinispan.cdi (slot: ispn-7.1, which has dependency to \"org.infinispan\" slot=\"ispn-7.1\" export=\"true\")\norg.infinispan.jcache (slot: ispn-7.1, which has dependency to \"org.infinispan\" slot=\"ispn-7.1\" and \"org.infinispan.cdi\" slot=\"ispn-7.1\" services=\"import\")\n\nInfinispan&apos;s CDI Extension invokes embeddedExtension.registerCacheBeans(event, beanManager), which registers custom Cache and AdvancedCache producer beans. Those beans are being successfully added to BeanManager but are never chosen for injection. All tests fail because of unsatisfied dependencies for Cache<CacheKey, String> with qualifiers @GreetingCache.\nSteps to reproduce:\n\nDownload and unzip https://github.com/slaskawi/infinispan/archive/upgrade_to_wf_8_2_failed_test.zip\nRun ./build.sh clean install -pl cdi,as-modules/embedded,integrationtests/as-integration-embedded -am -DskipTests\nModify Arquillian xml if breakpoint is needed ./integrationtests/as-integration-embedded/src/test/resources/arquillian.xml\nRun test (using IDE or Maven: ./build.sh test -pl integrationtests/as-integration-embedded -Dtest=GreetingServiceIT)\n\nFinding during debugging:\nAt first I would suggest creating conditional breakpoints:\n\norg.jboss.weld.bootstrap.Validator line 370 (WF 8.2) or 366 (WF 8.1), condition \"[BackedAnnotatedField] @Inject @GreetingCache private org.infinispan.test.integration.as.cdi.GreetingServiceIT.greetingCache\".equals(ij.toString()) - this will stop debugger when validating injection points for {GreetingCache.\norg.jboss.weld.resolution.TypeSafeResolver.ResolvableToBeanCollection line 51, condition from.toString().startsWith(\"Types: [org.infinispan.Cache<javax.cache.annotation.CacheKey, java.lang.String>]\") || from.toString().contains(\"org.infinispan.Cache\") - this stops debugger on loading Cache producer methods (created in Infinispan CDI Extension) to resolved Loading Cache in Wildfly 8.1.\n\nDuring debugging session we discovered that the beans from Infinispan&apos;s CDI Extension are created but never used for injection. This is because beanManager.getBeans(ij) in Validator.java always return empty list. In Wildfly 8.1 beans are properly resolved using ResolvableToBeanCollection#load method, but for some reason it never happens in Wildfly 8.2, because those beans are already preset in resolved Loading Cache with empty collection value. Unfortunately we couldn&apos;t find answer why.\nWorkaround:\nIn order to fix CDI Producer Beans accessibility we need to add a new dependency to our test: META-INF/MANIFEST.MF: Dependencies: org.infinispan:ispn-7.1.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.weld.deployment.BeanDeploymentArchiveImpl.java"], "label": 1, "es_results": []}, {"bug_id": 4323, "bug_title": "Transaction metrics all zero", "bug_description": "Hello, I have enabled the transactions metrics in standalone.xml on my Wildfly 8.2.0 as below but the transactions metrics are always zero, even though I have many projects deployed using transactions. Probably something trivial is missing, could some one tell me what is wrong? I&apos;m using the Spring Framework 4.1.2 and Hibernate as installed in the Wildfly modules.\nI started this as a question on the forum but got no answer. Please note that the exact same configuration on the same server gives Transaction statistics with the same deployments on JBoss 7.1.1\n  Thanks for any help, Tim Mickelson\n    \t<subsystem xmlns=\"urn:jboss:domain:transactions:2.0\">\n        \t<core-environment>\n            \t<process-id>\n                \t<uuid/>\n            \t</process-id>\n        \t</core-environment>\n        \t<recovery-environment socket-binding=\"txn-recovery-environment\" status-socket-binding=\"txn-status-manager\"/>\n        \t<coordinator-environment default-timeout=\"300\" statistics-enabled=\"true\"/>\n    \t</subsystem>\nThe datasource is configured as (with jta true):\n            \t<datasource jta=\"true\" jndi-name=\"java:/youconnect\" pool-name=\"youconnect_Pool\" enabled=\"true\" use-java-context=\"true\" use-ccm=\"true\">\n                \t<connection-url>jdbc:postgresql://127.0.0.1:5432/youconnect</connection-url>\n                \t<driver-class>org.postgresql.Driver</driver-class>\n                \t<driver>ps</driver>\n                \t<pool>\n                    \t<min-pool-size>10</min-pool-size>\n                    \t<max-pool-size>30</max-pool-size>\n                    \t<prefill>true</prefill>\n                    \t<flush-strategy>IdleConnections</flush-strategy>\n                \t</pool>\n                \t<security>\n                    \t<user-name>yyyy</user-name>\n                    \t<password>xxxxx</password>\n                \t</security>\n            \t</datasource>", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.txn.subsystem.TransactionSubsystemAdd.java"], "label": 1, "es_results": []}, {"bug_id": 4388, "bug_title": "Weld starts also for deployments with \"bean-discovery-mode=none\".", "bug_description": "This seems to me at least unneccessary.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.weld.deployment.processors.BeansXmlProcessor.java", "org.jboss.as.weld.deployment.processors.WeldImplicitDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 4438, "bug_title": "Singleton EJB constructor called per method invocation", "bug_description": "@Singleton EJB constructor and @PostConstruct method call not once.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.weld.ejb.SessionObjectReferenceImpl.java", "org.jboss.as.weld.ejb.StatefulSessionObjectReferenceImpl.java"], "label": 1, "es_results": []}, {"bug_id": 4464, "bug_title": "JDBC driver module-slot is not persisted in domain mode", "bug_description": "The module-slot of jdbc-driver is NOT persisted in domain mode, but it is persisted in standalone mode.\nAfter debugging, I found that the performRuntime() method of JdbcDriverAdd.java is not called in domain mode, but is called in standalone mode.\nFor more information about the issue, please refer to the thread: https://developer.jboss.org/thread/253654", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "9.0.0.CR1", "fixed_files": ["org.jboss.as.connector.subsystems.complextestcases.ComplexDatasourceSubsystemTestCase.java", "org.jboss.as.connector.subsystems.datasources.JdbcDriverAdd.java", "org.jboss.as.connector.subsystems.datasources.DataSourcesExtension.java", "org.jboss.as.connector.subsystems.datasources.DsParser.java"], "label": 1, "es_results": []}, {"bug_id": 4844, "bug_title": "When Wildfly EJB timer finishes, the transaction is not fully committed. ", "bug_description": "When a Singleton EJB timer finishes, if the next run has already started but waiting on the write lock of Singleton EJB, the next run won&apos;t see the changes committed by the current run. So I assume when the EJB timers finishes, the transaction is not fully committed, or it&apos;s the next run that starts too early.\nHere is a test case that should be able to reproduce the issue we are facing. \nhttps://github.com/xiaodong-xie/wildfly-singleton-timer\nHere is my analysis of this issue: \nThe CMTTxInterceptor is applied before ContainerManagedConcurrencyInterceptor. \nSo when waiting for the write lock of EJBReadWriteLock, we&apos;ve already started the transaction, which IMHO is earlier than necessary. \n", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "10.0.0.Alpha6", "fixed_files": ["org.jboss.as.ejb3.component.singleton.SingletonComponent.java", "org.jboss.as.ejb3.concurrency.ContainerManagedConcurrencyInterceptorFactory.java", "org.jboss.as.ejb3.concurrency.LockableComponent.java", "org.jboss.as.ejb3.component.singleton.SingletonComponentDescription.java", "org.jboss.as.ee.component.interceptors.InterceptorOrder.java"], "label": 1, "es_results": []}, {"bug_id": 4340, "bug_title": "use-try-lock exposed for <connection-definition>", "bug_description": "<connection-definition> DMR:\n\n\n\n\n\n\nuse-try-lock                    undefined                                               LONG\n\n\n\n\n\n\nwhich should be removed", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "10.0.0.Beta1", "fixed_files": ["org.jboss.as.connector.subsystems.resourceadapters.CommonAttributes.java"], "label": 1, "es_results": []}, {"bug_id": 6672, "bug_title": "EJB's async methods' Future#get should treat zero timeout as \"do not wait\"", "bug_description": "Say there is an asynchronous EJB method:\n\n\n\n\n\n\n@Asynchronous\n\n\n\n\npublic Future<Boolean> method() {\n\n\n\n\n   ...\n\n\n\n\n}\n\n\n\n\n\n\nCalling Future#get with a zero timeout:\n\n\n\n\n\n\nif (bean.method().get(0, TimeUnit.MILLISECONDS))\n\n\n\n\n\n\nresults in a block until the task is finished.\nInstead I expected zero waiting, because java.util.concurrent.Future.get(long, TimeUnit) doesn&apos;t specify any special treatment for a zero timeout value.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.0.Final", "fixed_version": "10.1.0.Final", "fixed_files": ["org.jboss.as.ejb3.component.interceptors.AsyncInvocationTask.java"], "label": 1, "es_results": []}, {"bug_id": 5995, "bug_title": "Initial calculation of the first expiration time for a scheduled timer is wrong if a start date is set", "bug_description": "If a scheduled timer should be created with the following parameters:\nScheduleExpression[second=0 minute=0/5 hour=20-22 dayOfWeek=* dayOfMonth=* month=* year=* start=Thu Jan 14 09:45:35 GMT+1 2016]\nThe first schedule should be \n  Thu Jan 17 20:00:20 GMT+1 2016\nbut is calculated as\n  Sun Jan 17 20:45:35 GMT+1 2016\nThe minutes are not correctly set according to the schedule and the given start date.\nThis happen for seconds/minutes if the ScheduleExpression limit the range.", "project": "Wildfly", "sub_project": "WFLY", "version": "8.2.1.Final", "fixed_version": "10.0.0.Final", "fixed_files": ["org.jboss.as.ejb3.timerservice.schedule.CalendarBasedTimeout.java", "org.jboss.as.ejb3.timer.schedule.CalendarBasedTimeoutTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 3875, "bug_title": "HTTPSession sharing between wars delivered in an EAR failure in standalone-ha.xml", "bug_description": "Deploying two Web applications within an EAR achive with the following jboss-all.xml, leads to a failure in deployment when using standalone-ha.xml configuration: \n<jboss umlns=\"urn:jboss:1.0\">\n    <shared-session-config xmlns=\"urn:jboss:shared-session-config:1.0\">\n        <session-config>\n            <cookie-config>\n                <path>/</path>\n            </cookie-config>\n        </session-config>\n    </shared-session-config>\n</jboss>\nException raised:\n15:58:52,160 ERROR [org.jboss.as.controller.management-operation] (DeploymentScanner-threads - 2) WFLYCTL0013: Operation (\"deploy\") failed - address: ([(\"deployment\" => \"ear1.ear\")]) - failure description: \n{\"WFLYCTL0180: Services with missing/unavailable dependencies\" => [\n\n    \"jboss.undertow.deployment.default-server.default-host./webapp1.codec.locator is missing [jboss.clustering.web.locator.\\\"ear1.ear.webapp1.war\\\"]\",\n\n    \"jboss.undertow.deployment.default-server.default-host./webapp2.codec.locator is missing [jboss.clustering.web.locator.\\\"ear1.ear.webapp2.war\\\"]\"\n\n]}\n15:58:52,227 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) WFLYSRV0010: Deployed \"ear1.ear\" (runtime-name : \"ear1.ear\")\n15:58:52,230 INFO  [org.jboss.as.controller] (DeploymentScanner-threads - 2) WFLYCTL0183: Service status report\nWFLYCTL0184:    New missing/unsatisfied dependencies:\n      service jboss.clustering.web.locator.\"ear1.ear.webapp1.war\" (missing) dependents: [service jboss.undertow.deployment.default-server.default-host./webapp1.codec.locator]\n      service jboss.clustering.web.locator.\"ear1.ear.webapp2.war\" (missing) dependents: [service jboss.undertow.deployment.default-server.default-host./webapp2.\ncodec.locator]", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.wildfly.extension.undertow.session.SharedSessionManagerConfig.java", "org.wildfly.extension.undertow.deployment.SharedSessionManagerDeploymentProcessor.java", "org.wildfly.extension.undertow.deployment.UndertowDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 3905, "bug_title": "POJO JAX-WS endpoints should not be processed if packaged in EJB-jar", "bug_description": "If a POJO is defined like this in an EJB-jar:\n\n\n\n\n\n\npackage com.redhat.gss.ws; \n\n\n\n\n\n\n\n\n\n@javax.jws.WebService \n\n\n\n\npublic class HelloService { \n\n\n\n\n  public String sayHello() { \n\n\n\n\n    return \"Hello World!\"; \n\n\n\n\n  } \n\n\n\n\n}\n\n\n\n\n\n\nDeployment structure:\n\n\n\n\n\n\nklape@localhost ws-java.jar$ tree\n\n\n\n\n.\n\n\n\n\n com\n\n\n\n\n  redhat\n\n\n\n\n      gss\n\n\n\n\n          ws\n\n\n\n\n              HelloService.java\n\n\n\n\n META-INF\n\n\n\n\n     MANIFEST.MF\n\n\n\n\n\n\n\n\n\n5 directories, 2 files\n\n\n\n\nklape@localhost ws-java.jar$\n\n\n\n\n\n\nUpon deployment, you get this in the log:\n\n\n\n\n\n\n16:52:51,372 INFO  [org.jboss.ws.cxf.metadata] (MSC service thread 1-7) JBWS024061: Adding service endpoint metadata: id=com.redhat.gss.ws.HelloService\n\n\n\n\n address=http://localhost:8080/ws-java/HelloService\n\n\n\n\n implementor=com.redhat.gss.ws.HelloService\n\n\n\n\n serviceName={http://ws.gss.redhat.com/}HelloServiceService\n\n\n\n\n portName={http://ws.gss.redhat.com/}HelloServicePort\n\n\n\n\n annotationWsdlLocation=null\n\n\n\n\n wsdlLocationOverride=null\n\n\n\n\n mtomEnabled=false\n\n\n\n\n16:52:51,571 INFO  [org.apache.cxf.service.factory.ReflectionServiceFactoryBean] (MSC service thread 1-7) Creating Service {http://ws.gss.redhat.com/}HelloServiceService from class com.redhat.gss.ws.HelloService\n\n\n\n\n16:52:51,879 INFO  [org.apache.cxf.endpoint.ServerImpl] (MSC service thread 1-7) Setting the server&apos;s publish address to be http://localhost:8080/ws-java/HelloService\n\n\n\n\n16:52:51,925 INFO  [org.jboss.ws.cxf.deployment] (MSC service thread 1-7) JBWS024074: WSDL published to: file:/home/remote/klape/work/archives/wildfly-8.1.0.Final/standalone/data/wsdl/ws-java.jar/HelloServiceService.wsdl\n\n\n\n\n\n\nYet when you try to get the WSDL at http://localhost:8080/ws-java/HelloService?wsdl (pulled from the metadata in the log), you get a 404 error.\nJBossWS should not be trying to deploy the POJO endpoint from within an EJB-jar.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.webservices.deployers.WSIntegrationProcessorJAXWS_POJO.java"], "label": 1, "es_results": []}, {"bug_id": 3957, "bug_title": "Non-distributable session manager ignores max-active-sessions from jboss-web.xml", "bug_description": "InMemorySessionManagerFactory already has a constructor that accepts the maximum session size, we just need to utilize it.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 3881, "bug_title": "User should not be able to use empty JNDI name ('java:/' or 'java:jboss/')", "bug_description": "https://bugzilla.redhat.com/show_bug.cgi?id=1019260\nDescription of problem:\n Currently the only validation for JNDI names is: JNDI name has to start with &apos;java:/&apos; or &apos;java:jboss/&apos;. But user is able to enter just &apos;java:/&apos; or &apos;java:jboss/&apos; as JNDI name. Using this JNDI name for eg. data-source will lead to java.lang.IllegalArgumentException: Empty name segment is not allowed for jboss. ", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.connector.logging.ConnectorLogger.java", "org.jboss.as.connector.subsystems.datasources.Constants.java"], "label": 1, "es_results": []}, {"bug_id": 4093, "bug_title": "Changing IOR settings should require restart of jacorb subsystem", "bug_description": "When using management operations to add IOR settings, the settings don&apos;t get reflected in the IORSecConfigMetaDataService until a server reload. The management operations should mark that the jacorb subsystem needs to be restarted.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.ejb3.iiop.EjbIIOPService.java", "org.jboss.as.jacorb.IORSASContextDefinition.java", "org.jboss.as.jacorb.IORASContextDefinition.java", "org.jboss.as.jacorb.IORSettingsDefinition.java", "org.jboss.as.jacorb.IORTransportConfigDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 4089, "bug_title": "ServletContainerInitializerDeploymentProcessor does not handle comments", "bug_description": "ServletContainerInitializerDeploymentProcessor.loadSci() has code to read the service file, rather than using the JDK-provided mechanisms, and it does not handle comments.\nThe API documentation at https://docs.oracle.com/javase/7/docs/api/java/util/ServiceLoader.html says that the # symbols and all following characters on the line should be ignored. It also notes the file must be UTF-8 encoded, and ServletContainerInitializerDeploymentProcessor does not appear to force that either.\nLog4j 2.1 triggers this bug (https://issues.apache.org/jira/browse/LOG4J2-890)", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.wildfly.extension.undertow.deployment.ServletContainerInitializerDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 4067, "bug_title": "DummyTransaction exception during session.invalidate with started conversation", "bug_description": "A DummyTransaction-IllegalStateException is thrown while invalidating a httpSession wit a started javax.enterprise.context.Converation.\nWe are working in \"full-ha\" with session distribution enabled (<distributable/> in web.xml)\nUnder https://ci.jboss.org/hudson/job/WildFly-latest-master/1334/ everything is working fine. No exception is thrown\nThe exception is thrown starting with version https://ci.jboss.org/hudson/job/WildFly-latest-master/1340 to the latest now (#1475)", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.wildfly.clustering.web.undertow.session.DistributableSessionTestCase.java", "org.wildfly.clustering.ee.Batch.java", "org.wildfly.clustering.web.undertow.session.DistributableSession.java", "org.wildfly.clustering.ee.infinispan.AbstractTransactionBatch.java"], "label": 1, "es_results": []}, {"bug_id": 4129, "bug_title": "The RemotingLoginModule should first check if there is already a RealmUser", "bug_description": "The reason is because the realm may have actually already substituted in a different name for the user.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.security.remoting.RemotingLoginModule.java"], "label": 1, "es_results": []}, {"bug_id": 4132, "bug_title": "Transaction subsystem does not initialise the recovery store correctly", "bug_description": "The initialisation code in the transaction subsystem sets the transaction log directory on the wrong instance (https://github.com/wildfly/wildfly/blob/master/transactions/src/main/java/org/jboss/as/txn/service/ArjunaObjectStoreEnvironmentService.java#L78). The code should pass in the null string for the instance name to get the default instance.\nThe bug arises because we recently fixed JBTM-2207 in order to avoid string comparison with the default name and the reason this is not a backwards compatibility issue is that com.arjuna.common.internal.util.propertyservice.BeanPopulator is internal code that the app server is using.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.txn.service.ArjunaObjectStoreEnvironmentService.java"], "label": 1, "es_results": []}, {"bug_id": 4167, "bug_title": "AS7Plugin dump-services command is failing", "bug_description": "Run JDR, the dump-services.json is always empty.  This is because the operation is not being set when JDR tries to invoke the operation.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.jdr.plugins.AS7Plugin.java"], "label": 1, "es_results": []}, {"bug_id": 4133, "bug_title": "Hanging EJB threads because of a persistent timer and failed deployment ", "bug_description": "When there is a time service with pending timeouts a bad redeploy can hang worker threads in the server.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.ejb3.timerservice.TimerServiceImpl.java", "org.jboss.as.ejb3.component.EJBComponent.java"], "label": 1, "es_results": []}, {"bug_id": 4185, "bug_title": "Using annotated servlet listeners from modules", "bug_description": "PicketLink provides support for Http Security. Basically, it consists of an API to define security policies to the paths or resources of an application and a security filter (servlet filter) that is responsible to enforce those policies for every single request.\nThe security filter is installed from a specific ServletContextListener (org.picketlink.http.internal.PicketLinkServletContextListener) that checks if the application has defined any security policy in order to decide if the filter must be installed or not.\nPicketLink also defines a ServletRequestListener (org.picketlink.http.internal.HttpServletRequestListener) that is used to produce a decorated HttpServletRequest instance. This decorated instance provides full integration between PL and the HttpServletRequest security methods plus some other goodies for PL users such as URL rewriting, etc.\nBoth listeners (servletcontext and request) are CDI beans with injection points and/or producer methods. \nWhen using PL from modules, the producer method of org.picketlink.http.internal.HttpServletRequestListener#produce is not being recognized. And that makes impossible to use PL from modules.\nThe same code works if you use PL jars inside the deployment.\nAnother interesting behavior is that EAP and WildFly are behaving differently. In EAP (latest build), the ServletContextListener is only recognized as a CDI bean if you define it in the web.xml. While in WildFly this is not necessary.\nAlso, in EAP the producer method of HttpServletRequestListener is properly recognized and everything works fine.\nI&apos;ve created a branch [1] to test this issue. The test case is \n\n\n\n\n\norg.wildfly.test.integration.security.picketlink.core.http.ServletListenerFromModuleTestCase\n\n\n\n\n\n.\n[1] https://github.com/pedroigor/wildfly/tree/WFLY-4185", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.weld.deployment.processors.ExternalBeanArchiveProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 4247, "bug_title": "Deployment fails if a web-fragment.xml references fragment name that is not present", "bug_description": "If you deploy a web application which has a web fragment with a relative ordering referring to a non-existent fragment, it will fail. This was reported for old JBossAS as JBAS-8767, Remy said the spec was not clear so he would ask, and them it was fixed for AS 6.0.\nThe reproducer WAR from JBAS-8767 fails to deploy on WildFly as well. I am unsure as to the result of the spec clarification on whether it should work, but since we fixed it for AS 6 it should probably be fixed in WF too.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.wildfly.extension.undertow.logging.UndertowLogger.java", "org.wildfly.extension.undertow.deployment.WarMetaDataProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 4275, "bug_title": "Implicit EE component attached to a root implicit bean archive recognized as implicit bean", "bug_description": "This is no longer necessary (see also WELD-1612).  Furhtermore, it&apos;s producing confusing results. For example, an ProcessBeanAttributes event is fired for com.sun.faces.config.ConfigureListener, org.jboss.weld.servlet.WeldInitialListener and other implicitly added EE components for a WAR deployment with bean-discovery-mode=\"annotated\".", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta2", "fixed_files": ["org.jboss.as.weld.deployment.processors.BeanArchiveProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 4470, "bug_title": "Duplicate message deliveries when start an MDB twice via CLI ", "bug_description": "Description of problem:\nA singleton MDB delivers duplicate messages when start-delivery() is invoked twice while the message being delivered\nSteps to Reproduce:\n1. Create a producer, which keeps sending messages for every second\n2. Deploy a singleton consumer MDB\n3. Invoke start-delivery() method on the MDB while the messages being delivered\nActual results:\nMDB delivers duplicate messages\nExpected results:\nMDB needs to ignore start-delivery() call if the MDB has already been started.\nAdditional info:", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Beta2", "fixed_version": "9.0.0.CR1", "fixed_files": ["org.jboss.as.ejb3.component.messagedriven.MessageDrivenComponent.java", "org.jboss.as.test.integration.ejb.mdb.deliveryactive.MDBTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 4475, "bug_title": "Replicate AuthenticatedSession when using custom authentication mechanisms", "bug_description": "Not replicating the authenticated session is just an optimization or BASIC, DIGEST, and CERT mechanisms.  We should treat custom authentication mechanisms the same way we treat FORM mechanisms.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Beta2", "fixed_version": "9.0.0.CR1", "fixed_files": ["org.wildfly.clustering.web.undertow.session.DistributableSessionTestCase.java", "org.wildfly.clustering.web.undertow.session.DistributableSession.java"], "label": 1, "es_results": []}, {"bug_id": 4451, "bug_title": "Security ModuleClassLoaderLocator.CombinedClassLoader does not implement getResources", "bug_description": "org.jboss.as.security.plugins.ModuleClassLoaderLocator.CombinedClassLoader does not implement getResources.  This classloader combines a module classloader with the thread context classloader.  It implements loadClass, getResource & getResourceAsStream and checks the module classloader first and if it finds it returns it else checks the TCCL.\nIt does not implement getResources which causes custom security login modules to not be able to locate resources via getResources.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta2", "fixed_files": ["org.jboss.as.security.plugins.ModuleClassLoaderLocator.java"], "label": 1, "es_results": []}, {"bug_id": 4498, "bug_title": "Resource Adapters subsystem transformers for model version 2.0.0 are not registered", "bug_description": "Due to a typo the transformers of ResourceAdapters subsystem for the model version 2.0.0 are not registered.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Beta2", "fixed_version": "9.0.0.CR1", "fixed_files": ["org.jboss.as.connector.subsystems.resourceadapters.ResourceAdaptersRootResourceDefinition.java"], "label": 1, "es_results": []}, {"bug_id": 4511, "bug_title": "CMTTxInterceptor.invokeInOurTx contains stale code handling ApplicationDeadlockException", "bug_description": "Description of problem:\n\ngit://git.app.eng.bos.redhat.com/jbossas/jboss-as.git\nejb3/src/main/java/org/jboss/as/ejb3/tx/CMTTxInterceptor.java\n\nThere is stale code catching ApplicationDeadlockException and attempting to retry the transaction. This results in a failure if the exception is raised and retry does not occur.\nVersion-Release number of selected component (if applicable):\nHow reproducible:\nConsistently\nSteps to Reproduce:\n\nVisual Inspection\nOR\nRegister a transaction Synchronization object which raises the exception during beforeCompletion()\n\nNote that EAP no longer raises this exception. The catch block code handling ApplicationDeadlockException seems to be an artifact of EAP 4 and should simply be removed.\nActual results:\nRetry does not occur\nExpected results:\nRetry should not be attempted by this code", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Beta2", "fixed_version": "9.0.0.CR1", "fixed_files": ["org.jboss.as.ejb3.tx.CMTTxInterceptor.java"], "label": 1, "es_results": []}, {"bug_id": 4487, "bug_title": "Unable to inject Web Service Context into CDI Interceptor", "bug_description": "CDI Interceptor cannot inject Web Service context.\nWhen trying to inject WebServiceContext in CDI Interceptor using @Resource annotation but it fails with: NameNotFoundException: env/org.example.MyInterceptor/webServiceContext", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.weld.services.bootstrap.WeldResourceInjectionServices.java"], "label": 1, "es_results": []}, {"bug_id": 2881, "bug_title": "org.jboss.as.ejb3.timer.schedule.CalendarBasedTimeoutTestCase#testCalendarBasedTimeout", "bug_description": "Running build with smoke tests on current github sources I get failure in this test case.\nHOUR_OF_DAY is not 0 as expected but 1.\nI changed the Assert in the test case to print out firstTimeout.toString() instead of only timeZoneDisplayName.\nSee attached files for more.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Beta2", "fixed_version": "8.1.0.Final", "fixed_files": ["org.jboss.as.ejb3.timerservice.schedule.CalendarBasedTimeout.java", "org.jboss.as.ejb3.timer.schedule.CalendarBasedTimeoutTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 4016, "bug_title": "Memory leak on undeploy caused by ejb client", "bug_description": "EJB client application deployed with jboss-ejb-client.xml, when undeployed the classloader is not being released leading to a memory leak.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.ejb3.remote.DescriptorBasedEJBClientContextService.java", "org.jboss.as.ejb3.remote.LocalEjbReceiver.java", "org.jboss.as.ejb3.subsystem.EJB3SubsystemAdd.java", "org.jboss.as.ejb3.deployment.processors.EjbClientContextSetupProcessor.java", "org.jboss.as.ejb3.remote.TCCLEJBClientContextSelectorService.java", "org.jboss.as.ejb3.deployment.processors.EJBClientDescriptorMetaDataProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 4168, "bug_title": "jdr.sh CommandLineMain does not run jdr on the application server", "bug_description": "jdr.sh CommandLineMain does not run jdr on the application server\nJDR run via the CLI / Managemenet API -  runs the JDR report in the Application Server&apos;s JVM\n/subsystem=jdr:generate-jdr-report()\nRunning jdr.sh / jdr.bat runs the JDR report in the JDR JVM\njdr.sh / jdr.bat should run the JDR report in the Application Server&apos;s JVM if it is running.  If it is not running, then it should just collect the files that are available.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.jdr.CommandLineMain.java", "org.jboss.as.jdr.commands.JdrEnvironment.java", "org.jboss.as.jdr.JdrRunner.java", "org.jboss.as.jdr.JdrReportService.java"], "label": 1, "es_results": []}, {"bug_id": 4391, "bug_title": "When testing with WildFly Full, the WSTestCase is randomly unstable", "bug_description": "Sometimes the WSTestCase will fail without any reason.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "9.0.0.Beta1", "fixed_files": ["org.jboss.as.test.smoke.webservices.WSTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 4660, "bug_title": "Infinispan cache store properties are not applied", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.CR1", "fixed_version": "10.0.0.Alpha2", "fixed_files": ["org.jboss.as.clustering.infinispan.subsystem.StorePropertyResourceDefinition.java", "org.jboss.as.clustering.jgroups.subsystem.PropertyResourceDefinition.java", "org.jboss.as.clustering.infinispan.subsystem.CacheAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 4644, "bug_title": "enabling access-log for virtual server is not effective before server reload but CLI does not require that", "bug_description": "When access-log is enabled for virtual host via CLI it does not want to perform server reload. But until server reload is executed logging is not enabled. When server reload is performed then logging works OK.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.CR1", "fixed_version": "10.0.0.Alpha3", "fixed_files": ["org.wildfly.extension.undertow.HostAdd.java", "org.wildfly.extension.undertow.AccessLogService.java", "org.wildfly.extension.undertow.Host.java", "org.wildfly.extension.undertow.AccessLogAdd.java"], "label": 1, "es_results": []}, {"bug_id": 4736, "bug_title": "UndertowDeploymentService starts web components in MSC thread", "bug_description": "The UndertowDeploymentService triggers web components&apos; start and stop lifecycle within the MSC thread which can lead to the server blocking during deployment. This was an issue with the older JBoss Web version of the Service too which was fixed as part of https://issues.jboss.org/browse/AS7-5969 (https://github.com/wildfly/wildfly/pull/3455). The same needs to be ported to this UndertowDeploymentService.\nHere&apos;s an example where a user deployment ends up being blocked https://developer.jboss.org/message/932681#932681", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.CR1", "fixed_version": "9.0.0.CR2", "fixed_files": ["org.wildfly.extension.undertow.deployment.UndertowDeploymentService.java", "org.wildfly.extension.undertow.deployment.UndertowDeploymentProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 4720, "bug_title": "DuplicateServiceException when adding a new FORK channel", "bug_description": "\n\n\n\n\n\n[standalone@localhost:9990 /] /subsystem=jgroups/channel=ee/fork=myfork:add\n\n\n\n\n{\n\n\n\n\n    \"outcome\" => \"failed\",\n\n\n\n\n    \"failure-description\" => \"WFLYCTL0158: Operation handler failed: org.jboss.msc.service.DuplicateServiceException: Service jboss.jgroups.factory.ee is already registered\",\n\n\n\n\n    \"rolled-back\" => true\n\n\n\n\n}\n\n\n\n\n\n\nthe problem is fixed in org.jboss.as.clustering.jgroups.subsystem.ForkAddHandler#installRuntimeServices\n", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.CR1", "fixed_version": "9.0.0.CR2", "fixed_files": ["org.jboss.as.clustering.jgroups.subsystem.ForkAddHandler.java"], "label": 1, "es_results": []}, {"bug_id": 4746, "bug_title": "SSO cookie-name attribute is ignored", "bug_description": "", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.CR1", "fixed_version": "9.0.0.CR2", "fixed_files": ["org.wildfly.extension.undertow.SingleSignOnService.java"], "label": 1, "es_results": []}, {"bug_id": 4635, "bug_title": "@TransactionAttribute ignored on non-public SFSB PostActivate and PrePassivate lifecycle callbacks", "bug_description": "Non-public PostActivate and PrePassivate SFSB are not supposed to be lifecycle methods by WFLY-4127 which leads to a situation where transactional attributes on them are ignored. Public methods work as expected.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.CR1", "fixed_version": "10.0.0.Alpha3", "fixed_files": ["org.jboss.as.ee.component.DefaultComponentConfigurator.java"], "label": 1, "es_results": []}, {"bug_id": 4715, "bug_title": "Webservices subsystem requires reload when it does not actually need to", "bug_description": "When trying undefining and already undefined attribute of the webservices subsystem of a WildFly container on which at least a WS deployment is active, the operation requires reload if the attribute has a default value.\nSee http://lists.jboss.org/pipermail/wildfly-dev/2015-June/004013.html for further details.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.CR1", "fixed_version": "10.0.0.Alpha3", "fixed_files": ["org.jboss.as.webservices.dmr.WSServerConfigAttributeHandler.java"], "label": 1, "es_results": []}, {"bug_id": 4777, "bug_title": "Multiple params not working properly in webservices tag", "bug_description": "I configured webservices to use a rewrite of the soap endpoint.  The following attributes don&apos;t seem to work correctly\n1. Adding this entry does not work.  I need the value for protocol to be configurable\n\n\n\n\n\n\n<wsdl-uri-scheme>${wsdl.protocol:http}</wsdl-uri-scheme>\n\n\n\n\n\n\nWith error\n\nMessage: \"WFLYCTL0248: Invalid value ${wsdl.protocol:http} for wsdl-uri-scheme; legal values are [http, https]\"\n2. wsdl-port is not leveraged properly.  I manually changed to https, based on the above limitation.  I set this:\n\n\n\n\n\n\n<wsdl-uri-scheme>https</wsdl-uri-scheme>\n\n\n\n\n<wsdl-port>${wsdl.port:443}</wsdl-port>\n\n\n\n\n\n\nHowever, the reported URL includes 8443 not my configured 443 value.\nIn addition, if I manually set the values\n\n\n\n\n\n\n            <wsdl-uri-scheme>https</wsdl-uri-scheme>\n\n\n\n\n            <wsdl-port>443</wsdl-port>\n\n\n\n\n\n\nI still get 8443.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.CR2", "fixed_version": "9.0.0.Final", "fixed_files": ["org.jboss.as.webservices.dmr.Attributes.java"], "label": 1, "es_results": []}, {"bug_id": 4612, "bug_title": "EjbJndiBindingsDeploymentUnitProcessor logs non-i18n message at INFO", "bug_description": "ejb3/src/main/java/org/jboss/as/ejb3/deployment/processors/EjbJndiBindingsDeploymentUnitProcessor.java\n\n\n\n\n\n\njndiBindingsLogMessage.append(\"JNDI bindings for session bean named \" + sessionBean.getEJBName() + \" in deployment unit \" + deploymentUnit + \" are as follows:\\n\\n\");\n\n\n\n\n\n\nThat eventually gets logged at INFO.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.CR1", "fixed_version": "10.0.0.Alpha4", "fixed_files": ["org.jboss.as.ejb3.logging.EjbLogger.java", "org.jboss.as.ejb3.deployment.processors.EjbJndiBindingsDeploymentUnitProcessor.java"], "label": 1, "es_results": []}, {"bug_id": 4748, "bug_title": "Singleton service fails to start after repetitive cluster split with \"Failed to reach quorum of 1\"", "bug_description": "When cluster of two nodes with deployed singleton service (f.i. cluster-ha-singleton quickstart app) splits, merges, and splits again, one of the nodes fails to run the singleton service with error message \"WFLYCLSV0006: Failed to reach quorum of 1 for jboss.quickstart.ha.singleton.default2 service. No singleton master will be elected.\" - note the \"quorum of 1\".\nThis only happens after the second and other successive splits. After the first split both nodes execute the service correctly.\nAfter analysis, it appears that nodes are never being added back to service providers cache upon cluster merge, because CacheServiceProviderRegistrationFactory#membershipChanged() is never called with &apos;merged&apos; attribute set to &apos;true&apos;.\nI presume that call should come from ChannelCommandDispatcherFactory#viewAccepted():\n\n\n\n\n\n\npublic void viewAccepted(View view) {\n\n\n\n\n    // ...\n\n\n\n\n    for (Listener listener: this.listeners) {\n\n\n\n\n        listener.membershipChanged(oldNodes, newNodes, view instanceof MergeView);\n\n\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\nThis method gets called, but the problem is that the &apos;listeners&apos; list is empty, so no listener is actually notified.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.CR1", "fixed_version": "10.0.0.Alpha6", "fixed_files": ["org.wildfly.clustering.server.group.CacheGroup.java"], "label": 1, "es_results": []}, {"bug_id": 4792, "bug_title": "Undertow deployment-level session statistics not available for distributable webapp", "bug_description": "org.wildfly.clustering.web.infinispan.session.InfinispanSessionManager which is used by default even for non-HA configurations in WildFly 9.0.0.CR2 (e.g. standalone.xml in app server distribution) does not implement io.undertow.server.session.SessionManagerStatistics and so no stats except for activeSessions are available. ", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.CR2", "fixed_version": "10.0.0.Beta1", "fixed_files": ["org.wildfly.clustering.web.infinispan.session.Time.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSessionTestCase.java", "org.wildfly.clustering.web.infinispan.session.SimpleSessionMetaDataExternalizer.java", "org.jboss.as.test.clustering.cluster.web.authentication.WebSecurityDomainSetup.java", "org.wildfly.clustering.web.undertow.session.DistributableSessionManagerTestCase.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSessionManager.java", "org.wildfly.clustering.web.session.SessionManager.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSession.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSessionManagerConfiguration.java", "org.wildfly.clustering.web.infinispan.session.InfinispanSessionManagerFactory.java", "org.wildfly.clustering.web.session.SessionManagerFactory.java", "org.wildfly.clustering.web.undertow.session.DistributableSessionManager.java", "org.wildfly.clustering.web.undertow.session.DistributableSessionManagerFactory.java", "org.wildfly.extension.undertow.DeploymentDefinition.java", "org.wildfly.clustering.web.infinispan.session.SessionExpirationScheduler.java"], "label": 1, "es_results": []}, {"bug_id": 3872, "bug_title": "Recurring failure of EJBSignEncryptMultipleClientsTestCase.encryptedAndSignedRequestFromJohn", "bug_description": "Since https://github.com/wildfly/wildfly/pull/6660 was submitted, EJBSignEncryptMultipleClientsTestCase.encryptedAndSignedRequestFromJohn is failing regularly. Not every time but very often.\nAlessio, you mentioned seeing some error logging from XAResourceRecoveryImpl, but that&apos;s in the logs on successful runs as well, and occurs prior to the test as well. That&apos;s a period background task from the transaction manager trying to perform recovery of some previous transaction. I don&apos;t see why it would have any impact on this test.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "10.0.0.Beta2", "fixed_files": ["org.jboss.as.test.integration.ws.wsse.signencrypt.EJBSignEncryptMultipleClientsTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 4308, "bug_title": "Proxies created via ContextService.createContextualProxy(...) are not Serializable", "bug_description": "Setting priority to critical since, I believe, this is a matter of compliance with the concurrency utilities specification.\nSection 3.3.4 of the specification states that:\n\"All invocation handlers for the contextual proxy implementation must implement java.io.Serializable.\"\nWhile the invocation handler of the generated proxy does indeed implement Serializable, it contains a reference to org.jboss.as.server.moduleservice.ServiceModuleLoader (among others), which is not serializable, thus attempts to serialize the proxies generated via ContextService.createContextualProxy(...) via JBoss Marshalling throw a org.infinispan.commons.marshall.NotSerializableException: org.jboss.as.server.moduleservice.ServiceModuleLoader", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "10.0.0.CR1", "fixed_files": ["org.jboss.as.test.integration.ee.concurrent.DefaultContextServiceServletTestCase.java", "org.jboss.as.security.service.SimpleSecurityManagerService.java", "org.jboss.as.security.SecuritySubsystemRootResourceDefinition.java", "org.jboss.as.security.service.JaasConfigurationService.java", "org.jboss.as.security.service.SecurityManagementService.java", "org.jboss.as.test.integration.ee.concurrent.DefaultContextServiceTestServlet.java", "org.jboss.as.test.integration.ee.concurrent.TestServletRunnable.java"], "label": 1, "es_results": []}, {"bug_id": 3532, "bug_title": " RemoteFailoverTestCase still fails intermittently", "bug_description": "Fail rate is at 1.5% atm.\nhttp://brontes.lab.eng.brq.redhat.com/project.html?projectId=WF&testNameId=3213279503671281753&tab=testDetails\n(making affected version alpha, but indeed its master)", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.0.Alpha1", "fixed_version": "11.0.0.Alpha1", "fixed_files": ["org.jboss.as.test.clustering.cluster.ClusterAbstractTestCase.java", "org.jboss.as.test.clustering.NodeUtil.java", "org.jboss.as.test.clustering.ClusteringTestConstants.java", "org.jboss.as.test.clustering.cluster.ejb.remote.RemoteFailoverTestCase.java"], "label": 1, "es_results": []}, {"bug_id": 6127, "bug_title": "Throw IllegalStateException if JTA tx has an unsynchronized persistence context and the target is synchronized persistence context", "bug_description": "SPEC: If a component is called and the JTA transaction is propagated into that component:\nIf there is a persistence context of type SynchronizationType.UNSYNCHRONIZED\nassociated with the JTA transaction and the target component specifies a persistence context of type SynchronizationType.SYNCHRONIZED, the IllegalStateException is thrown by the container\nWe have a stateful session bean (SFB1) / PC: TRANSACTION/UNSYNCHRONIZED)\nstateful session bean (SFB2) / PC: TRANSACTION/SYNCHRONIZED)\nSFB1 method M1 (REQUIRED) calls SFB2 Method 2 (REQUIRED):\nPC is propagated from SFB1 to SFB2 without any exception.", "project": "Wildfly", "sub_project": "WFLY", "version": "9.0.2.Final", "fixed_version": "10.1.0.Final", "fixed_files": ["org.jboss.as.test.integration.jpa.transaction.TransactionTestCase.java", "org.jboss.as.jpa.transaction.TransactionUtil.java", "org.jboss.as.jpa.messages.JpaLogger.java", "org.jboss.as.jpa.container.TransactionScopedEntityManager.java", "org.jboss.as.test.integration.jpa.transaction.UnsynchronizedSFSB.java", "org.jboss.as.jpa.container.ExtendedEntityManager.java"], "label": 1, "es_results": []}, {"bug_id": 14, "bug_title": "Cannot communicate with the server if port offset property is set", "bug_description": "In Hawkular Metrics, we use the Wildfly Maven Plugin to deploy our app and test its REST interface.\nIt is configured as follows:\n\n\n\n\n\n\n<properties>\n\n\n\n\n  <wildfly-maven-plugin.skip>false</wildfly-maven-plugin.skip>\n\n\n\n\n  <!-- IMPORTANT: The port must be the port offset + 8080. -->\n\n\n\n\n  <base-uri>127.0.0.1:55977/hawkular/metrics</base-uri>\n\n\n\n\n  <wildfly.port.offset>47897</wildfly.port.offset>\n\n\n\n\n  <!-- IMPORTANT: The management port must be the port offset + 9990. -->\n\n\n\n\n  <wildfly.management.port>57887</wildfly.management.port>\n\n\n\n\n  <wildfly.logging.console.level>ERROR</wildfly.logging.console.level>\n\n\n\n\n  <wildfly.logging.file.level>ERROR</wildfly.logging.file.level>\n\n\n\n\n  <terminal-event.timeout>10</terminal-event.timeout>\n\n\n\n\n</properties>\n\n\n\n\n\n\nand\n\n\n\n\n\n\n<plugin>\n\n\n\n\n  <groupId>org.wildfly.plugins</groupId>\n\n\n\n\n  <artifactId>wildfly-maven-plugin</artifactId>\n\n\n\n\n  <configuration>\n\n\n\n\n    <skip>${wildfly-maven-plugin.skip}</skip>\n\n\n\n\n    <port>${wildfly.management.port}</port>\n\n\n\n\n  </configuration>\n\n\n\n\n  <executions>\n\n\n\n\n    <execution>\n\n\n\n\n      <id>start-wildfly</id>\n\n\n\n\n      <phase>pre-integration-test</phase>\n\n\n\n\n      <goals>\n\n\n\n\n        <goal>start</goal>\n\n\n\n\n      </goals>\n\n\n\n\n      <configuration>\n\n\n\n\n        <serverConfig>standalone-test.xml</serverConfig>\n\n\n\n\n        <javaOpts>\n\n\n\n\n          <javaOpt>-Xms64m</javaOpt>\n\n\n\n\n          <javaOpt>-Xmx512m</javaOpt>\n\n\n\n\n          <javaOpt>-Xss256k</javaOpt>\n\n\n\n\n          <javaOpt>-Djava.net.preferIPv4Stack=true</javaOpt>\n\n\n\n\n          <javaOpt>-Dsun.rmi.dgc.client.gcInterval=3600000</javaOpt>\n\n\n\n\n          <javaOpt>-Dsun.rmi.dgc.server.gcInterval=3600000</javaOpt>\n\n\n\n\n          <javaOpt>-Djboss.socket.binding.port-offset=${wildfly.port.offset}</javaOpt>\n\n\n\n\n          <javaOpt>-Djboss.server.config.dir=${project.build.directory}/wildfly-configuration</javaOpt>\n\n\n\n\n          <javaOpt>-Dcassandra.keyspace=${cassandra.keyspace}</javaOpt>\n\n\n\n\n          <javaOpt>-Dcassandra.resetdb</javaOpt>\n\n\n\n\n          <javaOpt>-Dhawkular.metrics.waitForService</javaOpt>\n\n\n\n\n          <javaOpt>-Dhawkular.metrics.use-virtual-clock=true</javaOpt>\n\n\n\n\n          <javaOpt>-Dhawkular.terminal-event.timeout=${terminal-event.timeout}</javaOpt>\n\n\n\n\n          <javaOpt>-Dhawkular.metrics.allowed-cors-origins=http://test.hawkular.org,https://secure.hawkular.io</javaOpt>\n\n\n\n\n          <javaOpt>-Xdebug</javaOpt>\n\n\n\n\n          <javaOpt>-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8787</javaOpt>\n\n\n\n\n        </javaOpts>\n\n\n\n\n      </configuration>\n\n\n\n\n    </execution>\n\n\n\n\n    <execution>\n\n\n\n\n      <id>deploy-webapp</id>\n\n\n\n\n      <phase>pre-integration-test</phase>\n\n\n\n\n      <goals>\n\n\n\n\n        <goal>deploy-artifact</goal>\n\n\n\n\n      </goals>\n\n\n\n\n      <configuration>\n\n\n\n\n        <groupId>${project.groupId}</groupId>\n\n\n\n\n        <artifactId>hawkular-metrics-api-jaxrs</artifactId>\n\n\n\n\n        <name>hawkular-metric-rest.war</name>\n\n\n\n\n      </configuration>\n\n\n\n\n    </execution>\n\n\n\n\n    <execution>\n\n\n\n\n      <id>stop-wildfly</id>\n\n\n\n\n      <phase>post-integration-test</phase>\n\n\n\n\n      <goals>\n\n\n\n\n        <goal>shutdown</goal>\n\n\n\n\n      </goals>\n\n\n\n\n    </execution>\n\n\n\n\n  </executions>\n\n\n\n\n</plugin>\n\n\n\n\n\n\nIt worked well until we tried to upgrade to 1.1.0.Alpha3. It seems that the changes for WFMP-12 prevent us from setting a port offset.\nIn the best case (offset is small), the management client can&apos;t communicate with the server. In the worst case (offset is large), the server does not even start because the calculated management port is out of range.", "project": "Wildfly", "sub_project": "WFMP", "version": "1.1.0.Alpha3", "fixed_version": "1.1.0.Alpha4", "fixed_files": ["org.wildfly.plugin.server.RunMojo.java", "org.wildfly.plugin.server.StartMojo.java"], "label": 1, "es_results": []}, {"bug_id": 26, "bug_title": "Commands#failOnError defaults to false unless set explicitly", "bug_description": "I&apos;ve been working on a PR to support failOnError for script execution, per the discussion on GitHub PR #47.\nLeaving aside the fact that the note in the comment on this @Parameter states that \"this setting is not used for scripts\" and \"Scripts must handle errors on their own,\" and that the impetus for the \"not failing on error\" was that CLI module handling (add/remove) is broken in both commands and scripts for \"if-end-if\" and \"try-catch\"; the setting isn&apos;t behaving as expected.\nDuring debugging, unless the configuration is set explicitly, the default value is always false, even though defaultValue = \"true\" is set in the annotation.\nI don&apos;t know enough about Mojo DI to know if this is an artifact of a @Parameter of a @Parameter or something else, but explicitly setting private boolean failOnError = true; in Commands produces the expected results.\nI have a PR with tests of you&apos;re interested, but it means exposing the Commands field via ExecuteCommandsMojo#getCommands() for inspection during testing.", "project": "Wildfly", "sub_project": "WFMP", "version": "1.1.0.Alpha5", "fixed_version": "1.1.0.Alpha7", "fixed_files": ["org.wildfly.plugin.cli.Commands.java"], "label": 1, "es_results": []}, {"bug_id": 58, "bug_title": "The WildFly plugin's shutdown(reload=true) goal does not wait for the server to come back up", "bug_description": "If you call the shutdown(reload=true) goal, followed by the deploy-artifact goal, it goes boom. The reload operation runs asynchronously, and temporarily takes down the management interface that the deploy-artifact goal needs to succeed, creating a race condition that has ended badly 100% of the time for me.\nWhy might a project need to reload then deploy? For instance, it might start the server, use execute-commands to set system properties required by an application, then reload and use deploy-artifact to deploy that application. Similarly, you might want to reconfigure SSL and then reload, as that change also requires it.\nIt&apos;s worth noting that this likely has a simple fix: just copy the \"wait for server to be ready\" code used in the start goal over to the shutdown goal&apos;s reload handling.", "project": "Wildfly", "sub_project": "WFMP", "version": "1.1.0.Alpha11", "fixed_version": "1.1.0.Beta1", "fixed_files": ["org.wildfly.plugin.common.AbstractServerConnection.java", "org.wildfly.plugin.server.ShutdownMojo.java"], "label": 1, "es_results": []}]